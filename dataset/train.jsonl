{"prompt": "Explain the methodology used in the paper 'Fast adiabatic qubit gates using only $\\sigma_z$ control'.", "completion": "\n\n# Fast adiabatic qubit gates using only $\\sigma_z$ control\n\nDepartment of Physics, University of California, Santa Barbara, CA 93106, USA\n\nDepartment of Physics and Astronomy, University of Georgia, Athens, Ga 30602, USA\n\nA controlled-phase gate was demonstrated in superconducting Xmon transmon qubits with fidelity reaching 99.4\n\n## introduction\nHigh fidelity controlled-phase (CZ) gates were recently demonstrated\nfor adjacent qubits in a 5-qubit quantum processor [Unknown Author, \"Unknown Title\", ]. For\na two-qubit gate, CZ fidelity as high as 99.4\nthe phase shift from near crossing of the $|11\\rangle$ and\n$|02\\rangle$ states, similar to previous work on superconducting\nqubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], but following a new \u201cfast\nadiabatic\u201d protocol that gives both fast gate times and low error\nrates.  Here we explain the theoretical concepts behind this\nprotocol, showing how waveforms may be generated and parameterized in\na manner that is readily optimized, both numerically and\nexperimentally.\n\nThe general problem of achieving fast adiabatic performance is of great interest to the physics community\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], with applications in coherent manipulation, precision measurements, and quantum computing.  Finding an improved control methodology therefore has potential for applications in a variety of quantum systems.\n\nAlthough adiabatic quantum control has a long history, we are not aware of a theory that could address in detail our particular experimental problem: what is the optimal control trajectory for the desired CZ operation, having both short gate time and small non-adiabatic error, described in a way that is readily optimized with numerical and experimental methods.  For example, although a previous experiment used adiabaticity for a CZ gate [Unknown Author, \"Unknown Title\", ], the characterization and optimization of the adiabatic control waveform was not developed.  The goal here is to describe a simple theory that can be used to intuitively understand optimal waveforms for fast and accurate operation.\n\nSince we are concerned here with transition errors between the states $|11\\rangle$ and $|02\\rangle$ as their frequencies are varied, we may map this to a qubit problem for states $|0\\rangle$ and $|1\\rangle$ that has a fixed energy in $\\sigma_x$ from the avoided-level crossing and adjustable qubit frequency in $\\sigma_z$.  We note that this optimization problem differs from conventional quantum control, where the $\\sigma_z$ part of the Hamiltonian is fixed and both the $\\sigma_x$ and $\\sigma_y$ parts can be varied.  Here, the single-component control in $\\sigma_z$ makes optimal control much more difficult since a second operator does not exist that could be used to restore the desired adiabatic character [Unknown Author, \"Unknown Title\", ], disallowing standard pulse shaping techniques [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and \u201csuperadiabatic\u201d theory [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe set of possible adiabatic solutions is also influenced by other constraints with the superconducting qubit system.  First, the non-linearity of the qubits is small [Unknown Author, \"Unknown Title\", ], so other unwanted transitions are not necessarily far off resonance.  For example, although the waveform is optimized for adiabaticity of the near resonance $|11\\rangle$ and $|02\\rangle$ states, fast changes in the control waveform may produce transitions between the states $|01\\rangle$ and $|10\\rangle$, even though off resonance by $\\gtrsim 200\\,\\textrm{MHz}$.  A natural solution to this constraint is using smooth waveforms, which also seems to be a good strategy in terms of controlling many qubits, achieving low crosstalk, and simplifying the requirements of control electronics and their system calibration.  We thus rule out pulse and refocussing type protocols common in nuclear magnetic resonance (NMR) [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], but welcome any theory making this a practical solution.\n\nSecond, we are looking for control waveforms with fast gate times, of order $40\\,\\textrm{ns}$ for our qubits, that efficiently uses the moderate coupling $g/2\\pi \\simeq 30\\,\\textrm{MHz}$ between qubits [Unknown Author, \"Unknown Title\", ]; note that $2\\pi/g = 33\\,\\textrm{ns}$, making this problem non-trivial for adiabaticity.  Fast gates are important for coherence, especially since errors from 1/f flux noise and off-resonant coupling to other qubits, described as frequency shifts, produce phase errors proportional to characteristic gate times: If limited by these processes, the error probability thus scales as the square of gate time.  A full system optimization of a qubit processor, for example describing the optimal choice of on-resonance qubit-qubit coupling $g$ and its smaller off-resonant coupling, is beyond the scope of this article.  But clearly even a small improvement of gate time can be quite important, motivating here a detailed understanding of both fast and accurate control.\n\nThird, the CZ gate uses adiabatic control that is non-standard, as it partially moves into the avoided level crossing regime and then back out again, with the amplitude and time of the waveform adjusted to give a $\\pi$ phase shift to the $|11\\rangle$ state.  Typical solutions to an adiabatic problem consider moving through an avoided-level crossings [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], so a theory is needed to calculate optimal waveforms for an arbitrary control problem.\n\nSince one varies only a single control parameter in $\\sigma_z$, this theory may be described in a simple manner with familiar concepts that give insight into a physical understanding of adiabatic behavior.  We first show how state change from $\\sigma_z$ control in the qubit Hamiltonian can be intuitively described in an instantaneous coordinate system.  Here, the evolution of the quantum system can be understood in the small error limit using a geometrical construction.  Second, this description allows errors to be calculated using a generalized Fourier transform.  Third, to obtain a minimum time solution for small changes in angle, the theory of window functions is used to find optimal control waveforms.  We then show how to efficiently parameterize the optimum waveform using a few-term Fourier series.  Lastly, a non-linear mapping is used to find the optimal control waveform for an arbitrary change in the control.\n\nWe also examine a second problem, microwave control of a qubit, and show that conventional two-component optimal control using $\\sigma_x$ and $\\sigma_y$ gives better results as expected, but not by much.\n\nThese results present a simple yet effective way to optimize for adiabatic fidelity when changing control only in $\\sigma_z$.  Perhaps surprisingly, non-adiabatic errors can be small even if the interaction time is only slightly larger than the time scale of the transverse coupling, similar to that proposed earlier for a non-adiabatic gate [Unknown Author, \"Unknown Title\", ].  A recent experiment by our group has also demonstrated that these theoretical ideas can be used to optimize CZ performance [Unknown Author, \"Unknown Title\", ].\n\n## Geometrical Solution\nWe start with a geometrical solution to non-adiabatic error, a problem previously described using conventional methods [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  The description of a qubit given by the 2-state Hamiltonian is\n$$\n\nH = H_x\\sigma_x + H_z\\sigma_z\n= \\left(\n\\begin{array}{cc}\nH_z & \\ \\ H_x \\\\\nH_x & -H_z \\\\\n\\end{array}\n\\right) \\ ,\n\n$$\nwhere $H_x$ is constant and the qubit frequency is controlled by a time dependent $H_z(t)$, for example the magnetic field in the z-direction for an electron spin.  We consider the qubit to be controlled by a Hamiltonian vector $(H_x,0,H_z)$, having both length and direction.  As shown in Fig. (Figure fig:bloch)a, we define the control parameter $\\theta$ as the angle between the Hamiltonian vector and the z-axis\n$$\n\n\\theta = \\arctan(H_x/H_z) \\ .\n\\label{eq:theta}\n\n$$\n\nThe qubit state is described by a Bloch vector that can point in any direction on the Bloch sphere.  Here, the usefulness of this geometric construction is the idea that the lowest energy eigenstate has a Bloch vector that points in the direction of the control vector: the eigenstate vector has angle $\\theta$ from vertical and lies in the plane of the $\\hat{x}$ and $\\hat{z}$ axes.  The ground state eigenvalue $E_-=-\\sqrt{H_x^2+H_z^2}$ is proportional to the length of the control vector, whereas the excited eigenstate points in the opposite direction with eigenenergy $E_+=-E_-$.  If the Bloch state vector is not an eigenstate, then its time dynamics is to rotate (precess) around the eigenstate vector at a frequency proportional to the difference in eigenstate energies\n$$\n\n\\omega = (E_+-E_-)/\\hbar =2\\sqrt{H_x^2+H_z^2}/\\hbar \\ .\n\\label{eq:omega}\n\n$$\n\n< g r a p h i c s >\n\nGeometric picture of non-adiabatic errors.  a) Control field of constant $H_x$ and variable $H_z(t)$ gives control angle $\\theta$ from z-axis.  b) Bloch sphere representation gives ground eigenstate parallel to control vector (solid arrow).  For a small step in $\\theta$, the quantum state (gray arrow) points slightly away, with change $\\Delta \\theta$ (small gray arrow).  This state rotates around the eigenstate at frequency $\\omega$ (gray dotted lines).\n\nNon-adiabatic errors are typically understood by considering the Landau-Zener trajectory $H_z=\\dot{H}_z t$.  Initially at large negative times $t$, where $H_z$ is large and negative, the Hamiltonian control vector points in the down direction, with the state given by the Bloch vector also in the down direction having $\\theta = \\pi$.  As the time goes to zero, the control vector  $(H_x,0,H_z=0)$ points along the equator, with the Bloch vector $\\theta = \\pi/2$.  At large positive times the control and Bloch vector points in the up direction $\\theta = 0$.\n\nWhen the field is slowly varied $(\\dot{H}_z \\rightarrow 0)$, the state adiabatically changes from $\\theta = \\pi$ to $\\theta = 0$.  A finite ramp rate gives errors, with the probability to make a transition to the excited final eigenstate as\n$$\n\nP_e=\\exp(-\\pi H_x^2/\\hbar\\dot{H}_z) \\ .\n\n$$\nA small final error $P_e = 10^{-4}$ implies the condition $\\dot{H}_z=0.341\\,H_x^2/\\hbar$.  If we assume a change in $H_z$ from $-10 H_x$ to $10 H_x$, the total time for the control pulse is $t_c = 18.6\\,(h/2H_x)$, where $h/2H_x$ is the oscillation time for the transverse Hamiltonian.\n\nThe factor 18.6 implies a long control time for the Landau-Zener trajectory.  We will show with optimal control this time factor can be reduced significantly, to order unity.\n\nFor adiabatic evolution of the quantum state, the state vector stays aligned with the direction of the control Hamiltonian.  To better characterize non-adiabatic errors, we change the reference frame of the Bloch sphere to coincide with that of the control Hamiltonian.  In this moving frame $\\theta_m=0$ represents being in the ground state of the instantaneous Hamiltonian, with no non-adiabatic error.\n\nTo understand non-adiabatic deviations, we consider the time dynamics of state change.  We first consider an infinitesimal time step $\\Delta t$, during which the the control vector initially changes its direction by $\\Delta \\theta$, as shown in Fig. (Figure fig:bloch)b.  A transformation to the new moving frame produces a small change in the angle of the Bloch vector $-\\Delta \\theta$.  During the remainder of the time $\\Delta t$ the Bloch vector rotates around the $\\theta_m = 0$ axis, at the frequency $\\omega$.  Starting with $\\theta_m =  0$ before this time step, the angles $\\theta_x$ and $\\theta_y$ in the x- and y-direction can be written  compactly as\n$$\n\n\\theta_m \\equiv \\theta_x+i\\theta_y = -\\Delta\\theta \\, e^{-i\\omega \\Delta t}\n\n$$\nafter time $\\Delta t$, assuming small angles as appropriate for small non-adiabatic errors.  This finite angle implies the quantum state has not changed adiabatically (as $\\theta_m \\neq 0$), with the error probability given by $P_e = (\\sin|\\theta_m|/2)^2 \\approx |\\theta_m|^2/4$.\n\nWe next understand the error coming from a sequence of time steps $\\Delta t_i$ each with a small angle change $\\Delta \\theta_i$.  A useful simplification comes from changing to a new frame that rotates with the precession of the Bloch vector, which implies the above $\\theta_m$ vector does not rotate.  Instead, the change $\\Delta\\theta_i$ rotates in time by an angle $\\phi_i$, which is computed by summing over all the previous phase changes in the individual steps. The net change in the complex angle of the Bloch vector in this moving and rotating frame is\n$$\n\n\\theta_{mr} &= -\\sum_i \\Delta\\theta_i \\, e^{-i\\phi_i} \\\\\n&= -\\int dt\\,(d\\theta/dt) \\, \\exp[-i \\smallint^t \\omega(t') dt'] \\ , \\label{GLint}\\\\\nP_e&= |\\theta_{mr}|^2/4 \\ ,\n\n$$\nwhere $P_e$ is the total probability error.  These equations are the general solution for non-adiabatic error in the small error limit, derived here using a geometric description.\n\nThe amplitude error $\\theta_{mr}$ is proportional to the rate of change in the eigenstates, as given by $d\\theta/dt$.  This quantity is mostly averaged to zero because of the rapidly changing phase from the $\\omega$ integral, with averaged amplitude decreasing with increasing qubit frequency $\\omega$.\n\nNote that we have assumed here that all changes add linearly.  This is a good assumption as long as the net change in angle is very small; for example, it is known that for qubits with small change in state can be approximated by a harmonic oscillator, a linear system.  This assumption is generally acceptable since we are only interested in qubit control that give small errors.\n\nAn exact calculation of the error, starting from the Schr\u00f6dinger equation, is derived in Appendix I.  It gives results identical to this geometrical solution in the small error limit.  There are two changes for the exact solution: the driving amplitude $d\\theta/dt$ should also be multiplied by the factor $\\cos|\\theta_{mr}|$, and the probability is $P_e=\\{\\sin[\\arcsin(\\theta_{mr})/2]\\}^2$.\n\nTo understand how to construct an optimal waveform, we first note that there is a trade-off between the control time and the magnitude of non-adiabatic error.  Zero error is not possible - we are instead looking for acceptably small errors, say below $10^{-4}$, with as short of a control time as possible.  We also want stable control waveforms, so that the error does not increase rapidly for small changes in the waveform.\n\nWe first note that non-adiabatic errors are proportional to a change in the control variable $\\theta$.  Errors will be relatively small when $|H_z| \\gg H_x$, due to the slow dependence of $\\theta$ on $H_z/H_x$ and the large oscillation frequency $\\omega$, as described in Eqs. (<ref>) and (<ref>).\n\nOPTIMAL SOLUTION: SMALL CHANGE IN $\\theta$\n\nFor the case where $H_z$ only changes by a small amount, the qubit frequency can be approximated as being constant $\\omega = \\omega_0$.  Then Eq. (<ref>) is just the Fourier transform of $d\\theta/dt$ at frequency $\\omega_0$, which gives a probability proportional to the power spectral density of the signal at the oscillation frequency $\\omega_0$\n$$\n\nP_e = (1/4)\\, S_{d\\theta/dt}(\\omega_0) \\ .\n\n$$\nThis makes sense physically since it is power at the transition frequency, given by $|\\theta_{mr}|^2$, that drives the qubit transition to produce errors.\n\n< g r a p h i c s >\n\n(color online) Waveform and power spectral density $S(\\omega_0)$, for a small change in control $\\theta$ such that the qubit frequency is approximately constant $\\omega = \\omega_0$.  Here, the spectral density is dimensionless and proportional to the qubit error $P_e \\simeq (1/4)S(\\omega_0)$, valid in the limit of large $t_p$.  a) Plot of waveform $d\\theta/dt$ versus $t/t_p$ for a rectangular pulse (i, black), Hanning window (1, blue), Slepian (ii, gray), and optimized Fourier coefficients with two (2, red), four (4, green), and ten (10, cyan) terms.  Note the similarity of the Slepian curves to the optimized Fourier functions, except near $t/t_p=0,1$.  b) Plot of power spectral density obtained from a Fourier transform of the waveforms in a). All waveforms are normalized to have unit area.  The vertical dashed line shows spectral cutoff for minimization of integrated noise.\n\nFor the simple case of a linear change in the control $\\theta$ from $\\theta_i$ to $\\theta_f$, the error is proportional to the (constant) derivative $d\\theta /dt=(\\theta_f - \\theta_i)/t_p$, shown as the black line in Fig. (Figure fig:Theta)a.  The error versus the pulse time $t_p$ is the power spectral density of a rectangular pulse\n$$\n\nP_e^\\textrm{sq} = (1/4)\\Big|(d\\theta/dt) \\int_0^{t_p} dt \\exp(-i\\omega_0 t) \\Big|^2 \\\\\n= (\\theta_f-\\theta_i)^2 \\sin^2(\\omega_0t_p/2)/\\omega_0^2 t_p^2 \\ ,\n\n$$\nwhich corresponds to the square of the sinc function.  Although the error is zero when $t_p = 2\\pi/\\omega_0$, small errors occur only around a small range of this time, so we consider this solution not to be stable or practically useful.  For large times, the general falloff of the error is quite slow, scaling as $1/t_p^2$, so this control waveform does not present a good solution to adiabatic control.\n\nThe functional dependence of the error versus pulse time can be changed by using different control waveforms [Unknown Author, \"Unknown Title\", ].  Another example is the function $[1-\\cos(2\\pi t/t_p)]/2$, known as the Hanning window, as shown in blue in Fig. (Figure fig:Theta).  In this case, the error is\n$$\n\nP_e^\\textrm{H}\n= P_e^\\textrm{sq} /|1-(\\omega_0 t_p/2\\pi)^2|^2\\ ,\n\n$$\nwhere the first zero is at twice the time of the square window $t_p=4\\pi/\\omega_0$, but the error falls off more quickly as $1/t_p^6$ at large times.  Although this window function is superior to the square window, the errors are still somewhat large right after the first zero, so other window functions should be considered.\n\nAs well known from NMR [Unknown Author, \"Unknown Title\", ], optimizing non-adiabatic error versus total control time $t_p$ can be understood as optimizing windowing functions: the optimization criteria depend on the requirements for a particular application.\n\nSince we are interested in low errors for a range of pulse times, we define the optimal waveform as one that gives low error for any time larger than some chosen time: this definition is essentially equivalent to adiabatic behavior.\nWe can use the theory of optimal window functions in signal processing to find this control waveform, known as a Slepian [Unknown Author, \"Unknown Title\", ].  This function is defined by finding the optimal waveform that minimizes the integrated spectral density above a chosen frequency.  For example, the Slepian waveform optimized for frequencies above $\\omega_0 t_p/2\\pi > 2.3$ is shown in gray in Fig. (Figure fig:Theta).  Although the first minimum is at slightly longer times than for the Hanning window, the error is always below $10^{-5}$ above this value.  A different Slepian cutoff parameter can be used to tradeoff the maximum error for the time of the first minimum.\n\nA disadvantage of the Slepian function is that it does not go to zero at the beginning and end of the pulse, which creates a sharp edge as for a rectangular pulse.  This makes the function harder to synthesize, since real waveform generators have finite response times.  A practical way around this issue is to find a near optimum solution using Fourier basis functions [Unknown Author, \"Unknown Title\", ] given by\n$$\n\n\\frac{d\\theta}{dt} &= \\sum_{n=1,2,\\ldots, n_m} \\lambda_n [1-\\cos(2\\pi n t/t_p)] \\ , \\label{eq:dth}\n\n$$\nwhich goes smoothly to zero at the beginning and end of the pulse. The coefficients are constrained by the height of the pulse\n$$\n\n\\theta_f-\\theta_i &= t_p \\sum_n \\lambda_n \\ .\n\n$$\nUsing standard numerical minimization ( function in MATLAB), the coefficients $\\{ \\lambda_n \\}$ can be found that optimizes for the minimum integrated spectral density, as for the Slepian. The waveform and spectral densities for $n_m = 2, 4,$ and $10$ are plotted in Fig. (Figure fig:Theta), which shows performance close to the Slepian.   Coefficients are given in Table (Table tab:lamfourier), showing the first two are dominant.  It is particularly interesting to note that the waveform for $n_m=2$ (red), with only 2 Fourier coefficients, is reasonably close in shape to the Slepian and has acceptably small errors $<10^{-4}$.\n\nTable of $\\lambda_n$ coefficients obtained from numerical minimization of noise for frequencies $\\omega_0 t_p/2\\pi > 2.3$, using the constraint $\\sum \\lambda_n =1$.\n\n$n_m$     $\\lambda_1$      $\\lambda_2$      $\\lambda_3$      $\\lambda_4$\n$\\lambda_5$      $\\lambda_6$      $\\lambda_7$ 2     1.0866     -0.0866         4     1.0751     -0.0811     0.0017     0.0044 10     1.0280     -0.0606      0.0052     0.0055     0.0047     0.0046     0.0035\n\nThe Fourier basis functions can also include the terms $\\lambda_n^s \\sin(\\pi n t/t_p)$ for $n$ odd, which go to zero at $t=0, t_p$ but have non-zero derivatives there.  Upon using this larger basis set, we find the numerically optimized solutions are not much better than found above only using cosine terms.  We choose not use use these sine basis functions because we prefer to also have a zero derivative at the beginning and end of the pulse.\n\nWe are also interested in control waveforms that take an initial $\\theta_i$ to $\\theta_f$ and then back again to $\\theta_i$.  In this case the waveform for $\\theta$, not $d\\theta/dt$, is given by the Fourier basis\n$$\n\n\\theta - \\theta_i &= \\sum_{n=1,2,\\ldots, n_m} \\lambda_n' [1-\\cos(2\\pi n t/t_p)] \\ ,\n\\label{eq:dthprime}\n\n$$\nwith constraints on the coefficients\n$$\n\n\\theta_f-\\theta_i &= 2 \\sum_{n \\textrm{ odd}} \\lambda_n' \\ .\n\\label{eq:dthprimecon}\n\n$$\nThe derivative $d\\theta/dt$ is now a sum of sine functions, which have non-zero derivatives at the beginning and end of the pulse.  Figure (Figure fig:DTheta) shows optimized results for 1, 2, and 3 Fourier coefficients, as well as for the first-harmonic solution of the Slepian.  As for the previous case, the optimized Fourier solution is close to that of the Slepian: only two coefficients (red curve) is required for close approximation to the ideal solution.\n\n< g r a p h i c s >\n\n(color online) Waveform and power spectral density ($S(\\omega_0) \\simeq 4P_e$) as for Fig. (Figure fig:Theta), but with a trajectory from $\\theta_i$ to $\\theta_f$ and back.  a) Plot of waveform $d\\theta/dt$ versus $t/t_p$ for optimized Fourier coefficients with one (1, blue), two (2, red), and three (3, green) terms, as well as Slepian (i, gray).  b) Plot of power spectral density from Fourier transforms of the waveforms in a). Waveforms normalized using $2\\sum \\lambda_n' = 1$.\n\nOPTIMUM SOLUTION: ARBITRARY $\\theta$\n\nThe optimal solution for an arbitrary change in $\\theta$ will have to account for the qubit frequency $\\omega$ changing during the control pulse. The solution is found by first making a coordinate transformation to an accelerating frame in time where the oscillation frequency is constant, and then using optimal waveforms as found previously.\n\nThe basic idea is to define a new frame with time $\\tau$ such that the rate of change of the phase is constant.  Choosing this frequency as the constant $\\omega_x=2H_x/\\hbar$, the times are related by\n$$\n\n\\omega_x \\,d\\tau = \\omega(t)\\, dt \\ .\\label{eq:wt}\n\n$$\nIn this frame, the error angle from Eq. (<ref>) becomes\n$$\n\n\\theta_{mr} &=\n-\\int d\\tau\\,(d\\theta/d\\tau) \\, \\exp[-i \\omega_x \\tau] \\ , \\label{GLtauint}\n\n$$\nso that the optimal shape of $d\\theta(\\tau)/d\\tau$ can be computed for constant frequency $\\omega_x$, as done in the last section.  Integration of $d\\theta/d\\tau$ is next used to compute the quantity $\\theta(\\tau)$.  The relationship between the real time $t$ and $\\tau$ is finally solved by integrating Eq. (<ref>)\n$$\n\nt(\\tau)&=\\int^{\\tau} d\\tau' \\, \\omega_x/\\omega(\\tau') \\\\\n&= \\int^\\tau d\\tau'\\, \\sin\\theta(\\tau') \\ ,\n\n$$\nwhere in the last equation we have used Eqs. (<ref>) and (<ref>) to find the relation $\\omega=\\omega_x/\\sin\\theta$.\nThe function $t(\\tau)$ can be inverted numerically using interpolation.  For example, in MATLAB code the dependence $\\theta(t)$ would be given through the interpolation of the vectors $t(\\tau)$ and $\\theta(\\tau)$ using the command  $\\theta(t)$ =$(t(\\tau),\\theta(\\tau),t)$.\n\n< g r a p h i c s >\n\n(color online) Waveform and error for $H_z$ changing from $-10H_x$ to $10H_x$.  a) Blue lines are plot of control $\\theta(t)$ versus $t/t_p$ for two (solid) and three (dashed) Fourier coefficients.  The right scale shows the waveform $H_z(t)$ as green lines.  b) Plot of non-adiabatic error versus pulse time $t_p$ for linearized and exact solutions, with both two and three optimized coefficients. Low errors can be achieved for times greater than  $t_p = 2\\pi/\\omega_x$, corresponding to one oscillation at the avoided level crossing. We define $\\omega_x=2H_x/\\hbar$.\n\nTo illustrate this solution for an arbitrary control problem, we first consider the avoided level crossing from $H_z=-10H_x$ to $ H_z=10H_x$, as discussed earlier for the Landau-Zener trajectory.  The waveform is shown as solid lines in Fig. (Figure fig:LZopt)a for the 2 Fourier coefficients $\\{ \\lambda_1 = 1.086, \\lambda_2=-0.086 \\}$ found earlier.  Here we find the control waveform is nearly linear in $\\theta$, not in $H_z$ as assumed for the standard Landau-Zener problem.  The non-adiabatic error $P_e$ is plotted in Fig. (Figure fig:LZopt)b, both for the linearized (black) and the exact (blue) solution of the qubit dynamics.  The linearized solution has similar shape to that found earlier, as expected, whereas the exact solution shows significantly higher errors, demonstrating that an exact solution for this control problem is important.\n\n< g r a p h i c s >\n\n(color online) Waveform and error for $H_z$ changing from $10\\,H_x$ to $1.17\\,H_x$, and then back to $10H_x$.  a) Black line (1) is for optimal waveform, whereas blue line (2) includes the effect of waveform rounding by control electronics, here accounted for by a convolution.  b) Plot of non-adiabatic error versus pulse time $t_p$ for the two cases, using exact solutions.  Optimal coefficients are $\\{ \\lambda_2', \\lambda_3' \\} = \\{-0.19,0\\}$ for black (1) and $\\{-0.16,0.04\\}$ for blue (2) line.\n\nTo further reduce error, we next optimize the $\\lambda_n$ coefficients for better performance.  Shown in green is the best performance obtained for varying $\\lambda_2$, whereas the red curve shows optimal performance for a choice of $\\lambda_2$ and $\\lambda_3$.  It is impressive that non-adiabatic errors in the $10^{-5}$ range can be obtained with only a small number of coefficients.  Also note that that low errors occurs at a pulse time $t_p$ equal to one oscillation period $h/2H_x$ of the avoided level crossing, about 20 times faster than the simple Landau-Zener trajectory.\n\nAnother important waveform is for a controlled pulse in $\\theta$, as shown earlier in Fig. (Figure fig:DTheta).  Here we consider the control angle changing from $\\theta_i = 0.1$ to $\\theta_f = 0.55\\,\\pi/2$, then back again to $\\theta_i$; these parameters are chosen to give the CZ gate $|11\\rangle \\rightarrow \\exp(i\\pi)|11\\rangle$, where this additional $\\pi$ phase shift comes from the avoided level crossing between the states $|11\\rangle$ and $|02\\rangle$.  In this case $\\theta(\\tau)$ is given by Eqs. (<ref>) and (<ref>), and $\\theta(t)$ is found as for the last example.  We find a near optimal solution for only one additional coefficient $\\lambda_2' = -0.19$, as shown in black in Fig. (Figure fig:CZ).  We obtain very low error for a total control time about one oscillation of $\\omega_x/2\\pi$.\n\nThis waveform requires fast changes in $H_x$ at the beginning and end of the pulse.  Because of the finite bandwidth of the control electronics, such a shape may not be possible to synthesize, so we next consider the optimal control including rounding of the waveform, here accounted for by convolution of the output waveform with a Gaussian.  With convolution, the computed non-adiabatic error increases significantly with the original $\\lambda_2'$ coefficient.  We found that adjusting $\\lambda_2'$ could not improve the error much, but by including the next coefficient $\\lambda_3'$ the error could be effectively minimized.  This optimal solution is shown as the blue line in Fig. (Figure fig:CZ), where low error is now found at about twice the oscillation period of $\\omega_x/2\\pi$.  Note that about 1/2 of the increase in time of the control waveform is accounted for by the extra time added at the beginning and end of the pulse from convolution.\n\n## Optimum solution for 2-state errors\nThe Fourier basis may be used to optimize waveforms for other control problems, so it is natural to ask whether these ideas can be used to minimize the excitation to the second excited state when driving weakly anharmonic qubits.  This corresponds to the standard problem for optimal control, where shaping occurs in the off-diagonal $\\sigma_x$ and $\\sigma_y$ parts of the Hamiltonian.  A solution that works extremely well is waveform shaping by Derivative Removal by Adiabatic Gate (DRAG) [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  It is interesting to consider whether simple shaping using the Fourier basis waveforms can improve upon DRAG.\n\nErrors from the $|2\\rangle$ state come in two forms: (I) direct transitions to $|2\\rangle$ producing 2-state errors, and (II) virtual excitations to $|2\\rangle$, producing an AC Stark shift between the qubit states $|0\\rangle$ and $|1\\rangle$ that give changes in rotation amplitude and direction.  The transition frequencies between the states $|0\\rangle \\leftrightarrow |1\\rangle$ and $|1\\rangle \\leftrightarrow |2\\rangle$ are $\\omega_0$ and $\\omega_0+\\Delta$, which defines a nonlinearity $\\Delta$ that is negative for transmons.\n\n(I) Transitions to the 2-state come from the drive waveform having spectral density at the $|1\\rangle \\leftrightarrow |2\\rangle$ frequency.  As the drive needs to be resonant with the $|0\\rangle \\leftrightarrow |1\\rangle$\ntransition, it can be described in general with a two-quadrature form  $x(t)\\cos(\\omega_0 t)+y(t)\\sin(\\omega_0 t)$, which can be written compactly in complex notation as $[x(t)-iy(t)]\\exp(i\\omega_0 t)$.  The drive waveform for DRAG has the quadrature component proportional to the time derivative $\\dot{x}(t)$\n$$\n\nW(t)=[x(t)-iD\\, \\dot{x}(t)/\\Delta]e^{i\\omega_0 t} \\ ,\n\n$$\nwith its magnitude adjusted by a dimensionless derivative parameter $D$.  The transition rate is expected to scale as the spectral density of $W$, which is the squared magnitude of the Fourier transform\n$$\n\nW(\\omega) &= \\int dt \\, e^{-i\\omega t} W(t) \\\\\n&= [1+D(\\omega-\\omega_0)/\\Delta] \\int dt \\ e^{-i\\omega t} x(t)e^{i\\omega_0 t} \\ ,\n\n$$\nwhere integration by parts is used [Unknown Author, \"Unknown Title\", ] to shift the derivative of $x$ to the term $\\exp[i(\\omega_0 -\\omega)t]$.  Driving the $|0\\rangle \\leftrightarrow |1\\rangle$ transition at $\\omega_0$, the spectral density is zero at the $|1\\rangle \\leftrightarrow |2\\rangle$ transition frequency ($\\omega-\\omega_0=\\Delta$) when $D=-1$.  As this is a qualitative argument, we use numerical simulation to minimize the population error to the 2-state; below we show our optimal DRAG coefficient is $D=-1.20$, close to the computed value.\n\n(II) The origin of the AC Stark shift can be understood as coming from level repulsion between the $|1\\rangle$ and $|2\\rangle$ states when driven off-resonance, which changes the frequency of $|1\\rangle$ state proportional to $-x^2/2\\Delta$.  The derivative term also Stark shifts the qubit, giving a net shift [Unknown Author, \"Unknown Title\", ] proportional to $-(1+2D)x^2/2\\Delta$.  As the $x^2$ term gives a shift that is time dependent, a practical solution is to choose $D=-1/2$ for no Stark shift, allowing the qubit frequency to be constant [Unknown Author, \"Unknown Title\", ].  In this case transition errors to the 2-state are not optimized, but the solution is still useful since errors are lowered by $(1+D)^2 = 1/4$.\n\nAs we wish to use $D=-1$ for minimum 2-state errors, we note here there exists another practical solution: constant detuning of the microwave frequency.  This works because the dynamic Stark shift, which produces a small change in the rotation direction of the Bloch vector in the qubit subspace, can always be compensated for by a static change in drive frequency and phase.  Equivalently stated, the three parameters of the drive frequency, phase and amplitude moves the Bloch vector by any desired rotation direction and angle.  Finding zero error thus becomes the same procedure as for normal tuning up of qubit gates, only here the frequency and phase must be separately tuned for $\\pi/2$ and $\\pi$ rotations.  As this optimization can always be performed, we need only be concerned with 2-state errors.\n\nThese ideas were evaluated using numerical simulations of a 3-level system with $\\Delta$ nonlinearity, integrating the Hamiltonian matrix over the waveform pulse to find the net unitary transformation.  We find good performance using the Fourier basis, shown initially for a drive $x(t) \\propto 1-\\cos(2\\pi t/t_p)$ with amplitude adjusted to give a $\\pi$-pulse.  As we find transition probabilities for $|0\\rangle \\rightarrow |2\\rangle$ and $|1\\rangle \\rightarrow |2\\rangle$ are quite close in magnitude, we plot in Fig. (Figure fig:HD) the average of these 2-state errors versus pulse time $t_p$ normalized with the qubit anharmonicity $|\\Delta|/2\\pi$.  Here, we optimize amplitude and detuning parameters for qubit subspace errors below $10^{-7}$ at $t_p |\\Delta|/2\\pi \\simeq 2.5$; we find the 2-state errors change little when slightly varying these parameters to zero errors at different values of $t_p$.  The error without a derivative $D=0$ is plotted in black.  The waveform with the half-derivative $D=-0.48$, plotted in red, shows a reduction in error by about a factor of 4 that is consistent with the above argument.  As expected, we find a much better solution using the DRAG coefficient near unity $D=-1.20$, as plotted in green.\n\nWe also tested for waveform optimization of $x(t)$ by adjusting the Fourier coefficient $\\lambda_2$.  For the $D=0$ case we find better performance for $\\lambda_2=-0.07$, plotted in blue, with an average magnitude similar to the $D=-0.48$ solution.  For $D=-1.20$ and $\\lambda_2=-0.05$, plotted in purple, we found adjusting $\\lambda_2$ shifted the first minimum; we thus propose that this parameter can be used to tune for a somewhat smaller 2-state error.\n\nComparing to plots in Ref. [Unknown Author, \"Unknown Title\", ] using a truncated Gaussian waveform, we find the $D=-0.48$ solution has errors comparable to first order DRAG (purple curve of their Fig. 3).  Our $D=-1.20$ solution is about one order of magnitude below the second order DRAG solution (green curve of their Fig. 4) for $t_p |\\Delta|/2\\pi \\lesssim 3.1$.  We conjecture that combining second-order DRAG with our optimized Fourier-based waveforms would perform even better.\n\n< g r a p h i c s >\n\n(color online) Average probability of two-state population versus pulse time $t_p$ for a qubit $\\pi$-pulse.  The time is normalized with the qubit nonlinearity $|\\Delta|/2\\pi$.  Parameters are chosen to minimize qubit errors near $t_p|\\Delta|/2\\pi = 2.5$.  DRAG term $D=$ 0, -0.48 and -1.20 are shown in black (1), red (3) and green (4), respectively.  Optimization of the waveform $x(t)$ with Fourier coefficient $\\lambda_2$ are shown in blue (2) and purple (5).\n\nWaveforms corrected by a derivative term with $D=-1.20$ produce a good optimum solution.  However, one-component optimal control is not that much slower, acceptable for problems where there is only access to $\\sigma_z$ control.\n\n## conclusion\nWe have shown that an optimal control waveform for adiabatic behavior may be obtained by minimizing the spectral weight integrated above a cutoff frequency.  Although the best solution is a Slepian, optimization of a few-term Fourier series shows comparably low errors, with acceptable performance achieved with only two or three coefficients.  This solution can be used for arbitrary control, even when the transition frequency is changing in time, by first solving the problem with a fixed frequency and then transforming to the proper time frame.  We find effects of finite bandwidth in the control waveform can be readily accounted for by optimizing the Fourier coefficients.  This method of solution can be used for other control problems, such as minimizing the 2-state occupation for a single qubit $\\pi$-pulse.\n\nWith this protocol, we find that gates with intrinsic error below $10^{-4}$ should be possible for the two-qubit controlled-phase operation, even for relatively fast gate times.  This theoretical understanding may help open up a route to ultra-high fidelity quantum operations and fault tolerant quantum computation.\n\nWe thank A. Korotkov for helpful discussions. This work was supported\nby the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA), through the Army Research Office grants W911NF-09-1-0375 and W911NF-10-1-0334. All statements of fact, opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of IARPA, the ODNI, or the U.S. Government.\n\n## Appendix I: Exact solution\nThe exact quantum solution to the non-adiabatic problem may be expressed in the form found geometrically.  We start by considering the effect of a rotation around the $H_x$-axis.  If the wavefunction in a fixed basis is given by $|\\Psi\\rangle = a|0\\rangle + b |1\\rangle$, then it can be rewritten in a basis rotated by the angle $\\theta$ as $|\\Psi\\rangle = \\alpha |-\\rangle + \\beta |+\\rangle$, re-expressed in eigenstates of the new basis with amplitudes given by\n$$\n\n\\alpha &= a \\cos(\\theta/2) - b \\sin(\\theta/2) \\ ,\\\\\n\\beta &= b \\cos(\\theta/2) + a \\sin(\\theta/2) \\ .\n\n$$\n\nIn the $\\theta$-rotated basis we define the energy eigenvalues as $\\pm \\omega/2$, which introduces phase factors that has differential form $\\dot{\\alpha} = -i (\\omega/2)\\alpha$ and $\\dot{\\beta} = i (\\omega/2) \\beta$.  We are interested in changes in the control vector, so if $\\theta$ changes with time one finds\n$$\n\n\\dot{\\alpha} &= -i(\\omega/2)\\alpha-a\\sin(\\theta/2)\\,\\dot{\\theta}/2 -b\\cos(\\theta/2)\\,\\dot{\\theta}/2 \\\\\n&= (-i\\omega\\alpha-\\dot{\\theta}\\beta )/2 \\ ,\\\\\n\\dot{\\beta} &= (+i\\omega\\beta + \\dot{\\theta}\\alpha )/2 \\ .\n\n$$\nNote the symmetry of the rotations, with factors $i\\omega$ for the time-dependence of $H_z$ rotations, and $\\dot{\\theta}$ for the $H_x$ rotation.\n\nThe time dependence can be described simply if one considers the quantity $\\alpha^*\\beta$, where $^*$ is the complex conjugate.  Its derivative is\n$$\n\n\\frac{d}{dt}\\big(\\alpha^* \\beta\\big) &= (i\\omega\\alpha^*-\\beta^* \\dot{\\theta})\\beta/2 +\n\\alpha^*(i\\omega\\beta + \\alpha \\dot{\\theta})/2 ] \\\\\n&= i\\omega (\\alpha^* \\beta)+(|\\alpha|^2-|\\beta|^2)\\dot{\\theta}/2 \\\\\n&= i\\omega (\\alpha^* \\beta)+\\sqrt{1-4|\\alpha^*\\beta|^2}\\ \\dot{\\theta}/2 \\ ,\\label{LZde}\n\n$$\nwhere in the last equation we have used the relation\n$$\n\n\\big(|\\alpha|^2-|\\beta|^2\\big)^2 & = |\\alpha|^4+2|\\alpha|^2|\\beta|^2+|\\beta|^4 - 4|\\alpha^*\\beta|^2 \\\\\n& = \\big(|\\alpha|^2+|\\beta|^2\\big)^2 - 4|\\alpha^*\\beta|^2 \\\\\n& = 1 - 4|\\alpha^*\\beta|^2 \\ .\n\n$$\nNote that the square root factor in Eq. (<ref>) changes sign when $|\\alpha|^2-|\\beta|^2$ is negative.\n\nFor Bloch vector angles $\\Theta$ and $\\varphi$ the amplitudes are $\\alpha=\\cos(\\Theta/2)$ and $\\beta=\\sin(\\Theta/2)e^{i\\varphi}$, which gives\n$$\n\n\\alpha^*\\beta &= \\cos(\\Theta/2)\\sin(\\Theta/2)e^{i\\varphi} \\\\\n&=\\sin\\Theta \\,e^{i\\varphi} /2 \\ .\n\n$$\nso that its magnitude is the error probability $P_e = [\\sin(\\Theta/2)]^2 \\approx |\\alpha^*\\beta|$ only for small angles $\\Theta$. Inserting this result for $\\alpha^*\\beta$ into Eq. (<ref>), one finds\n$$\n\n\\frac{d}{dt}(\\sin\\Theta \\,e^{i\\varphi}) = i\\omega (\\sin\\Theta \\,e^{i\\varphi}) + \\cos \\Theta\\  \\dot{\\theta} \\ .\n\n$$\nChanging phase variables $\\varphi = \\varphi' + \\phi$, where $\\phi = \\int \\omega dt$ and noting that $d\\phi/dt = \\omega$, we can remove the $i\\omega$ phase term\n$$\n\n\\frac{d}{dt}(\\sin\\Theta \\,e^{i\\varphi'}) = \\cos \\Theta\\  \\dot{\\theta} e^{-i\\phi} \\ ,\n\n$$\nwhich is equivalent to previous geometrical result Eq. (<ref>) in the low amplitude limit $\\Theta \\rightarrow 0$.  Here, the exact solution has the amplitude of the drive term $d\\theta /dt$ rescaled by $\\cos\\Theta$ to account for the geometry of the Bloch sphere.\n\n10\n\nRami13 R. Barends, J. Kelly, A. Megrant, A. Veitia, D.\nSank, E. Jeffrey, T. C. White, J. Mutus, A. G. Fowler, B.\nCampbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, C. Neill, P.\nO'Malley, P. Roushan, A. Vainsencher, J. Wenner, A. N. Korotkov,\nA. N. Cleland and John M. Martinis, Nature 508, 500-503 (2014).\n\ncz1 F. W. Strauch, P. R. Johnson, A. J. Dragt, C. J. Lobb, J. R. Anderson and F. C. Wellstood, Phys. Rev. Lett. 91, 167005 (2003).\n\nczad L. DiCarlo, J. Chow, J. Gambetta, Lev Bishop, B. Johnson, D. Schuster, J. Majer, A. Blais, L. Frunzio, S. Girvin and R. J. Schoelkopf, Nature 460, 240 (2009).\n\ncz2 L. DiCarlo, M. D. Reed, L. Sun, B. R. Johnson, J. M. Chow, J. M. Gambetta, L. Frunzio, S. M. Girvin, M. H. Devoret and R. J. Schoelkopf, Nature 467, 574 (2010).\n\ncz3 T. Yamamoto, M. Neeley, E. Lucero, R. C. Bialczak, J.\nKelly, M. Lenander, Matteo Mariantoni, A. D. O'Connell, D. Sank,\nH. Wang, M. Weides, J. Wenner, Y. Yin, A. N. Cleland and John M.\nMartinis, Phys Rev. B 82, 184515 (2010).\n\ngen1 G. Schaller, S. Mostame and R. Schutzhold, Phys. Rev.\nA 73, 062307 (2006)\n\ngen2 D. A. Garanin and R. Schilling, Europhys. Lett. 59, 7 (2002).\n\ngen3 D. A. Garanin and R. Schilling, Phys. Rev. B\n66, 174438 (2002).\n\ngen4 E. Torrontegui, S. Ib\u00e1\u00f1ez, S.\nMart\u00ednez-Garaot,\nM. Modugno, A. del Campo, D. Gu\u00e9ry-Odelin, A.\nRuschhaupt, Xi Chen and J. G. Muga, Adv. At. Mol. Opt. Phys. 62, 117-169\n(2013).\n\ndemirplak M. Demirplak and S. Rice, J. Phys. Chem. A 107, 9937 (2003).\n\nmotzoi F. Motzoi and F. K. Wilhelm, Phys. Rev. A\n88, 062318 (2013).(2009).\n\nsuper0 M. Berry, Proc. R. Soc. Lond. A 429, 61 (1990).\n\nsuper1 R. Lim and M.V. Berry, J. Phys. A: Math. Gen. 24, 3255 (1991).\n\nsuper2 M.V. Berry, J. Phys. A: Math. Theor. 42 365303\n\nnmrpaper A. Mitra, A.Ghosh, R. Das, A. Patel and A. Kumar, J. Mag. Res. 177, 285 (2005).\n\nsteffen M. Steffen, J. M. Martinis, I. L. Chuang, Phys.\nRev. B 68, 224518 (2003).\n\ngdef The interacting Hamiltonian is $H_\\textrm{int} = \\hbar g(|10\\rangle\\langle 01|+|01\\rangle\\langle 10|)$.  The coupling between states $|11\\rangle$ and $|02\\rangle$ is larger by approximately $\\sqrt{2}$.\n\nszpaper M. G. Bason, M. Viteau, N. Malossi, P. Huillery, E. Arimondo,\t D. Ciampini, R. Fazio, V. Giovannetti, R. Mannella and O. Morsch, Nature Physics 8, 147 (2012).\n\nqs J. Roland and N. J. Cerf, Phys. Rev. A 65,\n042308 (2002).\n\nad1 X. Cao, J. Zhuang, Z.-J. Ning and W. Zhang, Chin. Phys.\nB 22, 9, 090310 (2013).\n\ngellercz J. Ghosh, A. Galiautdinov, Z. Zhou, A. N.\nKorotkov, J. M. Martinis and M. R. Geller, Phys. Rev. A\n87, 022309 (2013).\n\nkelly J. Kelly, R. Barends, B. Campbell, Y. Chen, Z. Chen,\nB. Chiaro, A. Dunsworth, A. Fowler, I. Hoi, E. Jeffrey, A.\nMegrant, J. Mutus, C. Neill, P. O'Malley, C. Quintana, P.\nRoushan, D. Sank, A. Vainsencher, J. Wenner, T. White, A. Cleland\nand John M. Martinis, Phys. Rev. Lett. 112, 240504\n(2014).\n\ndeschamps M. Deschamps, G. Kervern, D. Massiot, G. Pintacuda, L. Emsley and P. Grandinetti, J. Chem. Phys. 129, 204110 (2008).\n\nwarren W. Warren, J. Chem. Phys. 81, 5437 (1984).\n\nfreeman R. Freeman, Prog. Nucl. Magn. Reson. Spectrosc. 32, 59 (1998).\n\nnumrec W.H. Press, S. A. Teukolsky, W. T. Vetterling and B. P. Flannery, Numerical Recipes 3rd Edition: The Art of Scientific Computing, (New York: Cambridge University Press 2007).\n\ndrag F. Motzoi, J.M. Gambetta, P. Rebentrost and F.K. Wilhelm, Phys. Rev. Lett. 103, 110501 (2009).\n\ngambetta J. M. Gambetta, F. Motzoi, S. T. Merkel and F. K.\nWilhelm, Phys. Rev. A 83, 012308 (2011).\n\nfrank F. Wilhelm, private communication.\n\nape E. Lucero, J. Kelly, R. C. Bialczak, M. Lenander, M.\nMariantoni, M. Neeley, A. D. O'Connell, D. Sank, H. Wang, M.\nWeides, J. Wenner, T. Yamamoto, A. N. Cleland and J. M. Martinis\nPhys. Rev. A 82, 042339 (2010).\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'Paper 1904.09291'?", "completion": "\n\ngraphs/\n\nequationsection\n\nfont=normalsize\n\n$$\n}\n\\def\\ee{\n$$\n$$\n}\n\\def\\eea{\n$$\n\n\u27e8\n\u27e9\n\u0142\u27e8\u27e8\n\u27e9\u030a\u27e9\u030a\n\u2110\n\nempty\n[1]\nAbstract\u2014Quantum technology has been rapidly growing due to its potential revolutionary applications. In particular, superconducting qubits provide a strong light-matter interaction as required for quantum computation and in principle can be scaled up to a high level of complexity. However, obtaining the full benefit of quantum mechanics in superconducting circuits requires a deep understanding of quantum physics in such systems in all aspects. One of the most crucial aspects is the concept of measurement and the dynamics of the quantum systems under the measurement process. This document is intended to be a pedagogical introduction to the concept of quantum measurement from an experimental perspective. We study the dynamics of a single superconducting qubit under continuous monitoring. We demonstrate that weak measurement is a versatile tool to investigate fundamental questions in quantum dynamics and quantum thermodynamics for open quantum systems.\n\n100\n\ngisin2007quantum\nNicolas Gisin and Rob Thew.\nQuantum communication.\nNature photonics, 1(3):165, 2007.\n\ndegen2017quantum\nChristian\u00a0L Degen, F\u00a0Reinhard, and P\u00a0Cappellaro.\nQuantum sensing.\nReviews of modern physics, 89(3):035002, 2017.\n\nwendin2017quantum\nG\u00a0Wendin.\nQuantum information processing with superconducting circuits: a\nreview.\nReports on Progress in Physics, 80(10):106001, 2017.\n\nrotter2015review\nIngrid Rotter and JP\u00a0Bird.\nA review of progress in the physics of open quantum systems: theory\nand experiment.\nReports on Progress in Physics, 78(11):114001, 2015.\n\nzurek1992environment\nWojciech\u00a0H Zurek.\nThe environment, decoherence, and the transition from quantum to\nclassical.\nIn Quantum Gravity And Cosmology-Proceedings Of The Xxii Gift\nInternational Seminar On Theoretical Physics, page 117. World Scientific,\n1992.\n\nmodi2012classical\nKavan Modi, Aharon Brodutch, Hugo Cable, Tomasz Paterek, and Vlatko Vedral.\nThe classical-quantum boundary for correlations: discord and related\nmeasures.\nReviews of Modern Physics, 84(4):1655, 2012.\n\ntan2016quantum\nDian Tan, Mahdi Naghiloo, Klaus M\u00f6lmer, and KW\u00a0Murch.\nQuantum smoothing for classical mixtures.\nPhysical Review A, 94(5):050102, 2016.\n\ndressel2017arrow\nJustin Dressel, Areeya Chantasri, Andrew\u00a0N Jordan, and Alexander\u00a0N Korotkov.\nArrow of time for continuous quantum measurement.\nPhysical review letters, 119(22):220507, 2017.\n\nmanikandan2018fluctuation\nSreenath\u00a0K Manikandan, Cyril Elouard, and Andrew\u00a0N Jordan.\nFluctuation theorems for continuous quantum measurement and absolute\nirreversibility.\narXiv preprint arXiv:1807.05575, 2018.\n\nharrington2018characterizing\nPM\u00a0Harrington, D\u00a0Tan, M\u00a0Naghiloo, and KW\u00a0Murch.\nCharacterizing a statistical arrow of time in quantum measurement\ndynamics.\narXiv preprint arXiv:1811.07708, 2018.\n\nvinjanampathy2016quantum\nSai Vinjanampathy and Janet Anders.\nQuantum thermodynamics.\nContemporary Physics, 57(4):545\u2013579, 2016.\n\nhouck2008controlling\nAA\u00a0Houck, JA\u00a0Schreier, BR\u00a0Johnson, JM\u00a0Chow, Jens Koch, JM\u00a0Gambetta,\nDI\u00a0Schuster, L\u00a0Frunzio, MH\u00a0Devoret, SM\u00a0Girvin, et\u00a0al.\nControlling the spontaneous emission of a superconducting transmon\nqubit.\nPhysical review letters, 101(8):080502, 2008.\n\ngladchenko2009superconducting\nSergey Gladchenko, David Olaya, Eva Dupont-Ferrier, Benoit Dou\u00e7ot, Lev\u00a0B\nIoffe, and Michael\u00a0E Gershenson.\nSuperconducting nanocircuits for topologically protected qubits.\nNature Physics, 5(1):48, 2009.\n\ngambetta2011superconducting\nJM\u00a0Gambetta, AA\u00a0Houck, and Alexandre Blais.\nSuperconducting qubit with purcell protection and tunable coupling.\nPhysical review letters, 106(3):030502, 2011.\n\nkockum2018decoherence\nAnton\u00a0Frisk Kockum, G\u00f6ran Johansson, and Franco Nori.\nDecoherence-free interaction between giant atoms in waveguide quantum\nelectrodynamics.\nPhysical review letters, 120(14):140404, 2018.\n\nningyuan2015time\nJia Ningyuan, Clai Owens, Ariel Sommer, David Schuster, and Jonathan Simon.\nTime-and site-resolved dynamics in a topological circuit.\nPhysical Review X, 5(2):021031, 2015.\n\ndempster2014understanding\nJoshua\u00a0M Dempster, Bo\u00a0Fu, David\u00a0G Ferguson, DI\u00a0Schuster, and Jens Koch.\nUnderstanding degenerate ground states of a protected quantum circuit\nin the presence of disorder.\nPhysical Review B, 90(9):094518, 2014.\n\nkelly2015state\nJulian Kelly, Rami Barends, Austin\u00a0G Fowler, Anthony Megrant, Evan Jeffrey,\nTheodore\u00a0C White, Daniel Sank, Josh\u00a0Y Mutus, Brooks Campbell, Yu\u00a0Chen, et\u00a0al.\nState preservation by repetitive error detection in a superconducting\nquantum circuit.\nNature, 519(7541):66, 2015.\n\nofek2016extending\nNissim Ofek, Andrei Petrenko, Reinier Heeres, Philip Reinhold, Zaki Leghtas,\nBrian Vlastakis, Yehan Liu, Luigi Frunzio, SM\u00a0Girvin, L\u00a0Jiang, et\u00a0al.\nExtending the lifetime of a quantum bit with error correction in\nsuperconducting circuits.\nNature, 536(7617):441, 2016.\n\ncorcoles2015demonstration\nAntonio\u00a0D C\u00f3rcoles, Easwar Magesan, Srikanth\u00a0J Srinivasan, Andrew\u00a0W Cross,\nMatthias Steffen, Jay\u00a0M Gambetta, and Jerry\u00a0M Chow.\nDemonstration of a quantum error detection code using a square\nlattice of four superconducting qubits.\nNature communications, 6:6979, 2015.\n\nreed2012realization\nMatthew\u00a0D Reed, Leonardo DiCarlo, Simon\u00a0E Nigg, Luyan Sun, Luigi Frunzio,\nSteven\u00a0M Girvin, and Robert\u00a0J Schoelkopf.\nRealization of three-qubit quantum error correction with\nsuperconducting circuits.\nNature, 482(7385):382, 2012.\n\nkorotkov2010decoherence\nAlexander\u00a0N Korotkov and Kyle Keane.\nDecoherence suppression by quantum measurement reversal.\nPhysical Review A, 81(4):040103, 2010.\n\nkim2012protecting\nYong-Su Kim, Jong-Chan Lee, Osung Kwon, and Yoon-Ho Kim.\nProtecting entanglement from decoherence using weak measurement and\nquantum measurement reversal.\nNature Physics, 8(2):117, 2012.\n\ngillett2010experimental\nGG\u00a0Gillett, RB\u00a0Dalton, BP\u00a0Lanyon, MP\u00a0Almeida, Marco Barbieri, Geoff\u00a0J Pryde,\nJL\u00a0O\u2019brien, KJ\u00a0Resch, SD\u00a0Bartlett, and AG\u00a0White.\nExperimental feedback control of quantum systems using weak\nmeasurements.\nPhysical review letters, 104(8):080503, 2010.\n\nvijay2012stabilizing\nR\u00a0Vijay, Chris Macklin, DH\u00a0Slichter, SJ\u00a0Weber, KW\u00a0Murch, Ravi Naik, Alexander\u00a0N\nKorotkov, and Irfan Siddiqi.\nStabilizing rabi oscillations in a superconducting qubit using\nquantum feedback.\nNature, 490(7418):77, 2012.\n\nsayrin2011real\nCl\u00e9ment Sayrin, Igor Dotsenko, Xingxing Zhou, Bruno Peaudecerf, Th\u00e9o\nRybarczyk, S\u00e9bastien Gleyzes, Pierre Rouchon, Mazyar Mirrahimi, Hadis\nAmini, Michel Brune, et\u00a0al.\nReal-time quantum feedback prepares and stabilizes photon number\nstates.\nNature, 477(7362):73, 2011.\n\nsorensen2003measurement\nAnders\u00a0S S\u00f8rensen and Klaus M\u00f8lmer.\nMeasurement induced entanglement and quantum computation with atoms\nin optical cavities.\nPhysical review letters, 91(9):097905, 2003.\n\nruskov2003entanglement\nRusko Ruskov and Alexander\u00a0N Korotkov.\nEntanglement of solid-state qubits by measurement.\nPhysical Review B, 67(24):241305, 2003.\n\nroch2014observation\nNicolas Roch, Mollie\u00a0E Schwartz, Felix Motzoi, Christopher Macklin, Rajamani\nVijay, Andrew\u00a0W Eddins, Alexander\u00a0N Korotkov, K\u00a0Birgitta Whaley, Mohan\nSarovar, and Irfan Siddiqi.\nObservation of measurement-induced entanglement and quantum\ntrajectories of remote superconducting qubits.\nPhysical review letters, 112(17):170501, 2014.\n\nmurch2013observing\nKW\u00a0Murch, SJ\u00a0Weber, Christopher Macklin, and Irfan Siddiqi.\nObserving single quantum trajectories of a superconducting quantum\nbit.\nNature, 502(7470):211, 2013.\n\nhacohen2016quantum\nShay Hacohen-Gourgy, Leigh\u00a0S Martin, Emmanuel Flurin, Vinay\u00a0V Ramasesh,\nK\u00a0Birgitta Whaley, and Irfan Siddiqi.\nQuantum dynamics of simultaneously measured non-commuting\nobservables.\nNature, 538(7626):491, 2016.\n\nforoozani2016correlations\nN\u00a0Foroozani, M\u00a0Naghiloo, D\u00a0Tan, K\u00a0M\u00f8lmer, and KW\u00a0Murch.\nCorrelations of the time dependent signal and the state of a\ncontinuously monitored quantum system.\nPhysical review letters, 116(11):110401, 2016.\n\nnaghiloo2016mapping\nMahdi Naghiloo, N\u00a0Foroozani, Dian Tan, A\u00a0Jadbabaie, and KW\u00a0Murch.\nMapping quantum state dynamics in spontaneous emission.\nNature communications, 7:11527, 2016.\n\nweber2014mapping\nSJ\u00a0Weber, Areeya Chantasri, Justin Dressel, Andrew\u00a0N Jordan, KW\u00a0Murch, and\nIrfan Siddiqi.\nMapping the optimal route between two quantum states.\nNature, 511(7511):570, 2014.\n\nnaghiloo2017quantum\nM\u00a0Naghiloo, D\u00a0Tan, PM\u00a0Harrington, P\u00a0Lewalle, AN\u00a0Jordan, and KW\u00a0Murch.\nQuantum caustics in resonance-fluorescence trajectories.\nPhysical Review A, 96(5):053807, 2017.\n\ncujia2018watching\nKS\u00a0Cujia, JM\u00a0Boss, J\u00a0Zopes, and CL\u00a0Degen.\nWatching the precession of a single nuclear spin by weak\nmeasurements.\narXiv preprint arXiv:1806.08243, 2018.\n\nnaghiloo2017achieving\nM\u00a0Naghiloo, AN\u00a0Jordan, and KW\u00a0Murch.\nAchieving optimal quantum acceleration of frequency estimation using\nadaptive coherent control.\nPhysical review letters, 119(18):180801, 2017.\n\nkiilerich2016bayesian\nAlexander\u00a0Holm Kiilerich and Klaus M\u00f8lmer.\nBayesian parameter estimation by continuous homodyne detection.\nPhysical Review A, 94(3):032103, 2016.\n\nnaghiloo2017thermodynamics\nM\u00a0Naghiloo, D\u00a0Tan, PM\u00a0Harrington, JJ\u00a0Alonso, E\u00a0Lutz, A\u00a0Romito, and KW\u00a0Murch.\nThermodynamics along individual trajectories of a quantum bit.\narXiv preprint arXiv:1703.05885, 2017.\n\nbrandao2015second\nFernando Brandao, Michal Horodecki, Nelly Ng, Jonathan Oppenheim, and Stephanie\nWehner.\nThe second laws of quantum thermodynamics.\nProceedings of the National Academy of Sciences,\n112(11):3275\u20133279, 2015.\n\ntoyabe2010experimental\nShoichi Toyabe, Takahiro Sagawa, Masahito Ueda, Eiro Muneyuki, and Masaki Sano.\nExperimental demonstration of information-to-energy conversion and\nvalidation of the generalized jarzynski equality.\nNature physics, 6(12):988, 2010.\n\ngogolin2016equilibration\nChristian Gogolin and Jens Eisert.\nEquilibration, thermalisation, and the emergence of statistical\nmechanics in closed quantum systems.\nReports on Progress in Physics, 79(5):056001, 2016.\n\nparrondo2015thermodynamics\nJuan\u00a0MR Parrondo, Jordan\u00a0M Horowitz, and Takahiro Sagawa.\nThermodynamics of information.\nNature physics, 11(2):131, 2015.\n\nnaghiloo2018information\nM\u00a0Naghiloo, JJ\u00a0Alonso, A\u00a0Romito, E\u00a0Lutz, and KW\u00a0Murch.\nInformation gain and loss for a quantum maxwell's demon.\narXiv preprint arXiv:1802.07205, 2018.\n\nkurizki2015quantum\nGershon Kurizki, Patrice Bertet, Yuimaru Kubo, Klaus M\u00f8lmer, David\nPetrosyan, Peter Rabl, and J\u00f6rg Schmiedmayer.\nQuantum technologies with hybrid systems.\nProceedings of the National Academy of Sciences, page\n201419326, 2015.\n\nmurch2012cavity\nKW\u00a0Murch, U\u00a0Vool, D\u00a0Zhou, SJ\u00a0Weber, SM\u00a0Girvin, and I\u00a0Siddiqi.\nCavity-assisted quantum bath engineering.\nPhysical review letters, 109(18):183602, 2012.\n\nharrington2018bath\nPM\u00a0Harrington, Mahdi Naghiloo, D\u00a0Tan, and KW\u00a0Murch.\nBath engineering of a fluorescing artificial atom with a photonic\ncrystal.\narXiv preprint arXiv:1812.04205, 2018.\n\nel2018non\nRamy El-Ganainy, Konstantinos\u00a0G Makris, Mercedeh Khajavikhan, Ziad\u00a0H\nMusslimani, Stefan Rotter, and Demetrios\u00a0N Christodoulides.\nNon-hermitian physics and pt symmetry.\nNature Physics, 14(1):11, 2018.\n\npeng2014parity\nBo\u00a0Peng, \u015eahin\u00a0Kaya \u00d6zdemir, Fuchuan Lei, Faraz Monifi, Mariagiovanna\nGianfreda, Gui\u00a0Lu Long, Shanhui Fan, Franco Nori, Carl\u00a0M Bender, and Lan\nYang.\nParity\u2013time-symmetric whispering-gallery microcavities.\nNature Physics, 10(5):394, 2014.\n\nchen2017exceptional\nWeijian Chen, \u015eahin\u00a0Kaya \u00d6zdemir, Guangming Zhao, Jan Wiersig, and\nLan Yang.\nExceptional points enhance sensing in an optical microcavity.\nNature, 548(7666):192, 2017.\n\nbender2016pt\nCarl\u00a0M Bender.\nPt symmetry in quantum physics: From a mathematical curiosity to\noptical experiments.\nEurophysics News, 47(2):17\u201320, 2016.\n\nbender2017behavior\nCarl\u00a0M Bender, Nima Hassanpour, Daniel\u00a0W Hook, SP\u00a0Klevansky, Christoph\nS\u00fcnderhauf, and Zichao Wen.\nBehavior of eigenvalues in a region of broken pt symmetry.\nPhysical Review A, 95(5):052113, 2017.\n\nbender2016comment\nCarl\u00a0M Bender, Mariagiovanna Gianfreda, Nima Hassanpour, and Hugh\u00a0F Jones.\nComment on \u201con the lagrangian and hamiltonian description of the\ndamped linear harmonic oscillator\u201d[j. math. phys. 48, 032701 (2007)].\nJournal of Mathematical Physics, 57(8):084101, 2016.\n\nbender2018series\nCarl\u00a0M Bender, C\u00a0Ford, Nima Hassanpour, and B\u00a0Xia.\nSeries solutions of pt-symmetric schr\u00f6dinger equations.\nJournal of Physics Communications, 2(2), 2018.\n\nbender2016analytic\nCarl\u00a0M Bender, Alexander Felski, Nima Hassanpour, SP\u00a0Klevansky, and Alireza\nBeygi.\nAnalytic structure of eigenvalues of coupled quantum systems.\nPhysica Scripta, 92(1):015201, 2016.\n\nbender2018p\nCarl\u00a0M Bender, Nima Hassanpour, SP\u00a0Klevansky, and Sarben Sarkar.\nP t-symmetric quantum field theory in d dimensions.\nPhysical Review D, 98(12):125003, 2018.\n\nbender2018pt\nCarl\u00a0M Bender.\nPT Symmetry: In Quantum and Classical Physics.\nWorld Scientific Publishing, 2018.\n\nnaghiloo2019quantum\nM\u00a0Naghiloo, M\u00a0Abbasi, Yogesh\u00a0N Joglekar, and KW\u00a0Murch.\nQuantum state tomography across the exceptional point in a single\ndissipative qubit.\narXiv preprint arXiv:1901.07968, 2019.\n\nmalek17cutoff\nMoein Malekakhlagh, Alexandru Petrescu, and Hakan\u00a0E T\u00fcreci.\nCutoff-free circuit quantum electrodynamics.\nPhysical review letters, 119(7):073601, 2017.\n\ngely17converg\nMario\u00a0F Gely, Adrian Parra-Rodriguez, Daniel Bothner, Ya\u00a0M Blanter, Sal\u00a0J\nBosman, Enrique Solano, and Gary\u00a0A Steele.\nConvergence of the multimode quantum rabi model of circuit quantum\nelectrodynamics.\nPhysical Review B, 95(24):245115, 2017.\n\ngerr05\nChristopher Gerry, Peter Knight, and Peter\u00a0L Knight.\nIntroductory quantum optics.\nCambridge university press, 2005.\n\nwalls2007quantum\nDaniel\u00a0F Walls and Gerard\u00a0J Milburn.\nQuantum optics.\nSpringer Science & Business Media, 2007.\n\nhouck2007generating\nAA\u00a0Houck, DI\u00a0Schuster, JM\u00a0Gambetta, JA\u00a0Schreier, BR\u00a0Johnson, JM\u00a0Chow,\nL\u00a0Frunzio, J\u00a0Majer, MH\u00a0Devoret, SM\u00a0Girvin, et\u00a0al.\nGenerating single microwave photons in a circuit.\nNature, 449(7160):328, 2007.\n\nschu07thesis\nDavid\u00a0Isaac Schuster.\nCircuit quantum electrodynamics.\nYale University, 2007.\n\ntinkham2004introduction\nMichael Tinkham.\nIntroduction to superconductivity.\nCourier Corporation, 2004.\n\ndevoret2004shortreviwe\nMichel\u00a0H Devoret, Andreas Wallraff, and John\u00a0M Martinis.\nSuperconducting qubits: A short review.\narXiv preprint cond-mat/0411174, 2004.\n\nkhezri26beyand\nMostafa Khezri, Eric Mlinar, Justin Dressel, and Alexander\u00a0N. Korotkov.\nMeasuring a transmon qubit in circuit qed: Dressed squeezed states.\nPhys. Rev. A, 94:012347, Jul 2016.\n\nsank16beyond\nDaniel Sank, Zijun Chen, Mostafa Khezri, J.\u00a0Kelly, R.\u00a0Barends, B.\u00a0Campbell,\nY.\u00a0Chen, B.\u00a0Chiaro, A.\u00a0Dunsworth, A.\u00a0Fowler, E.\u00a0Jeffrey, E.\u00a0Lucero,\nA.\u00a0Megrant, J.\u00a0Mutus, M.\u00a0Neeley, C.\u00a0Neill, P.\u00a0J.\u00a0J. O'Malley, C.\u00a0Quintana,\nP.\u00a0Roushan, A.\u00a0Vainsencher, T.\u00a0White, J.\u00a0Wenner, Alexander\u00a0N. Korotkov, and\nJohn\u00a0M. Martinis.\nMeasurement-induced state transitions in a superconducting qubit:\nBeyond the rotating wave approximation.\nPhys. Rev. Lett., 117:190503, Nov 2016.\n\nniemczyk2010circuit\nThomas Niemczyk, F\u00a0Deppe, H\u00a0Huebl, EP\u00a0Menzel, F\u00a0Hocke, MJ\u00a0Schwarz,\nJJ\u00a0Garcia-Ripoll, D\u00a0Zueco, T\u00a0H\u00fcmmer, E\u00a0Solano, et\u00a0al.\nCircuit quantum electrodynamics in the ultrastrong-coupling regime.\nNature Physics, 6(10):772, 2010.\n\nbosman2017multi\nSal\u00a0J Bosman, Mario\u00a0F Gely, Vibhor Singh, Alessandro Bruno, Daniel Bothner, and\nGary\u00a0A Steele.\nMulti-mode ultra-strong coupling in circuit quantum electrodynamics.\nnpj Quantum Information, 3(1):46, 2017.\n\nkoch2007charge\nJens Koch, M\u00a0Yu Terri, Jay Gambetta, Andrew\u00a0A Houck, DI\u00a0Schuster, J\u00a0Majer,\nAlexandre Blais, Michel\u00a0H Devoret, Steven\u00a0M Girvin, and Robert\u00a0J Schoelkopf.\nCharge-insensitive qubit design derived from the cooper pair box.\nPhysical Review A, 76(4):042319, 2007.\n\npozar\nDavid\u00a0M Pozar.\nMicrowave engineering.\nJohn Wiley & Sons, 2009.\n\nmegrant2012planar\nAnthony Megrant, Charles Neill, Rami Barends, Ben Chiaro, Yu\u00a0Chen, Ludwig\nFeigl, Julian Kelly, Erik Lucero, Matteo Mariantoni, Peter\u00a0JJ O\u2019Malley,\net\u00a0al.\nPlanar superconducting resonators with internal quality factors above\none million.\nApplied Physics Letters, 100(11):113510, 2012.\n\nkhalil2012analysis\nMS\u00a0Khalil, MJA Stoutimore, FC\u00a0Wellstood, and KD\u00a0Osborn.\nAn analysis method for asymmetric resonator transmission applied to\nsuperconducting devices.\nJournal of Applied Physics, 111(5):054510, 2012.\n\nreed2010\nM.\u00a0D. Reed, L.\u00a0DiCarlo, B.\u00a0R. Johnson, L.\u00a0Sun, D.\u00a0I. Schuster, L.\u00a0Frunzio, and\nR.\u00a0J. Schoelkopf.\nHigh-fidelity readout in circuit quantum electrodynamics using the\njaynes-cummings nonlinearity.\nPhys. Rev. Lett., 105:173601, Oct 2010.\n\nslichterthesis\nDaniel\u00a0Huber Slichter.\nQuantum jumps and measurement backaction in a superconducting qubit.\nUniversity of California, Berkeley, 2011.\n\ndrummond2013quantum\nPeter\u00a0D Drummond and Zbigniew Ficek.\nQuantum squeezing, volume\u00a027.\nSpringer Science & Business Media, 2013.\n\ngambetta2008quantum\nJay Gambetta, Alexandre Blais, Maxime Boissonneault, Andrew\u00a0A Houck,\nDI\u00a0Schuster, and Steven\u00a0M Girvin.\nQuantum trajectory approach to circuit qed: Quantum jumps and the\nzeno effect.\nPhysical Review A, 77(1):012112, 2008.\n\njaco06\nKurt Jacobs and Daniel\u00a0A Steck.\nA straightforward introduction to continuous quantum measurement.\nContemporary Physics, 47(5):279\u2013303, 2006.\n\nbrun2000continuous\nTodd\u00a0A Brun.\nContinuous measurements, quantum trajectories, and decoherent\nhistories.\nPhysical Review A, 61(4):042107, 2000.\n\nkoro11_bayes\nAlexander\u00a0N Korotkov.\nQuantum bayesian approach to circuit qed measurement.\narXiv preprint arXiv:1111.4016, 2011.\n\ntan2017homodyne\nDian Tan, Neda Foroozani, Mahdi Naghiloo, AH\u00a0Kiilerich, K\u00a0M\u00f8lmer, and\nKW\u00a0Murch.\nHomodyne monitoring of postselected decay.\nPhysical Review A, 96(2):022104, 2017.\n\nmilonni1984spontaneous\nPW\u00a0Milonni.\nWhy spontaneous emission?\nAmerican Journal of Physics, 52(4):340\u2013343, 1984.\n\nblinov2004observation\nBB\u00a0Blinov, DL\u00a0Moehring, L-M Duan, and Chris Monroe.\nObservation of entanglement between a single trapped atom and a\nsingle photon.\nNature, 428(6979):153, 2004.\n\neichler2012observation\nC\u00a0Eichler, C\u00a0Lang, JM\u00a0Fink, J\u00a0Govenius, S\u00a0Filipp, and A\u00a0Wallraff.\nObservation of entanglement between itinerant microwave photons and a\nsuperconducting qubit.\nPhysical review letters, 109(24):240501, 2012.\n\nwiseman2009quantum\nHoward\u00a0M Wiseman and Gerard\u00a0J Milburn.\nQuantum measurement and control.\nCambridge university press, 2009.\n\nwiseman2012dynamical\nHoward\u00a0M Wiseman and Jay\u00a0M Gambetta.\nAre dynamical quantum jumps detector dependent?\nPhysical review letters, 108(22):220402, 2012.\n\nbolund2014stochastic\nAnders Bolund and Klaus M\u00f8lmer.\nStochastic excitation during the decay of a two-level emitter subject\nto homodyne and heterodyne detection.\nPhysical Review A, 89(2):023827, 2014.\n\njordan2016anatomy\nAndrew\u00a0N Jordan, Areeya Chantasri, Pierre Rouchon, and Benjamin Huard.\nAnatomy of fluorescence: quantum trajectory statistics from\ncontinuously measuring spontaneous emission.\nQuantum Studies: Mathematics and Foundations, 3(3):237\u2013263,\n2016.\n\ncampagne2016observing\nPhilippe Campagne-Ibarcq, Pierre Six, Landry Bretheau, Alain Sarlette, Mazyar\nMirrahimi, Pierre Rouchon, and Benjamin Huard.\nObserving quantum state diffusion by heterodyne detection of\nfluorescence.\nPhysical Review X, 6(1):011002, 2016.\n\ndalibard1992wave\nJean Dalibard, Yvan Castin, and Klaus M\u00f8lmer.\nWave-function approach to dissipative processes in quantum optics.\nPhysical review letters, 68(5):580, 1992.\n\nblocher2017many\nPhilip\u00a0Daniel Blocher and Klaus M\u00f8lmer.\nHow many atoms get excited when they decay?\nQuantum Science and Technology, 2(3):034011, 2017.\n\ncaves1982quantum\nCarlton\u00a0M Caves.\nQuantum limits on noise in linear amplifiers.\nPhysical Review D, 26(8):1817, 1982.\n\nlewalle2017prediction\nPhilippe Lewalle, Areeya Chantasri, and Andrew\u00a0N Jordan.\nPrediction and characterization of multiple extremal paths in\ncontinuously monitored qubits.\nPhysical Review A, 95(4):042126, 2017.\n\ncollin2005verification\nDelphine Collin, Felix Ritort, Christopher Jarzynski, Steven\u00a0B Smith, Ignacio\nTinoco\u00a0Jr, and Carlos Bustamante.\nVerification of the crooks fluctuation theorem and recovery of rna\nfolding free energies.\nNature, 437(7056):231, 2005.\n\njarzynski1997nonequilibrium\nChristopher Jarzynski.\nNonequilibrium equality for free energy differences.\nPhysical Review Letters, 78(14):2690, 1997.\n\nliphardt2002equilibrium\nJan Liphardt, Sophie Dumont, Steven\u00a0B Smith, Ignacio Tinoco, and Carlos\nBustamante.\nEquilibrium information from nonequilibrium measurements in an\nexperimental test of jarzynski's equality.\nScience, 296(5574):1832\u20131835, 2002.\n\nserreli2007molecular\nViviana Serreli, Chin-Fa Lee, Euan\u00a0R Kay, and David\u00a0A Leigh.\nA molecular information ratchet.\nNature, 445(7127):523, 2007.\n\nraizen2009comprehensive\nMark\u00a0G Raizen.\nComprehensive control of atomic motion.\nScience, 324(5933):1403\u20131406, 2009.\n\nkoski2014experimental\nJonne\u00a0V Koski, Ville\u00a0F Maisi, Takahiro Sagawa, and Jukka\u00a0P Pekola.\nExperimental observation of the role of mutual information in the\nnonequilibrium dynamics of a maxwell demon.\nPhysical review letters, 113(3):030601, 2014.\n\ncamati2016experimental\nPatrice\u00a0A Camati, John\u00a0PS Peterson, Tiago\u00a0B Batalhao, Kaonan Micadei,\nAlexandre\u00a0M Souza, Roberto\u00a0S Sarthour, Ivan\u00a0S Oliveira, and Roberto\u00a0M Serra.\nExperimental rectification of entropy production by maxwell\u2019s demon\nin a quantum system.\nPhysical review letters, 117(24):240502, 2016.\n\ncottet2017observing\nNathana\u00ebl Cottet, Sebastien Jezouin, Landry Bretheau, Philippe\nCampagne-Ibarcq, Quentin Ficheux, Janet Anders, Alexia Auff\u00e8ves, R\u00e9mi\nAzouit, Pierre Rouchon, and Benjamin Huard.\nObserving a quantum maxwell demon at work.\nProceedings of the National Academy of Sciences,\n114(29):7561\u20137564, 2017.\n\nciampini2017experimental\nMario\u00a0A Ciampini, Luca Mancino, Adeline Orieux, Caterina Vigliar, Paolo\nMataloni, Mauro Paternostro, and Marco Barbieri.\nExperimental extractable work-based multipartite separability\ncriteria.\nNPJ Quantum Information, 3(1):10, 2017.\n\nmasuyama2018information\nY\u00a0Masuyama, K\u00a0Funo, Y\u00a0Murashita, A\u00a0Noguchi, S\u00a0Kono, Y\u00a0Tabuchi, R\u00a0Yamazaki,\nM\u00a0Ueda, and Y\u00a0Nakamura.\nInformation-to-work conversion by maxwell\u2019s demon in a\nsuperconducting circuit quantum electrodynamical system.\nNature communications, 9(1):1291, 2018.\n\ntalkner2007fluctuation\nPeter Talkner, Eric Lutz, and Peter H\u00e4nggi.\nFluctuation theorems: Work is not an observable.\nPhysical Review E, 75(5):050102, 2007.\n\nlutz2015maxwell\nEric Lutz and Sergio Ciliberto.\nFrom maxwell\u2019s demon to landauer\u2019s eraser.\nPhysics Today, 68(9):30, 2015.\n\nfuno2013integral\nKen Funo, Yu\u00a0Watanabe, and Masahito Ueda.\nIntegral quantum fluctuation theorems under measurement and feedback\ncontrol.\nPhysical Review E, 88(5):052121, 2013.\n\ntocchapterBibliography\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'Paper 0909.5368'?", "completion": "\n\n"}
{"prompt": "What are the key contributions of the paper 'Paper 2112.03708'?", "completion": "\n\nfigureFig.Figs.\ntableTab.Tabs.\n\nY>X\ndc\nac\n\n\u0131\n\nprintendnotes\n\nNTprintendnotes\n\nlist-name=Methods, mark-cs=\n\n#\nThese authors contributed equally to this work.\n\nThese authors contributed equally to this work.\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nInstitut Quantique and D\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke J1K2R1 Qu\u00e9bec, Canada\n\nInstitut Quantique and D\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke J1K2R1 Qu\u00e9bec, Canada\n\nInstitut Quantique and D\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke J1K2R1 Qu\u00e9bec, Canada\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nCurrent affiliation: QuTech and Kavli Institute for Nanoscience, Delft University of Technology, Delft 2628 CJ, Netherlands\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nInstitute for Quantum Information, RWTH Aachen University, Aachen D-52056, Germany\nPeter Gr\u00fcnberg Institute, Theoretical Nanoelectronics, Forschungszentrum J\u00fclich, J\u00fclich D-52425, Germany\n\nInstitut Quantique and D\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke J1K2R1 Qu\u00e9bec, Canada\nCanadian Institute for Advanced Research, Toronto, ON, Canada\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\n\nDepartment of Physics, ETH Zurich, CH-8093 Zurich, Switzerland\nQuantum Center, ETH Zurich, 8093 Zurich, Switzerland\n\nQuantum computers hold the promise of solving computational problems which are intractable using conventional methods [Unknown Author, \"Unknown Title\", ].\nFor fault-tolerant operation quantum computers must correct errors occurring due to unavoidable decoherence and limited control accuracy\u00a0[Unknown Author, \"Unknown Title\", ].\nHere, we demonstrate quantum error correction using the surface code, which is known for its exceptionally high tolerance to errors [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nUsing 17 physical qubits in a superconducting circuit we encode quantum information in a distance-three logical qubit building up on recent distance-two error detection experiments [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nIn an error correction cycle taking only $1.1\\,$\u00b5s, we demonstrate the preservation of four cardinal states of the logical qubit.\nRepeatedly executing the cycle, we measure and decode both bit- and phase-flip error syndromes using a minimum-weight perfect-matching algorithm in an error-model-free approach and apply corrections in postprocessing.\nWe find a low error probability of $3\\,\\%$ per cycle when rejecting experimental runs in which leakage is detected.\nThe measured characteristics of our device agree well with a numerical model.\nOur demonstration of repeated, fast and high-performance quantum error correction cycles, together with recent advances in ion traps [Unknown Author, \"Unknown Title\", ], support our understanding that fault-tolerant quantum computation will be practically realizable.\n\nThe surface code [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] is a planar realization of Kitaev's toric code [Unknown Author, \"Unknown Title\", ] which uses topological features of a qubit lattice to correct errors in quantum information processing systems.\nThis code is a prominent contender to reach fault-tolerant quantum computation because of its high error threshold of about $1\\,\\%$ against quantum circuit noise [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and its compatibility with 2D architectures.\nThe surface code belongs to the family of stabilizer codes [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] which encode quantum information into a joint subspace of definite parities on a set of physical data qubits to form a logical qubit. Errors are detected using measurements of auxiliary qubits to extract parity information without collapsing the logical qubit state.\nThe fault-tolerant operation of a quantum computer requires repeated detection and correction of both bit- and phase-flip errors on data qubits. With an increasing number of physical qubits and thus an increasing code distance $d$ the number of errors $\\lfloor (d-1)/2 \\rfloor$ which can at least be detected and corrected per error-correction cycle increases, making the code more resilient when error rates are sufficiently low.\n\nError correction limited to a single type of error has been realized with repetition codes in nuclear magnetic resonance [Unknown Author, \"Unknown Title\", ], trapped ions [Unknown Author, \"Unknown Title\", ], nitrogen-vacancy centers [Unknown Author, \"Unknown Title\", ] and superconducting circuits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In single-cycle experiments, fault-tolerant stabilizer measurements and correction of both types of errors have been demonstrated with the five-qubit code and the Bacon-Shor code [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Recently, error detection in a distance-two surface code has been realized with seven qubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and only very recently, repeated stabilizer-based error correction has been demonstrated with a distance-three color code in a trapped ion system [Unknown Author, \"Unknown Title\", ].\n\nCorrection of both bit- and phase-flip errors requires at least a distance-three code. In combination with fault-tolerant circuits for error syndrome measurements, this guarantees that any single error on any of the constituent data and auxiliary qubits or operations can be corrected [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nWhile the work we discuss here focuses on digital encoding of quantum information, continuous variable encoding, for example in harmonic oscillator states, constitutes an alternative approach to quantum error correction\u00a0(QEC), see for example Refs.\u00a0Ofek2016, Hu2019a, Fluehmann2019, CampagneIbarcq2020.\n\nA DISTANCE-THREE SURFACE CODE IN SUPERCONDUCTING CIRCUITS\n\n< g r a p h i c s >\n\nDevice concept, architecture and performance.\na\u00a0Conceptual representation of the distance-three surface code consisting of data qubits (red circles), Z-type (green circles) and X-type auxiliary qubits (blue circles), with their connectivity indicated by gray lines. The data qubits participating in the weight-three logical operators $\\lopz$ and $\\lopx$ are indicated by solid black lines. Green (blue) plaquettes indicate X-type (Z-type) stabilizer circuits.\nb\u00a0False-color micrograph of the device realizing the concept in a with 17 transmon qubits, see legend for circuit elements and text for details. The qubit lattice is rotated by 45 degrees with respect to  a. c\u00a0Frequency arrangement in three distinct bands for idling data qubits (red circles),  idling Z/X-type auxiliary qubits (green/blue circles), and readout resonators (violet open circles). The qubit-frequency tuning ranges are indicated by vertical bars.\nd\u00a0Cumulative distributions (integrated histograms) of single-qubit gate (pink), simultaneous two-qubit gate (cyan), two-state (red) and three-state readout errors (light red).\n\nExperimentally realizing a distance-three surface code requires nine data qubits and eight auxiliary qubits, also referred to in the literature as ancilla or measurement qubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The qubits are arranged in a diagonal, planar square lattice, the edges of which are shown in gray in the schematic Fig.\u00a0(Figure fig:device)a. The data qubits D$j$,\u00a0$j=1 \\ldots 9$, (red dots) form a $3\\times 3$ array and are interlaced with auxiliary qubits $Ai$, labeled X$i$ (blue) and Z$i$,\u00a0$i=1 \\ldots 4$ (green). We realized this  arrangement in a superconducting circuit using 17 transmon qubits [Unknown Author, \"Unknown Title\", ] (yellow) capacitively coupled to each other along the edges of the square array with $\\sim 1$\u00a0mm long coplanar waveguide segments (turquoise), see Fig.\u00a0(Figure fig:device)b. We discuss the fabrication of this device in <ref>.\n\nUsing the auxiliary qubits X$i$ and Z$i$ we measure the parity of the neighboring two or four data qubits D$j$, which are located at the vertices of the blue and green plaquettes, in the X or Z basis (Fig.\u00a0(Figure fig:device)a,b).\nIn a Z-basis measurement, if an odd number of the data qubits involved in the parity operator under consideration is in the $|1\\rangle$-state the auxiliary qubit state is flipped. On the other hand, if an even number of data qubits is in  $|1\\rangle$ the auxiliary qubit state remains unchanged. The equivalent is true in the X basis for an even or odd number of data qubits in the $|-\\rangle$-state. Here, $|0\\rangle$, $|1\\rangle$ are the transmon qubit ground and first excited states, and $|\\pm\\rangle=\\left(|0\\rangle \\pm |1\\rangle\\right)/\\sqrt{2}$ are their superpositions.\nTo map the parity of the data qubits D$j$ onto the corresponding auxiliary qubit, we effectively use a sequence of controlled-not gates with the data qubits as control and the auxiliary qubit as target, and subsequently measure the state of the auxiliary qubit in the Z basis using single-shot readout. In the Z basis, a single bit-flip error of any individual data qubit leads to a change of parity, as does a single phase-flip in the X basis. Hence, measurements of changes of data-qubit parities allow us to detect and identify phase-flip or bit-flip errors as long as they occur sufficiently rarely [Unknown Author, \"Unknown Title\", ].\nThese parity measurements are also referred to as stabilizer measurements [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The corresponding mutually-commuting weight-two (or weight-four) stabilizer operators $\\sx{i} = \\prod_{j=1}^{2(4)}\\px_j$ and $\\sz{i} = \\prod_{j=1}^{2(4)}\\pz_j$ of the surface code are products of two (or four) Pauli-$\\px$ or -$\\pz$ operators of the data qubits $j$ located at the vertices of a given data-qubit plaquette. Measurement outcomes $s^{Ai} = \\pm 1$ of individual stabilizers $\\sai$ are extracted from the observed change of auxiliary qubit state from one cycle to the next and indicate even or odd parity, respectively.\n\nIn our experiments, the stabilizer gate sequence is realized as two or four controlled-phase (CZ) gates [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (see Methods <ref>) between data and auxiliary qubits, operated in a high and a low frequency band (see Fig.\u00a0(Figure fig:device)c), respectively, combined with initial and final $\\pi/2$-rotations on the auxiliary qubits (Fig.\u00a0(Figure fig:stabilizer)a,b). The gate sequence for measuring $\\sx{i}$ contains additional initial and final $\\pi/2$-rotations acting on the data qubits, implementing a basis change from the Z to the X basis (blue dashed squares in Fig.\u00a0(Figure fig:stabilizer)a and b). We apply echo pulses to the data qubits in the middle of the gate sequence to reduce dephasing of the data qubits and residual coherent coupling to spectator qubits\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe 24 pairwise  have a mean duration of $98(7)~$ns, including two conservatively chosen 15-ns-long buffers at the beginning and the end, and display a mean gate error of 0.015(10). The gate error histogram, displayed as an integrated (cumulative) distribution,\nshows variations of about a factor of four in two-qubit gate error (Fig\u00a0(Figure fig:device)d). We determine the two-qubit gate error from interleaved randomized benchmarking experiments with sets of three gates executed in parallel, as employed in our realization of the surface code cycle. Time-varying microscopic defects in our device have a detrimental influence on two-qubit gate performance and are responsible for outliers in the gate error distribution (<ref>).\nSingle-qubit gates displaying a mean error of 0.0009(4) are realized by applying short resonant microwave pulses to each qubit individually through a dedicated drive line (pink coplanar waveguide in Fig.\u00a0(Figure fig:device)b). We determined the single-qubit gate fidelities in randomized benchmarking experiments. We discuss the experimental setup used to realize these gates in <ref>.\n\nA key element of individual stabilizer measurements are fast and high-fidelity measurements of auxiliary qubit states while leaving data qubit states unaffected [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (see Methods <ref>).\nAccurate stabilizer measurements using mid-cycle qubit readout on timescales comparable to or shorter than the cumulated gate times per error correction cycle also contribute to maximizing the performance of error detection and correction in our surface code implementation as a whole.\n\nWith our readout scheme we discriminate the two computational qubit states and a leakage state, which if undetected or uncorrected for is detrimental to any surface code implementation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. We achieve a mean readout assignment error of $0.009(7)$ when discriminating the computational states only (two-state readout) and of $0.022(14)$ when discriminating the computational states and the leakage state (three-state readout), see <ref>. The corresponding cumulative distribution for two-state readout exhibits performance variations on the device of about a factor of two when disregarding two outliers, while the distribution for three-state readout shows variations larger by about a factor of two (Fig\u00a0(Figure fig:device)d).\n\nWith all elements in place for realizing a surface code, we first characterize the measurements of individual $\\sai$ stabilizers. To do so we prepare the data qubits D$j$ of a given weight-two or weight-four plaquette sequentially in each one of its $2^2=4$ or $2^4=16$ basis states composed of $|0\\rangle$ and $|1\\rangle$ for $\\sz{i}$ and $|+\\rangle$ and $|-\\rangle$ for $\\sx{i}$.\nIn the beginning of each experiment all qubits are initialized by heralding the ground state $|0\\rangle$ from single-shot readout.\n\nFor each input state, we compute the mean values $\\overline{s}^{Ai}$ from $\\sim 4\\times 10^4$ measurements of $s^{Ai}$ (colored bars in Fig.\u00a0(Figure fig:stabilizer)c) and find good qualitative agreement with master equation simulations (red outlines), see Appendices\u00a0<ref> and <ref> for details. Here, $+1/-1$ indicate even/odd parity of the measured state. The colored percentage values display the corresponding experimental and simulated errors of the stabilizer measurements. We attribute the differences between measurements and simulation mostly to two-qubit gate errors due to microscopic defect modes changing their frequency on timescales of hours or days (Appendix\u00a0<ref>).\n\nHaving verified that all stabilizer measurements perform at high quality levels individually, we combine the stabilizer measurements into a surface code cycle. Executing this cycle once, we prepare one of the four cardinal logical qubit states. Executing the cycle multiple times, we stabilize the logical states and investigate the performance of our realization of the code.\n\n< g r a p h i c s >\n\nStabilizer circuits and their characterization.\nQuantum circuit diagrams for a\u00a0weight-two and b\u00a0weight-four stabilizers acting between data qubits located on the vertices of a plaquette (red circles) and the corresponding auxiliary qubit used for Z-type (green) or X-type (blue circle) stabilizer measurements, where the latter require a basis change (dashed-blue squares), see text for details.\nc\u00a0Measured (filled bars), and simulated (red wireframes) average stabilizer values $\\overline{s}^{Ai}$ versus data qubit input state, ordered by number of excitations. Percentages are the experimental (blue, green) and simulated (red) error of $\\overline{s}^{Ai}$. Gray background indicates odd and white even parity.\n\nTHE SURFACE CODE CYCLE AND STATE INITIALIZATION\n\nAt the beginning of each experimental sequence, we\nprepare the nine data qubits in either one of the product states $\\ket{0}^{\\otimes 9}$ and $\\lopx{}\\ket{0}^{\\otimes 9}$ ($\\ket{+}^{\\otimes 9}$ and $\\lopz{}\\ket{+}^{\\otimes 9}$)\nto begin the process of initializing the cardinal logical qubit states $\\lz$ and $\\lo$ ($\\lp$ and $\\lm$). The cardinal states are eigenstates of the eight stabilizer operators $\\sai$ and $\\pm 1$ eigenstates of the logical Pauli operators which we choose as $\\lopz = \\pz_1\\pz_2\\pz_3$ and $\\lopx = \\px_1\\px_4\\px_7$, see solid black lines in Fig.\u00a0(Figure fig:device)a. As required, $\\lopz$ and $\\lopx$ commute with all stabilizers and anti-commute with each other.\nSince each of the prepared product states is an equal superposition of $16$ equivalent instances of the target logical state, executing a single quantum error correction cycle once deterministically initializes the target logical state in the stabilizer eigenspace corresponding to the measurement outcome of the stabilizers (<ref>).\n\nIn a single surface code cycle, we first execute all gate operations implementing the four $\\sz{i}$ stabilizer measurements. We realize the necessary two-qubit gates in four time steps in each of which we execute three CZ gates simultaneously.  Parallelizing stabilizer execution is a key technical requisite for scalable quantum error correction, in particular for operation of larger-distance codes.  The two-qubit gates are accompanied by a set of single-qubit gates applied to all auxiliary qubits in a leading and a trailing time step, and a dynamical decoupling pulse applied to all data qubits at a central time step (Fig.\u00a0(Figure fig:stabilizers_state_init)a). We choose the order of gate operations to provide resilience against single auxiliary qubit errors and to avoid interactions with microscopic defect modes (<ref>).\nThe gate execution is followed by readout of the Z-type auxiliary qubits to complete the Z-type stabilizer measurement, see Fig.\u00a0(Figure fig:stabilizers_state_init)a. Simultaneous with the Z-type auxiliary qubit readout,  we start executing the X-type stabilizer circuits, which are equivalent up to an additional basis change of the data qubits. This allows us to execute the $\\sz{i}$ and $\\sx{i}$ stabilizer measurements in a parallel, pipelined approach [Unknown Author, \"Unknown Title\", ], see Fig.\u00a0(Figure fig:stabilizers_state_init)a for a full circuit diagram and <ref> for a full pulse sequence.\n\nThanks to the pipelined approach combined with short qubit-readout times, we are able to execute a single quantum error correction cycle in a cycle time as short as $t_c = 1.1\\,$\u00b5s, setting the rate at which we detect errors for their subsequent correction. A short cycle time is essential for any error correction code as it determines the performance of the code at a given physical qubit coherence time. Moreover, a short cycle time reduces the execution time of error-corrected quantum algorithms [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nTo maximize performance, we have designed our device with parameters minimizing leakage on data qubits. We also detect the residual leakage on auxiliary qubits during the execution of each cycle, and on data qubits after the last cycle, using our three-state readout (see Methods <ref>).\n\nIn our experiments we reject all instances of detected leakage events. The degree to which leakage rejection affects the retained fraction of experimental runs is discussed in <ref>.\n\nTo characterize our logical-state initialization scheme, we determine the fidelity of the prepared state with respect to the target logical state by measuring the $2^9$ Pauli strings which form the basis of the 9-data-qubit logical state\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. For\nwe find a quantum state fidelity $\\mathcal{F}_\\mathrm{phys} = \\trace(\\rho |0\\rangle_{\\mathrm{L}}\\langle 0|_{\\mathrm{L}}) =  54.0(1)\\%$ (dark red bar in <ref>b) when using our leakage-detection scheme and when correcting for readout errors on data qubits.\nConsidering only errors in the logical subspace\u00a0[Unknown Author, \"Unknown Title\", ], we find a logical fidelity  $\\mathcal{F}_\\mathrm{L} =  \\mathcal{F}_\\mathrm{phys} / P_\\mathrm{L} = 99.6(2)\\,\\%$ where $P_\\mathrm{L} = 54.2(1)\\,\\%$ is the experimentally measured probability of preparing a state in the logical subspace (<ref>).\nBoth $\\mathcal{F}_\\mathrm{phys}$ and $P_\\mathrm{L}$ are smaller than in a distance-two surface code, see Ref.\u00a0Andersen2020b for example, since the two quantities are expected to decrease with increasing distance $d$ at constant physical error rate.\n\n< g r a p h i c s >\n\nThe surface code cycle, fidelity of logical state initialization, and average error syndromes.\na\u00a0Quantum circuit used to initialize and (repeatedly) error correct the distance-3 surface code logical qubit. Green (blue) shaded circuit elements represent the parallel execution of the four Z-type (X-type) stabilizer circuits. Empty squares indicate single-qubit rotations on data qubits. In the first cycle the X$i$ auxiliary qubits are not measured (dashed boxes).\nb\u00a0Fidelity of the prepared logical state  (dark red bar), all correctable states differing from  by one to four Pauli errors (red bars) and all uncorrectable states (light red bar).\nAverage syndrome elements $\\overline{\\sigma}_m^{Ai}$ as a function of the cycle index $m$ for c the   (filled circles) and d the  (filled triangles) preservation experiment. Open symbols are simulations. The horizontal black arrows indicate the average syndrome element over all stabilizers and cycles, see main text for details.\n\nTo further evaluate the performance of our logical state initialization, we analyze the fidelity of the prepared state with respect to subspaces of states which our surface code implementation can in principle correct.\nThe errors which are correctable by the distance-three surface code include all single-qubit Pauli (weight-one) errors $\\hat X_j$, $\\hat Y_j$, or  $\\hat Z_j$ on any data qubit $j$ and a subset of higher-weight errors. We compute the fidelity of the experimentally prepared state with respect to correctable subspaces including states which are equivalent to the target state up to Pauli errors of weight $i$ up to $i=4$ and find $(\\mathcal{F}_\\mathrm{w1},\\mathcal{F}_\\mathrm{w2},\\mathcal{F}_\\mathrm{w3},\\mathcal{F}_\\mathrm{w4}) = [34.3(0),\\,7.3(5), \\,0.3(8), \\,0.1(4)]\\,\\%$, see <ref> and Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nHence, the prepared initial state has a fidelity of $\\mathcal{F}_\\textrm{c} =\\mathcal{F}_\\textrm{phys} + \\sum_{i=1}^{4}\\mathcal{F}_{\\textrm{w}i} = 96.0(9)\\,\\%$ with respect to states which are in principle correctable in our realization of the surface code. We also note that weight-one errors account for the majority of errors on data qubits in the  state initialization, with higher weight errors having a largely reduced probability of occurrence (<ref>b).\n\nREPEATED QUANTUM ERROR CORRECTION\n\nOnce the first quantum error correction cycle completes the logical state initialization, we make use of all subsequent cycles for logical state preservation. In our experiments, we preserve the cardinal logical qubit states for up to $n=16$ cycles. In each cycle $m=1,..,n$ we extract eight stabilizer values $s_m^{Ai}$. Changes in stabilizer values signal the occurrence of errors and are used to construct error syndromes $\\sigma_m$ consisting of eight syndrome elements $\\sigma_m^{Ai}=(1-s_m^{Ai} \\times s_{m-1}^{Ai})/2$.  The elements $\\sigma_m^{Ai}$ are inferred in each cycle from the current $(m)$ and the previous ($m-1$) measured stabilizer values with $\\sigma_m^{Ai}=1(0)$ indicating an error (no error), respectively [Unknown Author, \"Unknown Title\", ].\n\nWe collectively process successive syndromes $\\sigma_m$ to determine which data and auxiliary qubits have most likely suffered an error [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nSpecifically, we construct a graph in which the syndrome elements are displayed at the auxiliary qubit locations along two spatial coordinates for each cycle index $m$ which forms the temporal coordinate. Spatial and temporal correlations between non-zero syndrome elements correspond to data and auxiliary qubit errors, respectively. If the overall error rate is sufficiently low, we obtain a low density of non-zero syndrome elements, or equivalently, mean syndrome element values $\\overline{\\sigma}_m^{Ai}\\ll 1$, with the mean taken over experimental realizations. In that case, the underlying errors can be decoded with low ambiguity (<ref>).\n\nExecuting $n$ consecutive error correction cycles and rejecting runs in which leakage has been detected, we record stabilizer measurement outcomes and construct syndromes from their values, the averages of which are shown in Fig.\u00a0(Figure fig:stabilizers_state_init)c,d.\nWhen averaging the syndromes over all individual elements and time, we find that the average syndrome element $\\overline{\\sigma} = 0.14 \\ll 1$ is small (see arrows in Fig.\u00a0(Figure fig:stabilizers_state_init)c,d), indicating that errors are rare and, therefore, allowing for efficient error detection and correction\u00a0[Unknown Author, \"Unknown Title\", ].\nAll syndrome elements $\\overline{\\sigma}_m^{Ai}$ averaged over repetitions of the experiments are approximately constant as a function of $m$ for $m \\geq 2$, see Fig.\u00a0(Figure fig:stabilizers_state_init)c,d obtained for preserving , and , , respectively. We attribute the small remaining increase of $\\overline{\\sigma}_m^{Ai}$ with $m$ to the fact that, in the absence of auxiliary qubit reset, auxiliary qubits initially prepared in the ground state tend to an asymptotic probability of $0.5$ to be in the excited state after $m$ cycles. As a result, with increasing $m$, auxiliary qubits suffer from larger decoherence during readout and during the subsequent idling periods of about $150\\,$ns before the start of the next quantum-error-correction cycle.\nOur numerical simulations show the same feature (open symbols in Fig.\u00a0(Figure fig:stabilizers_state_init)c,d).\nFor $m=1$, the averaged syndrome elements $\\overline{\\sigma}_1^{Ai}$ are reduced because the corresponding reference stabilizer values are computed from the initial data qubit product state, which we prepare with high fidelity. In the first cycle, the four values of $\\overline{\\sigma}_1^{\\textrm{Z}i}$ are smaller than $\\overline{\\sigma}_1^{\\textrm{X}i}$ because a quantum-error-correction cycle starts with measurements of $\\sz{i}$ and errors thus accumulate only during half a cycle.\n\nTo determine the performance of our distance-three surface code, we extract the logical error per cycle when preserving eigenstates of the logical qubit operators $\\lopz$ and $\\lopx$ versus the number of executed cycles $n$. For each sequence of cycles, we decode the error syndromes, including a syndrome determined from the final data qubit readout. After the $n^{\\rm{th}}$ cycle we perform a projective readout of the final data qubit state in the Z or X basis from which we determine the eigenvalue $z_{\\rm L}=\\pm 1$ of $\\lopz$ or $x_{\\rm L}=\\pm 1$ of $\\lopx$.\n\n< g r a p h i c s >\n\nLogical state preservation and error per cycle.\na\u00a0Experimentally determined (full symbols) and simulated (open symbols) expectation value of the  operator for prepared $\\lz$ (circles) and $\\lo$ (squares) and exponential fit (solid and dashed line). For reference, twice the average physical qubit decay is shown (dash-dotted line).  The extracted decay times are indicated on the right.  b\u00a0Corresponding data sets for , $\\lp$ (triangles) and $\\lm$ (diamonds). For reference, the average physical qubit coherence decay is indicated (dash-dotted line).\nc\u00a0Logical error probability $E_{\\rm L}$ as a function of the number $n$ of error correction cycles for $\\lz$ and $\\lp$ and the extracted error per cycle $\\epsilon_L$ indicated on the right. Same symbols as in a and b. The dash-dotted line shows the physical two-qubit gate error accumulated over $n$ cycles, for reference. The inset shows simulation results for $\\epsilon_{\\rm L}$ in state $\\lz$ (open, green circles) for an assumed homogeneous distribution of decoherence rates, gate and readout errors, reduced by factors of $x = 2, 5$ and $10$, see text for details. The green solid line is a fit to $1/x^2$.\n\nDecoding the error syndromes and applying potential corrections to $z_{\\rm L}$ or $x_{\\rm L}$, we compute the mean logical qubit expectation values $\\overline{z}_{\\rm L}=\\langle \\lopz \\rangle$ and $\\overline{x}_{\\rm L}=\\langle \\lopx \\rangle$ as a function of $n$ from a total of $10^6$ experimental runs, where the available data is reduced by ground state heralding before and leakage rejection during each run.\nWe decode the error syndromes using a minimum-weight perfect matching algorithm [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. We determine the weights in an error-model-free approach by inferring the errors per cycle from the measured data using a correlation analysis of the syndromes as described in <ref> and Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe correction of an error, initiated by analysing all cycles in postprocessing, takes the form of changing the sign of the logical qubit operator values $z_{\\rm L}$ and $x_{\\rm L}$ when indicated by the decoder. We note that for correcting $\\lopz$ it is sufficient to decode only syndromes $\\{\\sigma_m^{\\textrm{Z}i}\\}$, or, equivalently, only $\\{\\sigma_m^{\\textrm{X}i}\\}$ for $\\lopx$.\n\nWe observe an exponential decay of $\\langle \\lopz \\rangle$ and $\\langle \\lopx \\rangle$ with $n$ (solid symbols in Fig.\u00a0(Figure fig:state_preservation)a,b).\nFrom the logical qubit operator expectation values we extract the logical error probability $E_{\\mathrm{L}}=\\left(1-|\\langle Z_{\\mathrm{L}}\\rangle|\\right)/2$ (solid symbols in Fig.\u00a0(Figure fig:state_preservation)c) as a function of $n$ and find a small per cycle error probability of $\\epsilon_{\\mathrm{L}} = \\left[1-{\\rm exp}\\left(-t_{\\rm c}/T_{1,\\mathrm{L}}\\right)\\right]/2 \\approx t_{\\rm c}/2T_{1,\\mathrm{L}} = 0.032(1)$ also indicated on the right hand side of the corresponding data set in Fig.\u00a0(Figure fig:state_preservation)c. Equivalently, we obtain $\\epsilon_{\\mathrm{L}} = \\left[1-{\\rm exp}\\left(-t_{\\rm c}/T_{2,\\mathrm{L}}\\right)\\right]/2 \\approx t_{\\rm c}/2T_{2,\\mathrm{L}} = 0.029(1) $ for $\\langle X_{\\mathrm{L}}\\rangle$. We find that both the coherence time of $T_{2,\\mathrm{L}}=18.2(5)\\,$\u00b5s and the lifetime $T_{1,\\mathrm{L}}=16.4(8)\\,$\u00b5s of the logical qubit, as extracted from the decay curves of $\\langle \\lopz \\rangle$ and $\\langle \\lopx \\rangle$, are much longer than the duration of the quantum error correction cycle $t_c=1.1\\,$\u00b5s in our implementation of the surface code. In these experiments, we reject detected leakage events which occur with small probabilities on auxiliary and data qubits. As detailed in Appendix\u00a0<ref>, the retained fraction of data per cycle amounts to 92\n\nWe note that the logical coherence time is only about a factor of two lower than the mean physical coherence time $\\overline{T_2^*}=37.5\\,$\u00b5s of all 17 qubits while the logical relaxation time is about a factor four lower than twice the mean physical energy relaxation time $2 \\overline{T_1}=65.0\\,$\u00b5s, as indicated in Fig.\u00a0(Figure fig:state_preservation)a,b. In the latter case the factor of two assumes an infinite lifetime of the physical qubit ground state for the comparison. We also note that, within errors bars, the lifetime of the states $\\lz$ and $\\lo$, and the coherence time of $\\lp$ and $\\lm$ are identical. This is expected since all cardinal states of the logical qubit have the same number of qubits in the excited state and our dynamical decoupling scheme alternates between the basis states which are therefore similarly affected by decoherence.\n\nPERFORMANCE ASSESSMENT AND PROJECTION\n\nWe compare the state preservation experiments with numerical simulations using a Monte Carlo wavefunction method (open symbols in Fig.\u00a0(Figure fig:state_preservation)a,b,c). The model underlying the simulations (<ref>) uses the measured\ncoherence times, interaction rates and readout errors of the device as inputs.\nWe find that despite the complexity of the quantum error correction cycle the measured expectation values $\\langle \\lopx \\rangle$ and $\\langle \\lopz \\rangle$, when rejecting leakage, come close to the simulated values (open symbols in Fig.\u00a0(Figure fig:state_preservation)a,b).\nThe logical lifetimes extracted from exponential fits (dashed lines in Fig.\u00a0(Figure fig:state_preservation)a,b) to the simulated expectation values are approximately $26\\,$\u00b5s providing an upper bound for the performance achievable with the specified device parameters.\n\nSince the numerical simulations model the performance of our quantum device well, we use the model to project how future improvements in gate and readout fidelities are expected to reduce the logical error per cycle $\\epsilon_L$. To free the projection from device-specific spread in qubit parameters, we use the average over all 17 qubits as uniform parameters (see Tab.\u00a0(Table tab:qubit_measured_parameters)), and find good agreement with the results obtained from the qubit-specific model.\nWe then uniformly reduce all physical error parameters of the numerical model by a factor $x$, repeat the simulations of $\\langle \\lopx \\rangle$ and $\\langle \\lopz \\rangle$ vs\u00a0$n$, and extract the mean logical error per cycle $\\epsilon_L$ as a function of the improvement factor $x$. We find that the simulated error per cycle scales to a good approximation as $1/x^2$, see inset in Fig.\u00a0(Figure fig:state_preservation)c, as expected for a code of distance three [Unknown Author, \"Unknown Title\", ]. For reference, we plot the scaled two-qubit physical error per cycle $\\epsilon_{\\rm{2Q}}$ in the same plot (dash-dotted line).\n\nA metric commonly used to assess the performance of quantum error correction compares the logical error per cycle $\\epsilon_{\\rm L}$ to the dominant error on the physical level, typically the two-qubit gate error $\\epsilon_{\\rm{2Q}}$ [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nSuch a comparison is particularly relevant in architectures in which the logical two-qubit gate error is dominated by errors $\\epsilon_L$ in the quantum error correction cycles belonging to or following the logical two-qubit gate operation. The number of required cycles scales in general with $d$ in planar architectures and in architectures allowing for transversal execution of logical two-qubit gates [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe good agreement between measured ($\\sim 3\\,\\%$) and simulated ($\\sim 2\\,\\%$) logical errors $\\epsilon_{\\rm L}$ together with their simulated quadratic scaling suggests that the break-even of per-cycle logical errors with two-qubit gate errors may be in reach for modest improvements of device performance, when employing leakage detection or correction.\n\nIn our experiments, we demonstrate the viability of realizing quantum error correction in the surface code by detecting errors during the error correction cycle, and decoding the error syndromes and correcting for errors in postprocessing, which is sufficient in a quantum memory setting. Next generation experiments will provide the capability of correcting errors during the cycle using real-time decoding\u00a0[Unknown Author, \"Unknown Title\", ] and fast in-sequence feedback\u00a0[Unknown Author, \"Unknown Title\", ], implemented with dedicated digital electronics. Feedback will also enable the mid-cycle suppression of leakage\u00a0[Unknown Author, \"Unknown Title\", ], for example by auxiliary qubit reset.\nRealizing larger surface code lattices while improving the performance of their components and demonstrating exponential suppression of logical errors with increasing code distance are upcoming important steps toward achieving the long-term goal of fault-tolerant quantum computation.\n\nACKNOWLEDGMENTS\n\nThe authors are grateful for valuable discussions with Quentin Ficheux and Crist\u00f3bal Lled\u00f3. The authors acknowledge the contributions of Richard Boell to the experimental setup and of Michael Kerschbaum for early work on the two-qubit gate implementation.\n\nThe team in Zurich acknowledges financial support by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA), via the U.S. Army Research Office grant W911NF-16-1-0071, by the EU Flagship on Quantum Technology H2020-FETFLAG-2018-03 project 820363 OpenSuperQ, by the National Centre of Competence in Research Quantum Science and Technology (NCCR QSIT), a research instrument of the Swiss National Science Foundation (SNSF), by the SNFS R'equip grant 206021-170731 and by ETH Zurich. S.K. acknowledges financial support from Fondation Jean-Jacques & Felicia Lopez-Loreta and the ETH Zurich Foundation. The work in Sherbrooke was undertaken thanks in part to funding from NSERC, Canada First Research Excellence Fund and ARO W911NF-18-1-0411, the Minist\u00e8re de l\u2019\u00c9conomie et de l\u2019Innovation du Qu\u00e9bec, and U.S. Department of Energy, Office of Science, National Quantum Information Science Research Centers, Quantum Systems Accelerator. M.M. acknowledges support by the U.S. Army Research Office grant W911NF-16-1-0070.\nThe views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the ODNI, IARPA, or the U.S. Government.\n\nAUTHOR CONTRIBUTIONS\n\nS.K., N.L. and A.R. planned the experiments, S.K. and N.L performed the main experiment, and S.K. and N.L. analyzed the data.\nF.S., A.R. and C.K.A. designed the device, and S.K., A.R. and G.J.N. fabricated the device.\nN.L., C.H. and S.L. developed the experimental software framework and A.R., C.H., N.L., S.K. and S.L. developed control and calibration software routines.\nA.R., J.H., S.K. and C.H. designed and built elements of the room-temperature setup, and S.K., A.R., C.H., S.L., N.L. and F.S. maintained the experimental setup.\nS.K., N.L., A.R., C.H., S.L. and C.K.A. characterized and calibrated the device and the experimental setup.\nE.G., A.D.P. and C.L. performed the numerical simulations.\nM.M. provided guidance on logical qubit evaluation methodology aspects.\nS.K., N.L., A.R., C.H. and S.L. prepared the figures for the manuscript and S.K., N.L., A.R., C.E. and A.W. wrote the manuscript with inputs from all co-authors.\nA.B., C.E. and A.W. supervised the work.\n\nCOMPETING INTERESTS\n\nThe authors declare no competing interests.\n\nMETHODS\n\n### Controlled-phase Gates\nWe realize the necessary two-qubit controlled-phase (CZ) gates by tuning adjacent pairs of data (D$j$) and auxiliary qubits (X$i$, Z$i$) into resonance [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] using individual flux lines implemented with coplanar waveguides (green in  Fig.\u00a0(Figure fig:device)b) shorted near the SQUID loop of each qubit. We fabricated all qubits with asymmetric superconducting quantum interference devices (SQUIDs) [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to allow for data qubits to idle at their minimum and auxiliary qubits at their maximum frequencies, at which the qubits are to first-order insensitive to flux noise. Data qubits are designed with idle frequencies $3.7-4.1~$GHz in a low frequency band and auxiliary qubits with idle frequencies $5.9-6.3~$GHz in a high frequency band, see red and blue/green dots, respectively, in Fig.\u00a0(Figure fig:device)c and <ref>.\n\nWe implement  by tuning both data and auxiliary qubits to an intermediate interaction frequency $\\omega_{\\rm int}$ and $\\omega_{\\rm int}-\\alpha$, respectively, with $\\omega_{\\rm int}/2\\pi$ ranging from $4.4$ to $5.6~$GHz (<ref>). The qubit anharmonicity $\\alpha\\sim -0.17\\,$GHz is designed to be small to minimize residual qubit/qubit interactions\u00a0[Unknown Author, \"Unknown Title\", ]. We make use of net-zero flux pulses [Unknown Author, \"Unknown Title\", ], which reduce both the detrimental effect of low-frequency flux noise on qubit coherence and the impact of non-idealities in the transfer function of the flux lines on gate fidelities.\nGiven the large designed detuning of $\\sim 2$\u00a0GHz between the data and auxiliary qubits at their idle frequencies, we calculate residual-ZZ interaction strengths between qubits lower than $\\alpha_{\\textrm{zz}}/2\\pi\\sim 8~$kHz [Unknown Author, \"Unknown Title\", ]. It is only during two-qubit gate execution that $\\alpha_{\\textrm{zz}}$ increases by a factor of approximately $2$ to $25$, depending on the interaction frequency $\\omega_{\\rm int}$, which we partially mitigate using echo pulses. The coupling strength between auxiliary qubits and data qubits at the interaction point is about $J/2\\pi\\sim 7~$MHz.\n\n### Qubit-readout Architecture\nEach qubit is coupled to a resonant pair of readout resonator and Purcell filter (red- and blue $\\lambda/4$ coplanar waveguide resonators in Fig.\u00a0(Figure fig:device)b). Moreover, each readout resonator is coupled strongly to the qubit ($g/2\\pi\\sim 169\\,$MHz for auxiliary qubits and $g/2\\pi\\sim 252\\,$MHz for data qubits) and has a large effective bandwidth ($\\kappa_{\\rm eff}/2\\pi\\sim 10\\,$MHz) to enable fast, high-fidelity readout [Unknown Author, \"Unknown Title\", ]. The individual Purcell filters both maintain high qubit coherence, despite the large coupling and bandwidth of the readout resonators, and reduce undesired readout crosstalk (<ref>) between qubits which are in close proximity or have similar frequencies [Unknown Author, \"Unknown Title\", ]. This is particularly important for the simultaneous frequency-multiplexed readout of groups of four or five qubits using joint feed lines (purple coplanar waveguides in Fig.\u00a0(Figure fig:device)b). The readout resonator frequencies are separated by about 200\u00a0MHz within each feed line and occupy a frequency band extending from 6.8 to 7.6\u00a0GHz (purple points in Fig.\u00a0(Figure fig:device)c).\n\nWe read out the states of all qubits dispersively by applying frequency-multiplexed Gaussian filtered microwave pulses of duration $200-300~$ns to all four feed lines. We integrate the transmitted signals in a heterodyne detection scheme for a duration of $400$\u00a0ns (<ref>). Auxiliary qubits are read out near their idle frequencies while data qubits are read out at a flux-tuned qubit frequency of $\\sim 5$\u00a0GHz reducing the data qubit-readout resonator detuning [Unknown Author, \"Unknown Title\", ] and thus enhancing the dispersive coupling and the readout fidelity [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n### Leakage Detection\nWe make use of a leakage detection scheme based on three-state readout which allows us, in postprocessing, to reject those sequences in which any of the qubits were measured in a leakage state, see <ref>.\nIn our CZ gate scheme we make use of the second excited state $|2\\rangle$ of the auxiliary qubits rather than the one of the data qubits to mediate the interaction which minimizes data qubit leakage.\nPerforming three-state readout of the data qubits after the final error correction cycle, we reject experimental runs for which data qubit leakage was detected. The rejected fraction per qubit and per cycle amounts to $0.0017(2)$. In addition there is a cycle-independent rejection probability of about $0.01$ per qubit due to false positives caused by readout-error.\nIn addition, we detect, if any of the eight auxiliary qubits has leaked to the $|2\\rangle$ state in any of the $n$ cycles, using the same three-state readout, and find an average rejection probability of $0.0094(4)$ per qubit per cycle.\nIn total, this leads to a rejected data fraction per cycle of 8\n\nSUPPLEMENTARY INFORMATION\n\n## Device fabrication\nTo fabricate the 17-qubit surface code device, we pattern transmon qubit islands, couplers, resonators, and control lines into a 150 nm-thin niobium film sputtered onto a high-resistivity silicon substrate using photolithography and reactive ion etching.\nTo establish a well-connected ground plane at microwave frequencies and realize cross-overs for coplanar waveguides, we fabricate aluminum-titanium-aluminum trilayer airbridges onto the device using a two-layer resist photolithography process with reflow.\nWe fabricate aluminium-based Josephson junctions of the transmon qubits using electron-beam lithography (EBL) and shadow evaporation, and establish electrical contact between the junction metal and the niobium base-layer film using aluminum bandages\u00a0[Unknown Author, \"Unknown Title\", ] fabricated in a second EBL and evaporation run.\n\n## Device parameters and performance\nWe characterize the performance and properties of each qubit on the device using spectroscopy and standard time-domain methods, see <ref>.\nNote that some parameters (marked with the superscript 'a' in <ref>) were extracted from measurements in a separate cooldown of the same device.\n\nWe realize single-qubit gates with 40-ns-duration microwave DRAG pulses\u00a0[Unknown Author, \"Unknown Title\", ] with a Gaussian envelope which has a standard deviation of $\\sigma=\\ns{10}$ and is truncated at $\\pm 2\\sigma$.\n\nWe realize two-qubit gates with net-zero flux pulses\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with an average duration of 68, see\u00a0<ref> for a detailed description of the two-qubit gates implementation. We add 15 buffers before and after each flux-pulse resulting in a total average two-qubit gate duration of 98.\n\nWe benchmark the performance of single- and two-qubit gate operations across the entire device using randomized benchmarking\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (single-qubit gates) and interleaved randomized benchmarking\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (two-qubit gates), and display the resulting errors in <ref>.\nthat are executed simultaneously in the quantum error correction cycle (see <ref>a and <ref>) are also calibrated and benchmarked simultaneously.\n\nSingle-qubit gates have a mean error of 0.09(4)\nTwo-qubit gates used to realize the stabilizer 1 display larger errors, which we attribute to the low coherence times of the auxiliary qubit X1, and to the interaction with a microscopic defect (<ref>) with a frequency close to the idle-frequency of qubit X1.\n\n< g r a p h i c s >\n\nSingle- and two-qubit gate errors as characterized by randomized benchmarking and interleaved randomized benchmarking, respectively. The average measured single-qubit (two-qubit) gate error across the device is 0.09(4)\n\nQubit parameters, coherence properties and single-qubit performance for the nine data qubits (top) and the eight auxiliary qubits (bottom). We also provide, for relevant quantities, the averaged value across the device in column $\\overline{\\mathrm{Q}}$.\n\nParameter           D1           D2           D3           D4           D5           D6           D7           D8           D9\n\nQubit idle frequency, $\\omega_Q/2\\pi$ (GHz)\t\t\t\t\t        \t            3.885     3.994     3.952     3.878     3.895     3.74     4.056     3.993     4.143\n\nQubit anharmonicity, $\\alpha/2\\pi$ (MHz)\t\t\t\t\t\t\t                        -184     -184     -183     -184     -186     -184     -181     -183     -181\n\nLifetime, $T_1$ (s)\t\t\t\t\t\t\t                        29.1     33.0     65.5     59.3     32.2     60.2     36.0     33.1     25.9\n\nRamsey decay time, $T_2^*$  (s)\t\t\t\t        \t            35.0     13.5     33.9     74.3     46.1     78.1     74.8     41.4     31.7\n\nEcho decay time, $T_2^\\mathrm{e}$   (s)\t\t        \t\t        46.2     52.2     49.3     75.5     56.1     89.3     72.5     59.1     36.3\n\nSingle-qubit RB error[1], $\\epsilon_{\\mathrm{1Q}}$ (\nReadout frequency, $\\omega_\\mathrm{RO}/2\\pi$ (GHz)\t\t\t\t        \t        6.769     6.979     6.88     7.12     7.18     7.032     6.91     7.075     6.868\n\nQb. freq. during RO, $\\omega_Q'/2\\pi$ (GHz)\t\t\t\t\t            \t        5.321     4.75     5.275     4.25     4.42     5.13     4.395     3.993     5.0\n\nDispersive shift[1], $\\chi/2\\pi$ (MHz)\t\t\t        \t        -2.0     -2.2     -1.9     -1.6     -1.5     -1.6     -2.3     -2.0     -2.4\n\nDisp. shift during RO, $\\chi'/2\\pi$ (MHz)\t\t\t\t            \t        -7.4     -3.9     -6.0     -2.0     -2.1     -4.7     -3.0     -2.0     -4.9\n\nReadout linewidth[1], $\\kappa_{\\mathrm{eff}}/2\\pi$ (MHz)\t        6.3     7.2     8.3     8.7     3.5     9.0     8.6     8.2     8.9\n\nQubit-RO res. coupling[1], $g_{\\mathrm{Q,RR}}/2\\pi$ (MHz)\t    244     269     241     241     238     244     267     265     260\n\nTwo-state readout error, $\\epsilon_{\\mathrm{RO}}^{(2)}$ (\nThree-state readout error, $\\epsilon_{\\mathrm{RO}}^{(3)}$ (\nThermal population, $P_\\mathrm{th}$ (\nParameter           X1           X2           X3           X4           Z1           Z2           Z3           Z4      $\\mathbf{\\overline{Q}}$\n\nQubit idle frequency, $\\omega_Q/2\\pi$ (GHz)\t\t\t\t\t        \t            6.097     5.885     6.022     6.049     6.328     6.192     5.956     6.037     -\n\nQubit anharmonicity, $\\alpha/2\\pi$ (MHz)\t\t\t\t\t\t\t                        -170     -174     -170     -170     -163     -168     -171     -170     -177\n\nLifetime, $T_1$ (s)\t\t\t\t\t\t\t                        12.4     17.4     18.5     12.6     17.0     42.7     29.7     27.5     32.5\n\nRamsey decay time, $T_2^*$  (s)\t\t\t\t        \t            5.6     14.3     20.7     28.9     29.3     33.1     48.0     28.9     37.5\n\nEcho decay time, $T_2^\\mathrm{e}$   (s)\t\t        \t\t        15.8     33.0     16.1     33.1     31.5     26.0     53.6     53.6     47.0\n\nSingle-qubit RB error[1], $\\epsilon_{\\mathrm{1Q}}$ (\nReadout frequency, $\\omega_\\mathrm{RO/2\\pi}$ (GHz)\t\t\t\t        \t        7.372     7.554     7.258     7.461     7.316     7.502     7.2     7.412     -\n\nQb. freq. during RO, $\\omega_Q'/2\\pi$ (GHz)\t\t\t\t\t            \t        5.9     5.885     6.022     6.049     6.328     6.191     5.956     5.687     -\n\nDispersive shift[1], $\\chi/2\\pi$ (MHz)\t\t\t        \t        -2.8     -1.9     -3.2     -2.6     -4.7     -2.9     -3.2     -2.8     -2.4\n\nDisp. shift during RO, $\\chi'/2\\pi$ (MHz)\t\t\t\t            \t        -2.1     -1.9     -3.2     -2.6     -4.7     -2.9     -3.2     -2.8     -3.5\n\nReadout linewidth[1], $\\kappa_{\\mathrm{eff}}/2\\pi$ (MHz)\t        15.1     20.1     13.0     11.0     11.2     12.2     14.3     10.0     10.3\n\nQubit-RO res. coupling[1], $g_{\\mathrm{Q-RR}}/2\\pi$ (MHz)\t    167     168     167     168     171     170     167     171     213\n\nTwo-state readout error, $\\epsilon_{\\mathrm{RO}}^{(2)}$ (\nThree-state readout error, $\\epsilon_{\\mathrm{RO}}^{(3)}$ (\nThermal population, $P_\\mathrm{th}$ (\n\nMeasured in a different cooldown.\n\n## Two-qubit gates\nTwo-qubit gates are essential building blocks of the stabilizer circuits of the surface code. Here, we describe our implementation of , discuss the constraints and considerations for gate parallelization and gate ordering during the error correction cycle, and report on coherence properties during the gate execution.\n\nimplementation\n\nWe realize two-qubit controlled-phase (C$Z$) gates [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] by flux-tuning two neighboring qubits to an interaction frequency between the idle frequencies of the two qubits. We use a net-zero pulse shape to protect the qubits from low-frequency flux noise and to avoid the buildup of long-timescale distortions in the flux-control lines [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe flux pulse applied to each qubit consists of two Gaussian-filtered, approximately $30$-ns-long sections, which are interleaved with a 2.5-ns-long net-zero transition section, see <ref>a for an example waveform.\nThe amplitudes of the longer sections bring the $\\ket{20}$-transition frequency into resonance with the the $\\ket{11}$-transition frequency, see <ref>b.\nWe calibrate the duration of these sections to achieve full population recovery into the $\\ket{11}$ state.\n\nTo achieve a $\\pi$-controlled-phase rotation, we calibrate the pulse amplitude of the transition section for the data qubit, which effectively controls the phase acquired by the $\\ket{20}$ state relative to the $\\ket{11}$ state.\n\nWe select interaction frequencies which allow for the parallel execution of three  in each of the eight time steps of the quantum error correction cycle, as indicated by the color and label of the qubit-qubit couplers in <ref>c.\nThe interaction frequencies for a single time step (colored horizontal lines of same color) are chosen to avoid crossing neighboring qubits on which gates are executed in the same time step.\nIn addition, the interaction frequencies in a given CZ gate time step are distributed over the available $\\sim 2\\,$GHz frequency range to minimize residual-ZZ couplings between neighboring qubits performing CZ gates in parallel. The overall, calculated residual-ZZ coupling during the eight CZ gate time steps, averaged over all 24 qubit pairs and over the eight time steps, amounts to $\\alpha_{\\rm ZZ}/2\\pi = 27(37)\\,$kHz, which is about a factor three larger than with all qubits biased at their idle frequency.\n\nFinally, the interaction frequencies are chosen to minimize population loss due to interaction with the strongly coupled microscopic defects of our device. To characterize the defect-mode distribution, we determine the frequency-dependent population loss for each qubit by measuring the remaining excited-state population after applying Gaussian-filtered square flux pulse that tunes the qubit frequency from its idle frequency (black semi-circle) to $\\omega_{\\mathrm{int}}$ for a duration of $t_\\mathrm{int} = \\ns{100}$, see the gray filled areas in <ref>c.\nFor most qubits, we observe a constant background population loss of $\\leq2\\,\\%$ over the entire frequency range,\nwith $0-3$ narrow frequency bands ($\\leq 50\\,$MHz) exhibiting peak population loss $\\geq25\\%$. We attribute these population-loss peaks to coherent interactions with defects coupled to the qubits with a strength of $g/2\\pi \\geq 0.8\\,$MHz.\nQubits D7, D8 and X1 display broader and higher population-loss peaks, likely due to the interaction with defects coupled to the qubits with $g/2\\pi$ on the order of 1-20 MHz.\nFor these qubits, the finite interaction during the rising and falling edge of the flux pulse leads to a population loss tail when crossing the defect.\nWe choose interaction frequencies for the two-qubit gates that are detuned from all defects and that avoid crossing strongly coupled defects.\n\n< g r a p h i c s >\n\nRealization of two-qubit gates.\na. Example of a net-zero pulse shapes before compensating for flux line distortions that are applied simultaneously on a data qubit (D5) and an auxiliary qubit (X2) to implement a  between the two. Note that the duration of the transition section has been increased from 2.5 to 12.5 for better visibility in this figure.\nb. Calculated evolution of the eigenenergies for the pulse shapes shown in panel a.\nc. Frequency arrangement chosen for the operation of the device. Measured population loss (gray areas) when flux-tuning qubits from their idle frequencies (black dots) to $\\omega_{\\mathrm{int}}$ for a duration of 100. The chosen two-qubit gate interaction frequencies are displayed as colored lines corresponding to the color code used in the conceptual device representation at the bottom of the panel, which indicates two-qubit pairs between which gates are executed. Gates sharing the same color are executed simultaneously, in the time step indicated by the label extending between pairs of qubits\n\nIn addition to a suitable selection of interaction frequencies, accurate control of the qubit frequency is essential for the realization of high-fidelity and low-leakage two-qubit gates.\nHowever, the flux pulses reaching the sample and controlling the qubit frequency, are transformed from the programmed waveforms on the AWGs due to the transfer functions of, for instance, the high-pass filtering in the bias-tee, the frequency-dependent attenuation in the cables, and imperfections in the impedance matching of the flux line.\nTo characterize the flux pulse distortions at timescales ranging from $\\sim\\ns{50}$ to 50s,\nwe apply a step-like Gaussian-filtered flux pulse and resolve the resulting time dependence of the qubit frequency by identifying which drive frequency induces a transition from $\\ket{0}$ to $\\ket{1}$, for a varying delay $\\Delta t$ after applying the step-like flux pulse.\nThe time-dependent qubit-frequency response is then used to calibrate infinite impulse response (IIR) filters\nwhich invert the distortions of signals propagating along the flux line in digital preprocessing of the programmed waveforms, see above.\nMoreover, to compensate for distortions on nanosecond timescales, we calibrate finite impulse response (FIR) filters using methods described in Ref.\u00a0Rol2020.\n\n### Two-qubit gate order\nWe choose the order of the two-qubit gates, executed in the  time steps 1, 2, 3, 4 for $\\sz{i}$ and in the time steps 5, 6, 7, 8 for $\\sx{i}$ (Fig.\u00a0(Figure fig:interaction_frequencies)c), to provide resilience against single auxiliary-qubit errors propagating to data qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Simultaneously, we satisfy constraints imposed by the presence of microscopic defects near the two-qubit gate interaction frequencies (<ref>).\n\nA single $\\hat{X}$ error on an auxiliary qubit $\\mathrm{Z}i$ ($\\mathrm{X}i$) during a stabilizer measurement $\\sz{i}$ ($\\sx{i}$) results in $\\hat{Z}$ ($\\hat{X}$) errors on all data qubits which subsequently perform  with that auxiliary qubit, see Fig.\u00a0(Figure fig:gate_order)a for an example.\nAuxiliary qubit $\\hat{Z}$ errors commute with the CZ gates and therefore do not propagate to data qubits. We only consider the middle of weight-four stabilizer gate sequences as potential times when $\\hat{X}$ errors occur on the auxiliary qubits since the error propagates to two data qubits only in this case.\nFor all other auxiliary qubit error locations, the error effectively propagates to at most a single data qubit because data qubit errors are only relevant up to multiplication with stabilizer operators.\nFor instance, although an error between the first and second CZ gate physically propagates to three data qubits of the corresponding stabilizer plaquette, this three-qubit error is equivalent to a single-qubit error, of the same type, on the originally unaffected data qubit of the plaquette.\n\nTo ensure that such correlated two-qubit $\\hat{Z}$ or $\\hat{X}$ errors do not result in logical errors in the decoding process, we choose the last two  of each of the $\\sz{i}$ ($\\sx{i}$) measurements to involve data qubits which are not aligned parallel to the data-qubit strings forming the logical operators  ()\u00a0[Unknown Author, \"Unknown Title\", ], i.e. not horizontal (vertical) in <ref>b.\nWith this gate order, correlated two-qubit $\\hat{Z}$ or $\\hat{X}$ errors can be correctly identified (up to multiplication with stabilizer operators). As an example, we consider the correlated error $\\hat{Z}_{\\rm D4}\\hat{Z}_{\\rm D7}$ on D4 and D7 resulting from a single error $\\hat{Z}_{\\rm Z2}$ on Z2, see Fig.\u00a0(Figure fig:gate_order)b.\nAs a consequence, X2 and X4 show syndrome elements of 1 (dark blue, solid circles in Fig.\u00a0(Figure fig:gate_order)b). Because the stabilizers $\\sx{2}$ and $\\sx{4}$ do not share a data qubit, this syndrome cannot be caused by a single data-qubit error and the minimum-weight-perfect-matching decoder (<ref>) correctly identifies both errors, the error $\\hat{Z}_{\\rm D7}$ and one of the equivalent errors $\\hat{Z}_{\\rm D4}$ (indicated in Fig.\u00a0(Figure fig:gate_order)b with solid, dark blue arrows) or $\\hat{Z}_{\\rm D1}$.\nOn the other hand, if the gates Z2-D7 and Z2-D8 were successively performed in either the CZ gate time steps 1 and 2, or 3 and 4, the corresponding correlated error $\\hat{Z}_{\\rm D7}\\hat{Z}_{\\rm D8}$ (green rectangle with dashed outline in <ref>b) would not be correctly identified by the decoder.\nIn that case, only the syndrome element of X3 is 1 and as a result the decoder identifies one of the equivalent single-qubit errors $\\hat{Z}_{\\rm D9}$ (indicated in <ref>b with a dashed, dark blue arrow) or $\\hat{Z}_{\\rm D6}$, and applies the corresponding correction $\\hat{Z}_{\\rm D9}$ or $\\hat{Z}_{\\rm D6}$. However, one such false correction together with the original error $\\hat{Z}_{\\rm D7}\\hat{Z}_{\\rm D8}$ is equivalent to the application of  and thus leads to a logical error, see black dashed line in <ref>b.\n\nWe note that data qubits participating in the last two CZ gates of a stabilizer measurement may also be aligned diagonally with respect to the data qubit string of the corresponding logical operator, and that the resulting weight-two error on the data qubits remains correctable. In particular, this is the case for $\\sz{3}$ and allows us to execute the gate Z3-D5 in a different time step than the gate Z2-D7, which would otherwise result in a frequency crossing of Z2 and D5 because the gate Z2-D7 is constrained to an interaction frequency $\\omega_{\\rm int}/2\\pi \\lesssim 4.5~$GHz due to a microscopic defect on D7 (<ref>c). For completeness, we note that there is no constraint imposed on the two-qubit gate order from maintaining the commutation of neighboring stabilizers $\\sz{i}$ and $\\sx{i}$ [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] because we measure $\\sz{i}$ and $\\sx{i}$ sequentially.\n\n< g r a p h i c s >\n\nLimiting the propagation of auxiliary-qubit errors. a Weight-four stabilizer circuit as discussed in the main text. A single $\\hat{X}$ error on the auxiliary qubit in the middle of the circuit propagates to two data qubits (violet lines), resulting in a correlated $\\hat{Z}\\hat{Z}$ error (green box) for Z-type stabilizer circuits and in a correlated $\\hat{X}\\hat{X}$ error (blue rounded-corner box with dashed outline) for X-type stabilizer circuits. b 17-qubit surface code schematic with two potential correlated $\\hat{Z}\\hat{Z}$ errors (solid and dashed green boxes) indicated. Dark blue, solid and dashed circles around auxiliary qubits indicate the corresponding syndrome elements with value 1. Dark blue, solid and dashed arrows indicate the errors identified by the decoder, see text for details.\n\n### Reduced coherence at interaction frequencies\nAt the two-qubit gate interaction frequency, the sensitivity of the qubit frequency to fluctuations in flux is higher than at the idle frequency, which is first-order insensitive to fluctuations in flux. Hence, flux-noise-induced dephasing is increased during two-qubit gates.\nWe characterize the effective Ramsey decay time $T_2^{\\ast,\\mathrm{int}}$, for a given qubit $Qi$ ($Q \\in \\{\\mathrm{D}, \\mathrm{X}, \\mathrm{Z}\\}$ and $i=1, \\dots, 9$ if $Q = \\mathrm{D}$ and $i=1, \\dots, 4$ otherwise), fluxed-tuned to the interaction frequency $\\omega_\\mathrm{int}$ with a sequence of Ramsey measurements.\nSpecifically, we measure the phase of a given qubit with a Ramsey experiment in which we insert a train of $N$ 60-duration net-zero flux pulses (with 15-ns-long buffers on each side) between two Ramsey $\\pi/2$-pulses.\nWe repeat the measurement for $N=1,2,4,8,\\dots,256$ pulses, extract the phase contrast for each measurement from a cosine fit, and fit the phase contrasts to a decaying exponential to extract $T_2^{\\ast,\\mathrm{int}}$.\n\nWe compare $T_2^{\\ast,\\mathrm{int}}$ to the Ramsey decay time measured at the qubit idle frequency, $T_2^{\\ast}$, for each of the 24 two-qubit gates, see the wire-frame and filled bars in <ref>a, respectively.\nAveraged over the 24 qubit-pairs, we observe a mean $T_2^{\\ast\\mathrm{int}}$ of 13.1(4.2)$\\,$\u00b5s at the interaction frequency, compared to a mean $T_2^{\\ast}$ of 46.8(20.2)$\\,$\u00b5s at the idle frequency.\nAs the built-in echo effect of the net-zero flux-pulse provides protection against low-frequency flux-noise, we hypothesize that the reduction in decay-time is dominated by high-frequency flux noise.\nWe compute the decay-time ratio $T_2^{\\ast}/T_2^{\\ast,\\mathrm{int}}$ for each qubit-pair, see\u00a0<ref>b, and extract a mean ratio of $\\sim3.2$ (gray area).\nThis reduction in Ramsey decay time significantly affects the coherence limit of the two-qubit gates. To reproduce the characteristics of the experiment in numerical simulations, we account for this reduction by adjusting the dephasing rates for the duration of the two-qubit gates, see <ref> for details.\n\n< g r a p h i c s >\n\nReduced coherence during two-qubit gate execution.\u00a0a Comparison between the Ramsey decay times measured at the qubit idle frequencies (wire-frames), $T_2^{\\ast}$,  and at the two-qubit gate interaction frequencies (solid bars), $T_2^{\\ast,\\mathrm{int}}$,  for the 24 two-qubit gates of the device, with colors matching the respective qubit color in the conceptual device representation at the bottom of the figure. Each qubit appears multiple times as it is tuned to different interaction frequencies depending on which neighboring qubit it performs a gate with.\u00a0b Ratio of the Ramsey decay time at the qubit idle frequency, $T_2^{\\ast}$, and the Ramsey decay time at the two-qubit gate interaction frequency, $T_2^{\\ast,\\mathrm{int}}$. The median ratio is indicated by the gray area.\n\n## Experimental setup\nWe install the 17-qubit quantum device in a magnetically-shielded sample holder mounted at the base plate of a dilution refrigerator\u00a0[Unknown Author, \"Unknown Title\", ] and connect it to the control-electronics setup located at room temperature as indicated in <ref>. Input and output lines for charge control (pink), flux control (green), and readout (purple), are configured with the indicated microwave components for signal conditioning.\n\n< g r a p h i c s >\n\nSchematic illustration of the experimental setup. Flux lines (green), drive lines (pink), and readout lines (purple) connect room-temperature electronics to the device, schematically represented by qubits (yellow), readout resonators (red) and Purcell filters (dark blue). The background colors indicate the temperature stages of the experimental setup. We provide additional details about the components in the legend (white background) and in the text.\n\nDC voltage sources (Bat.) generate a current which passes through a series of attenuators and filters to induce a magnetic flux in the SQUID-loop of the transmon qubit and control its idle frequency.\nArbitrary waveform generators (AWG) generate voltage pulses at a sampling rate of 2.4 GSa/s to control the qubit frequencies on the nano-second timescale to implement two-qubit gates, see <ref>.  The AWG signal is combined with the DC bias current using a bias-tee.\n\nSingle-qubit drive pulses are generated at an intermediate frequency in the range of 0-500 by an AWG, and then up-converted (UC) to microwave frequencies in an analog IQ-mixer using the continuous-wave signal of a microwave generator (MWG) as a carrier.\n\nAn ultra-high frequency quantum analyzer (UHFQA) generates multiplexed-readout pulses at a sampling rate of 1.8 GSa/s. The amplification chain at each readout port of the sample consists of a wide-bandwidth near-quantum limited traveling-wave parametric amplifier (TWPA) [Unknown Author, \"Unknown Title\", ], a high-electron-mobility transistor (HEMT) amplifier and low-noise, and room-temperature amplifiers (RT-A board).\nWe add the TWPA pump tone to the input of the amplifier using a 20 dB directional coupler (Dir. coupler), and cancel it interferometrically at the input of the room-temperature amplifiers by combining the cryostat output signal with a phase- and amplitude-displaced pump tone that bypasses the cryostat.\nAfter amplification, the signal is down-converted with an IQ-mixer in a down-conversion (DC) board and then both digitally demodulated and integrated using the field-programmable gate-array of the UHFQA.\n\n## Crosstalk characterization and compensation\nAn important requirement for scaling up quantum processors is the individual and independent control of its constituents.\nHere, we characterize three types of crosstalk relevant for the execution of the surface code on our 17-qubit device: microwave drive crosstalk, flux crosstalk, and measurement-induced dephasing.\n\n### Drive crosstalk\n< g r a p h i c s >\n\nDrive crosstalk characterization. For each drive line (DL) targeting qubit $Qi$, crosstalk is expressed as the logarithm of the ratio between the amplitude of a $\\pi$-pulse on the target qubit, $a_i^{\\mathrm{DL} Qi}$, and the amplitude of a $\\pi$-pulse on any other qubit $j$, $a_j^{\\mathrm{DL} Qi}$. The hatched gray area corresponds to cross-driving of far detuned qubits ($\\sim$2 GHz), see text for details. White matrix elements without annotation correspond to DL-qubit pairs with cross-driving ratios $<-1.6$.\n\nDuring the execution of multi-qubit quantum circuits, individual qubits are susceptible to off-resonant driving mediated by microwave pulses applied to drive lines designed to address other qubits.\nEnsuring low cross-driving is therefore essential for the successful execution of the surface code.\n\nWe characterize the coupling rates of each drive line (DL $Qi$) to all other qubits on the device, by measuring the excited state population of qubit $Qj$ after applying a 100-ns-long Gaussian drive pulse to drive line DL $Qi$ at the frequency of qubit $Qj$. We sweep the pulse amplitude and fit a cosine function to the measured data to obtain the amplitude $a_j^{\\mathrm{DL}\\, Qi}$ corresponding to a $\\pi$-rotation induced on qubit $Qj$. As a measure of cross-driving, we normalize each value by the $\\pi$-pulse amplitude of the target qubit $a_i^{\\mathrm{DL}\\,Qi}$ to obtain the cross-driving ratios, of which we show the negative logarithm  $-\\log_{10}\\left({a_j^{\\mathrm{DL} \\,Qi}}/{a_i^{\\mathrm{DL}\\,Qi}}\\right)$ in <ref>. Given the chosen pulse duration and the maximum drive rate which we can apply without compressing the up-conversion IQ-mixer, this method allows us to resolve cross-driving ratios down to about $-\\log_{10}\\left({a_j^{\\mathrm{DL} \\,Qi}}/{a_i^{\\mathrm{DL}\\,Qi}}\\right)\\approx -1.6$, or equivalently a Rabi rotation angle of 4.6 degrees. We find the off-diagonal elements of the cross-driving matrix on average 1.5 orders of magnitude smaller than the drive rate of the target qubit, which provides an upper bound for the cross-driving of $Qj$ via DL $Qi$, since pulses applied to DL $Qi$ during the execution of the surface code are detuned from the frequency of $Qj$.\n\nSome auxiliary-data qubit pairs in physical proximity exhibit larger crosstalk, most likely mediated by the qubit-qubit coupling resonator.\nHowever, for all these pairs, the drive line addresses a qubit in the other frequency band (see <ref>a and <ref>c for a visual representation of the geometry and the frequency bands) than the cross-coupled qubit (see hatched region in <ref>), which strongly suppresses the effective cross-driving during device operation. Taking both the relative detunings and the experimentally characterized cross-driving ratios into account, we estimate the gate error induced on $Qj$ resulting from applying a $\\pi$-pulse on $Qi$ via DL $Qi$ and find that the gate error is smaller than 0.01\n\nFor qubit pairs within the same frequency band, we find that the expected gate error is smaller than 0.2\nfor the drive line DL D5 and qubits D1 and D4, for which the expected gate errors are 19.2\nAs crosstalk on that scale would significantly impact the execution of the surface code, we compensate the cross-driving of DL D5 on D1 and D4 with an interferometric cancellation drive pulse which has opposite amplitude but is otherwise identical to the pulse arriving at D1 via DL D5.\n\nNote that this characterization measurement was performed in a separate cooldown of the same device.\n\n### Flux crosstalk\nDuring the execution of a two-qubit gate, the transition-frequencies of both qubits are tuned to an intermediate interaction frequency (<ref>), at which the sensitivity of the qubit-frequency to flux is increased. Consequently, the parallel execution of two-qubit gates requires a careful flux crosstalk characterization and compensation.\n\nWe characterize the coupling of each flux line on the device to all qubits using a sequence of Ramsey experiments.\nIn particular, we measure the effect of the flux line with target qubit $Qi$ (FL $Qi$) on any qubit $Qj$ by sweeping the amplitude $V_i$ of a voltage pulse on FL $Qi$ and measuring the phase  induced on $Qj$ in a Ramsey experiment.\nDuring the experiment, $Qj$ is flux-tuned away from its idle frequency to increase its flux sensitivity and thereby increase the signal-to-noise ratio of the measured phase.\nWe convert the measured phase to frequency of $Qj$, $\\fcdeltafreq=\\fcdeltaphase/\\tau_{\\rm fp}$, with $\\tau_{\\rm fp}=60\\,$ns the duration of the flux pulse applied on FL $Qi$, which is close to the mean two-qubit gate duration on our device.\nFinally, we convert the frequency $\\fcdeltafreq(V_i)$ to a flux $\\fcdeltaflux(V_i)$ dependent on the applied voltage $V_i$ and fit a linear function to it, whose slope ${\\rm d}\\Phi_j/{\\rm d}V_i$ corresponds to an element of the flux crosstalk matrix .\nRepeating this procedure for all flux lines and all qubits, we obtain the flux crosstalk matrix.\nFor each flux line FL $Qi$, we normalize all crosstalk elements with respect to the targeted coupling on $Qi$, i.e. ${\\rm d}\\Phi_i/{\\rm d}V_i$, to obtain the cross-flux ratio, which we show on a base-ten logarithmic scale in <ref>a.\n\n< g r a p h i c s >\n\nFlux crosstalk characterization and compensation. a\u00a0Measured flux crosstalk matrix  normalized by its diagonal, for a 60 net-zero flux pulse and without crosstalk compensation (see text for details). b\u00a0Measured flux crosstalk matrix with a single round of flux crosstalk compensation calibrated based on the matrix shown in a. Red numbers indicate a negative sign of $\\mathrm{d}\\Phi_j/\\mathrm{d}V_i$.\n\nWe find that crosstalk (off-diagonal elements) is on average about three orders of magnitude smaller than the target couplings (diagonal elements).  The total induced flux $\\vec{\\Phi} = (\\Phi_1, \\dots, \\Phi_{17})^\\mathrm{T}$ in the SQUID loops when applying voltage pulses with amplitude $\\vec{V}= (V_1, \\dots, V_{17})^\\mathrm{T} $  is given by\n$$\n\n\\vec{\\Phi} = \\fcmtx\\,\\vec{V}\n\n$$\nHence, to induce a target flux vector $\\vec{\\Phi}'$, we program the amplitudes\n$$\n\n\\vec{V}'= \\fcmtx^{-1}\\,\\vec{\\Phi}'\n\n$$\nwhich compensates for the flux line crosstalk between all qubits on the device.\n\nTo verify the effectiveness of our compensation scheme, we repeat the crosstalk characterization measurement with activated flux crosstalk compensation, which yields $\\tilde{\\mathbf{C}}$, see <ref>b. The resulting off-diagonal elements of $\\tilde{\\mathbf{C}}$ are suppressed by two additional orders of magnitude.\nTo further reduce the flux crosstalk in our experiments, we apply the crosstalk compensation method recursively by using $\\tilde{\\mathbf{C}}^{-1}$ as a second compensation matrix.\n\n### Measurement-induced dephasing\nA successful implementation of the surface code requires repeated readout of a subset of auxiliary qubits without disturbing the state of any other qubits. However, in the presence of finite readout crosstalk, a readout pulse on an auxiliary qubit can off-resonantly excite the readout resonator of another qubit, thereby leading to dephasing and/or coherent phase rotations on that other qubit.\n\nTo characterize this effect, we sweep the amplitude of the readout pulse of an auxiliary qubit  while measuring the phase of another qubit  in a Ramsey experiment\u00a0[Unknown Author, \"Unknown Title\", ].\nWe fit the Ramsey-fringes contrast to a Gaussian model and the phase deviation to a quadratic model, from which we extract the measurement-induced dephasing rate $\\Gamma_{ij}$, and the coherent phase rotation $\\Delta\\phi_{ij}$ for the untargeted qubit  when reading out . The additional dephasing rate can be related to a phase-flip probability $P_\\phi^{ij} = [1 - \\exp(-\\Gamma_{ij} \\tau_{\\textrm{RO}})]/2$, where $\\tau_{\\textrm{RO}}$ is the readout pulse duration.\n\nWe characterize the measurement-induced dephasing of all auxiliary qubits on any other qubit, see <ref>. Note that for this measurement, the qubit idle frequency of X1 was changed from 6.097$\\,$GHz to 4.429$\\,$GHz to avoid a microscopic two-level defect whose frequency drifted towards X1's idle frequency.\n\nOn average, we observe a phase-flip probability of $0.09\\,\\%$ and a coherent phase rotation of $0.6^{\\circ}$. In our implementation of the surface code, all Z-type (X-type) auxiliary qubits are measured simultaneously, and therefore their mutual measurement-induced dephasing is not a concern (hatched region in <ref>). We observe the largest dephasing ($P_\\phi = 2.3\\,\\%$ and $\\Delta\\phi = 13.4^\\circ$) on auxiliary qubit Z2, when reading out auxiliary qubit X2, which we attribute to cross-driving of the readout resonator of Z2 by the readout signal targeting X2. This dephasing could partially explain the higher mean syndrome element $\\sigma_m^{\\mathrm{Z}2}$, compared to the other mean syndrome elements (see <ref>c).\n\n< g r a p h i c s >\n\nMeasurement-induced dephasing. a\u00a0Phase flip probability and b coherent phase rotation when measuring auxiliary qubits, on any other qubits. The hatched gray area corresponds to auxiliary qubits which are read out simultaneously in the surface-code experiment (see text for details).\n\nIn future work, we expect that we could correct for the coherent phase rotations by utilizing virtual-$Z$ rotations of equal magnitude and opposite sign.\n\n## Readout characterization\n### Three-state readout\n< g r a p h i c s >\n\nThree-state readout characterization of auxiliary qubit X4 presented as a representative example. We show the first 3000 of the $10^5$ single-shot measurements for each of the three state preparations, after preselection. The\nblue, red, and black areas delimit the regions of the\nintegrated quadrature plane in which a measured data point is\nassigned to $\\ket{0}$, $\\ket{1}$ and $\\ket{2}$, respectively. We indicate the mean (white dot) and the $1 \\sigma$ confidence ellipse (white dashed line) of each Gaussian distribution. The marginal histogram distributions of $u_1$ and $u_2$ are shown in the top and right panel, respectively.\n\nWe dispersively read out the state of the transmon qubits by applying a Gaussian-filtered ($\\sigma = \\SI{10}{ns}$) rectangular pulse with a pulse duration of 200 ns to auxiliary qubits and 300 ns to data qubits, see <ref>b for an example waveform.\nTo optimally distinguish between the first three states of the transmon, we integrate the complex-valued downconverted signals $s(t)$ in real-time on the UHFQA (see <ref>) with two sets of complex-valued, 400-ns-long integration weights $w_i(t)$  [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to obtain\n$$\n\nu_i = \\mathrm{Re}\\left\\{ \\int_0^{t_\\mathrm{int.}} s(t) w_i(t) \\,\\mathrm{d} t \\right\\}.\n\n$$\nWe use the integration weights\n$$\n\\label{key}\nw_1(t) &=& s_{\\ket{1}}^*(t) - s_{\\ket{0}}^*(t), \\\\\nw_2(t) &=& s_{\\ket{2}}^*(t) - s_{\\ket{0}}^*(t)- \\\\\n&& -\\frac{\\int w_1(t)(s_{\\ket{2}}(t) - s_{\\ket{0}}(t)) \\,\\mathrm{d}t}{\\int |w_1(t)|^2 \\,\\mathrm{d}t} w_1(t),\n\n$$\nwhere $s_i(t)$ is the averaged measured readout-resonator response for a qubit prepared in state $i \\in \\{\\ket{0},\\ket{1},\\ket{2}\\}$.\n\nTo characterize the single-shot readout, we prepare the qubit $10^5$ times in each of the three basis states ($\\ket{0}$, $\\ket{1}$, and $\\ket{2}$), and measure the integrated resonator response yielding a pair of values $\\{u_1, u_2\\}$ for each experimental run. Prior to applying the state-preparation pulses we perform a pre-selection readout and reject measurements in which the qubit is not in the ground state. We estimate the thermal population for each qubit as the probability to be in $\\ket{1}$ or $\\ket{2}$ after this pre-selection readout, see <ref>.\nWe fit the distribution of measured $\\{u_1,u_2\\}$ pairs to a trimodal Gaussian mixture model, associating each qubit state to one of the Gaussian components,  see <ref>.\nTo characterize two-state readout, we use only the Gaussian components of the mixture model corresponding to the $\\ket{0}$ and $\\ket{1}$ state.\nBased on the fitted model, we assign the individual readout outcomes to the most likely qubit state and compute the $N$-level readout error (<ref>)\n$$\n\n\\epsilon_{\\textrm{RO}}^{(N)} = 1 - \\frac{1}{N}\\sum_{i = 1}^N P(i|i),\n\n$$\nwhere $P(i|i)$ is the probability of correctly assigning the state $i$ to a qubit prepared in the state $i$.\n\n### Flux pulse-assisted readout\nWe make use of the flux-tunability of our transmon qubits to dynamically change the qubit frequency for the duration of the readout, see <ref>a. This allows us to optimize readout parameters in-situ, such as the readout resonator-qubit detuning and the dispersive shift $\\chi$, see\u00a0<ref> for the parameters during readout. We employ this method for all data qubits to reduce the detuning with the readout resonator during the readout, and for auxiliary qubit X1 to avoid a microscopic defect located close to its idle frequency (<ref>c).\n\nWe use Gaussian-filtered, rectangular flux pulses with short rising and falling edges ($\\sigma=0.5$\u00a0ns) in order to minimize coupling to defects. The flux pulse lasts longer than the readout pulse (see also <ref>) because we continue integrating the readout signal while the readout resonator field is ringing down.\n\n< g r a p h i c s >\n\nPulse sequence used for flux pulse-assisted readout of qubit D1. a The qubit transition-frequency (red solid line) is tuned from its lower sweet spot value (red dotted line), $\\omega_Q \\sim 4\\,$GHz, to a value $\\omega_Q'$ closer to the readout resonator frequency (purple line), using a fast flux pulse. b Intermediate frequency signal programmed on the AWG to generate the readout pulse.\n\n## Numerical Simulations\n### General considerations\nIn this section, we describe how the simulations of the experiment are performed. These simulations are based on the measured device characteristics including the individual qubit coherence times, readout errors (see\u00a0<ref>) and spurious $ZZ$ interactions.\n\n#### Device Hamiltonian\nThe system Hamiltonian includes a flux-tunable transmon Hamiltonian per qubit mode and capacitive-coupling interactions of the form\u00a0$\\hbar g_{k,k'} \\hat{n}_k\\hat{n}_{k'}$, where\u00a0$\\hat{n}_k$ is the charge operator associated with the\u00a0$k$th qubit, and\u00a0$\\hbar g_{k,k'}$ is the capacitive coupling strength between the pair of qubits\u00a0$(k,k')$. Single-qubit gates are modeled by a microwave-drive Hamiltonian of the form\u00a0$2e\\hat{n}_k V_k(t)$, where\u00a0$V_k(t)$ is a time-dependent voltage. Two-qubit gates are modeled by time-dependent flux pulses\u00a0$\\{\\phi_k(t),\\phi_{k'}(t)\\}$ on both target and control qubits in the pair\u00a0$(k,k')$. Here,\u00a0$\\phi_k$ is the external flux applied to the SQUID loop of qubit\u00a0$k$.\n\nTo facilitate the comparison to spectroscopy data used for gate calibration, we move to the flux-dependent basis which diagonalizes the device Hamiltonian,\nresulting in an effective model of the form\n$$\n\n\\begin{split}\n\\hat{H}_\\mathrm{eff}(t)/\\hbar = & \\sum_k \\omega_k[\\phi_k(t)] b^\\dagger_k b_k + \\frac{\\alpha_k}{2}b^{\\dagger 2}_k b^2_k  -i \\Omega_k(t) (b_k - b^\\dagger_k) \\\\\n&+ \\sum_{k<k'} \\xi_{k,k'}[\\phi_k(t),\\phi_{k'}(t)] b^\\dagger_k b_k b^\\dagger_{k'}b_{k'}\\\\\n&+ \\dots\n\\label{eq: effective circuit Hamiltonian}\n\\end{split}\n\n$$\nHere,\u00a0$\\omega_k[\\phi_k(t)]$,\u00a0$\\alpha_k$ and\u00a0$\\Omega_k(t)$ correspond, respectively, to the frequency, anharmonicity and effective drive amplitude of the\u00a0$k$th qubit mode, while\u00a0$\\xi_{k,k'}[\\phi_k(t),\\phi_{k'}(t)]$ is the strength of the cross-Kerr (or $ZZ$) interaction of the form $b^\\dagger_k b_k b^\\dagger_{k'}b_{k'}$ between the pair of modes\u00a0$(k,k')$. Note that the explicit dependence of the qubit frequencies and cross-Kerr interactions on the flux biases\u00a0$\\phi_k$ is omitted below.\nThis model accounts for the change in the $ZZ$-interactions with the bare mode frequencies, and therefore with the external flux biases\u00a0$\\{\\phi_k(t),\\phi_{k'}(t)\\}$ during the two-qubit gates.\nHigher-order interactions represented by the dots in\u00a0<ref> are not included in this effective model. Indeed, the impact of such nonidealities is minimized by device design and careful scheduling of the two-qubit gates, as described in <ref>.\n\nWe describe relaxation and dephasing with the effective zero-temperature master equation for the system's density matrix\u00a0$\\rho(t)$\n$$\n\n\\begin{split}\n\\dot{\\rho}(t) &= -i[\\hat{H}_\\mathrm{eff}(t)/\\hbar,\\rho(t)] \\\\\n&+ \\sum_k \\gamma_{1,k} \\mathcal{D}[b_k]\\rho(t) \\\\\n& + \\sum_k \\gamma_{\\varphi,k}[\\phi_k(t)] \\mathcal{D}[b^\\dagger_k b_k]\\rho(t),\n\\label{eq: effective master equation}\n\\end{split}\n\n$$\nwhere\u00a0$\\gamma \\mathcal{D}[\\hat{o}]\\bullet = \\mathcal{D}[\\hat{c}]\\bullet = \\hat{c}\\bullet \\hat{c}^\\dagger -\\{\\hat{c}^\\dagger\\hat{c},\\bullet\\}/2$ for the collapse operator\u00a0$\\hat{c}=\\sqrt{\\gamma}\\hat{o}$, and \u00a0$\\gamma_{1,k}$ and\u00a0$\\gamma_{\\varphi,k}[\\phi_k(t)]$ are, respectively, the decay and dephasing rates associated to mode\u00a0$k$. The dephasing rates of the qubits involved in two-qubit gates incorporate a flux-bias dependence\u00a0$\\gamma_{\\varphi,k}[\\phi_k(t)]$ which is determined experimentally.\n\n#### Numerical solver\nTo make the simulation of the 17-qubit chip numerically tractable, with each qubit modeled as a $d$-dimensional Kerr-nonlinear oscillator, we employ the method of Monte Carlo wavefunctions\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] as implemented in QuTiP's \u00a0[Unknown Author, \"Unknown Title\", ]. Because it evolves wavefunctions of size $d^{17}$ rather than the $d^{17}\\times d^{17}$ density matrix necessary for a master-equation simulation, the memory requirements are significantly reduced in this approach with respect to the master-equation simulation.\n\nSuccinctly, the Monte Carlo method evolves a stochastic wavefunction\u00a0$|\\psi(t)\\rangle$ according to a non-Hermitian Hamiltonian\u00a0$H_\\mathrm{nh} = H_\\mathrm{eff}(t) - i\\frac{\\hbar}{2} \\sum_l c_l^\\dagger c_l$, where\u00a0$c_l$ are the collapse operators of the system's master equation. Time-evolution under $H_\\mathrm{nh}$ for a time $dt$ leads to a decrease of the norm-square of the wavefunction by $dp = \\sum_l dt\\langle \\psi(t)|c_l^\\dagger c_l|\\psi(t)\\rangle\\ll 1$. At time\u00a0$t+dt$, the wavefunction\u00a0$|\\psi(t+dt)\\rangle$ is renormalized with probability\u00a0$1-dp$, or subject to a single quantum jump with probability\u00a0$dp$. In the case of a jump, the wavefunction collapses to the state\u00a0$c_{l}|\\psi(t)\\rangle/{ \\langle \\psi(t)|c_{l}^\\dagger c_{l}|\\psi(t)\\rangle}^{1/2}$ with relative probability\u00a0$\\langle \\psi(t)|c_{l}^\\dagger c_{l}|\\psi(t)\\rangle/\\sum_{l'} \\langle \\psi(t)|c_{l'}^\\dagger c_{l'}|\\psi(t)\\rangle$.\n\nOne realization of this stochastic evolution is known as a quantum trajectory, and an advantage of this approach is that multiple such trajectories can be numerically computed in parallel [Unknown Author, \"Unknown Title\", ]. With a sufficiently large number of trajectories, one can recover the solution of the master equation in\u00a0<ref> as\n$$\n\n\\mathbb{E}[|\\psi(t\\rangle\\langle \\psi(t)|] = \\rho(t).\n\\label{eq: mcsolve convergence}\n\n$$\nExpectation values of an observable\u00a0$\\hat{O}$ are similarly obtained from\n$$\n\n\\mathbb{E}[\\langle\\psi(t)|\\hat{O}|\\psi(t)\\rangle] = \\mathrm{tr}[\\rho(t) \\hat{O}].\n\\label{eq: mcsolve convergence observable}\n\n$$\nWe adjust the solver's error-tolerance parameters such\nthat\u00a0<ref> holds numerically (see\u00a0). To do so,\nwe determine the appropriate solver parameters by comparing the result of\u00a0 to that produced by the complete master-equation solver\u00a0 for systems of up to seven qubits and error-tolerance parameters set to numerical accuracy. In our stochastic simulations, we determine the number of trajectories that are needed by analyzing the convergence of\u00a0<ref> for all the stabilizer and logical-qubit operators.\nWe found that 50k trajectories were sufficient to estimate these expectation values with a sampling uncertainty of less than $1\\,\\%$, for the reduced model that we introduce below.\n\n#### Measurement model\nQubit measurements are modeled by letting the qubit idle for a time equal to the experimental readout time, followed by the projection of the stochastic wavefunction according to\n$$\n\n|\\psi\\rangle\\to \\frac{\\Pi^j_k|\\psi\\rangle}{\\sqrt{p^j_k}},\n\\label{eq: projective measurement rule}\n\n$$\nwhere $\\Pi^j_k=|j\\rangle\\langle j|_k$ is the single-qubit projector of the qubit\u00a0$k$, \u00a0$j\\in\\{0,1\\}$ corresponds to the measured qubit state, and $p^j_k=\\langle\\psi|\\Pi^j_k|\\psi\\rangle$ is the probability of measuring qubit\u00a0$k$ in the state\u00a0$j$. We model qubit readout errors by flipping the result of the measurement with a probability that is computed from the readout assignment matrix for each qubit.\n\n#### Single-qubit gate model\nSingle-qubit gates on qubit\u00a0$k$ are implemented with a Gaussian DRAG waveform with carrier frequency\u00a0$\\omega_k$\u00a0[Unknown Author, \"Unknown Title\", ] and additional virtual-$Z$ gates\u00a0[Unknown Author, \"Unknown Title\", ] when needed.\nTo speed up the simulations, we drop counter-rotating terms following the usual rotating-wave approximation (RWA).\nWe test this approximation by first comparing the average gate error per qubit with and without the counter-rotating terms, which we find to be limited by decoherence instead. Second, we have found no significant discrepancy in the estimated value of the logical qubit operators when using a RWA for simulating circuits with up to seven-qubits in a setup similar to that of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for up to five quantum-error-detection cycles.\n\n#### Two-qubit gate model\nbetween a pair of qubits\u00a0$(k,k')$ are emulated by the free evolution of the effective Hamiltonian\u00a0$(\\pi/t_g-\\xi_{k,k'})b^\\dagger_k b_k b^\\dagger_{k'}b_{k'}$, where\u00a0$t_g$ is the experimental gate time.\nDuring the gate time, we change the dephasing rates\u00a0$\\gamma_{\\varphi,k}$ and\u00a0$\\gamma_{\\varphi,k'}$ of the two qubits involved in the gate to the effective values corresponding to the coherence times measured experimentally for the 24 different controlled-$Z$ gates at the qubit interaction frequencies, see <ref>.\n\nGiven that the qubits are flux-biased at specific interaction frequencies during the gate time, we also account for the residual cross-Kerr interactions by adjusting the interaction strengths $\\xi_{k,k'}$ of the gate qubits with their neighbors on the device. With this model, we simulate an average gate infidelity of $0.9\\,\\%$, which is consistent with the median of the interleaved randomized benchmarking error of $1.2\\,\\%$. Data post-selection in the experiment mitigates the impact of leakage to a large extent and enables the use of a simpler model of the two-qubit gates which involves levels only within the computational subspace. As discussed in\u00a0<ref>, the performance of some of the two-qubit gates is limited by the interaction of qubits with strongly coupled two-level defects, an effect which is not included in the model used for the simulations.\n\n#### Pulse schedule\nCombining our model for the single- and two-qubit gates with projective measurements, we concatenate these operations to compose the pulse sequences used in the quantum error correction experiment, including buffer times, state-preparation and measurement pulses.\n\n### Reduced 9+4 model\nBy using the Monte Carlo solver we can simulate a 17-qubit system in a reasonable time using a general-purpose workstation: approximately 25\u00a0s per trajectory per error-correction cycle with a clock speed of\u00a0$\\sim 3$\u00a0GHz and using about $6$\u00a0GB of RAM. However, improvements in runtime and potential extensions of this method to even larger systems are possible with effective models with a reduced number of qubits. In this section, we describe an approximate model that employs a total of 13 qubits and is obtained by tracing out the auxiliary-qubit modes that do not participate in a given stabilizer measurement.\n\nIn practice, this effective model significantly reduces the simulation requirement to about 2\u00a0s per trajectory per QEC cycle while using less than $1$\u00a0GB of memory. A schematic illustration of the two models in consideration is provided in\u00a0<ref>.\n\n< g r a p h i c s >\n\na Illustration of the 9+4 model. Logical\u00a0$Z$ ($X$) stabilizer measurements are simulated by tracing out the state of the\u00a0X-type (Z-type) auxiliary qubits prior to the stabilizer measurement.\u00a0$\\rho(\\{\\bullet\\})$ refers to a density matrix describing the subsystem\u00a0$\\{\\bullet\\}$ of qubits indexed by color. b Full 17-qubit model includes all qubits at all times in the simulation.\nc Comparison between the decoded simulated data for the reduced 9+4- and the full 17-qubit model. The parameters of the simulation are those measured on the device and provided in\u00a0<ref>. We observe an\nexcellent agreement of the resulting logical\u00a0$T_1$ and\u00a0$T_2$ times between these two models.\n\nTo introduce the \u201c9+4\u201d model, we first consider the Z-type stabilizer measurements which constitute the first half of the QEC cycle. As illustrated in\u00a0<ref>a (see also\u00a0<ref>a), the circuit only involves single- and two-qubit operations on the nine data and four Z-type auxiliary qubits. Meanwhile, the measurement of the X-type auxiliary qubits, which occurs in 400\u00a0ns, projects those qubits into a product state of the form\u00a0$|X_n\\rangle=\\bigotimes_{k''\\in\\mathrm{X-aux.}}|j_{k''}\\rangle$ with\u00a0$j_{k''}\\in\\{0,1\\}$. By assuming that the state of the X-type auxiliary qubits remains close to a product state during the full semi-cycle duration, it is possible to trace-out those qubit modes from the Hamiltonian. Following the measurement, the best description of the auxiliary modes is given by a product of single-qubit density matrices of the form\u00a0$|1_{k''}\\rangle\\langle 1_{k''}|e^{-t/T_{1,k''}} + |0_{k''}\\rangle\\langle 0_{k''}|(1-e^{-t/T_{1,k''}})$ if the measurement result for qubit\u00a0$k''$ is 1, and\u00a0$|0_{k''}\\rangle 0_{k''}|$ otherwise. In other words, this corresponds to the effective model\n$$\n\n\\begin{split}\n\\hat{H}_\\mathrm{red}(t)/\\hbar &= \\sum_{k} \\Big(\\omega_k +  \\sum_{k''\\in X} \\xi_{k,k''}e^{-t/T_{1,k''}} \\langle b_{k''}^\\dagger b_{k''}\\rangle\\Big) b^\\dagger_k b_k \\\\\n&+ \\frac{\\alpha_k}{2}b^{\\dagger 2}_k b^2_k -i \\Omega_k(t) (b_k - b^\\dagger_k) \\\\\n&+ \\sum_{k<k'} \\xi_{k,k'} b^\\dagger_k b_k b^\\dagger_{k'}b_{k'},\n\\label{eq: effective reduced circuit Hamiltonian}\n\\end{split}\n\n$$\nwhere the subindices\u00a0$k$ and\u00a0$k'$ run over data and\u00a0Z-type auxiliary qubits, and\u00a0$\\langle b_{k''}^\\dagger b_{k''}\\rangle$ is the expectation value of\u00a0$b_{k''}^\\dagger b_{k''}$ immediately after the preceding\u00a0X-type auxiliary measurement. After evolving the 13-qubit wavefunction under $\\hat{H}_\\mathrm{red}(t)$ for the full semi-cycle, the projective measurement of the four Z-type auxiliary qubits is performed and the state of the system at time\u00a0$T$ is updated as\n$$\n\n|\\psi(T)\\rangle|Z_n\\rangle\\to|\\psi(T)\\rangle|X_n\\rangle,\n\\label{eq: state update}\n\n$$\nwhere $|\\psi(T)\\rangle$ describes the state of the data qubits after the projection. We perform the simulation of the following\u00a0X-type stabilizer measurement in a similar way.\n\nIn our simulations, we account for some of the noise associated with the auxiliary qubits that were traced out. First, as\u00a0<ref> shows, the cross-Kerr interaction between an auxiliary qubit that has been traced out and its neighboring data qubits varies in time to account for the auxiliary qubit's finite\u00a0$T_1$ time. Second, the idling state of a traced-out auxiliary qubit\u00a0$k''$ after its measurement is modeled by flipping\u00a0$|j_{k''}\\rangle$ from $|1\\rangle$ to $|0\\rangle$ with probability\u00a0$1-\\exp{\\left(-T_\\mathrm{semi-cycle}/T_{1,k''}\\right)}$, where\u00a0$T_\\mathrm{semi-cycle}$ is the time of a quantum error correction semi-cycle. The resulting auxiliary-qubit state from this process is used to simulate the next quantum error correction cycle.\n\nTo test the validity of this reduced model, <ref>c shows a comparison between the results obtained for the reduced 9+4- and 17-qubit models for up to eight QEC cycles. The parameters of the simulation reflect those of the measured device, as discussed above. We show the decoded data from a logical-state preservation simulation as a function of the number of QEC cycles, from where we can infer the logical\u00a0$T_1$ and\u00a0$T_2$ for the two models. We use the decoder described in\u00a0<ref> with weights that are extracted from the simulation data for each model. The result shows an excellent agreement between the reduced and full models of the experiment, with a discrepancy that is contained in the error of the exponential fit. This observation gives us confidence about the accuracy of the 9+4 model used to perform the simulations reported in the main text. We note that, while limited in some respects, our effective model goes beyond previous approaches\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] in the treatment of correlated errors (spurious\u00a0$ZZ$) and dissipation in continuous time.\n\n## Stabilizers\nThe distance-three surface code comprises eight stabilizer operators, i.e.\u00a0products of $\\hat Z$ or $\\hat X$ Pauli operators of a subset of the nine data qubits, as listed in <ref>.\nWe characterize the quantum circuit realizing each  (<ref>a,b) for the $2^N$ input states of the $N \\in \\{2,4\\}$ data qubits of a given plaquette (<ref>a) and compute the stabilizer error\n$$\n\n\\epsilon = 1 - \\frac{1}{2^N}\\sum_{n=1}^{2^N} \\frac{1}{2}|\\overline{s}^{Ai}_n -\\overline{s}^{Ai}_{n, \\mathrm{ideal}}|,\n\n$$\nsee <ref>.\n\nStabilizers  of the distance-3 surface code, characterized by the measured stabilizer error ($\\epsilon$) and the stabilizer error ($\\epsilon_\\mathrm{sim}$) determined from simulation.\n\nSymbol     Stabilizer      $\\epsilon$ (\n1      $\\pz_1\\pz_4$     2.9     2.8\n\n2      $\\pz_4\\pz_5\\pz_7\\pz_8$     8.4     5.0\n\n3      $\\pz_2\\pz_3\\pz_5\\pz_6$     6.8     4.3\n\n4      $\\pz_6\\pz_9$     2.5     2.0\n\n1      $\\px_2\\px_3$      5.7     6.7\n\n2      $\\px_1\\px_2\\px_4\\px_5$     5.9     3.9\n\n3      $\\px_5\\px_6\\px_8\\px_9$     11.8     4.4\n\n4      $\\px_7\\px_8$     4.5     2.6\n\nWeight-two average     3.9     3.5\n\nWeight-four average     8.2     4.4\n\nAverage     6.1     3.9\n\nWe measure an average weight-two stabilizer error of $3.9\\,\\%$, which is in good agreement with the $3.5\\,\\%$ average weight-two stabilizer error extracted from numerical simulations (<ref>).\nThe average weight-four stabilizer error obtained from measurements ($8.2\\,\\%$) is larger than the one obtained from simulation ($4.4\\,\\%$), which we identify as most likely due to the interaction with microscopic defects, residual coherent errors in two-qubit gates, and residual crosstalk which are not modeled in our numerical simulations (<ref>).\n\n## Logical state initialization and characterization\nHere, we describe the characterization of the  prepared nine-data-qubit logical states by measuring their quantum state fidelity  with respect to (i) the target state, (ii) the target logical subspace, and (iii) states in correctable subspaces.\n\n### Fidelity with respect to the target state\nWhile the complete tomographic reconstruction of a generic quantum state $\\rho$ of $n=9$ qubits would require the measurement of $4^n = 262144$ independent Pauli correlators \u00a0[Unknown Author, \"Unknown Title\", ], the measurement of the fidelity with respect to a target logical state $ \\rho_{\\lz} =|0\\rangle_{\\mathrm{L}}\\langle 0|_{\\mathrm{L}} = $\nexpressed in terms of the projector  onto the logical subspace and the projector   onto an eigenstate of $Z_L$\n$$\n\n\\prlogicalsubspace{}\\prlogicaloperator{}\n& = \\frac{1}{2^9} (1 + \\lopz) \\prod_{i = 1}^{4} (1 + s^{\\mathrm{X}i}\\hat S^{\\mathrm{X}i}) \\prod_{i = 1}^{4} (1 + \\hat S^{\\mathrm{Z}i}) \\label{eq:rho_z_prod}\\\\\n&= \\frac{1}{512}\\sum_{j=1}^{512} \\gamma_j \\hat P_j \\label{eq:lz_pauli}\n\n$$\nrequires the measurement of only $2^n =512$ terms \u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Here, $s^{\\mathrm{X}i}$ are the outcomes of the $X$-stabilizer measurements obtained in the state initialization,  $\\hat P_i$ are 9-qubit Pauli correlators obtained from expanding the product in <ref>, and the $\\gamma_j$ take values $+1$ or $-1$ depending on the individual outcomes of $\\{s^{\\mathrm{X}i}\\}$.\nThe fidelity $ \\mathcal{F_\\mathrm{phys}}$ of state $\\rho$ with respect to  is given by\n$$\n\n\\mathcal{F_\\mathrm{phys}}  = \\trace \\left( \\rho \\rho_{\\lz} \\right)\n= \\frac{1}{512} \\sum_{j=1}^{512}\\langle \\gamma_j \\hat P_j \\rangle_\\rho \\label{eq:fid_phys_pauli}\n\n$$\nwhere $\\langle  \\gamma_j \\hat P_j \\rangle_\\rho$ corresponds to the expectation value of the Pauli correlator $\\hat P_i$ in state $\\rho$.\n\nWe evaluate each of the 512 Pauli correlators of <ref> with data collected by executing a single quantum error correction cycle, followed by single-qubit tomography rotations on data qubits and a readout of all qubits.\nWe observe that in \u00a080.5\n$\\prod_i^4(1-\\overline{\\sigma}_1^{Zi}) \\approx 84.5\\%$, see  <ref>c.\n\nFor each $\\langle\\gamma_j \\hat P_j \\rangle_\\rho$, we reject leakage events as detected by our three-state readout scheme (<ref>) and account for readout errors (<ref>) on each of the data qubits involved in the correlator. Note that apart from leakage rejection we keep all instances for further data analysis, including those events in which at least one of the four measured i values yields $-1$.\nFollowing <ref>, we then take the average over all expectation values to compute $\\mathcal{F_\\mathrm{phys}}$.\n\n### Fidelity in the logical subspace\nSimilarly, we evaluate the probability of having prepared a state in the logical subspace as\n$$\n\nP_\\mathrm{L} = \\trace \\left( \\rho \\prlogicalsubspace\\right) = \\frac{1}{256} \\sum_{j=1}^{256}\\langle \\gamma_j \\hat P_j \\rangle_\\rho\n\n$$\nwhere the sum extends over the expectation values of the 256 Pauli correlators resulting from the expansion of the projector onto the logical subspace . Together with the value of $ \\mathcal{F_\\mathrm{phys}}$ the probability $P_\\mathrm{L}$ yields an estimate for the logical fidelity $ \\mathcal{F_\\mathrm{L}} =  \\mathcal{F_\\mathrm{phys}}/P_\\mathrm{L}$, which corresponds to the fidelity of the prepared state with the target logical state conditioned on having successfully projected onto the logical subspace.\n\n### Fidelity with respect to states in correctable subspaces\nIn the context of quantum error correction, it is insightful to compute the fidelity of the prepared state with respect to any of the states which are equivalent to the target state up to a correctable error.\nBy construction, a data-qubit state projected to the logical $Z$-basis is a $\\pm 1$ eigenstate of the eight stabilizers $\\sai$ and a $\\pm 1$ eigenstate of $\\lopz{}$. Thus, there are  $2^9 = 512$ distinct eigenstates of the data-qubit space in the logical Z-basis, with pair-wise degenerate syndromes.\nHowever, in a simple error correction scheme, each of the $2^8 = 256$ possible syndromes produced by the eight stabilizers is associated to a single corrective action. Consequently, for each of the 256 pairs of eigenstates with a degenerate syndrome, only one of the two eigenstates can be included in a given correctable subspace. To perform error correction most effectively, one  includes the eigenstate in the correctable subspace, which can be reached by a Pauli error that is more likely to occur on the physical device.\n\nSpecifically, we construct correctable subspaces for  in the following way: for each pair of eigenstates with degenerate syndrome, we compute the lowest weight errors which, when applied to , lead to these two eigenstates, respectively. With the assumption that lower-weight errors are more likely than higher-weight errors, we preferably include the eigenstate that can be reached via the lowest weight error.\nIf the two eigenstates can only be reached by applying errors of equal weight-$n$, we check how many different errors of weight-$n$ lead to each of the two eigenstates, and include the eigenstate that can be reached by more weight-$n$ errors.\nFinally, if both eigenstates can be reached by an equal number of weight $n$ errors, we randomly select one of the two eigenstates.\nNote that with this approach, any correctable subspace includes $\\lz{}$ (trivial +1 eigenstate of all stabilizers and of ), as well as all the states, which  can be reached by applying a weight-one Pauli error on any one of the data qubits.\n\nWe define the fidelity of the prepared state $\\rho$ with respect to a set of $N$ states $\\{\\hat E_n\\lz{}\\}$ as\n\n= \u2211_n=1^N ( \u03c1 \u00ca_n|0\u27e9\u27e8 0|_L\u00ca_n^\u2020)\n= 1/512\u2211_n=1^N ( \u03c1\u2211_j=1^512\u00ca_n \u03b3_j P\u0302_j \u00ca_n^\u2020)\n\nwhere we have made use of <ref>.\nWe observe that $\\hat E_n  \\hat P_j \\hat E_n^\\dagger = c_{j, n} \\hat P_j$ with $c_{j, n} = \\pm 1$ because  $\\hat E_n$ and $\\hat P_j$ are both tensors of Pauli matrices, and all matrices in the Pauli group commute or anti-commute.\nConsequently,\n$$\n\n\\fcorrectable = \\frac{1}{512} \\sum_{n=1}^N \\sum_{j=1}^{512}  c_{j, n} \\langle \\gamma_j \\hat P_j \\rangle_\\rho  \\label{eq:fid_corr_pauli}\n\n$$\ncan be computed based on the same set of 512 measured expectation values $\\langle \\gamma_j \\hat P_j \\rangle_\\rho $ with the appropriate combination of sign prefactors $c_{j, n}$. This circumvents the need to measure the expectation value of 512 Pauli correlators for each of the $N=256$ states spanning the correctable subspace.\n\nWe evaluate the fidelity  of the prepared state with respect to any state in the correctable subspace for 500 different correctable subspaces randomly chosen according to the procedure described above. We obtain a mean correctable fidelity averaged over the 500 correctable subspaces of $\\fcorrectable = 96.0(9)\\, \\%$.\nThe 4.0(9)\n\n## Pulse sequence\nWe realize the quantum circuit presented in <ref> a with a combination of microwave and flux pulses applied to the 17 qubits, see <ref> for the complete pulse sequence of a single cycle of quantum error correction used to prepare .\n\n< g r a p h i c s >\n\nAWG pulse sequence for the execution of a single quantum error correction cycle. Single-qubit drive pulses (solid lines), readout pulses (solid lines), and flux pulses (dotted lines) are displayed for each of the 17 qubits, as indicated by the label in the conceptual device representation. Qubit pairs realizing  are connected by shaded gradients. The time axis is segmented (parallel lines intersecting the axes) during idle times for clarity, see text for details.\n\nThe sequence starts with a multiplexed readout of all qubits to herald the ground-state in post-selection. Next, single-qubit drive pulses are applied to a subset of the data qubits to prepare the nine data qubits in one of the four product states $\\ket{0}^{\\otimes 9}$,  $\\lopx{}\\ket{0}^{\\otimes 9}$, $\\ket{+}^{\\otimes 9}$ or $\\lopz{}\\ket{+}^{\\otimes 9}$, each of which is a superposition of the $16$ equivalent instances of the respective target logical state.\nThereafter,  Z-type stabilizers are executed by applying three simultaneous  in four sequential time steps, with a dynamical decoupling pulse applied to all data qubits in between the second and the third two-qubit gate time step. Each  is realized by applying a flux pulse to a data qubit and to the corresponding auxiliary qubit, see the shaded gradient connecting pairs of qubits in <ref>.\nWhile the Z-type auxiliary qubits are being read out, the X-type stabilizers are realized in a similar fashion as the Z-type stabilizers but with $\\pi/2$-rotations implementing basis changes before and after the four time steps of . Finally, all qubits are read out in the Z-basis after a latency of 800 set by the minimum re-triggering period of our acquisition devices.\n\n## Leakage rejection\nWhile non-computational states can provide a useful resource for example to realize two-qubit gates in transmon qubits,\nuncontrolled leakage into non-computational states constitutes a source of errors.\nLeakage has therefore been addressed both theoretically and experimentally by reducing leakage errors [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], by detecting leakage indirectly on both auxiliary and data qubits using hidden Markov models [Unknown Author, \"Unknown Title\", ] or quantum non-demolition measurement protocols [Unknown Author, \"Unknown Title\", ], by developing leakage-aware decoding schemes [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and by converting leakage errors into errors within the computational subspace rendering them correctable in the standard error correction framework [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nFor our experimental realization of the surface code we mitigate leakage, particularly of data qubits, by choosing a frequency configuration and two-qubit gate scheme in which only the auxiliary qubits evolve through the second excited state $|2\\rangle$, keeping the average leakage probability per data qubit and per cycle as low as about two per mill. Furthermore, we detect the remaining leakage events on both the data and auxiliary qubits by implementing a high-fidelity three-state readout scheme (<ref>), which allows us to reject all instances of experimental runs with detected leakage events and to study the performance of quantum error correction independent of leakage dynamics [Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nRetained fraction of experimental runs after leakage rejection. a Retained fraction when rejecting leakage of data qubits only (light, green symbols), of auxiliary qubits only (mid-green), and of both (dark green). Solid black lines are exponential fits to the data. Data corresponds to the state preservation experiments of  and  presented in the main text. b Same as a, but for data from the state preservation experiments of  and .\n\nWhen analyzing the state preservation experiments shown in Fig.\u00a0(Figure fig:state_preservation) of the main text, we find that the retained fraction of runs $r$ in which no leakage event has been detected, decreases to good approximation exponentially with $n$, indicating that the retained fraction of runs per cycle $r_{\\rm c}$\nis independent of the cycle number, see Fig.\u00a0(Figure fig:retained_fractions). The value $r_{\\rm c}\\approx 92.1(3)\\,\\%$, which we obtain from exponential fits $r=Ar_{\\rm c}^n$ (black lines) to the data (dark symbols) is identical within error bars for prepared eigenstates of $\\hat Z_{\\rm L}$ (panel a) and $\\hat X_{\\rm L}$ (panel b). We attribute the slight deviation between the measured data and the exponential fit to the finite probability of falsely classifying a $|1\\rangle$-state as $|2\\rangle$ during readout, which for auxiliary qubits is on average $0.004$ and for data qubits $0.019$. In fact, the probability for having such falsely identified leakage events is proportional to the population of the $|1\\rangle$-state, which for auxiliary qubits increases from cycle to cycle due to their initialization in $|0\\rangle$ and the error correction protocol, approaching 0.5 in the limit of large $n$. Hence, the falsely identified auxiliary-qubit leakage events increase with $n$, approaching about $21\\,\\%$ of the totally detected auxiliary qubit leakage events and explaining the slight increase of detected leakage events per cycle with $n$.\n\nDistinguishing between leakage events on data and auxiliary qubits (lighter data points in <ref> a, b), we find that the probability for having detected a leakage event on any of the nine data qubits is only about $0.015(2)$ per cycle and about $0.075(3)$ for the eight auxiliary qubits.\n\nFor comparison, we also determine the extracted logical error probabilities $\\epsilon_{\\rm L}$ without leakage rejection (i), when rejecting data qubit leakage only (ii), and when rejecting auxiliary qubit leakage only (iii), see Table\u00a0(Table tab:leakage_schemes). For simplicity, we interpret non-rejected measured $|2\\rangle$-states as $|1\\rangle$-states during decoding. Compared to the case when rejecting all detected leakage events (iv), the average absolute increase in the logical error probability is $0.021(2)$ for scheme (i), $0.016(1)$ for scheme (ii), and only $0.001(1)$ for scheme (iii).\nThese results suggest that the low leakage rates achieved on our device, when combined with auxiliary-qubit reset using either feedback in combination with three-state readout or an unconditional scheme [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], could render leakage errors tractable in general.\n\nExtracted logical error per cycle $\\epsilon_{\\mathrm{L}}$ for the experiment preserving eigenstates of  and of  using the indicated leakage rejection schemes. The retained data fraction per cycle $r_c$ after leakage rejection is also indicated.\n\nLeakage rejection     $\\epsilon_{\\mathrm{L}}\\, [\\lopz]$     $\\epsilon_{\\mathrm{L}}\\, [\\lopx]$     $r_c$\n\n(i)   None     0.054(1)     0.049(2)      1.000(0)\n\n(ii)  Data qubits only     0.049(1)     0.044(1)       0.985(2)\n\n(iii) Aux. qubits only     0.033(2)     0.030(1)      0.925(3)\n\n(iv) Aux. and data qubits     0.032(1)     0.029(1)      0.921(3)\n\n## Decoding and weight extraction\nTo identify the most likely sequence of errors having occurred in a single instance of an experimental run, we decode the measured set of syndromes in post-processing by adopting the minimum-weight-perfect matching (MWPM) algorithm described in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. We represent each syndrome element $\\sigma_{m}^{Ai}$ as a vertex of a graph, which has two spatial dimensions set by the layout of auxiliary qubits ${Ai}$ in the surface code lattice, and one temporal dimension indexed by the cycle number $m$. We connect pairs of vertices with edges, each of which represents a particular error at the physical level [Unknown Author, \"Unknown Title\", ].\n\nIn our model, we consider three kinds of errors. First, auxiliary qubit errors, including errors during readout, which are represented by vertices at the same location but separated in time by one cycle ($\\Delta m =1$). Second, auxiliary qubit measurement misclassification errors, i.e. measurement errors which do not change the state of the auxiliary qubit, are represented by edges connecting vertices at the same location but separated in time by two cycles ($\\Delta m =2$). And third, single Pauli errors acting on data qubits, which are represented by edges connecting vertices either to a direct neighbor of the same type ($X$ or $Z$) or to a boundary. Depending on the time at which these errors occur, the corresponding edge either connects to a vertex of the same cycle ($\\Delta m =0$) or the next cycle ($\\Delta m =1$).   We extract the probabilities associated with those edges directly from measured syndrome correlations using the methods described in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Details of this scheme will be provided in a separate publication.\n\nBased on the individual edge error probabilities, we then compute for all pairs of vertices $k$ and $l$ with $\\Delta m \\leq 2$, the total probability $p_{{\\rm }kl}$ of being connected. We do so, by summing the individual probabilities over all possible error paths along the edges of the graph, see Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for details. Here, the terms  $p_{{\\rm }kk}$ correspond to the probability of having vertex $k$ being connected to a boundary.  We convert the matrix of probabilities ${p_{{}kl}}$ into a weight matrix $w_{kl} = -\\ln{p_{{}kl}}$, based on which the MWPM algorithm connects each syndrome element $\\sigma_{m}^{Ai}=1$ either to a second such syndrome element or to a boundary while minimizing the total weight associated with these connections.\n\nTo correct for decoded errors in the final outcome $z_{\\rm L}$ ($x_{\\rm L}$) of the logical operator $\\hat{Z}_{\\rm L}$ ($\\hat{X}_{\\rm L}$), we evaluate ${z}_{\\rm L}=z_1 z_2 z_3$ ($x_{\\rm L}=x_1 x_4 x_7$) from the final data qubit readout and multiply it by $(-1)^M$, where $M$ is the number of syndrome element pairs determined by the MPWM algorithm, which signal a logical error. A syndrome element pair signals a logical error if the underlying error path contains an odd number of errors on those data qubits, which are contained in the logical operator string $\\hat{Z}_{\\rm L} = \\hat{Z}_{1}\\hat{Z}_{2}\\hat{Z}_{3}$ ($\\hat{X}_{\\rm L} = \\hat{X}_{1}\\hat{X}_{4}\\hat{X}_{7}$).\n\nFor consistency we evaluate the weights for each of the experimental and simulated state preservation experiments independently. We verified that the decoding with weights extracted from separate data sets yields the same logical lifetimes.\n\n"}
{"prompt": "What are the key contributions of the paper 'Entanglement Metrology Using a Joint Readout of Superconducting Qubits'?", "completion": "\n\n2pt\n2pt\n\n# Entanglement Metrology Using a Joint Readout of Superconducting Qubits\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nInstitute for Quantum Computing and Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, Canada N2L 3G1\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nAccurate and precise detection of multi-qubit entanglement is key for the experimental development of quantum computation. Traditionally, non-classical correlations between entangled qubits are measured by counting coincidences between single-shot readouts of individual qubits. We report entanglement metrology using a single detection channel with direct access to ensemble-averaged correlations between two superconducting qubits. Following validation and calibration of this joint readout, we demonstrate full quantum tomography on both separable and highly-entangled two-qubit states produced on demand. Using a subset of the measurements required for full tomography, we perform entanglement metrology with $\\sim$$95\\%$ accuracy and $\\sim$$98\\%$ precision despite $\\sim$$10\\%$ fidelity of single measurements. For the highly entangled states, measured Clauser-Horne-Shimony-Holt operators reach a maximum value of $2.61\\pm 0.04$, and entanglement witnesses give a lower bound of $\\sim$$88\\%$ on concurrence. In its present form, this detector will be able to resolve future improvements in the production of two-qubit entanglement and is immediately extendable to 3 or 4 qubits.\n\nSince 1964, when Bell made testable [Unknown Author, \"Unknown Title\", ] the famous paradox formulated by Einstein, Podolsky and Rosen [Unknown Author, \"Unknown Title\", ] questioning non-locality in quantum mechanics, the measurement of correlations between quantum systems has been central to foundational tests against alternate theories. The once `spooky' non-classical correlations known as quantum entanglement have since been amply examined in experiments [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Recently, entanglement has gained prominence as a key resource for large-scale quantum computation, making today's quantum engineer less concerned with foundational issues, and more with the generation and detection of near-perfect entanglement between qubits.\n\nAll approaches to metrology of entanglement, such as quantum state tomography, entanglement witnesses and generalized Bell inequality violations [Unknown Author, \"Unknown Title\", ], require experimental measurement of ensemble-averaged qubit-qubit correlations. The paradigm for such detection used in trapped-ion systems\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], where single-shot qubit readouts with fidelities exceeding $99.99\\%$ have been realized [Unknown Author, \"Unknown Title\", ], is to calculate correlations by measuring coincidences between individual detector `clicks' over many repetitions. In solid-state systems, however, measurement cross-talk and lower readout fidelities make the accurate and precise measurement of  correlations by this approach technically challenging, despite significant improvements in recent years\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Various approaches seeking direct access to  correlations with joint, or quadratic,  on-chip detectors have been theoretically proposed for mesoscopic systems  [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn this Report, we demonstrate entanglement metrology with a single measurement channel that performs a joint readout of two charge-based superconducting qubits. This readout is based on qubit-state dependent shifts of a microwave transmission-line resonator in a circuit quantum electrodynamics architecture [Unknown Author, \"Unknown Title\", ]. By  validating and calibrating the measurement model for this single-channel detector, we circumvent a low $\\sim$$10\\%$ single-shot detection fidelity and obtain ensemble-averaged correlations with $\\sim$$95\\%$ accuracy and $\\sim$$98\\%$ precision. While this joint readout has been previously used in superconducting qubit systems [Unknown Author, \"Unknown Title\", ], we demonstrate for the first time its use to detect state-of-the-art highly-entangled states produced on demand, with fidelity to targeted Bell states $>$$90\\%$, a lower bound of $\\sim$$88\\%$ on concurrence, and violation of Clauser-Horne-Shimony-Holt (CHSH) inequalities [Unknown Author, \"Unknown Title\", ] with a value of $2.61\\pm 0.04$. Furthermore, we anticipate that future improvements in entanglement production with this architecture will be detectable with the joint readout in its present form.\n\n< g r a p h i c s >\n\nExperimental setup and readout. (A) Circuit diagram of experimental setup, representing the cavity as a lumped $L-C$ resonator. Microwave drive tones that address the cavity, $\\omega_{\\text{RF}}$, and qubits, $\\omega_\\text{d}^{\\text{L(R)}}$, are applied via the cavity input line. The left (right) qubit has charging energy $E_C^{\\text{L(R)}}$ and Josephson energy $E_J^{\\text{L(R)}}$ (flux $\\Phi^{\\text{L(R)}}$ tunable via $V^{\\text{L(R)}})$. The multiplexed qubit-state information is transmitted out on a single readout line, amplified through a high electron mobility transistor (HEMT) amplifier at $4\\, \\text{K}$ and mixed down at room temperature for digital processing. (B-E) Color images of transmitted $\\VH$ amplitude as a function of time and cavity drive frequency $\\omega_{\\text{RF}}$, for two-qubit states (B) $\\ket{0,0}$, (C) $\\ket{0,1}$, (D) $\\ket{1,0}$, and (E) $\\ket{1,1}$. In this color scheme blue (white) represents $\\VH=0\\,(1.9)\\, \\mV$. On short time scales $t<T_1^{\\text{L(R)}}$, maximal transmission occurs at different frequencies for the four cases (see text for details). (F) Temporal average of the homodyne voltage transients in (B-E) over the first $500\\,\\ns$ shows well resolved peaks. (G) Measured $\\VH$ transients for drive at the cavity frequency corresponding to $\\ket{0,0}$, showing the measurement transient for the four computational states.\n\nOur device consists of a superconducting transmission-line resonator that couples two transmon qubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Beyond mediating the interaction between the qubits, the bus serves as a single detection channel for their joint readout. Arbitrary single-qubit $x$- and $y$-rotations are performed using in-phase and quadrature microwave pulses resonant with the ground to first-excited state transition of each transmon [Unknown Author, \"Unknown Title\", ]. Reduction of leakage to the second-excited state is accomplished through the technique of derivative removal by adiabatic gate [Unknown Author, \"Unknown Title\", ], resulting in error rates of $\\sim$$1\\%$ in single-qubit rotations (See attached supporting material). Local flux-bias lines tune the qubit transition frequencies on nanosecond time scales, allowing control of single-qubit dynamical phases and of a  $Z^{\\text{L}} \\otimes Z^{\\text{R}}$ interaction, both crucial for implementing a two-qubit conditional-phase (C-phase) gate\u00a0[Unknown Author, \"Unknown Title\", ] (here $Z^{\\text{L(R)}}=\\sigma_z^{\\text{L(R)}}$ is the single-qubit Pauli $z$ operator  [Unknown Author, \"Unknown Title\", ] on the left (right) qubit). A schematic of the experimental setup [Unknown Author, \"Unknown Title\", ] is shown in Fig. 1A.\n\nCombining the single-qubit rotations with the C-phase gate, it is possible to produce maximally-entangled states such as the four standard Bell states, $\\ket{\\Psi_{\\pm}} = (\\ket{0,0} \\pm \\ket{1,1})/\\sqrt{2}$ and $\\ket{\\Phi_{\\pm}} = (\\ket{1,0} \\pm \\ket{0,1})/\\sqrt{2}$, where $\\ket{l,r}$ denotes excitation level $l(r)$ of the left (right) qubit [Unknown Author, \"Unknown Title\", ]. Yet, to accurately and precisely detect arbitrary two-qubit states, a complete physical model and calibration of the joint readout is necessary.\n\nThe physical mechanism enabling the joint readout is a qubit state-dependent dispersive cavity shift that is large relative to the cavity linewidth $\\kappa$. In this `strong dispersive' regime [Unknown Author, \"Unknown Title\", ], the system is described by a dispersive Tavis-Cummings Hamiltonian\n$$\n\nH_{\\text{TC}}/\\hbar = (\\wcav+\\chiL Z^{\\text{L}} +\\chiR Z^{\\text{R}})a^{\\dag}a-\\frac{\\wL}{2}Z^{\\text{L}} - \\frac{\\wR}{2}Z^{\\text{R}},\n\n$$\nwhere $\\wcav$ is the bare resonator frequency, $\\omega^{\\text{L(R)}}$ is the Lamb-shifted ground to first excited state transition frequency for the left (right) qubit, and  $\\chi^{\\text{L(R)}}$ is the left (right) qubit-state dependent cavity shift. Actual parameter values were determined by spectroscopy experiments [Unknown Author, \"Unknown Title\", ]. From Eq. (1), there can be at most four distinct cavity frequencies corresponding to the joint state of the two qubits.\n\nThe linear dispersive shifts are calibrated by measurement of the transmitted homodyne voltage $\\VH$ transient when pulsing a measurement tone, having prepared each of the four computational basis states, $\\ket{0,0}$, $\\ket{0,1}$, $\\ket{1,0}$, $\\ket{1,1}$, with single-qubit rotations. Color images in Figs. 1B-1E show the transient $\\langle\\VH\\rangle$ as a function of  cavity drive frequency $\\omega_{\\mathrm{RF}}$ for the four cases (brackets denote an average over 600,000 repetitions).\nOn time scales $t \\lesssim T_1^{\\mathrm{L(R)}}=1.2(0.9)\\, \\us$, the largest transmission occurs at distinct frequencies for all four cases. The discrete transmission peaks are well resolved in Fig. 1F, showing the time average of $\\langle\\VH\\rangle$ versus frequency over the first $500\\,\\ns$. By matching these frequencies to Eq. (1), we extract $\\chi^{\\text{L(R)}}/2\\pi=13(4)\\,\\MHz$. On long time scales  $t\\gtrsim T_1^{\\mathrm{L(R)}}$,\nthe dominant transmission is at the peak corresponding to $\\ket{0,0}$ for all cases.  The transition between the two time limits is most evident  for $\\ket{1,1}$, which decays partially into $\\ket{0,1}$ and $\\ket{1,0}$ before completely relaxing into the ground state $\\ket{0,0}$.\n\nIt is because $\\chiL$ and $\\chiR$ are both larger than $\\kappa= 1\\, \\MHz$ that a measurement can give joint qubit information. For example, applying a measurement tone at the cavity transmission peak corresponding to $\\ket{0,0}$ queries for the joint property that both qubits are in their ground state. Given the large state-dependent dispersive shifts, the system being in any other state results in a low transmission signal. This is best shown by the four transmission transients in Fig. 1G. The transients for the states $\\ket{0,1}$, $\\ket{1,0}$ and $\\ket{1,1}$ are all different from the transient for $\\ket{0,0}$, but also not identical to each other. Qubit relaxation during the measurement results in the transients converging towards the $\\ket{0,0}$ response on long time scales.\n\nMore rigorously, the idealized measurement $M$ is a projection operator onto $\\ket{0,0}$, $M=\\ket{0,0}\\bra{0,0}=(I+\\ZL + \\ZR+ \\ZL \\otimes \\ZR)/4$, which is sensitive to the polarization of each qubit along its $z$-axis as well as to two-qubit correlations. However, the actual measurement is an ensemble average of $\\VH$ which, due to qubit relaxation and partial overlap of the dispersive peaks, we expect to be described by\n$$\n\n\\langle \\VH \\rangle = \\beta_{II}  + \\beta_{ZI} \\langle \\ZL \\rangle + \\beta_{IZ} \\langle \\ZR \\rangle + \\beta_{ZZ} \\langle \\ZL \\otimes \\ZR \\rangle+\\delta v,\n\n$$\nwhere the $\\beta_{LR}$ are constant coefficients and $\\delta v$ is classical amplifier noise (details in supporting material). The amplifier noise, which limits the single-shot fidelity to $\\sim$$10\\%$, is largely eliminated by repeating the state preparation and measurement 600,000 times over fifteen seconds.\n\nA simple set of Rabi flopping experiments can be performed (Figs. 2A-C) to validate the measurement model of Eq. (2) and place bounds on other terms. The most general model, including all linear combinations of two-qubit Pauli operators [Unknown Author, \"Unknown Title\", ], is\n$$\n\nM = \\sum_{L,R \\in \\{I, X, Y, Z\\}} \\beta_{LR} L \\otimes R.\n\n$$\nFigures 2A and 2B show the measured $\\langle\\VH\\rangle$ as a function of the duration of an applied drive at $\\wL$ and $\\wR$, respectively. In each case the drive induces a Rabi oscillation of the addressed qubit around the $y$-axis of its Bloch sphere [Unknown Author, \"Unknown Title\", ].  The observed oscillations in $\\langle\\VH\\rangle$ are fit (solid lines) excellently by assuming the measurement model in Eq. (3) and the theoretical $\\langle Z \\rangle$ and $\\langle X \\rangle$ for driven qubits (see details in supporting material). From the fit to Fig. 2A (2B), we can estimate deviations from Eq. (2) due to the terms $\\langle\\XL\\rangle$ $(\\langle\\XR\\rangle)$ and $\\langle XZ\\rangle$ $(\\langle ZX \\rangle)$ are each $\\lesssim 2\\%$ of the full range of $\\langle \\VH\\rangle$.\n\n< g r a p h i c s >\n\nMeasurement model from Rabi oscillations. (A-C) Rabi oscillations on the (A) left qubit, (B) right qubit, and (C) simultaneously on both. Solid lines are fits to the model in Eq. (3). See text for details. (D) Fourier transform (FT) of the three Rabi experiments (markers) and of best fits (curves). While the red (blue) traces show one main peak at the Rabi frequency $\\Omega^{\\text{L(R)}}$, the purple traces reveal peaks at $\\Omega^{\\text{L}}$, $\\Omega^{\\text{R}}$, $\\Omega^{\\text{L}} +\\Omega^{\\text{R}}$, and $\\Omega^{\\text{L}}-\\Omega^{\\text{R}}$, demonstrating the mixing property that makes the joint measurement sensitive to qubit-qubit correlations.\n\nThe third experiment (Fig. 2C) measures the homodyne response to simultaneous Rabi drives on both qubits. The observed oscillations not only show frequency components at the individual Rabi frequencies, $\\Omega^{\\text{L}}$ and $\\Omega^{\\text{R}}$, but also at their sum and difference. This is clearly revealed in the Fourier transform of the oscillations (Fig.\u00a02D). This mixing effect agrees quantitatively with the term  $\\langle ZZ \\rangle$ in Eq. (2). An excellent fit is also obtained, giving deviations from Eq. (2) due to $\\langle XX \\rangle$ that are $\\sim 2\\%$ of the full swing of $\\langle \\VH \\rangle$ (see details in the supporting material). These Rabi experiments thus corroborate the measurement model Eq. (2).\n\nBesides testing the measurement model, these Rabi-flopping experiments allow calibration of the coefficients $\\beta_{LR}$ in Eq. (2). The best fits give $\\beta_{II}=800\\,\\mu$V, $\\beta_{IZ}=380\\,\\mu$V, $\\beta_{ZI}=380\\,\\mu$V, and $\\beta_{ZZ}=200\\,\\mu$V. The large ratios $\\beta_{ZZ}/\\beta_{IZ(ZI)}\\approx 0.6$ indicate the high sensitivity of the joint readout to the qubit-qubit correlations.\n\nHaving substantiated the physical nature and the quantitative model of the joint readout, we next use it to perform tomography of a variety of two-qubit states, both separable and entangled, produced on demand. We first perform an over-complete set of 30 raw measurements, each obtained by applying a different pair of simultaneous rotations of the qubits prior to measurement. The qubit rotations are chosen from the set $\\{I, R_x^{\\pm\\pi}, R_x^{\\pm\\pi/2}, R_y^{\\pm\\pi/2}\\}$ (see supporting material). Using the calibration of the $\\beta_{LR}$ and least-squares linear estimation, we then construct the Pauli set $\\Pauli$, whose 16 elements are the expectation values of the two-qubit Pauli operators, $\\langle LR \\rangle$, where $L, R \\in \\{I, X, Y, Z\\}$. Two-qubit states can then be visualized by plotting the Pauli set in bar-graph format, in contrast to plotting the density-matrix in three-dimensional city-scape format\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nRepresentation of two-qubit states using the Pauli set. Experimental Pauli set (with trivial $\\langle II\\rangle=1$ not shown), obtained from  linear operations on raw measurement data, for separable states (A) $\\ket{1,0}$ and  (B) $(\\ket{0,0}-\\ket{0,1}+\\ket{1,0}-\\ket{1,1})/2$ and entangled states (C) $\\ket{\\Psi_+}$ and (D) the Bell state in the $x$-basis $\\ket{\\Phi_+}_x=(\\ket{0,0}+\\ket{0,1}-\\ket{1,0}+\\ket{1,1})/2$. Red (blue) bars correspond to left (right) single-qubit Pauli operators. Purple bars are the qubit-qubit correlations. The fidelities to the four ideal targeted states computed using Eq. (5) are $\\F=98.2 \\pm 0.4\\%$, $96.8 \\pm 0.4\\%$, $90.0 \\pm 0.6\\%$, and $92.5 \\pm 0.7\\%$. The density matrix obtained using the same raw measurements is shown in three-dimensional city-scape format to the right of each Pauli set.\n\nAn advantage of the Pauli set representation is that one can easily distinguish separable from entangled states. In Fig. 3, we use the Pauli set to view the experimentally generated separable states, (A) $\\ket{0,1}$ and (B) $(\\ket{0}+\\ket{1})_{\\text{L}}\\otimes(\\ket{0}-\\ket{1})_\\text{R}/2$, as well as entangled states, (C) $\\ket{\\Phi_+}$,  and (D) the Bell state in the $x$-basis  $\\ket{\\Psi_+}_x=(\\ket{0,0}+\\ket{1,0}-\\ket{0,1}+\\ket{1,1})/2$. For these four states, the Pauli set ideally contains three non-zero bars, all of unit magnitude. The Pauli set can be sub-divided into three sections:\nthe qubit polarization vectors, $\\vec{P}^{\\text{L}}=\\{\\langle\\XL\\rangle, \\langle\\YL\\rangle,\\langle\\ZL\\rangle\\}$ and  $\\vec{P}^{\\text{R}}=\\{\\langle\\XR\\rangle, \\langle\\YR\\rangle,\\langle\\ZR\\rangle\\}$, and the vector of two-qubit correlations $\\vec{Q}=\\{\\langle XR \\rangle, \\cdots, \\langle ZZ \\rangle \\}$. In the figure, $\\vec{P}^{\\text{L}}$, $\\vec{P}^{\\text{R}}$ and $\\vec{Q}$ are color-coded\nred, blue and purple, respectively. For the separable states, we observe near unity components in the three sub-sections of the Pauli set, $\\vec{P}^{\\text{L}}$, $\\vec{P}^{\\text{R}}$, and $\\vec{Q}$. In contrast, for the entangled states, the only large components are in $\\vec{Q}$.\nThe presence of large bars in $\\vec{Q}$ and vanishing $\\vec{P}^{\\text{L}}$, $\\vec{P}^{\\text{R}}$ is a direct signature of a high degree of entanglement.\n\nThe Pauli set representation permits testing of some simple physical constraints, which if not met, reveal systematic errors. The most easily tested physical constraint is $|\\langle LR\\rangle | \\leq 1,\\,\\forall\\, L,R$ (other constraints are $0\\leq|\\vec{P}^{\\text{L,R}}|\\leq 1$, and $0\\leq|\\vec{Q}|\\leq \\sqrt{3}$). Although the states shown in Fig. 3 satisfy these bounds, a more thorough experimental test for systematic errors is to measure the Pauli set for a collection of states that differ only by the angle of a single-qubit rotation prior to measurement. Two such evolutions are shown in Figs. 4A and 4B, which involve a rotation $\\theta$ of the left qubit about its $y$-axis after preparing the separable state $\\ket{0,0}$ (evolution A) and the entangled state $\\ket{\\Psi_+}_x$ (evolution B), respectively.\n\nIn evolution A, varying $\\theta$ produces the oscillation of the Pauli set shown in Fig. 4C. Systematic errors in detection could appear as offsets and amplitudes of the Pauli set betraying the $\\pm 1$ bounds. Such deviations would limit the accuracy of physical quantities extracted from the Pauli set, and thus are important to identify and correct. In Fig. 4C, $\\langle XI\\rangle$, $\\langle ZI\\rangle$, $\\langle XZ\\rangle$, and $\\langle ZZ\\rangle$ oscillate with an average visibility of $97.6 \\pm 0.3 \\%$, demonstrating the large swing of the meter. Moreover, the average absolute error of all the ideally zero-valued bars is $\\lesssim 10\\%$. In evolution B, the dominant oscillating components are all in $\\vec{Q}$, indicating that the state remains entangled throughout all the rotations. In this case, we find a visibility of $91.5\\pm 0.3\\%$, in good agreement with a master equation simulation taking into account qubit relaxation and dephasing. A residual oscillation amplitude of $\\sim$$10\\%$ is observed in $\\langle XI\\rangle$ and $\\langle ZI \\rangle$, a factor $\\sim$$2$ larger than expected from theory. This discrepancy can arise from a combination of small calibration errors  in single-qubit rotations and various residual higher order couplings (see supporting material).  In the future, composite pulses and shaping might further reduce these effects.\n\n< g r a p h i c s >\n\nEvolution of the Pauli set and entanglement witnesses under qubit rotations. (A and B) Gate\nsequences generating evolutions of the Pauli set by subjecting (A) the separable state $\\ket{0,0}$ and (B) the entangled state $\\ket{\\Psi_+}_x$ to  a rotation $R_y(\\theta)$ on the left qubit, $-210^{\\circ} \\leq\\theta \\leq 210^{\\circ}$. (C and D) The measured Pauli set as a function of $\\theta$ for evolutions A and B, respectively. In evolution A, the left qubit polarization rotates along the $x$-$z$ plane, while the right qubit remains fully-polarized along $z$. In evolution B, both qubit polarizations vanish, with the only nonzero and oscillating Pauli operators being qubit-qubit correlators (purple bars). Arrows at $\\theta=-90 (+90)^{\\circ}$ indicate when the ideal two-qubit state is the standard Bell state $\\ket{\\Phi_-} (\\ket{\\Psi_+})$. (E and F) Experimental lower bounds $\\mathcal{B}_i$ (orange) on the concurrence given by the optimal witnesses for Bell states $\\mathcal{W}_{\\Psi +} $ (circles), $\\mathcal{W}_{\\Psi -}$ (squares), $\\mathcal{W}_{\\Phi +}$ (triangles), and $\\mathcal{W}_{\\Phi -}$ (crosses), and fidelity $\\mathcal{F}$ to the ideal state (black circles) for (E) evolution  A and (F) evolution B.  In F, a maximum lower bound is reached by $\\mathcal{B}_{\\Phi -}$ ($\\mathcal{B}_{\\Psi +}$) at $\\theta=-90 (+90)^{\\circ}$.  (G-H) Experimental average value of CHSH operators $\\CHSHzzxx$ (circles), $\\CHSHzxxz$ (squares), $\\CHSHzxzx$ (triangles), $\\CHSHxxzz$ (crosses). (G) For evolution A all $\\mCHSH$ values stay within the separable state bounds $\\pm \\sqrt{2}$ up to measurement noise, while for (H) evolution B, $\\max \\amCHSH = 2.61 \\pm 0.04$. Solid lines are master equation simulations.\n\nFinally, we use the fully characterized and high-visibility readout to extract accurate and precise measurements of physical quantities intrinsic to the two-qubit state. Examples include the fidelity to the targeted state, entanglement witnesses, and CHSH operators.  Interrogations of such quantities are henceforth statements about the quality of the states prepared.\n\nThe fidelity $\\F$ to a targeted state provides one way of quantifying the control over two-qubit states and is given by the inner (dot) product of the measured $\\Pauli$ to that of the ideal state,\n$$\n\n\\F=\\frac{1}{4} \\Pauli \\cdot \\vec{P}_{\\text{ideal}}.\n\n$$\nFor the states produced in evolutions A and B, we find average fidelities $\\mathcal{F}=98.8 \\pm 1.0\\%$ and $93.4 \\pm 1.5\\%$ over all $\\theta$, respectively. The fidelities (black circles) in Figs. 4E-F show excellent agreement with simulation (solid lines). This agreement demonstrates the accuracy of our meter for detecting both separable and entangled states, and the high fidelity values attest to the level of two-qubit control in the experiment.\n\nMeasures beyond fidelity are necessary to quantify the degree of two-qubit entanglement. Often, entanglement monotones such as concurrence $\\conc$\u00a0[Unknown Author, \"Unknown Title\", ] are obtained using non-linear estimators. It is standard to first perform maximum-likelihood estimation [Unknown Author, \"Unknown Title\", ] to generate a physical $\\rho$ despite any statistical or systematic errors in the raw data, and to then calculate these metrics from the eigenvalue spectrum of related matrices [Unknown Author, \"Unknown Title\", ].  This non-linear process complicates the propagation of any statistical and systematic errors in the measurements, and can bias the estimation of such metrics as the purity of the two-qubit state increases [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (See supporting material).\n\nTo be quantitative about entanglement while using only linear operations on the raw measurements, we make use of entanglement witnesses [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. An entanglement witness is a unity-trace observable $\\W$ with a positive expectation value for all separable states, such that $\\tr(\\rho \\W)<0$ guarantees entanglement. Furthermore, $-2 \\tr(\\rho \\W)$ gives a lower bound on $\\conc$\u00a0[Unknown Author, \"Unknown Title\", ]. The optimal witness for a targeted entangled state gives the tightest lower bound. For the Bell states, these are\n\n\ud835\udcb2_\u03a8 +   =   1/4 (II - XX + YY - ZZ),\n\ud835\udcb2_\u03a8 -   =   1/4 (II+XX - YY-ZZ ),\n\ud835\udcb2_ \u03a6 +   =   1/4 (II-XX-YY+ZZ),\n\ud835\udcb2_\u03a6 -   =   1/4(II+XX+YY+ZZ),\n\ngiving lower bounds $\\mathcal{B}_i = -2 \\tr(\\rho \\mathcal{W}_i)$ on $\\conc$.\n\nThe four bounds obtained for evolution A(B) are shown in Fig. 4E(4F). In evolution A, the four bounds are non-positive for all $\\theta$ to within measurement error, indicating that entanglement is not witnessed. This is as expected, since single-qubit rotations should not produce any entanglement. In Fig. 4F, in contrast, bounds $\\B_{\\Psi +}$ and $\\B_{\\Phi -}$ extend into the positive region, reaching $85.9\\pm 1.5\\%$ and $88.1 \\pm 1.5\\%$ at $\\theta=-90^{\\circ}$ and $90^{\\circ}$, respectively. There is at least one positive bound for most $\\theta$ (excluding $\\pm 180^{\\circ}$ and $0^{\\circ}$), indicating that the two qubits are entangled. Solid lines in Figs. 4E-F are obtained from the master equation simulation. The agreement between data and theory shows the accuracy of the entanglement witnesses and the small residuals $\\sim$$2\\%$ demonstrate their precision.\n\nA more well-known entanglement measure is the CHSH operator, often used to test local-hidden variable theories. CHSH operators [Unknown Author, \"Unknown Title\", ] are most generally defined as\n$$\n\n\\CHSH_{A,B,A',B'}= AB +A B' + A'B -  A'B',\n\n$$\nwith left-qubit operators $A$, $A'$ and right-qubit operators $B$, $B'$ being single-qubit Pauli operators along any axis. For separable states, $\\amCHSH \\leq 2$. However, for $A \\perp A'$ and $B \\perp B'$, the separable bound is tighter, $\\amCHSH \\leq \\sqrt{2}$.\n\nFrom the Pauli sets of evolutions A and B, we obtain experimental expectation values of four CHSH operators with $A,A'\\in \\{\\XL,\\ZL\\}$ and $B,B'\\in \\{\\XR,\\ZR\\}$. For the separable states of evolution A (Fig. 4G), we find that to within statistical error, $\\mCHSHzxxz=\\mXX-\\mXZ+\\mZX+\\mZZ$ (squares) and $\\mCHSHzxzx=\\mXX+\\mXZ-\\mZX+\\mZZ$ (triangles) remain within the separable bounds for all $\\theta$. For the entangled states prepared in evolution B (Fig. 4H), instead, $\\mCHSH$ oscillates past the separable bounds. At $\\theta = \\pm 45^{\\circ}$, a maximum value $\\amCHSH=2.61 \\pm 0.04$ is reached. The agreement with theory and proximity of the maximum $\\amCHSH$ to the $2\\sqrt{2}$ upper bound [Unknown Author, \"Unknown Title\", ] further demonstrate the high degree of entanglement of the states produced. We note that while $\\mCHSH$ exceeds the local-hidden variable bound [Unknown Author, \"Unknown Title\", ] of 2 by $\\sim$$15$ standard deviations, this result is not a strict violation of local-hidden variable theories due to locality and measurement loopholes in our system. For superconducting qubits, the measurement loophole has recently been closed using high-fidelity single-shot readout [Unknown Author, \"Unknown Title\", ].\n\nIn summary, we have  performed metrology of entanglement between two superconducting qubits using a single measurement channel giving direct access to qubit correlations. While loopholes  preclude using this joint readout for fundamental tests of quantum mechanics, the demonstrated ability to measure fidelity to targeted states, lower bounds on concurrence and strong violation of CHSH inequalities is eminently useful for quantum-computer engineering. In its present form, this single-channel detector will be able to detect future improvements in the controlled production of entangled states and is immediately extendable to three or four qubits. Similar implementations of joint detection may prove useful for metrology of multi-qubit operations in other qubit platforms  where cross-talk and low measurement fidelity make single-shot individual qubit readouts challenging.\n\nWe acknowledge discussions with R. Blume-Kohout, B. R. Johnson, Jens Koch, N. L\u00fctkenhaus,  K. Resch, C. Rigetti, and D. I. Schuster. This work was supported by LPS/NSA under ARO Contract No. W911NF-05-1-0365,\nand by the NSF under Grants No. DMR-0653377 and No. DMR-0603369.\nWe acknowledge additional support from a CIFAR Junior Fellowship, MITACS, MRI, and NSERC (JMG), and from CNR-Istituto di Cibernetica, Pozzuoli, Italy (LF).\n\n10\n\nbell_einstein-podolsky-rosen_1964\nJ.\u00a0S. Bell, Physics 1, 195 (1964).\n\nEPR\nA.\u00a0Einstein, B.\u00a0Podolsky, and N.\u00a0Rosen, Phys. Rev. 47, 777 (1935).\n\nCH_bell\nJ.\u00a0F. Clauser and M.\u00a0A. Horne, Phys. Rev. D 10, 526 (1974).\n\naspect_bells_1982\nA.\u00a0Aspect, J.\u00a0Dalibard, and G.\u00a0Roger, Phys. Rev. Lett. 49, 1804\n(1982).\n\ntittel_bells_1998\nW.\u00a0Tittel, J.\u00a0Brendel, H.\u00a0Zbinden, and N.\u00a0Gisin, Phys. Rev. Lett. 81,\n3563 (1998).\n\nzeilinger_experiment_1999\nA.\u00a0Zeilinger, Rev. Mod. Phys. 71, 288 (1999).\n\nansmann_thesis\nM.\u00a0Ansmann, Ph.D. thesis, University of California at Santa Barbara (2009).\n\nhorodecki_rmp\nR.\u00a0Horodecki, P.\u00a0Horodecki, M.\u00a0Horodecki, and K.\u00a0Horodecki, Rev. Mod. Phys.\n81, 865 (2009).\n\nHaffner_multiparticle_ions_2005\nH.\u00a0Haffner, W.\u00a0Hansel, C.\u00a0F. Roos, J.\u00a0Benhelm, D.\u00a0Chek-al kar, M.\u00a0Chwalla,\nT.\u00a0Korber, U.\u00a0D. Rapol, M.\u00a0Riebe, P.\u00a0O. Schmidt, C.\u00a0Becher, O.\u00a0Guhne, W.\u00a0Dur,\nand R.\u00a0Blatt, Nature 438, 643 (2005).\n\nLeibfried:2005yq\nD.\u00a0Leibfried, E.\u00a0Knill, S.\u00a0Seidelin, J.\u00a0Britton, R.\u00a0B. Blakestad,\nJ.\u00a0Chiaverini, D.\u00a0B. Hume, W.\u00a0M. Itano, J.\u00a0D. Jost, C.\u00a0Langer, R.\u00a0Ozeri,\nR.\u00a0Reichle, and D.\u00a0J. Wineland, Nature 438, 639 (2005).\n\nmyerson:200502\nA.\u00a0H. Myerson, D.\u00a0J. Szwer, S.\u00a0C. Webster, D.\u00a0T.\u00a0C. Allcock, M.\u00a0J. Curtis,\nG.\u00a0Imreh, J.\u00a0A. Sherman, D.\u00a0N. Stacey, A.\u00a0M. Steane, and D.\u00a0M. Lucas, Phys.\nRev. Lett. 100, 200502 (2008).\n\nmartinis_rabi_2002\nJ.\u00a0M. Martinis, S.\u00a0Nam, J.\u00a0Aumentado, and C.\u00a0Urbina, Phys. Rev. Lett.\n89, 117901 (2002).\n\nsiddiqi_jba_2004\nI.\u00a0Siddiqi, R.\u00a0Vijay, F.\u00a0Pierre, C.\u00a0M. Wilson, M.\u00a0Metcalfe, C.\u00a0Rigetti,\nL.\u00a0Frunzio, and M.\u00a0H. Devoret, Phys. Rev. Lett. 93, 207002 (2004).\n\nLupascu:2007nx\nA.\u00a0Lupascu, S.\u00a0Saito, T.\u00a0Picot, P.\u00a0C. de\u00a0Groot, C.\u00a0J. P.\u00a0M. Harmans, and J.\u00a0E.\nMooij, Nature Phys. 3, 119 (2007).\n\ntrauzettel:235331\nB.\u00a0Trauzettel, A.\u00a0N. Jordan, C.\u00a0W.\u00a0J. Beenakker, and M.\u00a0B\u00fcttiker, Phys.\nRev. B 73, 235331 (2006).\n\nMao_mesoQM_2004\nW.\u00a0Mao, D.\u00a0V. Averin, R.\u00a0Ruskov, and A.\u00a0N. Korotkov, Phys. Rev. Lett.\n93, 056803 (2004).\n\nwallra_strong_2004\nA.\u00a0Wallraff, D.\u00a0I. Schuster, A.\u00a0Blais, L.\u00a0Frunzio, R.-S. H.\u00a0J. Majer, S.\u00a0Kumar,\nS.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Nature 431, 162 (2004).\n\nfilipp_joint_2009\nS.\u00a0Filipp, P.\u00a0Maurer, P.\u00a0J. Leek, M.\u00a0Baur, R.\u00a0Bianchetti, J.\u00a0M. Fink, M.\u00a0Goppl,\nL.\u00a0Steffen, J.\u00a0M. Gambetta, A.\u00a0Blais, and A.\u00a0Wallraff, Phys. Rev. Lett.\n102, 200402 (2009).\n\nclauser_proposed_1969\nJ.\u00a0F. Clauser, M.\u00a0Horne, A.\u00a0Shimony, and R.\u00a0A. Holt, Phys. Rev. Lett.\n23, 880 (1969).\n\nkoch_charge-insensitive_2007\nJ.\u00a0Koch, T.\u00a0M. Yu, J.\u00a0Gambetta, A.\u00a0A. Houck, D.\u00a0I. Schuster, J.\u00a0Majer,\nA.\u00a0Blais, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev. A\n76, 042319 (2007).\n\nschreier_suppressing_2008\nJ.\u00a0A. Schreier, A.\u00a0A. Houck, J.\u00a0Koch, D.\u00a0I. Schuster, B.\u00a0R. Johnson, J.\u00a0M.\nChow, J.\u00a0M. Gambetta, J.\u00a0Majer, L.\u00a0Frunzio, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and\nR.\u00a0J. Schoelkopf, Phys. Rev. B 77, 180502 (2008).\n\nchow_bm_2009\nJ.\u00a0M. Chow, J.\u00a0M. Gambetta, L.\u00a0Tornberg, J.\u00a0Koch, L.\u00a0S. Bishop, A.\u00a0A. Houck,\nB.\u00a0R. Johnson, L.\u00a0Frunzio, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev.\nLett. 102, 090502 (2009).\n\nmotzoi_2009\nF.\u00a0Motzoi, J.\u00a0M. Gambetta, P.\u00a0Rebentrost, and F.\u00a0K. Wilhelm, arXiv:0901.0534\n(2009).\n\ndicarlo_2009\nL.\u00a0DiCarlo, J.\u00a0M. Chow, J.\u00a0M. Gambetta, L.\u00a0S. Bishop, B.\u00a0R. Johnson, D.\u00a0I.\nSchuster, J.\u00a0Majer, A.\u00a0Blais, L.\u00a0Frunzio, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf,\nNature 460, 240 (2009).\n\nnielsen_chuang_2000\nM.\u00a0A. Nielsen and I.\u00a0L. Chuang, Quantum Computation and Quantum\nInformation (Cambridge University Press, Cambridge, 2000).\n\nchow_supp\nMaterials and methods available in supporting material.\n\nschuster_resolving_2007\nD.\u00a0I. Schuster, A.\u00a0A. Houck, J.\u00a0A. Schreier, A.\u00a0Wallraff, J.\u00a0M. Gambetta,\nA.\u00a0Blais, L.\u00a0Frunzio, B.\u00a0Johnson, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and R.\u00a0J.\nSchoelkopf, Nature 445, 515 (2007).\n\notimes_note\nFor the rest of the text we adopt the notation ${L} \\otimes {R} \\to\n{LR}$ for ${L},{R}\\in\\{{I},{X},{Y},{Z}\\}$.\n\nJames_qubitmeas_2001\nD.\u00a0F.\u00a0V. James, P.\u00a0G. Kwiat, W.\u00a0J. Munro, and A.\u00a0G. White, Phys. Rev. A\n64, 052312 (2001).\n\nblume\nR.\u00a0Blume-Kohout, arXiv:quant-ph/0611080v1  (2006).\n\nHome:2009fv\nJ.\u00a0P. Home, D.\u00a0Hanneke, J.\u00a0D. Jost, J.\u00a0M. Amini, D.\u00a0Leibfried, and D.\u00a0J.\nWineland, Science, DOI: 10.1126/science.1177077 (6 August 2009).\n\neisert_witness_2007\nJ.\u00a0Eisert, F.\u00a0G. S.\u00a0L. Brandao, and K.\u00a0M.\u00a0R. Audenaert, New J. Phys.\n9, 46 (2007).\n\nCirelson_1980\nB.\u00a0S. Cirel'son, Lett. Math. Phys. 4, 93 (1980).\n\n"}
{"prompt": "Explain the methodology used in the paper 'Millisecond charge-parity fluctuations and induced decoherence in a superconducting qubit'.", "completion": "\n\n# Millisecond charge-parity fluctuations and induced decoherence in a superconducting qubit\n\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nJILA, National Institute of Standards and Technology and Department of Physics, University of Colorado, Boulder, Colorado 80309, USA\n\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046,\n2600 GA Delft, The Netherlands\n\nQuasiparticle excitations adversely affect the performance of superconducting devices in a wide range of applications.\nThey limit the sensitivity of photon detectors in astronomy\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the accuracy of current sources in metrology\u00a0[Unknown Author, \"Unknown Title\", ], the cooling power of micro-refrigerators\u00a0[Unknown Author, \"Unknown Title\", ], and could break the topological protection of Majorana qubits\u00a0[Unknown Author, \"Unknown Title\", ].\nIn superconducting circuits for quantum information processing, tunneling of quasiparticles across Josephson junctions constitutes a decoherence mechanism\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. As relaxation and pure dephasing times of transmon-type charge qubits now reach $100~\\us$, understanding whether quasiparticle tunneling may already bottleneck coherence is of high interest.\nWe integrate recent advances in qubit readout\u00a0[Unknown Author, \"Unknown Title\", ] and feedback control\u00a0[Unknown Author, \"Unknown Title\", ] in circuit quantum electrodynamics\u00a0[Unknown Author, \"Unknown Title\", ] to perform the first real-time observation of quasiparticle tunneling in a transmon qubit. We demonstrate  quasiparticle-tunneling contributions to qubit relaxation and pure dephasing in the millisecond range. Thus, quasiparticle tunneling will not limit coherence for at least  one order of magnitude beyond the state of the art.\n\nThe preservation of  charge parity (even or odd number of electrons) has historically been of primary concern in superconducting quantum information processing (QIP). In the first superconducting qubit, termed Cooper pair box (CPB)\u00a0[Unknown Author, \"Unknown Title\", ], maintaining the parity in a small island connected to a reservoir via Josephson junctions is essential to qubit operation. The qubit states $\\ket{0}$ and $\\ket{1}$ consist of symmetric superpositions of charge states of equal parity,  brought into resonance by a  controlled charge bias $n_g$ and split by the Josephson tunneling energy $\\EJ$ ($\\lesssim \\EC$, the island Cooper-pair charging energy). Quasiparticle (QP) tunneling across the junction changes the island parity, \u201cpoisoning\u201d the box until  parity switches back or $n_g$ is offset by $\\pm e$\u00a0[Unknown Author, \"Unknown Title\", ]. QP poisoning in CPBs has been extensively studied, with most experiments\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] finding  parity switching times of $10~\\us - 1~\\ms$, and some $>1~\\s$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  While these times are long compared to qubit gate operations ($\\sim10~\\ns$), the sensitivity of the CPB qubit transition frequency $\\wzo$ to background charge fluctuations  limits the  dephasing time to $<1~\\us$, severely restricting the use of traditional CPBs in QIP.\n\nEngineering the CPB into the transmon regime $\\EJ\\gg\\EC$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] exponentially suppresses the sensitivity of $\\wzo$ to charge-parity and background charge fluctuations. However, recent theory\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] predicts that QP tunneling remains a relevant source of qubit relaxation and pure dephasing, particularly as  improved understanding of dielectric loss\u00a0[Unknown Author, \"Unknown Title\", ] and the Purcell effect\u00a0[Unknown Author, \"Unknown Title\", ] has allowed reaching the $100~\\us$ scale in cQED. To guide further improvements, it is imperative to precisely pinpoint the timescale for QP tunneling and its contribution to qubit decoherence. To date, only upper and lower bounds have been placed\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nBistability and drift of the qubit transition frequency. a, Ramsey fringe experiment (dots) and  best-fit sum of two decaying sinusoids (curve). The reference oscillator is detuned $1~\\MHz$ from the average qubit transition frequency $\\wzo/2\\pi=4.387~\\GHz$. b, Sketch of the charge dispersion of the first two levels of the transmon qubit, showing $2e$ periodicity.\nQP tunneling across the junction shifts $n_g$ precisely by $e$, resulting in two transition frequencies  $\\fev$ and $\\fod$ (not to scale). c,\nRepeated Ramsey experiments ($15~\\s$ each) show a symmetric drift of $\\fev$ and $\\fod$ around $\\wzo/2\\pi$, arising from background charge motion.\nThe frequency difference $2\\df=\\fev-\\fod$ ranges from $0$ to $1.76~\\MHz$ (see also the Supplementary Methods).\n\nHere, we transform a state-of-the-art  single-junction  transmon qubit into a real-time charge-parity detector, and demonstrate that QP tunneling does not preclude reaching the millisecond timescale in transmon qubit coherence. Our qubit is controlled and measured in a 3D circuit quantum electrodynamics (cQED)  architecture\u00a0[Unknown Author, \"Unknown Title\", ], i.e., the same  environment that the qubit experiences in QIP applications, without need for any additional electrometer or other circuitry. At the heart of our detection scheme is a very small but detectable parity dependence of the qubit transition frequency (up to $0.04\\%$ of the average $\\wzo/2\\pi = 4.387~\\GHz$), obtained by choosing $\\EJ/\\EC=25$.\n\nStandard Ramsey fringe experiments provide the first evidence of QP tunneling across the qubit junction, as shown in Fig.\u00a01 for a refrigerator temperature $\\Tf=20~\\mK$.\nInstead of the usual decaying sinusoid, we observe two. Repeated Ramsey experiments always reveal two frequencies, fluctuating symmetrically about the average $\\wzo$ (Fig.\u00a01c). The double frequency pattern results from the qubit frequency sensitivity to charge, with QP tunneling events shifting the energy levels by $\\pm e$ in the $n_g$ axis. The fluctuation in the frequency difference $\\df$ is due to background charge motion slow compared to QP tunneling.\nThe observation of two frequencies in every experiment shows that QP tunneling is fast compared to the averaging time ($\\sim\\!15~\\s$), but slow compared to the maximum $1/2\\df\\sim 5~\\us$\u00a0[Unknown Author, \"Unknown Title\", ].\nFrom the similar amplitude of the sinusoids, we infer that the two parities are equally likely.\nClearly, these time-averaged measurements only loosely bound the timescale for QP tunneling, similarly to Refs.\u00a0Schreier08,Sun12.\n\nIn order to accurately pinpoint the timescale for QP tunneling, we have devised a scheme to monitor the charge parity in real time (Fig.\u00a02a), taking advantage of recent developments in high-fidelity nondemolition readout\u00a0[Unknown Author, \"Unknown Title\", ] and feedback control\u00a0[Unknown Author, \"Unknown Title\", ].\nStarting from $\\ket{0}$, the qubit is prepared in the superposition state ($\\ket{0}+\\ket{1})/\\sqrt{2}$ with a $\\pi/2$ $y$ pulse at $\\wzo$.\nThe qubit then acquires a phase $\\pm\\pi/2$  during a chosen idle time $\\dt=1/4\\df$, where the $+$ $(-)$ sign corresponds to even (odd) parity.\nA second $\\pi/2$ $x$ pulse completes the mapping of parity into a qubit basis state, even $\\to \\ket{0}$, odd $\\to \\ket{1}$. A following projective qubit  measurement\u00a0[Unknown Author, \"Unknown Title\", ] ideally matches the result $M=1$ $(-1)$ to even (odd) parity. Feedback-based reset\u00a0[Unknown Author, \"Unknown Title\", ] reinitializes the qubit to $\\ket{0}$ and allows repeating this sequence every $\\dt_\\mathrm{exp}=6~\\us$. We note that this scheme realizes the charge-parity meter in the envisioned top-transmon architecture\u00a0[Unknown Author, \"Unknown Title\", ], in which a transmon is used to manipulate and readout Majorana qubits.\n\n< g r a p h i c s >\n\nReal-time measurement of QP tunneling. a, Ramsey-type sequence converting the qubit into a charge-parity detector.\nThe sequence (see main text) is equivalent to a $\\pi$ rotation conditioned on odd parity.\nb, Snapshots of a typical measurement trace, $48~\\ms$ long. Dots are repetitions of the experiment in a, at $6~\\us$ interval. c,  Double-sided power spectral density of $M$, obtained by averaging the squared Fourier transform of 45 consecutive repetitions of b. The best fit of equation\u00a0(<ref>) gives $1/\\Grt=0.794\\pm 0.005~\\ms$. Repeated experiments have a standard deviation of $0.09~\\ms$. d, Histograms of dwell times for $M=\\pm1$. The grey curve is a model of RTS with symmetric rate $\\Grt$ and detection fidelity $F$, extracted from the fit in the main panel. e, Optical image of a qubit with identical geometry\u00a0[Unknown Author, \"Unknown Title\", ] to that used in this experiment.  See Supplementary Methods for several control experiments testing the measurement protocol.\n\nThe time evolution of charge parity is encoded in the series of results $M$ (Fig\u00a02b).\nThe time series has zero average, confirming that the two charge parities are equally probable.\nBoth the QP dynamics and the detection infidelity determine the distribution of  dwell times $t_1$ and $t_{-1}$ (Fig.\u00a02d).  The measured identical histograms match a numerical simulation of a symmetric random telegraph signal (RTS) with transition rate $\\Grt$, masked by uncorrelated detection errors occurring with probability $(1-F)/2$.  These two noise processes contribute distinct signatures to the spectral density of $M$ (Fig.\u00a02c). The best fit of the form\n$$\n\n\\label{eq:lor}\nS_M(f) = F^2 \\frac{4\\Grt}{(2\\Grt)^2+(2\\pi f)^2} + (1-F^2) \\Delta t_{\\mathrm{exp}}\n\n$$\nshows excellent agreement, giving $1/\\Grt=0.79~\\ms$  and $F = 0.92$.\n\n< g r a p h i c s >\n\nRates of QP tunneling with and without qubit transitions. a, Pulse sequence measuring the autocorrelation function of charge parity. Two parity measurements $\\Mb$ and $\\Md$ (see Fig.\u00a02) are separated by a waiting time $\\dT$. Postselection on $\\Mb=1$\u00a0[Unknown Author, \"Unknown Title\", ] prepares the state $\\ket{0e}$. Similarly, a measurement $\\Mc=1$ at the end of $\\dT$ ensures that the final qubit state is $\\ket{0}$. $\\Md$ will coincide with $\\Mb$ only if the parity is unchanged. Inserting $\\pi$ rotations after $\\Mb$ and/or before $\\Mc$ allows measuring the parity autocorrelation for different combinations of qubit states. A preliminary measurement $\\Ma$ (not shown) initializes the qubit in $\\ket{0}$ by postselection. b, Diagram of the four energy levels with the modeled transition rates  (not to scale). c, Charge-parity autocorrelation $\\Rppkk$ for qubit in state $\\ket{0}$ (dots), $\\ket{1}$ (squares), or having relaxed from $\\ket{1}$ to $\\ket{0}$ (diamonds) during $\\dT$.\nThe average of the conditioned $\\Md$ is corrected for detection  infidelity (see Methods).\nFitting the solution of the rate equations, conditioned on initial and final qubit state, gives the inverse rates: $1/\\Gamma_{00}^{eo}=0.92\\pm0.04~\\ms$, $1/\\Gamma_{11}^{eo}=0.70\\pm0.06~\\ms$, $1/\\Gamma^{ee}_{10}=0.14\\pm0.06~\\ms$, $1/\\Gamma_{10}^{eo}=3.3\\pm1.0~\\ms$.\n\nWhile the above scheme detects a characteristic time for QP tunneling, additional experiments are needed to distinguish QP tunneling events that cause qubit transitions from those that do not.\nFor this purpose, we model the system with four levels $\\ket{kl}$ ($k$ and $l$ denote the qubit and parity state, respectively), and rates  $\\Gamma_{kk'}^{ll'}$ connecting them, with $k$ $(k')$ and $l$ $(l')$ the initial (final) qubit and parity state, respectively (Fig.\u00a03b). Based on the identical distributions of dwell times, we consider symmetric rates $\\Gamma_{kk'}^{eo} = \\Gamma_{kk'}^{oe}$.\n\nTo extract the rates, we measure the autocorrelation function of charge parity, conditioned on specific initial and final qubit states (Fig.\u00a03).\nConditioning on a first charge-parity measurement $\\Mb=+1$ postselects the qubit in $\\ket{0}$ and even parity.\nA second measurement $\\Mc$ follows a waiting time $\\dT$.\nBy conditioning also on $\\Mc=+1$, we ensure that the qubit both starts and ends in $\\ket{0}$. A second parity measurement, ending with $\\Md$, completes the sequence. The average result, once corrected for detector infidelity (see Methods), is the parity autocorrelation $\\Rpg = \\langle P(0)P(\\dT) \\rangle_{00}$, with first (second) subscript indicating initial (final) qubit state.  Neglecting qubit excitation, i.e., setting $\\Gextot=\\Gex+\\Goeex=0$, $\\Rpg$ simply decays as $\\exp(-2\\Goeg t)$. The exact solution  shows that this remains a valid approximation when including the measured $\\Gextot = 1/6~\\ms^{-1}$, since the probability of multiple qubit transitions in $\\dT$ is negligible.\nSimilarly, we measure the parity autocorrelation with qubit initially and finally in $\\ket{1}$,  $\\Rpe\\approx\\exp(-2\\Goee t)$.\nTo do this, we use the same conditioning, but apply a $\\pi$ pulse after $\\Mb$ and before $\\Mc$. Exponential decay fits give $1/\\Goeg = 0.92\\pm0.04~\\ms$ and $1/\\Goee = 0.70\\pm0.06~\\ms$.\n\nTo quantify the contribution of QP tunneling to the measured qubit relaxation time $T_1=1/\\Grtot=0.14~\\ms$, we apply the same method, but condition on initial state $\\ket{1}$ and final state $\\ket{0}$.  The ratio of QP-induced to total relaxation rates $\\alpha\\equiv \\Goer/\\Grtot$ ($\\Grtot=\\Gr+\\Goer$) can be extracted from $\\Rpegz = 1-2\\alpha$.\nThe best fit of the model $\\Rpeg$ to the data, with $\\alpha$  as only free  parameter,\ngives $1/\\Goer = 3.3\\pm1.0~\\ms$ and $1/\\Gr = 0.14\\pm0.06~\\ms$.\nThis result clearly demonstrates that QP tunneling does not dominate qubit relaxation at $\\Tf = 20~\\mK$, contributing only $5\\%$ of qubit relaxation events.\n\n< g r a p h i c s >\n\nTemperature dependence of QP tunneling times.\na,b, Charge-parity autocorrelation functions\n$\\Rpg$ and $\\Rpeg$ at $20, 80$ (a), $150$ and $170~\\mK$ (b).\n$\\Rpegz$ progressively decreases, indicating an increasing contribution of QP tunneling to qubit relaxation. c, QP tunneling times for the ground-state ($1/\\Goeg$, dots) and excited-state ($1/\\Goee$, squares) manifold extracted from $\\Rpg$ and  $\\Rpe$ (not shown). Fits to $S_M(f)$ (Supplementary Methods, Fig.\u00a0S5) give similar values for $1/\\Grt$  (diamonds). Dashed curve: theory for $\\Goeg$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] for thermally distributed QPs and $\\DeltaAl = 170~\\ueV$. d, Relaxation times with ($1/\\Goer$, upward triangles) and without ($1/\\Gr$, downward triangles) QP tunneling, obtained from $\\Rpeg$ and the overall relaxation time $T_1=1/\\Grtot$ (squares). Dashed curve: equation\u00a0(<ref>) for thermal equilibrium. Error bars are 1 s.d.\n\nTo facilitate comparison to  theory, we perform the above experiments at elevated $\\Tf$ (Fig.\u00a04). We observe that $\\Grt$, $\\Goeg$, $\\Goee$, and $\\Goer$ have similar magnitude and jointly increase with $\\Tf$ in the range $20-170~\\mK$.\nHowever, $T_1$ remains insensitive to $\\Tf$ until $150~\\mK$. The observed sign reversal in $\\Rpegz$ near this temperature  (Fig.\u00a04b) indicates that QP tunneling becomes the dominant relaxation process.\n\nThe effect of QP dynamics on the qubit degree of freedom in superconducting circuits has been extensively studied theoretically\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nFor transmon qubits, the predicted QP-induced relaxation rate is\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\n$$\n\n\\label{eq:rel_theo}\n\\Goer \\approx \\frac{x_\\mathrm{qp}}{\\pi}\\sqrt{2\\DeltaAl\\wzo},\n\n$$\nwhere $x_\\mathrm{qp}=  n_\\mathrm{qp}/2\\nu_0\\DeltaAl$ is the QP density $n_\\mathrm{qp}$ normalized to the Cooper-pair density, with $\\nu_0=1.2\\times10^{4}~\\um^{-3}\\ueV^{-1}$ the single-spin density of states at the Fermi energy\u00a0[Unknown Author, \"Unknown Title\", ] and $\\DeltaAl$ the Al superconducting gap. This relation holds for any energy distribution of QPs.\nFor $\\Tf\\geq150~\\mK$, the data closely match equation\u00a0(<ref>) using the thermal equilibrium $x_\\mathrm{qp}  = \\sqrt{2\\pi\\Tf/\\DeltaAl}e^{-\\DeltaAl/\\Tf}$ and $\\DeltaAl = 170~\\ueV$, the value estimated from the normal-state resistance of the junction (see Methods).\nThe suppression of $\\Goer$ at lower $\\Tf$ is much weaker than expected from a thermal QP distribution.\nUsing equation\u00a0(<ref>), we estimate $n_\\mathrm{qp} = 0.04\\pm0.01~\\um^{-3}$ at $\\Tf=20~\\mK$, matching the lowest value reported for Al in a Cooper-pair transistor for use in metrology\u00a0[Unknown Author, \"Unknown Title\", ]. Improved shielding against infrared radiation\u00a0[Unknown Author, \"Unknown Title\", ] could further decrease $n_\\mathrm{qp}$ at low $\\Tf$, and will be pursued in future work.\n\nQP tunneling events that do not induce qubit transitions contribute to pure qubit dephasing.  Calculations based on  Refs.\u00a0Martinis09 and\u00a0Catelani12 predict $\\Gamma^{eo}_{kk}\\approx\\Goer$, in good agreement with the data (Fig.\u00a04c). It is presently not understood whether these QP tunneling events completely destroy qubit superposition states (case A)  or simply change the qubit precession frequency (case B).  In either case,  in the regime of strongly coupled RTS valid for our experiment  ($\\Goeg,\\Goee\\ll \\df$\u00a0[Unknown Author, \"Unknown Title\", ]) the QP-induced dephasing time is $2/(\\Gamma^{eo}_{00}+\\Gamma^{eo}_{11})\\sim0.8~\\ms$. For case B, this time would further increase in the weak-coupling regime (attained at $\\EJ/\\EC\\gtrsim 60$) due to motional averaging\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn conclusion, we have measured the characteristic times of QP tunneling across the single junction of a 3D transmon by converting the qubit into a real-time charge-parity detector. First, probing charge parity every $6~\\us$ with a Ramsey-like sequence reveals a symmetric RTS with $0.8~\\ms$ characteristic switching time. Second, measuring the charge-parity autocorrelation function, conditioned on specific initial and final qubit states,\ndistinguishes QP tunneling that induces qubit relaxation from that which does not.\nWe have shown that QP tunneling is not the dominant relaxation mechanism, contributing just $5\\%$ of relaxation events in our state-of-the-art transmon. Reaching the millisecond horizon in coherence will facilitate the realization of fault-tolerant QIP with superconducting circuits.\n\n## methods\nDevice parameters. The transmon has Josephson energy $\\EJ = 8.442~\\GHz$ and charging energy $\\EC=0.334~\\GHz$. Using the Ambegaokar-Baratoff relation $\\EJ R_{n} =\n\\Delta/8e^2$ and the measured room-temperature resistance $R_{n,300\\K}=15.2~\\kohm$ of the single Josephson junction, we estimate $\\Delta = 170~\\ueV$. The qubit couples to the\nfundamental mode of the cavity $\\wrr/2\\pi = 6.551~\\GHz$ (decay rate $\\kappa/2\\pi = 720~\\kHz$) with strength $g/2\\pi = 66~\\MHz$, inducing a dispersive shift $2\\chi/2\\pi=-1.0~\\MHz$. The qubit relaxation time $T_1$ may be limited by the Purcell effect\u00a0[Unknown Author, \"Unknown Title\", ]. A simple estimate including only the fundamental cavity mode gives $240~\\us$. The dephasing time, $\\Ttwostar = 10-25~\\us$, is limited by background charge fluctuations (see Supplementary Methods).\n\nExperimental setup.\nProjective readout with $99\\%$ fidelity is achieved by homodyne detection with a $400~\\ns$ pulse at $\\wrr-\\chi$, aided by a Josephson parametric amplifier\u00a0[Unknown Author, \"Unknown Title\", ]. The qubit reset is implemented with a home-built feedback controller based on a complex programmable logic device (Altera MAX V)  that integrates the last $200~\\ns$ of the readout signal and conditionally triggers a $\\pi$ pulse (Gaussian, $\\sigma = 8~\\ns$, $32~\\ns$ long) $2~\\us$ after the end of the measurement\u00a0[Unknown Author, \"Unknown Title\", ] (see the Supplementary Methods for more details).\n\nExtraction of QP tunneling rates. To convert $\\langle \\Md (\\dT) \\rangle_{kk'}$ into $\\Rppkk$, we correct for the overall detection errors, distributed among readout ($<1\\%$) and reset  ($\\sim\\!1\\%$) infidelities, suboptimal $\\dt$ ($<2\\%$), and dephasing during $\\dt$ (remaining $1-3\\%$). For this correction, we first fit an exponential decay to $\\langle \\Md(\\dT) \\rangle_{00}$ and $\\langle \\Md(\\dT) \\rangle_{11}$. The average of the best-fit value at $\\dT=0$ is used to renormalize the data in Figs.\u00a03c  and 4a,b. The fitted decay times are $1/2\\Goeg$ and $1/2\\Goee$, respectively. To extract $\\Goer$ and $\\Gr$, we fit the solution of equation\u00a0(2) to $\\Rpeg$, using $\\Goer+\\Gr=\\Grtot$.\n$\\Grtot$ is obtained from\nthe equilibration time $T_\\mathrm{eq}$ after inverting the steady-state populations  $P_{\\ket{0},\\mathrm{ss}}, P_{\\ket{1},\\mathrm{ss}}$ with a $\\pi$ pulse:\n$$\n\n\\label{eq:gamma01}\n\\Grtot = \\frac{P_{\\ket{0},\\mathrm{ss}}}{(P_{\\ket{0},\\mathrm{ss}}+P_{\\ket{1},\\mathrm{ss}}) T_\\mathrm{eq}}.\n\n$$\nThe total excitation $1-P_{\\ket{0},\\mathrm{ss}}$ is obtained by measurement and postselection\u00a0[Unknown Author, \"Unknown Title\", ]. Equation\u00a0(<ref>) remains a valid approximation even  for the highest temperatures in Fig.\u00a04, when  the populations of higher excited states become relevant. In this case, the populations $P_{\\ket{0},\\mathrm{ss}},P_{\\ket{1},\\mathrm{ss}}$ are estimated from the total excitation, assuming that the populations are thermally distributed\u00a0[Unknown Author, \"Unknown Title\", ].\nError bars for $\\Goer, \\Gr$ are calculated from the standard deviation of repeated $T_1$ measurements and the fit uncertainty in $\\alpha$.\n\n## Acknowledgments\nWe thank   G.\u00a0Catelani, A.\u00a0Endo,  F.\u00a0Hassler,  G.\u00a0de Lange, J.\u00a0M.\u00a0Martinis, L.\u00a0M.\u00a0K.\u00a0Vandersypen, P.\u00a0J.\u00a0de Visser, and the Yale cQED team for discussions. We acknowledge funding from the Dutch Organization for Fundamental Research on Matter (FOM), the Netherlands Organization for Scientific Research (NWO, VIDI scheme), the EU FP7 project SOLID, and the DARPA QuEST program.\n\n10\nurl<#>1urlprefixURL\n\nDay03\nauthorDay, P.\u00a0K., authorLeDuc, H.\u00a0G.,\nauthorMazin, B.\u00a0A., authorVayonakis, A. &\nauthorZmuidzinas, J.\ntitleA broadband superconducting detector suitable for\nuse in large arrays.\njournalNature volume425,\npages817\u201321 (year2003).\n\nStone12\nauthorStone, K.\u00a0J. et\u00a0al.\ntitleReal time quasiparticle tunneling measurements on an\nilluminated quantum capacitance detector.\njournalAppl. Phys. Lett.\nvolume100, pages263509\n(year2012).\n\nPekola12\nauthorPekola, J.\u00a0P. et\u00a0al.\ntitleSingle-electron current sources: towards a refined\ndefinition of ampere.\nhowpublishedarXiv:1208.4030 (2012).\n\nGiazotto06\nauthorGiazotto, F., authorHeikkil\u00e4, T.\u00a0T.,\nauthorLuukanen, A., authorSavin, A.\u00a0M. &\nauthorPekola, J.\u00a0P.\ntitleOpportunities for mesoscopics in thermometry and\nrefrigeration: physics and applications.\njournalRev. Mod. Phys.\nvolume78, pages217\u2013274\n(year2006).\n\nLutchyn10\nauthorLutchyn, R.\u00a0M., authorSau, J.\u00a0D. &\nauthorDas\u00a0Sarma, S.\ntitleMajorana fermions and a topological phase transition\nin semiconductor-superconductor heterostructures.\njournalPhys. Rev. Lett.\nvolume105, pages077001\n(year2010).\n\nMartinis09\nauthorMartinis, J.\u00a0M., authorAnsmann, M. &\nauthorAumentado, J.\ntitleEnergy decay in superconducting Josephson-junction\nqubits from nonequilibrium quasiparticle excitations.\njournalPhys. Rev. Lett.\nvolume103, pages097002\n(year2009).\n\nLenander11\nauthorLenander, M. et\u00a0al.\ntitleMeasurement of energy decay in superconducting qubits\nfrom nonequilibrium quasiparticles.\njournalPhys. Rev. B volume84,\npages024501 (year2011).\n\nCatelani11\nauthorCatelani, G., authorSchoelkopf, R.\u00a0J.,\nauthorDevoret, M.\u00a0H. & authorGlazman, L.\u00a0I.\ntitleRelaxation and frequency shifts induced by\nquasiparticles in superconducting qubits.\njournalPhys. Rev. B volume84,\npages064517 (year2011).\n\nCatelani12\nauthorCatelani, G., authorNigg, S.\u00a0E.,\nauthorGirvin, S.\u00a0M., authorSchoelkopf, R.\u00a0J. &\nauthorGlazman, L.\u00a0I.\ntitleDecoherence of superconducting qubits caused by\nquasiparticle tunneling.\njournalPhys. Rev. B volume86,\npages184514 (year2012).\n\nRiste12\nauthorRist\u00e8, D., authorvan Leeuwen, J.\u00a0G.,\nauthorKu, H.-S., authorLehnert, K.\u00a0W. &\nauthorDiCarlo, L.\ntitleInitialization by measurement of a superconducting\nquantum bit circuit.\njournalPhys. Rev. Lett.\nvolume109, pages050507\n(year2012).\n\nRiste12b\nauthorRist\u00e8, D., authorBultink, C.\u00a0C.,\nauthorLehnert, K.\u00a0W. & authorDiCarlo, L.\ntitleFeedback control of a solid-state qubit using\nhigh-fidelity projective measurement.\njournalPhys. Rev. Lett.\nvolume109, pages240502\n(year2012).\n\nWallraff04\nauthorWallraff, A. et\u00a0al.\ntitleStrong coupling of a single photon to a\nsuperconducting qubit using circuit quantum electrodynamics.\njournalNature volume431,\npages162\u2013167 (year2004).\n\nBouchiat98\nauthorBouchiat, V., authorVion, D.,\nauthorJoyez, P., authorEsteve, D. &\nauthorDevoret, M.\u00a0H.\ntitleQuantum coherence with a single Cooper pair.\njournalPhys. Scr. volumeT76,\npages165 (year1998).\n\nLutchyn06\nauthorLutchyn, R.\u00a0M., authorGlazman, L.\u00a0I. &\nauthorLarkin, A.\u00a0I.\ntitleKinetics of the superconducting charge qubit in the\npresence of a quasiparticle.\njournalPhys. Rev. B volume74,\npages064515 (year2006).\n\nFerguson06\nauthorFerguson, A.\u00a0J., authorCourt, N.\u00a0A.,\nauthorHudson, F.\u00a0E. & authorClark, R.\u00a0G.\ntitleMicrosecond resolution of quasiparticle tunneling in\nthe single-Cooper-pair transistor.\njournalPhys. Rev. Lett.\nvolume97, pages106603\n(year2006).\n\nNaaman06\nauthorNaaman, O. & authorAumentado, J.\ntitleTime-domain measurements of quasiparticle tunneling\nrates in a single-Cooper-pair transistor.\njournalPhys. Rev. B volume73,\npages172504 (year2006).\n\nCourt08\nauthorCourt, N.\u00a0A., authorFerguson, A.\u00a0J.,\nauthorLutchyn, R. & authorClark, R.\u00a0G.\ntitleQuantitative study of quasiparticle traps using the\nsingle-Cooper-pair transistor.\njournalPhys. Rev. B volume77,\npages100501 (year2008).\n\nShaw08\nauthorShaw, M.\u00a0D., authorLutchyn, R.\u00a0M.,\nauthorDelsing, P. & authorEchternach, P.\u00a0M.\ntitleKinetics of nonequilibrium quasiparticle tunneling in\nsuperconducting charge qubits.\njournalPhys. Rev. B volume78,\npages024503 (year2008).\n\nTuominen92\nauthorTuominen, M.\u00a0T., authorHergenrother, J.\u00a0M.,\nauthorTighe, T.\u00a0S. & authorTinkham, M.\ntitleExperimental evidence for parity-based 2e\nperiodicity in a superconducting single-electron tunneling transistor.\njournalPhys. Rev. Lett.\nvolume69, pages1997\u20132000\n(year1992).\n\nEiles94\nauthorEiles, T.\u00a0M. & authorMartinis, J.\u00a0M.\ntitleCombined Josephson and charging behavior of the\nsupercurrent in the superconducting single-electron transistor.\njournalPhys. Rev. B volume50,\npages627\u2013630 (year1994).\n\nAmar94\nauthorAmar, A., authorSong, D., authorLobb,\nC.\u00a0J. & authorWellstood, F.\u00a0C.\ntitle2e to e periodic pair currents in\nsuperconducting Coulomb-blockade electrometers.\njournalPhys. Rev. Lett.\nvolume72, pages3234\u20133237\n(year1994).\n\nKoch07\nauthorKoch, J. et\u00a0al.\ntitleCharge-insensitive qubit design derived from the\nCooper pair box.\njournalPhys. Rev. A volume76,\npages042319 (year2007).\n\nSchreier08\nauthorSchreier, J.\u00a0A. et\u00a0al.\ntitleSuppressing charge noise decoherence in\nsuperconducting charge qubits.\njournalPhys. Rev. B volume77,\npages180502 (year2008).\n\nPaik11\nauthorPaik, H. et\u00a0al.\ntitleObservation of high coherence in Josephson junction\nqubits measured in a three-dimensional circuit QED architecture.\njournalPhys. Rev. Lett.\nvolume107, pages240501\n(year2011).\n\nHouck08\nauthorHouck, A.\u00a0A. et\u00a0al.\ntitleControlling the spontaneous emission of a\nsuperconducting transmon qubit.\njournalPhys. Rev. Lett.\nvolume101, pages080502\n(year2008).\n\nSun12\nauthorSun, L. et\u00a0al.\ntitleMeasurements of quasiparticle tunneling dynamics in a\nband-gap-engineered transmon qubit.\njournalPhys. Rev. Lett.\nvolume108, pages230509\n(year2012).\n\nPaladino02\nauthorPaladino, E., authorFaoro, L.,\nauthorFalci, G. & authorFazio, R.\ntitleDecoherence and $1/\\mathit{f}$ noise in Josephson\nqubits.\njournalPhys. Rev. Lett.\nvolume88, pages228304\n(year2002).\n\nHassler11\nauthorHassler, F., authorAkhmerov, A.\u00a0R. &\nauthorBeenakker, C. W.\u00a0J.\ntitleThe top-transmon: a hybrid superconducting qubit for\nparity-protected quantum computation.\njournalNew J. Phys. volume13,\npages095004 (year2011).\n\nSaira12\nauthorSaira, O.-P., authorKemppinen, A.,\nauthorMaisi, V.\u00a0F. & authorPekola, J.\u00a0P.\ntitleVanishing quasiparticle density in a hybrid\nAl/Cu/Al single-electron transistor.\njournalPhys. Rev. B volume85,\npages012504 (year2012).\n\nBarends11\nauthorBarends, R. et\u00a0al.\ntitleMinimizing quasiparticle generation from stray\ninfrared light in superconducting quantum circuits.\njournalAppl. Phys. Lett.\nvolume99 (year2011).\n\n"}
{"prompt": "What are the key contributions of the paper 'Rapid Driven Reset of a Qubit Readout Resonator'?", "completion": "\n\nDTMphysrev\n\n# Rapid Driven Reset of a Qubit Readout Resonator\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nUsing a circuit QED device, we demonstrate a simple qubit measurement\npulse shape that yields fast ring-up and ring-down of the readout resonator\nregardless of the qubit state. The pulse differs from a square pulse only by the\ninclusion of additional constant-amplitude segments designed to effect a\nrapid transition from one steady-state population to another.\nUsing a Ramsey experiment performed shortly after the measurement pulse to\nquantify the residual population, we find that compared to a square pulse\nfollowed by a delay, this pulse shape reduces the timescale for cavity ring-down\nby more than twice the cavity time constant. At low drive powers, this\nperformance is achieved using pulse parameters calculated from a\nlinear cavity model; at higher powers, empirical optimization of the pulse\nparameters leads to similar performance.\n\nOver the last decade, circuit quantum electrodynamics\u00a0[Unknown Author, \"Unknown Title\", ]\n(cQED) has become a leading architecture for constructing scalable networks of\nsolid-state qubits, finding application in the context of not only\nsuperconducting qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] but\nalso spin qubits\u00a0[Unknown Author, \"Unknown Title\", ] and potentially other\nsystems\u00a0[Unknown Author, \"Unknown Title\", ].\nIn this paradigm, each qubit is coupled to a resonator in which it induces a\nstate-dependent frequency shift, allowing the qubit state to be interrogated\nusing a pulsed tone near the resonator frequency. A great deal of research has\nfocused on optimizing the speed and fidelity of such measurements.\nMost significantly, the ongoing development of quantum-limited\namplifiers\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has improved achievable signal-to-noise ratios\nenormously. The introduction of Purcell\nfilters\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has enabled the use of\nresonators with fast time constants, whose high bandwidth would otherwise\nprovide a pathway for qubit relaxation via spontaneous emission (Purcell\neffect\u00a0[Unknown Author, \"Unknown Title\", ]). Some work\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nhas also explored the use of pulse shapes with an initial overshoot in order\nto populate the readout resonator more quickly than the standard square pulse.\n\nAlthough these improvements have made fast, high-fidelity qubit readout in cQED\nsystems routine, relatively little attention has been devoted to the problem of\nreturning the readout resonator to its ground state immediately after the\nmeasurement pulse. If the pulse is simply turned off, residual photons gradually\nexiting the resonator will continue to measure the\nqubit\u00a0[Unknown Author, \"Unknown Title\", ], preventing high-fidelity operations for\na period of several time constants. Even for a resonator with a fast time\nconstant, this delay is typically longer than the time needed for qubit control\nand measurement. A technique for reducing the residual population on a timescale\nfaster than the resonator's free decay is therefore desirable in any\nalgorithm in which qubits need to be re-used shortly after measurement, e.g.\nerror correction with surface\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ],\nC4\u00a0[Unknown Author, \"Unknown Title\", ] or Bacon-Shor\u00a0[Unknown Author, \"Unknown Title\", ]\ncodes. A major impediment has been the fact any such scheme needs to work in the\nabsence of prior knowledge as to which of the two possible state-dependent\nresonator frequencies will be realized.\n\nHere we present the first experimental demonstration of driven\nstate-independent reset of a readout resonator, using a specially designed yet\nsimple pulse shape that we term the Cavity Level Excitation and Reset\n(CLEAR) pulse [Fig.\u00a0<ref>(a)]. The pulse uses short segments to \u201ckick\u201d\nthe resonator rapidly from one steady-state population to another: at the\nbeginning of the pulse, two such segments drive the population from zero to the desired steady-state value, and\nat the end, two more drive it back to zero. In this work, we focus on\nquantifying the effectiveness of the depopulating segments. Using a Ramsey experiment to\nextract the number of residual photons in the cavity after the pulse, we\ncompare the performance to that of a standard square pulse. We find that for\npulse powers where the cavity response remains linear, the theoretically\nderived CLEAR pulse shape depopulates the cavity to a negligible level in a time\nmore than two cavity time constants faster than that needed after the square pulse. At higher powers,\noptimizing the pulse shape empirically using an iterative algorithm leads to\nequally good performance.\n\nThe experimental device is a fixed-frequency transmon qubit mounted in a 3D\naluminum cavity\u00a0[Unknown Author, \"Unknown Title\", ] attached to the mixing chamber of a\ndilution refrigerator at an indicated base temperature of $10~\\mK$. Qubit and\nmeasurement drive tones are generated using Agilent E8267D function generators\nand modulated using Tektronix AWG7000 series arbitrary waveform generators at a\n2 GS/s sample rate. Qubit pulses are $4\\sigma$ Gaussians with\nDRAG\u00a0[Unknown Author, \"Unknown Title\", ] correction. The cavity is measured in\ntransmission, and the transmitted signal is fed to a HEMT amplifier (Low Noise\nFactory LNF-LNC6_20A) at $4~\\K$ using a superconducting NbTi/NbTi semi-rigid coaxial cable. After additional\namplification at room temperature, the signal is mixed down to $16~\\MHz$ and\ndigitally demodulated. The cavity is measured to have bare frequency\n$\\fbare=10.7457~\\GHz$, dressed frequency $\\fdressed = 10.7594~\\GHz$, and\nlinewidth $\\kappa/2\\pi=1.1~\\MHz$ (corresponding to a time constant $\\Tcav=1/\\kappa=0.14~\\us$). The qubit has\nfrequency $f_{01}=4.83315~\\GHz$, anharmonicity $\\delta/2\\pi=-155~\\MHz$,\naverage $\\Tone\\approx50~\\us$, and average $\\Ttwo\\approx60~\\us$. Preparing the\nqubit in the excited state shifts $\\fdressed$ by the cavity pull $2\\chi/2\\pi=-2.6~\\MHz$; the measurement tone is applied at the\nmidpoint of the two frequencies, $\\fdressed-\\chi/2\\pi$.\n\n< g r a p h i c s >\n\n(color) (a) Schematic shape of the\npiecewise-constant CLEAR pulse (solid red line) with a square pulse\n(dashed black line) for reference. (b) Pulse sequence used to extract the\nresidual cavity population after a measurement pulse.\nThe qubit is prepared in either the ground or excited state and\nthen a measurement pulse (either a square pulse or a CLEAR pulse) of length\n$\\tMone$ is applied. After the measurement pulse, an adjustable\ndelay $\\trelax$ precedes a pair of $X_{90}$ pulses separated by\n$\\tRamsey$ comprising a Ramsey experiment. The Ramsey experiment is followed by\nanother brief delay $\\tbuffer$ and a square measurement pulse of length\n$\\tMtwo = 10~\\us$.\n\nThe residual population after a measurement pulse can be quantified in terms of\nthe mean cavity photon number $\\nbar$ at some time after the end of the pulse.\nWe use the sequence illustrated in Fig.\u00a0<ref>(b) to extract\n$\\nbar$ following an initial measurement pulse denoted M1. The measurement pulse\nis followed by a quick Ramsey experiment ($\\tgate = 8~\\ns$, $\\tRamsey = 0$ to $600~\\ns$) to\nprobe the ac Stark shift and dephasing from any residual\nphotons\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe time $\\trelax$ between the end of M1 and the start of the Ramsey experiment\ncan be varied to measure $\\nbar$ as a function of time after the end of M1.\nThe time $\\tbuffer$ between the Ramsey experiment and the second measurement\npulse (M2) is set to $400~\\ns$ to ensure that even when $\\tRamsey$ and $\\trelax$\nare both short, M2 is not corrupted by lingering photons from M1.\n\n< g r a p h i c s >\n\n(color) (a) Sample Ramsey experiment and fit. The\nblack curve is a fit of Eq.\u00a0<ref> to the data (red circles), yielding\ninitial cavity population $\\no\\approx0.9$. (b) Markers indicate $\\no$ versus\nwait time $\\trelax$ after a square measurement pulse with drive power $\\Pnorm=2$. Here and throughout, blue and red denote\nexperiments in which the qubit was prepared in the ground and excited states, respectively. Solid\nblue and red curves are exponential fits to the respective data sets. (c) $\\no$\nversus drive power measured at $\\trelax=40~\\ns$ after a square\nmeasurement pulse. The dashed line indicates the prediction for a linear\ncavity, accounting for $\\trelax$. The solid curves account for the\ncavity's self-Kerr nonlinearity calculated from the measured qubit and cavity\nparameters.\n\nA typical Ramsey trace is shown in Fig.\u00a0<ref>(a). The non-monotonic\nmodulation in both amplitude and frequency arises from the fact that the cavity\npopulation evolves during the Ramsey delay, leading to recurrences. We derive\nthe expected form of the Ramsey trace during this transient response using the\npositive-$P$-function method as in Gambetta et\nal.\u00a0[Unknown Author, \"Unknown Title\", ], where it was applied to the steady-state\nproblem. For a Ramsey detuning $\\Dw$ (here $10~\\MHz$), decoherence rate\n$\\Gammatwo$, and initial phase $\\phi_0$, the resulting functional form is\n$$\n\n\\label{RamseyEqn}\nS(\\tRamsey) = \\frac{1}{2}[1 - \\mathrm{Im}(\\exp(-(\\Gammatwo+\\Dw i)\\tRamsey +\n(\\phi_0-2\\no\\chi\\tau) i))],\n\n$$\nwhere $\\tau = (1-e^{-(\\kappa+2\\chi i)\\tRamsey})/(\\kappa+2\\chi i)$ and\n$\\no$ is the value of $\\nbar$ at the beginning of the Ramsey experiment. Using $\\kappa$ and $\\chi$ obtained from frequency-domain measurements\nand taking $\\Gammatwo=1/\\Ttwo$, the only free parameters are $\\no$ and\n$\\phi_0$. As illustrated in the figure, this function yields a good fit to the\ndata, allowing reliable determination of $\\no$. In the rest of this work, we use\nthe extracted $\\no$ to quantify the residual population as a function of pulse\nshape, drive power, and wait time. We note that $\\no$ does not include\nthe background thermal population of the cavity, which is accounted for by the\n$\\Gammatwo$ term and is calculated from $\\Ttwo$ to be $\\sim0.02$ on\naverage (assuming thermal photons are the dominant source of steady-state\ndephasing\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]).\n\nThe Ramsey fit method of obtaining $\\no$ was validated by using it to measure\n$\\no$ as a function of both wait time $\\trelax$ and pulse power. For simplicity,\nthese tests were performed using square pulses for both M1 and M2, varying only\nthe power of M1, denoted $P$ as illustrated in Fig.\u00a0<ref>(a).\nFor convenience we define the normalized drive power $\\Pnorm=\nP/P_{1\\mathrm{ph}}$, where $P_{1\\mathrm{ph}}$ is the steady-state drive power\nthat yields $\\nbar=1$, as inferred from a standard Ramsey experiment measuring\nthe Stark shift $\\Delta\\omega=2\\chi\\nbar$ [Unknown Author, \"Unknown Title\", ]\ninduced by a CW tone. Figure\u00a0<ref>(b) shows $\\no$ extracted from\nRamsey fits as a function of $\\trelax$. Regardless of the prepared qubit state,\nthe decay is exponential, as expected for free decay, and the time constant\n$\\Tcav$ extracted from the best-fit curve is consistent with the value of\n$\\kappa$ obtained from frequency-domain measurements.\nFigure\u00a0<ref>(c) shows $\\no$ as a function of $\\Pnorm$ at\n$\\trelax=40~\\ns$; similar behavior was observed at all values of $\\trelax$ for\nwhich non-negligble $\\no$ were measured. The dashed line indicates the expected\nbehavior assuming a linear cavity: $\\no=e^{-\\kappa\\trelax}\\Pnorm$.\nThe data exhibit a transition from a linear response at low powers to a super-\nlinear response at high powers when the qubit is prepared in the\nground (excited) state. This behavior is consistent with the cavity's expected\nself-Kerr nonlinearity\u00a0[Unknown Author, \"Unknown Title\", ], which shifts the\ncavity frequency by a negative amount $K$ per cavity photon, pushing it closer\nto (farther from) the measurement frequency when the qubit is in the ground\n(excited) state. Approximating $K$ in the small-$\\delta$ limit as\n$K=2g^4\\delta(3\\omega_q^4+2\\omega_q^2\\omega_r^2+3\\omega_r^4)/(\\omega_q^2-\\omega_r^2)^4$,\nwhere $\\omega_q=2\\pi f_{01}$, $\\omega_r=2\\pi\\fdressed$, and $g$ is\ncalculated as in Ref.\u00a0[Unknown Author, \"Unknown Title\", ], we obtain $K\\approx-14~\\kHz$. The\nsolid blue (red) curve indicates the expected cavity response with the qubit\nin the ground (excited) state, accounting for the calculated non-linearity.\n\nHaving thus validated our method of quantifying residual photons, we then\nswitched to a CLEAR pulse shape for M1; for consistency, we continued to use a\nsquare pulse for M2. For an ideal single qubit-cavity system, the optimal CLEAR\npulse envelope [Fig.\u00a0<ref>(a)] consists of five\npiecewise-constant segments: two ring-up segments, one steady-state segment, and\ntwo ring-down segments. For the pulse to behave as intended, its bandwidth needs\nonly to be much greater than that of the cavity, a condition readily achieved in\nour setup. Setting the carrier frequency to $\\fdressed-\\chi/2\\pi$, as done here,\nis not required but maximizes both SNR and simplicity: in this case, a given measurement pulse\nyields the same steady-state $\\nbar$ regardless of qubit state as long as the\ncavity remains in the linear-response regime. The lengths of the ring-up and\nring-down segments were all initially fixed at $150~\\ns$ (approximately\n$\\Tcav$), and their amplitudes relative to that of the steady-state segment\nwere calculated by solving a driven damped harmonic oscillator model to find the\npulse shape that populates and depopulates the cavity in the shortest amount of\ntime regardless of the qubit state.\n\nThe cavity IQ plane trajectories produced by square and CLEAR pulses with the\nsame steady-state amplitude ($\\Pnorm = 3.6$) are shown by markers in\nFigs.\u00a0<ref>(a,b), respectively. For all trajectories, the time\nstep between markers is $24~\\ns$. Solid lines in these plots indicate the\ntheoretically calculated response of the cavity to each pulse, multiplied by an\noverall amplitude factor to match the data and adjusted to reflect the\nindependently observed $20\\%$ thermal population of the qubit excited state\n(which was reduced by an order of magnitude on later cooldowns of\nthis device with additional input line attenuation). We see that the experimental\ncavity responses track the theoretically calculated ones very well, and that\ncompared to the square pulse, the CLEAR pulse yields more compact trajectories that reach\nnear-steady-state populations (at both $\\nbar\\approx3.6$ and $\\nbar\\approx0$) in less time.\n\n< g r a p h i c s >\n\n(color) (a,b) IQ-plane cavity trajectories in\nresponse to a square pulse and CLEAR pulse, respectively. In each\nplot, experimental results (markers) are superimposed on theoretical\ncalculations (solid curves), the dashed circle indicates the target population\n$\\nbar=3.6$, the black cross indicates the origin, and the black arrows indicate the directions of the trajectories. (c) Residual cavity population versus pulse power for both\nsquare and CLEAR pulse shapes. For the CLEAR pulse, the Ramsey experiment begins immediately at the end of the pulse, while\nfor the square pulse, a delay of approximately $300~\\ns$ is inserted to match\nthe total length of the CLEAR pulse's two ring-down segments.\n\nWe quantitatively compare the performance of the CLEAR pulse to that of a square\npulse using the Ramsey fit method. To provide a fair comparison, a\nzero-amplitude segment is appended to the square pulse to allow undriven decay\nduring a time equivalent to the total length of the CLEAR pulse's two ring-down\nsegments. The results are shown in Fig.\u00a0<ref>(c). At all\nmeasurement powers, the CLEAR pulse significantly outperforms the square pulse;\nmoreover, for drive powers that keep the cavity in the linear regime (evidenced\nby $\\no$ being independent of the prepared qubit state), the residual population\nimmediately after the CLEAR pulse is negligible. As seen in\nFig.\u00a0<ref>(b), for drive powers in this range, negligible $\\no$ is\nnot obtained until $\\sim600~\\ns$ after a square pulse; allowing for the\n$300~\\ns$ taken by the ring-down segments of the CLEAR pulse, we find a net\nspeedup of $\\sim300~\\ns$, or approximately $2\\Tcav$. At higher powers, it\nappears that the cavity nonlinearity, not taken into account in calculating the optimal CLEAR pulse parameters, prevents perfect ring-down. We also find non-idealities when the lengths of the ring-down segments are reduced in an effort to shorten the ring-down time: for $120~\\ns$ ring-down segments (a $20\\%$ reduction), we find measurable $\\no$ even in the linear regime, as illustrated in\nFig.\u00a0<ref>(a). Further reductions in the segment lengths increase\nthe performance degradation.\n\n< g r a p h i c s >\n\n(color) (a) $\\no$ versus drive power for\nthe shortened CLEAR pulse ($120~\\ns$ ring-down segments), for $\\trelax=0$. (b)\nEvolution of $\\no$ at each step of an empirical optimization algorithm for the shortened CLEAR pulse with\n$\\Pnorm=10$. Inset: shortened CLEAR pulse shape before optimization (magenta)\nand after (green). (c) Ramsey traces obtained using initial shortened CLEAR\npulse, yielding $\\no\\approx 2.2$ for ground and $\\no\\approx 0.91$ for\nexcited. (d) Ramsey traces obtained using final shortened CLEAR pulse,\nyielding $\\no < 0.1$ for both qubit states.\n\nTo improve performance of the CLEAR pulse both at high powers and with shortened\nringdown segments, we use an empirical technique to optimize the pulse\nparameters. As an example, we take as a starting point the pulse with $120~\\ns$\nring-down segments and a steady-state drive power of $\\Pnorm=10$ (which yielded\n$\\no\\approx 2.16$ for the ground state and $\\no\\approx 0.91$ for the excited\nstate), and run an iterative optimization algorithm that attempts to minimize\n$\\no$ by adjusting the amplitudes of the ring-down segments. We keep\n$\\trelax=0$ throughout. The evolution of $\\no$ with each iteration is shown in\nFig.\u00a0<ref>(b): in fewer than 300 iterations, the pulse is\noptimized to yield $\\no<0.1$ regardless of initial qubit state.\nRamsey experiments before and after running this optimization are shown in\nFig.\u00a0<ref>(c,d), revealing that coherence is preserved with the\noptimized pulse shape regardless of initial qubit state. As seen in the inset of\nFig.\u00a0<ref>(b), the optimization process significantly increases\nthe amplitudes of both ring-down segments. Extending our theoretical\ncalculations to the non-linear regime may shed light on this result and\npotentially eliminate the need for empirical tune-up in this regime.\n\nIn summary, using a single-qubit cQED system, a qubit-state-independent\nreduction in the time needed to reach a steady-state resonator population both\nduring and after a qubit measurement pulse was achieved by including extra\nconstant-amplitude segments in the pulse. For low-power drives, near-perfect\nring-down (quantified using Ramsey experiments) is achieved using segment\namplitudes calculated from system parameters. At higher drive amplitudes,\nsimilar performance is obtained following empirical optimization of the pulse\nshape. Though this demonstration used a 3D transmon, the same technique should\nbe applicable to any cQED system; it may also be combined with machine-learning\nbased analysis\u00a0[Unknown Author, \"Unknown Title\", ] and Purcell filters to further reduce\nthe measurement cycle time. Future areas of interest may include numerical\ncalculation of the optimal CLEAR parameters in the non-linear regime, extension\nof this technique to resonators coupled to multiple qubits, and investigation as\na possible method for implementing the resonator-induced phase (RIP)\ngate\u00a0[Unknown Author, \"Unknown Title\", ] non-adiabatically.\n\nWe thank M. B. Rothwell and G. A. Keefe for device fabrication, J. R. Rozen and\nJ. Rohrs for technical assistance, and B. Abdo for useful discussions. We\nacknowledge support from IARPA under Contract No. W911NF-10-1-0324. All\nstatements of fact, opinion or conclusions contained herein are those of the\nauthors and should not be construed as representing the official views or\npolicies of the U.S. Government.\n\n"}
{"prompt": "What are the main findings of the paper 'Engineering cryogenic setups for 100-qubit scale superconducting circuit systems'?", "completion": "\n\nexample.eps\n\ngsave\nnewpath\n20 20 moveto\n20 220 lineto\n220 220 lineto\n220 20 lineto\nclosepath\n2 setlinewidth\ngsave\n.4 setgray fill\ngrestore\nstroke\ngrestore\n\n# Engineering cryogenic setups for 100-qubit scale superconducting circuit systems\n\nKrinner et al.\n\nDepartment of Physics, ETH Z\u00fcrich, CH-8093, Z\u00fcrich, Switzerland\n\nA robust cryogenic infrastructure in form of a wired, thermally optimized dilution refrigerator (DR) is essential for present and future solid-state based quantum processors. Here, we engineer an extensible cryogenic setup, which minimizes passive and active heat loads, while guaranteeing rapid qubit control and readout. We review design criteria for qubit drive lines, flux lines, and output lines used in typical experiments with superconducting circuits and describe each type of line in detail. The passive heat load of stainless steel and NbTi coaxial cables and the active load due to signal dissipation are measured, validating our robust and extensible concept for thermal anchoring of attenuators, cables, and other microwave components.\n\nOur results are important for managing the heat budget of future large-scale quantum computers based on superconducting circuits.\n\n## Introduction\nPromising solid-state based quantum computing platforms, such as superconducting circuits [Unknown Author, \"Unknown Title\", ] or charges and spins in semiconductor quantum dots [Unknown Author, \"Unknown Title\", ], require temperatures on the Millikelvin level to initialise the systems in their ground state and to avoid errors due to thermal excitation during operation. Millikelvin temperatures are achieved in ${\\rm He^3/He^4}$ dilution refrigerators (DR). When scaling those approaches from the few qubit level to large scale quantum processors, an increasing number of microwave and DC cables need to be integrated into the dilution refrigerator. They connect the classical control electronics at room temperature (RT) to the quantum processor at the lowest temperature stage of the dilution refrigerator, creating a substantial heat load on the dilution refrigerator due to heat conduction. Besides this passive load, active load due to the dissipation of control signals in cables and attenuators plays a major role. Dissipation is necessary to thermalize the incoming radiation fields and to reduce the number of thermal photons incident on the sample [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nWhile superconducting quantum processors operating 20 qubits have been recently realized [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], their cryogenic setup and extensibility towards larger system sizes has not been reported on. Here, we present a thermally optimized, robust cabling scheme and cryogenic setup suitable for the operation of 50 qubits at a temperature of 14 mK. Disregarding space constraints in the dilution refrigerator, at least 150 qubits could be operated. Before describing our customized cryogenic system in Section <ref>, we put forward methods of how to minimize passive heat loads on the stages of the dilution refrigerator and how to minimize thermal photons in cables connecting the room temperature to the base temperature stage while keeping active load low (Section <ref>).\n\nWe then present measurements of the passive loads arising from subsequent installations of cable trees comprising typically 25 coaxial lines each, and compare them to estimates based on available data on thermal conductances of coaxial cables (Section <ref>). Active loads due to application of control signals are characterized in Section <ref>. Finally, we discuss the total heat load in Section <ref> along with possible improvements which would allow to increase the number of operational qubits to up to thousand when disregarding space constraints.\n\n### Typical cabling for experiments with superconducting circuits\nWhen designing the control lines and output lines connecting to a superconducting quantum processor (QP) the goal is to provide sufficiently strong coupling rates to the quantum processor, while minimizing decoherence due to coupling of the QP via these lines to its environment.\n\nThermal noise, present due to the connection of the QP to electronics at room temperature, not only leads to qubit dephasing [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], but can also lead to creation of quasi-particles and thus to dissipation and reduced energy relaxation times [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Hence, thorough thermalization of cables, attenuators, and microwave components at the various temperature stages of the dilution refrigerator is not only important for reducing the heat load on the dilution refrigerator, but also for protecting the QP from thermal radiation. In addition to thermal anchoring, filters with stop-bands outside the frequency range of qubits and readout resonators as well as infra-red blocking filters [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] further suppress thermal radiation. Other sources of external noise that can negatively impact coherence times include 1/f noise [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] from electronic instruments and magnetic field fluctuations or magnetic offset fields inducing magnetic vortices that can lead to dissipation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. These sources can be mitigated with appropriate filters and magnetic shielding respectively, but their study is not a focus of this work.\n\nWe briefly present an overview of the cabling typically used in experiments with superconducting circuits. We distinguish between direct-current (DC) and radio-frequency (RF) cabling. DC lines are made from twisted pair wires, that are typically low-pass filtered and thermalized at each temperature stage. Typical scopes of applications are biasing of cryogenic amplifiers and flux biasing of tunable frequency qubits [Unknown Author, \"Unknown Title\", ]. RF lines on the other hand are realized as semi-rigid microwave cables and contain various microwave components such as attenuators, filters or amplifiers. They connect to the QP and are used for control and readout of the quantum processor. One typically distinguishes between drive lines, flux lines, and output lines, which we briefly described here.\n\nDrive lines are used for driving qubits with a microwave tone realizing single-qubit gates, and for driving readout resonators. To reduce thermal population of qubits, and frequency shifts of the qubits due to their dispersive interaction with a readout resonator [Unknown Author, \"Unknown Title\", ], the number of thermal noise photons in the drive lines arriving at the mixing chamber plate (MXC) of the dilution refrigerator should be well below the single photon level in both cases. More precisely, to guarantee a noise photon number at MXC on the $10^{-3}$ level, a total attenuation of about 60 dB is required, see Section <ref> and <ref>. The bandwidth of the drive lines is required to be large enough to cover the typical frequency ranges of qubits (4-6 GHz) and of readout resonators (4-8 GHz).\n\nFlux lines are mainly used for implementing two-qubit gates which are based on the dynamical tunability of the transition frequency of a qubit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or of a separate coupling subcircuit [Unknown Author, \"Unknown Title\", ]. In addition, qubit frequency variations, occurring due to imperfections in the fabrication of Josephson junctions, can be compensated. Tunable frequency qubits, as opposed to fixed frequency qubits, make use of a SQUID loop instead of a single Josephson junction as the inductive element. By threading a magnetic flux $\\Phi$ through this loop the frequency of the qubit approximately changes as $\\omega_q\\simeq\\omega_0 \\sqrt{|{\\rm cos}(\\pi\\Phi/\\Phi_0)|}$ [Unknown Author, \"Unknown Title\", ], where $\\Phi_0$ is the magnetic flux quantum.\n\nA mutual inductance between flux line and SQUID loop is realized by routing the on-chip part of the flux line past the SQUID loop. Hence, a current applied to the flux line results in a magnetic flux in the SQUID loop, effectively tuning the transition frequency of the qubit. Low-pass filters in the flux lines limit the bandwidth to about 1 GHz eliminating thermal noise at qubit frequencies. However, since the magnetic flux $\\Phi$ in the SQUID loop sets the qubit transition frequency, current noise leads to qubit dephasing [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. To reduce it, a suitable amount of attenuation (10-20 dB) is also added in the flux lines, see Section <ref>.\n\nOutput lines contain a series of cryogenic and room temperature amplifiers for the sensitive detection of readout signals [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. To isolate the sample from thermal noise photons and from noise of amplifiers while not attenuating the output signal, isolators and circulators are used, see Section <ref> for more details.\n\n## Sources of heat loads\nWe consider three dominant contributions to the heat load on the dilution refrigerator. First, passive load is due to heat flow from higher temperature stages to lower temperature stages. Here, we consider only heat conducted through installed cables. Heat which flows via posts that separate the various plates of the dilution refrigerator is not considered because it is already taken into account in the specified cooling power of the dilution refrigerator [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Second, active load arises due to the dissipation (Joule heating) of applied microwave signals in attenuators and in the microwave cables themselves. Dissipation arising from DC signals, used e.g. to bias HEMT amplifiers at the 4K stage or to flux bias qubits on the chip at MXC, falls also in this category. Third, radiative load from stages and shields of higher temperature to stages and shields of lower temperature [Unknown Author, \"Unknown Title\", ]. This load, however, is also taken into account in the specified cooling power of the dilution refrigerator. For completeness, we mention load due to residual gas, in particular Helium since it has the highest vapor pressure at cryogenic temperatures. However, during normal operation of the dilution refrigerator, the cryo-pumping capacity of the cold surfaces in the dilution refrigerator keeps the pressure in the vacuum can below $10^{-5}$ mbar providing an adequate isolation vacuum [Unknown Author, \"Unknown Title\", ]. We therefore do not consider this load.\n\n### Passive load\nTo minimize passive heat load we use cable materials with low thermal conductivity. Note that with the exception of superconductors this typically goes along with poor electrical conductivity, and hence leads to more dissipation when microwave signals are applied. However, in most of the lines attenuation and thus dissipation is anyway desired in order to thermalize the incoming radiation fields, see Section <ref>.\n\nTo estimate the passive load due to installed cables we consider fixed temperatures on the plates of the dilution refrigerator, corresponding to a steady state, in which the heat flows onto the various stages are absorbed by the cooling powers available at those stages. Note that the cooling power on a given stage depends on the temperature of that stage. The heat flow $P_i$ to stage $i$ with temperature $T_i$ due to a single coaxial cable is given by\n\n$$\n\\label{eqn:heat-flow}\nP_i = \\int_{T_{i-1}}^{T_i}dT\\,\\frac{\\rho_{\\rm o}(T) A_{\\rm o} + \\rho_{\\rm d}(T) A_{\\rm d} + \\rho_{\\rm c}(T) A_{\\rm c}}{L_{i}},\n\n$$\nwhere $\\rho_{\\rm o}$, $\\rho_{\\rm d}$, $\\rho_{\\rm c}$, and $A_{\\rm o}$, $A_{\\rm d}$, $A_{\\rm c}$ are thermal conductivities and cross sections of outer conductor (OC), dielectric, and center conductor (CC) respectively, and $L_i$ is the length of the cable connecting stage $i-1$ and $i$. $P_i$ has units of power. The labeling $i\\in\\{1,2,3,4,5\\}$ corresponds to the stages {\"50K\", \"4K\", \"Still\", Cold plate (\"CP\"), \"MXC\"}. Table (Table tab:DR) lists the corresponding temperatures in our Bluefors XLD400 dilution refrigerator as achieved in the empty dilution refrigerator after installation. The values are typical for state of the art pulse tube cooler based dilution refrigerators [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The thermal conductivities used for the estimates in this paper are listed in Appendix <ref>.\n\nStage name     Temperature (K)     Cooling power (W)     Cable length (mm)\n\n50K     35     30 (at 45 K)     200\n\n4K     2.85     1.5 (at 4.2 K)     290\n\nStill      $882\\times 10^{-3}$     40 $\\times 10^{-3}$ (at 1.2 K)     250\n\nCP      $82\\times 10^{-3}$     200$\\times 10^{-6}$ (at 140 mK)     170\n\nMXC     $6\\times 10^{-3}$     19$\\times 10^{-6}$ (at 20 mK)    140\n\nDilution refrigerator specifications. Temperatures and available cooling powers on the indicated stages of a Bluefors XLD400 DR. Coaxial cable lengths towards the respective stages are listed as well.\n\nTo motivate the choice of cable materials detailed in Section <ref> we plot in Fig. (Figure fig:heatFlow-materials) the heat flow to the various temperature stages due to single coaxial cables of different material.\n\nNote that these estimates assume thermalization of outer conductor, dielectric, and center conductor at every temperature stage, see Section <ref> for a discussion.\n\n< g r a p h i c s >\n\nHeat flow for indicated cable types. Heat flow to the five temperature stages for indicated cable types and given cable lengths (see text).\n\nTwisted pairs (TwP) consist of either Cu or PhBr from RT to the 4K stage, and of NbTi from the 4K to the MXC stage.\n\nThree typical and readily available types of coaxial cable are shown. The lengths of the cables are listed in Table (Table tab:DR) and correspond to the inter-plate distances in the dilution refrigerator plus a small correction due to the bends in those cables (see Section <ref>). Stainless steel cables (UT85-SS-SS) and NbTi cables (UT85-NbTi) have the lowest passive load. This is why we choose them for drive and output lines, respectively. The flows of these two cable types are dominated by their outer conductor, which has a cross-sectional area that is by a factor 10 larger than the center conductor. The contribution of the Teflon dielectric is of the same order of magnitude as the one of the inner conductor. This results from the low thermal conductivity of Teflon, see Appendix <ref>, and the cross-sectional area of the dielectric being comparable to the one of the outer conductor.\n\nAn alternative to stainless steel cable is Cupronickel (CuNi) cable. It is expected to have a 20-30\n\nIn our dilution refrigerator DC wiring is pre-installed. Copper or Phosphor-Bronze (PhBr) twisted pairs of diameters AWG35 and AWG36 respectively are only used from room temperature to the 4K stage due to their large thermal conductivity. From 4K to MXC superconducting NbTi twisted pairs are used[For clarity, NbTi twisted pairs are considered to consist of pure NbTi, although they are typically embedded in a CuNi matrix for mechanical stability.]. Fig. (Figure fig:heatFlow-materials) shows that among these materials only Cu twisted pairs cause a significant passive load comparable to the one of the coaxial cables.\n\n### Active load\nThe active load in the dilution refrigerator depends on the attenuation installed in the RF lines and on the signal levels required at the chip. We therefore in this section briefly discuss how much attenuation is needed to suppress thermal noise and how to distribute the attenuators among the various temperature stages. Furthermore, we discuss the signal levels required in typical experiments with superconducting qubits.\n\n#### The need of attenuation\nAlthough the signals required to drive qubits or to read them out are small (e.g. a peak power of -66 dBm for a 30 ns long $\\pi$-pulse), the power applied at the input of the dilution refrigerator needs to be orders of magnitude larger. This is because a total attenuation of at least $\\sim 60\\,$dB is required to reduce room temperature blackbody radiation, present in cables thermalized at room temperature, to a level corresponding to a thermal photon occupation number of a few $10^{-3}$ at the sample. This one-dimensional blackbody radiation in cables is known as Johnson-Nyquist noise in electronics. If a resistor $R$ is connected to the cable or if the cable is coaxial with a characteristic impedance $R$ the induced voltage fluctuations have a two-sided power spectral density given by\n$$\n\\label{eqn:JNnoisequantum}\nS_{V}^{\\rm th}(T) = 2 {\\rm k_B} T R \\frac{h|\\nu|}{{\\rm k_B} T} \\frac{1}{\\textup{exp}(h|\\nu|/{\\rm k_B} T)-1}.\n\n$$\n\nThe last factor in this equation is the photon occupation number as dictated by the Bose-Einstein distribution $n_{\\textup{BE}}=1/\\left[ \\textup{exp}(h|\\nu|/{\\rm k_B} T)-1 \\right]$. It is dimensionless and can be thought of as number of photons per Hz frequency interval, per second. In the classical limit $h\\nu\\ll{\\rm k_B} T$ one recovers the original (two-sided) Johnson Nyquist formula $S_{V}^{\\rm th}(T) = 2 {\\rm k_B} T R$.\n\nIn a coaxial cable connecting room temperature to base temperature, thermal photons\n\npropagate down the line towards the lower temperature stages. To reduce the spectral density of this radiation a series of attenuators is installed in the microwave line.\n\nAn attenuator with an attenuation of $A=20\\,\\textup{dB}=100$  can be considered to effectively function as a beamsplitter which transmits 1\n$$\n\\label{eqn:attenuator}\nn_i(\\nu)=\\frac{n_{i-1}(\\nu)}{A_i} + \\frac{A_i-1}{A_i}n_{\\textup{BE}}(T_{i,{\\rm att}},\\nu).\n\n$$\nWhen installing a cascade of attenuators in the microwave line thermalized at subsequently lower temperature stages, we employ this relation to determine the noise photon occupation number at the MXC stage, $n_{\\rm MXC}$.\n\nFor our considerations we fix the signal frequency to $\\nu_0=6$ GHz since typical qubits are operated at 5 GHz and typical readout resonators at 7 GHz. A lower bound for the total attenuation needed to achieve a noise photon number of $n_{\\rm MXC}=10^{-3}$ is obtained by neglecting the second term on the r.h.s. of Eqn. <ref> yielding $n_{\\textup{BE}}(T=300\\,{\\rm K},\\nu_0)/10^{-3}=60$ dB. This is a lower bound since blackbody radiation emitted by attenuators at all other temperature stages is neglected.\n\nDistributing the total attenuation among the various temperature stages is important to keep the active load on the lower stages well below the cooling powers available at those stages. In distributing the attenuation we avoid putting more attenuation $A_i$ on stage $i$ than is needed to thermalize the incoming radiation fields onto that stage, i.e. the first term on the r.h.s. of Eqn. <ref> should not be significantly smaller than the value to which the second term saturates for $A_i\\gg1$. Hence, good reference values for the attenuation on stage $i$ are $A_{i,{\\rm ref}}=n_{\\textup{BE}}(T_{i-1},\\nu_0)/n_{\\textup{BE}}(T_{i},\\nu_0)$. As an example we consider a total attenuation of 60 dB that is composed of 20 dB attenuators on the 4K, CP, and MXC stages. We first plot $n_{\\rm MXC}$ as a function of $A_{\\rm 4K}$ for a fixed attenuation of 20 dB at the CP and MXC stages respectively, see blue solid line in Fig. (Figure fig:thermal-photons). We observe that the number of noise photons is efficiently reduced by increasing the attenuation up to $\\sim20\\,$dB, as expected from the reference value $A_{\\rm 4K, guess}=n_{\\textup{BE}}(T_{\\rm RT},\\nu_0)/n_{\\textup{BE}}(T_{\\rm 4K},\\nu_0)\\approx T_{\\rm RT}/T_{\\rm 4K}=300/3=20$ dB. More attenuation is unnecessary because at this value the radiation field incident from room temperature has reached the 4K thermal noise floor.\n\n< g r a p h i c s >\n\n< g r a p h i c s >\n\nThermal noise photon numbers. a) Calculated thermal photon number at MXC as a function of the degree of attenuation at the 4K stage (blue), CP (green), MXC (red) for a fixed attenuation of 20dB at the respective other stages (45K stage and 1K stage have no attenuators in this example). The calculations are based on Eqn. <ref>. b) Thermal noise current spectral density at MXC as a function of attenuation at the 4K stage, calculated using Eqn. <ref>.\n\nA similar property is found when plotting $n_{\\rm MXC}$ as a function of $A_{\\rm CP}$, for a fixed attenuation of 20 dB at the 4K and MXC stages respectively (green dashed line in Fig. (Figure fig:thermal-photons)). Here a little bit more than 20 dB attenuation would further reduce $n_{\\rm MXC}$, as expected from a reference value $A_{\\rm CP, ref}=n_{\\textup{BE}}(T_{\\rm 4K},\\nu_0)/n_{\\textup{BE}}(T_{\\rm CP},\\nu_0)=22$ dB.\n\nWe finally plot $n_{\\rm MXC}$ as a function of attenuation at MXC (red dash-dotted line in Fig. (Figure fig:thermal-photons)). It demonstrates that over the considered attenuation range adding more attenuation at MXC linearly decreases $n_{\\rm MXC}$. This is because the noise floor of thermal photons at MXC is as low as $n_{\\textup{BE}}(T_{\\rm MXC}=20\\,{\\rm mK},\\nu_0)=6\\times 10^{-7}$. However, we will see in section <ref> that the limited cooling power at MXC prevents us from installing significantly more than 20 dB of attenuation at MXC.\n\n#### Signal levels required for the operation of the QP\nIn this section we estimate the powers required at the chip for two important operations on superconducting qubits: driving a $\\pi$-pulse on a qubit and setting a flux bias on a qubit.\n\nTo drive a $\\pi$-pulse on a qubit, we apply an RF pulse at the qubit frequency with a Gaussian envelope through a CPW transmission line weakly capacitively coupled to the qubit. This coupling has to be sufficiently small to prevent Purcell decay of the qubit into the transmission line [Unknown Author, \"Unknown Title\", ]. The finite value of the coupling imposes a limit on the $T_1$ time of the qubit, which we target here to be no lower than $T_1^{\\rm lim}=0.5\\,$ms, significantly larger than state-of-the-art coherence times [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The amplitude of the time-dependent Rabi frequency $\\Omega_R(t) = \\Omega_0 {\\rm exp}\\left[-t^2/(2\\sigma^2)\\right]$ for a 30 ns long $\\pi$-pulse with a width of $\\sigma=5\\,$ns is given by $\\Omega_0=\\sqrt{\\pi/(2\\sigma^2)}\\approx2\\pi\\times 40$ MHz. To achieve this value a peak power $P_{\\rm p}=\\hbar\\omega_q T_1^{\\rm lim}\\Omega_0^2/4\\approx -66\\,$dBm is needed [Unknown Author, \"Unknown Title\", ]. For an estimate of the associated heat load we employ the average power of the pulse, $P_{\\rm avg}=P_{\\rm p}\\frac{1}{6\\sigma}\\int_{-3\\sigma}^{3\\sigma}{\\rm exp}\\left[-t^2/(2\\sigma^2)\\right]\\,{\\rm d}t=\\frac{\\sqrt{\\pi}}{6}P_{\\rm p}\\approx -71\\,$dBm. This number will be further reduced due to a finite duty cycle of those pulses during the execution of a quantum algorithm. We assume a maximum duty cycle of 33\n\nReadout signals used to drive readout resonators to infer the state of qubits are typically an order of magnitude smaller and have a lower duty cycle. They are therefore not taken into account in our estimates.\n\nConcerning dissipation in flux lines, we primarily consider DC biasing currents, which are constantly applied to set the qubit frequency, in most of the cases to the so-called sweet spot frequency $\\omega_q=\\omega_0$, at which $\\omega_q$ is to first-order insensitive to flux noise [Unknown Author, \"Unknown Title\", ]. Assuming a worst case scenario of random offset magnetic fields in the SQUID loops, the compensating flux $\\Phi_{\\rm offset}$ which we apply to reach the closest sweet spot, is equally distributed in the interval $[-\\Phi_0/2,\\Phi_0/2]$. This corresponds to a current interval of [-1,1] mA, when using a reasonable mutual inductance between flux line and SQUID loop of $M=\\partial\\Phi/\\partial I=0.5$ $\\Phi_0/{\\rm mA}$. The mutual inductance is determined by the coupling strength (proximity) of the on-chip flux line to the SQUID loop and the area of the SQUID loop. A large $M$ on the one hand minimizes the required current and thus dissipation in the line, and allows for the usage of low-noise current sources which typically have a small dynamic range. On the other hand, a large SQUID loop is also more susceptible to (external) magnetic flux noise, and care needs to be taken in the design of large coupling strengths in order to keep residual capacitive coupling of the qubit to the flux line low, which otherwise can limit the qubit lifetime due to the Purcell effect [Unknown Author, \"Unknown Title\", ]. The dissipated heat due to the bias currents is most critical at the MXC stage because least cooling power is available there. The amount of dissipation\n\ndepends on the DC resistances of the stainless steel cable and low-pass filter installed between CP and MXC, and to which stage this dissipated heat predominantly flows to. We experimentally determine this heat load as discussed in Section <ref>.\n\nWe also consider dissipation due to flux pulses, which are used for the realization of two-qubit gates. Assuming that during the flux pulse the qubit's frequency is tuned by about 10\n\n### Radiative load\nEach temperature stage except for CP is fitted with a dedicated heat shield. For a given temperature stage $i$ we calculate the radiative heat load on heat shield $i$ from the enclosing heat shield by assuming infinitely extended cylindrical heat shields, and solving a system of coupled heat equations. The heat shields are made of Aluminium on the 50K and 4K stage and of Cu on Still and MXC. They are characterized by their emissivity $\\epsilon=0.06$, as quoted by the manufacturer.\n\nCompared to the cooling power of each stage, we find a significant contribution only for the 50K stage, amounting to $\\sim 50\\,$W. This corresponds to about half of the nominal cooling power of the two pulse tube coolers (2x Cryomech PT 420). This load however has already been taken into account in the available cooling power as specified by the manufacturer (40-50 W). Radiative loads at the lower temperature stages are insignificant [Unknown Author, \"Unknown Title\", ].\n\n## Cryogenic setup\n< g r a p h i c s >\n\nCabled dilution refrigerator (DR). a) Bluefors XLD DR with 25 drive lines, 25 flux lines, 4 read-out, 6 read-in, and 5 pump lines installed (see end of Section <ref> for details). b) Schematic of the cabling configuration inside the DR.\n\n### Dilution refrigerator (DR)\nA customized version of a Bluefors XLD400 dilution refrigerator as described in this paper is shown in Fig. (Figure fig:DR) a. It has a dilution unit positioned in the center of the MXC plate, making space available for an additional line-of-sight (LOS) port at the circumference of the system. A total of six LOS side ports are available in the system for the installation of RF cables. A LOS port consists of a series of vertically aligned cutouts in the plates of the dilution refrigerator designed for the installation of Cu plates for the thermalization of cables and attenuators, see Fig. (Figure fig:thermalizationscheme) a-c. Instead of the circular cutouts we designed rectangular cutouts with a width of 88 mm. They allow for mounting fully assembled cable trees from the side using a custom mounting tool, see Fig. (Figure fig:thermalizationscheme) e-g. This has the advantage that the cable trees, comprising 25 RF lines and the vacuum flange, can be pre-assembled and tested outside of the dilution refrigerator. Two out of the eight sectors at the circumference at the 50K and 4K stages are occupied by two pulse tube coolers , but we make use of the corresponding cutouts on the Still, CP, MXC stages for installing readout components, as discussed below.\n\nFurthermore, the distance between the Still plate and the CP has been enlarged by 60 mm to provide more space for the inline integration of MW components, and for reducing the passive heat load due to the cables from Still to CP. The dilution refrigerator was pre-equipped by the manufacturer according to our specifications with two looms of Cu twisted pairs (AWG 35) and two looms of Ph-Br twisted pairs (AWG 36), running both from room temperature to 4K. From 4K to MXC two looms of NbTi twisted pairs were pre-installed. Each of the looms contains 12 twisted pairs.\n\nWe have measured the cooling powers available on all stages of our custom dilution refrigerator (in the presence of the pre-installed DC wiring), see Table (Table tab:DR), using the technique described in Section <ref>. These powers are not to be exceeded to guarantee a base temperature below 20 mK [Unknown Author, \"Unknown Title\", ]. We designed and planned the wiring and attenuation scheme of the dilution refrigerator with the goal to not exceed those cooling powers.\n\nThe table also contains the RF cable lengths between the stages. Note that the cables have bends (bending radius $\\sim 1\\,$cm) to reduce strain on RF connectors when the system is cooled down.\n\nAs discussed in Section <ref>, good thermalization of the cables and attenuators is important for both reducing thermal noise photons affecting qubit coherence and reducing the heat load on the lower temperature stages affecting the cryostat performance. For this purpose, we have developed a flexible thermalization method for both attenuators and cables. It consists of a Cu plate with hexagonal cutouts, in which we individually clamp attenuators using a wedge shaped Cu piece, which presses the attenuator against two faces of the cutout when tightening a three millimeter (M3) Brass screw (Fig. (Figure fig:thermalizationscheme) a and b). The torque applied on each screw for fastening amounts to 0.9 Nm. We use Brass screws as they thermally contract more than Cu when cooled down, providing additional clamping force to the attenuator. This is important, because in general the contact resistance between two metal pieces at low temperatures is dominated by clamping force rather than surface area [Unknown Author, \"Unknown Title\", ]. We thermalize RF cables using the same Cu plate (Fig. (Figure fig:thermalizationscheme) c) in combination with a two-part Cu adapter (Fig. (Figure fig:thermalizationscheme) d). The round flange on those pieces guarantees radiation tight mounting. Using those plates we fit 25 RF lines into each of the six LOS ports.\n\n< g r a p h i c s >\n\nThermalization concept and pre-assembly of cable trees. a) CAD drawing of the Cu plate used to mount attenuators. To clamp the attenuators to the copper plate, an adapter as shown in d) is used. The Cu plates are then screwed onto the corresponding plate of the DR. b) Photograph of such a mounting plate with cabling installed in the DR. c) Photograph of the same plate, here used to clamp RF cables using the radiation tight Cu adapter pieces shown in d). d) Two-part Cu adapter that is pressed around an RF cable using the wedge shaped piece in the middle in combination with a screw (see also a)). e) Preassembly tool with mounted Cu plates and vacuum flange. f) Vacuum flange with vacuum tight SMA adapters installed. g) Mounting the preassembled cable tree into the DR using a custom mounting tool.\n\nWe now continue to describe in more detail the custom cabling of the dilution refrigerator. Schematics of drive lines, flux lines, and lines for readout are shown in Fig. (Figure fig:DR)\u00a0b and are typical for superconducting qubit experiments. To minimize passive heat load, we choose UT85-SS-SS cables for all types of lines except for the output lines[Smaller diameter cables of the same type would further reduce the passive heat load, but introduce a larger frequency dependence in the S21 transmission parameter.]. We characterize and test the system at half of its capacity by installing three out of six possible cable trees in the dilution refrigerator: a cable tree comprising of 25 drive lines, a cable tree comprising of 25 flux lines, and a cable tree comprising of lines needed for readout. This readout cable tree consists of six drive lines and 5 pump lines (see Section <ref>), running both from top to bottom of the dilution refrigerator, and four output lines running from room temperature to 4K. The remaining parts of the output lines continue in the non-LOS cutouts below one of the pulse tube coolers, where more space is available, see Fig. (Figure fig:outputlinecomponents).\n\n### Drive line configuration\nBased on our discussion of thermal noise photons in Section <ref> here we motivate our choice of attenuator configuration of 20 dB attenuators at each of the 4K, CP, MXC stages. We first plot the thermal noise photon number at MXC $n_{\\rm MXC}$ in a coaxial cable connecting the room temperature vacuum flange to MXC, for four attenuator configurations each with 60 dB of total attenuation, see Fig. (Figure fig:signal-dissipation) a. The calculations assume as effective attenuator temperatures the plate temperatures listed in the second column of Table (Table tab:DR). For configuration C1={0, 10, 0, 20, 30} dB we obtain $n_{\\rm MXC}\\approx0.0012$, which is only by 12\n\nRemoving 10 dB of attenuation at the CP and adding 10 dB at the 4K stage results in C2={0, 20, 0, 10, 30} dB and reduces the active load on the CP by a factor 10. The resulting value of $n_{\\rm MXC}=0.002$ is almost a factor of two larger than in C1 because 20 dB of attenuation at the 4K stage already corresponds to the regime where $n_{\\rm MXC}$ as a function of $A_{\\rm 4K}$ starts to saturate to the 4K noise floor, see Fig. (Figure fig:thermal-photons) a. We also note that dissipation on the 4K stage is relatively low compared to the available cooling power and thus redistributing some of the attenuation at 4K to the 50K stage is not necessary. Configuration C3={0, 20, 0, 20, 20} dB corresponds to C2 with 10 dB of attenuation moved from the MXC to the CP stage. In this case the noise photon number only increases by 20\n\nTo further reduce the active load on the CP by a factor ten one can redistribute 10 dB from the CP to the Still, resulting in configuration C4={0, 20, 10, 10, 20} dB. However, $n_{\\rm MXC}$ thereby increases by a factor of two compared to C3, which can be explained with similar arguments as above. A relatively small increase in $n_{\\rm MXC}$ as compared to C3 can be achieved by redistributing only 3 dB from the CP to the Still, reducing the load on the CP by a factor two. However, this is not very practical since it comes along with a non-standard attenuation of 17 dB at the CP. In addition, solutions with four attenuators require an additional hardware cost of one attenuator and one connectorized RF cable per line as compared to solutions with only three attenuators per line.\n\nAs a compromise between the number of noise photons and a low heat load on MXC we select C3, with a noise photon number of about 0.1\n\nTo filter infrared radiation that can lead to quasi-particle generation and thus to a reduced $T_1$ time [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], we provide the option to install a custom-built IR filter based on Eccosorb CR-124 absorber material right before the attenuator at MXC, see Appendix <ref>. With an attenuation of 6 dB at 6 GHz, it further reduces $n_{\\rm MXC}$ by a factor four, while increasing dissipation on all stages except MXC by a factor four.\n\n< g r a p h i c s >\n\nThermal noise photons and signal dissipation. a) Thermal noise photon number $n_{\\rm MXC}$ at 6 GHz for four attenuator configurations C1-C4 in the drive lines (see text). Taking into account attenuation in the cables reduces $n_{\\rm MXC}$ to the values indicated by the dashed bars. b) Dissipated power on the indicated stages of the DR due to the operation of 25 drive lines with signal levels translating into an average power level of -78 dBm at the input of the QP. Calculations for the four attenuator configurations C1-C4 are shown.\n\n### Flux line configuration\nTo reduce current and thus magnetic flux noise in the SQUID loop of a qubit, a suitable amount of attenuation needs to be installed in the flux lines. Part of this attenuation can be realized at room temperature to reduce 1/f noise and white noise from the instruments connected to the flux line (e.g. an arbitrary waveform generator) to the level of room temperature Johnson-Nyquist noise.\n\nTo reduce the noise level below room temperature Johnson-Nyquist noise we install a single attenuator $A_{\\rm 4K}$at the 4K stage.\n\nThe current-noise power spectral density after this attenuator is calculated as\n$$\n\\label{eqn:currentnoise}\nS_{I}^{\\rm th, eff} = \\frac{S_{I}^{\\rm th}(T_{\\rm RT})}{A_{\\rm 4K}} + \\frac{A_{\\rm 4K}-1}{A_{\\rm 4K}}S_{I}^{\\rm th}(T_{\\rm 4K}),\n\n$$\nwhere $S_{I}^{\\rm th}(T) = 2 {\\rm k_B} T/R$ is the two-sided current-noise power spectral density of Johnson-Nyquist noise. The resistance $R=50\\,\\Omega$ corresponds to the internal impedance of a typical arbitrary waveform generator instrument.\n\nNote that as opposed to using Eq. <ref> in the context of thermal noise in the drive lines, considering the classical Johnson-Nyquist formula here is sufficient since the thermal energy at $T_{\\rm 4K}\\approx 3$ K is much larger than the relevant noise frequencies of $\\lesssim 1$ GHz. We plot $S_{I}^{\\rm th, eff}$ as a function of $A_{\\rm 4K}$ for $T_{\\rm RT}\\approx 300$ K and $T_{\\rm 4K}\\approx 3$ K in Fig. (Figure fig:thermal-photons) b. Similar to Fig. (Figure fig:thermal-photons) a $S_{I}^{\\rm th, eff}$  saturates at the thermal noise floor of the 4K stage for attenuator values $A_{\\rm 4K}\\gtrsim 20$ dB.\n\nWe use $S_{I}^{\\rm th, eff}$ for deriving upper bounds on the coherence times $T_2^*$ and the echo coherence time $T_2$ due to thermal noise in the flux lines [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\n$$\n\\label{eq:T2limitwhite}\nT_2^* = \\frac{1}{2} T_2^E = \\frac{2}{D^2 S_I}.\n\n$$\nHere, $S_I(\\omega)=\\int {\\rm d}t\\langle\\delta I(0) \\delta I(t)\\rangle {\\rm e}^{-i\\omega t}$ is the power spectral density of the current noise and $D$ the sensitivity of the qubit transition frequency $\\omega_{\\rm ge}$ to the current $I$ in the flux line\n$$\n\\label{eqn:partials}\nD = \\frac{\\partial\\omega_{\\rm ge}}{\\partial I} = \\frac{\\partial\\omega_{\\rm ge}}{\\partial \\Phi} \\frac{\\partial\\Phi}{\\partial I}.\n\n$$\nUsing a typical mutual inductance between flux line and SQUID loop of $M=\\frac\\partial\\Phi\\partial I=0.5$ $\\Phi_0/{\\rm mA}$ we obtain $T_2^*=(46, 426, 2333)\\,\\mu$s for an attenuation of (0, 10, 20) dB, at a 10\n\n### Output line configuration\nOur four output lines are designed for the detection of signals on the single photon level [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. We use travelling wave Josephson parametric amplifiers (TWPA) [Unknown Author, \"Unknown Title\", ] with a broadband gain of 20-30 dB over a frequency range of 3-12 GHz as a near-quantum limited amplifier installed at MXC, see Fig. (Figure fig:outputlinecomponents) a. High-electron mobility transistor (HEMT) amplifiers (LNF LNC4_8C) with a gain of about 40 dB are installed at the 4K stage, see Fig. (Figure fig:outputlinecomponents) b. More than a total of 60 dB isolation towards the sample is provided by a circulator (Quinstar QCY-060400CM00) at CP and two isolators at MXC. The two isolators with an operation range of 3-12 GHz are also required for impedance matching of the TWPA over its entire gain bandwidth. For this purpose, one of the isolators is installed before and one after the TWPA, see Fig. (Figure fig:DR) b. Each isolator is part of a four-channel isolator array (Quinstar QCC-075900XM000), see Fig. (Figure fig:outputlinecomponents) a. Circulators and isolators are both magnetically shielded.\n\nA reflective cavity bandpass filter (Keenlion KBF-4/8-2S) at MXC suppresses noise at frequencies outside the bandwidths of circulator and isolators, see Fig. (Figure fig:outputlinecomponents) c. To minimize signal loss between the two amplfiers, we use superconducting NbTi coaxial cables between MXC and 4K. To minimize passive heat load we chose stainless steel cables from 4K to room temperature. According to Friis formula the increased loss compared to e.g. SPCW cable does not decrease the signal to noise ratio of the amplifier chain. E.g. a loss of 10 dB in the cable section between HEMT and the first amplifier at room temperature can be tolerated if one uses a low noise amplifier with a noise temperature of about $500$ K as a first amplifier at room temperature[When using only a HEMT amplifier as a cryogenic amplifier (and not a TWPA), an ultra-low noise amplifier with a noise temperature of about 100 K is required].\n\nFor the operation of the TWPA a microwave pump signal with a typical frequency in the range 6-8 GHz and a power level at the input of the TWPA of about $-55$ dBm is required. This pump signal is added to the TWPA via the isolated port of a 20 dB directional coupler[Choosing a smaller coupling ratio would decrease the transmission of the readout signal through the directional coupler accordingly.] (Krytar 120420), see Fig. (Figure fig:DR) b. Due to the relatively large pump power we use pump lines with a total of 50 dB attenuation as compared to the 60 dB in the drive lines. This 50 dB of attenuation includes the 20 dB attenuation provided by the directional coupler with its coupled port terminated with a 50 $\\Omega$ load resistance. Photographs of the readout components described in this Section are shown in Fig. (Figure fig:outputlinecomponents). The TWPAs and the isolator arrays are mounted to 2 mm thick Cu sheets whose stability is enforced by Cu bars at their borders, see Fig. (Figure fig:outputlinecomponents) a. For compact mounting and thermalization, the four TWPAs and the four bandpass filters (Fig. (Figure fig:outputlinecomponents) c) are first stacked using Cu spacers between them, which are then mounted to the Cu sheet or to an L-shaped bracket, respectively. Similarly, the four HEMT amplifiers and the four circulators are first mounted onto Cu pieces which are then mounted to a common bracket.\n\nUsing the concept of frequency-multiplexed readout [Unknown Author, \"Unknown Title\", ], each readout line allows for the simultaneous readout of up to 10 superconducting qubits. A pre-requisite for fast frequency-multiplexed single-shot readout is a near-quantum limited amplfier with a bandwidth of at least 1 GHz such as a TWPA.\n\n< g r a p h i c s >\n\nIntegration of four high-bandwidth output lines.  a) Components mounted on the MXC plate: readout signals from the quantum processor travel through a first 4-channel, magnetically shielded isolator array (right), followed by directional couplers, TWPAs and a second, identical isolator array (left). b) Four HEMT amplifiers mounted on the 4K plate. c) Four bandpass filters, mounted and thermalized at the MXC plate, followed by four circulators mounted to the cold plate.\n\n## Direct measurements of the passive heat load\nTo determine the passive heat load induced by each cable tree and to extract a heat load per line, we initially performed reference measurements of the cooling power in the dilution refrigerator system as delivered without microwave cabling. Then we cooled down the system each time we installed a new cable tree and recorded the temperature increases on each of the stages of the dilution refrigerator to infer the corresponding passive heat loads. The cooldown of cable trees comprising up to 25 identical lines of a given type has the advantage of generating temperature increases that are larger than typical run-to-run temperature variations on the stages of the dilution refrigerator. Furthermore, this method naturally averages over variations in material and components, as well as over possible variations occurring in the installation and thermalization of individual cables and attenuators.\n\n### Reference measurements\nOur reference measurements consist of applying a well defined heat load to a given temperature stage and recording the increased steady state temperature increases on all the other stages. In steady state the applied heat load corresponds to the cooling power on that stage at its steady state temperature. The measured relative temperature increases are shown as a function of heat load applied to a given stage in Fig. (Figure fig:passiveLoadGraphs). The absolute temperature increase on the stage, to which the power is applied, is indicated on the right axis of each plot.\n\nThe 50K stage and the 4K stage show approximately linear temperature increases over the range of applied powers (up to 10 W for the 50K stage and 0.9W for the 4K stage).\n\nHeating a given stage also affects stages at lower temperature because they are thermally connected via structural elements of the dilution refrigerator such as posts and other elements such as the dilution unit and pre-installed DC wiring. In addition the $^3{\\rm He}$ reaching the Still in the gas phase for condensation is effectively hotter when 50K and 4K stages are heated leading to a larger load on the Still.\n\nThe cooling power on the Still stage is provided mainly by the evaporation of $^3{\\rm He}$ and reflects the dependence of the partial pressure of $^3{\\rm He}$ on temperature [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The temperature of the Still plate increases by about 60\n\nThe CP has no active cooling element, but since it is mounted on top of the last set of heat exchangers [Unknown Author, \"Unknown Title\", ] it is effectively cooled by the cold mixture entering and leaving the mixing chamber. We measure the temperature increase over a relatively wide range of heat powers up to 300 $\\mu$W since our attenuator configuration C3 in the drive lines is expected to create a significant active load on the CP.\n\nOver this range the temperature of the CP doubles from about 80 mK to about 160 mK, see Fig. (Figure fig:passiveLoadGraphs) d. The effect on $T_{\\rm MXC}$ is relatively low, e.g. at the largest measured value of $P_{\\rm CP}=300\\,\\mu$W $T_{\\rm MXC}$ rises from 6.1 mK to 8.1 mK, corresponding to an effective load of only 1 $\\mu$W on the MXC stage.\n\n< g r a p h i c s >\n\nReference measurements in the DR system as delivered. Temperature increases on the different plates of the DR as a function of applied power to the 50K (a), 4K (b), Still (c), CP (d), MXC (e) stages. The temperatures indicated in the upper left corner of the plots represent the starting temperatures, without heat power applied.\n\n### Determination of passive heat loads\nThe reference measurments presented in Fig. (Figure fig:passiveLoadGraphs) allow us to convert an increase in temperature $\\Delta T_i$ observed on stage $i$ after the cooldown of a given cable tree, into a passive heat load\n$$\n\\label{eqn:passiveloadextr}\n\\Delta P_i = \\frac{\\partial P_i}{\\partial T_i}\\Delta T_i\n\n$$\non that stage. The coefficients $\\frac{\\partial P_i}{\\partial T_i}$ are extracted from a linear fit to the low (relative) temperature regimes of the data in Fig. (Figure fig:passiveLoadGraphs). All measured $\\Delta T_i$ are sufficiently small to justify the use of this linear expansion. Additional loads due to an increased temperature of the next higher stage $i-1$ are subtracted by substituting $\\Delta T_i\\rightarrow \\Delta \\tilde{T}_i=\\Delta T_i-\\frac{\\partial T_i}{\\partial P_{i-1}}\\Delta P_{i-1}$ in the r.h.s. of Eq. <ref>. This corresponds to a shift of the data in Fig. (Figure fig:passiveLoadGraphs) along the horizontal axes in negative direction. We have verified this procedure by measuring $T_i$ vs. $P_i$ curves for $P_{i-1}\\neq 0$. The resulting data sets lie on top of their $P_{i-1}= 0$ counterparts in Fig. (Figure fig:passiveLoadGraphs) when shifting the data along the applied power axis by an amount corresponding to $(\\partial T_i/\\partial P_{i-1}) P_{i-1}$. A significant correction $>20$\n\nAdditional care needs to be taken when determining $\\Delta T_{\\rm CP}$ and $\\Delta T_{\\rm MXC}$. This is because an increased Still temperature changes the flow through the dilution unit thereby not only leading to an additional passive load on CP and MXC, but effectively changing the cooling power vs temperature curves. This is most evident for the MXC stage when considering the relation $P_{\\rm MXC}\\propto \\dot{n}_3T_{\\rm MXC}^2$ from above. Before determining $\\Delta T_{\\rm CP}$ and $\\Delta T_{\\rm MXC}$ we thus reduce the Still heat power such that we reach $T_{\\rm Still}=882(1)\\,$mK, correponding to the flow of 0.69(1) mmol/s set for the reference measurements.\n\n!\n\n1l|     1r50K     1r4K     1rStill     1rCP    1rMXC\n\n2*[origin=c]90[c]1.7 cmDrive line UT085 SS-SS       Measured HL     45(23) mW     1.0(2) mW     4(3) $\\mu$W     0.4(2)$\\mu$W     0.013(6)$\\mu$W\n\nPredicted HL     24-27 mW     0.4-1.7 mW     1.9-2.1 $\\mu$W     0.33-0.43 $\\mu$W     0.004 $\\mu$W\n\n2*[origin=c]90[c]1.7cmFlux line UT085 SS-SS \t    Measured HL     56(27) mW     1.2(2) mW     2(1) $\\mu$W     0.29(3) $\\mu$W     0.025(5) $\\mu$W\n\nPredicted HL     24-27 mW     0.4-1.7 mW     1.9-2.1 $\\mu$W     0.30 $\\mu$W     0.027-0.131 $\\mu$W\n\n2*[origin=c]90[c]1.7cmOutput line UT085 NbTi\nMeasured HL     -     -     -     0.29(12) $\\mu$W     0.020(16) $\\mu$W\n\nPredicted HL    -   -   -     0.29-0.39 $\\mu$W      0.012-0.023 $\\mu$W\n\nPassive heat load per line.  Passive heat load (HL) of cable types installed in the DR, as inferred from observed temperature increases after the installation of new cables into the DR. The upper and middle sections of the table refer to 0.085\" diameter stainless steel coaxial cable (UT085 SS-SS) with attenuator configurations used in drive lines and flux lines, respectively. Error bars include statistical errors between different cooldowns and systematic uncertainties in the temperature measurements. The intervals of predicted heat loads correspond to calculations of lower and upper bounds (see text).\n\nTo extract the passive heat loads for each type of line we separately cooled down the dilution refrigerator after installation of the drive line cable tree, the readout cable tree without the NbTi lines, the four NbTi output lines between the 4K stage and the MXC stage, and the flux line cable tree, respectively. From the extracted total passive heat load after each cooldown we calculate an average load per line by dividing the total loads by the number of lines in the cable tree.\n\nTo extract a mean passive load per drive line we combine the data from the cooldown of the drive line tree and the readout tree since the readout tree consists of drive lines and pump lines having the same thermalization scheme with attenuators at the 4K, CP, and MXC stages. The data is shown in the first section of Table (Table tab:passiveload).\n\nThe determined heat loads are in qualitative agreement with predictions based on Eq. <ref>, see row \"Predicted HL\" in the upper part of Table (Table tab:passiveload). The lower and upper bounds of the intervals represent estimates in which thermalization of the center conductor and dielectric on stages without attenuator (50K and Still stage) is fully achieved or not at all. In calculating the predicted passive load we have assumed that the center conductor is fully thermalized on stages with an attenuator. However, it is an open question how well the center conductor thermalizes to the CC inside an attenuator and it is likely to depend on the physical structure and thermal properties of the attenuator [Unknown Author, \"Unknown Title\", ].\n\nWhile the measured loads on the 50K, 4K, Still, CP stages agree within error bars with the predicted values, the load on the MXC stage is larger than predicted. This can have several reasons.\n\nFirst, there could be discrepancies between the thermal conductivitiy of the particular stainless steel (SS) of the cables and the data used for the estimates in that temperature interval. Second, thermalization of the center conductor via the attenuator at the CP could be ineffective. Third, the long timescales for thermalization of components at MXC, in particular if they contain hydrogen [Unknown Author, \"Unknown Title\", ], can lead to an overestimation of the heat load since we measure $\\Delta T_i$ always at the same time ($\\sim$1 day after the condensation of the mixture when the MXC temperature is sufficiently stable). Fourth, gas describing from newly installed components' outgassing can freeze out at MXC, creating an additional heat load.\n\nThe average passive loads per flux line on the 50K, 4K, and Still stages agree within error bars with the corresponding passive loads per drive line, see second section of Table (Table tab:passiveload). This is expected since the two types of line are nominally identical from the vacuum flange to the Still stage. The load on the CP is also comparable to the corresponding load per drive line. This observation is also expected because the additional load on the CP in case of full thermalization of the center conductor as compared to no thermalization at all is only by 0.03 $\\mu$W (0.13 $\\mu$W) larger if the closest upper stage at which the center conductor is thermalized is the Still (4K) stage. Note that this corresponds to the interval of 0.33-0.43 $\\mu$W for the predicted load per drive line as compared to the predicted load per flux line of 0.3 $\\mu$W. The intervals for the predicted loads are calculated for complete thermalization of the center conductor at the 50K and Still stages or no thermalization of the center conductor at all.\n\nThe passive load per flux line on MXC is significantly larger than the one per drive line. This is due to the absence of an attenuator in the flux line at the CP causing a direct passive load from the Still to the MXC stage via the center conductor. Thermalization of the center conductor at the Still stage is likely because otherwise a load of 0.131 $\\mu$W at MXC is expected, which is by a factor of four larger than what we measure.\n\nThe passive loads extracted from the cooldown of the four NbTi lines are listed in the third section of Table (Table tab:passiveload), showing agreement with the predictions. Since it is unclear whether a circulator helps for achieving thermalization of the center conductor we calculate lower and upper bounds for the predicted heat loads by assuming complete thermalization of the center conductor at Still and CP or no thermalization at all. However, the error bars on the measured values are too large to draw any conclusion in that respect.\n\nIn summary, after the installation of 66 RF lines, mainly UT085-SS-SS, $T_{\\rm MXC}$ increased from 6.1(1) mK to 8.4(2) mK, corresponding to a total passive heat load on MXC of $1.4(2)\\,\\mu$W. This is more than a factor of ten smaller than the available cooling power at 20 mK, and thus sets the stage for experiments with tens to hundreds of superconducting qubits.\n\n## Active load measurements\n### Drive lines\n< g r a p h i c s >\n\nDissipation in drive lines. Dissipated power at the temperature stages of the DR when applying a microwave tone at 5 GHz and a power of 16 dBm, corresponding to a signal level of -52.5 dBm at MXC. Shown are measured data (blue rectangles, solid line) and results of calculations (red triangles, dashed line).\n\nTo experimentally test loads due to signal dissipation we apply a RF signal at one of the drive lines, and measure the corresponding temperature increases on the stages in the dilution refrigerator. In particular, we attempt to evaluate whether the power dissipated in an attenuator predominantly flows to the stage on which the attenuator is thermalized, or whether part of that heat flows to the next lower stage. This is important because the signal levels at stages with attenuators differ by 20 dB in the selected attenuator configuration of C3={0, 20, 0, 20, 20} dB. In other words, the power dissipated in an attenuator at the 4K (CP) stage is by a factor 100 larger than the power dissipated in the attenuator at the CP (MXC) stage. Hence, if only a small fraction of heat dissipated in an attenuator at a given stage flows towards the lower temperature stages, this can significantly increase the heat load on these stages.\n\nWe first apply a power of 10 dBm at a frequency of 10 MHz, at which dissipation in the RF cables themselves is negligible. This allows for a simple comparison with the expected loads of 10 mW on the 4K stage, 100 $\\mu$W on CP, and 1 $\\mu$W on MXC. Using our reference measurements, we extract an active load of $11.5(1.6)\\,$mW on the 4K stage, 95(9) $\\mu$W on CP, 1.1(1) $\\mu$W on MXC, in agreement with the predicted values and showing that there is no significant extra load on these stages due to signal dissipation on higher stages. However, we measured a non-zero active load of 48(6) $\\mu$W on the Still stage, which we attribute to a small fraction of the dissipated power at 4K (about 0.4\n\nWe next apply a signal at 5 GHz with a power of 16 dBm such that the resulting temperature increases on the lower stages are well measurable. To calculate the power level at MXC, we have to take into account the attenuation in the cables [Unknown Author, \"Unknown Title\", ], see Appendix <ref>.\n\nThe total attenuation in the cables sums up to about 8.5 dB, and with the 60 dB of discrete attenuation yields a signal level at MXC of about -52.5 dBm, much larger than the average value of -78 dBm required in a drive line, see Section <ref>. To predict an active load per drive line the extracted pure active loads shown as blue rectangles in Fig. (Figure fig:dissipation-driveline) need to be scaled down accordingly. On the stages with attenuators the data agrees well with the estimated active loads (red triangles). In our calculations we attribute one half of the dissipated power in a cable section itself (excluding the attenuators) to the stage above and the other half to the stage below. On the Still stage the measured load is by a factor two larger than estimated, which is consistent with the above observation made at a signal frequency of 10 MHz.\n\nThe active load per TWPA pump line is found to be comparable to the active load per drive line, with a dominating contribution of 0.23 $\\mu$W on the CP stage. This is a result of a pump power of about -65 dB required at the input of the TWPA and the pump line having 10 dB less attenuation than the drive lines.\n\nSummarizing, we have experimentally verified the predicted active loads for the selected attenuator configuration in the drive lines as presented in Fig. (Figure fig:signal-dissipation) b. Since this configuration has been chosen to keep the active load significantly below the available cooling powers, the active load due to execution of single-qubit gates has a negligible influence on the temperature of the quantum processor. Whether the thermal photon number is as low as predicted needs to be measured [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and would provide information about the effective temperatures at which the attenuators emit blackbody radiation.\n\n### Flux lines\n< g r a p h i c s >\n\n< g r a p h i c s >\n\nDissipation in flux lines. Dissipated power at MXC (left) and CP (right) measured as a function of current in the flux line. Solid lines are quadratic fits to the data.\n\nTo determine the active load arising from flux biasing the qubits, we terminate one of the flux lines at MXC with an electric short, apply a DC current to it, and measure the corresponding temperature increase and heat loads. While the relative temperature increases are negligibly small on the stages from room temperature to the Still, they are significant on CP and MXC. As expected we observe a quadratic increase of the extracted loads $P_{\\rm MXC/CP}=R_{\\rm eff,MXC/CP}I_{\\rm MXC}^2$ as a function of the applied current. The maximum applied current amounted to 8.8 mA at the input of the dilution refrigerator or to 4.6 mA after the 10 dB attenuator at 4K, and thus at MXC (denoted $I_{\\rm MXC}$). From quadratic fits to the data we extract $R_{\\rm eff,MXC}=0.15(1)\\,{\\rm \\Omega} = 0.15(1)\\mu{\\rm W/mA^2}$ and $R_{\\rm eff,CP}=0.42(2)\\,{\\rm \\Omega}$.\n\nThe sum of the two resistances corresponds to the resistance of a coaxial stainless steel cable with a length of 20 cm, which is a bit smaller than the cable length of 29 cm from Still to MXC. How the dissipated power in that cable distributes to the Still, CP, and MXC stages depends on details such as the thermal conductances between the center conductor, which contributes most to the resistance of the coaxial cable, and all of the stages.\n\nFor a reasonable choice of mutual inductance between flux line and qubit discussed in Section <ref>, the DC biasing currents needed to tune the qubits to the desired transition frequencies are considered to be randomly distributed in the interval $[-I_{\\rm max},I_{\\rm max}]=[-1,1]$ mA. Hence, an average power of $P_{\\rm avg}=\\frac{1}{I_{\\rm max}}\\int_0^{I_{\\rm max}} R_{\\rm eff} I_{\\rm MXC}^2\\,{\\rm d}I_{\\rm MXC} = \\frac{1}{3} R_{\\rm eff} I_{\\rm max}^2 \\approx 0.050(3)\\,\\mu$W is dissipated. For 25 flux lines this sums up to 1.25(7) $\\mu$W, which is about a factor of 15 smaller than the cooling power available at MXC at a temperature of 20 mK. We note that this is a worst-case scenario since with careful magnetic shielding it could be possible to reduce the offset fluxes to close to zero.\n\nFor an estimate of dissipation due to flux pulses used for two-qubit gates we use the measured effective DC resistances, the required current amplitude of about 0.2 mA and a duty cycle of 33\n\n## Conclusion and Outlook\n< g r a p h i c s >\n\nTotal heat load budget for the operation of a 50 qubit processor. Predicted passive and active heat loads for the operation of a 50 qubit processor with individual drive and flux control. The heat loads are normalized to the measured cooling powers as presented in Table (Table tab:DR).\n\nBased on our measurements of passive and active loads we predict a total heat load on the dilution refrigerator when operating a 50 qubit processor with individual drive and flux control and with a multiplexed readout architecture allowing for simultaneous readout of sets of 6-7 qubits, see Fig. (Figure fig:totalheatbudget). Such a quantum compressor requires a total of 124 RF lines (50 drive lines, 50 flux lines, 8 output lines, 8 read-in lines, 8 TWPA pump lines), corresponding to the operation of our system at its full capacity. The largest relative loads of about 30\n\nThe material of the coaxial cables has been chosen to minimize passive heat load on all of the stages. However, instead of the standard 0.085 \" diameter coaxial cables, one could use 0.047 \" cables or even thinner. This is beneficial because the passive heat load scales with the square of the diameter, whereas the attenuation in the cable scales approximately linearly. For the proposed case of 0.047 \" SS-SS cables, the passive heat load would be reduced by almost a factor of four. Since large attenuation is desired in the drive lines, the active load due to the execution of single-qubit gates would not be increased if one reduced the attenuation of the installed attenuators accordingly. However, the dominant active load at MXC due to flux biasing of the qubits would be increased four-fold because the DC resistance of the cables scales inversely with their diameter.\n\nWe briefly discuss an optimistic scenario in which magnetic flux offsets are brought close to zero by careful magnetic shielding of the quantum processor. Disregarding thus active load due to  DC flux biasing and considering the use of 0.047 \" diameter cables, the dominant relative load on the CP stage amounts to about 13\n\nUltimately, we propose the following modifications to allow for the operation of about thousand qubits. First, we use superconducting NbTi cables for the flux lines eliminating active load in these lines. Second, we tolerate a CP temperature of about 200 mK at which a cooling power of at least 400 $\\mu$W is available. To maintain the same noise photon number of 0.001 we shift about 7 dB of attenuation from the CP to the MXC stage, increasing the active load on MXC by a factor six. Third, we tolerate a base plate temperature of 30 mK at which the cooling power at MXC is at least doubled to about 40 $\\mu$W, while not affecting the noise photon number. We note that in this optimized scenario active loads in the drive lines are the dominating heat load at CP and MXC.\n\nWe conclude with the remark that future large-scale dilution refrigerators will likely have several dilution units to provide sufficient cooling power at the CP and MXC stages.\n\n*\n\nAPPENDICES\n\n## Attenuation of different types of coaxial cables\nThe attenuation at room temperature of various types of coaxial cables is shown as a function of frequency in Fig. (Figure fig:cableAtt). At low temperature the attenuation is slightly reduced, e.g. the attenuation constant of a UT-85-SS-SS cable at 6 GHz reduces from 9.7 dB/m at room temperature to 8.2 dB/m at 4 K [Unknown Author, \"Unknown Title\", ]. For the calculation of the thermal noise photon number and the active loads presented in Fig. (Figure fig:signal-dissipation) and in Fig. (Figure fig:dissipation-driveline) we have taken such temperature dependences to first order into account.\n\n< g r a p h i c s >\n\nAttenuation in coaxial cables at room temperature. Attenuation in indicated types of coaxial cables as a function of frequency as specified by the manufacturer [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n## Thermal conductivities of relevant materials and cables\nThe thermal conductivities of typical cryogenic cable materials are shown as a function of temperature in Fig. (Figure fig:thermalCond). The data has been used for the estimation of passive heat loads. Data for most of the materials is only available down to $4\\,$K. From 4 K to 0 K we use a linear extrapolation to zero. This is justified for metals at low temperatures, where the electronic contribution to the thermal conductivity dominates [Unknown Author, \"Unknown Title\", ]. Although the thermal conductivities of crystallized thermal insulators such as PTFE, and also of superconductors, is expected to have a $T^3$ dependence at low temperature, we make a linear interpolation to zero as an upper bound for our estimates.\n\n< g r a p h i c s >\n\nThermal conductivities. Thermal conductivity of indicated materials as a function of temperature [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] on a logarithmic scale. The upper plot shows the temperature range from 4K to 300K, the lower plot shows the range from 0.01K to 4K. Data for NbTi in the high temperature regime is taken from [Unknown Author, \"Unknown Title\", ]. The low temperature curve of NbTi (lower plot) is created from three data points [Unknown Author, \"Unknown Title\", ] and a linear extrapolation to zero, see text.\n\n## S-parameters of RF lines\nTypical S-parameter response curves of the installed drive lines and flux lines are shown in Fig. (Figure fig:S_parameters) a. Each line has been measured from the port on the vacuum flange (Port 1) to the port at the MXC flange (Port 2), using a vector network analyzer (VNA). The drive lines typically achieve reflection parameters below -20dB from 0 to 12 GHz, and below -25dB in the range of 4-8 GHz, which is most relevant for the applied microwave pulses. For lines with an Eccosorb filter we choose to position it before the attenuator at MXC such that the line is well impedance matched also at Port 2 even if the Eccosorb filter itself is not perfectly impedance matched.\n\nThe transmission coefficients confirm that the signal loss at DC frequencies is set by the installed attenuators (3x 20dB). For higher frequencies, the transmission coefficients decrease as expected due to the frequency dependent signal loss in the cables and Eccosorb filter.\n\nThe transmission spectrum of the flux line starts at -10 dB, corresponding to the 10 dB attenuator installed at the 4K stage, and sharply drops at $2\\,$GHz due to a low pass filter with a cutoff frequency of 1.3 GHz, see Fig. (Figure fig:S_parameters) b. The continuous drop between 0 and 2 GHz is due to a combination of frequency dependent loss in cable and Eccosorb filter. The reflection S22 from the sample side towards the Eccosorb filter is below -20 dB in the range of 0-500 MHz. Since this range is larger than the typical bandwidth of a flux pulse, possible multiple reflections of flux pulses between the sample and the Eccosorb filter are significantly suppressed.\n\n< g r a p h i c s >\n\nTypical S-parameters of installed RF lines. a) Example of a drive line with a total of 60 dB attenuation and an Eccosorb filter having an attenuation of $\\sim 5\\,$dB at 5 GHz. b) Example of a flux line with 10 dB attenuation, a low pass filter (Minicircuits VLFX1350), and an Eccosorb filter with an attenuation of $\\sim 3\\,$dB at 1 GHz $(\\sim 20\\,$dB at 5 GHz).\n\n## Temperature sensors and heaters\nWe use a PT100 temperature sensor at 50K, Cernox CX-1010 sensors at 4K and Still, and RuO2 RX-102B sensors at CP and MXC (all sensors are from Lake Shore Cryotronics). All except the sensor at CP were pre-installed by the manufacturer. The sensors are read out using the temperature controller model 372 from Lake Shore. We also installed resistive heaters on stages that had no heater installed by the manufacturer, i.e. on the 50K and the CP stage. On the 50K stage we installed a 25 $\\Omega$, 100 W cartridge heater (HTR-50, Lakeshore)  We use resistive cartridge heaters from Lakeshore Cryogenics. On the 50K stage we installed a 25 $\\Omega$, 100 W heater (HTR-25-100), whereas on the CP we installed a  50 $\\Omega$, 50 W heater (HTR-50). For mounting, the cartridge heaters are clamped in a circular hole in a rectangular Cu piece that is then mounted to the corresponding plate in the cryostat.\n\nACKNOWLEDGEMENTS\n\nThe authors thank Y. Salath\u00e9, G. Norris, C. K. Andersen, and S. Gasparinetti for useful discussions, and M. Frey for support during the installation of the dilution refrigerator. This work is supported by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA), via the U.S. Army Research Office grant W911NF-16-1-0071 and by ETH Zurich. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the ODNI, IARPA, or the U.S. Government. The U.S. Government is authorized to reproduce and distribute reprints for Governmental purposes notwithstanding any copyright annotation thereon.\n\nnaturemag\n\n"}
{"prompt": "Please summarize the paper titled 'Long-distance transmon coupler with CZ gate fidelity above 99.8'.", "completion": "\n\nauthor@finish\ncolumn@produce\n[t]\n\nplaintop\ntable\n\n# Long-distance transmon coupler with CZ gate fidelity above 99.8\n\nThese two authors contributed equally to this work\n\nThese two authors contributed equally to this work\navepsalainen@meetiqm.com\n\nIQM Quantum Computers, Espoo 02150, Finland\n\nIQM Quantum Computers, Munich 80636, Germany\n\nIQM Quantum Computers, Espoo 02150, Finland\n\nIQM Quantum Computers, Munich 80636, Germany\n\nIQM Quantum Computers, Espoo 02150, Finland\n\nIQM Quantum Computers, Munich 80636, Germany\n\nIQM Quantum Computers, Espoo 02150, Finland\n\nIQM Quantum Computers, Espoo 02150, Finland\nQCD Labs, QTF Centre of Excellence, Department of Applied Physics, Aalto University, Aalto 00076, Finland\nVTT Technical Research Centre of Finland, QTF Center of Excellence, VTT, VTT 02044, Finland\n\nIQM Quantum Computers, Espoo 02150, Finland\n\nTunable coupling of superconducting qubits has been widely studied due to its importance for isolated gate operations in scalable quantum processor architectures. Here, we demonstrate a tunable qubit-qubit coupler based on a floating transmon device which allows us to place qubits at least 2 apart from each other while maintaining over $\\SI{50}{\\mega\\hertz}$ coupling between the coupler and the qubits. In the introduced tunable-coupler design, both the qubit-qubit and the qubit-coupler couplings are mediated by two waveguides instead of relying on direct capacitive couplings between the components, reducing the impact of the qubit-qubit distance on the couplings. This leaves space for each qubit to have an individual readout resonator and a Purcell filter needed for fast high-fidelity readout. In addition, simulations show that the large qubit-qubit distance significantly lowers unwanted non-nearest-neighbor coupling and allows multiple control lines to cross over the structure with minimal crosstalk. Using the proposed flexible and scalable architecture, we demonstrate a controlled-$Z$ gate with [separate-uncertainty = true]99.81(2) fidelity.\n\n## Introduction\n< g r a p h i c s >\n\n(a) Quasi-lumped-element circuit diagram of qubits (blue and orange) coupled by a tunable coupling structure consisting of waveguide extenders (turquoise) and a floating coupler qubit (red). The gray lines show the effective lumped-element model for the coupling capacitances arising from the black waveguide extenders C and F.\n(b) False-colored micrograph of the qubit-coupler-qubit system. The qubits, coupler, and waveguide extenders follow the color code from (a). The airbridges are colored non-transparently to protect unpublished intellectual property.\n(c) Simulation of the effective coupling strengths between qubit 1 and the coupler, $g_{\\rm 1c}$, qubit 2 and the coupler, $g_{\\rm 2c}$, and qubit 1 and qubit 2, $g_{\\rm 12}$, for different qubit-qubit distances $d_{\\rm qq}$ (solid lines). The measured coupling values (dots with 68 confidence intervals) are shown for our device with $d_{\\rm qq} = \\SI{1960}{\\micro\\meter}$ (dashed line).\n(d) Simulated spurious next-nearest-neighbor coupling $g_{13}$ between $\\rm{Q}_1$ and $\\rm{Q}_3$ in a square lattice configuration (schematic), and the nearest-neighbor coupling $g_{12}$ as a function of the distances $d_{\\rm qq}$ between $\\rm{Q}_1$ and $\\rm{Q}_2$. The gray shaded area indicates the region, where the coupling values fall below the simulation accuracy.\n(e) Schematic of a simplified flip-chip architecture, where the qubits and the coupler are connected via waveguide extenders (light gray) on the bottom chip and a long perpendicular transmission line (black) is crossing above the qubit-coupler structure on the top chip.\n(f) Simulated capacitance coupling ratios (see main text) from each component to the transmission line (color code same as in (e)) at various crossing positions $x_{\\rm cross}$ of the transmission line, total coupling (black dashed line) and region for low-crosstalk crossings (blue shading).\n\nThe implementation of high-fidelity two-qubit gates is a key requirement for scalable quantum processors [Reagor, Matthew, Osborn, Christopher B, Tezak, Nikolas, Staley, Alexa, Prawiroatmodjo, Guenevere, Scheer, Michael, Alidoust, Nasser, Sete, Eyob A, Didier, Nicolas, da Silva, Marcus P, others, \"Demonstration of universal parametric entangling gates on a multi-qubit lattice\", 2018] [Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] [Chen, Zijun, Satzinger, Kevin J, Atalaya, Juan, Korotkov, Alexander N, Dunsworth, Andrew, Sank, Daniel, Quintana, Chris, McEwen, Matt, Barends, Rami, Klimov, Paul V, others, \"Exponential suppression of bit or phase errors with cyclic error correction\", 2021]. The performance of quantum gates relying only on the static qubit-qubit coupling [Majer, Johannes, Chow, JM, Gambetta, JM, Koch, Jens, Johnson, BR, Schreier, JA, Frunzio, L, Schuster, DI, Houck, Andrew Addison, Wallraff, Andreas, others, \"Coupling superconducting qubits via a cavity bus\", 2007] [DiCarlo, Leonardo, Chow, Jerry M, Gambetta, Jay M, Bishop, Lev S, Johnson, Blake R, Schuster, DI, Majer, J, Blais, Alexandre, Frunzio, Luigi, Girvin, SM, others, \"Demonstration of two-qubit algorithms with a superconducting quantum processor\", 2009] [Kandala, Abhinav, Temme, Kristan, C\u00f3rcoles, Antonio D, Mezzacapo, Antonio, Chow, Jerry M, Gambetta, Jay M, \"Error mitigation extends the computational reach of a noisy quantum processor\", 2019] is typically limited by stray $ZZ$ interaction between the qubits resulting in long gate times due to a poor on/off ratio for the coupling. To address this problem, different tunable-coupler designs have been proposed [Hime, Travis, Reichardt, PA, Plourde, BLT, Robertson, TL, Wu, C-E, Ustinov, AV, Clarke, John, \"Solid-state qubits with current-controlled coupling\", 2006] [Niskanen, AO, Harrabi, K, Yoshihara, F, Nakamura, Y, Lloyd, S, Tsai, Jaw Shen, \"Quantum coherent tunable coupling of superconducting qubits\", 2007] [Chen, Yu, Neill, C, Roushan, Pedram, Leung, Nelson, Fang, Michael, Barends, Rami, Kelly, Julian, Campbell, Brooks, Chen, Z, Chiaro, Benjamin, others, \"Qubit architecture with high coherence and fast tunable coupling\", 2014] [Geller, Michael R, Donate, Emmanuel, Chen, Yu, Fang, Michael T, Leung, Nelson, Neill, Charles, Roushan, Pedram, Martinis, John M, \"Tunable coupler for superconducting Xmon qubits: Perturbative nonlinear model\", 2015] [Chen, Qi-Ming, Kronowetter, Fabian, Fesquet, Florian, Honasoge, Kedar E., Nojiri, Yuki, Renger, Michael, Fedorov, Kirill G., Marx, Achim, Deppe, Frank, Gross, Rudolf, \"Tuning and amplifying the interactions in superconducting quantum circuits with subradiant qubits\", 2022] with increasing sophistication.\n\nAn important step toward tunable couplers with a high on/off ratio and with minimal impact on qubit coherence was the observation that one can design a coupler-mediated tunable interaction that cancels out the static qubit-qubit coupling at a specific coupler off-frequency which is above the qubit frequencies\u00a0[Yan, Fei, Krantz, Philip, Sung, Youngkyu, Kjaergaard, Morten, Campbell, Daniel L, Orlando, Terry P, Gustavsson, Simon, Oliver, William D, \"Tunable coupling scheme for implementing high-fidelity two-qubit gates\", 2018]. Since then, such couplers have been successfully used in several experiments [Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] [Li, X, Cai, T, Yan, H, Wang, Z, Pan, X, Ma, Y, Cai, W, Han, J, Hua, Z, Han, X, others, \"Tunable coupler for realizing a controlled-phase gate with dynamically decoupled regime in a superconducting circuit\", 2020] [Xu, Yuan, Chu, Ji, Yuan, Jiahao, Qiu, Jiawei, Zhou, Yuxuan, Zhang, Libo, Tan, Xinsheng, Yu, Yang, Liu, Song, Li, Jian, others, \"High-fidelity, high-scalability two-qubit gate scheme for superconducting qubits\", 2020] [Collodo, Michele C., Herrmann, Johannes, Lacroix, Nathan, Andersen, Christian Kraglund, Remm, Ants, Lazar, Stefania, Besse, Jean-Claude, Walter, Theo, Wallraff, Andreas, Eichler, Christopher, \"Implementation of Conditional Phase Gates Based on Tunable ZZ Interactions\", 2020] [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021] [Yangsen Ye, Sirui Cao, Yulin Wu, Xiawei Chen, Qingling Zhu, Shaowei Li, Fusheng Chen, Ming Gong, Chen Zha, He-Liang Huang, Youwei Zhao, Shiyu Wang, Shaojun Guo, Haoran Qian, Futian Liang, Jin Lin, Yu Xu, Cheng Guo, Lihua Sun, Na Li, Hui Deng, Xiaobo Zhu, Jian-Wei Pan, \"Realization of High-Fidelity Controlled-Phase Gates in Extensible Superconducting Qubits Design with a Tunable Coupler\", 2021]. In Ref.\u00a0[Sete, Eyob A, Chen, Angela Q, Manenti, Riccardo, Kulshreshtha, Shobhan, Poletto, Stefano, \"Floating tunable coupler for scalable quantum computing architectures\", 2021], a floating transmon coupler that can also be operated below the qubit frequencies was proposed, allowing two-qubit-gate operations near the flux insensitive coupler sweet spot and thereby reducing the impact of coupler flux noise during the gate. Moreover, the concept was used in Ref.\u00a0[Stehlik, J, Zajac, D M, Underwood, D L, Phung, T, Blair, J, Carnevale, S, Klaus, D, Keefe, G A, Carniol, A, Kumph, M, others, \"Tunable Coupling Architecture for Fixed-Frequency Transmon Superconducting Qubits\", 2021] for implementing high-fidelity CZ gates for fixed-frequency floating transmons.\n\nAlthough the $ZZ$-interaction-free tunable-coupler designs have seen significant success in enabling high-fidelity two-qubit gates, the static qubit-qubit coupling needed for canceling the coupler-mediated interaction arises from the direct coupling between the qubits, controlled mainly by the qubit-qubit distance. Having no residual $ZZ$ coupling in such architectures therefore requires small qubit-qubit distances. This restriction introduces severe limitations for the qubit locations, leading to high spurious non-nearest-neighbor coupling, and furthermore, limits the space in a square qubit lattice, allowing only the most essential components to be placed in between the lattice sites.\n\nHere, we introduce and experimentally demonstrate an extended floating coupler that allows us to increase the physical distances between qubits, thus providing the space on the chip for readout resonators with individual Purcell filters for high-fidelity readout [Heinsoo, Johannes, Andersen, Christian Kraglund, Remm, Ants, Krinner, Sebastian, Walter, Theodore, Salath\u00e9, Yves, Gasparinetti, Simone, Besse, Jean-Claude, Poto\u010dnik, Anton, Wallraff, Andreas, Eichler, Christopher, \"Rapid High-fidelity Multiplexed Readout of Superconducting Qubits\", 2018] [Sete, E. A., Martinis, J. M., Korotkov, A. N., \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015]. Furthermore, long qubit-qubit distances significantly lower the parasitic non-nearest-neighbor coupling and enable low-crosstalk paths for multiple control lines above the qubit-coupler-qubit structure if flip-chip technology is utilized. Similar to Refs.\u00a0[Sete, Eyob A, Chen, Angela Q, Manenti, Riccardo, Kulshreshtha, Shobhan, Poletto, Stefano, \"Floating tunable coupler for scalable quantum computing architectures\", 2021] [Stehlik, J, Zajac, D M, Underwood, D L, Phung, T, Blair, J, Carnevale, S, Klaus, D, Keefe, G A, Carniol, A, Kumph, M, others, \"Tunable Coupling Architecture for Fixed-Frequency Transmon Superconducting Qubits\", 2021], the tunable coupler is operated below the qubit frequencies, allowing two-qubit-gate operations closer to its flux insensitive sweet spot, and furthermore, preventing the coupler to cross any qubit readout-resonator modes. The ability to have long qubit-qubit distances is achieved using two waveguide extenders that mediate the direct qubit-qubit coupling, as well as the couplings between the qubits and the coupler. These couplings predominantly originate from interdigital capacitors between the two waveguide extenders and the coupler, making it possible to maintain couplings with similar magnitude as previous designs [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021] [Li, X, Cai, T, Yan, H, Wang, Z, Pan, X, Ma, Y, Cai, W, Han, J, Hua, Z, Han, X, others, \"Tunable coupler for realizing a controlled-phase gate with dynamically decoupled regime in a superconducting circuit\", 2020] across a broad range of qubit-qubit distances. To demonstrate that the couplings between the qubits and the coupler are high enough for qubit-qubit distances beyond 1, we implement a fast and high-fidelity controlled-$Z$ (CZ) gate with a duration of 33 and [separate-uncertainty = true]99.81(2) fidelity for a qubit-qubit distance of 1.96, which is four times longer than in typical tunable coupler designs\u00a0[Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021] [Collodo, Michele C., Herrmann, Johannes, Lacroix, Nathan, Andersen, Christian Kraglund, Remm, Ants, Lazar, Stefania, Besse, Jean-Claude, Walter, Theo, Wallraff, Andreas, Eichler, Christopher, \"Implementation of Conditional Phase Gates Based on Tunable ZZ Interactions\", 2020]. Our coupler design is readily extendable to a square qubit lattice, making it an appealing building block for a scalable high-fidelity quantum processor.\n\n## Extended floating transmon coupler design\nWe propose a coupler design in which two grounded transmon qubits interact through a floating transmon coupler. As shown in Fig.\u00a0(Figure fig:fig_1)(a), the qubits are connected to the coupler with two waveguide extenders that mediate effective capacitances $C_{\\rm 1c}$, $C_{\\rm 2c}$, and $C_{12}$ between the qubits and the coupler. The two waveguide extenders shown in Fig.\u00a0(Figure fig:fig_1)(b) are implemented as 0.9-long coplanar waveguides whose resonance frequencies are an order of magnitude higher than the qubits and coupler frequencies, such that the waveguide extender modes do not couple to the qubit and coupler modes.\nAt one end, the waveguide extenders are coupled to each other and to the coupler via interdigital capacitors, and at the other end to the qubits via gap capacitors. These gap capacitors are designed to accommodate four waveguide extenders which are coupled to a single qubit to form a square lattice. All the capacitance values between the extenders, the qubits, and the coupler can be independently adjusted to realize the desired effective capacitances, see Appendix\u00a0<ref> for the detailed model.\nWithin the effective capacitance model, the dynamics of the system can be described using the coupling strengths between qubit 1 ($\\rm{Q}_1$) and the coupler, $g_{\\rm 1c}$, qubit 2 ($\\rm{Q}_2$) and the coupler, $g_{\\rm 2c}$, and the qubit-qubit coupling $g_{\\rm 12}$.\n\nIn contrast to direct capacitive couplings between the qubits and the coupler studied in Ref.\u00a0[Sete, Eyob A, Chen, Angela Q, Manenti, Riccardo, Kulshreshtha, Shobhan, Poletto, Stefano, \"Floating tunable coupler for scalable quantum computing architectures\", 2021], the waveguide extenders facilitate flexible positioning of the individual components by simply elongating the waveguide extenders. To investigate the impact of qubit-qubit distance in our system, we calculate the effective coupling strengths for waveguide extenders of varying lengths using simulated capacitance values between all the superconducting islands, A\u2013H in Fig.\u00a0(Figure fig:fig_1)(a). As shown in Fig.\u00a0(Figure fig:fig_1)(c), changing the distance $d_{\\rm qq}$ between the qubits by up to 1000 impacts the coupling strengths between the qubits and the coupler by less than 50, implying that the couplings are still large enough for fast two-qubit gates over a wide range of qubit-qubit distances. In the simulation, we use scikit-rf [Arsenovic, Alexander, Hillairet, Julien, Anderson, Jackson, Forst\u00e9n, Henrik, Rie\u00df, Vincent, Eller, Michael, Sauber, Noah, Weikle, Robert, Barnhart, William, Forstmayr, Franz, \"scikit-rf: An Open Source Python Package for Microwave Network Creation, Analysis, and Calibration [Speaker\u2019s Corner]\", 2022] to model the qubits and the coupler as lumped-element circuits, and apply the transmission line model for the waveguide extenders, see Appendix\u00a0<ref> for details on the simulation. The slight decrease in coupling strengths with increasing $d_{\\rm qq}$ can be attributed to the increasing extender capacitance to ground which starts to contribute to the total capacitance of the system, ultimately limiting $d_{\\rm qq}$.\n\nEven though the test device studied in this work has only two qubits connected using the coupler, the layout is designed such that identical couplings can be simultaneously reached for up to four neighboring qubits, compatible with scaling to large qubit lattices. In such a lattice, the resulting freedom of qubit spacing allows the spurious couplings to non-nearest-neighbor qubits to be reduced while maintaining strong nearest-neighbor (NN) coupling, which is essential for a $ZZ$-interaction-free idling configuration of a multi-qubit system. The dominating non-nearest-neighbor couplings in a square qubit lattice architecture are the diagonal next-nearest-neighbor (NNN) qubit pairs. As shown in Fig.\u00a0(Figure fig:fig_1)(d), the simulated spurious NNN coupling $g_{13}$ between two diagonally placed qubits with the typical qubit-qubit distance of $d_{\\rm qq}= \\SI{500}{\\micro\\meter}$ has the same order of magnitude as the typical NN coupling $g_{12}$ [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021] [Li, X, Cai, T, Yan, H, Wang, Z, Pan, X, Ma, Y, Cai, W, Han, J, Hua, Z, Han, X, others, \"Tunable coupler for realizing a controlled-phase gate with dynamically decoupled regime in a superconducting circuit\", 2020], potentially leading to large residual $ZZ$-couplings during idling time. As $g_{13}$ decreases with increasing $d_{\\rm qq}$, the NNN coupling at our qubit-qubit distance of $\\SI{1960}{\\micro\\meter}$ is less than $g_{13}<\\SI{30}{\\kilo\\hertz}$, which is at least two orders of magnitude smaller than $g_{12}$. The upper bound of the estimate is limited by the accuracy of the simulation. The NNN coupling $g_{13}$ was extracted from an Ansys HFSS finite-element-method (FEM) simulation of the direct capacitance between qubits ${\\rm Q_1}$ and ${\\rm Q_3}$, and did not include other qubits or couplers. However, we verified that the inclusion of $\\rm{Q}_2$ and the couplers connecting $\\rm{Q}_1$, $\\rm{Q}_2$, and $\\rm{Q}_3$ in the simulation did not show a significant difference. From these capacitances, we calculate $g_{13}$ by modeling the two qubits as coupled harmonic oscillators with a frequency of $\\SI{4.3}{\\giga\\hertz}$ [Yan, Fei, Krantz, Philip, Sung, Youngkyu, Kjaergaard, Morten, Campbell, Daniel L, Orlando, Terry P, Gustavsson, Simon, Oliver, William D, \"Tunable coupling scheme for implementing high-fidelity two-qubit gates\", 2018]. For the simulation of the mediated qubit-qubit coupling $g_{12}$ the coupler was included, limiting the smallest simulation range of the qubit-qubit distance to $d_{\\rm qq}=\\SI{920}{\\micro\\meter}$ corresponding to the width of the coupler.\n\nIn addition to suppressing the NNN coupling, the large qubit-qubit distance gives us physical space for readout structures with individual Purcell filters for each qubit [Sete, E. A., Martinis, J. M., Korotkov, A. N., \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015] [Heinsoo, Johannes, Andersen, Christian Kraglund, Remm, Ants, Krinner, Sebastian, Walter, Theodore, Salath\u00e9, Yves, Gasparinetti, Simone, Besse, Jean-Claude, Poto\u010dnik, Anton, Wallraff, Andreas, Eichler, Christopher, \"Rapid High-fidelity Multiplexed Readout of Superconducting Qubits\", 2018], enabling fast and high-fidelity readout [Walter, T., Kurpiers, P., Gasparinetti, S., Magnard, P., Poto\u010dnik, A., Salath\u00e9, Y., Pechal, M., Mondal, M., Oppliger, M., Eichler, C., Wallraff, A., \"Rapid, High-Fidelity, Single-Shot Dispersive Readout of Superconducting Qubits\", 2017]. Implementing e.g.\u00a06 readout resonators and Purcell filters as spiral $\\lambda / 4$ coplanar resonators requires together at least 1^2 of space, which easily fits in a square qubit lattice with our qubit-qubit distances of $d_{\\rm qq} = \\SI{1960}{\\micro\\meter}$.\n\n< g r a p h i c s >\n\n(a) The effective $ZZ$ interaction strength $\\zeta$ between the qubits is shown as a function of the coupler frequency $\\omega_{\\rm c}/(2\\pi)$ and the frequency detuning between the two qubits, $\\Delta/(2\\pi)$. If $\\alpha_2 < \\Delta < -\\alpha_1$, there exists a contour (black dotted line) along which the $ZZ$ interaction vanishes.\nThe qubit frequencies are shown with orange dashed lines and the detuning values corresponding to their anharmonicities are marked with white dashed lines. The solid black line indicates the lowest coupler frequency at which a conditional phase of $\\phi_{11} = \\pi$ can be accumulated in 25.\nThe solid red line illustrates the path along which the coupler is operated in the experiments.\n(b) Experimentally measured interaction strength (dots) as a function of the coupler frequency $\\omega_{\\rm c} / (2\\pi)$ in units of flux quanta $\\Phi_0$ for the specific qubit-qubit detuning chosen to implement the CZ gate. The numerical model (purple line) is fitted to the data to extract the coupling strengths between the two qubits and between each qubit and the coupler.\n(c) Experimentally measured eigenfrequencies (white to blue spectrum) and fitted eigenfrequencies (lines) of the qubits and the coupler as a function of the external flux $\\Phi_{\\rm ext}^{\\rm c}$ threading through the coupler SQUID loop. The coupler spectrum below 3.7 is measured using ${\\rm Q_2}$ as an ancilla, see Appendix\u00a0<ref>. The red circles show the idling and the operation configuration of the coupler.\n\nAn additional benefit of the waveguide extenders is that the electric field density of the qubit and the coupler modes is reduced above the extenders. This allows microwave control lines to cross the qubit-coupler structure with low crosstalk. To support this claim, we conduct a FEM simulation to extract the capacitance between the components on the chip and a transmission line ($\\rm TL$) that crosses the structure 8 above the qubits (Fig.\u00a0(Figure fig:fig_1)(e)), corresponding to a typical flip-chip topology [Sandoko Kosen, Hang-Xi Li, Marcus Rommel, Daryoush Shiri, Christopher Warren, Leif Gr\u00f6nberg, Jaakko Salonen, Tahereh Abad, Janka Bizn\u00e1rov\u00e1, Marco Caputo, Liangyu Chen, Kestutis Grigoras, G\u00f6ran Johansson, Anton Frisk Kockum, Christian Kri\u017ean, Daniel P\u00e9rez Lozano, Graham J Norris, Amr Osman, Jorge Fern\u00e1ndez-Pend\u00e1s, Alberto Ronzani, Anita Fadavi Roudsari, Slawomir Simbierowicz, Giovanna Tancredi, Andreas Wallraff, Christopher Eichler, Joonas Govenius, Jonas Bylander, \"Building blocks of a flip-chip integrated superconducting quantum processor\", 2022], see Appendix\u00a0<ref> for further details on the simulation. To put the capacitance values into context, we calculate the drive crosstalk from the capacitance ratio $r_k = C_{{\\rm k} \\leftrightarrow \\rm{TL}}/C_{\\rm Q \\leftrightarrow \\rm{DL}}$, where $C_{{\\rm k} \\leftrightarrow \\rm{TL}}$ is the capacitance between the center conductor of the transmission line and component $k = \\{{\\rm Q_1}, {\\rm Q_2}, {\\rm c}\\}$, and $C_{\\rm Q  \\leftrightarrow \\rm{DL}}=\\SI{0.12}{\\femto\\farad}$ is the capacitance between each qubit and its corresponding drive line, see Fig.\u00a0(Figure fig:fig_1)(f). For this geometry, crossing the tunable coupling structure above the waveguide extenders reduces the parasitic coupling by a factor of 10 compared to passing over the tunable coupler. Above the extenders, the crosstalk is $r_{\\rm Q_i} < \\num{0.1} = \\SI{-20}{\\dB}$, which is comparable to the typical crosstalk between two microwave control lines and can be further reduced by increasing the chip-to-chip distance. This level of crosstalk enables the implementation of qubit lattices with crossing lines without resorting to more sophisticated technologies such as through silicon vias, significantly reducing the complexity of the scalable architecture.\n\n## CZ gate implementation\nIn our design, the effective static $ZZ$ interaction strength $\\zeta = \\omega_{11} - \\omega_{10} - \\omega_{01} + \\omega_{00}$ between the qubits can be eliminated if the detuning between the two qubits is smaller than their anharmonicity [Sete, Eyob A, Chen, Angela Q, Manenti, Riccardo, Kulshreshtha, Shobhan, Poletto, Stefano, \"Floating tunable coupler for scalable quantum computing architectures\", 2021], $\\Delta = \\omega_1 - \\omega_2 \\in [\\alpha_2, -\\alpha_1]$, where $\\alpha_i$ and $\\omega_i$ are the anharmonicity and the angular frequency of qubit $i$ in the laboratory frame, and $\\omega_{ij}/ (2\\pi)$ is the eigenfrequency for the computational state in which $\\rm{Q}_1$ is in state $i$ and $\\rm{Q}_2$ is in state $j$. If this condition is met, a contour with $\\zeta = 0$ for coupler frequencies below the qubit frequencies can be identified, as depicted by the simulation shown in Fig.\u00a0(Figure fig:fig_2)(a). In the simulation, we numerically solve for the $ZZ$ interaction strength in the dressed-state basis comprising the three lowest-energy states of the coupler and the qubits, see Appendix\u00a0<ref> for details.\n\nThe $ZZ$ interaction can be turned on by tuning the coupler frequency away from the $\\zeta=0$ contour. The highest coupling and therefore the fastest gate can be reached when the coupler frequency is close to the qubit frequencies, as shown in the 25-gate-time curve in Fig.\u00a0(Figure fig:fig_2)(a). The most relevant region for a fast and high-fidelity CZ gate is close to $\\Delta = -\\alpha_1$, where the qubit states evolve through a near-resonant $\\ket{11} \\leftrightarrow \\ket{20}$ transition if the coupling is turned on, implementing the diabatic version of the CZ gate. In the experiment, we set the qubit frequencies at $\\omega_1 = \\omega_2 - a \\alpha_1$, where $\\omega_1/(2\\pi) = \\SI{4.10}{\\giga\\hertz}$, $\\omega_2/(2\\pi) = \\SI{3.89}{\\giga\\hertz}$, $\\alpha_1/(2\\pi) = \\SI{-216}{\\mega\\hertz}$ and $a = 0.97$, see Appendix\u00a0<ref> for the full experimental setup and Appendix\u00a0<ref> for details on sample fabrication. Even though the fastest gate times can be reached when the $\\ket{11}$ and $\\ket{20}$ transitions are resonant, i.e. $a = 1$, we deliberately operate the qubits slightly away from the resonance to mitigate the effect of drive crosstalk during single-qubit gates. The drive crosstalk could also be reduced by idling the qubits in a configuration where the states $\\ket{11}$ and $\\ket{20}$ are initially far-detuned and tuning the qubits to their operation point only during the CZ gate [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021]. However, in order to reduce the number of required microwave control lines in the system, we choose not to use fast flux control for the qubits.\n\n< g r a p h i c s >\n\nInterleaved randomized benchmarking experiment for two qubits. (a) Experimental data of the sequence fidelity for randomized benchmarking with interleaved CZ gates (purple dots) and the reference Clifford sequence (blue dots) as a function of the number of Clifford gates. The purple and blue shaded regions indicate the standard deviation of 30 random sequences for the interleaved randomized benchmarking experiment and the reference Clifford sequence, respectively. The histograms in the inset show the error per Clifford gate (blue) and the error per CZ gate (purple) for the 14 repeated experiments, from which the average error per Clifford gate of $\\epsilon^{\\rm{avg}}_{\\rm{Clifford}} = \\num[separate-uncertainty]{1.39(3)e-2}$ and the average error per CZ gate of $\\epsilon^{\\rm{avg}}_{\\rm{CZ}} = \\num[separate-uncertainty]{1.9(2)e-3}$ were estimated.\n(b) Experimentally obtained error per CZ gate as a function of the number of interleaved CZ gates $n$ in the randomized benchmarking sequence. The error bars indicate the standard deviation extracted from the residuals of the best model fit of the sequence decay for $n$ interleaved CZ gates. The gate sequence is depicted in the inset: A random Clifford gate $\\rm C$ followed by $n$ CZ gates, repeated $m$ times, after which a reversing Clifford gate $\\rm C_r$ is applied. Extracting the fitting error for the sequence fidelity for $n$ interleaved CZ gates yields a reduction in the uncertainty of the error per CZ gate by a factor of $1/n$.\n\nWe experimentally determine the coupler idling frequency by measuring the conditional phase of $\\rm{Q}_1$ when $\\rm{Q}_2$ is initialized either in the ground or in the excited state, and find $\\lvert \\zeta \\rvert <\\SI{2}{\\kilo\\hertz}$ at $\\omega_{\\rm c}/(2\\pi) = \\SI{3.195}{\\giga\\hertz}$, see Fig. (Figure fig:fig_2)(b). The fit to the measured  $ZZ$ interaction strength as a function of the coupler frequency gives an estimate of $g_{\\rm 1c}/(2\\pi) = \\SI[separate-uncertainty]{51.5(7)}{\\mega\\hertz}$, $g_{\\rm 2c}/(2\\pi) = \\SI[separate-uncertainty]{53.9(6)}{\\mega\\hertz}$, and $g_{\\rm 12}/(2\\pi) = \\SI[separate-uncertainty]{3.7(5)}{\\mega\\hertz}$ where the couplings are defined at the idling configuration. The fitted coupling strengths deviate less than $\\SI{15}{\\percent}$ from the design and provide the strong $ZZ$ interaction strength needed to implement a CZ gate in less than 25 interaction time. In this configuration, we measure simultaneous single-qubit gate errors $\\epsilon_{\\rm Q1}^{\\rm sim} = \\num[separate-uncertainty]{1.32(5)e-3}$ and $\\epsilon_{\\rm Q2}^{\\rm sim} = \\num[separate-uncertainty]{8.9(5)e-4}$, which are only slightly higher than individual single-qubit gate errors, $\\epsilon_{\\rm Q1} = \\num[separate-uncertainty]{7.8(3)e-4}$ and $\\epsilon_{\\rm Q2} = \\num[separate-uncertainty]{6.8(4)e-4}$, respectively.\n\nTo realize the diabatic version of the CZ gate [Barends, Rami, Quintana, C M, Petukhov, A G, Chen, Yu, Kafri, Dvir, Kechedzhi, Kostyantyn, Collins, Roberto, Naaman, Ofer, Boixo, Sergio, Arute, F, others, \"Diabatic gates for frequency-tunable superconducting qubits\", 2019], we turn on the effective exchange interaction between the states $\\ket{20}$ and $\\ket{11}$ of the qubits by applying a 22-long flux pulse to the coupler, shifting its frequency from the idling point to the operation point, see Fig.\u00a0(Figure fig:fig_2)(c). We use a Slepian-shaped flux pulse to minimize the dominating leakage processes during the gate from $\\rm{Q}_2$ to the coupler [Martinis, John M, Geller, Michael R, \"Fast adiabatic qubit gates using only \u03c3 z control\", 2014] [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of High-Fidelity CZ and Z Z-Free iSWAP Gates with a Tunable Coupler\", 2021]. In addition, to account for the distortions in the flux pulse shape, we use two consecutive infinite-impulse-response filter to correct for their shape in real-time [Rol, Michiel A, Ciorciaro, Livio, Malinowski, Filip K, Tarasinski, Brian M, Sagastizabal, Ramiro E, Bultink, Cornelis Christiaan, Salathe, Yves, Haandb\u00e6k, Niels, Sedivy, Jan, DiCarlo, Leonardo, \"Time-domain characterization and correction of on-chip distortion of control pulses in a quantum processor\", 2020]. To mitigate the impact of the flux distortion at the nanosecond time scale, we add a 5.5 idle time before and after the flux pulse, resulting in a total flux pulse duration of 33.\n\n< g r a p h i c s >\n\nThe impact of the coupler decoherence on the qubits.\n(a) Energy relaxation times of the hybridized qubit-coupler modes measured directly (dots), measured via an ancilla qubit (diamonds), and evaluated numerically based on the hybridization with the coupler (solid lines) as a function of the coupler frequency $\\omega_{\\rm c}/(2\\pi)$. The shaded areas indicate the coupler frequencies swept during the CZ gate (gray) and regions with unknown sources of decoherence, partly attributed to parasitic two-level systems (orange and blue shading for $\\rm{Q}_1$ and $\\rm{Q}_2$, respectively).\n(b) Measured frequencies of hybridized modes during coherence measurements (dense set of dots) and frequencies of the uncoupled system (black dashed lines).\n(c) as in (a) but shows the Gaussian component of the pure dephasing time for the hybridized qubit and coupler modes.\n(d) Coherence limit of the CZ gate (solid black line) as a function of the interaction time $\\tau$ calculated using Eq.\u00a0(<ref>) with contributions from individual coherence times (dashed lines), and the coherence limit for no decoherence contributions from the coupler (green stars). When evaluating the gate error, an idling time of 11 is added on top of the interaction time. The black dot shows the experimental gate error with the 68 confidence interval. The data for $T_{\\phi, 1, {\\rm eff}}^{\\rm Q_2}$ is below the curve corresponding to $T_{1, {\\rm eff}}^{\\rm Q_2}$ and not well visible in the plot.\n\nWe optimize the CZ gate by adjusting the amplitude and duration of the coupler flux pulse to find an operation point that minimizes the occupation in the state $\\ket{20}$ while accumulating a conditional phase shift $\\phi_{11} = \\pi$ in state $\\ket{11}$. We account for the additional single-qubit phase accumulation caused by the dispersive interaction between the coupler and the qubits during the gate by applying virtual $Z$ gates [McKay, David C., Wood, Christopher J., Sheldon, Sarah, Chow, Jerry M., Gambetta, Jay M., \"Efficient Z gates for quantum computing\", 2017] to both qubits after each CZ gate.\n\n## CZ gate characterization\nTo characterize the average gate fidelity, we employ randomized benchmarking where a sequence of random two-qubit Clifford gates is interleaved with CZ gates [Magesan, Easwar, Gambetta, Jay M., Johnson, B. R., Ryan, Colm A., Chow, Jerry M., Merkel, Seth T., da Silva, Marcus P., Keefe, George A., Rothwell, Mary B., Ohki, Thomas A., Ketchen, Mark B., Steffen, M., \"Efficient Measurement of Quantum Gate Error by Interleaved Randomized Benchmarking\", 2012] [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014]. The experiment was repeated 14 times over a period of 15, shown in Fig.\u00a0(Figure fig:fig_3)(a). We extract an average error per CZ gate of $\\epsilon^{\\rm avg}_{\\rm CZ} = \\num[separate-uncertainty]{1.9(2)e-3}$ from the collected data, where the uncertainty indicates the 68 confidence interval. For consistency, the average error per Clifford $\\epsilon_{\\rm Clifford} = \\num[separate-uncertainty]{1.39(3)e-2}$ can be compared to the errors of its constituent CZ and single-qubit gates. On average, each  two-qubit Clifford gate consists of 1.5 CZ gates and 8.25 single-qubit gates [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014], which by simple summation of errors results in the estimate for the Clifford error $\\epsilon_{\\rm Clifford}^{\\rm estimate} = \\num[separate-uncertainty]{1.1(4)e-2}$, in agreement with the measured value.\n\nWe can improve the estimate for the CZ gate error by interleaving multiple CZ gates in the randomized benchmarking sequence and calculating the average error per gate for different numbers $n$ of interleaved gates [Sheldon, Sarah, Bishop, Lev S, Magesan, Easwar, Filipp, Stefan, Chow, Jerry M, Gambetta, Jay M, \"Characterizing errors on qubit operations via iterative randomized benchmarking\", 2016]. As shown in Fig.\u00a0(Figure fig:fig_3)(b), the error per CZ gate converges from $\\epsilon_{\\rm CZ}^{(1)} = \\num[separate-uncertainty]{2.0(5)e-3}$ for one interleaved CZ gate towards $\\epsilon_{\\rm CZ}^{(20)} = \\num[separate-uncertainty]{2.35(7)e-3}$ for 20 interleaved CZ gates, demonstrating a seven-fold reduction in the uncertainty and a minor increase for the error per CZ gate, see Appendix\u00a0<ref> for further details. In contrast to conventional randomized benchmarking, where coherent errors are suppressed due to randomization of the basis between each application of the CZ gate, interleaving the sequence with several CZ gates reveals coherent errors as well since they tend to add up for the $n$ interleaved CZ gates. The minor increase in the error rate when interleaving multiple CZ gates suggests that the CZ gate fidelity is mostly limited by decoherence at its chosen operation point, rather than by coherent errors. The low error rate per CZ gate in the iterated randomized benchmarking experiment is important for real-world applications due to the accumulation of coherent errors being particularly detrimental to many quantum algorithms [Kjaergaard, M., Schwartz, M. E., Greene, A., Samach, G. O., Bengtsson, A., O'Keeffe, M., McNally, C. M., Braum\u00fcller, J., Kim, D. K., Krantz, P., Marvian, M., Melville, A., Niedzielski, B. M., Sung, Y., Winik, R., Yoder, J., Rosenberg, D., Obenland, K., Lloyd, S., Orlando, T. P., Marvian, I., Gustavsson, S., Oliver, W. D., \"Demonstration of Density Matrix Exponentiation Using a Superconducting Quantum Processor\", 2022].\n\nDuring the CZ gate, the coupler and the qubits become strongly hybridized which affects the coherence of the computational states. To quantify the impact of decoherence during the CZ gate, we first measure the energy relaxation times of all the three hybridized qubit and coupler modes as a function of the uncoupled coupler frequency, shown in Fig.\u00a0(Figure fig:fig_4)(a).\nEven though there are no individual drive and readout lines for the coupler, we can  measure the energy-relaxation time of the coupler-like mode using the qubit readout and drive lines when the coupler and qubit states are hybridized. For the coupler frequencies below 3.9 the degree of hybridization is low and we employ two-probe readout with $\\rm{Q}_2$ as an ancilla qubit instead, see Appendix\u00a0<ref> for details on the experiment. The measured frequencies of the hybridized modes are shown in Fig. (Figure fig:fig_4)(b). In the frequency range relevant for the CZ gate (gray shaded area), we observe that the energy-relaxation times of the qubit-like modes are not significantly affected by the hybridization with the coupler due to its high intrinsic energy-relaxation time, $T_1^{\\rm c} > \\SI{40}{\\micro\\second}$ at the idling configuration.\n\nTo model the dependency of the energy relaxation times of the hybridized states on the coupler frequency, we assume that the energy relaxation times of the uncoupled modes stay constant as a function of the coupler frequency. We then numerically evaluate the energy relaxation time of the coupled modes based solely on the degree of hybridization with the coupler, shown with solid lines in Fig\u00a0(Figure fig:fig_4)(a). In the frequency range relevant for the CZ gate and at coupler frequencies above 4.1, we find a good match between the measurements and the model. For coupler frequencies between 3.9 and 4.1, we observe unexpected dips in the relaxation times, which can potentially be attributed to parasitic two-level systems (TLSs) near ${\\rm Q_1}$ and ${\\rm Q_2}$ [Klimov, P. V., Kelly, J., Chen, Z., Neeley, M., Megrant, A., Burkett, B., Barends, R., Arya, K., Chiaro, B., Chen, Yu, Dunsworth, A., Fowler, A., Foxen, B., Gidney, C., Giustina, M., Graff, R., Huang, T., Jeffrey, E., Lucero, Erik, Mutus, J. Y., Naaman, O., Neill, C., Quintana, C., Roushan, P., Sank, Daniel, Vainsencher, A., Wenner, J., White, T. C., Boixo, S., Babbush, R., Smelyanskiy, V. N., Neven, H., Martinis, John M., \"Fluctuations of Energy-Relaxation Times in Superconducting Qubits\", 2018] [Clemens M\u00fcller, Jared H Cole, J\u00fcrgen Lisenfeld, \"Towards understanding two-level-systems in amorphous solids: insights from quantum circuits\", 2019] [Krinner, Sebastian, Lacroix, Nathan, Remm, Ants, Di Paolo, Agustin, Genois, Elie, Leroux, Catherine, Hellings, Christoph, Lazar, Stefania, Swiadek, Francois, Herrmann, Johannes, Norris, Graham J., Andersen, Christian Kraglund, M\u00fcller, Markus, Blais, Alexandre, Eichler, Christopher, Wallraff, Andreas, \"Realizing repeated quantum error correction in a distance-three surface code\", 2022]. However, these TLSs do not have a significant impact on the performance of the gate as long as the coupler remains below 3.9.\n\nNext, we measure the dephasing times of the three hybridized modes as a function of the coupler frequency, see Fig.\u00a0(Figure fig:fig_4)(c). At each of the frequencies, we perform a Ramsey experiment and extract the dephasing times from a fit to the model\n$$\n\n\\label{eq:decay_envelope}\n\\nu(t) = a(t)\\mathrm{e}^{-\\frac{t}{2 T_1} -\\frac{t}{T_{\\phi, 1}} -\\left(\\frac{t}{T_{\\phi, 2}}\\right)^2},\n\n$$\nwhere $a(t)$ is the response of the Ramsey experiment excluding decoherence, $T_1$ is the energy-relaxation time measured earlier, and $T_{\\phi, 1}$ and $T_{\\phi, 2}$ are the exponential and Gaussian components of the dephasing time. The exponential dephasing time originates from excess wide-band noise such as thermal excitations in the readout resonators [Yan, Fei, Campbell, Dan, Krantz, Philip, Kjaergaard, Morten, Kim, David, Yoder, Jonilyn L., Hover, David, Sears, Adam, Kerman, Andrew J., Orlando, Terry P., Gustavsson, Simon, Oliver, William D., \"Distinguishing Coherent and Thermal Photon Noise in a Circuit Quantum Electrodynamical System\", 2018] and is expected to only moderately contribute to the total dephasing. Indeed, we find $T_{\\phi, 1}^{\\rm Q1} \\approx \\SI{70}{\\micro\\second}$ and $T_{\\phi, 1}^{\\rm Q2} \\approx \\SI{45}{\\micro\\second}$ for the coupler frequencies relevant for the CZ gate, see Appendix\u00a0<ref> for the full data. The Gaussian component of the dephasing time is dominated by low-frequency flux noise [Bylander, Jonas, Gustavsson, Simon, Yan, Fei, Yoshihara, Fumiki, Harrabi, Khalil, Fitch, George, Cory, David G, Nakamura, Yasunobu, Tsai, Jaw-Shen, Oliver, William D, \"Noise spectroscopy through dynamical decoupling with a superconducting flux qubit\", 2011] (see Appendix\u00a0<ref> for details), which is a function of flux-dispersion of the uncoupled modes and the degree of their hybridisation. We model the dephasing rate of the coupled mode $k$ as\n$$\n\n\\Gamma_{\\phi, 2}^{k} = 1/T_{\\phi, 2}^{k} =\\sqrt{\\sum_{i=\\rm{Q_1}, \\rm{Q_2}, \\rm{c}} \\left(p_{i, k}\\tilde{\\Gamma}_{\\phi, 2}^i\\right)^2},\n\n$$\nwhere $p_{i, k}$ is the participation ratio of the uncoupled mode $i$ in the hybridized mode $k$ and $\\tilde{\\Gamma}_{\\phi, 2}^i$ are the dephasing rates of the uncoupled modes, see Fig. (Figure fig:fig_4)(c) for the comparison of the model and the experimental data. Above we have assumed that flux noise affecting the uncoupled modes originates from independent sources and can be approximated as quasi-static noise, resulting in the dephasing rates of the uncoupled modes to sum in square [Ithier, G., Collin, E., Joyez, P., Meeson, P. J., Vion, D., Esteve, D., Chiarello, F., Shnirman, A., Makhlin, Y., Schriefl, J., Sch\u00f6n, G., \"Decoherence in a superconducting quantum bit circuit\", 2005]. To account for the change in the flux noise sensitivity of the uncoupled coupler mode as its frequency is varied, we model the coupler dephasing rate as $\\tilde{\\Gamma}_{\\phi, 2}^{\\rm c} = B|\\frac{\\partial\\omega_{\\rm c}}{\\partial\\Phi_{\\rm c}}|$ [Bylander, Jonas, Gustavsson, Simon, Yan, Fei, Yoshihara, Fumiki, Harrabi, Khalil, Fitch, George, Cory, David G, Nakamura, Yasunobu, Tsai, Jaw-Shen, Oliver, William D, \"Noise spectroscopy through dynamical decoupling with a superconducting flux qubit\", 2011], where $\\omega_{\\rm c}/2\\pi$ is the frequency of the uncoupled coupler mode, $\\Phi_{\\rm c}$ is the coupler flux, $B\\approx\\SI{53}{\\Phi_0}$ is the flux noise amplitude extracted from a fit to the coupler dephasing rate when it is decoupled from the qubits, and $\\Phi_0$ is the flux quantum. With these assumptions, we observe an excellent match between the experimental data and the model across the measured coupler frequency range, and note that the dephasing times of the qubit modes stay above $\\SI{1}{\\micro\\second}$ even when maximally hybridized with the coupler due to having the coupler flux sweet spot being located near the qubit frequencies.\n\nIn order to estimate the coherence limit of an arbitrarily long CZ gate, we calculate effective relaxation times $T_{1, {\\rm eff}}$ and effective dephasing times $T_{\\phi, 1, {\\rm eff}}$ and $T_{\\phi, 2, {\\rm eff}}$ for both qubits by weighting the measured coherence rates with the time spend on the corresponding continuous adiabatic trajectories [Fig.\u00a0(Figure fig:fig_4)(b)] during the CZ gate, see Appendix\u00a0<ref> for additional information. The time spent on each frequency is determined by the Slepian pulse shape, which we parameterize with the interaction time $\\tau$. For each $\\tau$, we re-calculate the pulse shape using the $ZZ$ interaction strength calibration data in Fig.\u00a0(Figure fig:fig_2)(b) to ensure that a conditional phase of $\\phi_{11}=\\pi$ is accumulated.\n\nThe coherence limit can then be calculated as [Chu, Ji, Yan, Fei, \"Coupler-Assisted Controlled-Phase Gate with Enhanced Adiabaticity\", 2021] [Abad, Tahereh, Fern\u00e1ndez-Pend\u00e1s, Jorge, Kockum, Anton Frisk, Johansson, G\u00f6ran, \"Universal fidelity reduction of quantum operations from weak dissipation\", 2021]\n$$\n\n\\label{eq:coherence_limit}\n\\epsilon_{\\rm CZ}^{\\rm limit}(\\tau) = \\sum_{i=1,2} \\frac{2}{5}\\left[ \\frac{\\tau}{T_{1, {\\rm eff}}^{{\\rm Q}_i} (\\tau)} +\n\\frac{\\tau}{T_{\\phi, 1, {\\rm eff}}^{{\\rm Q}_i} (\\tau)} +\n\\left(\\frac{\\tau}{T_{\\phi, 2, {\\rm eff}}^{{\\rm Q}_i}(\\tau)}\\right)^2 \\right],\n\n$$\nwhere the first term in the square brackets corresponds to the coherence limit of the CZ gate due to the relaxation times of qubits and the second and third terms yield the coherence limits due to exponential and Gaussian components of dephasing, respectively. Figure\u00a0(Figure fig:fig_4)(d) depicts the coherence limit for the gate error $\\epsilon_{\\rm CZ}^{\\rm limit}$ for various different gate durations along with the contributions of the individual terms in Eq.\u00a0(<ref>).\n\nFor our CZ gate with the interaction time of 22 and an additional 11 wait time around it, we obtain $T_{1, {\\rm eff}}^{{\\rm Q}_1} = \\SI{14}{\\micro\\second}$, $T_{1, {\\rm eff}}^{{\\rm Q}_2} = \\SI{43}{\\micro\\second}$, $T_{\\phi, 1, {\\rm eff}}^{{\\rm Q}_1} = \\SI{67}{\\micro\\second}$, $T_{\\phi, 1, {\\rm eff}}^{{\\rm Q}_2} = \\SI{43}{\\micro\\second}$, $T_{\\phi, 2, {\\rm eff}}^{{\\rm Q}_1} = \\SI{17}{\\micro\\second}$ and $T_{\\phi, 2, {\\rm eff}}^{{\\rm Q}_2} = \\SI{6}{\\micro\\second}$, yielding a coherence limit of $\\epsilon_{\\rm CZ}^{\\rm limit} = \\num{1.7e-3}$. This limit can be compared with the experimentally measured gate error $\\epsilon_{\\rm CZ} = \\num[separate-uncertainty]{1.9(2)e-3}$ which is only slightly higher, indicating that the gate is mostly coherence limited, as was already suggested by the randomized benchmarking experiment with multiple interleaved CZ gates. The most significant contribution to the errors comes from the energy relaxation time $T_{1, {\\rm eff}}^{{\\rm Q}_1}$. Importantly, the fidelity is only modestly affected by dephasing, mainly due to the possibility to operate the coupler near its flux insensitive sweep spot during the CZ gate. To demonstrate that the coupler coherence times at the two-qubit-gate operation region are high enough not to have a detrimental impact on the gate errors, we re-compute the coherence limit assuming that hybridization with the coupler does not affect the qubit coherence times and use this as a reference, see Fig. (Figure fig:fig_4)(d). Comparing the reference case with the coherence limit $\\epsilon_{\\rm CZ}^{\\rm limit}$, we find a negligible difference, confirming the hypothesis.\n\nPossible reasons for the remaining errors include system fluctuations due to TLSs nearby the qubits, leading to rare uncontrollable jumps in the qubit frequencies, as well as uncompensated flux pulse distortions in the nanosecond range and leakage to non-computational states.\n\n## Conclusions\nWe have proposed and demonstrated a tunable-coupler design based on a floating transmon coupled to two computational qubits via waveguide extenders. This design allows the qubits to be separated at least by 2, enabling each qubit to have individual readout resonators and Purcell filters for high-fidelity readout, low non-nearest-neighbor coupling, and reduced crosstalk from passing control lines to the qubits in a flip-chip architecture. Although there is a minor trade-off between qubit-qubit distance and the coupling strengths due to the added capacitance of the waveguide extenders to ground, we have shown that the interaction strength is large enough for a qubit-qubit distance beyond 1 by demonstrating a fast and high-fidelity CZ gate with [separate-uncertainty = true]99.81(2) fidelity. We confirmed that the CZ gate fidelity is not limited by the coupler coherence, but mostly determined by the qubit energy-relaxation rate, making state-of-the-art two-qubit-gate fidelities on large quantum processors based on this coupler design an achievable goal.\n\n"}
{"prompt": "What are the key contributions of the paper 'Quantum theory of a bandpass Purcell filter for qubit readout'?", "completion": "\n\n# Quantum theory of a bandpass Purcell filter for qubit readout\n\n$^1$Department  of Electrical and Computer Engineering,\nUniversity of California, Riverside, California 92521, USA\n\n$^2$Department of Physics, University of California, Santa Barbara,\nCalifornia 93106, USA\n\n$^3$Google Inc., Santa Barbara, USA\n\nThe measurement fidelity of superconducting transmon and Xmon qubits is\npartially limited by the qubit energy relaxation through the resonator into\nthe transmission line, which is also known as the Purcell effect. One\nway to suppress this energy relaxation is to employ a filter which impedes\nmicrowave propagation at the qubit frequency. We present\nsemiclassical and quantum analyses for the bandpass Purcell filter\nrealized by E. Jeffrey et al. [Phys. Rev. Lett. 112,\n190504 (2014)]. For typical experimental parameters, the bandpass\nfilter suppresses the qubit relaxation rate by up to two orders of\nmagnitude while maintaining the same measurement rate. We also show\nthat in the presence of a microwave drive the qubit relaxation rate\nfurther decreases with increasing drive strength.\n\n03.67.Lx,  85.25.-j, 03.65.Yz\n\n## Introduction\nThe implementation of  fault-tolerant quantum information processing\n[Unknown Author, \"Unknown Title\", ] requires high-fidelity quantum gates and also needs sufficiently fast and accurate qubit measurement. Superconducting quantum computing technology [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] is currently approaching the threshold for quantum error correction. Compared with the recent rapid progress in the increase of single-qubit and two-qubit gate fidelities, qubit measurement shows somewhat slower progress. The development of faster and higher-fidelity qubit readout remains an important task.\n\nIn circuit QED (cQED) [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the qubit state\nis inferred by measuring the state-dependent frequency shift of the\nresonator via homodyne detection. This method introduces an unwanted\ndecay channel [Unknown Author, \"Unknown Title\", ] for the qubit due to the energy\nleakage through the resonator into the transmission line, the\nprocess known as the Purcell effect [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe Purcell effect is one of the limiting factors for high fidelity\nqubit readout.\n\nIn principle, the Purcell rate can be suppressed by increasing the\nqubit-resonator detuning, decreasing the qubit-resonator coupling,\nor decreasing the resonator bandwidth due to damping. However,\nthese simple methods increase the time needed to measure the qubit.\nThis leads to a trade-off between the qubit relaxation and\nmeasurement time, whereas it is desirable to suppress the Purcell rate\nwithout compromising qubit measurement. Several proposals have been\nput forward for this purpose, which include employing a Purcell\nfilter [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], engineering a Purcell-protected\nqubit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], or using a tunable coupler that\ndecouples the transmission line from the resonator during the\nqubit-resonator interaction, thereby avoiding the Purcell effect\naltogether [Unknown Author, \"Unknown Title\", ].\n\nThe general idea of the Purcell filter is to impede the propagation of\nthe photon emitted at the qubit frequency, compared with propagation\nof the microwave field at the resonator frequency, used for the\nqubit measurement. A notch (band-rejection) filter detuned by 1.7\nGHz from the resonator frequency was realized in Ref. [Unknown Author, \"Unknown Title\", ].\nA factor of 50 reduction in the Purcell rate was demonstrated when\nthe qubit frequency was placed in the rejection band of the filter.\nA bandpass filter with the quality factor $Q_{\\rm f}\\simeq 30$ (and\ncorresponding bandwidth of 0.22 GHz) centered near the\nresonator frequency was used in Ref. [Unknown Author, \"Unknown Title\", ]. This\nallowed the qubit measurement within 140 ns with fidelities\n$F_{|1\\rangle}=98.7$ and $F_{|0\\rangle}=99.3$ for the two qubit\nstates. (The bandpass Purcell filter was also used in Ref. [Unknown Author, \"Unknown Title\", ]; it\nhad a similar design with a few minor changes.) A major advantage of\nthe bandpass Purcell filter in comparison with the notch filter is\nthe possibility to keep strongly reduced Purcell rate for qubits\nwith practically any frequency (except near the filter frequency),\nthus allowing quantum gates based on tuning the qubit frequency,\nand also allowing multiplexed readout of several qubits by placing\nreadout resonators with different frequencies within the filter\nbandwidth.\n\nIn this work, we analyze the Purcell filter of Ref.[Unknown Author, \"Unknown Title\", ] using both semiclassical and quantum approaches\nand considering both the weak and the strong drive regimes. Our\nsemiclassical analysis uses somewhat different language compared\nto the analysis in Ref. [Unknown Author, \"Unknown Title\", ]; however, the results are\nvery similar (they show that with the filter the Purcell rate can be\nsuppressed by two orders of magnitude, while maintaining the same\nmeasurement time). The results of the quantum analysis in the regime\nof a weak measurement drive or no drive (considering the\nsingle-photon subspace) practically coincide with the semiclassical\nresults. In the presence of strong microwave drive, the Purcell rate\nis further suppressed with increasing drive strength. We have found\nthat this suppression is stronger than that obtained without a\nfilter [Unknown Author, \"Unknown Title\", ].\n\nIn Sec. II we discuss the general idea of the bandpass Purcell\nfilter and analyze its operation semiclassically. Section III is\ndevoted to the quantum calculation of the Purcell rate in the\npresence of the bandpass Purcell filter. In Sec. IV we discuss further\nsuppression of the Purcell rate due to an applied microwave drive.\nSection V is the Conclusion. In the appendix we review the basic theory of a\ntransmon/Xmon qubit measurement, the Purcell decay, and the\ncorresponding measurement error without the Purcell filter.\n\n## Idea of a bandpass Purcell filter and semiclassical analysis\nIn the standard cQED setup of dispersive measurement (Fig.(Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r)) the qubit interaction with the resonator slightly\nchanges the effective resonator frequency depending on the qubit\nstate, so that it is $\\omega_{\\rm r}^{|e\\rangle}$ when the qubit is\nin the excited state and $\\omega_{\\rm r}^{|g\\rangle}$ when the qubit\nis in the ground state. The dispersive coupling $\\chi$ is defined as\n\u03c7\u2261(\u03c9_r^|e\u27e9-\u03c9_r^|g\u27e9)/2 .\nIn the two-level approximation for the qubit, $\\chi=g^2/(\\omega_{\\rm\nq}^{\\rm b}-\\omega_{\\rm r}^{\\rm b})$, where $g$ is the\nqubit-resonator coupling and $\\omega_{\\rm q}^{\\rm b}$ and\n$\\omega_{\\rm r}^{\\rm b}$ are the bare frequencies of the qubit and\nthe resonator, respectively [Unknown Author, \"Unknown Title\", ]. For a transmon or an Xmon qubit,\n$\\chi$ is usually significantly smaller, $\\chi \\approx -g^2\n\\delta_{\\rm q}/[(\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm r}^{\\rm\nb})(\\omega_{\\rm q}^{\\rm b}-\\delta_{\\rm q}-\\omega_{\\rm r}^{\\rm b})]$,\nwhere $\\delta_{\\rm q}$ is the qubit anharmonicity ($\\delta_{\\rm q}>0$); moreover, $\\chi$\nas well as the central frequency $(\\omega_{\\rm\nr}^{|e\\rangle}+\\omega_{\\rm r}^{|g\\rangle})/2$ depend on the number\nof photons $n$ in the resonator (see [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and the Appendix for a more detailed discussion). The resonator frequency change (and thus the qubit state) is sensed by applying the microwave field with amplitude $\\varepsilon$, then amplifying the transmitted or reflected signal, and then mixing it with the applied microwave field to measure its phase and amplitude (Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r)).\n\n< g r a p h i c s >\n\nSchematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency $\\omega_{\\rm r}$ (due to qubit-resonator interaction with strength $g$), and this is sensed by passing the microwave through (or reflecting from) the resonator. The amplified outgoing microwave is combined with the local oscillator at the mixer, whose output is measured to discriminate the qubit states. The energy decay $\\kappa$ of the resonator is mainly due to its coupling with the transmission line.\n\nIn the process of measurement, the qubit decays with the Purcell\nrate [Unknown Author, \"Unknown Title\", ]\n\u0393\u2248\u03ba\ng^2/(\u03c9_q-\u03c9_r)^2,\nwhere $\\kappa$ is the resonator energy damping rate (mostly due to leakage into the transmission line \u2013 see Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r)). Note that in this formula we do\nnot distinguish the bare and effective frequencies. In the quantum\nlanguage this can be interpreted as the leakage with the rate\n$\\kappa$ of the qubit \u201ctail\u201d $g^2/(\\omega_{\\rm q}-\\omega_{\\rm\nr})^2$, existing in the form of the resonator photon. However, the\nPurcell decay also has a simple classical interpretation via the resistive damping\n[Unknown Author, \"Unknown Title\", ], essentially being a linear effect, in contrast to\nthe dispersion (<ref>) \u2013 see Appendix for more\ndetails, including dependence of $\\Gamma$ on $n$ [Unknown Author, \"Unknown Title\", ].\n\nThe Purcell decay leads to measurement error; therefore, it is\nimportant to reduce the rate $\\Gamma$. This can be done by\ndecreasing the ratio $g/|\\omega_{\\rm q}-\\omega_{\\rm r}|$; however,\nthis decreases $\\chi$ and thus increases the necessary measurement\ntime $t_{\\rm m}$ (see Appendix for more details). Another way to\ndecrease $\\Gamma$ is to use a very small leakage rate $\\kappa$;\nhowever, this also increases the measurement time $t_{\\rm m}$\nbecause the ring-up and ring-down processes give a natural\nlimitation $t_{\\rm m} \\agt 4\\,\\kappa^{-1}$, and in many practical\ncases it is even $t_{\\rm m} \\gg 10 \\,\\kappa^{-1}$.\n\nIt would be good if the rate $\\kappa$ which governs the measurement time were\ndifferent from $\\kappa$ in Eq. (<ref>): specifically if\n$\\kappa$ for the Purcell decay were much smaller than $\\kappa$ for the measurement. This\nis exactly what is achieved by using the bandpass filter of Ref.[Unknown Author, \"Unknown Title\", ]. There are other ways to explain how this Purcell\nfilter works [Unknown Author, \"Unknown Title\", ], but here we interpret the main idea\nof the bandpass Purcell filter as producing different effective\nrates $\\kappa_{\\rm eff}$ for the measurement and for the Purcell decay (so\nthat the measurement microwave easily passes through the filter,\nwhile the propagation of the photon emitted by the qubit is strongly\nimpeded by the filter).\n\n< g r a p h i c s >\n\nQubit measurement schematic with the bandpass Purcell\nfilter  of Ref. [Unknown Author, \"Unknown Title\", ]. The readout resonator with\nfrequency $\\omega_{\\rm r}$ (which depends on the qubit state) is\ncoupled (coupling $\\mathcal{G}$) with a filter resonator of\nfrequency $\\omega_{\\rm f}$, which decays into the transmission line\nwith the rate $\\kappa_{\\rm f}$. The further processing of the\noutgoing microwave (not shown) is the same as in Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r).\nThe microwave drive can be applied either to the readout\n($\\varepsilon_{\\rm r}$) or to the filter ($\\varepsilon_{\\rm f}$)\nresonators. Coupling with the decaying filter resonator produces an\neffective decay rate $\\kappa_{\\rm eff}$ of the readout resonator,\nwhich depends on the drive frequency. As a result, for the\nmeasurement microwave $\\kappa_{\\rm eff}=\\kappa_{\\rm r}$, while the\nqubit sees a much smaller value $\\kappa_{\\rm eff}=\\kappa_{\\rm q}$,\nthus leading to a suppression of the qubit Purcell decay by a factor $\\kappa_{\\rm q}/\\kappa_{\\rm r}$.\n\nThe schematic of the qubit measurement with the bandpass Purcell\nfilter of Ref. [Unknown Author, \"Unknown Title\", ] is shown in Fig. (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>).\nBesides the readout resonator with qubit-state-dependent frequency $\\omega_{\\rm\nr}=\\omega_{\\rm r}^{|e\\rangle}$ or $\\omega_{\\rm r}=\\omega_{\\rm\nr}^{|g\\rangle}$, there is a second (filter)\nresonator with frequency $\\omega_{\\rm f}$, coupled with the readout\nresonator with the coupling $\\mathcal{G}$. (The coupling\n$\\mathcal{G}$ is inductive, but we draw it as capacitive to keep the figure simple.) The filter resonator leaks the microwave into the\ntransmission line with a relatively large damping rate $\\kappa_{\\rm f}$, so\nthat its $Q$-factor is $Q_{\\rm f}=\\omega_{\\rm f}/\\kappa_{\\rm f}\n\\simeq 30$, while $|\\mathcal{G}|\\ll \\kappa_{\\rm f}$. The leaked\nfield is then amplified and sent to the mixer (not shown) in the\nsame way as in the standard cQED setup. The readout and filter\nresonators are in general detuned from each other, but not much,\n$|\\omega_{\\rm r}-\\omega_{\\rm f}|\\alt \\kappa_{\\rm f}$ (detuning is needed to\nmultiplex readout of several qubits using the same filter resonator\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]; for simplicity we consider the measurement of only one qubit). The filter resonator is pumped with the\ndrive frequency $\\omega_{\\rm d}$ (close to $\\omega_{\\rm r}$) and\namplitude $\\varepsilon_{\\rm f}$. However, for us it will be easier\nto first assume instead that the readout resonator is pumped with\namplitude $\\varepsilon_{\\rm r}$ (Fig. (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>)), and then show\nthe correspondence between the drives $\\varepsilon_{\\rm r}$ and\n$\\varepsilon_{\\rm f}$.\n\nLet us use the rotating wave approximation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with the rotating frame $e^{-i\\omega_d t}$ based on the drive\nfrequency $\\omega_{\\rm d}$. Then the evolution of the classical\nfield amplitudes $\\alpha (t)$ and $\\beta (t)$ in the readout and\nfilter resonators, respectively, is given by the equations\n$$\n\n& \\dot {\\alpha} =-i\\Delta_{\\rm rd} \\alpha -i\\mathcal{G}\\beta\n-i\\varepsilon_{\\rm r} ,\n\\label{alpha-dot-1} \\\\\n&  \\dot {\\beta} = -i\\Delta_{\\rm fd}\\beta -i\\mathcal{G}^*\\alpha\n-\\frac{\\kappa_{\\rm f}}{2}\\, \\beta , \\label{beta-dot-1}\n\n$$\nwhere $\\alpha$ and $\\beta$ are normalized so that $|\\alpha|^2$ and\n$|\\beta|^2$ are the average number of photons in the resonators,\n$\\varepsilon_{\\rm r}$ is normalized correspondingly, and\n\u0394_rd = \u03c9_r- \u03c9_d,\n\u0394_fd = \u03c9_f- \u03c9_d\n(recall that $\\omega_{\\rm r}$ depends on the qubit state). If we are\nnot interested in the details of evolution on the fast time scale\n$\\kappa_{\\rm f}^{-1}$, then we can use the quasisteady state for\n$\\beta$ [obtained from Eq. (<ref>) using $\\dot \\beta=0$],\n\u03b2= -i \ud835\udca2^*/\u03ba_f/2 + i \u0394_fd  \u03b1,\nwhich can then be inserted into Eq. (<ref>), giving\n$$\n\n&& \\dot {\\alpha} = -i(\\Delta_{\\rm rd}+\\delta \\omega_{\\rm r}) \\,\n\\alpha -\\frac{\\kappa_{\\rm eff}}{2} \\, \\alpha -i\\varepsilon_{\\rm r},\n\\label{alpha-dot-2}\\\\\n&& \\kappa_{\\rm eff} = \\frac{4 |\\mathcal{G}|^2}{\\kappa_{\\rm f}} \\,\n\\frac{1}{1+(2\\Delta_{\\rm fd}/\\kappa_{\\rm f})^2} ,\n\\label{kappa-eff}\\\\\n&& \\delta\\omega_{\\rm r} = - \\frac{ |\\mathcal{G}|^2  \\Delta_{\\rm\nfd}}{(\\kappa_{\\rm f} /2)^2 +\\Delta_{\\rm fd}^2}=-\\frac{\\Delta_{\\rm\nfd}}{\\kappa_{\\rm f}}\\, \\kappa_{\\rm eff} .\n\\label{delta-omega-r}\n\n$$\nThus we see that the field $\\alpha$ evolves in practically the same\nway as in the standard setup of Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r); however,\ninteraction with the filter resonator shifts the readout resonator\nfrequency by $\\delta\\omega_{\\rm r}$  and introduces the effective\nleakage rate $\\kappa_{\\rm eff}$ of the readout resonator.\n\nMost importantly, $\\kappa_{\\rm eff}$ depends on the drive frequency.\nFor measurement we use $\\omega_{\\rm d} \\approx \\omega_{\\rm r}$, so\n$\\kappa_{\\rm eff}$ is approximately\n\u03ba_r \u22614 |\ud835\udca2|^2/\u03ba_f\n1/1+[2(\u03c9_r-\u03c9_f)/\u03ba_f]^2 .\nHowever, when the qubit tries to leak its excitation through the\nreadout resonator, this can be considered as a drive at the qubit\nfrequency, $\\omega_{\\rm d}=\\omega_{\\rm q}$, and the corresponding\n$\\kappa_{\\rm eff}$ is then\n\u03ba_q \u22614 |\ud835\udca2|^2/\u03ba_f\n1/1+[2(\u03c9_q-\u03c9_f)/\u03ba_f]^2,\nwhich is much smaller than $\\kappa_{\\rm r}$ if the qubit is detuned\naway from the filter linewidth, $|\\omega_{\\rm q}-\\omega_{\\rm f}| \\gg\n\\kappa_{\\rm f}$. This difference is exactly what we wished for  suppressing the\nPurcell rate $\\Gamma$: the measurement is governed by $\\kappa_{\\rm\nr}$, while the qubit sees a much smaller value $\\kappa_{\\rm q}$.\nTherefore, we would expect that the Purcell rate is given by Eq.(<ref>) with $\\kappa=\\kappa_{\\rm q}$ [see Eq. (<ref>) later], while the\n\u201cseparation\u201d measurement error is given by Eqs.(<ref>)\u2013(<ref>) with $\\kappa=\\kappa_{\\rm r}$\n(see Appendix). As a result, compared with the standard setup (Fig.(Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r)) with the same physical parameters for measurement, the\nPurcell rate is suppressed by the factor\nF= \u03ba_q/\u03ba_r =\n1+[2(\u03c9_r-\u03c9_f)/\u03ba_f]^2/1+[2(\u03c9_q-\u03c9_f)/\u03ba_f]^2 \u226a1.\nThis is essentially the main result of this paper, which will\nbe confirmed by the quantum analysis in the next section. (To avoid a possible confusion, we note that $\\kappa_{\\rm q}$ is not the qubit decay rate; it is the resonator decay, as seen by the qubit.)\n\nOur result for the Purcell suppression factor was based on the\nbehavior of the field amplitude in the readout resonator. Let us\nalso check that the field $\\gamma_{\\rm tl}$ propagating in the outgoing\ntransmission line behaves according to the effective model as well.\nThe outgoing field amplitude is $\\gamma_{\\rm tl}=\\sqrt{\\kappa_{\\rm\nf}}\\, \\beta$ (in the normalization for which $|\\gamma_{\\rm tl}|^2$ is\nthe average number of propagating photons per second). Using Eq.(<ref>), we find\n\u03b3_tl = -i \ud835\udca2^* \u221a(\u03ba_f)/\u03ba_f/2 + i \u0394_fd  \u03b1= e^i \u03c6\n\u221a(\u03ba_eff)   \u03b1,\nso, as expected, the outgoing amplitude behaves as in the standard\nsetup of Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r) with $\\kappa=\\kappa_{\\rm eff}$, up to an\nunimportant phase shift $\\varphi= {\\rm arg} [-i\n\\mathcal{G}^*/(\\kappa_{\\rm f}/2 + i \\Delta_{\\rm fd})]$. Note that to\nshow the equivalence between the dynamics (including transients) of\nthe systems in Figs. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r) and (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>) we needed the\nassumption of a sufficiently large $\\kappa_{\\rm f}$ in order to use\nthe quasisteady state (<ref>). However, this assumption is\nnot needed if we consider only the steady state (without\ntransients).\n\nSo far we assumed that the measurement is performed by driving the\nreadout resonator with the amplitude $\\varepsilon_{\\rm r}$. Now let\nus consider the realistic case [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] when the\ndrive $\\varepsilon_{\\rm f}$ is applied to the filter resonator. The evolution equations (<ref>) and (<ref>) for the classical field amplitudes are then replaced by\n$$\n\n& \\dot {\\alpha} =-i\\Delta_{\\rm rd} \\alpha -i\\mathcal{G}\\beta ,\n\\label{alpha-dot-3} \\\\\n&  \\dot {\\beta} = -i\\Delta_{\\rm fd}\\beta -i\\mathcal{G}^*\\alpha\n-\\frac{\\kappa_{\\rm f}}{2}\\, \\beta -i\\varepsilon_{\\rm f} ,\n\\label{beta-dot-3}\n\n$$\nso that the quasisteady state for the filter resonator is\n\u03b2= -i \ud835\udca2^* /\u03ba_f/2 + i \u0394_fd  \u03b1+  -i\u03b5_f/\u03ba_f/2 + i \u0394_fd ,\nand the field evolution in the readout resonator is\n\u03b1\u0307 = -i(\u0394_rd+\u03b4\u03c9_r)\n\u03b1-\u03ba_eff/2   \u03b1-\n\ud835\udca2/\u03ba_f/2 + i \u0394_fd\n\u03b5_f,\n\nwith the same $\\kappa_{\\rm eff}$ and $\\delta\\omega_{\\rm r}$  given\nby Eqs. (<ref>) and (<ref>). The only\ndifference between the effective evolution equations\n(<ref>) and (<ref>) is a linear relation,\n\u03b5_r \u2194-i  \u03b5_f\n\ud835\udca2 /(\u03ba_f/2 + i \u0394_fd),\nbetween the\ndrive amplitudes $\\varepsilon_{\\rm r}$ and $\\varepsilon_{\\rm f}$\nproducing the same effect. Therefore, our results obtained above remain\nunchanged for driving the filter resonator, and the Purcell rate\nsuppression factor is still given by Eq. (<ref>).\n\nNote that in the quasisteady state the separation between the filter\namplitudes $\\beta$ for the two qubit states does not depend on\nwhether the drive is applied to the filter or readout  resonator, as\nlong as we use the correspondence (<ref>) between the drive\namplitudes. The same is true for the separation between the outgoing\nfields $\\gamma_{\\rm tl}$. Similarly, the separation between the\noutgoing fields for the two qubit states is the same (up to  the\nphase $\\varphi$) as in the standard setup of Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r) with\n$\\varepsilon=\\varepsilon_{\\rm r}$, $\\kappa =\\kappa_{\\rm r}$, and the\nresonator frequency adjusted by $\\delta\\omega_{\\rm r}$ given by Eq.(<ref>). Therefore, these configurations are\nequivalent to each other from the point of view of quantum\nmeasurement, including interaction between the qubit and readout\nresonator, extraction of quantum information, back-action, etc.\n\nNevertheless, driving the filter resonator produces a different\noutgoing field $\\gamma_{\\rm tl}=\\sqrt{\\kappa_{\\rm f}}\\, \\beta$,\nwhich now contains an additional term $-i\\varepsilon_{\\rm f}\n\\sqrt{\\kappa_{\\rm f}} / (\\kappa_{\\rm f}/2 + i \\Delta_{\\rm fd})$ in\ncomparison with Eq. (<ref>), which comes from the second\nterm in Eq. (<ref>). In particular, instead of the\nLorentzian line shape of the transfer function when driving the\nreadout resonator, the transfer function for driving the filter is\n(in the steady state)\n\u03b3_tl^(f)/\u03b5_f=\n\u221a(\u03ba_f)/\u03ba_f/2+i\u0394_fd\n2\u0394_rd/\u03ba_eff/1 +2i (\u0394_rd+\u03b4\u03c9_r)/\u03ba_eff,\nwhere $\\kappa_{\\rm eff}$ can be replaced with $\\kappa_{\\rm r}$. (Note a non-standard normalization of the transfer function because of different normalizations of $\\gamma_{\\rm tl}^{\\rm (f)}$ and $\\varepsilon_{\\rm f}$.) This\nline shape for the amplitude $|\\gamma_{\\rm tl}^{\\rm (f)}/\\varepsilon_{\\rm f}|$ shows a dip near $\\omega_{\\rm r}$ (note that $\\gamma_{\\rm\ntl}^{\\rm (f)}/\\varepsilon_{\\rm f}=0$ at $\\omega_{\\rm d}=\\omega_{\\rm\nr}$) and is  significantly asymmetric when $\\delta\\omega_{\\rm r}$ is\ncomparable to $\\kappa_{\\rm r}$; this occurs when the detuning\nbetween the readout and filter resonators is comparable to\n$\\kappa_{\\rm f}$ \u2013 see Eq. (<ref>). In terms of the\nfield $\\alpha$ in the readout resonator, the outgoing field at\nsteady state is\n\u03b3_tl^(f) = - \u221a(\u03ba_f)\n\u0394_rd/\ud835\udca2   \u03b1\ninstead of Eq. (<ref>) for driving the readout resonator.\n\nThe difference between the outgoing fields  $\\gamma_{\\rm tl}^{\\rm (f)}$ and  $\\gamma_{\\rm tl}^{\\rm (r)}$ when driving the filter or readout resonator (for the same $\\alpha$, i.e., the same measurement conditions) may be important for saturation of the microwave amplifier. The ratio of the corresponding outgoing\npowers is\n| \u03b3_tl^(f)|^2/| \u03b3_tl^(r)|^2 = (\u0394_rd/\u03ba_r)^2 4/1+(2\u0394_fd /\u03ba_f)^2  ,\n\nwhere we assumed $|\\Delta_{\\rm rd}|\\ll\n\\kappa_{\\rm f}$ (so that $\\kappa_{\\rm eff}\\approx \\kappa_{\\rm r}$).\nFor example, if the drive frequency is chosen as $\\omega_{\\rm\nd}=(\\omega_{\\rm r}^{|g\\rangle}+\\omega_{\\rm r}^{|e\\rangle})/2$, then\n$\\Delta_{\\rm rd}=\\pm \\chi$; if in this case $|\\chi| \\ll \\kappa_{\\rm\nr}$, then driving the filter resonator is advantageous because it\nproduces less power to be amplified, while driving the readout\nresonator is advantageous if $|\\chi| \\gg \\kappa_{\\rm r}$. However,\nwhen $\\omega_{\\rm d} \\neq (\\omega_{\\rm r}^{|g\\rangle}+\\omega_{\\rm\nr}^{|e\\rangle})/2$, the situation is more complicated.\n\nFigure (Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>) shows the transient phase-space evolution $\\beta\n(t)$ of the field (coherent state) in the filter resonator when a\nstep-function drive is applied to the readout resonator (red curves)\nor to the filter resonator (blue curves), with the drive amplitudes\nrelated via Eq. (<ref>), and for real $\\varepsilon_{\\rm r}$. The\nsolid curves show the evolution when the qubit is in the excited\nstate, while the dashed curves are for the qubit in the ground\nstate. We have used parameters similar to the experimental\nparameters of Ref. [Unknown Author, \"Unknown Title\", ]: $\\omega_{\\rm\nr}^{|e\\rangle}/2\\pi=6.8$ GHz, $\\omega_{\\rm\nr}^{|g\\rangle}/2\\pi=6.803$ GHz (so that $2\\chi/2\\pi=-3$ MHz),\n$\\omega_{\\rm f}/2\\pi = 6.75$ GHz, $Q_{\\rm f}=30$ (so that\n$\\kappa_{\\rm f}^{-1}= 0.71$ ns), and $\\kappa_{\\rm r}^{-1}=30$ ns (so\nthat $\\mathcal{G}/2\\pi =18.9$ MHz). The field evolution is\ncalculated using either Eqs.(<ref>)\u2013(<ref>) or Eqs.(<ref>)\u2013(<ref>); in simulations we have\nneglected the dependence of $\\chi$ and $(\\omega_{\\rm\nr}^{|e\\rangle}+\\omega_{\\rm r}^{|g\\rangle})/2$ on the average number\nof photons $\\bar n_{\\rm r}=|\\alpha |^2$ in the readout resonator (see Appendix).\nThe black dots indicate the time moments every 10 ns between 0 and\n100 ns, and then every 50 ns. The circles illustrate the coherent\nstate error circles [Unknown Author, \"Unknown Title\", ] in the steady state. We see that when the drive is applied to\nthe filter resonator (blue curves), the evolution $\\beta (t)$ is\ninitially very fast (governed by $\\kappa_{\\rm f}$), while after the\nquasisteady state is reached, the evolution is governed by a much\nslower $\\kappa_{\\rm r}$, eventually approaching the steady state.\nWhen the drive is applied to the readout resonator (red curves), the\ntransient evolution is always governed by the slower decay\n$\\kappa_{\\rm r}$.\n\n< g r a p h i c s >\n\n< g r a p h i c s >\n\nPhase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>). Solid curves are\nfor the qubit state $|e\\rangle$, dashed curves are for the state\n$|g\\rangle$. See text for the assumed parameters. For panel (a) we\nchoose the drive frequency $\\omega_{\\rm d}$ symmetrically for the\nreadout resonator, so that  $\\bar{n}_{\\rm\nr}^{|g\\rangle}=\\bar{n}_{\\rm r}^{|e\\rangle}=50$. For panel (b) we\nchoose $\\omega_{\\rm d}$ symmetrically for the filter resonator, so that\n$\\bar{n}_{\\rm f}^{|g\\rangle}=\\bar{n}_{\\rm f}^{|e\\rangle}$ when\ndriving the filter; we choose $\\bar{n}_{\\rm r}^{|e\\rangle}=50$. The\nblack dots indicate time moments in the evolution every 10 ns until 100 ns, then\nevery 50 ns. Circles illustrate the coherent state error circles in the steady state.\n\nIn Fig. (Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>)(a) we choose the drive frequency $\\omega_{\\rm\nd}$ symmetrically from the point of view of the readout resonator\nfield, so that in the steady state $\\bar{n}_{\\rm\nr}^{|g\\rangle}=\\bar{n}_{\\rm r}^{|e\\rangle}=50$, where $\\bar{n}_{\\rm\nr}^{|g\\rangle}$ and $\\bar{n}_{\\rm r}^{|e\\rangle}$ are the average\nphoton numbers for the two qubit states. For that we need\n$\\omega_{\\rm d}=(\\omega_{\\rm r}^{|g\\rangle}+\\omega_{\\rm\nr}^{|e\\rangle})/2+\\delta\\omega_{\\rm r}$ with $\\delta\\omega_{\\rm r}$\ngiven by Eq. (<ref>); for our parameters\n$\\delta\\omega_{\\rm r}/2\\pi =1.23$ MHz, so $\\omega_{\\rm d}/2\\pi =\n6.80273$ GHz. Such symmetric choice of the drive frequency provides\nthe largest separation between the two coherent states for a fixed\ndrive amplitude if $2 \\,|\\chi|<\\kappa_{\\rm r}$. While the field in\nthe readout resonator is always symmetric in this case, Fig.(Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>)(a) shows that the field in the filter resonator is\nsymmetric only when driving the readout resonator (red curves,\n$\\bar{n}_{\\rm f}^{|g\\rangle}=\\bar{n}_{\\rm f}^{|e\\rangle}=1.2$),\nwhile it is strongly asymmetric when the filter resonator is driven (blue\ncurves, $\\bar{n}_{\\rm f}^{|g\\rangle}=0.01$, $\\bar{n}_{\\rm\nf}^{|e\\rangle}=1.0$; $\\bar{n}_{\\rm f}^{|g\\rangle}$ is very small\nbecause for our parameters $\\delta\\omega_{\\rm r}\\approx |\\chi|$ and therefore $\\omega_{\\rm d}\\approx \\omega_{\\rm\nr}^{|g\\rangle}$). The number of photons in the filter is much less\nthan in the readout resonator because $\\kappa_{\\rm f} \\gg\n\\kappa_{\\rm r}$.\n\nIn Fig. (Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>)(b) we choose $\\omega_{\\rm d}$ so that in the\nsteady state $\\bar{n}_{\\rm f}^{|g\\rangle}=\\bar{n}_{\\rm\nf}^{|e\\rangle}$ for driving the filter; this is the natural choice\nfor decreasing the microwave power to be amplified. This occurs at\n$\\omega_{\\rm d}/2\\pi =6.80120$, which is close to the expected value\n$(\\omega_{\\rm r}^{|g\\rangle}+\\omega_{\\rm r}^{|e\\rangle})/2$, but not\nequal because of the asymmetry of the line shape (<ref>).\nWe choose the amplitudes to produce $\\bar{n}_{\\rm r}^{|e\\rangle}=50$\n(then $\\bar{n}_{\\rm r}^{|g\\rangle}=22$). The difference between\n$\\bar{n}_{\\rm r}^{|e\\rangle}$ and $\\bar{n}_{\\rm r}^{|g\\rangle}$\nleads to different values $\\bar{n}_{\\rm f}^{|e\\rangle}=1.2$ and\n$\\bar{n}_{\\rm f}^{|g\\rangle}=0.5$ when driving the readout\nresonator, while for driving the filter the field in the filter is\nsymmetric, $\\bar{n}_{\\rm f}^{|e\\rangle}=\\bar{n}_{\\rm\nf}^{|g\\rangle}=0.2$. Compared to the case of Fig.  (Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>)(a),\nthere is 5 times less power to be amplified for the $|e\\rangle$\nstate (when driving the filter); however, the state separation is\n1.3  times smaller (in amplitude) for the same $\\bar{n}_{\\rm\nr}^{|e\\rangle}$. Thus, there is a trade-off between the state\nseparation and amplified power in choosing the drive frequency.\nComparing the red and blue curves in Fig. (Figure: Phase-space transient evolution of qubit-state-dependent\ncoherent states in the filter resonator for driving either the\nreadout resonator (red curves, left) or the filter (blue curves, right), with the\ndrive amplitudes related via Eq. (<ref>)(b), we see that in the steady state $\\bar{n}_{\\rm f}^{|g\\rangle}$ and  $\\bar{n}_{\\rm f}^{|e\\rangle}$  are smaller for driving the\nfilter rather than the readout resonator. This is beneficial because\nthere is less power to be amplified; however, the ratio is not very big (as\nexpected for a moderate value $|\\chi|/\\kappa_{\\rm r}=0.28$).\n\nNote that our definition of $\\kappa_{\\rm r}$ in Eq.(<ref>) is not strictly well-defined because the resonator\nfrequency $\\omega_{\\rm r}$ depends on the qubit state, and the\ndrive frequency can be in between $\\omega_{\\rm r}^{\\rm |e\\rangle}$\nand $\\omega_{\\rm r}^{\\rm |g\\rangle}$. However, this frequency\ndifference is much smaller than $\\kappa_{\\rm f}$, and therefore not\nimportant for practical purposes in the definition of $\\kappa_{\\rm\nr}$. In an experiment $\\kappa_{\\rm r}$ can be measured either via the field decay\n[Unknown Author, \"Unknown Title\", ] or via the linewidth of the steady-state transfer\nfunction showing the dip of $|\\gamma_{\\rm tl}^{\\rm (f)}/\\varepsilon_{\\rm f}|$ near the resonance $\\omega_{\\rm d}=\\omega_{\\rm r}$  [Eq. (<ref>)], since near the dip $\\kappa_{\\rm eff}\\approx \\kappa_{\\rm r}$.\n\nThus far we assumed that all decay $\\kappa_{\\rm f}$ in the filter\nresonator is due to the leakage $\\kappa_{\\rm f}^{\\rm out}$ into the\noutgoing transmission line. If $\\kappa_{\\rm f}^{\\rm out} <\n\\kappa_{\\rm f}$ and the decay $\\kappa_{\\rm f}-\\kappa_{\\rm f}^{\\rm\nout}$ is due to leakage into the line delivering the drive\n$\\varepsilon_{\\rm f}$ or due to another dissipation channel, then\nthe only difference compared to the previous discussion is the extra\nfactor $\\sqrt{\\kappa_{\\rm f}^{\\rm out}/\\kappa_{\\rm f}}$ for the\noutgoing field $\\gamma_{\\rm tl}$. This will lead to multiplication\nof the overall quantum efficiency of the measurement by $\\kappa_{\\rm\nf}^{\\rm out}/\\kappa_{\\rm f}$ and will only slightly affect the\nmeasurement fidelity.  Adding dissipation in the readout resonator with\nrate $\\kappa_{\\rm r,d}$ increases the effective linewidth to\n$\\kappa_{\\rm eff}+\\kappa_{\\rm r,d}$ and multiplies the quantum\nefficiency by $\\kappa_{\\rm r}/(\\kappa_{\\rm r}+\\kappa_{\\rm r,d})$.\nMost importantly, since $\\kappa_{\\rm r,d}$ does not change with\nfrequency, the Purcell suppression factor (<ref>) becomes\n$(\\kappa_{\\rm q}+\\kappa_{\\rm r,d})/(\\kappa_{\\rm r}+\\kappa_{\\rm\nr,d})$, so that the Purcell filter performance deteriorates; we will\ndiscuss this in a little more detail in Sec. III$\\,$C.\n\nNote that our main result (<ref>) for the Purcell suppression\nfactor is slightly different from the result $F=[\\kappa_{\\rm\nf}/2(\\omega_{\\rm q}-\\omega_{\\rm r})]^2 (\\omega_{\\rm q}/\\omega_{\\rm\nr})^2$, which was derived in Ref. [Unknown Author, \"Unknown Title\", ] using the\ncircuit theory. The reasons are the following. First, in the\nderivation of [Unknown Author, \"Unknown Title\", ] it was assumed that the two\nresonators have the same frequency, which makes the numerator in\nEq. (<ref>) equal to 1. Second, the term 1 in the denominator\nin Eq. (<ref>) was essentially neglected in comparison with the\nlarger second term. Finally, the role of the factor $(\\omega_{\\rm\nq}/\\omega_{\\rm r})^2$ is not quite clear. In the derivation of Ref.[Unknown Author, \"Unknown Title\", ] keeping this factor was exceeding the accuracy of\nthe derivation, while in our derivation we essentially use the\nrotating wave approximation, which assumes $\\omega_{\\rm\nq}/\\omega_{\\rm r}\\approx 1$. Aside from these small differences, our\nresult coincides with the result of Ref. [Unknown Author, \"Unknown Title\", ].\n\n## Quantum analysis in single-excitation subspace\nIn this section we discuss the quantum derivation of the Purcell rate in the presence of the\nbandpass filter in the regime when the resonators are not driven or\ndriven sufficiently weakly to neglect dependence of the Purcell rate\non the number of photons in the resonator [Unknown Author, \"Unknown Title\", ]. More\nprecisely, we consider the quantum evolution in the\nsingle-excitation (and zero-excitation) subspace. We apply two\nmethods: the wavefunction approach, in which we use a non-Hermitian\nHamiltonian with a decaying wavefunction, and the more traditional\ndensity matrix analysis.\n\nIn the absence of the drive and in the rotating wave approximation, the relevant Hamiltonian of the system\nshown in Fig. (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>) (without considering decay $\\kappa_{\\rm\nf}$) is ($\\hbar =1$)\n$$\n\n&& H =  \\omega_{\\rm q}^{\\rm b} \\sigma_+\\sigma_- + \\omega_{\\rm r}^{\\rm b} a^\\dagger a + \\omega_{\\rm f} b^\\dagger b + g (a^\\dagger \\sigma_- + a\\sigma_+)\n\\nonumber \\\\\n&& \\hspace{0.8cm} +\\mathcal{G} a^\\dagger b + \\mathcal{G}^* a b^\\dagger ,\n\\label{Ham-start}\n$$\nwhere $\\omega_{\\rm q}^{\\rm b}$ is the bare qubit frequency, $\\omega_{\\rm r}^{\\rm b}$ is the bare frequency of the readout\nresonator, $\\omega_{\\rm f}$ is the  filter resonator frequency,\nraising/lowering operators $\\sigma_{+}$ and $\\sigma_-$ act on the\nqubit state, $a^\\dagger$ and $a$ are the creation and annihilation\noperators for the readout resonator, $b^\\dagger$ and $b$ are for the\nfilter resonator, $g$ is the qubit-readout resonator coupling, and\n$\\mathcal{G}$ is the resonator-resonator coupling. For simplicity we\nassume a real positive $g$, but $\\mathcal{G}$ can be complex for generality (for the capacitive or inductive coupling between the resonators, $\\mathcal{G}$ is real if the same generalized coordinates are used for both resonators).\n\nNote that in the case without drive it is sufficient to consider only two\nlevels for the qubit because only the single-excitation (and\nzero-excitation) subspace is involved in the evolution, and therefore the amount of qubit nonlinearity due to the Josephson junction is irrelevant. However, in the presence of a drive (considered in the next section) it is formally necessary to take into account several levels in the qubit (as done in the Appendix). Nevertheless, to leading order the Purcell rate is insensitive to this, because the Purcell decay is essentially a classical linear effect (see discussion in the Appendix). Also note that the lab-frame Hamiltonian (<ref>) assumes the rotating wave approximation (as in the standard Jaynes-Cummings Hamiltonian), since it neglects the \u201ccounter-rotating\u201d terms of the form $a^\\dagger \\sigma_+$, $a\\sigma_-$, $a^\\dagger b^\\dagger$, and $ab$. This requires assumption that $|\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm r}^{\\rm b}|$, $|\\omega_{\\rm f}-\\omega_{\\rm r}^{\\rm b}|$, $g$, and $|\\mathcal{G}|$ are small compared to $\\omega_{\\rm r}^{\\rm b}$.\n\nLet us choose the rotating frame with frequency $\\omega_{\\rm q}^{\\rm b}$, i.e., $H_0=\\omega_{\\rm q}^{\\rm b} (\\sigma_+\\sigma_- + a^\\dagger a+b^\\dagger b)$; then the interaction Hamiltonian $V=H-H_0$ is\n$$\n\\label{h}\nV=\\Delta_{\\rm rq} a^\\dagger a + \\Delta_{\\rm fq} b^{\\dag}b\n+\\textit{g}(a^{\\dag}\\sigma_{-}+a\\sigma_{+})+\\mathcal{G}a^{\\dag}b+ \\mathcal{G}^* ab^{\\dag},\n\n$$\nwhere\n\u0394_rq=\u03c9_r^b-\u03c9_q^b,\n\u0394_fq=\u03c9_f-\u03c9_q^b,\nand the interaction picture is equivalent to the Schr\u00f6dinger picture because $\\exp(iH_0 t) V\\exp(-iH_0 t)=V$, which is because the starting Hamiltonian (<ref>) already assumes the rotating-wave approximation.\nThe master\nequation for the density matrix $\\rho$, which includes the damping $\\kappa_{\\rm f}$ of the filter resonator is\n$$\n\\label{ma}\n\\dot \\rho=-i[V,\\rho]+\\kappa_{\\rm f} \\left(b\\rho b^{\\dag}-b^{\\dag}b\\rho/2-\\rho b^{\\dag}b/2\\right) .\n\n$$\n\nIn general, the bare basis is $|jnm\\rangle$, where $j$ represents the qubit states, while $n$ and $m$ represent the readout and filter resonator Fock states,\nrespectively. However, in this section we consider only the single-excitation (and zero-excitation) subspace, so only four bare states are relevant: $|\\textbf{e}\\rangle \\equiv |\\text{e}00\\rangle$, $|\\textbf{r}\\rangle=|\\text{g}10\\rangle$, $|\\textbf{f}\\rangle =|\\text{g}01\\rangle$, and $|\\textbf{g}\\rangle=|\\text{g}00\\rangle$.\n\nNote that the interaction hybridizes the bare states of the qubit and the resonators. (Hybridization of the readout resonator mode is essentially what makes the qubit measurement possible.) Therefore, when discussing the Purcell rate for the qubit energy relaxation, we actually mean decay of the eigenstate, corresponding to the qubit  excited state. This makes perfect sense experimentally, since manipulations of the qubit state usually occur in the eigenbasis (adiabatically, compared with the qubit detuning from the resonator).\n\n### Method I: Decaying wavefunction\nInstead of using the traditional density matrix language for the\ndescription of the Purcell effect [Unknown Author, \"Unknown Title\", ], it is easier\nto use the language of wavefunctions, even in the presence of the\ndecay $\\kappa_{\\rm f}$ [Unknown Author, \"Unknown Title\", ]. Physically, the wave functions\ncan still be used because in the single-excitation subspace\nunraveling of the Lindblad equation corresponds to only one \u201cno\nrelaxation\u201d scenario (see, e.g., [Unknown Author, \"Unknown Title\", ]), and therefore the\nwavefunction evolution is non-stochastic. Another, more formal way\nto introduce this language, is to rewrite the master equation\n(<ref>) as [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] $\\dot \\rho=-i[H_{\\rm\neff},\\rho]+\\kappa_{\\rm f} b\\rho b^{\\dag}$, where $H_{\\rm\neff}=V-i\\kappa_{\\rm f} b^{\\dag}b/2$ is an effective non-Hermitian\nHamiltonian. Next, the term $\\kappa_{\\rm f} b\\rho b^{\\dag}$ can be\nneglected because in the single-excitation subspace it produces only\nan \u201cincoming\u201d contribution  from higher-excitation subspaces,\nwhich are not populated. Therefore, in the single-excitation\nsubspace we can use $\\dot \\rho=-i[H_{\\rm eff},\\rho]$. Equivalently,\n$|\\dot \\psi \\rangle=-iH_{\\rm eff}|\\psi\\rangle$, which describes the\nevolution of the decaying wavefunction\n$|\\psi(t)\\rangle=c_{\\textbf e}(t)|\\textbf{e}\\rangle+c_{\\textbf\nr}(t)|\\textbf{r}\\rangle+c_{\\textbf f}(t)|\\textbf{f}\\rangle$.\nTherefore, the probability amplitudes\n$c_{\\textbf{e},\\textbf{r},\\textbf{f}}$ satisfy the following\nequations:\n$$\n\n% \\nonumber to remove numbering (before each equation)\n&& \\dot c_{\\textbf e} = -i g c_{\\textbf r},\n\\label{c-dot-e}\\\\\n&& \\dot c_{\\textbf r} = -i\\Delta_{\\rm rq}  c_{\\textbf r} -i gc_{\\textbf e} -i\\mathcal{G} c_{\\textbf f},\n\\label{c-dot-r}\\\\\n&& \\dot c_{\\textbf f} = -i \\Delta_{\\rm fq} c_{\\textbf f} -i\\mathcal{G}^*c_{\\textbf r} -(\\kappa_{\\rm f}/2)\\, c_{\\textbf f},\n\\label{c-dot-f}\n$$\nwhile the population $\\rho_{\\textbf{gg}}$ of the zero-excitation\nstate $|\\textbf{g}\\rangle$ evolves as\n$\\dot\\rho_{\\textbf{gg}}=\\kappa_{\\rm f}|c_{\\textbf{ff}}|^2$ or can be\nfound as $\\rho_{\\textbf{gg}}=1-|c_{\\textbf{ee}}|^2\n-|c_{\\textbf{rr}}|^2 -|c_{\\textbf{ff}}|^2$. Note that Eqs.(<ref>) and (<ref>) exactly correspond to the\nclassical equations (<ref>) and (<ref>) with\n$\\Delta_{\\rm rd}$ replaced with $\\Delta_{\\rm rq}$, also $\\Delta_{\\rm\nfd}$ replaced with $\\Delta_{\\rm fq}$, and $\\varepsilon_{\\rm r}$\nreplaced with $gc_{\\textbf e}$.\n\nFrom the eigenvalues $\\lambda_{\\textbf{e},\\textbf{r},\\textbf{f}}=-i\n\\omega_{\\textbf{e},\\textbf{r},\\textbf{f}}-\\Gamma_{\\textbf{e},\\textbf{r},\\textbf{f}}/2$\nof the matrix representing Eqs. (<ref>)\u2013(<ref>),\none can obtain the  eigenfrequencies\n$\\omega_{\\textbf{e},\\textbf{r},\\textbf{f}}$ and the corresponding\ndecay rates $\\Gamma_{\\textbf{e},\\textbf{r},\\textbf{f}}$. These\neigenvalues can be found from the qubic equation\n$$\n\\label{lambda-eq}\n& \\lambda ^3+ \\lambda^2 (i\\Delta_{\\rm rq} +i\\Delta_{\\rm fq} + \\kappa_{\\rm f}/2)\n+ \\lambda (- \\Delta_{\\rm rq}\\Delta_{\\rm fq} +|\\mathcal{G}|^2 +g^2\n\\notag\\\\\n& \\hspace{0.5cm} + i \\Delta_{\\rm rq} \\kappa_{\\rm f}/2) + g^2 (i \\Delta_{\\rm fq}+ \\kappa_{\\rm f}/2 ) =0 .\n\n$$\nWe are interested in the Purcell rate $\\Gamma=\\Gamma_{\\textbf e}$,\nwhich corresponds to the decay of the eigenstate close to\n$|\\textbf{e}\\rangle$. Since $\\lambda_{\\textbf{e}}$ is close to zero,\nin the first approximation we can neglect the term $\\lambda^3$ in\nEq. (<ref>), thus reducing it to the quadratic equation.\nIf more accuracy is needed, the equation can be solved iteratively,\nreplacing $\\lambda^3$ with the value found in the previous iteration\n(the second iteration is usually sufficient).\n\nBesides finding the Purcell rate $\\Gamma$ exactly or approximately\nfrom Eq. (<ref>), we can find it approximately by using\nquasisteady solutions of Eqs. (<ref>) and (<ref>),\nto a large extent  following the classical derivation in the\nprevious section. Assuming $\\dot c_{\\textbf f}=0$ in Eq.(<ref>), we find $c_{\\textbf f}=-i\\mathcal{G}^* c_{\\textbf\nr}/(i\\Delta_{\\rm fq}+\\kappa_{\\rm f}/2)$. Inserting this quasisteady\nvalue into Eq. (<ref>) and assuming $\\dot c_{\\textbf r}=0$,\nwe find $c_{\\textbf r}=-igc_{\\textbf e}/[i\\Delta_{\\rm rq} +\n|\\mathcal{G}|^2 /(i\\Delta_{\\rm fq}+\\kappa_{\\rm f}/2)]$. Substituting\nthis quasisteady value into Eq. (<ref>), we obtain\n\u010b_e=- g^2 /i\u0394_rq + |\ud835\udca2|^2 /(i\u0394_fq+\u03ba_f/2)   c_e = \u03bb_e c_e.\nFinally, we obtain the Purcell rate as $\\Gamma =-2{\\rm\nRe}(\\lambda_{\\textbf e})$,\n$$\n\n&& \\Gamma = \\frac{g^2 |\\mathcal{G}|^2\\kappa_{\\rm f}}\n{\\Delta_{\\rm rq}^2 [(\\Delta_{\\rm fq}-|\\mathcal G|^2/\\Delta_{\\rm rq})^2 +(\\kappa_{\\rm f}/2)^2]}\n\\label{Gamma-wf-1}\\\\\n&& \\hspace{0.3cm} \\approx \\frac{g^2 |\\mathcal{G}|^2\\kappa_{\\rm f}}\n{\\Delta_{\\rm rq}^2 [\\Delta_{\\rm fq}^2 +(\\kappa_{\\rm f}/2)^2]} = \\frac{g^2\\kappa_{\\rm q}}{\\Delta_{\\rm rq}^2},\n\\label{Gamma-wf}\n$$\nwhere $\\kappa_{\\rm q}$ is given by Eq. (<ref>) and we\nassumed  $|\\mathcal{G}|^2 \\ll  \\Delta_{\\rm fq}\\Delta_{\\rm rq}$ to transform Eq. (<ref>) into Eq. (<ref>).\n\nThe Purcell rate given by Eq. (<ref>) is exactly what we\nexpected from the classical analysis in Sec. II: in the usual\nformula (<ref>) we simply need to substitute $\\kappa$\nwith the readout resonator decay rate $\\kappa_{\\rm q}$ seen by the qubit.\nSince the measurement is governed by a different decay rate\n$\\kappa_{\\rm r}$, the effective Purcell rate suppression factor is\ngiven by Eq. (<ref>), as was expected. This confirms the\nresults of the classical analysis in Sec. II.\n\n### Method II: Density matrix analysis\nWe can also find the Purcell rate in a more traditional way by writing\nthe master equation (<ref>) explicitly in the single-excitation subspace:\n$$\n\n% \\nonumber to remove numbering (before each equation)\n&& \\dot \\rho_{\\textbf{ee}} = i\\textit{g}(\\rho_{\\textbf{er}}-\\rho_{\\textbf{re}}), \\label{r11} \\\\\n&& \\dot \\rho_{\\textbf{er}} = -i\\Delta_{\\rm qr} \\rho_{\\textbf{er}}-i\\textit{g}(\\rho_{\\textbf{rr}}-\\rho_{\\textbf{ee}})\n+i\\mathcal{G}^*\\rho_{\\textbf{ef}},\n\\label{r12} \\\\\n&& \\dot \\rho_{\\textbf{ef}} = -\\frac{\\kappa_{\\rm f}}{2}\\rho_{\\textbf{ef}}-i\\Delta_{\\rm qf}\\rho_{\\textbf{ef}}+i\\mathcal{G}\\rho_{\\textbf{er}} -ig \\rho_{\\textbf{rf}},\n\\label{r13} \\\\\n&& \\dot \\rho_{\\textbf{rr}} =-i\\textit{g}(\\rho_{\\textbf{er}}-\\rho_{\\textbf{re}})-i\\mathcal{G}\n\\rho_{\\textbf{fr}}+i\\mathcal{G}^*\\rho_{\\textbf{rf}},\n\\label{6}\\\\\n&& \\dot\\rho_{\\textbf{rf}}=-\\frac{\\kappa_{\\rm f}}{2}\\rho_{\\textbf{rf}}+i\\Delta_{\\rm fr}\\rho_{\\textbf{rf}}-i\\mathcal{G}\\rho_{\\textbf{ff}}+i \\mathcal{G}^* \\rho_{\\textbf{rr}}\n-ig \\rho_{\\textbf{ef}}, \\qquad \\label{7}\\\\\n&&  \\dot \\rho_{\\textbf{ff}} = -\\kappa_{\\rm f} \\rho_{\\textbf{ff}} -i\\mathcal{G}^*\\rho_{\\textbf{rf}}+i \\mathcal{G}\\rho_{\\textbf{fr}}.\n\\label{8}\n\n$$\nNote that $\\dot \\rho_{\\textbf{gg}} = \\kappa_{\\rm f}\n\\rho_{\\textbf{ff}}$ and\n$\\rho_{\\textbf{ee}}+\\rho_{\\textbf{rr}}+\\rho_{\\textbf{ff}}+\\rho_{\\textbf{gg}}=1$ (however, we do not use these two equations for the derivation of the\nPurcell rate).\n\nUsing the quasisteady solutions of Eqs. (<ref>)\u2013(<ref>),\ni.e. assuming $\\dot \\rho_{\\textbf{er}}=\\dot \\rho_{\\textbf{ef}}=\\dot\n\\rho_{\\textbf{rr}}=\\dot \\rho_{\\textbf{rf}}=\\dot\n\\rho_{\\textbf{ff}}=0$, we can obtain a lengthy equation for\n$\\rho_{\\textbf{er}}$, which is proportional to $\\rho_{\\textbf{ee}}$.\nIf we use the first-order expansion of this equation in the coupling\n$g$ and neglect $g^3$ terms (there is no $g^2$ contribution), then\n\u03c1_er = ig/i\u0394_rq+|\ud835\udca2|^2/(i\u0394_fq+\u03ba_f/2)   \u03c1_ee,\nwhich has the form similar to Eq. (<ref>). Substituting\nthis $\\rho_{\\textbf{er}}$ into Eq. (<ref>), we obtain the\nevolution equation $\\dot\\rho_{\\textbf{ee}}=-\\Gamma\n\\rho_{\\textbf{ee}}$ with $\\Gamma$ given exactly by Eq.(<ref>). If we do not use the above-mentioned\napproximation for the quasisteady $\\rho_{\\textbf{er}}$, then the\nresult for the Purcell rate is slightly different and much\nlengthier,\n$$\n\n&&    \\Gamma = g^2 |\\mathcal{G}|^2\\kappa_{\\rm f}  \\big[\n(\\Delta_{\\rm rq} \\Delta_{\\rm fq} -|\\mathcal G|^2)^2\n+ (\\Delta_{\\rm rq}^2 +g^2)(\\kappa_{\\rm f}/2)^2\n\\nonumber \\\\\n&& \\hspace{0.5cm}\n+g^2 (\\Delta_{\\rm fq}^2 +2\\Delta_{\\rm fq}\\Delta_{\\rm rq}\n- |\\mathcal G|^2 ) + g^4 \\big]^{-1} .\n\\label{Gamma-dm}\n$$\nThus the derivations based on the wavefunction and density matrix\nlanguages using the quasisteady-state approximation both lead to practically\nthe same result for the Purcell rate $\\Gamma$. The most physically\ntransparent result is given by Eq. (<ref>), which\ncorresponds to the semiclassical analysis in Sec. II and simply\nreplaces $\\kappa$ in Eq. (<ref>) with $\\kappa_{\\rm q}$\nseen by the qubit, in contrast to the measurement process, which is\ngoverned by $\\kappa_{\\rm r}$.\n\nAs an example, let us use the parameters similar to that in\nRef. [Unknown Author, \"Unknown Title\", ]: $\\omega_{\\rm q}/2\\pi = 5.9$ GHz,\n$\\omega_{\\rm r}/2\\pi = 6.8$ GHz, $\\omega_{\\rm f}/2\\pi = 6.75$ GHz,\n$Q_{\\rm f}=30$ (so that $\\kappa_{\\rm f}^{-1}= 0.71$ ns), $g/2\\pi=90$\nMHz, and $\\kappa_{\\rm r}^{-1}=30$ ns (so that $\\mathcal{G}/2\\pi\n=18.9$ MHz). In this case the resonator decay [Eq. (<ref>)]\nseen by the qubit is $\\kappa_{\\rm q}^{-1}=1.45\\, \\mu$s, the Purcell\nrate [Eq. (<ref>)] is $\\Gamma =1/(145\\, \\mu{\\rm s})$, and\nthe Purcell rate suppression factor [Eq. (<ref>)] is\n$F=30\\,{\\rm ns}/1.45\\, \\mu{\\rm s}=(1+0.44^2)/(1+7.6^2)=0.021$.\n\nThus, for typical parameters the bandpass Purcell filter suppresses\nthe Purcell decay by a factor of $\\sim$50. It is easy to increase\nthis factor to 100 by using $\\omega_{\\rm q}/2\\pi = 5.5$ GHz in the\nabove example; however, further decrease of the Purcell rate is not\nneeded for practical purposes, while increased resonator-qubit\ndetuning decreases the dispersive shift $2\\chi$ (in the above\nexample $2\\chi/2\\pi \\approx -3$ MHz for the qubit anharmonicity of\n180 MHz, while for $\\omega_{\\rm q}/2\\pi = 5.5$ GHz the dispersive\nshift becomes twice less).\n\nNote that for the parameters in the above example, Eq.(<ref>) overestimates the exact solution for $\\Gamma$ via\nEq. (<ref>) by 5\n(<ref>), and Eq. (<ref>) overestimates the\nPurcell rate by 2\nquadratic equation neglecting $\\lambda^3$ gives $\\Gamma$, which\noverestimates the exact solution by 22\nis practically exact ($-0.01\\%$). The inaccuracies grow for smaller\nresonator-qubit detuning (crudely as $\\Delta_{\\rm rq}^{-2}$), but\nremain reasonably small in a sufficiently wide range; for example,\nEq. (<ref>) overestimates the Purcell rate by $50\\%$ for\n$\\omega_{\\rm q}/2\\pi=6.5$ GHz, i.e. detuning of 0.3 GHz.\n\n### Nonzero readout resonator damping\nIn the quantum evolution model (<ref>) we have considered only\nthe damping of the filter resonator with the rate $\\kappa_{\\rm f}$.\nIf there is also an additional energy dissipation in the readout\nresonator with the rate $\\kappa_{\\rm r,d}$ (e.g., due to coupling\nwith the transmission line delivering the drive $\\varepsilon_{\\rm\nr}$ in Fig. (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>)), then the master equation (<ref>) should\nbe replaced with\n$$\n\\label{maN}\n\\dot \\rho=&-i[V,\\rho]+\\kappa_{\\rm f} \\left(b\\rho b^{\\dag}-b^{\\dag}b\\rho/2-\\rho b^{\\dag}b/2\\right)\\notag\\\\\n&+\\kappa_{\\rm r,d}(a\\rho a^{\\dag}-a^{\\dag}a\\rho/2-\\rho a^{\\dag}a/2).\n\n$$\nIn the wavefunction-language derivation this leads to the extra term\n$-\\kappa_{\\rm r,d}c_{\\textbf r}/2$ in Eq. (<ref>) for $\\dot\nc_{\\textbf r}$. This does not change the quasisteady value for\n$c_{\\textbf f}$ but changes the quasisteady value $c_{\\textbf\nr}=-igc_{\\textbf e}/[i\\Delta_{\\rm rq} + |\\mathcal{G}|^2\n/(i\\Delta_{\\rm fq}+\\kappa_{\\rm f}/2)+\\kappa_{\\rm r,d}/2]$, so that\nthe Purcell rate is\n$$\n\n&&    \\Gamma =2 \\, {\\rm Re} \\left[ \\frac{ g^2 } {i\\Delta_{\\rm rq} +\n|\\mathcal{G}|^2 /(i\\Delta_{\\rm fq}+\\kappa_{\\rm f}/2) +\\kappa_{\\rm\nr,d}/2} \\right] \\qquad\n\\\\\n&& \\hspace{0.5cm} \\approx \\frac{g^2(\\kappa_{\\rm q}\n+\\kappa_{\\rm r,d})}{\\Delta_{\\rm rq}^2}\n\n$$\ninstead of Eq. (<ref>). Practically the same result can be obtained\nusing the derivation via the density matrix evolution (assuming $\\kappa_{\\rm r, d}\\ll \\kappa_{\\rm f}$). As expected,\nthe dissipation $\\kappa_{\\rm r,d}$ simply adds to the rate\n$\\kappa_{\\rm q}$ seen by the qubit. Since $\\kappa_{\\rm r,d}$ is not\naffected by the filter, it adds in the same way to the bandwidth\n$\\kappa_{\\rm r}$ governing the qubit measurement process and thus\ndeteriorates the Purcell rate suppression (<ref>), replacing it\nwith $F=(\\kappa_{\\rm q}+\\kappa_{\\rm r,d})/(\\kappa_{\\rm r}\n+\\kappa_{\\rm r,d})$.\n\n## Purcell rate with microwave drive and bandpass filter\nThe Purcell rate may decrease when the measurement microwave drive is added [Unknown Author, \"Unknown Title\", ]. A simple physical reason is the ac Stark shift, which in the typical setup increases the absolute value of detuning between the qubit and readout resonator with increasing number of photons in the resonator, thus reducing the Purcell rate. However, this explanation may not necessarily work well quantitatively.\n\nThe Purcell rate suppression due to the microwave drive was analyzed\nin Ref. [Unknown Author, \"Unknown Title\", ] for the case without the Purcell filter and\nusing the two-level approximation for the qubit. It was shown that\nin this case the suppression factor $\\Gamma (\\bar{n})/\\Gamma (0)$ is\napproximately $[(1+\\bar{n}/n_{\\rm crit})^{-1/2}+(1+\\bar{n}/n_{\\rm\ncrit})^{-1}]^2$ instead of the factor $(1+\\bar{n}/n_{\\rm\ncrit})^{-1}$ expected from the ac Stark shift, where $\\bar{n}$ is\nthe mean number of photons in the resonator and $n_{\\rm crit}\\equiv\n(\\Delta_{\\rm rq}/2g)^2$. This difference results in the ratio $3/2$\nbetween the corresponding slopes of $\\Gamma (\\bar{n})$ at small\n$\\bar{n}$, with the ac Stark shift model underestimating the Purcell\nrate suppression (see the blue lines in Fig. (Figure: Purcell relaxation time versus qubit-resonator detuning  for g/2\u03c0=86MHz)). However, when the third level of the qubit is taken into account, then the ac Stark shift model describes correctly the slope of $\\Gamma (\\bar{n})$ at small $\\bar{n}$  when the qubit anharmonicity is relatively small, $|\\delta_{\\rm q}/\\Delta_{\\rm rq}| \\ll 1$ (see Appendix). In this case the ac Stark shift model predicts $\\Gamma\n(\\bar{n})/\\Gamma (0)=1+4 \\bar{n}\\chi (0) /\\Delta_{\\rm rq}$ at\n$\\bar{n}\\ll n_{\\rm crit}$, where $\\chi (0)$ is the value of $\\chi$ at $\\bar{n}=0$; note that $|\\chi (0)| \\ll |g^2/\\Delta_{\\rm rq}|$ and $\\chi (0) <0$ when\n$\\Delta_{\\rm rq}> 0$.\n\nWith the filter resonator, we also expect that the ac Stark shift\nmodel for the Purcell rate suppression should work reasonably well,\nso that from Eq. (<ref>) we expect\n\u0393(n\u0305) \u2248g^2 |\ud835\udca2|^2\u03ba_f/[\u03c9_r-\u03c9_q,eff (n\u0305)]^2\n{[\u03c9_f-\u03c9_q,eff (n\u0305)]^2 +(\u03ba_f/2)^2} ,\nwhere $\\omega_{\\rm q,eff} (\\bar{n})$ is the effective qubit frequency, $\\omega_{\\rm q,eff} (\\bar{n})=\\omega_{\\rm q}^{\\rm b}+2\\chi (0) \\bar{n}$ if\nwe neglect dependence of $\\chi$ on $\\bar{n}$ and the \u201cLamb shift\u201d.\nTherefore, in a typical situation when $|\\omega_{\\rm f} - \\omega_{\\rm r}| \\ll |\\omega_{\\rm r} - \\omega_{\\rm q}|$ and $\\kappa_{\\rm f} \\ll |\\omega_{\\rm r} - \\omega_{\\rm q}|$, we expect the suppression ratio\n\u0393(n\u0305)/\u0393(0) \u2248[\u03c9_r-\u03c9_q^b/\u03c9_r-\u03c9_q,eff (n\u0305) ]^4 .\n\n< g r a p h i c s >\n\nThe Purcell relaxation rate $\\Gamma (\\bar{n})$ with a microwave drive,\nnormalized by the no-drive rate $\\Gamma(0)$, with the filter (red solid curve) and without the filter (blue solid curve), as functions of the mean number of photons $\\bar n$ in the readout resonator. The numerical simulations used the two-level approximation for the qubit, for which $\\bar{n}/|\\Delta_{\\rm rq}/\\chi (0)|=\\bar{n}/4n_{\\rm crit}$. The dashed lines show the values expected from the model based on the ac Stark shift: $\\Gamma ({\\bar n})/\\Gamma (0)=(1+{\\bar n}/n_{\\rm crit})^{-2}$ with the filter and $(1+{\\bar n}/n_{\\rm crit})^{-1}$ without the filter. The parameters used in the simulations are given in the text.\n\nTo check the accuracy of this formula numerically, we need to add into the Hamiltonian (<ref>) the terms describing the drive and higher levels in the qubit (see Appendix). However, the resulting Hilbert space was too large for our numerical simulations, so we numerically calculated $\\Gamma (\\bar{n})$ using only the two-level approximation for the qubit. Using the rotating frame based on the drive frequency $\\omega_{\\rm d}$ [i.e., $H_0=\\omega_{\\rm d}(\\sigma_+\\sigma_- +a^\\dagger a+ b^\\dagger b)$], we then obtain the interaction Hamiltonian\n$$\n\\label{h}\nV_{\\rm d}&=\\Delta_{\\rm rd}a^{\\dag}a+\\Delta_{\\rm fd}b^{\\dag}b+ \\Delta_{\\rm qd} \\sigma_+\\sigma_- +\\textit{g}(a^{\\dag}\\sigma_{-}+a\\sigma_{+})\\notag\\\\\n&+\\mathcal{G}a^{\\dag}b+ \\mathcal{G}^*ab^{\\dag} +\\varepsilon_{\\rm r} a^{\\dag}\n+ \\varepsilon_{\\rm r}^* a,\n\n$$\nwhere $\\Delta_{\\rm rd}=\\omega_{\\rm r}^{\\rm b}-\\omega_{\\rm d}$,  $\\Delta_{\\rm fd}=\\omega_{\\rm f}-\\omega_{\\rm d}$, $\\Delta_{\\rm qd}=\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm d}$, and for simplicity we assumed that the drive $\\varepsilon_{\\rm r}$\nis applied to the readout resonator. (For the rotating wave approximation we also need to assume that $|\\Delta_{\\rm rd}|$, $|\\Delta_{\\rm fd}|$, $|\\Delta_{\\rm qd}|$, $|g|$, $|\\mathcal{G}|$, and $|\\dot{\\varepsilon_{\\rm r}}/\\varepsilon_{\\rm r}|$ are all small compared with $\\omega_{\\rm d}$.) Note that in the two-level\napproximation $[\\omega_{\\rm r}-\\omega_{\\rm q,eff} (\\bar{n}) ]^2\n=\\Delta_{\\rm rq}^2+4g^2\\bar{n}=\\Delta_{\\rm rq}^2 (1+\\bar{n}/n_{\\rm\ncrit})$.\n\nWe have numerically solved the full master equation with the\nHamiltonian (<ref>), including the decay $\\kappa_{\\rm f}$ of the\nfilter resonator. As the initial state we use the excited state for\nthe qubit and vacuum for the two resonators, $|\\psi\\rangle_{\\rm\nin}=|e00\\rangle$. The Purcell rate is extracted from the numerical\nsolution of $\\rho_{ee}(t)$ by fitting $-\\ln[\\rho_{ee}(t)]$ with a\nlinear function in the long time limit (still requiring $1-\\rho_{ee}(t)\\ll 1$). In the simulations we pump\nthe readout resonator with the frequency $\\omega_{\\rm d}=\\omega_{\\rm\nr}^{|e\\rangle}$ and control $\\bar{n}$ by\nchoosing the corresponding value of $\\varepsilon_{\\rm r}$. The value of $\\bar{n}$ is calculated numerically; it is close to what is expected from the solution of the classical field equations when the $n$-dependence of $\\chi$ and $\\omega_{\\rm r}^{|e\\rangle}$ is taken into account: in the two-level approximation $\\chi({\\bar n})=-g^2/[\\Delta_{\\rm rq}\\sqrt{1+4g^2{\\bar n}/\\Delta_{\\rm rq}^2}]$ and $\\omega_{\\rm r}^{|e\\rangle}=\\omega_{\\rm r}^{\\rm b}+\\chi ({\\bar n})$. Since $\\omega_{\\rm r}^{|e\\rangle}$ changes with $\\bar n$, we change $\\omega_{\\rm d}$ accordingly.\n\nThe red solid line in Fig.  (Figure: Purcell relaxation time versus qubit-resonator detuning  for g/2\u03c0=86MHz) shows the numerical results for the Purcell rate suppression factor $\\Gamma (\\bar{n})/\\Gamma (0)$ as a function of $\\bar n=\\bar{n}^{|e\\rangle}$, normalized by $|\\Delta_{\\rm rq}/\\chi(0)|$. Note that in the two-level approximation (which we used in the simulations) ${\\bar n}/|\\Delta_{\\rm rq}/\\chi(0)|={\\bar n}/4n_{\\rm crit}$. In the simulations we have used $g/2\\pi=100\\,$MHz, $\\kappa_{\\rm r}^{-1}=36\\,$ns, $\\kappa_{\\rm f}^{-1}=0.71\\,$ns, $\\omega_{\\rm r}^{\\rm b}/2\\pi=\\omega_{\\rm f}/2\\pi=6.8\\,$GHz,\nand $\\omega_{\\rm q}^{\\rm b}/2\\pi=6\\,$GHz. The blue solid line shows the numerical suppression factor for the standard setup [Unknown Author, \"Unknown Title\", ] (without the filter resonator), also in the two-level approximation for the qubit. We see a larger suppression for the case with the filter, as expected from\nthe ac Stark shift interpretation and the fact that $\\Gamma \\propto \\Delta_{\\rm rq}^{-4}$ with the filter, while $\\Gamma \\propto \\Delta_{\\rm rq}^{-2}$ in the standard setup.\nHowever, comparison with the prediction of the ac Stark shift model (dashed lines) does not show a quantitative agreement. There is about 10\n\nNote that the numerical calculations have been made using only the two-level model for the qubit. It is possible that the agreement between the ac Stark shift model and the numerical results is much better if three or more levels in the qubit are taken into account. This is an interesting question for further research.\n\nAlso note that in experiments, increase of the drive power often leads to decrease of the qubit lifetime, instead of the increase, predicted by our analysis (both with and without the filter). The reason for this effect is not quite clear and may be related to various technical issues. Therefore, either suppression or enhancement of the qubit relaxation with the drive power may be observed in actual experiments.\n\n## Conclusion\nIn this paper we have discussed the theory of the bandpass Purcell filter used in Refs. [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] for measurement of superconducting qubits. An additional wide-bandwidth filter resonator (Fig. (Figure: Qubit measurement schematic with the bandpass Purcell\nfilter  of Ref. <cit.>)) coupled to the readout resonator easily passes the microwave field used for the qubit measurement, but strongly impedes the propagation of a photon at the qubit frequency, which is far outside of the filter bandwidth. A simple way to quantitatively describe the operation of the filter is by noticing that the effective decay rate $\\kappa_{\\rm eff}$ of the readout resonator [Eq. (<ref>)] depends on frequency. Therefore, the measurement is governed by a relatively large value $\\kappa_{\\rm r}$ [Eq. (<ref>)], which permits a fast measurement, while the Purcell relaxation is determined by a much smaller value $\\kappa_{\\rm q}$ seen by the qubit [Eq. (<ref>)]. The ratio of these effective decay rates of the readout resonator gives the suppression factor for the qubit relaxation [Eq. (<ref>)]. The result for the suppression factor is similar to the result obtained in Ref. [Unknown Author, \"Unknown Title\", ] using circuit theory (with a few minor differences).\n\nWe have first analyzed the operation of the Purcell filter quasiclassically, and then confirmed the results using the quantum approach. In the quantum analysis we have used two approaches: based on decaying wavefunction and density matrix evolutions. While the Purcell effect is traditionally described using density matrices, it is actually simpler to use the approach based on wavefunctions. The results of our semiclassical and two quantum approaches are very close to each other; however, they are not identical because the approaches use slightly different approximations. A simple and most physically transparent result for the Purcell rate is given by Eq. (<ref>).\n\nThe Purcell rate of the qubit decay is further suppressed when a microwave drive is applied for measurement. The effect is similar to what was discussed in Ref. [Unknown Author, \"Unknown Title\", ] for the standard setup without the filter, and can be crudely understood as being due to the ac Stark shift of the qubit frequency, which increases the resonator-qubit detuning $\\Delta_{\\rm rq}$. Since the Purcell rate with the filter scales with $\\Delta_{\\rm rq}$ crudely as $\\Delta_{\\rm rq}^{-4}$   [Eq. (<ref>)] instead of $\\Delta_{\\rm rq}^{-2}$ in the standard setup, the Purcell rate suppression due to microwaves is stronger in the case with the filter. Numerical results for the suppression due to microwaves using the two-level approximation for the qubit show that the explanation based on ac Stark shift works well, but underestimates the effect by about 10\n\nThe bandpass Purcell filter decreases the qubit decay due to the Purcell effect by a factor of $\\sim$50 for typical parameters, for the same measurement conditions as in the standard setup without the filter. This allows much faster and more accurate measurement of superconducting qubits, compared to the case without the filter. The qubit measurement within 140 ns with 99\n\nThe authors thank Daniel Sank,  Mostafa Khezri, and Justin Dressel for useful discussions.\nThe research was funded by the\nOffice of the Director of National Intelligence (ODNI), Intelligence\nAdvanced Research Projects Activity (IARPA), through the Army\nResearch Office Grant No. W911NF-10-1-0334. All statements of fact,\nopinion or conclusions contained herein are those of the authors and\nshould not be construed as representing the official views or\npolicies of IARPA, the ODNI, or the U.S. Government. We also\nacknowledge support from the ARO MURI Grant No. W911NF-11-1-0268.\n\n## Qubit measurement and Purcell effect in the standard setup\nIn this Appendix we review the trade-off between the Purcell rate\nand measurement time for a transmon or Xmon qubit in the standard\ncQED setup (without a filter).  In the standard setup\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (Fig. (Figure: Schematic of a standard circuit QED qubit readout setup. The qubit state slightly changes the resonator frequency \u03c9_ r)) the qubit is\ndispersively coupled with the resonator, so that the qubit state\nslightly changes the resonator frequency. This change causes a phase\nshift (and in general an amplitude change) of a microwave field\ntransmitted through or reflected from the resonator. The transmitted\nor reflected microwave is then amplified and sent to a mixer, so\nthat the phase shift (and amplitude change) can be discriminated,\nthus distinguishing the states $|g\\rangle$ and $|e\\rangle$ of the\nqubit.\n\n### Basic theory\nFor the basic analysis of measurement [Unknown Author, \"Unknown Title\", ], it is\nsufficient to consider three energy levels of the qubit: the ground\nstate $|g\\rangle$, the first excited state $|e\\rangle$, and the\nsecond excited state $|f\\rangle$, so that the Hamiltonian is\n($\\hbar=1$)\n$$\n\nH & =  \\omega_{\\rm q}^{\\rm b} |e\\rangle \\langle e| +\n(2\\omega_{\\rm q}^{\\rm b}-\\delta_{\\rm q}) |f\\rangle \\langle f| +\n\\omega_{\\rm r}^{\\rm b} a^{\\dag}a\n\\nonumber \\\\\n& + g a^{\\dag}|g\\rangle\\langle e| +g^* a |g\\rangle\\langle e|\n+ \\tilde{g} a^{\\dag}|e\\rangle\\langle f| +\n\\tilde{g}^* a |f\\rangle\\langle e|\n\\notag\\\\\n&+\\varepsilon_{\\rm r} a^\\dagger e^{-i\\omega_{\\rm d}t}+\\varepsilon_{\\rm r}^*\na e^{i\\omega_{\\rm d}t}+H_{\\kappa}+H_{\\gamma},\n\\label{H-standadr-init}\n$$\nwhere $\\omega_{\\rm q}^{\\rm b}$ is the bare qubit frequency,\n$\\delta_{\\rm q}$ is its ahnarmononicity ($\\delta_{\\rm q}>0$,\n$\\delta_{\\rm q}/ \\omega_{\\rm q}^{\\rm b} \\sim 0.2\\, {\\rm GHz}/6\\,\n{\\rm GHz}\\ll 1$), $\\omega_{\\rm r}^{\\rm b}$ is the bare resonator\nfrequency, $a$ is the annihilation operator for the resonator, $g$\nis the coupling between the qubit and the resonator,\n$\\tilde{g}\\approx \\sqrt{2}\\,g$ is the similar coupling involving\nlevels $|e\\rangle$ and $|f\\rangle$, and $\\varepsilon_{\\rm r}$ is the\nnormalized amplitude of the microwave drive with frequency\n$\\omega_{\\rm d}$. For brevity $H_{\\kappa}$ describes the coupling of\nthe resonator with the transmission line, which causes resonator\nenergy damping with the rate $\\kappa$, while $H_\\gamma$ describes\nthe intrinsic qubit relaxation (excluding the Purcell effect) with\nthe rate $T_{1,\\rm int}^{-1}$. Note that in the Hamiltonian\n(<ref>) we neglected the coupling terms creating or\nannihilating the double excitations in the qubit and the resonator.\nFor simplicity we assume a real coupling: $g^*=g$ and\n$\\tilde{g}^*=\\tilde{g}$.\n\nFor a simple analysis of the measurement process, let us first\nneglect $H_\\kappa$, $H_\\gamma$, and the drive $\\varepsilon_r$, and\nconsider the three Jaynes-Cummings ladders of states\n$|g,n\\rangle$, $|e,n\\rangle$, and $|f,n\\rangle$, where $n$ denotes\nthe number of photons in the resonator. The coupling $g$ provides\nthe level repulsion between $|g,n+1\\rangle$ and $|e,n\\rangle$\n(effective coupling is $\\sqrt{n+1}\\, g$), while $\\tilde{g}$ provides\nthe level repulsion between $|e,n+1\\rangle$ and $|f,n\\rangle$ (with\ncoupling $\\sqrt{n+1}\\, \\tilde{g}$). Assuming sufficiently large level\nseparation, $|\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm r}^{\\rm b} |\\gg\n\\sqrt{n} \\, |g|$ and $|\\omega_{\\rm q}^{\\rm b}-\\delta_{\\rm q}\n-\\omega_{\\rm r}^{\\rm b}| \\gg \\sqrt{n} \\, |\\tilde{g}|$, we can treat\nthe level repulsion to lowest order; then the energies of the\neigenstates $\\overline{|g,n\\rangle}$ and $\\overline{|e,n\\rangle}$\nare\n$$\n\n&    E_{\\overline{|g,n\\rangle}}= n\\omega_{\\rm r}^{\\rm b} -  \\,\n\\frac{n g^2}{\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm r}^{\\rm b}},\n\\label{eigenenergy-g}\\\\\n& E_{\\overline{|e,n\\rangle}}=\n\\omega_{\\rm q}^{\\rm b }+ n\\omega_{\\rm r}^{\\rm b} + \\, \\frac{(n+1)\\,\ng^2}{\\omega_{\\rm q}^{\\rm b}-\\omega_{\\rm r}^{\\rm b}} -\n\\frac{n\\tilde{g}^2}{\\omega_{\\rm q}^{\\rm b} -\\delta_{\\rm\nq}-\\omega_{\\rm r}^{\\rm b}}.\n\\label{eigenenergy-e}\n$$\nTherefore the effective resonator frequency $\\omega_{\\rm\nr}^{|g\\rangle}$ when the qubit in the ground state is\n\u03c9_r^|g\u27e9 = E_|g,n+1\u27e9 - E_|g,n\u27e9\n= \u03c9_r^b - g^2/\u0394,\nwhere\n\u0394=\u0394_qr=\u03c9_q^b-\u03c9_r^b,\nwhile for the qubit state $|e\\rangle$ the effective resonator\nfrequency is\n\u03c9_r^|e\u27e9 = E_|e,n+1\u27e9   -\nE_|e,n\u27e9\n= \u03c9_r^b + g^2/\u0394 -\ng\u0303^2/\u0394- \u03b4_q.\nDenoting the frequency difference by $2\\chi$, we obtain\n$$\n\n&& \\hspace{2cm}  \\omega_{\\rm r}^{|e\\rangle}-  \\omega_{\\rm r}^{|g\\rangle} = 2\\chi,\n\\,\\,\\,\n\\label{chi-def}\\\\\n&&  \\chi = \\frac{g^2}{\\Delta} -\n\\frac{\\tilde{g}^2/2}{\\Delta-\\delta_{\\rm q}} =-\\frac{g^2\\delta_{\\rm q}}{\\Delta (\\Delta-\\delta_{\\rm q})} + \\frac{g^2-\\tilde{g}^2/2}{\\Delta-\\delta_{\\rm q}}. \\qquad\n\\label{chi-res}\n$$\nThe corresponding effective qubit frequency is\n\u03c9_q^eff  = E_|e,n\u27e9 -\nE_|g,n\u27e9\n= \u03c9_q^b\n+   g^2/\u0394 +2n\u03c7,\nwhich includes the \u201cLamb shift\u201d $g^2/\\Delta$ and the \u201cac Stark\nshift\u201d $2n\\chi$.\n\nTherefore, in this case the first two lines of the Hamiltonian\n(<ref>) can be approximated as\nH = \u03c9_q/2   \u03c3_z + \u03c9_r a^\u2020a +\n\u03c7a^\u2020a   \u03c3_z,\nwhere\n\u03c9_q=\u03c9_q^b+g^2/\u0394,\n\u03c9_r= \u03c9_r^b- 1/2\ng\u0303^2/\u0394- \u03b4_q,\n$\\sigma_z=|e\\rangle\\langle e|-|g\\rangle\\langle g|$, we shifted the\nenergy by $-\\omega_{\\rm q}/2$, and we no longer need the qubit state\n$|f\\rangle$.\n\nNote that the dispersive coupling $\\chi$ given by Eq.(<ref>) is much smaller [Unknown Author, \"Unknown Title\", ] than the value\n$g^2/\\Delta$ expected in the two-level case. This is because the\ntransmon and Xmon qubits are only slightly different from a linear\noscillator, for which $\\tilde{g}=\\sqrt{2}\\, g$ and $\\delta_{\\rm\nq}=0$, thus leading to $\\chi=0$. The effect of nonzero anharmonicity $\\delta_{\\rm\nq}$ in Eq. (<ref>) is more important than the effect of nonzero\n$\\tilde{g}-\\sqrt{2}\\, g$ because\ng\u0303^2/2-g^2 \u2248- g^2 \u03b4_q/\u03c9_q^b\nand $|\\Delta|\\ll\n\\omega_{\\rm q}^{\\rm b}$. Therefore $\\chi$ can be approximated as\n\u03c7\u2248-g^2\u03b4_q/\u0394(\u0394-\u03b4_q) \u2248- g^2 \u03b4_q/\u0394^2,\nwhere the last formula also assumes $|\\Delta| \\gg \\delta_{\\rm q}$.\n\nThe dispersive approximation (<ref>) is based on the\napproximate formulas (<ref>)\u2013(<ref>)\nfor the eigenenergies, and therefore requires a limited number of\nphotons $n$ in the resonator,\nn \u226amin(n_crit, \u00f1_crit),\nn_crit =\u0394^2/4g^2,\n\u00f1_crit =(\u0394-\u03b4_q)^2/4g\u0303^2,\nwhere the factor 4 in the definitions of the critical photon numbers\n$n_{\\rm crit}$ and $\\tilde{n}_{\\rm crit}$ is a usual convention. For\n$n$ beyond this range it is still possible (at least to some extent)\nto use the dispersive approximation (<ref>) if the spread of\n$n$ is relatively small; however $\\omega_{\\rm q}$, $\\omega_{\\rm r}$,\nand $\\chi$ should be redefined. For that we need to use similar\nsteps as in Eqs. (<ref>)\u2013(<ref>), but\nstarting with more accurate formulas than (<ref>) and\n(<ref>). In particular, in the two-level approximation\nfor the qubit ($\\tilde{g}=0$ or $\\delta_{\\rm q}=\\infty$) we would\nobtain $\\chi \\approx g^2/\\sqrt{\\Delta^2+4\\bar{n}g^2}$ with $\\bar{n}$\nbeing the average (typical) number of photons; however,\nthe generalization of the realistic case (<ref>) is not so\nsimple (see below).\n\nThe dispersive approximation (<ref>) cannot reproduce the\nPurcell effect [Unknown Author, \"Unknown Title\", ] after including the last line of the\nHamiltonian (<ref>), so it should be added\nseparately. Without the microwave drive ($\\varepsilon_{\\rm r}=0$)\nonly levels $|e,0\\rangle$, $|g,1\\rangle$ and $|g,0\\rangle$ are\ninvolved into the evolution described by Eq.(<ref>), and for sufficiently small resonator\nbandwidth, $\\kappa \\ll \\sqrt{\\Delta^2+4g^2}$, the qubit relaxation\nrate due to Purcell effect is\n\u0393\u2248\u03ba/2 ( 1-\n|\u0394|/\u221a(\u0394^2+4g^2) ) \u2248g^2 \u03ba/\u0394^2.\nNote that this rate does not depend on the qubit anharmonicity\n$\\delta_{\\rm q}$, in contrast to the dispersive coupling $\\chi$,\nwhich vanishes at $\\delta_{\\rm q} \\rightarrow 0$. This is because\nthe Purcell effect is essentially a linear effect (energy decay via\ndecay of a coupled system), in contrast to $\\chi$, which is based on\nqubit nonlinearity. This linearity is the reason why the Purcell\nrate $\\Gamma$ does not change (in the first approximation) when the\nmicrowave drive $\\varepsilon_{\\rm r}$ creates a significant photon\npopulation in the resonator, $1\\ll n \\ll \\min (n_{\\rm crit},\n\\tilde{n}_{\\rm crit})$. (Someone might naively expect that $\\Gamma$\nscales with $n$ because of effective coupling $\\sqrt{n}\\, g$.)\nHowever, in the next approximation $\\Gamma$ depends on $n$\n[Unknown Author, \"Unknown Title\", ] and can be calculated as\n\u0393(n) = \u03ba  |\u27e8g, n| a\n|e,n\u27e9|^2,\nwith subsequent replacement of $n$ with the average photon number\n$\\bar{n}$ if the spread of $n$ is relatively small.\n\nUsing the third-order (in $g$ and/or $\\tilde{g}$) eigenstates,\n$$\n\n&    \\overline{|g,n\\rangle } = \\left( 1-\\frac{n\ng^2}{2\\Delta^2}\\right) |g,n\\rangle +\\frac{\\sqrt{n(n-1)}\\, g\n\\tilde{g}}{\\Delta(2\\Delta-\\delta_{\\rm q})} \\, |f,n-2\\rangle\n\\nonumber \\\\\n& \\hspace{0.5cm}   -\\frac{\\sqrt{n}\\, g}{\\Delta} \\left( 1-\\frac{3n g^2}{2\\Delta^2} + \\frac{(n-1)\\tilde{g}^2}{\\Delta(2\\Delta-\\delta_{\\rm q})}\\right)  |e,n-1\\rangle ,\n\\label{g,n-eigen}\\\\\n& \\overline{|e,n\\rangle } \\approx \\left( 1-\\frac{(n+1) g^2}{2\\Delta^2}\n-\\frac{n \\tilde{g}^2}{2(\\Delta-\\delta_{\\rm q})^2}\\right) |e,n\\rangle\n\\nonumber \\\\\n& \\hspace{0.5cm} + \\frac{\\sqrt{n+1}\\, g}{\\Delta} \\left( 1- \\frac{3(n+1) g^2}{2\\Delta^2} +\\frac{n\\tilde{g}^2 (\\Delta-2\\delta_{\\rm q})}{2\\Delta (\\Delta-\\delta_{\\rm q})^2} \\right)\n\\nonumber \\\\\n& \\hspace{0.5cm} \\times  |g,n+1\\rangle\n-  \\frac{\\sqrt{n}\\, \\tilde{g}}{\\Delta-\\delta_{\\rm q}} \\,\n|f,n-1\\rangle ,\n\\label{e,n-eigen}\n$$\nwhere the last term in Eq. (<ref>) for brevity is only of the first order, we find the Purcell rate\n\u0393(n) = \u03bag^2/\u0394^2 (1- 3g^2/\u0394^2\n-6 n g^2/\u0394^2 +n g\u0303^2 (3\u0394-4\u03b4_q)/\u0394(\u0394-\u03b4_q)^2 )  ,\nwhich is an approximation up to 5th order in $g$. This result\ncoincides with the result of Ref. [Unknown Author, \"Unknown Title\", ] when $\\tilde{g}=0$.\nApproximating $\\tilde{g}=\\sqrt{2}\\, g$ [see Eq.(<ref>)], we obtain\n\u0393(n) \u2248\u03bag^2/\u0394^2 (\n1- 3g^2/\u0394^2\n+ n   2g^2 \u03b4_q (2\u0394-3\u03b4_q)/\u0394^2 (\u0394-\u03b4_q)^2 ) .\nIt is interesting to note that while in the two-level approximation\n($\\tilde{g}=0$) the Purcell rate is always suppressed with increasing\n$n$ [Unknown Author, \"Unknown Title\", ], Eq. (<ref>) shows the suppression only\nwhen $\\Delta < (3/2)\\delta_{\\rm q}$ (which is the usual experimental\ncase, since $\\Delta$ is usually negative). Numerical results using\nEq. (<ref>) show that even when $\\Gamma(n)$ initially\nincreases with $n$, it is still suppressed at larger $n$. Note that the result (<ref>) requires\nassumption (<ref>) of a sufficiently small nonlinearity.\nComparing Eqs. (<ref>) and (<ref>), we see\nthat in the case of large detuning, $|\\Delta|\\gg \\delta_{\\rm q}$,\nthe dependence of the Purcell rate on $n$ is consistent with the\nexplanation based on the ac Stark shift, $\\Gamma (n)\\approx \\kappa\ng^2/ (\\Delta +2n \\chi)^2$. (This is in contrast to the two-level\napproximation, in which this explanation leads to a discrepancy\nin the slope [Unknown Author, \"Unknown Title\", ] by a factor of $3/2$.) We have checked that taking into account the fourth level in the qubit does not change Eqs. (<ref>) and (<ref>); there are no additional contributions of the order $g^4$.\n\nBesides the qubit energy relaxation $\\Gamma$, the resonator damping\n$\\kappa$ in the presence of drive leads to the qubit excitation [Unknown Author, \"Unknown Title\", ]\n$|g\\rangle \\rightarrow |e\\rangle$ with the rate $\\Gamma_{|g\\rangle \\rightarrow |e\\rangle}=\\kappa \\,\n|\\overline{\\langle e, n-2|} a \\overline{|g,n\\rangle }|^2$ and the\nexcitation $|e\\rangle \\rightarrow |f\\rangle$ with the rate $\\Gamma_{|e\\rangle \\rightarrow |f\\rangle}=\\kappa\n\\, |\\overline{\\langle f, n-2|} a \\overline{|e,n\\rangle }|^2$. These\nrates (up to sixth order in coupling) are\n$$\n\n&& \\Gamma_{|g\\rangle\\rightarrow|e\\rangle}= \\frac{\\kappa g^2n(n-1)}{\\Delta^2}\\left[\\frac{g^2}{\\Delta^2}-\\frac{\\tilde g^2}{\\Delta(2\\Delta-\\delta_{\\rm q})}\\right]^2 \\qquad\n\\\\\n&& \\hspace{1.3cm} \\approx  \\frac{\\kappa g^2}{\\Delta^2}\\left( \\frac{n}{n_{\\rm crit}}\\right )^2\\frac{\\delta_{\\rm q}^2}{16 \\, (2\\Delta-\\delta_{\\rm q})^2} ,\n\\label{Gamma-g-e-2}\n$$\n$$\n\n&& \\hspace{-0.0cm} \\Gamma_{|e\\rangle\\rightarrow|f\\rangle}= \\frac{\\kappa \\tilde g^2n(n-1)}{(\\Delta-\\delta_{\\rm q})^4}\\left[ \\frac{\\tilde g^2}{\\Delta-\\delta_{\\rm q}}-\\frac{g^2}{2\\Delta-\\delta_{\\rm q}} \\right.  \\,\\,\\,\n\\nonumber \\\\\n&& \\hspace{1.4cm}  \\left. -\\frac{\\tilde{\\tilde g}^2}{2\\Delta-3\\delta_{\\rm q}}\\right]^2\n\\\\\n&&   \\hspace{0.8cm} \\approx  \\frac{\\kappa g^2}{\\Delta^2}\\frac{ ( n/n_{\\rm crit})^2 \\, \\delta_{\\rm q}^2 \\Delta^8}{ 2(\\Delta-\\delta_{\\rm q})^6(2\\Delta-\\delta_{\\rm q})^2(2\\Delta-3\\delta_{\\rm q})^2},  \\qquad \\,\\,\\,\\,\n\\label{Gamma-e-f-2}\n$$\nwhere $\\tilde{\\tilde g}\\approx \\sqrt{3}\\, g$ is the coupling due to the fourth qubit level with energy $3\\omega_{\\rm q}^{\\rm b}-3\\delta_{\\rm q}$, and in Eqs. (<ref>) and (<ref>) we also used $\\tilde g=\\sqrt{2}\\, g$  and replaced $n(n-1)$ with $n^2$.\nIn the assumed range, $n\\ll n_{\\rm crit}$, the excitation rates are much smaller than the Purcell decay rate $\\Gamma$.\n\nNow let us discuss the $n$-dependence of the dispersive coupling $\\chi(n)=[\\omega_{\\rm r}^{| e\\rangle}(n)-\\omega_{\\rm r}^{|g\\rangle}(n)]/2$, where $\\omega_{\\rm r}^{| g\\rangle}(n)=E_{\\overline{|g,n+1\\rangle}} \\, - E_{\\overline{|g,n\\rangle}}$ and $\\omega_{\\rm r}^{| e\\rangle}(n)=E_{\\overline{|e,n+1\\rangle}} \\, - E_{\\overline{|e,n\\rangle}}$ [see Eqs. (<ref>), (<ref>), and (<ref>)]. Using the three-level approximation for the qubit with accuracy up to the fourth order in $g$ and/or $\\tilde g$ (assuming $n\\ll n_{\\rm crit}$), we obtain\n$$\n\n&&    \\omega_{\\rm r}^{|g\\rangle}(n)= -\\frac{g^2}{\\Delta }+\\frac{g^4 (2 n+1)}{\\Delta ^3}-\\frac{2 g^2 \\tilde g^2 n}{\\Delta ^2 (2 \\Delta -\\delta_{\\rm q} )},\n\\label{omega-r-g-3lev}\\\\\n&& \\omega_{\\rm r}^{|e\\rangle}(n) = \\frac{g^2}{\\Delta }\n-\\frac{\\tilde g^2}{\\Delta -\\delta_{\\rm q} }\n-\\frac{g^4 (2 n+3)}{\\Delta ^3}\n+\\frac{\\tilde g^4 (2 n+1)}{(\\Delta -\\delta_{\\rm q} )^3} \\qquad\n\\nonumber \\\\\n&& \\hspace{1.3cm}    -\\frac{2 \\delta_{\\rm q}  g^2 \\tilde g^2 (n+1)}{\\Delta ^2 (\\Delta -\\delta_{\\rm q} )^2},\n\\label{omega-r-e-3lev}\n$$\nso that assuming $\\tilde{g}=\\sqrt{2}\\, g$, we obtain\n$$\n\n&&    \\chi(n)\\approx -\\frac{g^2\\delta_{\\rm q}}{\\Delta (\\Delta-\\delta_{\\rm q})}\n+\\frac{4g^4\\delta_{\\rm q}}{\\Delta^4} \\, \\frac{1-\\tilde\\delta_{\\rm q}+\\tilde\\delta_{\\rm q}^2/2}{(1-\\tilde\\delta_{\\rm q})^3}\n\\nonumber \\\\\n&& \\hspace{1.2cm} +\n\\frac{3ng^4}{\\Delta^3} \\, \\frac{1-\\tilde\\delta_{\\rm q}^2+\\tilde\\delta_{\\rm q}^3-\\tilde\\delta_{\\rm q}^4/3}{(1-\\tilde\\delta_{\\rm q}/2)(1-\\tilde\\delta_{\\rm q})^3},\n\\label{chi(n)-3}\n$$\nwhere $\\tilde\\delta_{\\rm q}=\\delta_{\\rm q}/\\Delta$. This result predicts a quite strong $n$-dependence of $\\chi$, which is, however, not correct. The reason is that it is not sufficient to consider three qubit levels for $\\chi(n)$. When the\nfourth level of the qubit is taken into account (with energy $3\\omega_{\\rm q}^{\\rm b}-3\\delta_{\\rm q}$ and coupling $\\tilde{\\tilde g}$), this does not change Eq. (<ref>) for $\\omega_{\\rm r}^{|g\\rangle}(n)$, but introduces an additional term\n-2g\u0303^2g\u0303\u0303\u0303^2 n/(\u0394-\u03b4_q)^2(2\u0394-3\u03b4_q)\ninto Eq. (<ref>) for $\\omega_{\\rm r}^{|e\\rangle}(n)$. Assuming $\\tilde{\\tilde g}= \\sqrt{3}\\, g$, this changes Eq. (<ref>) into\n$$\n\n&&    \\chi(n)\\approx -\\frac{g^2\\delta_{\\rm q}}{\\Delta (\\Delta-\\delta_{\\rm q})}\n+\\frac{4g^4\\delta_{\\rm q}}{\\Delta^4} \\, \\frac{1-\\tilde\\delta_{\\rm q}+\\tilde\\delta_{\\rm q}^2/2}{(1-\\tilde\\delta_{\\rm q})^3}\n\\nonumber \\\\\n&&  \\hspace{0.5cm} -\n\\frac{9ng^4\\delta_{\\rm q}^2}{2\\Delta^5} \\, \\frac{1-(5/3)\\tilde\\delta_{\\rm q}+(11/9)\\tilde\\delta_{\\rm q}^2-\\tilde\\delta_{\\rm q}^3/3}{(1-\\tilde\\delta_{\\rm q}/2)(1-\\tilde\\delta_{\\rm q})^3(1-3\\tilde\\delta_{\\rm q}/2)}. \\qquad \\,\\,\\,\n\\label{chi(n)-4}\n$$\nwhich shows a quite weak dependence on $n$,\nd\u03c7(n)/dn \u22489/8  \u03b4_q/\u0394   \u03c7(0)/n_crit,\nassuming $\\delta_{\\rm q}\\ll |\\Delta|$. In the usual case when $\\Delta <0$, the absolute value of $\\chi(n)$ decreases with increasing $n$.\n\nNote that in Eqs. (<ref>) and (<ref>) we used ${\\tilde g}= \\sqrt{2}\\, g$ and $\\tilde{\\tilde g}= \\sqrt{3}\\, g$. If a better approximation is used,\ng\u0303\u2248\u221a(2)  g   (1-\u03b4_q /2\u03c9_q^b),\ng\u0303\u0303\u0303\u2248\u221a(3)  g   (1-\u03b4_q /\u03c9_q^b),\nthen correction to the $\\tilde g^2$-term in Eq. (<ref>) creates an additional contribution $g^2\\delta_{\\rm q}/[\\omega_{\\rm q}^{\\rm b}(\\Delta-\\delta_{\\rm q})]$ to $\\chi$, which for typical parameters is much larger than the second terms in Eqs. (<ref>) and (<ref>). The correction (<ref>) also yields an additional $n$-dependent contribution of\napproximately $2g^4\\delta_{\\rm q}n/(\\Delta^3\\omega_{\\rm q}^{\\rm b})$ (assuming $\\delta_{\\rm q}\\ll |\\Delta |$) to both $\\omega_{\\rm r}^{|g\\rangle}(n)$ and $\\omega_{\\rm r}^{|e\\rangle}(n)$. These additional slopes are comparable to the slope of $\\chi(n)$ in Eq. (<ref>) because $\\Delta^2/(\\delta_{\\rm q}\\omega_{\\rm q}^{\\rm b})$ is on the order of 1 for typical experimental parameters. However, the contribution to $\\chi(n)$ from the correction (<ref>) is only $9 g^4\\delta_{\\rm q}^2n/(\\Delta^4 \\omega_{\\rm q}^{\\rm b})$ (assuming $\\delta_{\\rm q}\\ll |\\Delta |$), which is smaller than the last term in Eq. (<ref>) because $|\\Delta |\\ll\\omega_{\\rm q}^{\\rm b}$. Therefore, the slope of $\\chi(n)$ in Eq. (<ref>) is practically not affected by the correction (<ref>). Similarly, inaccuracy of our approximation of the fourth qubit level energy by $3\\omega_{\\rm q}^{\\rm b}-3\\delta_{\\rm q}$ produces only a small correction to the slope of $\\chi(n)$: the correction to the fourth-level energy is on the order of $\\delta_{\\rm q}^2/\\omega_{\\rm q}^{\\rm b}$, and therefore the correction to $\\chi (n)$ [via Eq. (<ref>)] is on the order of $g^4\\delta_{\\rm q}^2n/(\\Delta^4 \\omega_{\\rm q}^{\\rm b})$ for $\\delta_{\\rm q}\\ll |\\Delta |$.\n\nThus, we see that for a transmon or Xmon qubit, calculation of $\\chi (0)$ requires at least three qubit levels to be taken into account, while the first correction due to $\\chi (n)$ dependence ($n\\ll n_{\\rm crit}$) requires at least four qubit levels to be considered. In contrast, calculation of the Purcell rate $\\Gamma (0)$ requires two qubit levels, while the first correction due to $\\Gamma (n)$ dependence requires three qubit levels.\n\n### Measurement error\nNow let us discuss the qubit measurement error caused by the qubit\nrelaxation due to Purcell effect.  To describe measurement, we will\nuse the dispersive approximation (<ref>) with\n$\\chi=-g^2\\delta_{\\rm q}/\\Delta^2$ [Eq. (<ref>)] and\nneglect the small difference between $\\Delta$ defined in Eq.(<ref>) and $\\omega_{\\rm q}-\\omega_{\\rm r}$ defined via\nEq. (<ref>). For the Purcell rate we will use the\nsimplest form $\\Gamma = g^2\\kappa/\\Delta^2$. Both approximations\nassume a sufficiently small number of photons, Eq.(<ref>).\n\nAssuming that the qubit is either in the state $|g\\rangle$ or\n$|e\\rangle$ (non-evolving), from Eq. (<ref>) we see that the\neffective resonator frequency is constant in time, $\\omega_{\\rm\nr}\\pm \\chi$, where the upper sign is for the state $|e\\rangle$ and\nthe lower sign is for $|g\\rangle$. The corresponding resonator state\nis a coherent state $|\\alpha_{\\pm}\\rangle$, characterized by an\namplitude $\\alpha_{\\pm}(t)$ in the rotating frame based on the drive\nfrequency $\\omega_{\\rm d}$ [in the lab frame the resonator wave\nfunction is $e^{-|\\alpha_\\pm|^2/2}\\sum_n (\\alpha_\\pm e^{-i\\omega_d\nt})^n n^{-1/2} |n\\rangle$ up to an overall phase]. The evolution of\nthe amplitude is\n\n\u03b1\u0307_\u00b1= -i (\u0394_rd \u00b1\u03c7)  \u03b1_\u00b1\n-\u03ba/2  \u03b1_\u00b1 -i\u03b5_r,\n\nwhere the upper sign everywhere is for the state $|e\\rangle$,\n\u0394_rd = \u03c9_r-\u03c9_d,\nand complex $\\varepsilon_{\\rm r} (t)$ can in general depend on time to\ndescribe a drive with changing amplitude and frequency. (Note a difference in notation compared with the main text: now $\\Delta_{\\rm rd}$ does not depend on the qubit state and the frequency shift $\\pm \\chi$ is added explicitly.) The steady\nstate for a steady drive, $\\varepsilon_{\\rm r}= {\\rm const}$, is\n\u03b1_\u00b1= -i\u03b5_r/\u03ba/2+i(\u0394_rd \u00b1\u03c7),\nso that the two coherent states are separated by\n\u03b1_+ -\u03b1_- = -2\u03b5_r\u03c7/(\u03ba/2+i\u0394_rd)^2+\u03c7^2,\nand this is the difference, which can be sensed by the homodyne\ndetection (it does not matter whether the microwave is transmitted or reflected from the resonator when we discuss the measurement in terms of $\\alpha_{\\pm}$).\n\nIn the case when $\\Delta_{\\rm rd}=0$ (so that $\\omega_{\\rm\nd}=\\omega_{\\rm r}$), both states have the same average number of\nphotons, $\\bar{n}=|\\alpha_+|^2=|\\alpha_-|^2=|\\varepsilon_{\\rm\nr}|^2/(\\kappa^2/4+\\chi^2)$, and the absolute value of the state\nseparation is\n\u03b4\u03b1\u2261| \u03b1_+ -\u03b1_-|= 2 \u221a(n\u0305)/\u221a((\u03ba/2\u03c7)^2+1).\n\nTheoretically, the distinguishability of two coherent states separated by\n$\\delta\\alpha$ is the same as the distinguishability of two Gaussians\nwith width (standard deviation) of 1/2 each, separated by\n$\\delta\\alpha$. However, a measurement for the duration $t_{\\rm m}$\nincreases the effective separation by a factor of $\\sqrt{\\kappa\nt_{\\rm m}}$, while imperfect quantum efficiency $\\eta$ of the\nmeasurement (mainly due to the amplifier noise) increases the\nGaussian width by $\\eta^{-1/2}$ or, equivalently, decreases the\neffective separation by $\\eta^{-1/2}$. Therefore, we may think about the\ndistinguishability of two Gaussians with width 1/2 each, separated\nby\n\u03b4\u03b1_eff = \u221a(\u03b7\u03bat_m)\n\u03b4\u03b1,\nwhich gives the error probability due to state separation\nP_err^sep=1-Erf(\u03b4\u03b1_eff/\u221a(2))/2 \u2248exp[-(\u03b4\u03b1_eff)^2/2]/\u221a(2\u03c0) \u03b4\u03b1_eff  .\n\nThe other contribution to the measurement error $P_{\\rm err}$ for the state $|e\\rangle$ comes\nfrom the qubit energy relaxation with the rate $\\Gamma+T_{1,\\rm\nint}^{-1}$ during the measurement time $t_{\\rm m}$,\nP_err=  P_err^sep + 1/2  t_m (\u0393+T_1,int^-1),\nwhere the factor $1/2$ is because the relaxation moment is distributed practically uniformly within the measurement duration $t_{\\rm m}$.\nSince $P_{\\rm err}^{\\rm sep}$ decreases with time $t_{\\rm m}$\nexponentially, the main limitation for $P_{\\rm err}$ comes from the\nsecond term.\n\nIt is easy to find that $ P_{\\rm err}^{\\rm sep}=10^{-2}$ corresponds\nto $\\delta\\alpha_{\\rm eff}=2.3$, $ P_{\\rm err}^{\\rm sep}=10^{-3}$\ncorresponds to $\\delta\\alpha_{\\rm eff}=3.1$, and $ P_{\\rm err}^{\\rm\nsep}=10^{-4}$ corresponds to $\\delta\\alpha_{\\rm eff}=3.7$. For an\nestimate let us choose $\\delta\\alpha_{\\rm eff}\\agt 3$. Then from\nEq. (<ref>) $t_{\\rm m}\\agt\n9/(\\eta\\kappa\\,\\delta\\alpha^2)$, and therefore even neglecting\nintrinsic relaxation $T_{1,\\rm int}^{-1}$ in Eq. (<ref>), we\nobtain the condition\n\u03931/4 P_err\u03b7\u03ba(\u03b4\u03b1)^2.\nNow using $\\Gamma=\\kappa g^2/\\Delta^2$ and assuming $\\kappa \\agt 2\\, |\\chi |$\nin Eq. (<ref>), so that $\\delta\\alpha \\simeq 4\\chi\n\\sqrt{\\nbar}/\\kappa$,\nwe rewrite this condition as\n\u03ba2 \u221a(P_err\u03b7)   |\u03c7|/|g|  \u22432 \u221a(P_err\u03b7)\n|g\u03b4_q|/|\u0394|,\nwhere for the second expression we used $\\chi \\simeq -g^2\\delta_{\\rm q}/\\Delta^2$.\nSince the measurement time $t_{\\rm m}$ should be at least few times\nlonger than $\\kappa^{-1}$, we obtain\nt_m >4/\u03ba 2/\u221a(P_err\u03b7)   |\u0394|/|g\u03b4_q| =4/\u03b4_q/\u221a(P_err\u03b7)\u221a(/n_crit).\n\nThese estimates show that the Purcell effect requires a sufficiently long measurement time when we desire a small measurement error $P_{\\rm err}$. The limitation is not severe, but it is still inconsistent with a fast accurate measurement needed for quantum error correction. As an example, from Eq. (<ref>) we see that for $\\delta_{\\rm q}/2\\pi\\simeq 200\\, {\\rm MHz}$, $P_{\\rm err}\\simeq 10^{-3}$, $\\eta \\simeq 0.3$ and $\\nbar \\simeq n_{\\rm crit}/4$ we need $t_m >400\\,{\\rm ns}$ (this in turn would require a very long $T_{1, \\rm int}$). Also, the detuning should be sufficiently large,\n|\u0394/g|>\u221a(\u03bat_m/2P_err)>\u221a(2/P_err),\nas directly follows from $\\Gamma =\\kappa (g/\\Delta)^2$ and $\\kappa t_{\\rm m} >4$.\n\nAs a more detailed example, let us choose $g/2\\pi \\simeq 30\\, {\\rm MHz}$, $\\Delta/2\\pi \\simeq -1.35\\, {\\rm GHz}$, $\\delta_{\\rm q}/2\\pi\\simeq 200\\, {\\rm MHz}$, $\\kappa^{-1}\\simeq 100 \\, {\\rm ns}$, $t_{\\rm m}\\simeq 400 \\, {\\rm ns}$, $\\eta\\simeq 0.3$, and $\\nbar\\simeq n_{\\rm crit}/4\\simeq 125$. Then for the excited qubit state the Purcell decay brings the error contribution $t_{\\rm m}\\Gamma /2\\simeq 10^{-3}$; the dispersive coupling is $\\chi /2\\pi \\simeq -0.1 \\, {\\rm MHz}$, so $\\delta \\alpha \\simeq 0.25\\sqrt{\\nbar}\\simeq 2.8$ and $\\delta\\alpha_{\\rm eff}\\simeq 3$, so the separation error is also about $10^{-3}$ [actually slightly larger since $|\\chi|$ decreases with $\\nbar$ for negative $\\Delta$ \u2013 see Eq. (<ref>)].\n\nThus, we see that even with the qubit decay due to the Purcell effect, it is possible to measure a qubit with a low measurement error, but this requires a relatively long time and large resonator-qubit detuning. Note that we also had to assume a large number of photons in the resonator, which can lead to detrimental effects (neglected in our analysis) such as dressed dephasing [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and various imperfections related to nonlinear dynamics. Suppression of the Purcell effect (using a Purcell filter or other means) allows us to significantly increase the ratio $|g/\\Delta|$, thus increasing the coupling $\\chi$ and correspondingly decreasing the measurement time for the same measurement error.\n\n99\n\nN-C-book M. A. Nielsen and I. L. Chuang, Quantum\nComputation and Quantum Information (Cambridge University Press,\nCambridge, 2000).\n\nBarends-14 R. Barends, J. Kelly, A. Megrant, A. Veitia,\nD. Sank, E. Jeffrey, T. C. White, J. Mutus, A. G. Fowler, B.\nCampbell, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, C. Neill, P.\nO'Malley, P. Roushan, A. Vainsencher, J. Wenner, A. N. Korotkov, A.\nN. Cleland, and J. M. Martinis, Nature 508, 500 (2014).\n\nChow-14 J. M. Chow, J. M. Gambetta, E. Magesan, D. W. Abraham,\nA. W. Cross, B. R. Johnson, N. A. Masluk, C. A. Ryan, J. A. Smolin,\nS. J. Srinivasan, J. Srikanth, and M. Steffen, Nature Comm. 5,\n4015 (2014).\n\nWeber-14 S. J. Weber, A. Chantasri, J. Dressel, A. N. Jordan,\nK. W. Murch, and I. Siddiqi, Nature 511, 570 (2014).\n\nSun-14 L. Sun, A. Petrenko, Z. Leghtas, B. Vlastakis,\nG. Kirchmair, K. M. Sliwa, A. Narla, M. Hatridge, S. Shankar, J.\nBlumoff, L. Frunzio, M. Mirrahimi, M. H. Devoret, and R. J.\nSchoelkopf, Nature 511, 7510 (2014).\n\nRiste-14 D. Riste, M. Dukalski, C. A. Watson, G. de Lange,\nM. J. Tiggelman, Y. M. Blanter, K. W. Lehnert, R. N. Schouten, and\nL. DiCarlo, Nature 502, 350 (2013).\n\nStern-14 M. Stern, G. Catelani, Y. Kubo, C. Grezes,\nA. Bienfait, D. Vion, D. Esteve, and P. Bertet, Phys. Rev. Lett.\n113, 123601 (2014).\n\nMlynek-14 J. A. Mlynek, A. A. Abdumalikov, C. Eichler, and\nA. Wallraff, Nature Comm. 5, 5186 (2014).\n\nLin-14 Z. R. Lin, K. Inomata, K. Koshino, W. D. Oliver, Y. Nakamura, J.\nS. Tsai, and T. Yamamoto, Nature Comm. 5, 4480 (2014).\n\nKelly-15  J. Kelly, R. Barends, A. G. Fowler, A. Megrant,\nE. Jeffrey, T. C. White, D. Sank, J. Y. Mutus, B. Campbell, Yu Chen,\nZ. Chen, B. Chiaro, A. Dunsworth, I.-C. Hoi, C. Neill, P. J. J.\nO'Malley, C. Quintana, P. Roushan, A. Vainsencher, J. Wenner, A. N.\nCleland, and J. M. Martinis, Nature 519, 66 (2015).\n\nBlais-04 A. Blais, R. S. Huang, A. Wallraff,\nS. M. Girvin, and R. J. Schoelkopf, Phys. Rev. A 69, 062320\n(2004).\n\nWallraff-04 A. Wallraff, D. I. Schuster, A. Blais, L. Frunzio,\nR. S. Huang, J. Majer, S. Kumar, S. M. Girvin, and R. J. Schoelkopf,\nNature (London) 431, 162 (2004).\n\nEsteve-86 D. Esteve, M. H. Devoret, and J. M. Martinis,\nPhys. Rev. B 34, 158 (1986).\n\nPurcell-46 E. M. Purcell, Phys. Rev. 69, 681 (1946).\n\nHaroche-book H. Haroche and J.-M. Raimond, Exploring the Quantum:Atoms, Cavities, and Photons\n(Oxford University Press, Oxford, 2006).\n\nRed10 M. D. Reed, B. R. Johnson, A. A. Houck, L. DiCarlo,\nJ. M. Chow, D. I. Schuster, L. Frunzio, and R. J. Schoelkopf, Appl.\nPhys. Lett. 96, 203110 (2010).\n\nJeffrey-14 E. Jeffrey, D. Sank, J.Y. Mutus, T.C. White,\nJ. Kelly, R. Barends, Y. Chen, Z. Chen, B. Chiaro, A. Dunsworth, A.\nMegrant, P.J.J. O'Malley, C. Neill, P. Roushan, A. Vainsencher, J.\nWenner, A.N. Cleland, J. M. Martinis, Phys. Rev. Lett. 112,\n190504 (2014).\n\nBronn-APS-15 N. Bronn, A. Corcoles, J. Hertzberg, S. Srinivasan, J. Chow, J. Gambetta, M. Steffen, Y. Liu, and  A. Houck, Bull. Am. Phys. Soc.\n60, S39.6 (2015).\n\nBronn-15 N. T. Bronn, E. Magesan, N. A. Masluk, J. M. Chow, J. M. Gambetta and M. Steffen, arXiv:1504.04353.\n\nGam11 J. M. Gambetta, A. A. Houck, and A. Blais, Phys. Rev.\nLett. 106, 030502 (2011).\n\nSrinivasan-11 S. J. Srinivasan, A. J. Hoffman, J. M. Gambetta,\nand A. A. Houck, Phys. Rev. Lett. 106, 083601 (2011).\n\nSet13 E. A. Sete, A. Galiautdinov, E. Mlinar,\nJ. M. Martinis, and A. N. Korotkov, Phys. Rev. Lett. 110,\n210501 (2013).\n\nSet14 E. A. Sete, J. M. Gambetta, and A.N. Korotkov, Phys. Rev. B 89, 104516 (2014).\n\nKoch-07 J. Koch, T. M. Yu, J. Gambetta, A. A. Houck, D. I.\nSchuster, J. Majer, A. Blais, M. H. Devoret, S. M. Girvin, and R. J.\nSchoelkopf, Phys. Rev. A 76, 042319 (2007).\n\nBoisson-10 M. Boissonneault, J. M. Gambetta, and A. Blais, Phys. Rev. Lett. 105, 100504 (2010).\n\nAllen-Eberly-book L. Allen and J. H. Eberly, Optical Resonance and Two-Level Atoms (Dover, Mineola, NY, 1997).\n\nRWA-note The rotating wave approximation neglects the counter-rotating terms. For driven classical oscillators [Eqs. (<ref>) and (<ref>)] it requires that $|\\Delta_{\\rm rd}|$, $|\\Delta_{\\rm fd}|$, $|\\mathcal{G}|$, and $|\\dot{\\varepsilon_{\\rm r}}/\\varepsilon |$ are small compared to $\\omega_{\\rm r}$.\n\nScully-book  M. O. Scully and M. S. Zubairy, Quantum Optics (Cambridge Univ. Press, Cambridge, 1997).\n\nKor-13 A. N. Korotkov, arXiv:1309.6405, Appendix B.\n\nPie07 P. Meystre and M. Surgent III, Elements of\nQuantum Optics (Springer-Verlag, Berlin, 2007).\n\nCar93 H. J. Carmichael, Phys. Rev. Lett. 70, 2273 (1993).\n\nBoi08 M. Boissonneault, J. M. Gambetta, and A. Blais, Phys. Rev. A\n77, 060305 (2008).\nBoi09 M. Boissonneault, J. M. Gambetta, and A. Blais, Phys. Rev. A\n79, 013819 (2009).\n\n"}
{"prompt": "What are the main findings of the paper 'High-fidelity controlled-Z gate with maximal intermediate leakage operating at the speed limit in a superconducting quantum processor'?", "completion": "\n\n-\n\n# High-fidelity controlled-Z gate with maximal intermediate leakage operating at the speed limit in a superconducting quantum processor\n\nThese authors contributed equally to this work.\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nInstituto Superior T\u00e9cnico, Lisbon, Portugal\n\nThese authors contributed equally to this work.\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nNetherlands Organisation for Applied Scientific Research (TNO), P.O. Box 96864, 2509 JG The Hague, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nNetherlands Organisation for Applied Scientific Research (TNO), P.O. Box 96864, 2509 JG The Hague, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nNetherlands Organisation for Applied Scientific Research (TNO), P.O. Box 96864, 2509 JG The Hague, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nWe introduce the sudden variant (SNZ) of the Net Zero scheme realizing controlled-$Z$ (CZ) gates by baseband flux control of transmon frequency.\nSNZ CZ gates operate at the speed limit of transverse coupling between computational and non-computational states by maximizing intermediate leakage.\nThe key advantage of SNZ is tuneup simplicity, owing to the regular structure of conditional phase and leakage as a function of two control parameters.\nWe realize SNZ CZ gates in a multi-transmon processor, achieving $99.93\\pm0.24\\%$ fidelity and $0.10\\pm0.02\\%$ leakage.\nSNZ is compatible with scalable schemes for quantum error correction and adaptable to generalized conditional-phase gates useful in intermediate-scale applications.\n\n[apsrev4-1]\n\nSuperconducting quantum processors\u00a0[Unknown Author, \"Unknown Title\", ] have recently reached important milestones for quantum computing, notably the demonstration of quantum supremacy on a 53-transmon processor\u00a0[Unknown Author, \"Unknown Title\", ]. On the path to quantum error correction (QEC) and fault tolerance\u00a0[Unknown Author, \"Unknown Title\", ], recent experiments have used repetitive parity measurements to stabilize two-qubit entanglement\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and to perform surface-code quantum error detection in a 7-transmon processor\u00a0[Unknown Author, \"Unknown Title\", ]. These developments have relied on two-qubit controlled-phase (CP) gates realized by dynamical flux control of transmon frequency, harnessing the transverse coupling $\\Jtwo$ between a computational state $\\ket{11}$ and a non-computational state such as $\\ket{02}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Compared to other implementations, e.g., cross-resonance using microwave-frequency pulses \u00a0[Unknown Author, \"Unknown Title\", ] and parametric radio-frequency pulsing\u00a0[Unknown Author, \"Unknown Title\", ], baseband flux pulses achieve the fastest controlled-$Z$ (CZ) gates (a special case of CP), operating near the speed limit $\\tlim=\\pi/\\Jtwo$\u00a0[Unknown Author, \"Unknown Title\", ].\n\nOver the last decade, baseband flux pulsing for two-qubit gating has evolved in a continuous effort to increase gate fidelity and to reduce leakage and residual $ZZ$ coupling. In particular, leakage has become a main focus for its negative impact on QEC, adding complexity to error-decoder design\u00a0[Unknown Author, \"Unknown Title\", ] and requiring hardware and operational overhead to seep\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nTo reduce leakage from linear-dynamical distortion in flux-control lines and limited time resolution in arbitrary waveform generators (AWGs), unipolar square pulses\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] have been superseded by softened unipolar pulses\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] based on fast-adiabatic theory\u00a0[Unknown Author, \"Unknown Title\", ]. In parallel, coupling strengths have reduced roughly fourfold (to $\\Jtwo/2\\pi \\sim 10\\mathrm{-}20~\\MHz$) to reduce residual $ZZ$ coupling, which affects single-qubit gates and idling at bias points, and produces crosstalk from spectator qubits\u00a0[Unknown Author, \"Unknown Title\", ]. Many groups are actively developing tunable coupling schemes to suppress residual coupling without incurring slowdown\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nA main limitation to the fidelity of flux-based CP gates is dephasing from flux noise, as one qubit is displaced $0.5\\mathrm{-}1~\\GHz$ below its flux-symmetry point (i.e., sweetspot\u00a0[Unknown Author, \"Unknown Title\", ]) to reach the $\\ket{11}$-$\\ket{02}$ resonance. To address this limitation, Ref.\u00a0Rol19 recently introduced a bipolar variant [termed Net Zero (NZ)] of the fast-adiabatic scheme, which provides a built-in echo reducing the impact of low-frequency flux noise. The double use of the transverse interaction also reduces leakage by destructive interference, as understood by analogy with a Mach-Zehnder interferometer (MZI). Finally, the zero-average characteristic avoids the buildup of long-timescale distortions remaining in flux-control lines after compensation, significantly improving gate repeatability. NZ pulsing has been successfully used in several recent experiments\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], elevating the state of the art for CZ gate fidelity in a multi-transmon processor to $99.72\\pm0.35\\%$\u00a0[Unknown Author, \"Unknown Title\", ]. However, NZ suffers from complicated tuneup, owing to the complex dependence of conditional phase and leakage on fast-adiabatic pulse parameters. This complication limits the use of NZ for two-qubit gating as quantum processors grow in qubit count.\n\nIn this Letter, we introduce the sudden variant (SNZ) of the Net Zero scheme implementing CZ gates using baseband flux pulsing.\nSNZ offers two key advantages while preserving the built-in echo, destructive leakage interference, and repeatability characteristic of conventional NZ.\nFirst, SNZ operates at the speed limit of transverse coupling by maximizing intermediate leakage to the non-computational state.\nThe second and main advantage is greatly simplified tuneup: the landscapes of conditional phase and leakage as a function of two pulse parameters have very regular structure and interrelation, easily understood by exact analogy to the MZI.\nWe realize SNZ CZ gates among four pairs of nearest neighbors in a seven-transmon processor and characterize their performance using two-qubit interleaved randomized benchmarking (2QIRB) with\nmodifications to quantify leakage\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The highest performance achieved has $99.93\\pm 0.24\\%$ fidelity with $0.10 \\pm 0.02\\%$ corresponding leakage.\nUsing numerical simulation with experimental input parameters, we dissect an error budget finding SNZ to slightly outperform conventional NZ.\nSNZ CZ gates are fully compatible with scalable approaches to QEC\u00a0[Unknown Author, \"Unknown Title\", ].\nThe generalization of SNZ to arbitrary CP gates is straightforward and useful for optimization\u00a0[Unknown Author, \"Unknown Title\", ], quantum simulation\u00a0[Unknown Author, \"Unknown Title\", ], and other noisy intermediate-scale quantum (NISQ) applications\u00a0[Unknown Author, \"Unknown Title\", ].\n\nA flux pulse harnessing the $\\ket{11}$-$\\ket{02}$ interaction implements the unitary\n\n= [              1              0              0              0              0;              0            e^i              0              0              0;              0              0            e^i              0              0;              0              0              0      \u221a(1-4)e^i  \u221a(4)e^\u03d5_02,11;              0              0              0 \u221a(4)e^i\u03d5_11,02     \u221a(1-4) e^i;                ]\n\nin the $\\{ \\ket{00},\\ket{01},\\ket{10}, \\ket{11}, \\ket{02}\\}$ subspace, neglecting decoherence and residual interaction between far off-resonant levels.\nHere, $\\phizo$ and $\\phioz$ are the single-qubit phases, and $\\phioo=\\phizo+\\phioz+\\phitwoq$, where $\\phitwoq$ is the conditional phase.\nFinally, $\\Lone$ is the leakage parameter.\n\nIn a rotating frame which absorbs the single-qubit phases, the system Hamiltonian is\n\nH =   (t) |02\u27e9\u27e802|+ ( |02\u27e9\u27e811|+ |11\u27e9\u27e802|),\n\nwhere $\\Dzt(t)$ is the dynamical detuning between $\\ket{02}$ and $\\ket{11}$.\nEach half of the bipolar NZ pulse implements the unitary\n\n==[ \u03b1 e^i \u03b2 e^i; \u03b2 e^i \u03b1 e^i;       ],\n\nin the $\\{ \\ket{11}, \\ket{02} \\}$ subspace, where $\\alpha,\\beta \\in \\left[0,1\\right]$ satisfy $\\alpha^2+\\beta^2=1$ and $\\phia+\\phid=\\phib+\\phic+\\pi~(\\modulo~2\\pi)$.\nIn the MZI analogy, this unitary is the action of each (ideally identical) beamsplitter.\n\nIn SNZ, each half pulse is a square pulse with amplitude $\\pm A$ and duration $\\tp/2=\\tlim/2$.\nSNZ intentionally adds an idling period $\\ttwoq$ between the half pulses to perfect the analogy to the MZI (Fig.\u00a01 inset), allowing accrual of relative phase $\\phi$ in between the beamsplitters.\nThe unitary action of this idling is\n\n= [    1    0;    0 e^i\u03d5;      ].\n\nAn ideal CZ gate, our target here, achieves $\\phizo=\\phioz=0~(\\modulo~2\\pi)$, $\\phitwoq=\\pi~(\\modulo~2\\pi)$ (phase condition PC), and $\\Lone=0$ (leakage condition LC), with arbitrary $\\phizt$. Accomplishing both conditions with $\\UmA\\UB\\UA$ requires\n\n\u03b1^2 e^i 2 + \u03b2^2 e^i( ++ \u03d5)=-1 (PC)\n\nsimultaneously with either one of three conditions:\n(LC1) $\\beta=0$; (LC2) $\\phia-\\phid-\\phi=\\pi~(\\modulo~2\\pi)$; or (LC3) $\\alpha=0$.\nLC1 (LC3) corresponds to perfect reflection (transmission) at each beamsplitter.\nLC2 corresponds to destructive interference at the second beamsplitter of the $\\ket{02}$ leakage produced by the first.\n\n< g r a p h i c s >\n\nNumerical simulation of an idealized SNZ pulse with infinite time resolution for the pair $\\QL$-$\\QMtwo$, with $\\Dzt/2\\pi=1.063~\\GHz$ (at bias point) and $\\tlim=35.40~\\ns$ for the $\\ket{11}$-$\\ket{02}$ interaction. (a) The flux pulse has $\\tp=\\tlim$ and variable $A$ and $\\ttwoq$. Amplitude $A$ is normalized to the $\\ket{11}$-$\\ket{02}$ resonance. (b, c) Landscapes of conditional phase $\\phitwoq$ (b) and leakage $\\Lone$ (c) as a function of $A$ and $\\ttwoq$. Dashed curves are contours of $\\phitwoq=180\\degrees$. In (c), the vertical valley at $A=1$ is due to LC3: each half pulse fully transmits $\\ket{11}$ to $\\ket{02}$, and vice versa. The other two vertical valleys are due to LC1: each half pulse implements a complete (off-resonant) oscillation and thus perfectly reflects.\nThe diagonal valleys are due to LC2.\nNote the simultaneous overlap of $\\phitwoq=180\\degrees$ contours with the crossing of LC3 and LC2 valleys.\nThese crossing points occur at $A=1$ and $\\ttwoq$ satisfying $\\Dzt\\ttwoq=0~(\\modulo~2\\pi)$.\n\nThe key advantage of SNZ over conventional NZ is the very straightforward procedure to simultaneously meet PC and LC3.\nTo appreciate this, consider first the ideal scenario where the pulses can have infinite time resolution. For, $\\tp=\\tlim$, $\\ttwoq=0$ ($\\phi=0$), and $A=1$ ($\\Dzt=0$) each half pulse implements an iSWAP gate between $\\ket{11}$ and $\\ket{02}$. Thus, $\\alpha=0$ (meeting LC3) and $\\phib=\\phic=-\\pi/2$ (meeting PC). In the MZI analogy, the first beamsplitter fully transmits $\\ket{11}$ to $-i\\!\\ket{02}$ (producing maximal intermediate leakage), and the second fully transmits $-i\\!\\ket{02}$ to $-\\!\\ket{11}$.\n\nConsider now the effect of non-zero $\\ttwoq$. The idealized two-qutrit numerical simulation with infinite time resolution and no decoherence in Fig.\u00a01 shows that the landscapes of $\\phitwoq$ and  $\\Lone$ as a function of $A$ and $\\ttwoq$ have a clear structure and link to each other. Evidently, $\\UmA\\UB\\UA$ is $2\\pi$-periodic in $\\phi$, so both landscapes are vertically periodic.\nThe  $\\Lone(A,\\ttwoq)$ landscape shows a vertical leakage valley at $A=1$, where LC3 is met.\nLC2 gives rise to additional, diagonally running valleys. Juxtaposing the contour of $\\phitwoq=180\\degrees$ shows that PC is met at the crossing points between these valleys.\nIn this way, this regular leakage landscape provides useful crosshairs for simultaneously meeting PC.\nWe note that along the LC3 vertical valley, $\\phitwoq$ changes monotonically as a function of $\\ttwoq$, allowing the realization of CP gates with any desired $\\phitwoq$.\nWe leave this useful generalization for future work, focusing here on CZ gates.\n\nWhile in this idealized scenario the idling period is not needed, there are practical reasons to include $\\ttwoq$ in experiment: any flux-pulse distortion remaining from the first half pulse during the second (e.g., due to finite pulse rise time) will break the symmetry $\\UmA\\!=\\!\\UA$. Due to the time resolution $\\ts$ of the AWG used for flux control, $\\phi$ can only increment in steps of $-\\Dzt\\ts$, where $\\Dzt$ is the detuning at the bias point. As typically $\\Dzt/2\\pi=0.5\\mathrm{-}1~\\GHz$ and $\\ts\\sim 1~\\ns$, one may only use the number of intermediate sampling points for very coarse control. For fine control, we propose to use the amplitude $\\pm B$ of the first and last sampling points during $\\ttwoq$\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWith these considerations, we turn to the experimental realization of SNZ CZ gates between the nearest-neighbor pairs among four transmons in a 7-transmon processor. High- and low-frequency transmons ($\\QH$ and $\\QL$, respectively) connect to two mid-frequency transmons ($\\QMone$ and $\\QMtwo$) using bus resonators dedicated to each pair. Each transmon has a flux-control line for two-qubit gating, a microwave-drive line for single-qubit gating, and a dispersively coupled resonator with Purcell filter for readout\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. All transmons can be measured simultaneously by frequency multiplexing using a common feedline. See\u00a0[Unknown Author, \"Unknown Title\", ] for device details and a summary of measured transmon parameters, single-qubit-gate and readout performance. Each transmon is biased at its sweetspot using static flux bias to counter residual offsets. Flux pulsing is performed using a Zurich Instruments HDAWG-8 $(\\ts=1/2.4~\\ns)$. Following prior work\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ],  we measure the linear-dynamical distortions in the flux-control lines using the Cryoscope technique and correct them using real-time filters built into the AWG.\n\n< g r a p h i c s >\n\nCalibration of the SNZ pulse for pair $\\QL$-$\\QMtwo$ and comparison to simulation.\n(a) $\\ket{2}$-state population of $\\QMtwo$ as a function of the amplitude and duration of a unipolar square pulse making $\\ket{11}$ interact with $\\ket{02}$.\nThe characteristic chevron pattern is used to identify $\\tlim$ and the amplitude bringing $\\ket{11}$ and $\\ket{02}$ on resonance. (b,c) Landscapes of conditional phase $\\phitwoq$ and leakage estimate $\\Loneexp$ as a function of SNZ pulse amplitudes $A$ and $B$, with $\\tp=\\tlimp$ and $\\ttwoq=1.67~\\ns$. Note that the juxtaposed $\\phitwoq=180\\degrees$ contour runs along the opposite diagonal compared to Figs.\u00a01(b,c) because increasing $B$ (which decreases $\\Dzt$) changes $\\phi$ in the opposite direction from $\\ttwoq$. Data points marked with dots are measured with extra averaging for detailed examination in Fig.\u00a03.\n(d) Numerical simulation of leakage $\\Lone$ landscape and $\\phitwoq=180\\degrees$ contour. The simulation uses pulse and transmon parameters from experiment (neglecting decoherence), and includes the measured final flux-pulse distortion.\nAll landscapes are sampled using an adaptive algorithm based on\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe exemplify the tuneup of SNZ pulses using pair $\\QL$-$\\QMtwo$ (Fig.\u00a02). We first identify $\\tlim$ for the $\\ket{11}$-$\\ket{02}$ interaction and the amplitude $A$ bringing the two levels on resonance.\n(The rightmost index indicates the excitation level of the fluxed transmon, here $\\QMtwo$). These parameters are extracted from the characteristic chevron pattern of $\\ket{2}$-population in $\\QMtwo$  as a function of the amplitude and duration of a unipolar square flux pulse acting on $\\ket{11}$ [Fig.\u00a02(a)]. The chevron symmetry axis corresponds to $A=1$ and the oscillation period along this axis gives $\\tlim$. We set $\\tp=\\tlimp \\equiv 2n\\ts$, where $n$ is the smallest integer satisfying $2n\\ts \\geq \\tlim$. Next, we measure the landscapes of $\\phitwoq$ and leakage estimate\u00a0$\\Loneexp$ in the range $A\\in\\left[0.9, 1.1\\right]$, $B\\in\\left[0,A\\right]$. These quantities are extracted from the conditional-oscillation experiments described in\u00a0[Unknown Author, \"Unknown Title\", ]. As expected, the landscape of $\\Loneexp$ [Fig.\u00a02(c)] reveals  a vertical valley at $A=1$ and a diagonal valley. Juxtaposing the $\\phitwoq=180\\degrees$ contour extracted from the $\\phitwoq$ landscape [Fig.\u00a02(b)], we observe the matching of PC at the crossing of these valleys. These experimental observations are in excellent agreement with a numerical two-qutrit simulation [Fig.\u00a02(d)].\n\n< g r a p h i c s >\n\nLandscapes of the leakage estimate $\\Loneexp$ for (a) intentionally short $(\\tp=\\tlimp-6 \\ts)$ and (b) intentionally long $(\\tp=\\tlimp+6\\ts)$ flux pulses on $\\QMtwo$.\nThese landscapes are sampled using an adaptive algorithm based on\u00a0[Unknown Author, \"Unknown Title\", ].\n(c) Extracted $\\Loneexp$ along the $\\phitwoq=180\\degrees$ contours from (a), (b), and Fig.\u00a02(c). For $\\tp<\\tlim$, a single minimum is observed, but at a higher value than the minimum for $\\tp=\\tlimp$. For $\\tp>\\tlim$, two leakage minima are found, matching the single minimum for $\\tp=\\tlimp$.\n\nExperimentally, it is nearly impossible to precisely match $\\tp=\\tlim$ due to the discrete $\\ts$. To understand the possible consequences of $\\tp$ mismatch, we examine the $\\phitwoq$ and $\\Loneexp$ landscapes for SNZ pulses with intentionally set $\\tp = \\tlimp \\pm 6 \\ts$ (Fig.\u00a03). We find that the PC contour remains roughly unchanged in both cases. However, there are significant effects on $\\Loneexp$. In both cases, we observe that $\\Loneexp$ lifts at the prior crossing of LC2 and LC3 valleys where $\\phitwoq=180\\degrees$. For too-short pulses [Fig.\u00a03(a)], there remain two valleys of minimal $\\Loneexp$, but these are now curved and do not cross the $\\phitwoq=180\\degrees$ contour. For too-long pulses [Fig.\u00a03(b)], there are also two curved valleys. Crucially, these cross the $\\phitwoq=180\\degrees$ contour, and it remains possible to achieve PC and minimize leakage at two $(A,B)$ settings. Extracting $\\Loneexp$ along the $\\phitwoq=180\\degrees$ contours  [Fig.\u00a03(c)] confirms that the minimal leakage obtainable for $\\tp = \\tlimp + 6\\ts$ matches that for $\\tp=\\tlimp$.  The observed impossibility to achieve minimal leakage at $\\phitwoq=180\\degrees$ for $\\tp<\\tlim$ is a clear manifestation of the speed limit set by $\\Jtwo$. In turn, the demonstrated possibility to do so for $\\tp>\\tlim$ (even when overshooting by several sampling points) is an important proof of the viability of the SNZ pulse in practice.\n\nWith these insights, we proceed to tuning SNZ CZ gates for the four transmon pairs, following similar procedures.\nNamely, we use final weak bipolar pulses of total duration $\\toneq=10~\\ns$ to null the single-qubit phases in the frame of microwave drives. Also, since our codeword-based control electronics has a $20~\\ns$ timing grid, and\n$40~\\ns<\\ttotal=\\tp+\\ttwoq+\\toneq<60~\\ns$ for all pairs,  we allocate $60~\\ns$ to every CZ gate. However, some  pair-specific details must be noted.  Owing to the overlap of qubit frequencies between mid-frequency qubits, implementing CZ between $\\QH$ and $\\QMone$ $(\\QMtwo)$ requires parking of $\\QMtwo$ $(\\QMone)$ during the SNZ pulse on $\\QH$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The parking flux pulse is also bipolar, with each half a square pulse lasting $(\\tp+\\ttwoq)/2$. Its amplitude is chosen to downshift the parked qubit by $\\sim 300~\\MHz$, and fine tuned to null its single-qubit phase. For most pairs, we employ the $\\ket{11}$-$\\ket{02}$ interaction, which requires the smallest flux amplitude (reducing the impact of dephasing from flux noise) and does not require crossing any other interaction on the way to and from it. However, for pair $\\QL$-$\\QMone$, we cannot reliably use this interaction as there is a flickering two-level system (TLS) aligned with the $\\QMone$ qubit transition at this amplitude (See\u00a0[Unknown Author, \"Unknown Title\", ] for chevron measurements showing the flickering nature of this TLS). For this pair, we therefore employ the $\\ket{11}$-$\\ket{20}$ interaction. Using square pulses is a side benefit of SNZ in this case: it minimizes exchange between $\\ket{01}$ and the TLS, $\\ket{11}$ and $\\ket{20}$, and  $\\ket{01}$ and $\\ket{10}$ as their resonances are crossed as suddenly as possible.\n\nParameter     $\\QMone$-$\\QH$      $\\QMtwo$-$\\QH$        $\\QL$-$\\QMone$        $\\QL$-$\\QMtwo$\n\n$\\tlim~(\\ns)$      $32.20$     $29.00$     $40.60$     $35.40$\n\n$\\tp~(\\ns)$      $32.50$     $29.16$     $40.83$     $35.83$\n\n$\\ttwoq~(\\ns)$      2.92     3.75     1.25     1.67\n\n$(\\tp+\\ttwoq)/\\tlim$     $1.10$     $1.13$     $1.04$     $1.06$\n\n$\\ttotal~(\\ns)$     $45.42$     $42.91$     $52.08$     $47.50$\n\nInteraction     $\\ket{11}$-$\\ket{02}$     $\\ket{11}$-$\\ket{02}$     $\\ket{11}$-$\\ket{20}$     $\\ket{11}$-$\\ket{02}$\n\nParked\u00a0qubit     $\\QMtwo$      $\\QMone$     \u2013     \u2013\n\nAvg.\u00a0$\\Fid$ $(\\%)$     $98.89\\pm0.35$     $99.54\\pm0.27$     $93.72\\pm 2.10$     $97.14\\pm 0.72$\n\nAvg.\u00a0$\\Lone$ $(\\%)$     $0.13\\pm0.02$     $0.18\\pm0.04$     $0.78\\pm0.32$     $0.63\\pm0.11$\n\nMax.\u00a0$\\Fid$ $(\\%)$     $99.77\\pm0.23$      $99.93\\pm0.24$      $99.15\\pm1.20$      $98.56\\pm0.70$\n\nMin.\u00a0$\\Lone$ $(\\%)$     $0.07\\pm0.04$     $0.10\\pm0.02$     $0.04\\pm0.08$     $0.41\\pm0.10$\n\nSummary of SNZ CZ pulse parameters and achieved performance for the four transmon pairs. All SNZ CZ gates null single-qubit phases with weak bipolar square pulse of duration $\\toneq=10~\\ns$ immediately following the strong pulse. We allocate $60~\\ns$ to every CZ gate to conform to the $20~\\ns$ timing grid of our control electronics. Gate fidelities and leakage are obtained from 2QIRB keeping the other two qubits in $\\ket{0}$. Statistics (average and standard deviation) are taken from repeated 2QIRB runs (see\u00a0[Unknown Author, \"Unknown Title\", ] for technical details). The maximum $\\Fid$ and minimum $\\Lone$ quoted are not necessarily from the same run.\n\nTable\u00a01 summarizes the timing parameters and performance attained for the four SNZ CZ gates. The CZ gate fidelity $\\Fid$ and leakage $\\Lone$ are extracted using a 2QIRB protocol modified to quantify leakage\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nFor each pair, we report the best, average and standard deviation of both values based on at least 10 repetitions of the protocol spanning more than $8~\\hours$\u00a0[Unknown Author, \"Unknown Title\", ].\nSeveral observations can be drawn. First, CZ gates involving $\\QH$ perform better on average than those involving $\\QL$. This is likely due to the shorter $\\tlim$ and correspondingly longer time $60~\\ns-\\tp$ spent near the sweetspot. Another possible reason is that the frequency downshifting required of $\\QH$ to interact with $\\QMone$ and $\\QMtwo$  is roughly half that required of the latter to interact with $\\QL$. This reduces the impact of dephasing from flux noise during the pulse. Not surprisingly, performance is worst for the pair $\\QL$-$\\QMone$. Here, the pulse must downshift $\\QMone$ the most in order to reach the distant $\\ket{11}$-$\\ket{20}$ interaction, increasing dephasing from flux noise. Also, there may be residual exchange with the identified TLS and as the $\\ket{11}$-$\\ket{02}$ and $\\ket{01}$-$\\ket{10}$ resonances are crossed. Overall, there is significant variation in the performance metrics during repeated 2QIRB characterization. We believe this reflects the underlying variability of qubit relaxation and dephasing times, which however were not tracked simultaneously. In addition to having the best average performance, pair $\\QMtwo$-$\\QH$ also displays the hero performance based on a single 2QIRB run (Fig.\u00a04). Peaking at $\\Fid=99.93\\pm0.24\\%$, we believe this is the highest CZ fidelity extracted from 2QIRB characterization in a multi-transmon processor.\n\n< g r a p h i c s >\n\nBest SNZ CZ gate performance achieved from a single run of 2QIRB.\n(a) Reference and CZ-interleaved return probability $M_0$ to $\\ket{00}$ and (b) population in the computational space $\\chi_1$ as a function of the number of two-qubit Cliffords in the reference curve.\nErrors bars in $\\Fid$ and $\\Lone$ are obtained from the uncertainty of exponential-decay fits.\n\nIn an effort to identify the dominant sources of infidelity $\\Infid=1-\\Fid$ and leakage for SNZ CZ gates, we perform a two-qutrit numerical simulation for pair $\\QMtwo$-$\\QH$ with an error model taking parameters from experiment [Fig.\u00a05]. As in our previous work on conventional NZ\u00a0[Unknown Author, \"Unknown Title\", ], the simulation incrementally adds: (A) no noise; (B) energy relaxation; (C) Markovian dephasing; (D) dephasing from low-frequency flux noise; and (E) flux-pulse distortion. The experimental inputs for models B, C and D combine measured qubit relaxation time $\\Tone$ at the bias point, and measured echo and Ramsey dephasing times ($\\Ttwoecho$ and $\\Ttwostar$) as a function of qubit frequency. The input to E consists of a final Cryoscope measurement of the flux step response using all real-time filters. The simulation suggests that the main source of $\\Infid$ is Markovian dephasing (as in\u00a0[Unknown Author, \"Unknown Title\", ]), while the dominant contribution to $\\Lone$ is low-frequency flux noise. The latter contrasts with Ref.\u00a0[Unknown Author, \"Unknown Title\", ], where simulation identified flux-pulse distortion as the dominant leakage source. We identify two possible reasons for this difference: in the current experiment, the $1/f$ low-frequency flux noise is $\\sim\\!4$ times larger (in units of $\\Phio/\\sqrt{\\Hz}$) and the achieved flux step response is noticeably sharper. Finally, we use the simulation to compare performance of SNZ to conventional NZ CZ. For the latter, we fix $\\ttwoq=0$, $\\toneq=60~\\ns-\\tp$, and use the fast-adiabatic pulse shape and $\\tp=45.83~\\ns$ optimized by simulation. Overall, the error sources contribute very similarly to the error budget for both cases. The marginally higher overall performance found for SNZ is likely due to the increased time spent at the sweetspot during the $60~\\ns$ allocated for each CZ.\n\n< g r a p h i c s >\n\nError budgets for infidelity $\\Infid$ (a) and leakage $\\Lone$ (b) obtained by a numerical simulation (as in [Unknown Author, \"Unknown Title\", ]) of the $\\QMtwo$-$\\QH$ SNZ CZ gate with parameters in Fig.\u00a04 and for a conventional NZ gate with optimized parameters (see text for details). The simulation incrementally adds errors using experimental input parameters for this pair: (A) no noise; (B) relaxation; (C) Markovian dephasing; (D) dephasing from quasistatic flux noise; and (E) flux-pulse distortion.\n\nIn summary, we have proposed and implemented the sudden variant of the NZ pulsing scheme\u00a0[Unknown Author, \"Unknown Title\", ] realizing flux-based CZ gates by exploiting transverse coupling between computational and non-computation states.\nSNZ operates at the speed limit of transverse coupling by maximizing the intermediate leakage to the non-computational state.\nThe key advantage of SNZ over conventional NZ is ease of tuneup, owing to the simple structure of error landscapes as a function of pulse parameters.\nWe have demonstrated high-fidelity CZ gates between four transmon pairs in a patch of our 7-transmon processor.\nTo the best of our knowledge, the best fidelity extracted from 2QIRB extends the state of the art.\nControl architectures without a timing grid will additionally benefit from the increased speed of SNZ over conventional NZ by reducing the total gate time and thus the impact of decoherence.\nTaking advantage of the tuning simplicity, we already employ SNZ CZ gates in the Starmon-5 quantum processor publicly available via the QuTech Quantum Inspire platform\u00a0[Unknown Author, \"Unknown Title\", ].\nMoving forwards, the full compatibility of SNZ with our proposed\u00a0[Unknown Author, \"Unknown Title\", ] scalable scheme for surface coding makes SNZ our choice for CZ gates as we pursue quantum error correction.\nFinally, the noted straightforward extension of SNZ to arbitrary conditional-phase gates will find immediate application in NISQ applications.\n\nWe thank L.\u00a0Janssen, M.\u00a0Rol, M.\u00a0Sarsby, T.\u00a0Stavenga, and B.\u00a0Tarasinski for experimental assistance, C.\u00a0Eichler and B.\u00a0Terhal for discussions, and G.\u00a0Calusine and W.\u00a0Oliver for providing the travelling-wave parametric amplifier used in the readout amplification chain. This research is supported by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA), via the U.S. Army Research Office Grant No. W911NF-16-1-0071, and by Intel Corporation. The views and conclusions contained herein are those of the authors and should not be interpreted as necessarily representing the official policies or endorsements, either expressed or implied, of the ODNI, IARPA, or the U.S. Government. F.\u00a0B. is supported by ERC Grant EQEC No.\u00a0682726.\n\n41\nfxundefined [1]\nifx#1\n\nfnum [1]\n#1firstoftwo\nsecondoftwo\n\nfx [1]\n#1firstoftwo\nsecondoftwo\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12\\catcode\n`\\&12\\catcode `\\#12\\catcode `\\^12\\catcode `\\_12\\catcode `\\%12\\relax}%\n\\providecommand \\@@startlink[1]{}%\n\\providecommand \\@@endlink[0]{}%\n\\providecommand \\url  [0]{\\begingroup\\@sanitize@url \\@url }%\n\\providecommand \\@url [1]{\\endgroup\\@href {#1}{\\urlprefix }}%\n\\providecommand \\urlprefix  [0]{URL }%\n\\providecommand \\Eprint [0]{\\href }%\n\\providecommand \\doibase [0]{https://doi.org/}%\n\\providecommand \\selectlanguage [0]{\\@gobble}%\n\\providecommand \\bibinfo  [0]{\\@secondoftwo}%\n\\providecommand \\bibfield  [0]{\\@secondoftwo}%\n\\providecommand \\translation [1]{[#1]}%\n\\providecommand \\BibitemOpen [0]{}%\n\\providecommand \\bibitemStop [0]{}%\n\\providecommand \\bibitemNoStop [0]{.\\EOS\\space}%\n\\providecommand \\EOS [0]{\\spacefactor3000\\relax}%\n\\providecommand \\BibitemShut  [1]{\\csname bibitem#1\\endcsname}%\n\\let\\auto@bib@innerbib\\@empty\n%</preamble>\n\\bibitem [{\\citenamefont {Kjaergaard}\\ \\emph {et~al.}(2019)\\citenamefont\n{Kjaergaard}, \\citenamefont {Schwartz}, \\citenamefont {Braum\u00fcller},\n\\citenamefont {Krantz}, \\citenamefont {Wang}, \\citenamefont {Gustavsson},\\\nand\\ \\citenamefont {Oliver}}]{Kjaergaard19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Kjaergaard}}, \\bibinfo {author} {\\bibfnamefont {M.~E.}\\ \\bibnamefont\n{Schwartz}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Braum\u00fcller}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Krantz}},\n\\bibinfo {author} {\\bibfnamefont {J.~I.~J.}\\ \\bibnamefont {Wang}}, \\bibinfo\n{author} {\\bibfnamefont {S.}~\\bibnamefont {Gustavsson}},\\ and\\ \\bibinfo\n{author} {\\bibfnamefont {W.~D.}\\ \\bibnamefont {Oliver}},\\ }\\href\n{https://arxiv.org/abs/1905.13641} {\\bibfield  {journal} {\\bibinfo  {journal}\n{ArXiv:1905.13641}\\ } (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Arute}\\ \\emph {et~al.}(2019)\\citenamefont {Arute},\n\\citenamefont {Arya}, \\citenamefont {Babbush}, \\citenamefont {Bacon},\n\\citenamefont {Bardin}, \\citenamefont {Barends}, \\citenamefont {Biswas},\n\\citenamefont {Boixo}, \\citenamefont {Brandao}, \\citenamefont {Buell},\n\\citenamefont {Burkett}, \\citenamefont {Chen}, \\citenamefont {Chen},\n\\citenamefont {Chiaro}, \\citenamefont {Collins}, \\citenamefont {Courtney},\n\\citenamefont {Dunsworth}, \\citenamefont {Farhi}, \\citenamefont {Foxen},\n\\citenamefont {Fowler}, \\citenamefont {Gidney}, \\citenamefont {Giustina},\n\\citenamefont {Graff}, \\citenamefont {Guerin}, \\citenamefont {Habegger},\n\\citenamefont {Harrigan}, \\citenamefont {Hartmann}, \\citenamefont {Ho},\n\\citenamefont {Hoffmann}, \\citenamefont {Huang}, \\citenamefont {Humble},\n\\citenamefont {Isakov}, \\citenamefont {Jeffrey}, \\citenamefont {Jiang},\n\\citenamefont {Kafri}, \\citenamefont {Kechedzhi}, \\citenamefont {Kelly},\n\\citenamefont {Klimov}, \\citenamefont {Knysh}, \\citenamefont {Korotkov},\n\\citenamefont {Kostritsa}, \\citenamefont {Landhuis}, \\citenamefont\n{Lindmark}, \\citenamefont {Lucero}, \\citenamefont {Lyakh}, \\citenamefont\n{Mandr{\\`{a}}}, \\citenamefont {McClean}, \\citenamefont {McEwen},\n\\citenamefont {Megrant}, \\citenamefont {Mi}, \\citenamefont {Michielsen},\n\\citenamefont {Mohseni}, \\citenamefont {Mutus}, \\citenamefont {Naaman},\n\\citenamefont {Neeley}, \\citenamefont {Neill}, \\citenamefont {Niu},\n\\citenamefont {Ostby}, \\citenamefont {Petukhov}, \\citenamefont {Platt},\n\\citenamefont {Quintana}, \\citenamefont {Rieffel}, \\citenamefont {Roushan},\n\\citenamefont {Rubin}, \\citenamefont {Sank}, \\citenamefont {Satzinger},\n\\citenamefont {Smelyanskiy}, \\citenamefont {Sung}, \\citenamefont\n{Trevithick}, \\citenamefont {Vainsencher}, \\citenamefont {Villalonga},\n\\citenamefont {White}, \\citenamefont {Yao}, \\citenamefont {Yeh},\n\\citenamefont {Zalcman}, \\citenamefont {Neven},\\ and\\ \\citenamefont\n{Martinis}}]{Arute19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Arute}}, \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Arya}},\n\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Babbush}}, \\bibinfo\n{author} {\\bibfnamefont {D.}~\\bibnamefont {Bacon}}, \\bibinfo {author}\n{\\bibfnamefont {J.~C.}\\ \\bibnamefont {Bardin}}, \\bibinfo {author}\n{\\bibfnamefont {R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Biswas}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Boixo}}, \\bibinfo {author} {\\bibfnamefont {F.~G. S.~L.}\\\n\\bibnamefont {Brandao}}, \\bibinfo {author} {\\bibfnamefont {D.~A.}\\\n\\bibnamefont {Buell}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Burkett}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}},\n\\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Collins}}, \\bibinfo {author} {\\bibfnamefont\n{W.}~\\bibnamefont {Courtney}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Farhi}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Foxen}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Fowler}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Gidney}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Giustina}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Graff}}, \\bibinfo {author} {\\bibfnamefont\n{K.}~\\bibnamefont {Guerin}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Habegger}}, \\bibinfo {author} {\\bibfnamefont {M.~P.}\\\n\\bibnamefont {Harrigan}}, \\bibinfo {author} {\\bibfnamefont {M.~J.}\\\n\\bibnamefont {Hartmann}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Ho}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Hoffmann}},\n\\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {Huang}}, \\bibinfo\n{author} {\\bibfnamefont {T.~S.}\\ \\bibnamefont {Humble}}, \\bibinfo {author}\n{\\bibfnamefont {S.~V.}\\ \\bibnamefont {Isakov}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{Z.}~\\bibnamefont {Jiang}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Kafri}}, \\bibinfo {author} {\\bibfnamefont\n{K.}~\\bibnamefont {Kechedzhi}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont {P.~V.}\\\n\\bibnamefont {Klimov}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n{Knysh}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Korotkov}},\n\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Kostritsa}}, \\bibinfo\n{author} {\\bibfnamefont {D.}~\\bibnamefont {Landhuis}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Lindmark}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Lucero}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Lyakh}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Mandr{\\`{a}}}}, \\bibinfo {author} {\\bibfnamefont {J.~R.}\\\n\\bibnamefont {McClean}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{McEwen}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}},\n\\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont {Mi}}, \\bibinfo {author}\n{\\bibfnamefont {K.}~\\bibnamefont {Michielsen}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Mohseni}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Mutus}}, \\bibinfo {author} {\\bibfnamefont\n{O.}~\\bibnamefont {Naaman}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Neeley}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Neill}}, \\bibinfo {author} {\\bibfnamefont {M.~Y.}\\\n\\bibnamefont {Niu}}, \\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{Ostby}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Petukhov}},\n\\bibinfo {author} {\\bibfnamefont {J.~C.}\\ \\bibnamefont {Platt}}, \\bibinfo\n{author} {\\bibfnamefont {C.}~\\bibnamefont {Quintana}}, \\bibinfo {author}\n{\\bibfnamefont {E.~G.}\\ \\bibnamefont {Rieffel}}, \\bibinfo {author}\n{\\bibfnamefont {P.}~\\bibnamefont {Roushan}}, \\bibinfo {author} {\\bibfnamefont\n{N.~C.}\\ \\bibnamefont {Rubin}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {K.~J.}\\\n\\bibnamefont {Satzinger}}, \\bibinfo {author} {\\bibfnamefont {V.}~\\bibnamefont\n{Smelyanskiy}}, \\bibinfo {author} {\\bibfnamefont {K.~J.}\\ \\bibnamefont\n{Sung}}, \\bibinfo {author} {\\bibfnamefont {M.~D.}\\ \\bibnamefont\n{Trevithick}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Vainsencher}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Villalonga}}, \\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {White}},\n\\bibinfo {author} {\\bibfnamefont {Z.~J.}\\ \\bibnamefont {Yao}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Yeh}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Zalcman}}, \\bibinfo {author} {\\bibfnamefont\n{H.}~\\bibnamefont {Neven}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\\n\\bibnamefont {Martinis}},\\ }\\href {https://doi.org/10.1038/s41586-019-1666-5}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {574}},\\ \\bibinfo {pages} {505} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Fowler}\\ \\emph {et~al.}(2012)\\citenamefont {Fowler},\n\\citenamefont {Mariantoni}, \\citenamefont {Martinis},\\ and\\ \\citenamefont\n{Cleland}}]{Fowler12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont\n{Fowler}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Mariantoni}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Martinis}},\\ and\\\n\\bibinfo {author} {\\bibfnamefont {A.~N.}\\ \\bibnamefont {Cleland}},\\ }\\href\n{https://link.aps.org/doi/10.1103/PhysRevA.86.032324} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume} {86}},\\\n\\bibinfo {pages} {032324} (\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Bultink}\\ \\emph {et~al.}(2020)\\citenamefont\n{Bultink}, \\citenamefont {O{\\textquoteright}Brien}, \\citenamefont {Vollmer},\n\\citenamefont {Muthusubramanian}, \\citenamefont {Beekman}, \\citenamefont\n{Rol}, \\citenamefont {Fu}, \\citenamefont {Tarasinski}, \\citenamefont\n{Ostroukh}, \\citenamefont {Varbanov}, \\citenamefont {Bruno},\\ and\\\n\\citenamefont {DiCarlo}}]{Bultink20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~C.}\\ \\bibnamefont\n{Bultink}}, \\bibinfo {author} {\\bibfnamefont {T.~E.}\\ \\bibnamefont\n{O{\\textquoteright}Brien}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Vollmer}}, \\bibinfo {author} {\\bibfnamefont\n{N.}~\\bibnamefont {Muthusubramanian}}, \\bibinfo {author} {\\bibfnamefont\n{M.~W.}\\ \\bibnamefont {Beekman}}, \\bibinfo {author} {\\bibfnamefont {M.~A.}\\\n\\bibnamefont {Rol}}, \\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont\n{Fu}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Tarasinski}},\n\\bibinfo {author} {\\bibfnamefont {V.}~\\bibnamefont {Ostroukh}}, \\bibinfo\n{author} {\\bibfnamefont {B.}~\\bibnamefont {Varbanov}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Bruno}},\\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\bibfield  {journal} {\\bibinfo\n{journal} {Science Advances}\\ }\\textbf {\\bibinfo {volume} {6}},\\ \\href\n{https://doi.org/10.1126/sciadv.aay3050} {10.1126/sciadv.aay3050} (\\bibinfo\n{year} {2020})\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Andersen}\\ \\emph {et~al.}(2019)\\citenamefont\n{Andersen}, \\citenamefont {Remm}, \\citenamefont {Lazar}, \\citenamefont\n{Krinner}, \\citenamefont {Heinsoo}, \\citenamefont {Besse}, \\citenamefont\n{Gabureac}, \\citenamefont {Wallraff},\\ and\\ \\citenamefont\n{Eichler}}]{Andersen19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~K.}\\ \\bibnamefont\n{Andersen}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}},\n\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Lazar}}, \\bibinfo\n{author} {\\bibfnamefont {S.}~\\bibnamefont {Krinner}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Heinsoo}}, \\bibinfo {author} {\\bibfnamefont\n{J.-C.}\\ \\bibnamefont {Besse}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Gabureac}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Wallraff}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Eichler}},\\ }\\href\n{https://doi.org/10.1038/s41534-019-0185-4} {\\bibfield  {journal} {\\bibinfo\n{journal} {npj Quantum Information}\\ }\\textbf {\\bibinfo {volume} {5}},\\\n\\bibinfo {pages} {1} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Andersen}\\ \\emph {et~al.}()\\citenamefont {Andersen},\n\\citenamefont {Remm}, \\citenamefont {Lazar}, \\citenamefont {Krinner},\n\\citenamefont {Lacroix}, \\citenamefont {Norris}, \\citenamefont {Gabureac},\n\\citenamefont {Eichler},\\ and\\ \\citenamefont {Wallraff}}]{Andersen20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~K.}\\ \\bibnamefont\n{Andersen}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}},\n\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Lazar}}, \\bibinfo\n{author} {\\bibfnamefont {S.}~\\bibnamefont {Krinner}}, \\bibinfo {author}\n{\\bibfnamefont {N.}~\\bibnamefont {Lacroix}}, \\bibinfo {author} {\\bibfnamefont\n{G.~J.}\\ \\bibnamefont {Norris}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Gabureac}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Eichler}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Wallraff}},\\ }\\href\n{https://doi.org/10.1038/s41567-020-0920-y} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nat.\\ Phys.}\\ }\\textbf {\\bibinfo {volume} {16}},\\ \\bibinfo {pages}\n{875}}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Strauch}\\ \\emph {et~al.}(2003)\\citenamefont\n{Strauch}, \\citenamefont {Johnson}, \\citenamefont {Dragt}, \\citenamefont\n{Lobb}, \\citenamefont {Anderson},\\ and\\ \\citenamefont\n{Wellstood}}]{Strauch03}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {F.~W.}\\ \\bibnamefont\n{Strauch}}, \\bibinfo {author} {\\bibfnamefont {P.~R.}\\ \\bibnamefont\n{Johnson}}, \\bibinfo {author} {\\bibfnamefont {A.~J.}\\ \\bibnamefont {Dragt}},\n\\bibinfo {author} {\\bibfnamefont {C.~J.}\\ \\bibnamefont {Lobb}}, \\bibinfo\n{author} {\\bibfnamefont {J.~R.}\\ \\bibnamefont {Anderson}},\\ and\\ \\bibinfo\n{author} {\\bibfnamefont {F.~C.}\\ \\bibnamefont {Wellstood}},\\ }\\href\n{https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.91.167005}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf\n{\\bibinfo {volume} {91}},\\ \\bibinfo {pages} {167005} (\\bibinfo {year}\n{2003})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Di{C}arlo}\\ \\emph {et~al.}(2009)\\citenamefont\n{Di{C}arlo}, \\citenamefont {Chow}, \\citenamefont {Gambetta}, \\citenamefont\n{Bishop}, \\citenamefont {Johnson}, \\citenamefont {Schuster}, \\citenamefont\n{Majer}, \\citenamefont {Blais}, \\citenamefont {Frunzio}, \\citenamefont\n{Girvin},\\ and\\ \\citenamefont {Schoelkopf}}]{DiCarlo09}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Di{C}arlo}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo\n{author} {\\bibfnamefont {L.~S.}\\ \\bibnamefont {Bishop}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {D.~I.}\\ \\bibnamefont {Schuster}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Majer}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Blais}}, \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\\n\\bibnamefont {Girvin}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\\n\\bibnamefont {Schoelkopf}},\\ }\\href\n{http://www.nature.com/nature/journal/v460/n7252/abs/nature08121.html}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {460}},\\ \\bibinfo {pages} {240} (\\bibinfo {year}\n{2009})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {{Sheldon}}\\ \\emph {et~al.}(2016)\\citenamefont\n{{Sheldon}}, \\citenamefont {{Magesan}}, \\citenamefont {{Chow}},\\ and\\\n\\citenamefont {{Gambetta}}}]{Sheldon16b}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n{{Sheldon}}}, \\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{{Magesan}}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{{Chow}}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{{Gambetta}}},\\ }\\href {https://doi.org/10.1103/PhysRevA.93.060302}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Physical Review A}\\ }\\textbf\n{\\bibinfo {volume} {93}},\\ \\bibinfo {eid} {060302} (\\bibinfo {year}\n{2016})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Hong}\\ \\emph {et~al.}(2020)\\citenamefont {Hong},\n\\citenamefont {Papageorge}, \\citenamefont {Sivarajah}, \\citenamefont\n{Crossman}, \\citenamefont {Didier}, \\citenamefont {Polloreno}, \\citenamefont\n{Sete}, \\citenamefont {Turkowski}, \\citenamefont {da~Silva},\\ and\\\n\\citenamefont {Johnson}}]{Hong19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.~S.}\\ \\bibnamefont\n{Hong}}, \\bibinfo {author} {\\bibfnamefont {A.~T.}\\ \\bibnamefont\n{Papageorge}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n{Sivarajah}}, \\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont {Crossman}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Didier}}, \\bibinfo\n{author} {\\bibfnamefont {A.~M.}\\ \\bibnamefont {Polloreno}}, \\bibinfo {author}\n{\\bibfnamefont {E.~A.}\\ \\bibnamefont {Sete}}, \\bibinfo {author}\n{\\bibfnamefont {S.~W.}\\ \\bibnamefont {Turkowski}}, \\bibinfo {author}\n{\\bibfnamefont {M.~P.}\\ \\bibnamefont {da~Silva}},\\ and\\ \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}},\\ }\\href\n{https://doi.org/10.1103/PhysRevA.101.012302} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume} {101}},\\ \\bibinfo\n{pages} {012302} (\\bibinfo {year} {2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Barends}\\ \\emph {et~al.}(2019)\\citenamefont\n{Barends}, \\citenamefont {Quintana}, \\citenamefont {Petukhov}, \\citenamefont\n{Chen}, \\citenamefont {Kafri}, \\citenamefont {Kechedzhi}, \\citenamefont\n{Collins}, \\citenamefont {Naaman}, \\citenamefont {Boixo}, \\citenamefont\n{Arute}, \\citenamefont {Arya}, \\citenamefont {Buell}, \\citenamefont\n{Burkett}, \\citenamefont {Chen}, \\citenamefont {Chiaro}, \\citenamefont\n{Dunsworth}, \\citenamefont {Foxen}, \\citenamefont {Fowler}, \\citenamefont\n{Gidney}, \\citenamefont {Giustina}, \\citenamefont {Graff}, \\citenamefont\n{Huang}, \\citenamefont {Jeffrey}, \\citenamefont {Kelly}, \\citenamefont\n{Klimov}, \\citenamefont {Kostritsa}, \\citenamefont {Landhuis}, \\citenamefont\n{Lucero}, \\citenamefont {McEwen}, \\citenamefont {Megrant}, \\citenamefont\n{Mi}, \\citenamefont {Mutus}, \\citenamefont {Neeley}, \\citenamefont {Neill},\n\\citenamefont {Ostby}, \\citenamefont {Roushan}, \\citenamefont {Sank},\n\\citenamefont {Satzinger}, \\citenamefont {Vainsencher}, \\citenamefont\n{White}, \\citenamefont {Yao}, \\citenamefont {Yeh}, \\citenamefont {Zalcman},\n\\citenamefont {Neven}, \\citenamefont {Smelyanskiy},\\ and\\ \\citenamefont\n{Martinis}}]{Barends19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Barends}}, \\bibinfo {author} {\\bibfnamefont {C.~M.}\\ \\bibnamefont\n{Quintana}}, \\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont\n{Petukhov}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}},\n\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Kafri}}, \\bibinfo\n{author} {\\bibfnamefont {K.}~\\bibnamefont {Kechedzhi}}, \\bibinfo {author}\n{\\bibfnamefont {R.}~\\bibnamefont {Collins}}, \\bibinfo {author} {\\bibfnamefont\n{O.}~\\bibnamefont {Naaman}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Boixo}}, \\bibinfo {author} {\\bibfnamefont\n{F.}~\\bibnamefont {Arute}}, \\bibinfo {author} {\\bibfnamefont\n{K.}~\\bibnamefont {Arya}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n{Buell}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Burkett}},\n\\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Foxen}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Fowler}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Gidney}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Giustina}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Graff}}, \\bibinfo {author} {\\bibfnamefont\n{T.}~\\bibnamefont {Huang}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont {P.~V.}\\\n\\bibnamefont {Klimov}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Kostritsa}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Landhuis}},\n\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Lucero}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {McEwen}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author} {\\bibfnamefont\n{X.}~\\bibnamefont {Mi}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Mutus}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Neeley}},\n\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Neill}}, \\bibinfo\n{author} {\\bibfnamefont {E.}~\\bibnamefont {Ostby}}, \\bibinfo {author}\n{\\bibfnamefont {P.}~\\bibnamefont {Roushan}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {K.~J.}\\\n\\bibnamefont {Satzinger}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Vainsencher}}, \\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {White}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Yao}}, \\bibinfo {author}\n{\\bibfnamefont {P.}~\\bibnamefont {Yeh}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Zalcman}}, \\bibinfo {author} {\\bibfnamefont\n{H.}~\\bibnamefont {Neven}}, \\bibinfo {author} {\\bibfnamefont {V.~N.}\\\n\\bibnamefont {Smelyanskiy}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\\n\\bibnamefont {Martinis}},\\ }\\href\n{https://doi.org/10.1103/PhysRevLett.123.210501} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {123}},\\\n\\bibinfo {pages} {210501} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Varbanov}\\ \\emph {et~al.}(2020)\\citenamefont\n{Varbanov}, \\citenamefont {Battistel}, \\citenamefont {Tarasinski},\n\\citenamefont {Ostroukh}, \\citenamefont {O'Brien}, \\citenamefont {Terhal},\\\nand\\ \\citenamefont {DiCarlo}}]{Varbanov20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Varbanov}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Battistel}},\n\\bibinfo {author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont {Tarasinski}},\n\\bibinfo {author} {\\bibfnamefont {V.~P.}\\ \\bibnamefont {Ostroukh}}, \\bibinfo\n{author} {\\bibfnamefont {T.~E.}\\ \\bibnamefont {O'Brien}}, \\bibinfo {author}\n{\\bibfnamefont {B.~M.}\\ \\bibnamefont {Terhal}},\\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href\n{https://arxiv.org/abs/2002.07119} {\\bibfield  {journal} {\\bibinfo  {journal}\n{arXiv:2002.07119}\\ } (\\bibinfo {year} {in prepartion (2020)})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Aliferis}\\ and\\ \\citenamefont\n{Terhal}(2007)}]{Aliferis07}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n{Aliferis}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont\n{Terhal}},\\ }\\href {http://dl.acm.org/citation.cfm?id=2011706.2011715}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Quantum Info. Comput.}\\ }\\textbf\n{\\bibinfo {volume} {7}},\\ \\bibinfo {pages} {139} (\\bibinfo {year}\n{2007})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Ghosh}\\ \\emph {et~al.}(2013)\\citenamefont {Ghosh},\n\\citenamefont {Fowler}, \\citenamefont {Martinis},\\ and\\ \\citenamefont\n{Geller}}]{Ghosh13_B}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Ghosh}}, \\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont {Fowler}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Martinis}},\\ and\\\n\\bibinfo {author} {\\bibfnamefont {M.~R.}\\ \\bibnamefont {Geller}},\\ }\\href\n{https://doi.org/10.1103/PhysRevA.88.062329} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume} {88}},\\ \\bibinfo\n{pages} {062329} (\\bibinfo {year} {2013})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Fowler}(2013)}]{Fowler13}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont\n{Fowler}},\\ }\\href {https://link.aps.org/doi/10.1103/PhysRevA.88.042308}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo\n{volume} {88}},\\ \\bibinfo {pages} {042308} (\\bibinfo {year}\n{2013})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Suchara}\\ \\emph {et~al.}(2015)\\citenamefont\n{Suchara}, \\citenamefont {Cross},\\ and\\ \\citenamefont\n{Gambetta}}]{Suchara15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Suchara}}, \\bibinfo {author} {\\bibfnamefont {A.~W.}\\ \\bibnamefont {Cross}},\\\nand\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}},\\\n}\\href {http://dl.acm.org/citation.cfm?id=2871350.2871358} {\\bibfield\n{journal} {\\bibinfo  {journal} {Quantum Info. Comput.}\\ }\\textbf {\\bibinfo\n{volume} {15}},\\ \\bibinfo {pages} {997} (\\bibinfo {year} {2015})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Ghosh}\\ and\\ \\citenamefont {Fowler}(2015)}]{Ghosh15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Ghosh}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont\n{Fowler}},\\ }\\href {https://doi.org/10.1103/PhysRevA.91.020302} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume}\n{91}},\\ \\bibinfo {pages} {020302} (\\bibinfo {year} {2015})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {DiCarlo}\\ \\emph {et~al.}(2010)\\citenamefont\n{DiCarlo}, \\citenamefont {Reed}, \\citenamefont {Sun}, \\citenamefont\n{Johnson}, \\citenamefont {Chow}, \\citenamefont {Gambetta}, \\citenamefont\n{Frunzio}, \\citenamefont {Girvin}, \\citenamefont {Devoret},\\ and\\\n\\citenamefont {Schoelkopf}}]{DiCarlo10}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{DiCarlo}}, \\bibinfo {author} {\\bibfnamefont {M.~D.}\\ \\bibnamefont {Reed}},\n\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Sun}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont\n{S.~M.}\\ \\bibnamefont {Girvin}}, \\bibinfo {author} {\\bibfnamefont {M.~H.}\\\n\\bibnamefont {Devoret}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\\n\\bibnamefont {Schoelkopf}},\\ }\\href {https://doi.org/10.1038/nature09416}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {467}},\\ \\bibinfo {pages} {574} (\\bibinfo {year}\n{2010})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Barends}\\ \\emph {et~al.}(2014)\\citenamefont\n{Barends}, \\citenamefont {Kelly}, \\citenamefont {Megrant}, \\citenamefont\n{Veitia}, \\citenamefont {Sank}, \\citenamefont {Jeffrey}, \\citenamefont\n{White}, \\citenamefont {Mutus}, \\citenamefont {Fowler}, \\citenamefont\n{Campbell}, \\citenamefont {Chen}, \\citenamefont {Chen}, \\citenamefont\n{Chiaro}, \\citenamefont {Dunsworth}, \\citenamefont {Neill}, \\citenamefont\n{O'Malley}, \\citenamefont {Roushan}, \\citenamefont {Vainsencher},\n\\citenamefont {Wenner}, \\citenamefont {Korotkov}, \\citenamefont {Cleland},\\\nand\\ \\citenamefont {Martinis}}]{Barends14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Barends}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Kelly}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Veitia}}, \\bibinfo {author}\n{\\bibfnamefont {D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont {T.~C.}\\\n\\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Mutus}}, \\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont {Fowler}},\n\\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Campbell}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {Z.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Neill}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {O'Malley}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Roushan}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Vainsencher}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Wenner}}, \\bibinfo {author} {\\bibfnamefont {A.~N.}\\\n\\bibnamefont {Korotkov}}, \\bibinfo {author} {\\bibfnamefont {A.~N.}\\\n\\bibnamefont {Cleland}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\\n\\bibnamefont {Martinis}},\\ }\\href\n{http://www.nature.com/nature/journal/v508/n7497/abs/nature13171.html}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {508}},\\ \\bibinfo {pages} {500} (\\bibinfo {year}\n{2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kelly}\\ \\emph {et~al.}(2015)\\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Fowler}, \\citenamefont {Megrant},\n\\citenamefont {Jeffrey}, \\citenamefont {White}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {Campbell}, \\citenamefont {Chen},\n\\citenamefont {Chiaro}, \\citenamefont {Dunsworth}, \\citenamefont {Hoi},\n\\citenamefont {Neill}, \\citenamefont {O\u2019Malley}, \\citenamefont {Quintana},\n\\citenamefont {Roushan}, \\citenamefont {Vainsencher}, \\citenamefont\n{Cleland},\\ and\\ \\citenamefont {Martinis}}]{Kelly15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Kelly}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Barends}},\n\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont {Fowler}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{T.}~\\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Mutus}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Campbell}},\n\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont {I.-C.}\\\n\\bibnamefont {Hoi}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Neill}}, \\bibinfo {author} {\\bibfnamefont {P.~J.~J.}\\ \\bibnamefont\n{O\u2019Malley}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Quintana}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Vainsencher}}, \\bibinfo\n{author} {\\bibfnamefont {A.~N.}\\ \\bibnamefont {Cleland}, \\bibfnamefont\n{J.~Wenner}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Martinis}},\\ }\\href\n{https://www.nature.com/nature/journal/v519/n7541/full/nature14270.html}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {519}},\\ \\bibinfo {pages} {66} (\\bibinfo {year} {2015})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Martinis}\\ and\\ \\citenamefont\n{Geller}(2014)}]{Martinis14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Martinis}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {M.~R.}\\ \\bibnamefont\n{Geller}},\\ }\\href {https://doi.org/10.1103/PhysRevA.90.022307} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume}\n{90}},\\ \\bibinfo {pages} {022307} (\\bibinfo {year} {2014})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Krinner}\\ \\emph {et~al.}(2020)\\citenamefont\n{Krinner}, \\citenamefont {Lazar}, \\citenamefont {Remm}, \\citenamefont\n{Andersen}, \\citenamefont {Lacroix}, \\citenamefont {Norris}, \\citenamefont\n{Hellings}, \\citenamefont {Gabureac}, \\citenamefont {Eichler},\\ and\\\n\\citenamefont {Wallraff}}]{Krinner20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n{Krinner}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Lazar}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}}, \\bibinfo {author}\n{\\bibfnamefont {C.}~\\bibnamefont {Andersen}}, \\bibinfo {author}\n{\\bibfnamefont {N.}~\\bibnamefont {Lacroix}}, \\bibinfo {author} {\\bibfnamefont\n{G.}~\\bibnamefont {Norris}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Hellings}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Gabureac}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Eichler}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Wallraff}},\\ }\\href {https://arxiv.org/abs/2005.05914}\n{\\bibfield  {journal} {\\bibinfo  {journal} {arXiv preprint arXiv:2005.05914}\\\n} (\\bibinfo {year} {2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chen}\\ \\emph {et~al.}(2014)\\citenamefont {Chen},\n\\citenamefont {Neill}, \\citenamefont {Roushan}, \\citenamefont {Leung},\n\\citenamefont {Fang}, \\citenamefont {Barends}, \\citenamefont {Kelly},\n\\citenamefont {Campbell}, \\citenamefont {Chen}, \\citenamefont {Chiaro},\n\\citenamefont {Dunsworth}, \\citenamefont {Jeffrey}, \\citenamefont {Megrant},\n\\citenamefont {Mutus}, \\citenamefont {O'Malley}, \\citenamefont {Quintana},\n\\citenamefont {Sank}, \\citenamefont {Vainsencher}, \\citenamefont {Wenner},\n\\citenamefont {White}, \\citenamefont {Geller}, \\citenamefont {Cleland},\\ and\\\n\\citenamefont {Martinis}}]{Chen14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Chen}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Neill}},\n\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}}, \\bibinfo\n{author} {\\bibfnamefont {N.}~\\bibnamefont {Leung}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Fang}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Campbell}}, \\bibinfo {author} {\\bibfnamefont\n{Z.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Chiaro}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Dunsworth}},\n\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {J.~Y.}\\ \\bibnamefont {Mutus}}, \\bibinfo {author}\n{\\bibfnamefont {P.~J.~J.}\\ \\bibnamefont {O'Malley}}, \\bibinfo {author}\n{\\bibfnamefont {C.~M.}\\ \\bibnamefont {Quintana}}, \\bibinfo {author}\n{\\bibfnamefont {D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Vainsencher}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Wenner}}, \\bibinfo {author} {\\bibfnamefont {T.~C.}\\\n\\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont {M.~R.}\\ \\bibnamefont\n{Geller}}, \\bibinfo {author} {\\bibfnamefont {A.~N.}\\ \\bibnamefont\n{Cleland}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Martinis}},\\ }\\href {https://doi.org/10.1103/PhysRevLett.113.220502}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf\n{\\bibinfo {volume} {113}},\\ \\bibinfo {pages} {220502} (\\bibinfo {year}\n{2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Yan}\\ \\emph {et~al.}(2018)\\citenamefont {Yan},\n\\citenamefont {Krantz}, \\citenamefont {Sung}, \\citenamefont {Kjaergaard},\n\\citenamefont {Campbell}, \\citenamefont {Orlando}, \\citenamefont\n{Gustavsson},\\ and\\ \\citenamefont {Oliver}}]{Yan18}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Yan}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Krantz}},\n\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Sung}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Kjaergaard}}, \\bibinfo {author}\n{\\bibfnamefont {D.~L.}\\ \\bibnamefont {Campbell}}, \\bibinfo {author}\n{\\bibfnamefont {T.~P.}\\ \\bibnamefont {Orlando}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Gustavsson}},\\ and\\ \\bibinfo {author}\n{\\bibfnamefont {W.~D.}\\ \\bibnamefont {Oliver}},\\ }\\href\n{https://link.aps.org/doi/10.1103/PhysRevApplied.10.054062} {\\bibfield\n{journal} {\\bibinfo  {journal} {Physical Review Applied}\\ }\\textbf {\\bibinfo\n{volume} {10}},\\ \\bibinfo {pages} {054062} (\\bibinfo {year}\n{2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Mundada}\\ \\emph {et~al.}(2019)\\citenamefont\n{Mundada}, \\citenamefont {Zhang}, \\citenamefont {Hazard},\\ and\\ \\citenamefont\n{Houck}}]{Mundada19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n{Mundada}}, \\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont {Zhang}},\n\\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {Hazard}},\\ and\\ \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Houck}},\\ }\\href\n{https://link.aps.org/doi/10.1103/PhysRevApplied.12.054023} {\\bibfield\n{journal} {\\bibinfo  {journal} {Physical Review Applied}\\ }\\textbf {\\bibinfo\n{volume} {12}},\\ \\bibinfo {pages} {054023} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Collodo}\\ \\emph {et~al.}(2020)\\citenamefont\n{Collodo}, \\citenamefont {Herrmann}, \\citenamefont {Lacroix}, \\citenamefont\n{Andersen}, \\citenamefont {Remm}, \\citenamefont {Lazar}, \\citenamefont\n{Besse}, \\citenamefont {Walter}, \\citenamefont {Wallraff},\\ and\\\n\\citenamefont {Eichler}}]{Collodo20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~C.}\\ \\bibnamefont\n{Collodo}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Herrmann}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Lacroix}}, \\bibinfo\n{author} {\\bibfnamefont {C.~K.}\\ \\bibnamefont {Andersen}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Remm}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Lazar}}, \\bibinfo {author} {\\bibfnamefont {J.-C.}\\\n\\bibnamefont {Besse}}, \\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont\n{Walter}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Wallraff}},\\\nand\\ \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Eichler}},\\ }\\href\n{https://arxiv.org/abs/2005.08863} {\\bibfield  {journal} {\\bibinfo  {journal}\n{arXiv preprint arXiv:2005.08863}\\ } (\\bibinfo {year} {2020})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Xu}\\ \\emph {et~al.}(2020)\\citenamefont {Xu},\n\\citenamefont {Chu}, \\citenamefont {Yuan}, \\citenamefont {Qiu}, \\citenamefont\n{Zhou}, \\citenamefont {Zhang}, \\citenamefont {Tan}, \\citenamefont {Yu},\n\\citenamefont {Liu}, \\citenamefont {Li}, \\citenamefont {Yan},\\ and\\\n\\citenamefont {Yu}}]{Xu20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Xu}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Chu}}, \\bibinfo\n{author} {\\bibfnamefont {J.}~\\bibnamefont {Yuan}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Qiu}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Zhou}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Zhang}}, \\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont {Tan}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Yu}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Liu}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Li}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Yan}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Yu}},\\\n}\\href {https://arxiv.org/pdf/2006.11860} {\\bibfield  {journal} {\\bibinfo\n{journal} {arXiv preprint arXiv:2006.11860}\\ } (\\bibinfo {year}\n{2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Schreier}\\ \\emph {et~al.}(2008)\\citenamefont\n{Schreier}, \\citenamefont {Houck}, \\citenamefont {Koch}, \\citenamefont\n{Schuster}, \\citenamefont {Johnson}, \\citenamefont {Chow}, \\citenamefont\n{Gambetta}, \\citenamefont {Majer}, \\citenamefont {Frunzio}, \\citenamefont\n{Devoret}, \\citenamefont {Girvin},\\ and\\ \\citenamefont\n{Schoelkopf}}]{Schreier08}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~A.}\\ \\bibnamefont\n{Schreier}}, \\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont {Houck}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Koch}}, \\bibinfo {author}\n{\\bibfnamefont {D.~I.}\\ \\bibnamefont {Schuster}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Majer}}, \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont {M.~H.}\\\n\\bibnamefont {Devoret}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\\n\\bibnamefont {Girvin}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\\n\\bibnamefont {Schoelkopf}},\\ }\\href\n{https://link.aps.org/doi/10.1103/PhysRevB.77.180502} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Phys. Rev. B}\\ }\\textbf {\\bibinfo {volume} {77}},\\\n\\bibinfo {pages} {180502} (\\bibinfo {year} {2008})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rol}\\ \\emph {et~al.}(2019)\\citenamefont {Rol},\n\\citenamefont {Battistel}, \\citenamefont {Malinowski}, \\citenamefont\n{Bultink}, \\citenamefont {Tarasinski}, \\citenamefont {Vollmer}, \\citenamefont\n{Haider}, \\citenamefont {Muthusubramanian}, \\citenamefont {Bruno},\n\\citenamefont {Terhal},\\ and\\ \\citenamefont {DiCarlo}}]{Rol19}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~A.}\\ \\bibnamefont\n{Rol}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Battistel}},\n\\bibinfo {author} {\\bibfnamefont {F.~K.}\\ \\bibnamefont {Malinowski}},\n\\bibinfo {author} {\\bibfnamefont {C.~C.}\\ \\bibnamefont {Bultink}}, \\bibinfo\n{author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont {Tarasinski}}, \\bibinfo\n{author} {\\bibfnamefont {R.}~\\bibnamefont {Vollmer}}, \\bibinfo {author}\n{\\bibfnamefont {N.}~\\bibnamefont {Haider}}, \\bibinfo {author} {\\bibfnamefont\n{N.}~\\bibnamefont {Muthusubramanian}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Bruno}}, \\bibinfo {author} {\\bibfnamefont {B.~M.}\\\n\\bibnamefont {Terhal}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {DiCarlo}},\\ }\\href\n{https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.123.120502}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf\n{\\bibinfo {volume} {123}},\\ \\bibinfo {pages} {120502} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kjaergaard}\\ \\emph {et~al.}(2020)\\citenamefont\n{Kjaergaard}, \\citenamefont {Schwartz}, \\citenamefont {Greene}, \\citenamefont\n{Samach}, \\citenamefont {A.~Bengtsson}, \\citenamefont {McNally},\n\\citenamefont {Braum\u00fcller}, \\citenamefont {Kim}, \\citenamefont {Krantz},\n\\citenamefont {Marvian}, \\citenamefont {Melville}, \\citenamefont\n{Niedzielski}, \\citenamefont {Sung}, \\citenamefont {Winik}, \\citenamefont\n{Yoder}, \\citenamefont {Rosenberg}, \\citenamefont {K.~Obenland},\n\\citenamefont {Orlando}, \\citenamefont {Marvian}, \\citenamefont\n{Gustavsson},\\ and\\ \\citenamefont {Oliver}}]{Kjaergaard20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Kjaergaard}}, \\bibinfo {author} {\\bibfnamefont {M.~E.}\\ \\bibnamefont\n{Schwartz}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Greene}},\n\\bibinfo {author} {\\bibfnamefont {G.~O.}\\ \\bibnamefont {Samach}}, \\bibinfo\n{author} {\\bibfnamefont {M.~O.}\\ \\bibnamefont {A.~Bengtsson}}, \\bibinfo\n{author} {\\bibfnamefont {C.~M.}\\ \\bibnamefont {McNally}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Braum\u00fcller}}, \\bibinfo {author}\n{\\bibfnamefont {D.~K.}\\ \\bibnamefont {Kim}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Krantz}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Marvian}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Melville}}, \\bibinfo {author} {\\bibfnamefont {B.~M.}\\\n\\bibnamefont {Niedzielski}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Sung}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Winik}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Yoder}},\n\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Rosenberg}}, \\bibinfo\n{author} {\\bibfnamefont {S.~L.}\\ \\bibnamefont {K.~Obenland}}, \\bibinfo\n{author} {\\bibfnamefont {.~T.~P.}\\ \\bibnamefont {Orlando}}, \\bibinfo {author}\n{\\bibfnamefont {I.}~\\bibnamefont {Marvian}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Gustavsson}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{W.~D.}\\ \\bibnamefont {Oliver}},\\ }\\href {https://arxiv.org/pdf/2001.08838}\n{\\bibfield  {journal} {\\bibinfo  {journal} {ArXiv:2001.08838}\\ } (\\bibinfo\n{year} {2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Magesan}\\ \\emph {et~al.}(2012)\\citenamefont\n{Magesan}, \\citenamefont {Gambetta},\\ and\\ \\citenamefont\n{Emerson}}]{Magesan12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{Magesan}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Gambetta}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Emerson}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. A}\\ }\\textbf {\\bibinfo {volume} {85}},\\ \\bibinfo {pages} {042311}\n(\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Wood}\\ and\\ \\citenamefont {Gambetta}(2018)}]{Wood18}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~J.}\\ \\bibnamefont\n{Wood}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Gambetta}},\\ }\\href {https://doi.org/10.1103/PhysRevA.97.032306} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume}\n{97}},\\ \\bibinfo {pages} {032306} (\\bibinfo {year} {2018})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Versluis}\\ \\emph {et~al.}(2017)\\citenamefont\n{Versluis}, \\citenamefont {Poletto}, \\citenamefont {Khammassi}, \\citenamefont\n{Tarasinski}, \\citenamefont {Haider}, \\citenamefont {Michalak}, \\citenamefont\n{Bruno}, \\citenamefont {Bertels},\\ and\\ \\citenamefont\n{DiCarlo}}]{Versluis17}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Versluis}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Poletto}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Khammassi}}, \\bibinfo\n{author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont {Tarasinski}}, \\bibinfo\n{author} {\\bibfnamefont {N.}~\\bibnamefont {Haider}}, \\bibinfo {author}\n{\\bibfnamefont {D.~J.}\\ \\bibnamefont {Michalak}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Bruno}}, \\bibinfo {author} {\\bibfnamefont\n{K.}~\\bibnamefont {Bertels}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {DiCarlo}},\\ }\\href\n{https://doi.org/10.1103/PhysRevApplied.8.034021} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Phys. Rev. Appl.}\\ }\\textbf {\\bibinfo {volume} {8}},\\\n\\bibinfo {pages} {034021} (\\bibinfo {year} {2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Lacroix}\\ \\emph {et~al.}(2020)\\citenamefont\n{Lacroix}, \\citenamefont {Hellings}, \\citenamefont {Kraglund~Andersen},\n\\citenamefont {Di~Paolo}, \\citenamefont {Remm}, \\citenamefont {Lazar},\n\\citenamefont {Krinner}, \\citenamefont {Norris}, \\citenamefont {Gabureac},\n\\citenamefont {Blais}, \\citenamefont {Eichler},\\ and\\ \\citenamefont\n{Wallraff}}]{Lacroix20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n{Lacroix}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Hellings}},\n\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Kraglund~Andersen}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Di~Paolo}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Lazar}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Krinner}}, \\bibinfo {author} {\\bibfnamefont {G.~J.}\\\n\\bibnamefont {Norris}}, \\bibinfo {author} {\\bibfnamefont {M.~G.}\\\n\\bibnamefont {Gabureac}}, \\bibinfo {author} {\\bibfnamefont {A.~B.}\\\n\\bibnamefont {Blais}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Eichler}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Wallraff}},\\ }\\href {https://arxiv.org/abs/2005.05275} {\\bibfield  {journal}\n{\\bibinfo  {journal} {arXiv preprint arXiv:2005.05275}\\ } (\\bibinfo {year}\n{2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Barends}\\ \\emph {et~al.}(2015)\\citenamefont\n{Barends}, \\citenamefont {Lamata}, \\citenamefont {Kelly}, \\citenamefont\n{Garc{\\'\\i}a-{\\'A}lvarez}, \\citenamefont {Fowler}, \\citenamefont {Megrant},\n\\citenamefont {Jeffrey}, \\citenamefont {White}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {Campbell}, \\citenamefont {Chen},\n\\citenamefont {Chen}, \\citenamefont {Chiaro}, \\citenamefont {Dunsworth},\n\\citenamefont {Hoi}, \\citenamefont {Neill}, \\citenamefont {O\u2019Malley},\n\\citenamefont {Quintana}, \\citenamefont {Roushan}, \\citenamefont\n{Vainsencher}, \\citenamefont {Wenner}, \\citenamefont {Solano},\\ and\\\n\\citenamefont {Martinis}}]{Barends15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Barends}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Lamata}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Kelly}}, \\bibinfo\n{author} {\\bibfnamefont {L.}~\\bibnamefont {Garc{\\'\\i}a-{\\'A}lvarez}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Fowler}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{T.}~\\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Mutus}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Campbell}},\n\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {Z.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont {I.-C.}\\\n\\bibnamefont {Hoi}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Neill}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {O\u2019Malley}},\n\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Quintana}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Vainsencher}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Wenner}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Solano}},\\ and\\ \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Martinis}},\\ }\\href\n{http://www.nature.com/articles/ncomms8654} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nat.\\ Commun.}\\ }\\textbf {\\bibinfo {volume} {6}},\\ \\bibinfo\n{pages} {7654} (\\bibinfo {year} {2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Preskill}(2018)}]{Preskill18}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Preskill}},\\ }\\href {https://doi.org/10.22331/q-2018-08-06-79} {\\bibfield\n{journal} {\\bibinfo  {journal} {{Quantum}}\\ }\\textbf {\\bibinfo {volume}\n{2}},\\ \\bibinfo {pages} {79} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{SOM()}]{SOM_SNZ}%\n\\BibitemOpen\n\\href@noop {} {}\\bibinfo {note} {See supplemental material.}\\BibitemShut\n{Stop}%\n\\bibitem [{\\citenamefont {Heinsoo}\\ \\emph {et~al.}(2018)\\citenamefont\n{Heinsoo}, \\citenamefont {Andersen}, \\citenamefont {Remm}, \\citenamefont\n{Krinner}, \\citenamefont {Walter}, \\citenamefont {Salath\\'e}, \\citenamefont\n{Gasparinetti}, \\citenamefont {Besse}, \\citenamefont\n{Poto\\ifmmode~\\check{c}\\else \\v{c}\\fi{}nik}, \\citenamefont {Wallraff},\\ and\\\n\\citenamefont {Eichler}}]{Heinsoo18}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Heinsoo}}, \\bibinfo {author} {\\bibfnamefont {C.~K.}\\ \\bibnamefont\n{Andersen}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}},\n\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Krinner}}, \\bibinfo\n{author} {\\bibfnamefont {T.}~\\bibnamefont {Walter}}, \\bibinfo {author}\n{\\bibfnamefont {Y.}~\\bibnamefont {Salath\\'e}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Gasparinetti}}, \\bibinfo {author}\n{\\bibfnamefont {J.-C.}\\ \\bibnamefont {Besse}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Poto\\ifmmode~\\check{c}\\else\n\\v{c}\\fi{}nik}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Wallraff}},\\ and\\ \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Eichler}},\\ }\\href {https://doi.org/10.1103/PhysRevApplied.10.034040}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Appl.}\\ }\\textbf\n{\\bibinfo {volume} {10}},\\ \\bibinfo {pages} {034040} (\\bibinfo {year}\n{2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rol}\\ \\emph {et~al.}(2020)\\citenamefont {Rol},\n\\citenamefont {Ciorciaro}, \\citenamefont {Malinowski}, \\citenamefont\n{Tarasinski}, \\citenamefont {Sagastizabal}, \\citenamefont {Bultink},\n\\citenamefont {Salathe}, \\citenamefont {Haandbaek}, \\citenamefont {Sedivy},\\\nand\\ \\citenamefont {DiCarlo}}]{Rol20}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~A.}\\ \\bibnamefont\n{Rol}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Ciorciaro}},\n\\bibinfo {author} {\\bibfnamefont {F.~K.}\\ \\bibnamefont {Malinowski}},\n\\bibinfo {author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont {Tarasinski}},\n\\bibinfo {author} {\\bibfnamefont {R.~E.}\\ \\bibnamefont {Sagastizabal}},\n\\bibinfo {author} {\\bibfnamefont {C.~C.}\\ \\bibnamefont {Bultink}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Salathe}}, \\bibinfo {author}\n{\\bibfnamefont {N.}~\\bibnamefont {Haandbaek}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Sedivy}},\\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href\n{https://doi.org/10.1063/1.5133894} {\\bibfield  {journal} {\\bibinfo\n{journal} {Applied Physics Letters}\\ }\\textbf {\\bibinfo {volume} {116}},\\\n\\bibinfo {pages} {054001} (\\bibinfo {year} {2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Nijholt}\\ \\emph {et~al.}(2019)\\citenamefont\n{Nijholt}, \\citenamefont {Weston}, \\citenamefont {Hoofwijk},\\ and\\\n\\citenamefont {Akhmerov}}]{Nijholt2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Nijholt}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Weston}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Hoofwijk}},\\ and\\\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Akhmerov}},\\ }\\href\n{https://doi.org/10.5281/zenodo.1182437} {\\bibinfo {title}\n{\\textit{Adaptive}: parallel active learning of mathematical functions}}\n(\\bibinfo {year} {2019})\\BibitemShut {NoStop}%\n\\bibitem [{Qua()}]{QuantumInspire}%\n\\BibitemOpen\n\\href {https://www.quantum-inspire.com/} {\\bibinfo {title} {{Q}utech\n{Q}uantum {I}nspire}},\\ \\bibinfo {note}\n{\\url{https://www.quantum-inspire.com/}}\\BibitemShut {NoStop}%\n\\end{thebibliography}%\n\\end{bibunit}\n\n\\begin{bibunit}[apsrev4-1]\n\\onecolumngrid\n\\clearpage\n\\renewcommand{\\theequation}{S\\arabic{equation}}\n\\renewcommand{\\thefigure}{S\\arabic{figure}}\n\\renewcommand{\\thetable}{S\\arabic{table}}\n\\renewcommand{\\bibnumfmt}[1]{[S#1]}\n\\renewcommand{\\citenumfont}[1]{S#1}\n\\setcounter{figure}{0}\n\\setcounter{equation}{0}\n\\setcounter{table}{0}\n\n\\section*{Supplemental material for 'High-fidelity controlled-Z gate with maximal intermediate leakage operating at the speed limit in a superconducting quantum processor'}\n\\date{\\today}\n\nThis supplement provides additional information in support of statements and claims made in the main text.\nSection \\ref{sec:one} summarizes the main differences between conventional NZ pulses and SNZ pulses.\nSection \\ref{sec:two} provides further details on the device used and measured transmon parameters.\nSection \\ref{sec:three} presents the characterization of single-qubit gate performance.\nSection \\ref{sec:four} provides evidence for the two-level system affecting the realization of SNZ CZ gates in pair $$-$$ using the $|11\u27e9$-$|02\u27e9$ interaction.\nSection \\ref{sec:five} presents a characterization of the residual $ZZ$ coupling between qubits at the bias point.\nSection \\ref{sec:six} summarizes the technical details of the CZ characterization by repeated 2QIRB.\n\n\\section{Comparison of conventional NZ pulses and SNZ pulses}\n\\label{sec:one}\n\nThis section highlights the main differences between conventional NZ pulses and the SNZ pulses introduced here.\nThe conventional NZ strong pulse [Fig.~S1(a)] consists of two back-to-back half pulses of duration $/2$ each, applied on the higher-frequency transmon. Typically, $/\u223c1.1-1.6$. The strong half pulses are formally parametrized as in~\\cite{Martinis14}. For the purposes of illustration, here we can loosely lump this parametrization as affecting the amplitude ($\u00b1A$) and curvature ($A'$) of the strong half pulses. Immediately following the strong pulse, weak bipolar pulses of duration $$ are applied on both the higher- and lower-frequency transmons with amplitudes $\u00b1C$ and $\u00b1D$, respectively, in order to null the single-qubit phases acquired by each. Typically, $=10\u00a0$.\nIn conventional NZ there is no intermediate idling period between the strong half pulses, so the analogy to the MZI is not exact [Fig.~S1(c)].\nDuring tuneup, one searches the $(A,A')$ space to achieve $=(=\u03c0)$ by only affecting the unitary action of the two beamsplitters.\nBecause for typical $$ conventional NZ produces significant leakage at the first strong pulse, achieving minimal leakage relies on meeting LC2.\nThe structure of the $(A,A')$ and $(A,A')$  landscapes and especially their interrelation are not straightforward, so the search for an $(A,A')$ setting satisfying both PC and LC2 is not easily guided.\nWe point the interested reader to~\\cite{Rol19} for examples.\n\nThe SNZ pulses introduced here [Fig.~S1(b)] differ in two key ways. First, the strong half pulses are replaced by square half pulses each with duration $/2$ as close as possible to $/2$ (as allowed by the AWG sampling period) but not shorter. Second, an intermediate idling period $$ is added to accrue relative phase $\u03d5$ between $|02\u27e9$ and $|11\u27e9$, perfecting the analogy to the MZI [Fig.~S1(d)]. We use the amplitude $\u00b1B$ of the first and last sampling points in $$ and the number of intermediate zero-amplitude points to achieve fine and coarse control of $\u03d5$, respectively. As in conventional NZ, we use weak bipolar pulses on both transmons (also with $=10\u00a0$) to null the single-qubit phases. During tuneup, we search the $(A,B)$ space to achieve $=(=\u03c0)$. As shown in the main text, the SNZ pulse design gives a very simple structure to the $(A,B)$ and $(A,B)$ landscapes. Crucially, the crossing point of leakage valleys satisfying LC2 and LC3 matches $=180$. This simplicity of tuneup is the key advantage of SNZ over conventional NZ.\n\nAnother advantage of SNZ over conventional CZ is the reduced total time $=++$ required to achieve a CZ gate. However, due to the $20\u00a0$ timing grid of our control electronics and the transverse coupling strengths\nin our device, this speedup is insufficient to reduce the total time allocated per CZ gate from $60$ to $40\u00a0$. Nonetheless, in SNZ, the fluxed transmon spends more time at its sweetspot, which reduces the dephasing due to flux noise.\n\n\\begin{figure}[h!]\n\\includegraphics[width=0.8\\columnwidth]{FigureS1}\n\\caption{\nComparison of conventional NZ and SNZ pulses for CZ gates.\n(a) Conventional NZ CZ pulses consist of two back-to-back strong half pulses of duration $/2$ each, followed by two weak back-to-back half pulses of duration $/2$ each on the higher-frequency qubit. The amplitude ($\u00b1A$) and curvature ($A'$) of the strong pulses are jointly tuned to set the conditional phasse $$ at minimal leakage $$ , while the amplitude $\u00b1C$ of the weak pulses is used to null the single-qubit phase on the higher-frequency transmon. Weak pulses (amplitude $\u00b1D$) on the lower-frequency qubit (not shown here) are also used to null its single-qubit phase.\n(b) In SNZ, the strong pulses are replaced by square pulses with $$ as close as possible to $$ but not shorter. Also, an intermediate idling period $$ is added to accrue relative phase $\u03d5$ between $|02\u27e9$ and $|11\u27e9$. The amplitude $\u00b1B$ of the first and last sampling points in $$ and the number of intermediate zero-amplitude points provide fine and coarse control of this relative phase, respectively. SNZ CZ gates also use weak bipolar pulses (now square) of total duration $$ to null single-qubit phases.\n(c) The MZI analogy for conventional NZ pulses is incomplete. Each strong half pulse implements a beamsplitter (ideally identical) with scattering parameters affected by $A$ and $A'$. However, there is no possibility to independently control the relative phase in the two arms between the beamsplitters.\n(d) The MZI analogy is exact for SNZ pulse. The scattering at the beamsplitters is controlled by $A$ and the relative phase $\u03d5$ is controlled finely using $B$ and coarsely using $$.\n}\n\\end{figure}\n\n\\section{Device and transmon parameters}\n\\label{sec:two}\nOur experimental study focuses on four transmons in a patch of our 7-qubit processor.\nAn optical image of the device, zoomed in to these four transmons, is shown in Fig.~S2.\nTransmons $$ and $$ both connect to $$ and $$ with a dedicated coupling bus resonator for each connection.\nEvery transmon has a dedicated microwave-drive line for single-qubit gating, a flux-control line used for CZ gating, and a dispersively-coupled readout resonator with dedicated Purcell filter~\\cite{Heinsoo18, Bultink20} for readout.\nReadout is performed by frequency multiplexed measurement of a common feedline capacitively connected to all four Purcell filters. Table~S1 provides a summary of measured parameters for the four transmons.\n\n\\begin{figure}[h!]\n\\includegraphics[width=0.7\\columnwidth]{FigureS2}\n\\caption{\nOptical image of the device, zoomed in to the four transmons used in this study and with added false color to help identify circuit elements.\nTransmons $$ (red) and $$ (pink) each connect to $$ (green) and $$ (cyan) using dedicated coupling bus resonators for each pair (light orange).\nEach transmon has a flux-control line for two-qubit gating (yellow), a microwave-drive line for single-qubit gating (dark orange), and dispersively-coupled resonator with Purcell filter for readout (purple)~\\cite{Heinsoo18, Bultink20}. The readout-resonator/Purcell-filter pair for $$ is visible at the center of this image.\nThe vertically running common feedline (blue) connects to all Purcell filters, enabling simultaneous readout of the four transmons by frequency multiplexing.\nAir-bridge crossovers enable the routing of all input and output lines to the edges of the chip, where they connect to a printed circuit board through aluminum wirebonds.\n}\n\\end{figure}\n\n\\begin{table}[h!]\n\\setlength{\\tabcolsep}{12pt}\n\\renewcommand{\\arraystretch}{1.2}\n\\begin{tabular}{lcccc}\n\\hline\n& $$  & $$   &  $$  &  $$\u00a0 \\\\\n\\hline\nQubit transition frequency at sweetspot, $\u03c9_q/2\u03c0$ $()$\u00a0& 6.4329 & 5.7707 & 5.8864 & 4.5338 \\\\\nTransmon anharmonicity, \\(\\alpha/2\\pi\\) $()$\u00a0& -280 & -290 & -285 & -320 \\\\\nReadout frequency, $\u03c9_r/2\u03c0$ $()$\u00a0& 7.4925 & 7.2248 & 7.0584 & 6.9132 \\\\\nRelaxation time, $$ $()$  & $37\u00b11$ & $40\u00b11$ & $47\u00b11$ & $66\u00b11$ \\\\\nRamsey dephasing time, $$ $()$  & $38\u00b11$ & $49\u00b11$ & $47\u00b11$ & $64\u00b11$ \\\\\nEcho dephasing time, $$ $()$  & $54\u00b12$ & $68\u00b11$ & $77\u00b11$ & $94\u00b12$ \\\\\nResidual qubit excitation, $(\n`&12`#12`1\u03022`_12`\nstartlink[1]\nendlink[0]\n\nrl [1]href #1\n\n@bib@innerbibempty\n\n[Martinis and Geller(2014)]Martinis14\nauthor author J.\u00a0M. Martinis and author M.\u00a0R. Geller, https://doi.org/10.1103/PhysRevA.90.022307 journal journal Phys. Rev. A volume\n90, pages 022307 (year 2014)NoStop\n[Rol et\u00a0al.(2019)Rol,\nBattistel, Malinowski, Bultink, Tarasinski, Vollmer, Haider, Muthusubramanian, Bruno,\nTerhal, and DiCarlo]Rol19\nauthor author M.\u00a0A. Rol, author F.\u00a0Battistel,\nauthor F.\u00a0K. Malinowski,\nauthor C.\u00a0C. Bultink, author B.\u00a0M. Tarasinski, author R.\u00a0Vollmer, author\nN.\u00a0Haider, author N.\u00a0Muthusubramanian, author A.\u00a0Bruno, author B.\u00a0M.  Terhal, and author L.\u00a0DiCarlo, https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.123.120502\njournal journal Phys. Rev. Lett. volume 123, pages 120502 (year\n2019)NoStop\n[Heinsoo et\u00a0al.(2018)Heinsoo, Andersen, Remm, Krinner, Walter, Salath\u00e9, Gasparinetti, Besse, Poto\u00a0\u010d\u010dnik, Wallraff, and  Eichler]Heinsoo18\nauthor author J.\u00a0Heinsoo, author C.\u00a0K. Andersen, author A.\u00a0Remm,\nauthor S.\u00a0Krinner, author T.\u00a0Walter, author\nY.\u00a0Salath\u00e9, author\nS.\u00a0Gasparinetti, author\nJ.-C. Besse, author\nA.\u00a0Poto\u00a0\u010d\u010dnik, author A.\u00a0Wallraff, and author C.\u00a0Eichler, https://doi.org/10.1103/PhysRevApplied.10.034040\njournal journal Phys. Rev. Appl. volume 10, pages 034040 (year\n2018)NoStop\n[Bultink et\u00a0al.(2020)Bultink, O\u2019Brien, Vollmer,\nMuthusubramanian, Beekman, Rol, Fu, Tarasinski, Ostroukh, Varbanov, Bruno, and  DiCarlo]Bultink20\nauthor author C.\u00a0C. Bultink, author T.\u00a0E. O\u2019Brien, author R.\u00a0Vollmer, author N.\u00a0Muthusubramanian, author M.\u00a0W. Beekman, author M.\u00a0A.  Rol, author X.\u00a0Fu, author B.\u00a0Tarasinski,\nauthor V.\u00a0Ostroukh, author B.\u00a0Varbanov, author\nA.\u00a0Bruno, and author\nL.\u00a0DiCarlo, journal journal Science Advances volume 6, https://doi.org/10.1126/sciadv.aay3050 10.1126/sciadv.aay3050 (year 2020)NoStop\n[Krantz et\u00a0al.(2019)Krantz,\nKjaergaard, Yan, Orlando,\nGustavsson, and Oliver]Krantz19\nauthor author P.\u00a0Krantz, author M.\u00a0Kjaergaard,\nauthor F.\u00a0Yan, author\nT.\u00a0P. Orlando, author\nS.\u00a0Gustavsson, and author\nW.\u00a0D. Oliver, https://doi.org/10.1063/1.5089550 journal journal Appl. Phys. Rev. volume 6, pages 021318 (year 2019)NoStop\n[Bultink et\u00a0al.(2018)Bultink, Tarasinski, Haandbaek,\nPoletto, Haider, Michalak,\nBruno, and DiCarlo]Bultink18\nauthor author C.\u00a0C. Bultink, author B.\u00a0Tarasinski,\nauthor N.\u00a0Haandbaek, author S.\u00a0Poletto, author\nN.\u00a0Haider, author D.\u00a0J. Michalak, author A.\u00a0Bruno, and author L.\u00a0DiCarlo, https://doi.org/10.1063/1.5015954\njournal journal Appl. Phys. Lett. volume 112, pages 092601 (year\n2018)NoStop\n[Motzoi et\u00a0al.(2009)Motzoi,\nGambetta, Rebentrost, and Wilhelm]Motzoi09\nauthor author F.\u00a0Motzoi, author J.\u00a0M. Gambetta, author P.\u00a0Rebentrost, and author F.\u00a0K. Wilhelm, https://journals.aps.org/prl/abstract/10.1103/PhysRevLett.103.110501\njournal journal Phys. Rev. Lett. volume 103, pages 110501 (year\n2009)NoStop\n[Chow et\u00a0al.(2010)Chow,\nDiCarlo, Gambetta, Motzoi,\nFrunzio, Girvin, and Schoelkopf]Chow10b\nauthor author J.\u00a0M. Chow, author L.\u00a0DiCarlo,\nauthor J.\u00a0M. Gambetta, author F.\u00a0Motzoi, author\nL.\u00a0Frunzio, author S.\u00a0M. Girvin, and author R.\u00a0J. Schoelkopf, https://journals.aps.org/pra/abstract/10.1103/PhysRevA.82.040305 journal journal Phys. Rev. A volume\n82, pages 040305 (year 2010)NoStop\n[Nijholt et\u00a0al.(2019)Nijholt, Weston, Hoofwijk, and  Akhmerov]Nijholt2019\nauthor author B.\u00a0Nijholt, author J.\u00a0Weston,\nauthor J.\u00a0Hoofwijk, and  author A.\u00a0Akhmerov, https://doi.org/10.5281/zenodo.1182437 title\nAdaptive: parallel active learning of mathematical functions\n(year 2019)NoStop\n\n"}
{"prompt": "Explain the methodology used in the paper 'A simple all-microwave entangling gate for fixed-frequency superconducting qubits'.", "completion": "\n\n# A simple all-microwave entangling gate for fixed-frequency superconducting qubits\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nRaytheon BBN Technologies, Cambridge, MA 02138, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nWe demonstrate an all-microwave two-qubit gate on superconducting qubits which are fixed in frequency at optimal bias points. The gate requires no additional subcircuitry and is tunable via the amplitude of microwave irradiation on one qubit at the transition frequency of the other. We use the gate to generate entangled states with a maximal extracted concurrence of $0.88$ and quantum process tomography reveals a gate fidelity of $81\\%$.\n\n03.67.Ac, 42.50.Pq, 85.25.-j\n\nA basic requirement for fault tolerant quantum computing is a universal set of nearly perfect one- and two-qubit gates. As high-fidelity single-qubit operations on superconducting qubits become routine\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the focus shifts onto developing robust and scalable two-qubit gates. Already, rapid progress has been made, including a controlled-NOT (CNOT) gate with fixed coupled qubits\u00a0[Unknown Author, \"Unknown Title\", ], and highly entangled states of two\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and three\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] qubits generated from tuning qubits to explicit resonances.\n\nAlthough scaling up superconducting systems with many fixed mutual couplings between qubits is simple to experimentally design, it becomes difficult to control the effective interaction between qubits. Alternatively, this control can be achieved by 1)\u00a0tuning the coupling energy between the qubits; or 2)\u00a0dynamically changing the detuning between qubits in the presence of some small fixed coupling. In the first case, the coupling takes the form of a non-linear tunable subcircuit which can be driven with either microwaves [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or dc\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. This scheme has the benefit of allowing the qubits to be operated at their optimal bias points for coherence. However, the additional control lines for the tunable subcircuit can also result in added circuit complexity. In the second case, which requires no additional controls other than those for operating the individual qubits, two-qubit gates have been demonstrated such as $\\sqrt{i\\text{SWAP}}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and conditional phase\u00a0[Unknown Author, \"Unknown Title\", ] by tuning the qubit energy levels into explicit resonance conditions. Although this scheme has been effective for systems up to three qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], tuning qubit frequencies in devices with even more qubits could lead to unwanted coupling to noncomputational energy levels of the system and to spurious modes of the electromagnetic environment. Hence, desiderata for a scalable qubit coupling would combine tunability of the effective coupling strength with the simplicity of fixed coupling, in an architecture amenable to a larger number of qubits.\n\nIn this Letter, we demonstrate a new two-qubit gate which combines the hardware simplicity of a fixed coupling scheme with a tunable effective interaction enacted with only microwave control\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], all on a quantum bus architecture\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Two capacitively-shunted flux qubits\u00a0[Unknown Author, \"Unknown Title\", ] (CSFQs) are dispersively coupled through a microwave cavity and parked at locations of optimal coherence. We find that a two-qubit interaction turns on linearly with the amplitude of an applied cross-resonant (CR) drive, in which microwaves resonant with a target qubit are applied on the other control qubit. Up to single-qubit rotations, the CR two-qubit gate is related to the canonical CNOT, and we use it to generate entangled states with a maximal extracted concurrence of $0.88$. Furthermore, quantum process tomography reveals a gate fidelity of $81\\%$, with residual errors due to coherence times and single-qubit gate calibration.\n\nCSFQs are a suitable choice for testing the CR protocol, since they have been shown to give consistently long coherence times in a circuit QED scheme\u00a0[Unknown Author, \"Unknown Title\", ]. Figures\u00a0(Figure fig:1)(a-b) show the schematic of our experimental setup and optical images of our device, in which two qubits are coupled to opposite ends of a coplanar-waveguide resonator ($\\omega_{\\text{R}}/2\\pi = 9.72\\,\\GHz$) and on-chip flux bias lines (FBLs) are used to independently tune them to their flux sweet-spot transition frequencies,  $\\omega_1/2\\pi = 5.854\\,\\GHz$ and $\\omega_2/2\\pi = 5.528\\,\\GHz$. Here, we find optimal relaxation [$T_1^{\\text{1(2)}}=1.6\\,(1.5)\\,\\us$] and decoherence [$T_2^{*,\\text{1(2)}}=1.6\\,(1.5)\\,\\us$] times for both qubits. Operating in the dispersive regime of circuit QED, we measure cavity shifts $\\chi_1/\\pi = 1.1\\,\\MHz$ and $\\chi_2/\\pi = 0.6\\,\\MHz$ permitting a joint two-qubit readout\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. To avoid errors due to the finite qubit anharmonicities, $\\alpha_1/2\\pi = \\omega_1^{12}-\\omega_1^{01} = 224$ MHz and $\\alpha_2/2\\pi = \\omega_2^{12}-\\omega_2^{01} = 255$ MHz, we use gaussians with quadrature derivative pulse-shaping $\\sigma = 4\\,\\ns$, total gate length $4\\sigma$,  for single-qubit gates\u00a0[Unknown Author, \"Unknown Title\", ], $\\{X,Y,X_{\\pm90},Y_{\\pm90}\\}$. We use the notation $A_{\\theta}=\\exp(-i\\theta A \\pi/360)$ for a rotation of $\\theta$ around $A$, and drop the subscript for Pauli operators. The standard deviation of the gaussian shapes is $\\sigma = 4\\,\\ns$ with total gate length $4\\sigma$ and the derivative scale parameter\u00a0[Unknown Author, \"Unknown Title\", ] is experimentally determined to be $-1.4$ for both qubits.\n\n< g r a p h i c s >\n\n(color online)\u00a0Circuit schematic and two-qubit device.\u00a0 (a) Circuit schematic showing two CSFQs (Q1, red on left and Q2, blue on right) with shunt capacitance $C_{\\text{S}}$ and small junction ratio $\\alpha$, coupled to a single resonator. The qubit-cavity coupling is governed by $C_{\\text{g}}$.  Each qubit has an on-chip local flux-bias line which is used to both dc tune the energy levels and serve as a microwave excitation port for driving transitions. Two-qubit joint readout is performed by probing the system through the input port near the cavity frequency and detecting the transmission at the output port. (b) Optical micrographs of device (false-colored). The resonator is realized as a coplanar waveguide with measured frequency $\\omega_{\\text{R}}/2\\pi = 9.72\\,\\GHz$ and linewidth $\\kappa/2\\pi = 1\\,\\MHz$. The flux-bias lines are terminated with an inductance to ground, off-centered from each qubit-loop. Fabrication details are given in previous work\u00a0[Unknown Author, \"Unknown Title\", ]\n\n< g r a p h i c s >\n\n(color online) Cross-resonance level diagram and experimentally extracted tunable coupling strength. The effective interaction strength for different cross-drive powers is found from the extracted frequency shift of the $\\Omega_{\\text{R},2}$ with qubit 1 in either the ground or excited state. The interaction turns on linearly with the amplitude $A$ of the drive, here shown normalized on the $x$-axis to $\\Omega_{\\text{R},2}$, before leveling off at higher amplitudes when $\\Omega_{\\text{R},2}$ approaches $\\Delta_{12}$. The maximum interaction strength of $1.4\\,\\MHz$ is observed at $A/2\\pi=493\\,\\MHz$.(inset) Energy spectrum corresponding to a pair of fixed weakly-coupled qubits ($\\Delta_{12}>J$). Dashed (solid) red and blue lines reflect uncoupled (coupled) energy levels for qubit 1 and 2 respectively. Assuming qubit 1 as the control qubit, a cross-drive at the qubit 2 transition frequency rotates qubit 2, the target, with a phase dependent on the state of the control, with a rate down by a factor $J/\\Delta_{12}$ over a resonant drive.\n\nWe implement the CR scheme on our device by applying microwave excitations resonant with the opposite qubit's transition frequency directly onto either qubit via the FBLs [Fig.\u00a0(Figure fig:1)(a)]. To understand how the CR effect arises, consider the Hamiltonian for a pair of qubits which are detuned from the resonator by $\\Delta_i = \\omega_i - \\omega_{\\text{R}}$ for $i=1,2$, and dispersively coupled to each other via the resonator,\n$$\n\nH/\\hbar = \\frac{1}{2}\\omega_1 ZI + \\frac{1}{2}\\omega_2 IZ +J XX,\n\\label{eq:dispH}\n\n$$\nwhere $\\{I,X,Y,Z\\}^{\\otimes 2}$ are the Pauli operators (including the identity) and the order indexes the qubit number. Equation\u00a0<ref> can be diagonalized and considered as a new set of two qubits with shifted frequencies $\\tilde{\\omega}_1 = \\omega_1 + J/\\Delta_{12}$, $\\tilde{\\omega}_2 = \\omega_2 - J/\\Delta_{12}$ when $J$ is small compared to the qubit-qubit detuning, $\\Delta_{12} = \\omega_1-\\omega_2$ (see Fig.\u00a0(Figure fig:2) inset). In this frame, a single drive on qubit 1 at either $\\tilde{\\omega}_1$ or $\\tilde{\\omega}_2$ can excite transitions to qubit 1 or 2, respectively. However, the CR drive amplitude of qubit 2 is reduced by a factor of $J/\\Delta_{12}$ and acquires a phase which is dependent on the state of qubit 1. The drive Hamiltonian then takes the form\n$$\n\nH_{\\text{D}} = \\hbar A(t)\\cos(\\tilde{\\omega}_2t)\\left(XI-\\frac{J}{\\Delta_{12}}ZX+m_{12}IX\\right),\n\\label{eq:driveH}\n\n$$\nwhere $A(t)$ is the shaped microwave amplitude of a drive on qubit 1 and $m_{12}$ represents spurious crosstalk due to stray electromagnetic coupling in the device circuit and package\u00a0[Unknown Author, \"Unknown Title\", ]. Hence, a drive on qubit 1 at $\\tilde{\\omega}_2$ can be used to turn on a $ZX$ interaction, which is a primitive\u00a0[Unknown Author, \"Unknown Title\", ] for the two-qubit CNOT. The same analysis holds symmetrically for a drive applied to qubit\u00a02. We will use the notation $\\text{CR}_{ij}(A,\\tg)$ to represent a cross drive on qubit $i$ at $\\omega_j$ with amplitude $A$ and gate time $\\tg$.\n\n< g r a p h i c s >\n\n(color online)\u00a0Entangled states and concurrence oscillations. (a)\u00a0Pulse sequence for generating entangled states; both qubits are initialized in the ground state; qubit 1 is first placed into a superposition state with a $X_{+90}$, leaving the system in the separable state $\\ket{\\psi} = (\\ket{00}+\\ket{10})/\\sqrt{2}$; next the $\\CR$ pulse is also applied to qubit 1 before the joint readout sequence. The concurrence can be computed for all density matrices obtained with this pulse protocol, and oscillations are observed as a function of the gate time $\\tg$ for four different $\\CR$ drive amplitudes (b-e), corresponding to $\\{139, 220, 349, 553\\}$ MHz. The period of the oscillations correspond to $1/\\Jeff$ and the maximum concurrence is observed at $\\tg= 220$ ns at $A/2\\pi=553\\,\\MHz$. (f) Measured density matrix for Bell-state $\\ket{\\psi_{\\text{Bell}}} = (\\ket{00} +\\ket{11})/\\sqrt{2}$ generated at the point of optimal concurrence labeled in (e).\n\nAlthough a $ZX$ interaction theoretically corresponds to an $X$ rotation on qubit 2 with the direction dependent on the state of qubit 1, in practice due to the $m_{12}\\sim 0.5$ term in Eq.\u00a0<ref>, $\\CR$ also directly induces an additional rotation of qubit 2. This spurious crosstalk parameter $m_{12}$ is determined by comparing Rabi frequencies of both qubits when driven with the same amplitude through the same FBL. This effect does not degrade the two-qubit interaction because it commutes with the $ZX$ term. The effective interaction strength $\\Jeff$ is then manifested as the difference in qubit 2 Rabi oscillation frequencies, $\\Omega_{\\text{R},2}$, dependent on the state of qubit 1.\n\nFigure\u00a0(Figure fig:2)(b) shows the experimentally measured $\\Jeff$ versus $A$. We shape the $\\CR$ pulse as a slow gaussian turn-on with a flat-top and a derivative-pulse correction on the quadrature (scale parameter of 0.8). With and without a single qubit $X$ gate on qubit 1, we find different $\\Omega_{\\text{R},2}$, extracted from oscillations of the qubit 2 excited state population versus the time of the $\\CR$ pulse $\\tg$. For small $A$, $\\Jeff$ turns on linearly. However, at stronger drives, the interaction strength levels off to a maximum of $1.4\\,\\MHz$, which is in agreement with a two-level theory\u00a0[Unknown Author, \"Unknown Title\", ] and is due to the off-resonant driving of $XI$ in eq.\u00a0<ref>. At the strongest of drives the measured $\\Jeff$ does not agree with the two-level theory due to the presence of higher levels in the qubits and the breakdown of our simplified derivative-pulse shaping correction.\n\nNon-classical states can be generated and measured using the protocol in figure\u00a0(Figure fig:3)a, in which a $X_{+90}$ gate creates a superposition state of the control qubit, followed by the $\\CR$ gate before the joint readout is used to perform state tomography and reconstruct the two-qubit density matrix $\\rho$. The joint readout technique has been shown to be capable of measuring ensembles of both separable and highly-entangled two-qubit states\u00a0[Unknown Author, \"Unknown Title\", ]. The joint readout assumes the measurement ensemble to be $\\langle M \\rangle = \\beta_{II}+\\beta_{IZ} \\langle IZ \\rangle +\\beta_{ZI} \\langle ZI \\rangle + \\beta_{ZZ} \\langle ZZ \\rangle$. Calibration of the readout gives $[\\beta_{II},\\beta_{IZ}, \\beta_{ZI}, \\beta_{ZZ}] = [1,0.77, 0.72,0.6]$. We use maximum-likelihood estimation to extract $\\rho$ from a set of experiments involving 15 different single-qubit operations applied to a two-qubit state right before the measurement.\n\nA standard metric of entanglement, the concurrence $\\mathcal{C}$, can be computed for measured $\\rho$ generated with our gate protocol for different $\\tg$ and $A$. Figures\u00a0(Figure fig:3)(b\u2013e) show the evolution of $\\mathcal{C}$ with $\\tg$ for four different $A$. We find that $\\mathcal{C}$ oscillates with a period of $1/\\Jeff$. The points of maximal $\\mathcal{C}$ correspond to $\\tg = 1/2\\Jeff$, where the $\\CR$ is a $[ZX]_{+90}$ two-qubit operation which produces maximally entangled states in the Bell basis. The solid lines in Fig.\u00a0(Figure fig:3)(b\u2013e) correspond to master-equation two-level simulations taking into account the gate  and  coherence times.\n\n< g r a p h i c s >\n\n(color online)\u00a0Quantum process tomography. $\\text{Re}[\\chi]$ for the optimal $\\CR$ gate are shown as the shaded and colored bars, corresponding to $t_{\\text{gate}} = 220\\,\\ns$ and $A'$. The $x$- and $y$-axes are labeled in the two-qubit Pauli operator basis $\\{I, X,Y,Z\\}^{\\otimes 2}$. The ideal two-qubit gate corresponds to a CNOT two-qubit unitary, and the corresponding $\\text{Re}[\\chi_{\\text{ideal}}]$ and $\\text{Im}[\\chi_{\\text{ideal}}]$ are shown as the transparent bars.  All $\\text{Im}[\\chi]$ bars (not shown) are $ < 0.05$.\n\nIn Fig.\u00a0(Figure fig:3)(f) we show a measured $\\rho$ for one of the maximally entangled Bell basis states $\\ket{\\psi_{\\text{Bell}}} = 1/\\sqrt{2} (\\ket{00} +\\ket{11})$, generated with a $\\CR$ gate at $\\tg= 220\\,\\ns$ and the amplitude $A/2\\pi=553\\,\\MHz$ which gives the maximal $\\mathcal{C}$ in the oscillations shown in Fig.\u00a0(Figure fig:3)(e). As previously mentioned, due to the spurious crosstalk on qubit 2 during the gate, an additional single qubit rotation of qubit 2 is usually performed. Although this extra rotation can be simply un-done with an additional single-qubit gate, for this specific $\\tg$ and $A$, the additional rotation from the crosstalk is $X_{+90}$, which when combined with the $[ZX]_{+90}$ leaves the two qubits in the canonical Bell state $\\ket{\\psi_{\\text{Bell}}}$. The fidelity of this measured state to the ideal $\\ket{\\psi_{\\text{Bell}}}$ is found to be $\\mathcal{F} = \\langle \\psi_{\\text{Bell}}|\\rho|\\psi_{\\text{Bell}}\\rangle = 90\\%\\pm0.04$ with a concurrence of $\\mathcal{C} = 0.88\\pm 0.05$.\n\nThe $\\CR$ gate is finally characterized using quantum process tomography\u00a0[Unknown Author, \"Unknown Title\", ] (QPT). First, we create the input states corresponding to applying combinations of single-qubit gates $\\{I, X_{\\pm90}, Y_{\\pm90}, X\\}$ on both qubits. Then we operate $\\CR(A,\\tg)$ on all 36 such input states and perform state tomography. The process matrix $\\chi$ is obtained and compared to the ideal $\\chi_{\\text{ideal}}$ (see Fig.\u00a0(Figure fig:4)) to give a process fidelity $\\mathcal{F}_p = 0.77$ and a gate fidelity\u00a0[Unknown Author, \"Unknown Title\", ] $\\mathcal{F}_{\\text{g}} = 0.81$, which is consistent with a simulated gate fidelity of 0.86 that takes into account the measured coherence times. The difference in the values is attributable to calibration errors on the single-qubit preparation and analysis gates. As an experimental measure of the effectiveness of the $\\CR$ gate we also perform QPT for a 220\u00a0ns identity operation, where we find $\\mathcal{F}_{\\text{g}} = 0.81$, which critically is the same as the $\\CR$ gate fidelity. For a test of other residual two-qubit interactions in the system, we extract a maximum $\\mathcal{C}=0.09$ from the action of the identity operation over all separable input states. This is consistent with a measured residual $ZZ$ interaction of 200 kHz, which is an effect common to the circuit QED system\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThus, we have developed a microwaves-only scheme for a two-qubit universal gate capable of generating highly entangled states with superconducting qubits. Furthermore, the underlying two-qubit interaction is tunable simply via increasing the amplitude of a microwave drive. Although we saturate to a maximal interaction strength in this work [Fig.\u00a0(Figure fig:2)(b)], we anticipate surpassing this limit with additional pulse shaping on the cross-resonance drive in the future. The cross-resonance coupling protocol is minimal in complexity to implement as it requires no additional subcircuits or controls other than those for addressing each qubit independently. The gate can be immediately expanded to generate maximally entangled states for systems of more than two fixed-frequency qubits and to couple non-nearest neighbor qubits in frequency. The cross-resonance protocol is therefore poised to be a useful experimental tool for larger-scale quantum information processors.\n\nWe thank Kent Fung and Jack Rohrs for experimental contributions and Marcus P.\u00a0da Silva, Zachary Dutton, and Graeme Smith for engaging theoretical discussions. We acknowledge support from IARPA under contract W911NF-10-1-0324. All statements of fact, opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of the U.S. Government.\n\n27\nfxundefined [1]\nifx#1\n\nfnum [1]\n#1firstoftwo\nsecondoftwo\n\nfx [1]\n#1firstoftwo\nsecondoftwo\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12`&12`#12`1\u03022`_12`\nstartlink[1]\nendlink[0]\n\nrl [1]href #1\n\n@bib@innerbibempty\n\n[Lucero et\u00a0al.(2008)Lucero,\nHofheinz, Ansmann, Bialczak,\nKatz, Neeley, O'Connell,\nWang, Cleland, and Martinis]lucero_gates_2008\nauthor author E.\u00a0Lucero, author M.\u00a0Hofheinz,\nauthor M.\u00a0Ansmann, author R.\u00a0C. Bialczak, author\nN.\u00a0Katz, author M.\u00a0Neeley, author A.\u00a0D.  O'Connell, author H.\u00a0Wang, author A.\u00a0N. Cleland,   and author J.\u00a0M. Martinis,  10.1103/PhysRevLett.100.247001 journal\njournal Phys. Rev. Lett. volume 100,  eid 247001 (year 2008)NoStop\n[Chow et\u00a0al.(2010a)Chow, DiCarlo,\nGambetta, Motzoi, Frunzio,\nGirvin, and Schoelkopf]Chow2010a\nauthor author J.\u00a0M. Chow, author L.\u00a0DiCarlo,\nauthor J.\u00a0M. Gambetta, author F.\u00a0Motzoi, author\nL.\u00a0Frunzio, author S.\u00a0M. Girvin,  and author R.\u00a0J. Schoelkopf, http://link.aps.org/doi/10.1103/PhysRevA.82.040305 journal\njournal Phys. Rev. A volume 82,  pages 040305 (year 2010a)NoStop\n[Plantenberg et\u00a0al.(2007)Plantenberg, de\u00a0Groot, Harmans, and  Mooij]Plantenberg:2007it\nauthor author J.\u00a0H. Plantenberg, author P.\u00a0C. de\u00a0Groot, author C.\u00a0J. P.\u00a0M. Harmans,  and author J.\u00a0E. Mooij, 10.1038/nature05896 journal\njournal Nature volume 447, pages 836 (year 2007)NoStop\n[DiCarlo et\u00a0al.(2009)DiCarlo, Chow, Gambetta, Bishop, Johnson, Schuster, Majer, Blais, Frunzio, Girvin, and Schoelkopf]dicarlo_2009\nauthor author L.\u00a0DiCarlo, author J.\u00a0M. Chow,\nauthor J.\u00a0M. Gambetta, author L.\u00a0S. Bishop, author\nB.\u00a0R. Johnson, author\nD.\u00a0I. Schuster, author\nJ.\u00a0Majer, author A.\u00a0Blais, author L.\u00a0Frunzio, author S.\u00a0M.  Girvin,  and author R.\u00a0J.  Schoelkopf, 10.1038/nature08121 journal journal Nature volume\n460, pages 240 (year 2009)NoStop\n[Ansmann et\u00a0al.(2009)Ansmann, Wang, Bialczak, Hofheinz, Lucero, Neeley, O'Connell, Sank, Weides, Wenner, Cleland, and Martinis]Ansmann:2009yq\nauthor author M.\u00a0Ansmann, author H.\u00a0Wang,\nauthor R.\u00a0C. Bialczak, author M.\u00a0Hofheinz, author\nE.\u00a0Lucero, author M.\u00a0Neeley, author A.\u00a0D.  O'Connell, author D.\u00a0Sank, author M.\u00a0Weides,\nauthor J.\u00a0Wenner, author A.\u00a0N. Cleland,  and author J.\u00a0M. Martinis, 10.1038/nature08363 journal journal Nature  volume 461, pages 504 (year\n2009)NoStop\n[DiCarlo et\u00a0al.(2010)DiCarlo, Reed, Sun, Johnson, Chow, Gambetta, Frunzio, Girvin, Devoret, and  Schoelkopf]DiCarlo2010\nauthor author L.\u00a0DiCarlo, author M.\u00a0D. Reed,\nauthor L.\u00a0Sun, author\nB.\u00a0R. Johnson, author\nJ.\u00a0M. Chow, author\nJ.\u00a0M. Gambetta, author\nL.\u00a0Frunzio, author S.\u00a0M. Girvin, author M.\u00a0H.  Devoret,  and author R.\u00a0J.  Schoelkopf, http://dx.doi.org/10.1038/nature09416\njournal journal Nature volume 467, pages 574 (year\n2010)NoStop\n[Neeley et\u00a0al.(2010)Neeley,\nBialczak, Lenander, Lucero,\nMariantoni, O/'Connell, Sank,\nWang, Weides, Wenner,\nYin, Yamamoto, Cleland, and  Martinis]Neeley2010\nauthor author M.\u00a0Neeley, author R.\u00a0C. Bialczak, author M.\u00a0Lenander,\nauthor E.\u00a0Lucero, author M.\u00a0Mariantoni, author\nA.\u00a0D. O'Connell, author\nD.\u00a0Sank, author H.\u00a0Wang, author M.\u00a0Weides, author J.\u00a0Wenner,\nauthor Y.\u00a0Yin, author\nT.\u00a0Yamamoto, author\nA.\u00a0N. Cleland,  and author\nJ.\u00a0M. Martinis, http://dx.doi.org/10.1038/nature09418 journal journal Nature volume 467, pages\n570 (year 2010)NoStop\n[Bertet et\u00a0al.(2006)Bertet,\nHarmans, and Mooij]Bertet2006\nauthor author P.\u00a0Bertet, author C.\u00a0J. P.\u00a0M. Harmans,  and author J.\u00a0E. Mooij, http://link.aps.org/doi/10.1103/PhysRevB.73.064512\njournal journal Phys. Rev. B volume 73, pages 064512 (year\n2006)NoStop\n[Niskanen et\u00a0al.(2007)Niskanen, Harrabi, Yoshihara, Nakamura, Lloyd, and Tsai]Niskanen:2007if\nauthor author A.\u00a0O. Niskanen, author K.\u00a0Harrabi,\nauthor F.\u00a0Yoshihara, author Y.\u00a0Nakamura, author\nS.\u00a0Lloyd,  and author\nJ.\u00a0S. Tsai, 10.1126/science.1141324 journal journal\nScience volume 316, pages 723\n(year 2007)NoStop\n[Harris et\u00a0al.(2007)Harris,\nBerkley, Johnson, Bunyk,\nGovorkov, Thom, Uchaikin,\nWilson, Chung, Holtham,\nBiamonte, Smirnov, Amin,  and Maassen van\u00a0den Brink]Harris2007\nauthor author R.\u00a0Harris, author A.\u00a0J. Berkley,\nauthor M.\u00a0W. Johnson, author P.\u00a0Bunyk, author\nS.\u00a0Govorkov, author\nM.\u00a0C. Thom, author\nS.\u00a0Uchaikin, author\nA.\u00a0B. Wilson, author\nJ.\u00a0Chung, author E.\u00a0Holtham, author J.\u00a0D.  Biamonte, author A.\u00a0Y.  Smirnov, author M.\u00a0H.\u00a0S.  Amin,  and author A.\u00a0Maassen van\u00a0den Brink, http://link.aps.org/doi/10.1103/PhysRevLett.98.177001 journal\njournal Phys. Rev. Lett. volume 98,  pages 177001 (year 2007)NoStop\n[Hime et\u00a0al.(2006)Hime,\nReichardt, Plourde, Robertson, Wu, Ustinov, and Clarke]Hime:2006ef\nauthor author T.\u00a0Hime, author P.\u00a0A. Reichardt,\nauthor B.\u00a0L.\u00a0T. Plourde,\nauthor T.\u00a0L. Robertson, author C.\u00a0E. Wu, author\nA.\u00a0V. Ustinov,  and author\nJ.\u00a0Clarke, 10.1126/science.1134388 journal journal\nScience volume 314, pages 1427\n(year 2006)NoStop\n[Bialczak et\u00a0al.(2011)Bialczak, Ansmann, Hofheinz, Lenander, Lucero, Neeley, O'Connell, Sank, Wang, Weides, Wenner, Yamamoto, Cleland, and Martinis]Bialczak2011\nauthor author R.\u00a0C. Bialczak, author M.\u00a0Ansmann,\nauthor M.\u00a0Hofheinz, author M.\u00a0Lenander, author\nE.\u00a0Lucero, author M.\u00a0Neeley, author A.\u00a0D.  O'Connell, author D.\u00a0Sank, author H.\u00a0Wang, author M.\u00a0Weides, author\nJ.\u00a0Wenner, author T.\u00a0Yamamoto, author A.\u00a0N.  Cleland,  and author J.\u00a0M.  Martinis, http://link.aps.org/doi/10.1103/PhysRevLett.106.060501 journal journal Phys. Rev. Lett. volume 106, pages 060501 (year\n2011)NoStop\n[Srinivasan et\u00a0al.(2011)Srinivasan, Hoffman, Gambetta, and  Houck]Sri2011\nauthor author S.\u00a0J. Srinivasan, author A.\u00a0J. Hoffman, author J.\u00a0M. Gambetta,  and author A.\u00a0A. Houck, http://link.aps.org/doi/10.1103/PhysRevLett.106.083601\njournal journal Phys. Rev. Lett. volume 106, pages 083601 (year\n2011)NoStop\n[Steffen et\u00a0al.(2006)Steffen, Ansmann, Bialczak, Katz, Lucero, McDermott, Neeley, Weig, Cleland, and Martinis]steffen_entang_2006\nauthor author M.\u00a0Steffen, author M.\u00a0Ansmann,\nauthor R.\u00a0C. Bialczak, author N.\u00a0Katz, author\nE.\u00a0Lucero, author R.\u00a0McDermott, author M.\u00a0Neeley, author E.\u00a0M.  Weig, author A.\u00a0N. Cleland,  and author J.\u00a0M. Martinis, 10.1126/science.1130886 journal\njournal Science volume 313, pages 1423 (year 2006)NoStop\n[Bialczak et\u00a0al.(2010)Bialczak, Ansmann, Hofheinz, Lucero, Neeley, O/'Connell, Sank, Wang, Wenner, Steffen, Cleland, and Martinis]Bialczak2010\nauthor author R.\u00a0C. Bialczak, author M.\u00a0Ansmann,\nauthor M.\u00a0Hofheinz, author E.\u00a0Lucero, author\nM.\u00a0Neeley, author A.\u00a0D. O/'Connell, author D.\u00a0Sank, author H.\u00a0Wang, author J.\u00a0Wenner,\nauthor M.\u00a0Steffen, author A.\u00a0N. Cleland,  and author J.\u00a0M. Martinis, http://dx.doi.org/10.1038/nphys1639 journal journal Nat Phys volume 6, pages\n409 (year 2010)NoStop\n[Paraoanu(2006)]Paraoanu2006\nauthor author G.\u00a0S. Paraoanu, http://link.aps.org/doi/10.1103/PhysRevB.74.140504\njournal journal Phys. Rev. B volume 74, pages 140504 (year\n2006)NoStop\n[Rigetti and Devoret(2010)]Rigetti2010\nauthor author C.\u00a0Rigetti and author M.\u00a0Devoret, http://link.aps.org/doi/10.1103/PhysRevB.81.134507\njournal journal Phys. Rev. B volume 81, pages 134507 (year\n2010)NoStop\n[de\u00a0Groot et\u00a0al.(2010)de\u00a0Groot, Lisenfeld, Schouten,\nAshhab, Lupascu, Harmans,  and Mooij]Groot2010\nauthor author P.\u00a0C. de\u00a0Groot, author J.\u00a0Lisenfeld,\nauthor R.\u00a0N. Schouten, author S.\u00a0Ashhab, author\nA.\u00a0Lupascu, author C.\u00a0J. P.\u00a0M. Harmans,  and author\nJ.\u00a0E. Mooij, http://dx.doi.org/10.1038/nphys1733 journal journal Nat Phys volume 6, pages\n763 (year 2010)NoStop\n[Majer et\u00a0al.(2007)Majer,\nChow, Gambetta, Koch,\nJohnson, Schreier, Frunzio,\nSchuster, Houck, Wallraff,\nBlais, Devoret, Girvin, and  Schoelkopf]majer_coupling_2007\nauthor author J.\u00a0Majer, author J.\u00a0M. Chow,\nauthor J.\u00a0M. Gambetta, author J.\u00a0Koch, author\nB.\u00a0R. Johnson, author\nJ.\u00a0A. Schreier, author\nL.\u00a0Frunzio, author D.\u00a0I. Schuster, author A.\u00a0A.  Houck, author A.\u00a0Wallraff, author A.\u00a0Blais,\nauthor M.\u00a0H. Devoret, author S.\u00a0M. Girvin,  and author R.\u00a0J. Schoelkopf, 10.1038/nature06184 journal journal\nNature volume 449, pages 443\n(year 2007)NoStop\n[Sillanp\u00e4\u00e4 et\u00a0al.(2007)Sillanp\u00e4\u00e4, Park, and Simmonds]Sillanpaa_2007\nauthor author M.\u00a0A. Sillanp\u00e4\u00e4, author J.\u00a0I. Park,  and author R.\u00a0W. Simmonds, 10.1038/nature06124 journal\njournal Nature volume 449, pages 438 (year 2007)NoStop\n[Steffen et\u00a0al.(2010)Steffen, Kumar, DiVincenzo, Rozen, Keefe, Rothwell, and Ketchen]Steffen2010\nauthor author M.\u00a0Steffen, author S.\u00a0Kumar,\nauthor D.\u00a0P. DiVincenzo,\nauthor J.\u00a0R. Rozen, author G.\u00a0A. Keefe, author\nM.\u00a0B. Rothwell,  and author\nM.\u00a0B. Ketchen, http://link.aps.org/doi/10.1103/PhysRevLett.105.100502 journal journal Phys. Rev. Lett. volume 105, pages 100502 (year\n2010)NoStop\n[Filipp et\u00a0al.(2009)Filipp,\nMaurer, Leek, Baur,\nBianchetti, Fink, Goppl,\nSteffen, Gambetta, Blais,  and Wallraff]filipp_joint_2009\nauthor author S.\u00a0Filipp, author P.\u00a0Maurer,\nauthor P.\u00a0J. Leek, author M.\u00a0Baur, author\nR.\u00a0Bianchetti, author\nJ.\u00a0M. Fink, author\nM.\u00a0Goppl, author L.\u00a0Steffen, author J.\u00a0M.  Gambetta, author A.\u00a0Blais,  and author A.\u00a0Wallraff, 10.1103/PhysRevLett.102.200402 journal journal Phys. Rev. Lett. volume 102, eid 200402 (year\n2009)NoStop\n[Chow et\u00a0al.(2010b)Chow, DiCarlo,\nGambetta, Nunnenkamp, Bishop,\nFrunzio, Devoret, Girvin,  and Schoelkopf]Chow2010\nauthor author J.\u00a0M. Chow, author L.\u00a0DiCarlo,\nauthor J.\u00a0M. Gambetta, author A.\u00a0Nunnenkamp, author\nL.\u00a0S. Bishop, author\nL.\u00a0Frunzio, author M.\u00a0H. Devoret, author S.\u00a0M.  Girvin,  and author R.\u00a0J.  Schoelkopf, http://link.aps.org/doi/10.1103/PhysRevA.81.062325 journal\njournal Phys. Rev. A volume 81,  pages 062325 (year 2010b)NoStop\n[Motzoi et\u00a0al.(2009)Motzoi,\nGambetta, Rebentrost, and Wilhelm]Motzoi:2009fx\nauthor author F.\u00a0Motzoi, author J.\u00a0M. Gambetta, author P.\u00a0Rebentrost,  and author F.\u00a0K. Wilhelm, 10.1103/PhysRevLett.103.110501 journal journal Physical Review Letters volume 103, pages 110501 (year\n2009)NoStop\n[Wenner et\u00a0al.(2011)Wenner,\nNeeley, Bialczak, Lenander,\nLucero, O\u2019Connell, Sank,\nWang, Weides, Cleland, and  Martinis]Wenner2011\nauthor author J.\u00a0Wenner, author M.\u00a0Neeley,\nauthor R.\u00a0C. Bialczak, author M.\u00a0Lenander, author\nE.\u00a0Lucero, author A.\u00a0D. O\u2019Connell, author D.\u00a0Sank, author H.\u00a0Wang, author M.\u00a0Weides,\nauthor A.\u00a0N. Cleland,  and  author J.\u00a0M. Martinis, http://iopscience.iop.org/0953-2048/24/6/065001 journal\njournal Supercond. Sci. Technol. volume\n24, pages 065001 (year 2011)NoStop\n[Nielsen and Chuang(2000)]nielsen_chuang_2000\nauthor author M.\u00a0A. Nielsen and author I.\u00a0L. Chuang, 10.2277/0521635039 title\nQuantum Computation and Quantum Information (publisher\nCambridge University Press, Cambridge, year 2000)NoStop\n[Nielsen(2002)]nielsen_gatefid_2002\nauthor author M.\u00a0A. Nielsen, 10.1016/S0375-9601(02)01272-0 journal journal Phys. Lett. A volume\n303, pages 249 (year 2002)NoStop\n\n"}
{"prompt": "What are the key contributions of the paper 'High-Fidelity Readout in Circuit Quantum Electrodynamics Using the Jaynes-Cummings Nonlinearity'?", "completion": "\n\n# High-Fidelity Readout in Circuit Quantum Electrodynamics Using the Jaynes-Cummings Nonlinearity\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, Connecticut 06520, USA\n\n.pdf, .jpg, .tif\n.eps, .jpg\n\nWe demonstrate a qubit readout scheme that exploits the Jaynes-Cummings nonlinearity of a superconducting cavity coupled to transmon qubits.  We find that in the strongly-driven dispersive regime of this system, there is the unexpected onset of a high-transmission \u201cbright\u201d state at a critical power which depends sensitively on the initial qubit state.  A simple and robust measurement protocol exploiting this effect achieves a single-shot fidelity of 87\n\nCircuit quantum electrodynamics (cQED) is the study of the interaction of light and matter where superconducting qubits playing the role of atoms are strongly coupled to microwave transmission line resonators acting as cavities [Unknown Author, \"Unknown Title\", ].  This architecture offers advantages over cavity QED with atomic systems with regard to both coupling strength and accessibility of strongly driven nonlinear regimes [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  For example, the high-power response of a cavity with a qubit in resonance has recently been studied, demonstrating the appearance of additional photon number ($n$) resonances with characteristic $\\sqrt{n}$ spacing, in excellent agreement with theory [Unknown Author, \"Unknown Title\", ].  In this Letter, we investigate the behavior of a strongly driven cQED system in the dispersive regime, where four strongly coupled transmon qubits [Unknown Author, \"Unknown Title\", ] are far detuned from the cavity.  We find that for increasing drive strength, the cavity response initially becomes strongly nonlinear and  continuously shifts down in frequency.  At a critical power, it reaches its bare frequency and transmission rapidly rises to a \u201cbright state\u201d.  Importantly, this critical power is strongly dependent on the initial state of the qubit, providing for a simple high-fidelity qubit readout mechanism.  This scheme is also applicable to the joint measurement of several qubits simultaneously.\n\nThere are two commonly used cQED readout schemes.  The first employs the state-dependent dispersive shift of the coupled cavity's resonance frequency [Fig.\u00a0(Figure fig:pspec1q)(a)] to infer the qubit state by measuring transmission [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  This must be done in the low-power, linear response regime of the cavity in part because system anharmonicity inhibits higher population.  The signal-to-noise ratio (SNR) and fidelity of this weak measurement is thus limited (to typically 40\n\n< g r a p h i c s >\n\n(Color)\nCavity transmission as a function of drive power and frequency, demonstrating the \u201cbright\u201d state at high incident power.\n(a) Dispersively shifted cavity response for excited (blue) and ground (red) states of the $8\\ghz$ qubit with $\\sim1$\u00a0photon mean cavity occupation.  We reference this power to 0\u00a0dB.  For all plots in this figure, the $8\\ghz$ qubit is prepared, a measurement tone is pulsed on, and the responding homodyne amplitude is averaged for 400\u00a0ns to yield $\\overline{A_{\\mathrm{H}}}$.  The mV scale used is arbitrary, but consistent to ease comparison.  The $x$-axis for (a-e) is frequency and covers the same range as for (f-g).\n(b-d) Cavity response for increasing drive power, with data for previous power plotted with dashed lines.  Transmission is inhibited by the cavity's inherited nonlinearity, limiting dispersive measurement fidelity.  Note for example that increasing drive 10\u00a0dB from (b) to (c) increases $\\overline{A_{\\mathrm{H}}}$ by only a factor of $\\sim2$ and complicates the frequency dependence.  The emergence of a distinct resonance can be seen in (d).\n(e) High-transmission bright state.  At large drive power, the Jaynes-Cummings cavity anharmonicity shrinks sufficiently to allow near-unity transmission at $f_{\\mathrm{bare}}$.  For this power the system only reaches its bright state when the qubit is excited due to the asymmetry of the dispersive cavity shift about $f_{\\mathrm{bare}}$.  This asymmetry is characteristic to the transmon qubit [Unknown Author, \"Unknown Title\", ] but might be possible to simulate for other designs [Unknown Author, \"Unknown Title\", ].\n(f-g) Cavity response (log magnitude) for qubit ground and excited states.  The cavity continuously evolves from its low power linear behavior through the anharmonic bistable region and to the bright state.  There are two peaks present in (g) due to qubit relaxation during measurement.  The symbols (+) denote the optimal power and frequency for qubit readout, where the cavity response for the two qubit states is maximally different.\n(h) Response at $f_{\\mathrm{bare}}$ (arrows) versus input power, showing a steep jump in transmission corresponding to the onset of the bright state at a qubit-state-dependent power.  Though transmission state dependence exists elsewhere, the behavior here is especially amenable for use as a qubit readout because the difference is large compared to amplifier noise.\n\nOur readout scheme exploits the unusual behavior of the system when driven strongly.  For low drive strength, the cavity (at $f_{\\mathrm{bare}} = 9.070\\ghz$) is dispersively shifted many linewidths by the strongly coupled transmons at frequencies $(f_1, f_2, f_3, f_4) = (6.000, 7.000, 8.000, 12.271)\\ghz~\\pm~2\\mhz$ (see Supplement for device details).  The cavity also inherits anharmonicity ($\\alpha$, the frequency difference between subsequent cavity transitions) from the interaction, which inhibits transmission for larger power [Figs.\u00a0(Figure fig:pspec1q)(a-d)].  For small number of excitations $n$, $\\alpha$ is to first order constant [Unknown Author, \"Unknown Title\", ], though higher order terms are often considered as $n$ approaches a critical value [Unknown Author, \"Unknown Title\", ].  This expansion neglects the high-power behavior of the system, which can be recovered with a semiclassical model, shown previously for the case of a qubit and cavity in resonance [Unknown Author, \"Unknown Title\", ].  In a parallel publication [Unknown Author, \"Unknown Title\", ], Bishop et al. consider the case of a large cavity-qubit detuning semiclassically and show that for increasing $n$, $\\alpha$ decreases monotonically and the cavity frequency ($f_c$) shifts toward $f_{\\mathrm{bare}}$, in qualitative agreement with our observations.  The measured cavity output power as a function of incident drive power and frequency thus smoothly evolves from a linear relation at low occupation ($n\\sim1$), where the shift due to increasing $n$ is small compared to cavity linewidth, to a nonlinear relation at intermediate $n$ where $\\alpha$ is important [Fig.\u00a0(Figure fig:pspec1q)(f)].  A dip in transmission likely caused by interference between two bistable solutions follows the cavity down in frequency with increasing power and disappears at $f_{\\mathrm{bare}}$.  At large drive power, the cavity reaches a near-unity transmission \u201cbright state\u201d where $f_c \\to f_{\\mathrm{bare}}$ and $\\alpha \\to 0$.  This power is $\\sim 50,000$ times larger than what induces a one-photon mean population, producing a signal large compared to measurement noise.  We reference the one-photon power to 0\u00a0dB.\n\n< g r a p h i c s >\n\nMeasurement transients and histograms for single-shot measurement of one qubit (at $8\\ghz$).\n(a) Three measurements of single-shot system response $V_{\\mathrm{H}}(t)$ to driving at $f_{\\mathrm{bare}}$ with a power $P_{\\mathrm{meas}}$ for prepared qubit ground and excited states, low-passed to the response time of the cavity $1/\\kappa\\approx 100$\u00a0ns.  They are reproducible and well-distinguished, demonstrating that the response is large compared to the measurement noise.\n(b) Histograms and S-curves quantifying measurement fidelity.  An ensemble of single-shot responses are integrated for 500\u00a0ns and their distribution plotted. The two histogram peaks (solid lines) are well separated with few counts between them.  Integrating these yields \u201cS-curves\u201d (dashed lines), with their maximal difference indicating a single-shot fidelity of 87\n(c) Measurement fidelity versus integration time.  Integrating $V_{\\mathrm{H}}(t)$ for 120\u00a0ns yields 80\n\nThis behavior can be used to realize a high-fidelity qubit measurement because of a qubit-state-dependent bright-state onset power.  When driving with sufficiently high power at $f_{\\mathrm{bare}}$, the system will excite to its bright state and remain there as long as the drive is applied.  Crucially, however, the lowest power for which the system will excite depends strongly on the qubit state because the cavity is dispersively shifted closer to $f_{\\mathrm{bare}}$ when the qubit is excited [Fig.\u00a0(Figure fig:pspec1q)(g)].  This smaller detuning reduces the Lorentzian filtering effect of the cavity at $f_{\\mathrm{bare}}$, lowering the onset power.  The cavity response at $f_{\\mathrm{bare}}$ thus undergoes a sharp step for increasing drive at a power depending on the qubit state [Fig.\u00a0(Figure fig:pspec1q)(h)].  This transition does not happen discontinuously; there are powers where the system will only excite some of the time.  A high-discrimination readout is then made by choosing a drive power $P_{\\mathrm{meas}}$ that maximizes the difference in bright-state probability for the qubit ground and excited states, generating a large state-dependent transmission difference [Fig.\u00a0(Figure fig:hist1q)(a)].  For measurements of the $8\\ghz$ qubit, the optimal power is $P_{\\mathrm{meas}} \\approx +47~\\mathrm{dB}$.\n\nWe determine the readout measurement fidelity by comparing the ensemble distribution of cavity responses having prepared the qubit ground and excited states.  This is done by integrating $\\sim500,000$ (in this case) individual measurement transients such as those shown in Fig.\u00a0(Figure fig:hist1q)(a) for $500~\\mathrm{ns}$ for both qubit preparations and plotting their distribution [Fig.\u00a0(Figure fig:hist1q)(b)].  For the qubit at $8\\ghz$, the maximal separation between the normalized integral of these histograms indicates a measurement fidelity of 87\n\nTwo important considerations for qubit readout are measurement time and repetition rate.  Single-shot fidelity as a function of integration time is shown in Fig.\u00a0(Figure fig:hist1q)(c).  After 120\u00a0ns the fidelity has risen to 80\n\n< g r a p h i c s >\n\nJoint qubit readout.\n(a) Pulsed cavity response $\\overline{A_{\\mathrm{H}}}$ when preparing the $\\bra{111}$ state.  The eight ($2^3$) register states of three qubits induce a different dispersive cavity shift, each discernible at low power due to decay of the $\\bra{111}$ state during measurement.  These frequencies were independently measured to be $( f_{\\bra{000}}, f_{\\bra{100}}, f_{\\bra{010}}, f_{\\bra{001}}, f_{\\bra{110}}, f_{\\bra{101}}, f_{\\bra{011}}, f_{\\bra{111}} ) = ( 9.145, 9.139, 9.131, 9.112, 9.124, 9.105, 9.097, 9.090 )~\\mathrm{GHz}$, with $f_{\\mathrm{bare}}=9.070\\ghz$.  The most prominent secondary cavity position corresponds to the third qubit (at $8\\ghz$) relaxing during measurement, consistent with its Purcell-limited [Unknown Author, \"Unknown Title\", ] $T_{\\mathrm{1}}$ being shortest of the three, with $T_{\\mathrm{1}}^{\\mathrm{Q}_{\\mathrm{1}}}= 1.2 ~\\mu \\mathrm{s}$, $T_{\\mathrm{1}}^{\\mathrm{Q}_{\\mathrm{2}}}= 1.0 ~\\mu \\mathrm{s}$, and $T_{\\mathrm{1}}^{\\mathrm{Q}_{\\mathrm{3}}}= 0.6 ~\\mu \\mathrm{s}$.  The system excites to its bright state at lower power here than seen in Fig.\u00a0(Figure fig:pspec1q) because of the smaller initial cavity detuning from $f_{\\mathrm{bare}}$.  The color scale is identical to that in Fig.\u00a0(Figure fig:pspec1q).\n(b) Histograms for all eight basis states, when driving with +49\u00a0dB at $f_{\\mathrm{bare}}$.\n(c) S-curves for joint qubit readout, indicating a minimum of 61\n\nWe have extended this readout scheme to the joint readout of three qubits.  The physics of multiqubit readout are similar to the solitary case, but generalized for the eight zero-power cavity frequencies possible with three qubits.  Each basis state induces a different dispersive cavity shift from $f_{\\mathrm{bare}}$, yielding a hierarchy of powers for the onset of the bright state.  Readout is done by choosing a measurement power above the onset power for all but the state one is trying to detect.  We consider the register of three qubits at frequencies $(6,7,8)\\ghz$, with the fourth qubit unused.  For these detunings, $P_{\\mathrm{joint}} \\approx 49~\\mathrm{dB}$ is optimal for distinguishing $\\bra{000}$ from all other basis states (including second excited states).  This scheme is especially convenient for performing qubit tomography, which involves measuring multiqubit correlations [Unknown Author, \"Unknown Title\", ] and is done efficiently with a joint qubit measurement [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].  Indeed, the creation and detection of tripartite entanglement was recently demonstrated using this device and readout scheme [Unknown Author, \"Unknown Title\", ].  Cavity transmission for the prepared excited states of all three qubits is shown in Fig.\u00a0(Figure fig:pspec3q)(a).\n\nThe joint fidelity is quantified in a similar manner as for one qubit, but expanded for the eight qubit basis states [Fig.\u00a0(Figure fig:pspec3q)(b)].  As there is no established definition of joint qubit readout fidelity, we propose a conservative metric: the maximal separation between the S-curves for the state one is trying to detect and the least distinguishable state.  This standard yields a fidelity of 61\n\nThis measurement scheme, which we name the Jaynes-Cummings readout, provides high-fidelity single-shot qubit measurement in cQED while being simple, relatively insensitive to qubit detuning, and not requiring any change in experimental setup or sample design.  It works by combining the occupation-dependent Jaynes-Cummings anharmonicity [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with the qubit-state-dependent dispersive cavity shift to conditionally drive the system to a high-transmission bright state, in analogy to the fluorescence readout scheme used in ion traps [Unknown Author, \"Unknown Title\", ].  The effect has also delivered similar performance in a Purcell-filtered [Unknown Author, \"Unknown Title\", ] low-Q cavity coupled to a single transmon, suggesting that it is also robust to cavity lifetime.  It may also be extendable to other cQED architectures, not just those using transmons [Unknown Author, \"Unknown Title\", ].  We do not expect it to be quantum nondemolition due to dressed dephasing [Unknown Author, \"Unknown Title\", ] of the qubit from the substantial photon population, but this is not necessary for many applications.  Future work will further optimize the readout scheme by changing sample design parameters.  A scheme may be possible where all qubit states are measured in a single shot by sweeping the measurement tone power and frequency or by using an intermediate power where the transition rate for each basis state is substantially different.\n\nWe thank L.\u00a0S.\u00a0Bishop, E.\u00a0Ginossar, M.\u00a0H.\u00a0Devoret, and S.\u00a0M.\u00a0Girvin for discussions and M.\u00a0Brink for experimental contributions.  We acknowledge support from LPS/NSA under ARO Contract No. W911NF-05-1-0365, from IARPA under ARO Contract No. W911NF-09-1-0369, and from the NSF under Grants No. DMR-0653377 and No. DMR-0603369. Additional support provided by CNR-Istituto di Cibernetica, Pozzuoli, Italy (LF).  All statements of fact, opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of the U.S. Government.\n\napsrev4-1\n\n"}
{"prompt": "Explain the methodology used in the paper 'Theory of quantum system certification \u2013 a tutorial'.", "completion": "=1\n\nrevtex4-2Failed to recognize\n\nrevtex4-2Failed to patch the float package\ncaptionUnknown document class\n\n./pics/./\n\ncompat=1.16\nshadings,shadows\n\nshapes,shapes.arrows\ndecorations\ndecorations.text,decorations.markings\narrows.meta\ncalc\npositioning\nbg\nbg,main\n\nsbox/.style = draw, rounded corners = .5ex,\nminimum height = 1.6em,\nminimum width = 1.8em,\nblau/.style = top color=niceblue!12,\nbottom color=niceblue!90,\nBbox/.style = sbox, blau, inner sep = 1pt,\nleg/.style = rounded corners = .5ex,thick,postaction=decorate,\ndecoration = markings,mark=at position 0.8 with >\n,\nlegr/.style = rounded corners = .5ex,thick,postaction=decorate,\ndecoration = markings,mark=at position 0.8 with <\n,\nLeg/.style = rounded corners = 1ex,thick,postaction=decorate,\ndecoration = markings,mark=at position 0.2 with >\n,\ndir/.style = gray,thick,\n\n./pics/./\n\nskins,breakable\n\n[auto counter]theoremblock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=MidnightBlue,\nfonttitle=,\ntitle=Theorem\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]propositionblock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=MidnightBlue,\nfonttitle=,\ntitle=Proposition\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]lemmablock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=MidnightBlue,\nfonttitle=,\ntitle=Lemma\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]corollaryblock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=MidnightBlue,\nfonttitle=,\ntitle=Corollary\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]definitionblock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=OliveGreen,\nfonttitle=,\ntitle=Definition\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]protocolblock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=OliveGreen,\nfonttitle=,\ntitle=Protocol\u00a0\u00a0(#2):,\n#1,\n\n[use counter from=theoremblock]exerciseBlock[2][]\nbeamer,\nbreakable,\ncolback=LightGray!5,\ncolframe=BrickRed!90!black,\nfonttitle=,\ntitle=Exercise\u00a0\u00a0(#2):,\n#1,\n\n(#1#2$#1#2$2mu#1#2\n\n# Theory of quantum system certification \u2013 a tutorial\n\ninfo@mkliesch.eui.roth@fu-berlin.de\nThe precise control of complex quantum systems promises numerous technological applications\nincluding digital quantum computing. The complexity of such devices renders the certification of their correct functioning a challenge. To address this challenge, numerous methods were developed in the last decade.\n\nIn this tutorial, we explain prominent protocols for certifying the physical layer of quantum devices described by quantum states and processes. Such protocols are particularly important in the development of near-term devices. Specifically, we discuss methods of direct quantum state certification, direct fidelity estimation, shadow fidelity estimation, direct quantum process certification, randomized benchmarking and cross-entropy benchmarking. Moreover, we provide an introduction to powerful mathematical methods, which are widely used in quantum information theory, in order to derive theoretical guarantees for\nthe protocols.\n\n## Introduction\nWe are witnessing rapid progress in the experimental abilities to manipulate physical systems in their\ninner quantum properties such as state superposition and entanglement.\nMost importantly, we begin to have precise control over complex quantum systems on scales\nthat\nare out of reach of simulations on even the most powerful existing classical computing devices.\nHarnessing their computational power promises the development of digital quantum computers that solve important problems\nmuch faster than any classical computer.\nEnvisioned applications also\ninclude, e.g., the study of complex phases of matter in analogue simulations and cryptographically secure communication [Unknown Author, \"Unknown Title\", ].\nHence, quantum technology promises highly useful devices with diverse domains of application ranging from  fundamental research\nto commercial businesses.\n\nWith the advent of these novel technologies comes the necessity for certifying their correct functioning.\nThe certification of quantum devices is a particularly daunting task in the interesting regime of high complexity as\nmost straightforward strategies based on classical simulations are bound to fail.\nIndeed, predicting the behaviour of complex quantum devices quickly exhausts the available classical computing power.\nIronically, it is the same complexity that makes quantum technology powerful that hinders their certification.\nThis challenging prospective has already motivated extensive effort in developing certification tools for quantum devices\nin the last decades.\n\nIntriguingly, numerous fields within the quantum sciences have tackled the\nproblem of certification from a variety of different perspectives and have developed a large landscape of different\nprotocols.\nThese protocols operate under very distinct assumptions and resource requirements that are well-motivated by\nthe different perspectives.\nFor example, certifying the correct function of a small-scale quantum device used in basic research\nallows one to invest sizable efforts.\nHere, one can potentially rely on a precise model of the physics of the device and might aim at a highly discriminative certificate providing plenty of information.\nA very different example is the certification of a server, correctly performing a quantum computation, by a\nremote client with standard desktop hardware.\nSuch a protocol should be light-weight on the client-side and not rely on a detailed model of the server.\n\nAn attempt at a panoramic overview of the many approaches that all fall within\nthe field of quantum certification was recently conducted in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nTherein, a very general classification framework for quantum certification protocols was proposed that is\nabstract enough to capture their wide range.\nLet us start by sketching the general framework.\nThereby we can subsequently define the narrower scope of this tutorial.\n\n### Anatomy of quantum certification protocols\n[t].65 0pt\n\n< g r a p h i c s >\n[t].33 25pt\n\n< g r a p h i c s >\nLeft: the theoretical description of protocols makes use of the distinction into\nthe device, measurement apparatus and classical processor.\nRight: a complex quantum device\ncomprises multiple abstraction layers.\nDifferent protocols aim at certifying the\nfunctioning of the device on different layers.\nNISQ devices are not expected to feature a powerful logical gate layer.\nInstead, applications\nare directly tailored to the physical gate layer.\n\nA certification protocol is a set of instructions that outputs either `accept' or `reject' concerning the\nhypothesis that the device is functioning correctly, with a certain level of confidence.\n\nThe correct functioning of a device is defined in terms of a measure of quality.\nSuch measures range\nfrom rigorous worst-case discrimination of `fundamental' physical objects modeling the device, to\nperformance benchmarks defined in terms of tasks directly on the application layer.\nNote that in principle a measure of quality can be solely defined in terms of a protocol that\nthat can be reproducibly implemented.\nOn the other hand, measures of quality that directly aim at the deviation of physical objects modeling\nthe function of the device can provide an understanding of the device that is\nhighly attractive in the development of the technology.\n\nIn this tutorial, we encounter a couple of such physically motivated measures of quality and study their\nmathematical properties and operational interpretations.\nThese measures all map to the real line.\nCertification protocols then provide $\\epsilon$-certificates that\n\nreject the hypothesis of\nthe measure of quality being larger than a given $\\epsilon$.\nFor this reason, most protocols that we present are estimation protocols for specific measures of quality that\ncan be easily turned into $\\epsilon$-certification protocols by a standard method.\n\nTheoretically, it is convenient to describe the protocol as involving three distinct objects, Fig.\u00a0(Figure fig:anatomy) (left):\nFirst, the device that is under scrutiny.\nIdeally, we try to be fairly conservative\nin the model and assumptions describing the device to be on the safe side.\nSecond, the protocol employs a measurement apparatus.\nThe measurement apparatus, also a quantum device, is typically assumed to be much more precisely characterized compared to\nthe device itself.\nNote that the device and measurement apparatus are not necessarily physically distinct devices.\nChoosing the split might be ambiguous and yield different formulation of the assumptions\nof the protocol.\nAn extreme example are device-independent certification protocols that regard all quantum parts as a single device\nthat is not subjected to any assumptions. In particular, they do not involve an anyhow characterized separate quantum measurement apparatus.\nThe third object, is the classical processor, a classical computing device, that\nmight take care of potentially required pre- and post-processing tasks for the device control\nand the processing of the output data to arrive at a certificate or even\ncommunicates with the device and measurement apparatus in multiple rounds of an interactive protocol.\n\nThe landscape of protocols can be roughly organized according to three `axes'.\nThe first axis comprises the set of assumptions that are imposed on the device and measurement apparatus to guarantee the functioning of\nthe protocol.\n\nA second axis summarizes the complexity of the resources that the protocol consumes.\nEach protocol requires\na certain number of different measurement settings, its measurement complexity, that each require the implementation of\nmeasurements that involve a certain quantum measurement complexity.\nTo arrive at a final statistical estimate, a total number of repetitions of device invocations are required, the scaling of which is referred to as the sample complexity.\nFurthermore, as we already highlighted at the beginning, a particularly important figure of merit\nfor a protocol is that it comes with practically manageable demands in space and time for the classical processing tasks, its classical processing complexity.\nFor our present scope, the mentioned complexity categories are the most important and are in the focus of our discussion.\nNote, however, that this list is by far not complete, for example, interactive protocols might be compared in terms of challenging demands in the timing of the device's control.\n\nThe third and final axis is the information gain of the protocol.\nAt a first glimpse this might come as a surprise as a protocol that outputs `accept' or `reject' might\nbe regarded as always providing one bit of information.\nBut different measures of quality have different discriminatory power among the hypothesis class that models the device\ncompatible with the protocol's set of assumptions.\nFor example, let us imagine a device preparing quantum states on demand.\nWe might require the device to produce a quantum state that is $\\epsilon$-close in some distance measure to a specific target state.\nAn alternative specification of the device might require it to always output the same quantum state but this quantum state should only be within a specified set of quantum states.\nIn this situation, we can roughly say that the information gain restricting the device (within its allowed hypothesis class) is higher in the first specification compared to the latter one.\n\nConcomitant with less information gain, it is conceivable that one can design a protocol for the latter specification with\nsignificantly less complexity compared to the first specification.\nAnalyzing the information gain in performing a certification task often allows one to derive lower bounds on the complexity of any protocol for this task.\nBeside the discriminatory power of the measure of quality, other intermediate steps in the certification protocol can reveal significantly more information about the device than is ultimately reflected in the measure of quality and the final certificate.\nFor example, a potential certification protocol for our device that prepares quantum states might perform a high-precision, complete tomographic reconstruction of the quantum state and subsequently calculate the measure of quality using the tomographic estimate together with its error bounds.\nConceptually, this example illustrates that certification is a subtask of the broader task of quantum system characterization, that encompasses protocols aiming at different types of information about a quantum system, e.g., identification of a quantum system or testing for a specific property.\nProtocols that perform quantum system identification or property estimation naturally also give rise to certification protocols.\nNote that in practice, the hidden information gain of a certification protocol can provide valuable information to calibrate and improve the device.\n\nAnother related task in quantum system characterization is the benchmarking of quantum devices.\nBenchmarking aims at comparing the performance of multiple devices.\nThis can be done by comparing the achievable $\\epsilon$-value of $\\epsilon$-certificates of the respective devices.\nBenchmarking especially provides pragmatic impetus towards measures of quality that are not directly\ninterpretable on the physical layer.\nInstead, for the benchmarking of quantum devices it suffices to implicitly define a reproducible performance measure\nby specifying a protocol that returns the measure.\nThe only required justification is that the measure\nis expected to be correlated with the performance in practically relevant tasks.\n\n### Quantum certification for near-term devices \u2013 scalable certification of the physical-layer\nIn this tutorial, we focus on protocols that are particularly important for the certification\nof near-term quantum devices.\nThese devices are still expected to be fairly noisy\nand of intermediate size, so-called NISQ devices [Unknown Author, \"Unknown Title\", ].\nHowever, they are already in a regime of complexity where prominent certification methods that use\nfull tomographic characterization become practically infeasible.\nOn the other hand, there is still a large technological leap required in order\nto arrive at truly scalable devices, e.g. implementing fault-tolerant quantum computing.\nSuch a full-fledged quantum device is described using multiple layers of abstraction from the\nphysical layer over, e.g. physical and logical gate layers, to an application layer, see Figure\u00a0(Figure fig:anatomy) (right).\nWhen a device already comes with multiple layers of abstraction one can also\ncertify the functioning on the higher levels.\nNISQ devices, however, allow only for a bit of abstraction above the physical layer.\nFor this reason, near-term quantum devices pose the need for certification techniques\nthat aim at the physical layer but are scalable to the intermediate\nsystem sizes of NISQ devices.\nSuch scalable certification methods for the physical layer are the focus of this tutorial.\n\nIn the long term, for complex quantum devices high-level certification on the application level, also referred to as verification,\nwill become increasingly important.\nWith cryptographic techniques quantum computations can be delegated to a remote server without revealing the actual computations.\nThe correct execution of such blind quantum computation can be verified in different settings without many assumptions [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nWe do not cover these methods in this tutorial.\nInstead, we refer to the review\u00a0[Unknown Author, \"Unknown Title\", ] of existing approaches for verifying quantum computations on devices that are close to being able to accurately perform a universal set of operations.\nNote that also in the long run, the scalable certification of the physical layer remains\nimportant for the diagnostic of the components of more complex quantum devices\nin the development and during run-time.\n\nWe model the physical layer generically in terms of quantum states and processes throughout the tutorial.\nThe model is general enough to capture different types of quantum devices used, e.g., in quantum communication networks\nand analogue simulators.\nNonetheless, we take the certification of digital quantum computing devices as our main\nguiding problem.\nParticularly, the last two methods that we discuss, RB and XEB, are specifically designed for digital quantum computing devices.\nRB aims at estimating the physical noise that compromises a gate layer. XEB aims at certifying the generation of samples from a probability distribution encoded in a quantum circuit.\nAs such XEB can be regarded as a certification for the application layer of\na digital quantum computing device. But the application is deliberately designed very close to the physical layer.\n\nIn addition, we chose a set of protocols that can be presented\nand analyzed using a common set of mathematical methods.\nThis allows us to combine our presentation of the certification protocol with a detailed introduction\ninto the mathematical formalism that is required in order to prove rigorous performance guarantees\nfor the protocols.\n\nLastly, we restrict our focus to certification protocols that employ measures of quality that are\nclose to being natural measures of distance on the very fundamental physical description of the devices\nas quantum states and quantum processes.\nAlso, important and equally fundamental, but not captured in this tutorial, is the certification of specific properties such as entanglement or non-classicality.\nCertain distinct properties, e.g. sufficiently high entanglement, allow for the certification of specific quantum states and processes even\ndevice-independently.\nThis class of so-called self-testing protocols is reviewed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nOne of the most intriguing aspects of the field of quantum certification is definitely\nthe impressive stretch over multiple disciplines that come into play.\nQuantum certification is equally a field in applied mathematics,\ntheoretical computer science,\napplied numerical computer science, experimental physics and quantum hardware and software engineering.\nIt comprises proofs of theorems, classical numerical studies of actual implementations,\nand performing the protocol in an actual quantum experiment\nincluding a diligent analysis of\n\u2018real-world\u2019 data.\nEach of the disciplines involved comes with its own methods accustomed to the arising challenges.\nAt the same time, looking at certification on different stages from theory to experiment holds\nvaluable lessons that go in both directions.\nHaving said this,\nwe present a practically well-motivated but\ntheoretical formal framework for\na set of quantum certification protocols.\nWe do not delve into the exciting world of\nnumerical and\nexperimental implementations of the certification protocols\nthat bring our model assumptions to the harsh scrutiny of \u2018real-world\u2019 physics.\nInstead, practical considerations and desiderata constantly serve as our motivation\nand inform our discussion.\n\n### Overview and structure\nThe tutorial is divided into two major subsequent parts: the first part focusing on certification protocols for quantum states, Section\u00a0<ref>, and the second part focusing on certification protocols for quantum processes, Section\u00a0<ref>.\nFurthermore, the tutorial consists of two different types of chapters: chapters that introduce the mathematical preliminaries, and chapters that present and analyze the certification protocols.\nWe try to bring these two types of chapters in a dialog that goes back and forth between providing the motivation and tools for understanding the mathematical framework and protocols.\nThe chapters on certification protocols conclude with suggestions for further reading on variants and extensions of the protocol and its theoretical analysis.\n\nWe would like to highlight that the mathematical methods are core foundations of the broad field of theoretical quantum information and are by far not limited to quantum certification or even quantum characterization in their applications.\nQuite on the contrary, we expect the mathematical introductory chapters to serve as a valuable resource for students and researches working on quantum information in general.\nAt the same time experts in quantum information mainly interested in the presented certification methods\nmight want to simply skip the mathematical introductory chapters. They can conveniently find the protocol chapters in the table of contents by looking out for chapter titles that are typeset in italic font.\n\nIn more detail, the mathematical methods and certification protocols presented here are the following:\nwe start our discussion on quantum states with a brief introduction to the mathematical formalism of quantum mechanics, such as mathematical notions of operators and the modeling of quantum mechanical measurements (Section\u00a0<ref>).\nThis allows us to formally introduce quantum state certification as a one-sided statistical test in Section\u00a0<ref>.\nCertification protocols rely on quantum mechanical measurements, which are probabilistic in nature.\nTherefore, the confidence of the protocols is controlled using so-called tail bounds introduced in Section\u00a0<ref>.\nAs an example for an application of tail bounds, we derive the estimation error and the confidence when estimating expectation values of observables in Section\u00a0<ref>.\nIn order to quantify the accuracy of quantum state preparations, we introduce relevant metrics on quantum states in Section\u00a0<ref>.\nA popular metric is given by the (Uhlmann) fidelity.\nWe provide a certification protocol in terms of the fidelity in Section\u00a0<ref>.\nStabilizer states are an important class of quantum states that can be certified with particularly few Pauli measurements (Section\u00a0<ref>).\nAnother approach to certification employs estimation protocols.\nEstimating the fidelity requires more measurements compared to the one-sided certification protocol.\nA tool to reduce the measurement effort is importance sampling introduced in Section\u00a0<ref>.\nDFE uses this method to estimate the fidelity w.r.t. pure target states from relatively few state copies, Section\u00a0<ref>.\n\nFor the remaining part of the tutorial random quantum states and random unitaries play an important role.\nFor this reason, we introduce them in Section\u00a0<ref>.\nCertain random unitary operations allow, in general, for an estimation of the fidelity from fewer state copies than DFE, which we explain in Section\u00a0<ref> on SFE.\n\nWe start our discussion of quantum processes with some mathematical preliminaries (Section\u00a0<ref>), where we introduce the Choi- isomorphism (a.k.a. channel-state duality), process fidelity measures quantifying average-case error measures and a worst-case error measure, the diamond norm.\nMost certification methods for quantum processes use average-case error measures.\nThe presented quantum state certification methods can be translated to quantum processes using the Choi- isomorphism.\nAs an example, Section\u00a0<ref> presents the resulting protocol for direct quantum process certification.\nSuch translated protocols, typically require high-quality state preparations and measurements to probe the quantum processes.\nA method tailored to quantum gates that allows the average gate fidelity to be extracted without requiring highly accurate state preparations and measurements is RB (Section\u00a0<ref>).\nAs our last protocol we discuss XEB in Section\u00a0<ref>;\nthis method has been used by Google to build trust in their recent experiment demonstrating the potential power of quantum computers in the task of generating certain random samples.\n\n## Quantum states\nThe first part of the tutorial is devoted to  protocols that aim at certifying that a quantum state generated by a device is the correct one.\nWe start by quickly reviewing and introducing the mathematical formalism\nof quantum mechanics.\nWe expect that most of the presented material and basic mathematical notions\nare already known to the reader.\nTherefore, we are fairly brief in our presentation and\naim at quickly setting up the notation that we use throughout the tutorial.\nFor sake of completeness, we provide many details on the mathematical formalism.\nHowever, the main ideas behind the protocols and their theoretical guarantees can also be followed with a more superficial understanding of the mathematical preliminaries.\n\n### Mathematical objects of quantum mechanics\nIn order to discuss quantum states we set up some mathematical notation.\nWe focus on finite-dimensional quantum mechanics in accordance with our emphasis on\ndigital quantum computing. Hence, we assume all vector spaces to be finite-dimensional.\nThe space of linear operators from a vector space $V$ to a vector space $W$ is denoted by $\\L(V,W)$, and we set $\\L(V) \\coloneqq \\L(V,V)$.\nA Hilbert space is a vector space with an inner product $\\langle \\cdot, \\cdot \\rangle$ (w.r.t. which it is complete).\nLet $\\H$ and $\\K$ be complex Hilbert spaces throughout the tutorial.\nWe denote the adjoint of an operator $X \\in \\L(\\H, \\K)$ by $X^\\ad$, i.e. $\\langle k , X h\\rangle = \\langle X^\\ad k, h\\rangle$ for all $h \\in \\mathcal H$ and $k \\in \\mathcal K$.\n\nAs customary in physics, we use the bra-ket notation (Dirac notation):\nwe denote vectors by ket-vectors $\\ket\\psi \\in \\H$ and linear functionals on $\\H$ by bra-vectors $\\bra\\psi$, which are elements of the dual space $\\H^\\ast$.\nFurthermore, we understand ket-vectors and bra-vectors with the same\nlabel as being related by the canonical isomorphism induced by the inner product.\nIn bra-ket notation we frequently drop tensor-product operators to shorten the notation, e.g. $\\ket\\psi\\!\\ket\\phi \\coloneqq \\ket\\psi\\otimes \\ket\\phi \\in \\K \\otimes \\H$ or $\\ketbra\\psi\\psi \\coloneqq \\ket\\psi\\otimes \\bra\\psi \\in \\K \\otimes \\H' \\cong \\L(\\K, \\H)$ for $\\ket\\psi \\in \\K$ and $\\ket\\phi \\in \\H$.\n\nTo describe the state of a quantum system we require the notion of density operators.\nThe real subspace of self-adjoint operators, $X=X^\\ad$, is denoted by $\\Herm(\\H)\\subset \\L(\\H)$ and the convex cone of positive semidefinite operators by $\\Pos(\\H) \\coloneqq \\{X \\in \\Herm(\\H) \\mid \\sandwich \\psi X \\psi \\geq 0 \\}$.\nThe trace of an operator $X \\in \\L(\\H)$ is\n$\\Tr[X]\\coloneqq \\sum_i \\sandwich iXi$, where $\\{\\ket{i}\\}\\subset \\H$ is an arbitrary orthonormal basis of $\\H$.\nThe vector space $\\L(\\H)$ is itself a Hilbert space endowed with the Hilbert-Schmidt (trace) inner-product\n$$\n\\label{eq:HS_inner_prod}\n\\langle X, Y\\rangle \\coloneqq \\Tr[X^\\ad Y]\\, .\n\n$$\nThe set of density operators is defined as\n$\\DM(\\H) \\coloneqq \\{ \\rho \\in \\PSD(\\H): \\ \\Tr[\\rho] = 1\\}$.\n\nOutcomes of a quantum measurement are modeled by random variables.\nAbstractly, a random variable is defined as a measurable function from a probability space to a measurable space $\\mathcal X$.\nHere, we are exclusively concerned with two types of random variables: (i) those that take values in a finite, discrete set\n$\\mathcal X \\cong [n] \\coloneqq \\{1, \\ldots, n\\}$ (understood as the measurable space with its power set as the $\\sigma$-algebra)\nand (ii) those that take values in the reals $\\mathcal X = \\RR$ (with the standard Borel $\\sigma$-algebra generated by the open sets).\nIn practice, the underlying probability space is often left implicit and one describes a\nrandom variable $X$ taking values in $\\mathcal X$ directly by its probability distribution $\\Pr$ that assigns a probability\nto an element of the $\\sigma$-algebra of $\\mathcal X$.\nFor example, for a random variable $X$ taken values in $\\RR$ and $I \\subset \\RR$ an interval, we write $\\Pr[X \\in I]$ for the probability of $X$ assuming a value in $I$.\nAbstractly speaking, $\\Pr$ is the push-forward of the measure of the probability space to $\\mathcal X$ induced by the random variable $X$. Thus, $\\Pr$ is sufficient to describe $X$.\nThe underlying probability space is, however, important to define correlations between multiple random variables which are understood to be defined on the same probability space.\n\nThe probability distribution of a discrete random variable $X$ taking values in a finite set $\\mathcal X \\cong [n]$ is characterized by its probability mass function $p_X: [n] \\to [0,1]$, $k \\mapsto p_X(k) \\coloneqq \\Pr[X = k] \\coloneqq \\Pr(X \\in \\{k\\})$.\nA real random variable $X$ is characterized by its (cumulative) distribution function $P_X: \\RR \\to [0,1]$, $x \\mapsto P_X(x) \\coloneqq \\Pr[X < x] \\coloneqq \\Pr[X \\in (\\infty, x)]$ or in case it is absolutely continuous by its probability density function $p_X: \\RR \\to [0,1]$,  $x \\mapsto p_X(x) \\coloneqq \\left.\\frac{d}{dt}\\right|_x P_X(t)$.\nNote that if a discrete random variable takes values in a discrete subset of $\\RR$ we can also assign a non-continuous (cumulative)  distribution function.\n\nThe most general way to define a linear map from density operators $\\DM(\\H)$ to random variables is by means of a POVM.\nA POVM is a map from (the $\\sigma$-algebra) of $\\mathcal X$ to $\\Pos(\\mathcal H)$.\nFor a discrete random variable $X$ taking values in $[n]$ a POVM is uniquely defined by a set of effects $\\{E_i \\in \\Pos(\\mathcal H)\\}_{i=1}^{n}$ with\n$$\n\n\\sum_{i=1}^n E_i = \\1_{\\H}\\, ,\n\n$$\nwhere $\\1_{\\H}\\in \\L(\\H)$ denotes the identity operator.\nStrictly speaking the POVM is the map on the power set of $[n]$ that extends\n$k \\mapsto E_k$ additively.\nIt is convenient and common to refer to the set of effects as the POVM.\nA POVM $\\mset$ (with effects) $\\{E_i \\in \\Pos(\\mathcal H)\\}_{i=1}^{n}$ induces a map from $\\DM(\\H)$ to random variables.\nTo this end, we associate to $\\rho$ the random variable $\\mset_\\rho$ with probability mass function $p_{\\mset_\\rho}(k) \\coloneqq \\langle \\rho, E_k \\rangle$.\n\nThese are the ingredients to formalize the static postulates of quantum theory.\nWe will only require dynamics in Section\u00a0<ref> on quantum process certification.\n\n[fonttitle=]Postulate (quantum states and measure\u00adments):0\n*  Every quantum system is associated with a (separable) complex Hilbert space $\\H$.\n\n*  The state of a quantum system, its quantum state, is described by a density operator $\\rho \\in \\DM(\\H)$\n\n*\nA measurement with potential outcomes in a finite, discrete set $O \\cong [n]$ is\ndescribed by a POVM $\\mset$ with effects $\\{E_i\\}_{i \\in [n]}$.\n\n*  If a quantum system is in the state $\\rho \\in \\DM(\\H)$ and the measurement $\\mset$ is performed\nthe observed outcome is a realization of the random variable $\\mset_\\rho$ associated to $\\rho$ by $\\mset$.\n\nThe set $\\DM(\\H)$ is convex.\nIts extremal points are rank-one operators.\nA quantum state $\\rho \\in \\DM(\\H)$ of unit rank is called a pure state.\nIn particular, there exist a state vector $\\ket\\psi \\in \\H$ such that $\\rho = \\ketbra\\psi\\psi$.\nThe state vector associated to a pure quantum state is only unique up to a phase factor.\nA general quantum state is therefore a convex combination of the form $\\sum_i p_i \\ketbra{\\psi_i}{\\psi_i}$, where $p$ is a probability vector, i.e., an entry-wise non-negative vector $p\\in \\RR^d$, $p \\geq 0$ that is normalized, i.e., $\\sum_i p_i = 1$.\nA quantum state that is not pure is called mixed.\n\nGiven two\nquantum systems, their joint system should also be a quantum system.\nThis expectation is captured by the following postulate.\n\nPostulate (composite quantum systems):\nThe Hilbert space of two quantum systems with Hilbert spaces $\\mcH_1$ and $\\mcH_2$, respectively,  is the tensor product $\\mcH_1\\otimes \\mcH_2$.\nThis construction induces an embedding from $\\L(\\mcH_1)$ into $\\L(\\mcH_1\\otimes\\mcH_2)$ by\n$$\n\nA \\mapsto A \\otimes \\1 \\, .\n\n$$\nDually to that, for any state $\\rho\\in \\DM(\\mcH_1\\otimes\\mcH_2)$,\n$$\n\n\\Tr[\\rho\\, ( A\\otimes \\1)] = \\Tr[\\rho_1 A] \\, ,\n\n$$\nwhere $\\rho_1$ is $\\rho$ reduced to system $1$;\nthe reduced state captures all information of $\\rho$ that can be obtained from measuring system $1$ alone and can be explicitly obtained by the partial trace over the second subsystem\n$$\n\n\\begin{aligned}\n\\Tr_2 : \\L(\\mcH_1\\otimes \\mcH_2) &\\to \\L(\\mcH_1) \\qquad \\text{(linear)}\n\\\\\nX\\otimes Y &\\mapsto \\Tr_2[X\\otimes Y] \\coloneqq X \\Tr[Y]\n\\end{aligned}\n\n$$\nas $\\rho_1\\coloneqq \\Tr_2[\\rho]$.\n\nBy $\\FF\\in \\L(\\mcH\\otimes\\mcH)$ we denote the flip operator (or swap operator) that is defined by linearly extending\n$$\n\\label{eq:SwapOp}\n\\FF \\ket\\psi\\ket\\phi \\coloneqq \\ket\\phi\\ket\\psi  \\, .\n\n$$\nIn a basis $\\{\\ket i\\}_{i=1}^{\\dim(\\H)}$ of $\\H$, we can express $\\ket \\psi \\in \\H \\otimes \\H$ by a coefficient matrix $A \\in \\CC^{\\dim \\H \\times \\dim \\H}$ as $\\ket \\psi = \\sum_{i,j} A_{ij} \\ket i \\ket j$.\nThe coefficient matrix of $\\FF\\ket \\psi$ is given by the matrix transpose $A^{\\T}$ of $A$ with entries $(A^{\\T})_{i,j} = A_{j, i}$.\n\nThe swap-trick\nLet $\\FF\\in \\L(\\mcH\\otimes\\mcH)$ be the flip operator(<ref>).\nShow that\n$$\n\\label{eq:swap-trick}\n\\Tr[\\FF(X\\otimes Y)]\n=\n\\Tr[XY]\n\n$$\nfor any $X \\in \\L(\\H)$.\nThe swap-trick\nLet $\\FF\\in \\L(\\mcH\\otimes\\mcH)$ be the flip operator(<ref>).\nFor any $X \\in \\L(\\H)$ it holds that\n$$\n\\ifex\\else\\label{eq:swap-trick}\\fi\n\\Tr[\\FF(X\\otimes Y)]\n=\n\\Tr[XY]\\, .\n\n$$\n\nThe identity can be checked by direct computation with basis elements or by using tensor network diagrams.\nWe leave it as an exercise.\n\n### A definition of quantum state certification\nIn this section, we define\nwhat we mean by a certification test for a quantum state.\nThis definition will serve as the blue-print for the specific protocols that we present in the subsequent sections of the chapter.\nA state certification test solves the task of making sure that a quantum state prepared by a device $\\rhop$ is a sufficiently good approximation of a target state $\\rhot$.\nDue to the statistical nature of quantum measurements, the protocol for a certification test\ntypically requires multiple copies of the quantum state.\nFor this reason, it is appropriate to think of quantum state certification as the certification of a device that\nrepeatedly prepares a target state $\\rhot$.\n\nIn this tutorial we restrict our attention to single round protocols,\nwhere a fixed number $\\np$ of copies of a target state is prepared and measured subsequently.\nWithout further assumptions the output of the device is described by an output state $\\Rhop \\in \\DM((\\CC^d)^{\\otimes \\np})$ on which the measurements are performed.\nBased on the measurement data the classical post-processor then decides to accept or reject the hypothesis that the device\nprepared the target state within a specified accuracy.\n\nThis procedure is formalized by the notion of an $\\epsilon$-certification test, illustrated in Fig.\u00a0(Figure fig:cert).\nAn $\\epsilon$-certification test should output  if the prepared state is the targeted state in the majority of attempts.\nThis requirement is referred to as completeness.\nAdditionally, one demands an $\\epsilon$-certification to likely output  in case the prepared state deviates from the target state beyond a tolerance.\nThe deviation is quantified in terms of a distance measure on $\\DM(\\CC^d)$ taking values in $\\RR_+$, the non-negative reals, and `beyond tolerance'\nmeans that it exceeds a certain tolerated error threshold $\\epsilon > 0$.\nWe arrive at the following definition for a single-round $\\epsilon$-certification test.\n\nfig_cert\n< g r a p h i c s >\n\nThe task of quantum state certification is to detect when a state preparation $\\rhop$ is not close to a chosen target state $\\rhot$, i.e. when $\\dist(\\rhot,\\rhop)>\\epsilon$.\n[label=def:state_certification,fonttitle=]Quantum state $\\epsilon$-certification test\nLet $\\rhot \\in \\DM(\\CC^d)$ be a quantum state, the target state,\n$\\epsilon > 0$ and $\\dist: \\DM(\\CC^d)  \\times \\DM(\\CC^d) \\to \\mathbb R_{+}$\nbe a distance measure.\nAn $\\epsilon$-certification test for $\\rhot$ w.r.t. $\\dist$ consists\nof a quantum measurement on the device output\n$\\Rhop \\in \\DM((\\CC^d)^{\\otimes \\np})$\nfollowed by classical post-processing of the measurement data\noutputting either  or  and satisfying the completeness condition,\n$$\n\\label{eq:right_accept}\n\\Rhop = \\rhot^{\\otimes \\np}\n\\ \\Rightarrow \\\n\\Pr[{\\accept}] \\geq \\frac 23 \\, ,\n\n$$\nand the soundness condition holds for the reduced states $\\rhop_i$ of $\\Rhop$,\n$$\n\\label{eq:right_reject}\n\\dist(\\rhot, \\rhop_i) > \\epsilon \\ \\forall i \\in [\\np]\n\\ \\Rightarrow \\\n\\Pr[{\\reject}] \\geq \\frac23 \\, .\n\n$$\n\nNote that more generally one could also define certification tests with respect to measures directly on the composite space $\\DM((\\CC^d)^{\\otimes \\np})$.\n\nThe terms completeness and soundness are inspired by interactive proof systems.\nThe role these conditions can be clarified from the\nperspective of statistical hypothesis testing.\nIn hypothesis testing one has a null hypothesis $H_0$ (often the hypothesis that one hopes to disprove) and an alternative hypothesis $H_1$ and one needs to figure out which is true based on statistical data.\nIn this setting, there are two types of error,\n$$\n\n\\PP[\\,\\text{accept $H_1$}\\mid H_0]&\\quad \\text{(type-I error)}\n\\\\\n\\PP[\\,\\text{accept $H_0$}\\mid H_1]&\\quad \\text{(type-II error)} \\, .\n\n$$\nIn state certification we choose the null hypothesis $H_0$ to be `$\\dist(\\rhop, \\rhot)>\\epsilon$' and `$\\rhop=\\rhot$' to be the alternative hypothesis $H_1$.\nThen, for the output of the $\\epsilon$-state certification test, $\\Pr[{\\reject} \\mid \\rhop=\\rhot]$ is the type-II error and\n$\\Pr[{\\accept} \\mid \\dist(\\rhop, \\rhot) > \\epsilon]$\nthe type-I error.\nThe completeness condition (<ref>) corresponds to requiring that the type-II error is bounded by $1/3$.\nAnalogously, the soundness condition (<ref>) is the requirement that the type-I error is bounded by $1/3$.\n\nFor a test to meet the soundness and completeness condition additional\nassumptions on the prepared state $\\Rhop$ can be required.\nA common assumption is that the device prepares a sequence of independent states.\nThis means that\n$$\n\\label{eq:globalRhop}\n\\Rhop = \\rhop_1 \\otimes \\rhop_2 \\otimes \\cdots \\otimes \\rhop_{n_\\rho}\n\n$$\nwith $\\rhop_i \\in \\DM(\\CC^d)$ for all $i$.\nIn principle, it is also conceivable that a device prepares entangled states to maliciously\ntrick a certifier working under the independence assumption.\nBut in many circumstances minimal control over the device or beliefs about its physically plausible\nlimitations justify the independence assumptions.\n\nAn even stronger assumption is that the prepared states are independent and identically distributed (iid.).\nIn this case, $\\Rhop = \\rhop^{n_\\rho}$.\nIn the experimental practice it can be challenging to fulfill this assumption. For example, drifts\nin environmental parameters of a device can yield to a systematic deviation of the\nstate copies that defy the iid. assumption.\nNonetheless, in many instances\nthe iid. assumption may be justified by a basic understanding of the functioning of the device and valid to a sufficient degree.\nIn some situations, the iid. assumption can be removed at the cost of a higher measurement effort using [Unknown Author, \"Unknown Title\", ] a quantum de Finetti theorem [Unknown Author, \"Unknown Title\", ] or an improved analysis [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe arguably most important measure of complexity for an $\\epsilon$-certification test is its sampling complexity.\n\n[label=def:certification_sampling_complexity]sampling complexity\nThe sample complexity of a family of\ntests $\\{\\mc T_{\\np}\\}$, each consuming $\\np$ states, is (the scaling of) $\\np$ with $d$ and $\\epsilon$.\n\nThe sampling complexity is the scaling of the number of states that the device needs to prepare for the test with the input parameters.\nIn particular, in the context of digital quantum computing the statement that a \u201cprotocol is efficient\u201d  is often understood as\nhaving sampling complexity in $\\LandauO(\\polylog(d))$ as this translates into a sampling complexity in $\\LandauO(\\poly(n))$ for a system of $n$ qubits.\nMost guarantees that we prove for protocols in this tutorial, consist in upper bounds on the sampling complexity of a test.\n\nAnother important measure for the practical feasibility of the protocol is the measurement complexity that quantifies how difficult\nit is to perform the quantum measurements of the protocol.\nIn contrast to the precise definition of the sampling complexity, the measurement complexity should be regarded as a collection of different ways to formalize the demands of the measurement.\nFor this reason, the discussion of the measurement complexity is of more qualitative nature.\n\nIn the context of state certification, an important aspect of measurement complexity is the number of copies that the POVM needs to act on simultaneously.\nThe special case that encompasses all the presented protocols are sequential measurements where the measurements are only performed on the $\\np$ individual state copies separately.\nTherefore, the measurement device does not need to be able to store state copies before performing a measurement significantly lowering its complexity.\n\nAnother relaxation of the measurement complexity of sequential measurements are non-adaptive measurements where\nthe performed measurement on an individual copy does not depend on the previously obtained measurement results.\nFurthermore, the complexity of the implementation of the POVM can be quantified, e.g. by measures for the complexity of the circuits required for its implementation in terms of local gates.\nThe qualitative assessment of the measurement complexity as being experimentally feasible or not can vary widely for different devices and platforms.\n\nA certification test is only required to accept the target state.\nHowever, in practice, such test will accept states from some region around the target state with large probability.\nThis property of a certification test is called robustness (against deviations from the target states).\nOne way of how such a robustness can be guaranteed is by estimating the distance of the targeted state $\\rho$ and the prepared state $\\rhop$,\nas we see in Section\u00a0<ref> on fidelity estimation.\nIn this way, one obtains more information (a distance) than just  or .\n\nClearly, one can also certify through full quantum state tomography.\nHowever, the number of single sequential measurements in general required for tomography of a state $\\rhop \\in \\DM(\\CC^d)$ scales as $\\Omega(d\\rank(\\rho))$ and as $\\Omega(d^2\\rank(\\rho)^2)$ in the case two-outcome Pauli string measurements [Unknown Author, \"Unknown Title\", ].\nSo, for the relevant case of pure $n$-qubit states this number scales at least as $2^{n}$.\nThis measurement effort becomes infeasible already for relatively moderate $n$.\n\nAs we will see, fidelity estimation can work with dramatically fewer measurements than full tomography, when the target state has additional structure.\nIn many situations, certification can work with even fewer measurements than fidelity estimation thanks to an improved $\\epsilon$-dependence in the sample complexity.\n\nOur definition of a certification test used the somewhat arbitrary confidence value of $2/3$.\nIt is not hard to see that as long as the failure probability is bounded away from $1$, the confidence can be amplified\nby repeating the test multiple times.\n\n[label=ex:confidence_amplification]Confidence amplification\nLet $\\mc T_{n_\\rho}$ be an $\\epsilon$-certification test of a quantum state $\\rho$ from $n_\\rho$ iid. samples with maximum failure probability $\\delta = \\frac 13$.\nWe repeat the certification test $N$ times and obtain a new certification test by performing a majority vote on the outcomes.\nShow that the new test satisfies the completeness and soundness conditions\n$$\n\n\\sigma = \\rho\n&\\Rightarrow\n\\Pr[{\\accept}] \\geq 1-\\delta \\, ,\n\\\\\n\\dist(\\rhot,\\rhop)>\\epsilon\n&\\Rightarrow\n\\Pr[{\\reject}] \\geq 1-\\delta \\, ,\n\n$$\nfor all $\\sigma \\in \\DM(\\CC^d)$,\nwhere $\\delta = \\e^{-c\\,N}$ and $c>0$ is an absolute constant.\nThe parameter $1-\\delta$ is also called the confidence of the test.\nConfidence amplification[label=ex:confidence_amplification]Confidence amplification\nLet $\\mc T_{n_\\rho}$ be an $\\epsilon$-certification test of a quantum state $\\rho$ from $n_\\rho$ iid. samples with maximum failure probability $\\delta = \\frac 13$.\nWe repeat the certification test $N$ times and obtain a new certification test by performing a majority vote on the outcomes.\nThen the new test satisfies the completeness and soundness conditions\n$$\n\n\\sigma = \\rho\n&\\Rightarrow\n\\Pr[{\\accept}] \\geq 1-\\delta \\, ,\n\\\\\n\\dist(\\rhot,\\rhop)>\\epsilon\n&\\Rightarrow\n\\Pr[{\\reject}] \\geq 1-\\delta \\, ,\n\n$$\nfor all $\\sigma \\in \\DM(\\CC^d)$,\nwhere $\\delta = \\e^{-c\\,N}$ and $c>0$ is an absolute constant.\nThe parameter $1-\\delta$ is also called the confidence of the test.\n\nThis statement can be checked directly from Definition\u00a0<ref>.\n\nWe remark that the statement of this proposition also holds without the iid. assumption.\nHere, only the proof of the soundness condition (<ref>) changes, since $\\Rhop$ might be classically correlated or entangled across the $\\np$ subsystems.\nHowever, one can show (see, e.g. [Unknown Author, \"Unknown Title\", ] for the argument) that the worst case, given by a $\\Rhop$ with minimum rejection probability, corresponds to a product state.\nThis statement can be proven by choosing a basis for $(\\CC^d)^{\\otimes \\np}$ for which the local measurements are all diagonal. Then the measurement outcomes only depend on the diagonal entries of $\\Rhop$ and, hence, a worst-case $\\Rhop$ is a pure product state.\nThis means that the worst case corresponds to iid. state preparations.\n\nFinally, we want to mention that, especially in the computer science community, certification is often also called verification.\nIn particular from an epistemological point of view, a physical model or hypothesis can never be fully verified.\nTherefore, we will stick to the term certification for the physical-layer where we actually model a device as being in a quantum state.\nThis allows one to reserve the term verification to certification on higher level of device abstraction such as the application layer.\n\n### Estimation and tail bounds\nA main technical tool for bounding the sampling complexity of certification protocols are tail bounds.\nThe measurement outcomes of a quantum mechanical experiment are random variables.\nRecall that the expected value of a random variable $X$ on a probability space $(\\Omega, \\Sigma, P)$ is defined as\n$$\n\n\\EE[X] = \\int_{\\Omega} X(\\omega) \\rmd P(\\omega),\n\n$$\nwhich gives rise to the standard expressions\n$$\n\n\\EE[X] = \\sum_{k \\in [n]} p_X(k) x_k \\quad \\text{and} \\quad \\EE[X] = \\int_{\\RR} x\\, p_X(x) \\rmd x\n\n$$\nfor a discrete finite random variable $X$ taking values in $\\{x_k\\}_{k\\in [n]}$ or a (absolutely continuous) real random variable $X$, with\n$p_X$ being the probability mass function or probability density function, respectively.\n\nWhen we want to estimate a measure of quality, such as a distance measure for quantum states,\nwe have to construct an estimator for that measure, which is a function of measurement outcomes.\nAn estimator $\\hat E$ of a quantity $E$ can itself be viewed as a random variable (pushing forward the measure on the probability space).\nIt is said to be unbiased if $\\EE[\\hat E] = E$.\nOur estimators are typically families of random variables depending on a number of samples, i.e., the number of quantum states that the protocol consumes.\nIn our notation we often leave this dependency implicit.\nWe expect that if a protocol provides an estimator $\\hat E$ then it reveals $E$ accurately in the limit of infinitely many samples.\nSuch an estimator is called consistent (if $\\hat E$ converges to $E$ in probability).\nTo capture the effect of finite statistics, we introduce the notion of an $\\epsilon$-accurate estimator.\n\nfig_tail\n< g r a p h i c s >\n\nThe (upper) tail of a random variable $X$ is the probability of $X$ being greater than some threshold $t$.\nThis probability is given by the corresponding area under the graph of the probability density function (PDF) of $X$.\n$\\epsilon$-accurate estimator\nLet $E \\in \\RR$ and $\\epsilon, \\delta > 0$.\nA random variable $\\hat E$ taking values in $\\RR$ is an $\\epsilon$-accurate estimator for $E$ with confidence $1 - \\delta$ if\n$$\n\n\\Pr[|\\hat E - E| \\leq \\epsilon] \\geq \\delta\\, .\n\n$$\n\nThe (scaling of) number of samples required for a family of estimators to be an $\\epsilon$-accurate estimator is its sampling complexity.\nThe sampling complexity of estimators\ncan be derived using tail bounds of random variables.\n\nTail bounds for random variables are bounds to the probability that a random variable assumes a value that deviates from the expected value, as visualized by the marked area in Figure\u00a0(Figure fig:tail).\nIndeed, for any non-negative random variable $X$ it is unlikely to assume values that are much larger than the expected value $\\EE[X]$, as guaranteed by the following inequality.\n\nMarkov's inequality\nLet $X$ be a non-negative random variable and $t > 0$. Then\n$$\n\\label{eq:MarkovsIneq}\nP_X(t) = \\PP[X\\geq t] \\leq \\frac{\\EE[X]}{t} \\, .\n\n$$\n\nMarkov's inequality is as elementary as its proof.\nLet $(\\Omega, \\Sigma, P)$ be the probability space of $X$.\nFor the proof we denote\nthe indicator function $\\vec 1_A$ of a subset $A \\subset \\Omega$ by\n$$\n\\label{eq:def:indicator_func}\n\\vec 1_A(\\omega) \\coloneqq\n\\begin{cases}\n1 & \\text{ if } \\omega\\in A\\\\\n0 & \\text{ otherwise. }\n\\end{cases}\n\n$$\nTo prove Markov's inequality we set $A\\coloneqq \\{\\omega: \\ X(\\omega) \\geq t\\}$ and observe that\n$$\n\nt\\, \\vec 1_{\\{\\omega: \\ X(\\omega) \\geq t\\}}(\\omega') \\leq X(\\omega')\n\n$$\nfor all $\\omega' \\in \\Omega$.\nTaking the expected value of both sides of this inequality finishes the proof.\n\nAs a consequence of Markov's inequality, the variance of a real random variable $X$,\n$$\n\n\\Var[X] = \\EE[X^2] - \\EE[X]^2\\, ,\n\n$$\ncan be used to control its tails:\n\n[label=thm:Chebyshev]Chebyshev's inequality\nLet $X$ be a random variable, $\\EE[X] = 0$, with finite variance $\\sigma^2 \\coloneqq \\EE[X^2]$.\nThen\n$$\n\\label{eq:Chebyshev}\n\\PP[|X|\\geq t ] \\leq \\frac{\\sigma^2}{t^2}\n\n$$\nfor all $t\\geq 0$.\n\nThe proof follows by simply applying Markov's inequality to the random variable $X^2$.\n\nNote that the assumption of mean zero is not really a restriction but only helps to state the theorem more concisely.\nIn the case of a random variable $Y$ that does not necessarily have a zero mean, Chebyshev's inequality yields a tail bound by applying it to $X \\coloneqq Y - \\EE[Y]$; see also Figure\u00a0(Figure fig:tail).\nThe same argument can be made for the tail bounds below.\n\nA random variable $X$ is called bounded if it takes values in a bounded subset of the reals almost surely.\nIts empirical mean is $\\frac 1n\\sum_{i=1}^n X_i$ where $X_i\\sim X$ are iid. copies of $X$.\nIn the case of bounded random variables, the empirical mean concentrates much more than a naive application of Markov's or Chebychev's inequality suggests.\nMore precisely, the following inequality holds (see, e.g., [Unknown Author, \"Unknown Title\", ]).\n\n[label=thm:Hoeffdings]Hoeffding's inequality\nLet $X_1, \\dots, X_n$ be independent bounded random variables with $a_i \\leq X_i \\leq b_i$ almost surely for all $i \\in [n]$ and denote their sum by $S_n\\coloneqq \\sum_{i=1}^n X_i$.\nThen for all $t > 0$ it holds that\n$$\n\\label{eq:Hoeffdings}\n&\\PP[S_n-\\EE[S_n]\\geq t]\n\\leq\n\\exp\\myleft( -\\frac{2\\, t^2}{\\sum_{i=1}^n (b_i-a_i)^2} \\myright)\n\\\\\\notag\n&\\text{and}\n\\\\\n&\\PP[|S_n-\\EE[S_n]| \\geq t]\n\\leq\n2 \\exp\\myleft( -\\frac{2\\, t^2}{\\sum_{i=1}^n (b_i-a_i)^2} \\myright) .\n\\label{eq:HoeffdingsAbs}\n\n$$\n\nWe only sketch the proof and recommend to flesh out the details as an exercise.\nThe second statement directly follows from the first one.\nIn order to prove the first one, let $s>0$, apply Markov's inequality to\n$$\n\n\\PP[S_n - \\EE[S_n] \\geq t]\n=\n\\PP\\left[\\e^{s(S_n - \\EE[S_n])} \\geq \\e^{s\\,t}\\right]  .\n\n$$\nThe independence of the $X_i$ allows us to factorize the exponential and\nuse the bounds on the range of $X_i$ individually.\nFinally, choosing the optimal $s$ yields the theorem's statement.\n\nNote that when one can additionally control the variance of bounded random variables then the Bernstein inequality [Unknown Author, \"Unknown Title\", ] can give a better concentration, especially for small values of $t$.\n\nAnother related tail bound is Azuma's inequality, which allows for a relaxation on the independence assumption (super-martingales with bounded differences).\n\nThe median of means estimator is an estimator that allows for much better tail bounds than the empirical mean for the case of unbounded i.i.d. random variables with finite variance.\nThe intuition is that taking the median of several empirical means\nis more robust against statistical outliers compared to taking the overall empirical mean.\n\n[label=thm:MME]Median of means estimator,\nversion of [Unknown Author, \"Unknown Title\", ]\nLet $\\{X_i\\}$ be iid. random variables with mean $\\mu$ and variance\n$\\sigma^2$ and denote by $S_k\\coloneqq \\frac 1k \\sum_{i=1}^k X_i$ the empirical mean from $k$ i.i.d. samples.\nTake $l$ empirical means $S_{k,j}$, $j \\in [l]$, that are (iid.) copies of $S_k$ and set\n$$\n\\label{eq:MMestimator}\n\\hat \\mu \\coloneqq \\operatorname{median}(S_{k,1}, \\dots, S_{k,\\ell})\\, .\n\n$$\nThen\n$$\n\n\\PP\\bigl[\\bigl|\\hat \\mu - \\mu \\bigr| > \\sigma\\sqrt{4/\\ell}\\bigr]\n\\leq\n\\e^{-k/8} \\, .\n\n$$\nIn particular, for any $\\delta \\in (0,1)$, $k=\\lceil 8\\ln(1/\\delta) \\rceil$ and $m = k \\ell$,\n$$\n\n\\bigl|\\hat \\mu - \\mu \\bigr|\n\\leq \\sigma \\sqrt{\\frac{32\\, \\ln(1/\\delta)}{m}}\n\n$$\nwith probability at least $1-\\delta$.\n\nThis theorem can be proven using Chebyshev's inequality for the empirical means $S_{k,j}$ and Hoeffding's inequality for a binomial distribution to obtain the concentration of the median. We refer to Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for further details.\n\nFinally, it is often required to bound the probability that at least one of several events happens.\nFor a series of events $A_1, A_2, \\dots$ the union bound (Boole's inequality) guarantees that\n$$\n\\label{eq:union_bound}\n\\PP[A_1 \\ \\mathrm{or} \\ A_2 \\ \\mathrm{or}\\dots ]\n\\leq\n\\sum_i \\PP[A_i] \\, .\n\n$$\n\n### Expectation value estimation for observables\nNow we familiarize ourselves with the application of tail bounds for the derivation of sampling complexities and turn our attention to a very basic task in quantum mechanics:\nthe estimation of an expectation value of an observable.\n\nWe formulate a general quantum measurement in terms of a POVM.\nAn important special case of a POVM is a PVM where the effects are orthogonal projectors.\nA measurement described by a PVM is also called a von Neumann / projective measurement.\n\nAn observable quantity is modeled by a self-adjoint operator $A \\in \\Herm(\\H)$.\nA self-adjoint operator has an eigendecomposition $A = \\sum_{\\alpha = 1}^{n} a_\\alpha P_\\alpha$ with $a_\\alpha \\in \\mathbb R$ and\northogonal projectors $P_i$ onto the eigenspaces.\nThe set of outcomes associated to the measurements of $A$ is its real eigenvalue spectrum $\\spec(A) = \\{a_\\alpha\\}_{\\alpha \\in [n]}$ and\nthe measurement is described by the PVM that has the projectors $P_\\alpha$ as effects.\nThus, associated to an observable $A$ is the map from $\\DM(\\H)$ to random variables $\\rho \\mapsto  A_\\rho$ taking values in $\\spec(A)$ with\nprobability mass function $p_{{A}_\\rho}(a_\\alpha) = \\Tr[P_\\alpha \\rho]$.\nThis implies that the expectation value of an observable $A\\in \\Herm(\\H)$ in the state $\\rho$ is $\\langle A \\rangle_\\rho \\coloneqq \\EE[ A_\\rho] = \\Tr[\\rho A]$.\n\nGiven a quantum system in some state $\\rho\\in \\DM(\\H)$, we wish to estimate $\\langle A \\rangle_{\\rho}$; note that the expectation value itself cannot be observed directly but needs to be estimated from single measurements.\nOne protocol for estimating $\\langle A \\rangle_{\\rho}$\nis to perform the projective measurement of the observable multiple times and use the observed\nempirical mean as an estimator for $\\langle A \\rangle_\\rho$.\nLet $A^{(i)}_\\rho$ be the random variable describing the outcome of the $i$-th measurement of $A$ in state $\\rho$.\nThe empirical mean estimator of $m$ measurements is\n$$\n\\label{eq:EmpMean}\nY^{(m)} \\coloneqq \\frac 1m \\sum_{i=1}^m  A^{(i)}_\\rho\\, .\n\n$$\nIt is easy to see that $Y^{(m)}$ is an unbiased estimator for $\\langle A\\rangle_{\\rho}$.\nSo how many copies of $\\rho$ does this protocol consume in order to arrive at an $\\epsilon$-accurate estimate of $\\langle A \\rangle_\\rho$ with confidence $1 - \\delta$?\n\nIf the measurements are independent and the eigenvalue spectrum of $A$ is bounded then Hoeffding's inequality\u00a0(<ref>) yields a bound on the sampling complexity.\n\n[label=prop:EstimationExpectationVals]Estimation of observables\nLet $\\rho \\in \\DM(\\H)$ be a state and $A \\in \\Herm(\\H)$ an observable with $\\spec(A) \\in [a, b]$.\nChoose $\\epsilon > 0$ and $\\delta \\in (0,1)$.\nThe empirical mean estimator (<ref>) of the expectation value $\\langle A \\rangle_\\rho$ from\nmeasurements of $A$ on $m$ independent copies of $\\rho$ satisfies\n$$\n\n|Y^{(m)} - \\langle A \\rangle_\\rho| \\leq \\epsilon\n\n$$\nwith probability at least $1-\\delta$ for all\n$$\n\\label{eq:ObsEstSampComp}\nm \\geq m_0 = \\frac{(b-a)^2}{2\\epsilon^2} \\, \\ln \\frac2\\delta \\, .\n\n$$\n\nHaving $m$ independent state copies implies\nthat the measurement outcomes are independent random variables.\nWe choose $X_1, \\ldots, X_m$ as independent copies of the random variable $A_\\rho / m$.\nThen, the empirical mean estimator is described by a sum of $m$ independent random variables $Y^{(m)} = \\sum_{k = 1}^{m} X_k$\nwith bounded range $X_k \\in [a/m , b/m]$ for all $k$.\nHoeffding's inequality yields\n$$\n\n\\PP\\left[ \\left| Y^{(m)} - \\langle A \\rangle_\\rho\\right| \\geq \\epsilon\\right]\n\\leq\n2 \\exp\\myleft( - \\frac{2m\\epsilon^2}{(b-a)^2} \\myright)\n\n$$\nfor any $\\epsilon>0$.\nWe wish this probability to be small, i.e., we require that\n$$\n\n2 \\exp\\myleft( - \\frac{2m\\epsilon^2}{(b-a)^2} \\myright) \\leq \\delta\n\n$$\nand determine the critical value $m_0$ required for the estimation by solving the inequality for $m=m_0$, which yields (<ref>).\n\nProposition\u00a0<ref> guarantees that expectation values of bounded observables can be estimated with a measurement effort that is independent of the Hilbert space dimension.\nThe confidence $1-\\delta$ can be improved exponentially fast by increasing the measurement effort $m$.\n\nOne can define distance measures on $\\DM(\\H)$ in terms of expectation values of a set of observables.\nNaturally, the estimation protocol described in this section gives rise to an $\\epsilon$-certification test\nw.r.t. to such measures.\n\nFurther reading\n\nUsing the union bound, one can easily generalize Proposition\u00a0<ref> to derive the\nsampling complexity of estimating multiple observables.\nThe total number of sufficient state copies $\\rho$ to estimate $\\ell$ different observables then scales as $m_0 \\in \\LandauO\\myleft(\\frac{\\ell\\log(2\\ell /\\delta)}{\\epsilon^2}\\myright)$.\nIn this setting each observable is estimated from a different measurement setting.\nIn contrast, Shadow estimation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] provides a way to estimate multiple observables from a single measurement setting.\nFor certain types of observables, the shadow estimation has sampling complexity of\n$m_0\\in \\LandauO\\myleft(\\frac{\\ln(2\\ell/\\delta)}{\\epsilon^2}\\myright)$ [Unknown Author, \"Unknown Title\", ].\n\nWe further discuss shadow estimation techniques in the context of state certification in Section\u00a0<ref>.\n\n### Distance measures for quantum states\nIn our general definition of an $\\epsilon$-certification test, Definition\u00a0<ref>,\nrequires a distance measure on $\\DM(\\H)$.\nIn this section we introduce some `natural' measures on quantum states.\n\nTo this end, recall that for any operator $X \\in \\L(\\H,\\K)$ between two Hilbert spaces $\\H$ and $\\K$,\nthe operator $X^\\ad X$ is positive semidefinite, i.e., in $\\Pos(\\H)$ (see Section\u00a0<ref>).\nIn consequence, it has a positive semidefinite square root $\\left|X\\right| \\coloneqq \\sqrt{X^\\ad X} \\in \\Pos(\\H)$.\nAlso recall that any normal operator $X \\in \\L(\\H)$, i.e., any operator that commutes with its adjoint, $[X,X^\\ad] \\coloneqq X X^\\ad - X^\\ad X = 0$, can be written in spectral composition $X = \\sum_i x_i P_i$, where $x_i\\in \\CC$ are its eigenvalues and $P_j = P_j^2 \\in \\Pos(\\H)$ the corresponding spectral projectors. This decomposition can be used, for instance, to calculate $\\left|X\\right|$.\n\nThere are several useful norms of an operator $X \\in \\L(\\H,\\K)$.\nThe spectral norm (a.k.a. operator norm) $\\snorm{X} \\in \\RR_{+}$ of $X$ is defined to be the largest eigenvalue of $|X|$.\nThe trace norm is $\\tnorm{X} \\coloneqq \\Tr[|X|]$ and the Frobenius norm $\\fnorm{X} \\coloneqq \\sqrt{\\Tr[|X|^2]} = \\sqrt{\\Tr[X^\\ad X]}$.\nThese norms can be defined in several equivalent ways:\nthe spectral norm coincides with the norm induced by the $\\ell_2$-norm on $\\H$ via $\\snorm{X} = \\sup_{\\|v\\|_{\\ell_2} \\leq  1}  \\|Xv\\|_{\\ell_2}$, a manifestation of the Rayleigh principle.\nThe Frobenius norm is induced by the Hilbert-Schmidt inner product(<ref>).\nIt can also be expressed in terms of a matrix representation of $X$ as $\\fnorm{X} = \\sum_{i,j} |X_{ij}|^2$.\nFinally, all three norms are instances of the Schatten $p$-norms that are directly defined as $\\ell_p$-norms on the singular value spectrum.\nThe singular value spectrum $\\sigma(X)$ of $X$ is defined as the eigenvalue spectrum of $|X|$ and the $\\ell_p$-norms are given by $\\norm{x}_{\\ell_p} \\coloneqq \\left(\\sum_i |x_i|^p\\right)^{1/p}$.\nThis gives rise to the unitarily invariant Schatten $p$-norm $\\norm{X}_{p} \\coloneqq \\|\\sigma(X)\\|_{\\ell_p}$\nand $\\snorm{\\argdot}$, $\\tnorm{\\argdot}$,  and $\\fnorm{\\argdot}$ are the Schatten $p$-norms with $p = \\infty, 1, 2$, respectively.\n\nThe Euclidean inner product is bounded by $\\ell_p$-norms through the H\u00f6lder inequality: for all $x, y \\in \\CC^d$ and pairs $p, q \\in \\{1, 2, \\ldots, \\infty\\}$ with $p^{-1} + q^{-1} = 1$ (understanding $1/\\infty = 0$) it holds that\n$$\n\n|\\langle x, y\\rangle| \\leq \\|x\\|_{\\ell_p} \\|x\\|_{\\ell_q}.\n\n$$\nThe H\u00f6lder inequality generalizes the Cauchy-Schwarz inequality where $p= q = 2$.\nThe Schatten $p$-norms inherit a matrix H\u00f6lder inequality from the H\u00f6lder inequality:\nlet $X, Y \\in \\L(\\H, \\K)$ and $p, q$ as before, then\n$$\n\\label{eq:matrix_Hoelder}\n|\\langle X, Y\\rangle | \\leq \\tnorm{X^\\ad Y} \\leq \\|X\\|_p \\|Y\\|_q\\, .\n\n$$\nThe H\u00f6lder inequality directly follows from the von Neumann inequality\n$\\Tr[|A B|] \\leq \\langle \\sigma(A), \\sigma(B) \\rangle$ where the singular value spectra $\\sigma(A)$ and $\\sigma(B)$ are each in descending [Unknown Author, \"Unknown Title\", ].\nFurthermore, the Schatten $p$-norms inherit the ordering of the $\\ell_p$-norms, $\\|X\\|_\\infty \\leq \\ldots \\leq \\|X\\|_2 \\leq \\ldots \\leq\\|X\\|_1$ for all $X$.\nNorm bounds in reversed order will in general introduce dimensional factors. For low-rank matrices these bounds can be tightened.\nReversed norm bounds\nFor all $X \\in \\L(\\H, \\K)$ it holds that\n$$\n\n\\tnorm{X} \\leq \\sqrt{\\rank(X)} \\fnorm{X} \\leq \\rank(X) \\snorm{X}\\, .\n\n$$\n\nLet $X \\in \\L(\\H, \\K)$ and $r = \\rank(X)$.\nWe can always write $X = X P_r$ with $P_r$ a rank-$r$ projector onto the orthogonal complement of the kernel of $X$.\nNow by the matrix H\u00f6lder inequality (<ref>)  $\\tnorm{X} = \\tnorm{X P_r} \\leq \\fnorm{P_r} \\fnorm{X} = \\sqrt{r} \\fnorm{X}$.\nFor the second inequality, we use again the matrix H\u00f6lder inequality to obtain $\\left|\\Tr[X^\\ad X]\\right| \\leq \\tnorm{X^\\ad X} \\leq \\tnorm{P_r} \\snorm{X^\\ad X} = r \\snorm{X}^2$.\nTaking the square root we conclude that $\\fnorm{X} \\leq \\sqrt{r}\\snorm{X}$ from which the second inequality follows.\n\nA natural metric on quantum states is the trace-distance $\\dist_{\\Tr}: \\DM(\\H) \\times \\DM(\\H) \\to \\R_+$,\n$$\n\n\\dist_{\\Tr}(\\rhot, \\rhop) = \\frac12 \\tnorm{\\rhot - \\rhop}.\n\n$$\nWe have already seen that compared to the other Schatten $p$-norms the trace norm is the largest one, i.e., provides the most `pessimistic' distance measure.\nFurthermore, the trace norm has an operational interpretation in terms of the distinguishability of quantum states by\ndichotomic measurements.\n\n[label=prop:tnorm_operational]Operational interpretation of the trace distance\nLet $\\rho,\\sigma\\in \\DM(\\H)$.\nIt holds that\n$$\n\n\\dist_{\\Tr} (\\rho, \\sigma)\n=\n\\sup_{0 \\leq P \\leq \\1} \\Tr[P(\\rho-\\sigma)] \\, .\n\n$$\nFurthermore, the supremum is attained for the orthogonal projector $P^+$ onto the positive part of $\\rho-\\sigma$.\n\nFirst we show that the supremum is attained for $P^+$.\nThe self-adjoint operator difference can be decomposed as\n$$\n\n\\rho-\\sigma = X^+ - X^-\n\n$$\ninto a positive part $X^+ \\in \\Pos(\\H)$ and a negative part $X^- \\in \\Pos(\\H)$.\nWe note that $\\snorm{X^\\pm} \\leq 1$. Since $\\Tr[X^+ - X^-]= \\Tr[\\rho-\\sigma]= \\Tr[\\rho] - \\Tr[\\sigma] = 0$, we have\n$\\Tr[X^+] = \\Tr[X^-]$.\nMoreover, $\\tnorm{\\rho-\\sigma} = \\Tr[X^+] + \\Tr[X^-]$.\nThe last two statements together yield that the trace distance between the two states is\n$$\n\\label{eq:tr_dist_Xplus}\n\\frac 12 \\tnorm{\\rho-\\sigma}\n=\n\\Tr[X^+]\n=\n\\Tr[P^+ (\\rho-\\sigma)] \\, ,\n\n$$\nwhere $P^+$ is the orthogonal projector onto the support of $X^+$.\nIt can be calculated by means of the singular value decomposition of $\\rho - \\sigma = U \\Sigma V^\\ad$ as\n$P^+ = U_+ V_+^\\ad$ with $U_+$ and $V_+$ the matrices with singular left and right vectors, respectively, associated to the positive singular values as its columns.\n\nIn order to show that the supremum cannot become larger than the trace distance, we consider some operator $P$ with $0\\leq P\\leq \\1$.\nThen, indeed,\n$$\n\n\\begin{aligned}\n\\Tr[P (\\rho-\\sigma)]\n&=\n\\Tr[P X^+] - \\Tr[P X^-]\n% \\\\\n\\leq\n\\Tr[P X^+]\n\\\\\n&\\leq\n\\tnorm{X^+}\n= \\frac 12 \\tnorm{\\rho-\\sigma}\\, ,\n\\end{aligned}\n\n$$\nwhere we use the matrix H\u00f6lder inequality (<ref>) and (<ref>) in the last two steps.\n\nGiven two quantum states the optimal dichotomic POVM measurement $\\{P, \\1 - P\\}$ to distinguish\nthe two states is the POVM that maximizes the probability of measuring the outcome associated to $P$ in one state and minimizes the\nsame probability for the other state.\nOf course exchanging the role of $P$ and $\\1 - P$ works equivalently.\nWe can think of the achievable differences in probabilities as a measure for the distinguishability of $\\rho$ and $\\sigma$.\nProposition\u00a0<ref> shows that the trace distance of two states coincides with the maximal distinguishability by any dichotomic POVM measurements.\nThis distinguishability of a single shot measurement can be amplified by measuring multiple iid. copies of a quantum state with $\\{P, \\1-P\\}$.\nWe turn this insight into an $\\epsilon$-certification test for pure states in the next section.\n\nBefore we do this, let us introduce another important distance measure on quantum states.\nThe (squared) fidelity of two quantum states $\\rho,\\sigma\\in \\DM(\\H)$ is defined as\n$$\n\\label{eq:fidelity}\n\\fidelity(\\rho, \\sigma)\n\\coloneqq\n\\pnorm[1]{\\sqrt \\rho \\sqrt \\sigma}^2 \\, .\n\n$$\nNote that\n$$\n\\label{eq:sqrt_rho_sigma}\n\\pnorm[1]{\\sqrt \\rho \\sqrt \\sigma}\n=\n\\Tr\\Bigl[\\sqrt{\\sqrt{\\rho}\\, \\sigma\\sqrt{\\rho}}\\Bigr] \\, .\n\n$$\nWhile not any more directly evident from (<ref>),\nthe fidelity is symmetric\nas is apparent from (<ref>).\n\nSome authors define the fidelity as $\\pnorm[1]{\\sqrt \\rho \\sqrt \\sigma}$ without the square.\nFor this reason, one might want to refer to the expression of (<ref>) explicitly as the squared fidelity to avoid\nconfusion.\nFor brevity, we however call $\\fidelity$ simply the fidelity hereinafter.\n\nThe fidelity is more precisely not a measure of `distance' for two quantum states but of \u201ccloseness\u201d.\nIn particular, $\\fidelity(\\rho, \\rho) = 1$, which can be seen to be the maximal values of $\\fidelity(\\rho, \\sigma)$ for\nall $\\rho, \\sigma \\in \\DM(\\H)$.\nHence, $0 \\leq \\fidelity(\\rho, \\sigma) \\leq 1$ on $\\DM(\\H)$.\nOften it is convenient to work with the infidelity $1-\\fidelity(\\rho,\\sigma)$ as the complementary measure of `distance'.\n\nWhen at least one of the states $\\rho$ or $\\sigma$ is pure, say $\\rho = \\ketbra \\psi \\psi$ then\n$$\n\\label{eq:pure_state_fidelity}\n\\fidelity(\\rho,\\sigma)\n=\n\\sandwich \\psi \\sigma \\psi\n=\n\\Tr[\\rho \\sigma] = \\langle \\rho, \\sigma \\rangle\n\\, ,\n\n$$\nwhich can easily be proven using (<ref>).\nFurthermore, for both states being pure we have $\\fidelity(\\ketbra\\psi\\psi, \\ketbra\\phi\\phi) = |\\!\\braket\\psi\\phi\\!|^2$ for all $\\ketbra \\psi \\psi, \\ketbra\\phi\\phi \\in \\DM(\\H)$.\nThus, for pure states the fidelity is the overlap of the states and can be related to the angle between the state vectors.\nIn fact, we mostly encounter the case where at least one of the states is pure and mostly work with (<ref>) instead of (<ref>).\n\nThe fidelity is related to the trace distance as follows.\n\nFuchs-van-de-Graaf inequalities [Unknown Author, \"Unknown Title\", ]\nFor any states $\\rho, \\sigma\\in\\DM(\\H)$\n$$\n\\label{eq:Fuchs-van-de-Graaf}\n1-\\sqrt{\\fidelity(\\rho, \\sigma)}\n\\leq\n\\frac 12 \\pnorm[1]{\\rho-\\sigma}\n\\leq\n\\sqrt{1-\\fidelity(\\rho, \\sigma)} \\, .\n\n$$\n\nSince the Fuchs-van-de-Graaf inequalities are not explicitly dependent on the Hilbert-space dimension\none can regard the trace-distance and fidelity as equivalent measures of quality in many applications.\nNote however that the square root on the right-hand side can still make a painstaking difference in practice.\nAiming at a trace-norm distance of $10^{-3}$ can in the worst-case require to ensure\nan infidelity of $10^{-6}$.\nThis can be a crucial difference when it comes to the practical feasibility of certification.\nImportantly, the square-root scaling is unavoidable for\npure states.\n[label=ex:fvdg_purestates]Fuchs-van-de-Graaf inequality for pure states\nThe upper bound of the Fuchs-van-de-Graaf inequality for pure states\n$\\ketbra\\psi\\psi, \\ketbra\\phi\\phi \\in \\DM(\\H)$ is tight.\nTo show this proof that the following equality holds for\n$p=1$\n$$\n\\label{eq:pnorm_rank1}\n\\pnorm{\\ketbra \\psi \\psi - \\ketbra \\phi \\phi}\n=\n2^{1/p}\\sqrt{1 - \\left|\\braket\\psi\\phi\\right|^2} \\, .\n\n$$\nFurthermore, show that the equality actually holds for all Schatten-$p$-norms $p \\in \\{1, 2, \\ldots, \\infty\\}$.\nFuchs-van-de-Graaf inequality for pure states[label=ex:fvdg_purestates]Fuchs-van-de-Graaf inequality for pure states\nThe upper bound of the Fuchs-van-de-Graaf inequality for pure states\n$\\ketbra\\psi\\psi, \\ketbra\\phi\\phi \\in \\DM(\\H)$ is tight and\n$$\n\\ifex\\else\\label{eq:pnorm_rank1}\\fi\n\\pnorm{\\ketbra \\psi \\psi - \\ketbra \\phi \\phi}\n=\n2^{1/p}\\sqrt{1 - \\left|\\braket\\psi\\phi\\right|^2}\n\n$$\nholds for all $p$.\n\nDenote $X\\coloneqq \\ketbra \\psi \\psi - \\ketbra \\phi \\phi$.\nWe have $\\Tr[X]= 0$ and $\\rank(X) \\in \\{0,2\\}$.\nHence, $X$ has two eigenvalues $\\lambda>0$ and $-\\lambda<0$.\nThis implies that $\\lambda^2 = \\fnorm{X}^2/2 = 1 - 1\\left|\\braket\\psi\\phi\\right|^2$, as directly follows by writing $\\fnorm{X}^2$ as a Hilbert-Schmidt inner product.\nFrom the eigenvalues one can calculate $\\pnorm{X}$ as Schatten $p$-norm, which yields the result.\n\nIn\nExercise\nLemma\n<ref>,\nwe showed that the upper bound of (<ref>) is tight for pure states.\nConversely, one might hope for more mixed states to arrive at an improved scaling closer to the lower bound of Eq. (<ref>).\nWe will review such a bound in the analogous discussion of distance measures of quantum channels,\nTheorem\u00a0<ref> in Section\u00a0<ref>.\n\nIn the next section, we present protocols that aim\nat directly providing an $\\epsilon$-certification test for certain states.\nSection\u00a0<ref> and <ref> present\ntwo protocols that aim at estimating the fidelity:\ndirect fidelity estimation and shadow fidelity estimation.\n\n### Direct quantum state certification\nIn this section, we present approaches to certification protocols for quantum states that are direct in that\nthey do not use a protocol designed for another task, such as an estimation protocol, as a subroutine.\nOur exposition largely follows the work by Pallister et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nWe start with perhaps the most direct attempt building on the insight of Proposition\u00a0<ref>.\nThis proposition illustrates the interpretation of the trace distance as the maximal distinguishability\nby a dichotomic POVM and shows that the optimal POVM in this regard is given by the projection onto the positive part of\nthe state difference.\nThis indicates that the best way to distinguish a pure quantum state from all other states\nis to measures the POVM that has the state itself as an element.\n\nWe now turn this insight into an $\\epsilon$-certification test.\nIt can be most easily formulated in terms of the infidelity $1-\\fidelity$ as the distance measure.\n\nGiven a pure target state $\\rhot = \\ketbra\\psi\\psi$ with a state vector $\\ket\\psi \\in \\CC^d$,\nwe consider the POVM $\\{\\Omega, \\1 - \\Omega\\}$ given by $\\Omega = \\ketbra\\psi\\psi$.\nWe call the outcome corresponding to $\\Omega$  and the one of $\\1-\\Omega$ .\nThen, for any $\\rhop\\in \\DM(\\CC^d)$ we have\n$$\n\n\\Pr[\\pass] = \\Tr[\\Omega \\rhop] = \\fidelity(\\rhot,\\rhop) \\, ,\n\n$$\ni.e., the probability of the POVM returning $\\pass$ is the fidelity of the two states.\nThis gives us a simple protocol that measures the POVM on a single state copy and accepts when the result is $\\pass$ and rejects otherwise.\nThis protocol is complete but not sound in the sense of Definition\u00a0<ref> as the probability of an acceptance is fixed to be $1-\\fidelity(\\rhot,\\rhop)$, i.e., the probability of a false acceptance in not constantly bounded away from one.\nBut using more state copies we can boost the probability to detect deviations of the form $\\fidelity(\\rhot,\\rhop)< 1- \\epsilon$ with some targeted confidence $1-\\delta$.\n\nIn order to be able to capture a class of large measurement settings we first formulate the protocol\nfor an arbitrary dichotomic POVM measurements.\n\n[label=protocol:QSC_unconstrained]Naive direct quantum state certification\nLet $\\rhot \\in \\DM(\\CC^d)$ be a pure target state and $\\Omega\\in \\Pos(\\CC^d)$ with $\\snorm{\\Omega}\\leq 1$.\nDenote by $\\{\\Omega, \\1-\\Omega\\}$ the binary POVM given by $\\Omega$,\ncall the outcome corresponding to $\\Omega$  and the one of $\\1-\\Omega$ .\n\nFor state preparations $\\rhop_1, \\dots, \\rhop_{\\np}\\in \\DM(\\CC^d)$ the protocol consists of the following steps.\n[1]\n$i \\in [\\np]$ measure $\\{\\Omega, \\1-\\Omega\\}$ on $\\rhop_i$\nthe outcome is :\noutput  and end protocol\noutput\n\nAs stated, this protocol is adaptive in that it can end early in case of a rejection instance.\nHowever, one could easily turn into a non-adaptive protocol without changing the number of measurements in the performance guarantee below.\n\nFor a pure state $\\rho$ and measurement $\\Omega = \\rho$ the protocol is a certification protocol w.r.t. the infidelity as more precisely summarized by the following proposition.\n\n[label=prop:QSCsimple_guarantee]Performance guarantee I\nLet $\\rhot\\in \\DM(\\CC^d)$ be a pure target state and choose $\\epsilon, \\delta>0$.\nProtocol\u00a0<ref> with $\\Omega = \\rhot$ is an $\\epsilon$-certification test w.r.t. the infidelity from $\\np$ independent samples for\n$$\n\\label{eq:prop:np}\n\\np \\geq  \\frac{\\ln(1/\\delta)}{\\epsilon}\n\n$$\nwith confidence at least $1-\\delta$.\nMoreover, the protocol accepts the target state $\\rhot$ with probability\u00a0$1$.\n\nThe probability of the measurement outcome  in step $i\\in [\\np]$ is\n$$\n\n\\PP[{\\pass}|\\rhop_i]\n=\n\\Tr[\\Omega \\rhop_i]\n=\n\\Tr[\\rhot\\rhop_i]\n=\n\\fidelity(\\rhot, \\rhop_i) \\, .\n\n$$\nHence, the final probability that the protocol accepts is\n$$\n\n\\PP[\\accept]\n=\n\\prod_{i=1}^\\np \\fidelity(\\rhot, \\rhop_i) \\, .\n\n$$\n\nClearly, if $\\rhop_i = \\rhot$ for all $i \\in [\\np]$ then the protocol accepts almost surely.\nNow let us consider the case that the fidelity is small, i.e.,\n$$\n\n\\fidelity(\\rhot,\\rhop_i)\n=\n\\sandwich\\psi{\\rhop_i}\\psi \\leq 1-\\epsilon  \\qquad \\forall i \\in [\\np].\n\n$$\nThen the probability that the protocol wrongfully accepts is\n$$\n\n\\PP[\\accept]\n\\leq\n(1-\\epsilon)^\\np \\, .\n\n$$\nNow we wish this probability (type-II error) be bounded by $\\delta>0$, i.e.,\n$$\n\\label{eq:QSC_simple_bound_delta}\n(1-\\epsilon)^\\np \\leq \\delta \\, .\n\n$$\nThis bound on the type-II error satisfied for\n$$\n\\label{eq:np}\n\\np \\geq \\frac{\\ln\\left(\\frac 1\\delta\\right)}{\\ln\\left( \\frac 1{1-\\epsilon} \\right)} \\, .\n\n$$\nWe note that for $\\epsilon \\in [0,a] \\subset [0,1)$ the following bounds hold\n$$\n\\label{eq:lnfrac_epsilon_bound}\n\\epsilon\n\\leq\n\\ln\\left( \\frac 1{1-\\epsilon} \\right)\n\\leq\n\\ln\\left( \\frac 1{1-a} \\right) \\frac{\\epsilon}{a} \\, ,\n\n$$\nwhich can be seen by using the fact that $\\epsilon \\mapsto \\ln\\left( \\frac 1{1-\\epsilon} \\right)$ is smooth, has value $0$ at $0$, its first derivative is lower bounded by $1$, and its second derivative is positive.\nHence, for any $\\np \\geq  \\frac{\\ln(1/\\delta)}{\\epsilon}$ the required bound (<ref>) is satisfied.\n\nAs a remark, the minimum number of samples in Eq. (<ref>) scales as\n$$\n\n\\frac{\\ln\\left(\\frac 1\\delta\\right)}{\\ln\\left( \\frac 1{1-\\epsilon} \\right)} = \\frac{\\ln(1/\\delta)}{\\epsilon} + \\LandauO(1/\\epsilon^2) \\, ,\n\n$$\nso that (<ref>) captures the leading scaling of (<ref>), see also the bounds (<ref>).\n\nPerhaps surprisingly, the sample complexity (<ref>) of this direct certification protocol does not depend on the physical system size at all.\nIt has a zero type\u00a0I error and one can control the type\u00a0II error via the parameter $\\delta$.\nHowever, for many target states it is not practical to directly implement the required POVM.\nThis motivates the following more complicated strategies.\nSay, we have access to a set of POVM elements\n$$\n\\label{eq:mset_subset}\n\\mset \\subset \\{\\mop \\in \\Pos(\\CC^d): \\ \\snorm{\\mop} \\leq 1 \\}\\, .\n\n$$\nThese encode the measurements that are experimentally feasible.\nAs one can only make finitely many measurements, we assume that $|\\mset|< \\infty$.\nThen for each state preparation we pick a POVM element $M \\in \\mset$ with some probability and consider the corresponding dichotomic POVM\n$\\{M, \\1-M\\}$, where $M$ has output  and $\\1-M$ has output .\nWe refer to a set $\\mset$ of the form (<ref>) together with a probability mass $\\mu: \\mset \\to [0,1]$, $\\sum_{M \\in \\mset} \\mu(M) = 1$,\nas a probabilistic measurement strategy.\nNow we modify Protocol\u00a0<ref> by including a probabilistic measurement strategy.\n\n[label=protocol:QSC]Direct state certification\nLet $\\rhot \\in \\DM(\\CC^d)$ be a pure target state and $(\\mset, \\mu)$ be a probabilistic measurement strategy.\nFor state preparations $\\rhop_1, \\dots, \\rhop_{\\np}\\in \\DM(\\CC^d)$ the protocol consists of the following steps.\n[1]\n$i \\in [\\np]$ Draw $M$ from $\\mset$ according to $\\mu$.\nMeasure the POVM $\\{M, \\1-M\\}$ on $\\rhop_i$.\nthe outcome is :\noutput  and end protocol.\noutput\n\nLet us assume that the prepared states are iid. copies of a state $\\rhop$.\nThen\nthe overall probability of measuring  is\n$$\n\\label{eq:indirect_measurement_Omega}\n\\PP[{\\pass}] = \\sum_{M\\in \\mset} \\mu(M) \\Tr[M \\rhop] = \\Tr[\\Omega \\rhop],\n\n$$\nwhere\n$$\n\\label{eq:Omega}\n\\Omega\\coloneqq \\sum_{M \\in \\mset} \\mu(M) M\n\n$$\nis the so-called effective measurement operator.\nBelow, we see that it plays a similar role as the measurement operator $\\Omega$ in Protocol\u00a0<ref> when it comes to proving performance guarantees.\nAt the same time, it allows capturing more sophisticated measurement strategies.\n\nHowever, there is one constraint that allows for a simple analysis of Protocol\u00a0<ref>: we require that\n$$\n\\label{eq:OmegaRhoEqOne}\n\\Tr[\\Omega\\rhot]=1 \\, ,\n\n$$\ni.e., that there is no false reject of the target state $\\rho$ with probability one.\nIn particular, it requires that $\\Tr[M\\rhot]=1$ for all $M \\in \\mset$.\nThis constraint still allows for optimal measurement strategies, which is guaranteed by the following.\n\n[Unknown Author, \"Unknown Title\", ]\nLet $\\rhot=\\ketbra\\psi\\psi$ be a target state.\nLet $0\\leq \\Omega'\\leq \\1$ be an effective measurement operator (<ref>) with $\\Tr[\\Omega'\\rhot]<1$ so that Protocol\u00a0<ref> is an $\\epsilon$-certification test w.r.t. infidelity from $\\np'$ iid. samples.\nThen there exists an effective measurement operator $0\\leq \\Omega\\leq \\1$ with $\\Tr[\\Omega\\rhot]=1$ so that Protocol\u00a0<ref> is an $\\epsilon$-certification test w.r.t. infidelity from $\\np$ iid. samples so that $\\np \\leq \\np'$ holds for sufficiently small $\\epsilon$.\n\nThe proof of this statement is a consequence of the Chernoff-Stein lemma from information theory, which quantifies the asymptotic distinguishability of two distributions in terms of their relative entropy.\n\nSince the constraint (<ref>) implies that there is no false rejection the only remaining hypothesis testing error is a false acceptance, which is the event where a state $\\rhop$ with $\\fidelity(\\rhot,\\rhop)< 1-\\epsilon$ is accepted.\nThis event has a worst-case probability over all states $\\rhop$ in the rejection region that given by the optimization\n$$\n\\label{eq:false_pass}\n\\PP[\\pass\\mid \\text{``$\\epsilon$-worst case''}]\n=\n\\max_{\\substack{\\rhop\\in \\DM(\\CC^d):\\\\ \\,\\Tr[\\rhot\\rhop]\\leq 1-\\epsilon}} \\Tr[\\Omega\\rhop] \\, .\n\n$$\nIn the following lemma we see that this maximum is determined by the spectral gap\n$$\n\\label{eq:SpectralGap}\n\\nu(\\Omega) \\coloneqq \\lambda_1(\\Omega) - \\lambda_2(\\Omega) \\, ,\n\n$$\nof the effective measurement operator $\\Omega$,\nwhere $\\lambda_1(\\Omega) \\geq \\lambda_2(\\Omega) \\geq \\ldots \\geq \\lambda_d(\\Omega)$ are the eigenvalues of $\\Omega$ in descending order.\n\n[label=lem:QSC-single_measurement_worst_case,fonttitle=][Unknown Author, \"Unknown Title\", ], [Unknown Author, \"Unknown Title\", ]\n\nLet $\\rhot\\in \\DM(\\CC^d)$ be a pure state, $0\\leq \\Omega \\leq \\1$, $\\Tr[\\rhot\\Omega]=1$, and $\\epsilon>0$.\nThen\n$$\n\\label{eq:worst_case_rhop}\n\\max_{\\substack{\\rhop\\in \\DM(\\CC^d):\\\\ \\,\\Tr[\\rhot\\rhop]\\leq 1-\\epsilon}} \\Tr[\\Omega\\rhop]\n=\n1 - \\nu(\\Omega)\\epsilon \\, .\n\n$$\n\nWe note that $\\Tr[\\rhot\\Omega] = 1$ means that a state vector $\\ket \\psi$ with $\\rhot = \\ketbra\\psi\\psi$ is an eigenvalue-$1$ eigenvector of $\\Omega$.\nMoreover, let us write $\\Omega$ in spectral decomposition,\n$$\n\n\\Omega = \\sum_{j=1}^d \\lambda_j P_j\n\n$$\nwith $1 = \\lambda_1 \\geq \\lambda_2\\geq \\dots\\geq \\lambda_d$ and $P_1 = \\rhot$.\nFor the case $\\lambda_2 = 1$ the choice $\\rhop = P_2$ yields a maximum of $1$ in the maximization (<ref>).\nLet us now consider the case $\\lambda_2<1$.\nThen for\n$$\n\n\\rhop = (1-\\epsilon)\\rhot + \\epsilon P_2\n\n$$\nwe have\n$$\n\n\\begin{aligned}\n\\Tr[\\Omega\\rhop] &= 1-\\epsilon \\Tr[\\Omega\\rhot] + \\epsilon \\Tr[\\Omega P_2]\\\\\n&=\n1-\\epsilon + \\epsilon \\lambda_2\n=\n1-(1-\\lambda_2)\\epsilon \\, ,\n\\end{aligned}\n\n$$\ni.e.,\nthe claimed maximum in (<ref>) is attained for some feasible $\\sigma$.\n\nTo show that the claimed maximum is actually the maximum we consider some state $\\rhop\\in \\DM(\\CC^d)$ with $\\Tr[\\rhot\\rhop]\\leq 1-\\epsilon$.\nWe write $\\rhop$ as convex combination $\\rhop = (1-\\epsilon') \\rhot + \\epsilon'\\rhot^\\perp$ and observe that $\\epsilon'\\geq \\epsilon$.\nThen\n$$\n\n\\begin{aligned}\n\\Tr[\\Omega\\rhop]\n&=\n\\Tr[\\rhot\\rhop] + \\sum_{j=2}^d \\lambda_j \\Tr[P_j \\rhop]\n\\\\\n&\\leq\n\\Tr[\\rhot\\rhop] + \\lambda_2 \\sum_{j=2}^d \\Tr[P_j \\rhop]\n\\\\\n&=\n1-\\epsilon' + \\lambda_2 \\epsilon' \\Tr\\Bigl[ \\sum_{j=2}^d P_j \\rhot^\\perp\\Bigr]\n\\\\\n&=\n1-\\epsilon' + \\lambda_2 \\epsilon' \\Tr[\\rhot^\\perp]\n\\\\\n&=\n1-\\epsilon' + \\lambda_2 \\epsilon'\n= 1-(1-\\lambda_2)\\epsilon'\n\\\\\n&\\leq 1 - (1-\\lambda_2)\\epsilon \\, .\n\\end{aligned}\n\n$$\n\nGiven a measurement strategy with effective measurement operator $\\Omega$ this lemma provides a closed formula for the false acceptance probability (<ref>).\nThis allows us to state the following guarantee for Protocol\u00a0<ref>.\n\n[label=prop:QSC_guarantee,fonttitle=]Performance guarantee II [Unknown Author, \"Unknown Title\", ]\nLet $\\rhot\\in \\DM(\\CC^d)$ be a pure target state and $\\epsilon,\\delta>0$.\nWe consider an effective measurement operator (<ref>) satisfying $0\\leq \\Omega \\leq 1$ and $\\Tr[\\Omega\\rhot] = 1$ and having a spectral gap (<ref>) bounded as $\\nu(\\Omega)>0$.\n\nThen the certification test from Protocol\u00a0<ref>\nis an $\\epsilon$-certification test w.r.t. the infidelity from $\\np$ independent samples for\n$$\n\\label{eq:SampCompDSC}\n\\np \\geq  \\frac{\\ln(1/\\delta)}{\\nu(\\Omega)\\, \\epsilon}\n\n$$\nwith confidence at least $1-\\delta$.\nMoreover, the protocol accepts the target state $\\rhot$ with probability\u00a0$1$.\n\nCompared to the sample complexity (<ref>) of the naive Protocol\u00a0<ref>, the sample complexity (<ref>) has an overhead of a factor $1/\\nu(\\Omega)$,\n\nThe proof is mostly analogous to the one of Proposition\u00a0<ref>.\n\nThanks to Lemma\u00a0<ref>, the probability of wrongfully accepting a state $\\rhop\\in \\DM(\\CC^d)$ with $\\fidelity(\\rhot,\\rhop_i)\\leq 1-\\epsilon$ is bounded as\n$$\n\\label{eq:prob:pass}\n\\PP[\\pass|\\rhop_i] \\leq 1 - \\nu(\\Omega)\\epsilon \\, .\n\n$$\nHence, the probability that Protocol\u00a0<ref> accepts is bounded as\n$$\n\n\\PP[\\accept] \\leq \\left(1 - \\nu(\\Omega)\\epsilon\\right)^\\np \\, .\n\n$$\nImposing $\\left(1 - \\nu(\\Omega)\\epsilon\\right)^\\np \\leq \\delta$ and solving for $\\np$ yields\n$$\n\n\\np \\geq \\frac{\\ln(1/\\delta)}{\\ln\\!\\left( \\frac{1}{1-\\nu(\\Omega)\\epsilon} \\right)}\n\n$$\nand the bound (<ref>) finishes the proof.\n\nThis proposition tells us that as long as $\\Omega$ has a constant gap between its largest and second largest eigenvalue the sample complexity of the certification protocol has the same scaling as the one where $\\Omega$ is the target state itself.\nNow it depends on the physical situation of what feasible measurement strategies $\\Omega$ are.\nGiven a set $\\mset$ of feasible measurements we can single out an optimal strategy as follows.\n\n[label=def:minimax_QSC]Minimax optimization\nLet $\\rhot$ be a pure state and $\\epsilon>0$.\nMoreover, let us assume that we have access to a compact set of binary measurements given by the operators\n$\\mset \\subset \\{ P: \\ 0 \\leq P \\leq \\1\\, ,\\  \\Tr[P\\rhot]=1\\}$.\n\nThen the best strategy $\\Omega$ for the worst-case state preparation $\\rhop$ is\n$$\n\\label{eq:cert_minimax}\n\\min_{\\Omega \\in \\conv(\\mset)} \\max_{\\rhop: \\,\\Tr[\\rhot\\rhop]\\leq 1-\\epsilon} \\Tr[\\Omega\\rhop] \\, ,\n\n$$\nwhere $\\conv(S)$ denotes the convex hull of a set $S$, i.e., the set of all convex combinations of elements in $S$.\nThis quantity\nis called minimax value and a strategy $\\Omega$ where the minimum is attained is called minimax optimal.\n\nSuch minimax optimizations are common in game theory and risk analysis.\n\nIf there are no restrictions on the measurements of a pure target state $\\rhot$, i.e.,\n$\\mset = \\{ P: \\ 0 \\leq P \\leq \\1 \\, , \\ \\Tr[P\\rhot]=1\\}$,\nthen $\\Omega = \\rhot$ is minimax optimal.\n\nFor a number of settings with physically motivated measurement restrictions the minimax strategy, or at least one that is close to it, has been found.\nFor instance for stabilizer states, which are ubiquitous in quantum information theory, there are such optimal measurement strategies.\nIn the following we introduce stabilizer states and, for two-outcome Pauli measurements, we derive a minimax optimal certification protocol for them.\n\n#### Stabilizer states\nNow we consider the certification of stabilizer target states by using a particularly suitable measurement strategy in the direct certification Protocol\u00a0<ref>.\n\nLet us start with a few preliminaries on stabilizer states.\nAn $n$-qubit Pauli string is $\\sigma_{s_1} \\otimes \\dots \\otimes \\sigma_{s_n}$, where $s \\in \\{0,1,2,3\\}^n$ and $\\{\\sigma_i\\}$ are the Pauli matrices\n$$\n\\label{eq:def:PauliMatrices}\n\\begin{aligned}\n\\sigma_x &\\coloneqq \\sigma_1 \\coloneqq\n\\begin{pmatrix} 0&1\\\\1&0 \\end{pmatrix},\n&\n\\sigma_y &\\coloneqq \\sigma_2 \\coloneqq\n\\begin{pmatrix} 0&-\\i\\\\\\i&0 \\end{pmatrix},\n\\\\\n\\sigma_z &\\coloneqq \\sigma_3 \\coloneqq\n\\begin{pmatrix} 1&0\\\\0&-1 \\end{pmatrix},\n&\n\\sigma_0 &\\coloneqq \\1_{2\\times 2} \\, .\n\\end{aligned}\n\n$$\nThen the Pauli group $\\mcP_n\\subset \\U(2^n)$ is the group generated by all $n$-qubit Pauli strings and $\\i \\1$.\nAn $n$-qubit state $\\ket \\psi$ is a stabilizer state if there is an Abelian subgroup $\\mc S \\subset \\mcP_n$, called stabilizer (subgroup), that stabilizes $\\ket\\psi$ and only $\\ket\\psi$, i.e., $\\ket\\psi$ is the unique joint eigenvalue-$1$ eigenstate of all elements in that subgroup.\nSuch subgroups are generated by $n$ elements and contain $|\\mc S| = 2^n$ elements in total.\nNote that they cannot contain the element $-\\1$.\n\nAn example of such a subgroup is the one of all Pauli strings made of $\\1$'s and $\\sigma_z$'s.\n\nIt is not difficult to show that a general $n$-qubit stabilizer state $\\rho$ with stabilizer $\\mc S$ is explicitly given as\n$$\n\\label{eq:STAB_as_sum}\n\\rho\n=\n\\prod_{j=1}^n \\tfrac 12 (\\1 + G_j)\n=\n\\frac{1}{2^n}\\sum_{S \\in \\mc S} S \\, ,\n\n$$\nwhere $\\{G_j\\}_{j\\in [n]}$ is a set of generators of $\\mc S$.\n\nThe measurement strategy for our direct certification of stabilizer states essentially consists in measuring stabilizer observables that are drawn uniformly at random from the stabilizer group of the target state.\nWe accept exactly when the measurement outcome corresponds to the stabilized eigenspaces of eigenvalue $+1$.\nThis strategy is minimax optimal (Definition <ref>) among all strategies based on measuring Pauli observables, i.e. two-outcome Pauli measurements.\n\n[label=thm:QST:stabilizer]Minimax optimal $2$-outcome Pauli measurements for STABs [Unknown Author, \"Unknown Title\", ]\nLet $\\ket\\psi$ we an $n$-qubit stabilizer state with stabilizer group $\\mc S \\subset \\mc P_n$ with elements\n$\\mc S = \\{\\1 = S_0, S_1, \\dots, S_{2^n-1}\\}$.\nFor $i \\in [2^n-1]$ denote by\n$P_i \\coloneqq \\frac 12\\left( \\1 + S_i \\right)$\nthe projector onto the positive eigenspace of $S_i$.\n\nThen the minimax optimal measurement strategy for having Pauli observables $\\mc P_n$ as accessible measurements (see Definition\u00a0<ref>)\nis given by measuring $S_i$ with probability $\\frac{1}{2^n-1}$.\nThe resulting effective measurement operator $\\Omega = \\frac{1}{2^n-1} \\sum_{i=1}^{2^n-1} P_i$ satisfies\n$\\Omega\\ket\\psi=\\ket\\psi$ and has the second largest eigenvalue\n$$\n\n\\lambda_2(\\Omega) = \\frac{2^{n-1}-1}{2^n-1}\\, .\n\n$$\n\nBy Lemma\u00a0<ref>, the minimax optimum is\n$$\n\n\\begin{aligned}\n\\min_{\\Omega\\in \\mc X}\n\\max_{\\rhop: \\,\\Tr[\\rhot\\rhop]\\leq 1-\\epsilon} \\Tr[\\Omega\\rhop]\n&=\n\\min_{\\Omega \\in \\mc X} \\left( 1-\\nu(\\Omega) \\epsilon \\right)\n\\\\\n&=\n1- \\epsilon \\, \\max_{\\Omega \\in \\mc X}  \\nu(\\Omega)  \\, ,\n\\end{aligned}\n\n$$\nwhere\n$$\n\n\\begin{aligned}\n\\mc X &\\coloneqq \\{\\Omega \\in \\conv(\\mc P_n):\\ \\Omega\\ket\\psi = \\ket\\psi\\}\n% \t\\\\\n= \\conv(\\mc S)\\, .\n\\end{aligned}\n\n$$\nWe argue that the minimization over $\\conv(\\mc S)$ can be replaced by a minimization over $\\conv(\\mc S')$ with $\\mc S'\\coloneqq \\mc S \\setminus\\{\\1\\}$.\nTo see this,\nobserve that if $\\Omega = (1-\\alpha) \\Omega' + \\alpha \\1$ for $\\alpha \\in [0,1]$ then $\\nu(\\Omega)\\leq \\nu(\\Omega')$.\nThen minimax optimal measurement strategies are hence of the form\n$$\n\\label{eq:Omega:opt_strategy_form}\n\\Omega = \\sum_{i=1}^{2^n-1} \\mu_j P_i\n\n$$\nfor a probability vector $\\mu$.\nWe note that\n$$\n\n\\Tr[\\Omega] = 2^{n-1}\n\n$$\nsince $\\Tr[P_i] = 2^{n-1}$.\n\nNext, since $\\ket\\psi$ is an eigenvalue-$1$ eigenvector of $\\Omega$, we can write\n$$\n\n\\Omega = 1\\oplus \\tilde \\Omega\n\n$$\nwith\n$$\n\n\\lambda_2(\\Omega) = \\snormb{\\tilde \\Omega}.\n\n$$\nMoreover, $\\Tr[\\tilde\\Omega] = 2^{n-1}-1$.\nThe operator $\\tilde\\Omega$ with the minimal norm $\\snormb{\\tilde \\Omega}$ under this constraint is of the form $\\tilde \\Omega = a \\1$ for $a>0$.\nTaking the trace of that equality, solving for $a$ and denoting the orthogonal projector of $\\ketbra\\psi\\psi$ by\n$\\ketbra\\psi\\psi^\\perp\\coloneqq \\1-\\ketbra\\psi\\psi$\nyields\n$$\n\\label{eq:Omega_suggestion}\n\\Omega = \\ketbra\\psi\\psi + \\frac{2^{n-1}-1}{2^n-1} \\, \\ketbra\\psi\\psi^\\perp\n\n$$\nwith\n$$\n\n\\lambda_2(\\Omega)\n=\n\\frac{2^{n-1}-1}{2^n-1}\n\\, .\n\n$$\nIn order to finish the proof we show that $\\Omega\\in \\conv(\\mc S)$, i.e., that this choice of $\\Omega$ is indeed compatible with (<ref>).\n\nWe write the stabilizer state $\\ketbra\\psi\\psi$ as combination of the stabilizers (see\u00a0(<ref>)) and use that $S_j = 2P_j-\\1$,\n$$\n\n\\begin{aligned}\n\\ketbra\\psi\\psi\n&= \\frac{1}{2^n}\\left( \\1 + \\sum_{j=1}^{2^n-1} S_j \\right)\n\\\\\n&=\n\\frac{1}{2^n}\\left( \\1 + 2 \\sum_{j=1}^{2^n-1} P_j - (2^n-1) \\1 \\right)\n\\\\\n&= \\left( \\frac{1}{2^{n-1}}-1 \\right) \\1 + \\frac{1}{2^{n-1}} \\sum_{j=1}^{2^n-1} P_j \\, .\n\\end{aligned}\n\n$$\nWith $\\1 = \\ketbra\\psi\\psi + \\ketbra\\psi\\psi^\\perp$ this implies that\n$$\n\n\\begin{aligned}\n\\sum_{j=1}^{2^n-1} P_j\n&=\n(2^n-1)\\ketbra\\psi\\psi + (2^{n-1}-1) \\ketbra\\psi\\psi^\\perp\n\\end{aligned}\n\n$$\nand, hence,\n$$\n\n\\begin{aligned}\n\\frac{1}{2^n-1} \\sum_{j=1}^{2^n-1} P_j\n&=\n\\ketbra\\psi\\psi + \\frac{2^{n-1}-1}{2^n-1} \\ketbra\\psi\\psi^\\perp \\, ,\n\\end{aligned}\n\n$$\nwhich is the $\\Omega$ from (<ref>) and also the measurement strategy from the theorem statement.\nSampling complexity [Unknown Author, \"Unknown Title\", ]\nLet us call the outcome corresponding to $P_i$  and the one corresponding to $1-P_i$ .\nThen Protocol\u00a0<ref> is an $\\epsilon$-certification test of $\\rhot$ w.r.t. infidelity from $\\np$ independent samples for\n$$\n\n\\np \\geq 2\\, \\frac {\\ln(1/\\delta)}{\\epsilon}\n\n$$\nwith confidence $1-\\delta$.\nMoreover, $\\rhot$ is accepted with probability $1$.\n\nAccording to Proposition\u00a0<ref> a number of measurements\n$$\n\n\\np \\geq  \\frac{\\ln(1/\\delta)}{\\epsilon\\, \\nu(\\Omega)}\n\n$$\nis sufficient, where\n$$\n\n\\begin{aligned}\n\\nu(\\Omega) &= 1-\\lambda_2(\\Omega)\n\\\\\n&=\n1 -\\frac{2^{n-1}-1}{2^n-1}\n\\\\\n&=\n\\frac{2^{n-1}}{2^n-1} \\, .\n\\end{aligned}\n\n$$\nThis results in\n$$\n\n\\np \\geq \\frac{2^n-1}{2^{n-1}} \\frac{\\ln(1/\\delta)}{\\epsilon} \\, .\n\n$$\n\nSo, restricting from all measurements to Pauli measurements results in at most a constant overhead of $2$, cmp. Proposition\u00a0<ref>.\nWe note that only very few of the $2^n-1$ non-trivial stabilizers of $\\rhot$ are actually measured.\nMore precisely, the measurements are the ones of randomly subsampled stabilizer observables.\n\n#### Extension towards fidelity estimation\nDirect certification provides minimum information to solve the certification task by  just giving an accept/reject answer.\nOften it is also desirable to actually know explicitly what the distance or fidelity of a quantum state implementation $\\rhop$ to its target $\\rhot$ is.\n\nThe direct quantum state certification protocol\u00a0(<ref>) with effective measurement operator $\\Omega$ (see (<ref>)) can be turned into a estimation protocol for the fidelity $\\fidelity(\\rhop,\\rhot)$ if $\\Omega$ is homogeneous, i.e. of the form\n$$\n%\\label{eq:Omega_suggestion}\n\\Omega = \\ketbra\\psi\\psi + \\tau \\, \\ketbra\\psi\\psi^\\perp\n\n$$\nfor some $\\tau>0$ [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ];\nfor instance, for stabilizer states (<ref>) we have $\\tau = \\frac{2^{n-1} - 1}{2^n-1}$.\nIn this case, we have\n$$\n\n\\Tr[\\rhop\\,\\Omega] = \\fidelity(\\rhop,\\rhot) + \\tau (\\Tr[\\rhop] - \\fidelity(\\rhop,\\rhot))\n\n$$\nand, hence,\n$$\n\n\\fidelity(\\rhop,\\rhot)\n=\n\\frac{\\Tr[\\rhop\\,\\Omega] - \\tau}{1-\\tau}\n=\n\\frac{\\Tr[\\rhop\\,\\Omega] - \\lambda_2(\\Omega)}{\\nu(\\Omega)} \\, .\n\n$$\nTherefore, an estimate on the expectation value of $\\Omega$ yields an estimate of the fidelity $\\fidelity(\\rhop,\\rhot)$.\n\nWe note that the number of measurements required for estimating the expectation value up to an additive error $\\varepsilon$ scales as $1/\\varepsilon^2$.\nWe also remember that in the case where we can measure $\\Omega$ as observable the estimation task can be solved with a number of measurements $m\\geq  \\frac{1}{2\\varepsilon^2}\\ln(2/\\delta)$ with confidence $1-\\delta$, see Proposition\u00a0<ref>.\nHowever, in Protocol <ref> we only assume access to measurements\n$M\\in \\mset$ that on some average give the expectation value of $\\Omega$.\nIn general, the number of measurements $\\left|\\mset\\right|$ can be exponentially large, as is the case for stabilizer states, cp. Theorem\u00a0<ref>.\nHere, one could use ides of Monte Carlo estimation and importance sampling in order to perform this estimation efficiently; a method that we introduce in Section\u00a0<ref>.\nSubsequently, we discuss DFE, which relies on this idea.\n\nFurther reading\n\nThe direct certification of maximally entangled states was studied by Hayashi et al.\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nBuilding on these earlier works and the discussed framework of Pallister et al. [Unknown Author, \"Unknown Title\", ], direct certification protocols were then developed for other classes of quantum states featuring a (close to) optimal sampling complexity.\nThey include the following settings:\n\n*  Stabilizer states and two-qubit states with single-qubit measurements [Unknown Author, \"Unknown Title\", ].\n\n*  Bipartite states [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], qubit case in an LOCC setting [Unknown Author, \"Unknown Title\", ].\n\n*  Hypergraph states [Unknown Author, \"Unknown Title\", ] with improvements in efficiency by Zhu and Hayashi [Unknown Author, \"Unknown Title\", ] and a generalization to weighted graph states [Unknown Author, \"Unknown Title\", ].\n\n*  Dicke states [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n*  A general adversarial scenario without the assumptions of the state preparations being identical and independent [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nProtocols for the efficient verification of graph states, which are certain stabilizer states, were developed in the context of measurement-only blind quantum computation [Unknown Author, \"Unknown Title\", ] and interactive proof systems [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nEfficient certification protocols for ground states of locally interacting Hamiltonians were developed by Cramer et al. [Unknown Author, \"Unknown Title\", ]\nand extended by Hangleiter et al. [Unknown Author, \"Unknown Title\", ] to ground states enabling universal quantum computation.\nIn this line of research, fidelity witnesses [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] can be used to  estimate fidelity lower bounds from simple measurements.\nAlso in the context of interactive proof systems efficient ground state certification schemes have been developed [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nKalev et al.\u00a0[Unknown Author, \"Unknown Title\", ] have extended arguments from direct fidelity estimation [Unknown Author, \"Unknown Title\", ] (see Section\u00a0<ref>) and ground state certification [Unknown Author, \"Unknown Title\", ] to the certification of stabilizer states.\nThey also use Bernstein's inequality to give a quadratically improved $\\epsilon$-scaling for large $\\epsilon$.\n\nThe work [Unknown Author, \"Unknown Title\", ] solves the certification problem by efficiently reconstructing the state\nassuming it to be of matrix product form.\nSimilar ideas based on ansatz state tomography also work for permutationally invariant states\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nTakeuchi and Morimae [Unknown Author, \"Unknown Title\", ] provide efficient results on the certification of ground states of locally interacting Hamiltonians, and hypergraph states, where the iid. assumptions on the state preparations is removed using a quantum de Finetti theorem [Unknown Author, \"Unknown Title\", ].\nHypergraph states include quantum states that are generated by so-called IQP circuits designed for demonstrating quantum supremacy [Unknown Author, \"Unknown Title\", ].\n\nGlobal von Neumann measurements on multiple iid. copies of the prepared quantum state have been considered [Unknown Author, \"Unknown Title\", ] (even with mixed target states),\nwhich leads to a sample complexity scaling as $\\np \\in \\LandauO(d/\\epsilon)$ a version of $\\epsilon$-certification of quantum states in $\\DM(\\CC^d)$.\n\nFor a very helpful survey on quantum property testing we refer to Ref.\u00a0[Unknown Author, \"Unknown Title\", ], where several methods and notions of certification are reviewed.\n\n### Importance sampling\nIn the next section, we study DFE, where the fidelity between a target state and a state preparation is estimated from measurements that are drawn randomly from a certain distribution depending on the target state.\nThe idea is to perform the measurements more often that are particularly relevant to the fidelity estimation.\n\nThis idea is formalized by a Monte Carlo integration technique called importance sampling.\nMonte Carlo integration aims at computing an integral $F$ that is written as an expected value\nof some function $f$\nover a probability distribution with density function $p$:\n$$\n\\label{eq:EE_of_f}\nF \\coloneqq \\EE_{X \\sim p} [f(X)] = \\int f(x) p(x) \\, \\rmd x \\, .\n\n$$\nThe general idea is to draw iid. samples $X^{(1)}, \\dots, X^{(m)} \\sim p$ and take the empirical average\n$$\n\\label{eq:MCintegration}\n\\hat F \\coloneqq\n\\frac 1m \\sum_{i=1}^m f(X^{(i)})\n\n$$\nas estimator for $F$.\nIt is not difficult to see that $\\hat F$ is unbiased.\nIf $\\Var[f(X)] < \\infty$ then $\\hat F$ can be proven to be consistent, i.e., $\\hat F$ converges to $F$ for $m \\to \\infty$ in an appropriate sense.\nMoreover,\n$$\n\\label{eq:Variance_of_sum}\n\\Var[\\hat F] = \\frac{\\Var[f(X)]}m \\, .\n\n$$\nThereby the empirical variance also gives an estimate of the estimation error.\nThe estimation error can be controlled by increasing the number of samples $m$.\n\nNow, the integration (<ref>) relies on the ability to sample from $p$.\nA popular way to make such sampling efficient is importance sampling.\nThe main idea of importance sampling is to rewrite the integrand $f\\, p$ in the expectation value (<ref>) as\n$$\n\nf p = \\frac{fp}qq\n\n$$\nfor some probability distribution with density function $q$.\nThen we can apply the Monte Carlo sampling idea (<ref>) w.r.t. $q$ and draw $X^{(1)}, \\dots, X^{(m)} \\sim q$ iid. to obtain the estimator\n$$\n\n\\hat F_q\n\\coloneqq\n\\frac 1m \\sum_{i=1}^m f(X^{(i)}) \\frac{p(X^{(i)})}{q(X^{(i)})} \\, .\n\n$$\nIt holds that $\\EE_q[\\hat F_q] = F$ and\n$$\n\n\\Var_q[\\hat F_q] = \\frac 1m \\, \\Var_q[fp/q]\n=\n\\frac 1m \\left[\\int \\frac{f^2 p^2}{q} - F^2 \\right] .\n\n$$\n\nOne can show that the minimal variance\nis achieved by choosing $q$ as\n$$\n\nq^\\ast \\coloneqq \\frac{p\\, |f|}{Z}\n\n$$\nwith a normalization factor $Z$ such that $q^\\ast$ is a probability density.\nNote that for $f\\geq 0$ we have\n$\\EE_{q^\\ast}[(f p /q^\\ast)^2] = \\EE_p[f]^2= \\EE_{q^\\ast}[f p /q^\\ast]^2$ and, thus,\n$\\Var_{q^\\ast}[\\hat F_{q^\\ast}] = 0$.\nSo, if $f$ does not change its sign then a single sample from $q^\\ast$ is sufficient for the exact estimation.\nThis might seem miraculous at first sight.\nBut its is important to notice that in order to determine the optimal $q^\\ast$\none needs to know the value of normalization $Z$ and\ncalculating $Z$ is equivalent to solving the integration problem.\nHowever, finding non-optimal but good choices for $q$ can already speed up the integration, as we will see in the case of direct fidelity estimation.\n\n### Direct fidelity estimation\nWe assume to be given access to state preparations $\\rhop\\in \\DM(\\CC^d)$ of some target state $\\rhot\\in\\DM(\\CC^d)$.\nDFE [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] is a protocol to estimate the fidelity $\\Tr[\\rhop\\rhot]$ for the case where the $\\rhot$ is a pure state, i.e. of the form $\\rhot = \\ketbra \\psi\\psi$.\nIn order to do so, the target states is expanded into products of Pauli matrices\n(<ref>) of the form\n$\\sigma_{s_1} \\otimes \\dots \\otimes \\sigma_{s_n}$\nwith $s_i\\in \\{0,\\dots, 4\\}$ and $d= 2^n$ being the Hilbert space dimension.\nFor sake of readability we denote these Pauli products by $\\W_1, \\dots, \\W_{d^2}$ in some order and note that they are an orthogonal basis for the space of Hermitian operators $\\Herm(\\CC^d)$ w.r.t. the Hilbert-Schmidt inner product (<ref>):\n$$\n\\label{eq:W_orthogonal}\n\\frac 1 d \\Tr[\\W_k \\W_{k'}] = \\delta_{k,k'}\n\n$$\nfor all $k,k'\\in[d^2]$.\n\nGiven any operator $\\sigma\\in \\Herm\\myleft(\\CC^d\\myright)$ we define its\ncharacteristic function (or quasi-probability distribution) $\\W_\\sigma: [d^2] \\to \\RR$ by\n$$\n\\label{eq:dfe:charFunc}\n\\chi_\\sigma(k)\n\\coloneqq\n\\Tr\\Bigl[\\sigma \\frac{W_k}{\\sqrt d} \\Bigr] \\, .\n\n$$\nThanks to the orthogonality relation (<ref>) we have\n$$\n\n\\sigma = \\sum_{k=1}^{d^2} \\chi_\\sigma(k) \\frac{W_k}{\\sqrt d}\n\n$$\nand hence\n$$\n\\label{eq:rhosigmaFrameExpansion}\n\\begin{aligned}\n\\Tr[ \\rho \\sigma ]\n&=\n\\sum_{k=1}^{d^2}  \\chi_\\rho(k) \\chi_\\sigma(k)\n\\end{aligned}\n\n$$\nfor any $\\rho,\\sigma\\in\\Herm(\\CC^d)$.\n\nNow, we use importance sampling (Section\u00a0<ref>) to estimate the sum\u00a0(<ref>) for a pure target state $\\rhot\\in \\DM(\\CC^d)$ and its preparation $\\rhop\\in \\DM(\\CC^d)$.\nFor this purpose we rewrite the overlap (<ref>) as\n$$\n\n\\Tr[ \\rhot \\rhop ]\n=\n\\sum_{k=1}^{d^2}\n\\frac{\\chi_\\rhop(k)}{\\chi_\\rhot(k)}\\chi_\\rhot(k)^2\n% \\, ,\n\n$$\nand define\n$$\n\\label{eq:def:q}\nq_k \\coloneqq \\chi_\\rhot(k)^2 \\, .\n\n$$\nWe choose $q$ as the probability mass function of the importance sampling distribution on the sampling space $[d^2]$.\nThe purity of $\\rhot$ can be written as\n$$\n\n\\Tr[\\rhot^2]\n=\n\\sum_{k=1}^{d^2} \\Bigl|\\Bigl\\langle \\frac{\\W_k}{\\sqrt d}, \\rhot\\Bigr\\rangle\\Bigr|^2\n=\n\\sum_{k=1}^{d^2}  \\chi_\\rhot(k)^2\n\n$$\nand equals $1$ for any pure state $\\rhot$.\nThus, $q$ is indeed a normalized probability vector.\n\nWe define a random variable\n$$\n\\label{eq:Xlambda}\nX_k \\coloneqq \\frac{\\chi_\\rhop(k)}{\\chi_\\rhot(k)}\n\n$$\nwith $k \\sim q$ and find that $X_k$ is an unbiased estimator of the fidelity:\n$$\n\\label{eq:XunbiasedEstimator}\n\\EE_{k \\sim q} [X_k]\n=\n\\sum_{k=1}^{d^2} \\frac{\\chi_\\rhop(k)}{\\chi_\\rhot(k)} q_k\n=\n\\sum_{k=1}^{d^2} \\chi_\\rhot(k) \\chi_\\rhop(k)\n=\n\\Tr[\\rhot \\rhop]\\, ,\n\n$$\nwhere the last identity is again (<ref>).\n\nIn order to estimate the random variable $X_k$, we need to know the value of the characteristic function $\\chi_{\\tilde \\rho}(k)$.\nBy definition (<ref>), $\\chi_{\\tilde \\rho}(k)$ can be estimated as the expectation value\nfrom repeated measurements of the observable $W_k$ in the prepared state $\\tilde \\rho$.\nThus, we end up with an estimation procedure of $\\Tr[\\rhot \\rhop]$ that involves two sources of randomness and correspondingly\nproceeds in two steps.\n(i) We classically sample $k$ from $[d^2]$ according to the importance sampling distribution (<ref>) defined by the target state $\\rhot$.\n(ii) For the randomly drawn $k$, we estimate $X_k$ from repeated probabilistic measurements of $W_k$.\nCombining the estimates of the $X_k$ we arrive at an estimate for $\\Tr[\\rhot \\rhop]$.\n\nThe following protocol summarizes these steps.\n[label=protocol:DFE]DFE [Unknown Author, \"Unknown Title\", ]\nLet $\\rhot \\in \\DM(\\CC^d)$ be a pure target state and\n$\\{\\W_k\\}$ a set of observables $\\{\\W_k\\}$.\nLet $\\epsilon>0$ and $\\delta>0$ be the parameters for the desired estimation accuracy and maximum failure probability.\n\nThe protocol consists of the following steps requiring $n_\\rhop$ state preparations in total:\n[(i)]\n\n*\nDraw iid. samples $k_1, \\dots, k_\\ell \\sim q$ from the importance sampling distribution (<ref>), where $\\ell \\coloneqq \\left\\lceil \\frac{1}{\\epsilon^2\\delta}\\right\\rceil$\n(or as (<ref>) for well-conditioned states).\n\n*\nMeasure each observable $\\W_{k_i}$ a number of $m_i$ times for $i \\in [\\ell]$ with $m_i$ chosen as\n$$\n\\label{eq:mi_choice}\nm_i \\coloneqq\n\\left\\lceil \\frac{ 2 }{d \\chi_\\rhot(k_i)^2 \\ell \\epsilon^2} \\ln(2/\\delta)  \\right\\rceil\n\n$$\n(or as $m_i= 1$ for well-conditioned states).\n\n*\nFor each $i \\in [\\ell]$ calculate empirical estimate of the expectation value $\\langle \\W_{k_i}\\rangle_{\\rhop}$ from the\nmeasurement outcomes.\nFrom these estimates calculate the empricial estimator $\\hat X_{k_i}$ of $X_{k_i} \\coloneqq \\frac{\\chi_\\rhop(k_i)}{\\chi_\\rhot(k_i)} =\\frac{\\langle \\W_{k_i}\\rangle_{\\rhot}}{\\sqrt{d}\\,  \\chi_\\rho(k_i)}$.\n\n*\nCalculate $\\hat Y \\coloneqq \\frac 1\\ell \\sum_{i=1}^\\ell \\hat X_{k_i}$.\n\n*  Output $\\hat Y$ as a fidelity estimator.\n\nTo derive a guarantee for DFE we have to control the error made\nin the two estimation steps.\nTo this end, we consider the steps in reversed order:\nwe consider $Y \\coloneqq \\frac 1\\ell \\sum_{i=1}^\\ell X_{k_i}$ with $\\ell$ iid. samples $k_i\\sim q$\nassuming perfect estimates $X_{k_i}$ for the moment.\nThe accuracy of $Y$ as an estimator of $\\Tr[\\rhot\\rhop]$ can be controlled by increasing $\\ell$.\nSubsequently, we have to analyze the accuracy of the estimator $\\hat Y$ of $Y$ that uses the finitely many measurement outcomes.\nAltogether we arrive at the following guarantee:\n\n[label=thm:DFE]Guarantee for DFE [Unknown Author, \"Unknown Title\", ]\nLet $\\rhot\\in \\DM(\\CC^d)$ be a pure target state.\nThe number of expected state preparations in Protocol\u00a0<ref> is\n$$\n\\label{eq:DFEsampleComplexity}\n\\EE[n_\\rhop] = \\EE\\, \\sum_{i=1}^\\ell m_i\n\\leq\n1 + \\frac{1}{\\epsilon^2 \\delta} + \\frac{ 2\\, d }{\\epsilon^2 } \\ln(2/\\delta) \\, .\n\n$$\nIf the state preparations are iid. given by $\\rhop\\in \\DM(\\CC^d)$\nthen the fidelity estimate $\\hat Y$ is an $2\\epsilon$-accurate unbiased estimator of $\\fidelity(\\rhot,\\rhop)$ with confidence $1-2\\delta$.\n\nNote that the sample complexity scales linearly in the Hilbert space dimension.\nIn contrast, the number of Pauli measurements required for state tomography scales as $\\tLandauOmega(d^2\\rank(\\rhop)^2)$ [Unknown Author, \"Unknown Title\", ].\n\nWe start with bounding the estimation error arising by taking the empirical average in step\u00a0(<ref>) of Protocol\u00a0<ref>.\nWe note that $X_k$ defined in(<ref>) is an unbounded random variable in general, as\n$\\chi_\\rhot(k)$ can be arbitrarily small.\nHence, we will use Chebyshev's inequality\u00a0(<ref>) to derive a tail bound for $Y$.\nUsing the definitions (<ref>) and (<ref>) of $q$ and $X$ and that $X$ is the unbiased estimator (<ref>),\nthe variance of $X$ becomes\n$$\n\n\\begin{aligned}\n\\Var_{k \\sim q} [ X_k ]\n&=\n\\EE_{k \\sim q}[ X_k^2 ] - \\Tr[\\rho\\sigma]^2\n\\\\\n&= \\sum_{k=1}^{d^2}  \\frac{\\chi_\\rhop(k)^2}{\\chi_\\rhot(k)^2} \\chi_\\rhot(k)^2\n-\n\\Tr[\\rho\\sigma]^2\n\\\\\n&= \\chi_\\rhop(k)^2\n-\n\\Tr[\\rho\\sigma]^2\n\\\\\n&=\n\\Tr[\\rhop^2]-\\Tr[\\rhot \\rhop]^2 \\, .\n\\end{aligned}\n\n$$\nHence,\n$$\n\n\\Var_{k \\sim q} [ X_k ]\n\\leq\n\\Tr[\\rhop^2]\n\\leq\n1 \\, .\n\n$$\nUsing the basic insight of Monte Carlo estimation (<ref>),\nwe obtain\n$$\n\n\\Var_q[Y] = \\EE_q[(Y -\\Tr[\\rhot\\rhop])^2] \\leq 1/\\ell \\, .\n\n$$\nAs $Y$ is an unbiased estimator of $\\Tr[\\rhot\\rhop]$, i.e.,\n$\\EE_q[Y -\\Tr[\\rhot\\rhop]]=0$, we can directly apply Chebyshev's inequality (<ref>) to arrive at\n$$\n\\label{eq:appCheb}\n\\PP\\myleft[\\bigl|Y - \\Tr[\\rhot\\rhop]\\bigr|\\geq \\epsilon \\myright]\n\\leq\n\\frac{1}{\\epsilon^2\\ell}\n\n$$\nfor any $\\epsilon>0$.\nHence, for any $\\delta>0$ and\n$$\n\\label{eq:ell_bound}\n\\ell \\geq \\frac1 {\\epsilon^2 \\delta}\n\n$$\nthe failure probability is bounded by $\\delta$,\n$$\n\\label{eq:Ytail}\n\\PP\\myleft[\\myleft|Y - \\Tr[\\rhot\\rhop]\\myright|\\geq \\epsilon\\myright] \\leq \\delta\\, .\n\n$$\n\nNow we bound the statistical error that arises from the estimation of $X_{k_i}$ from the measurement setup $i\\in [\\ell]$ in step\u00a0(<ref>) of Protocol\u00a0<ref>.\nFor this purpose we write for each $k$ the eigendecomposition of $\\W_k$ as\n$$\n\\label{eq:MlambdaEig}\n\\W_k = \\sum_\\alpha a_{k,\\alpha} P_{k,\\alpha}\n\n$$\nwith $\\{P_{k,\\alpha}\\}$ being the projector onto the eigenspaces and\n$\\{a_{k,\\alpha}\\} \\subseteq \\{-1,1\\}$\nthe eigenvalues of the Pauli string $\\W_k$.\nWe note that the expected measurement outcome is\n$$\n\n\\EE[a_{k,\\alpha}] = \\Tr[\\W_k \\rhop] = \\sqrt d\\,  \\chi_\\rhop(k) \\, .\n\n$$\nWe denote by $a_{k_j, \\alpha_j}$ the measurement outcome for measurement $j\\in[m_i]$\nand consider the following corresponding empirical estimate of $X_{k_i}$\n(see (<ref>))\n$$\n\n\\hat X_{k_i}\n\\coloneqq\n\\frac{1}{m_i \\sqrt d \\chi_\\rhot(k_i)} \\sum_{j=1}^{m_i} a_{k_i, \\alpha_j} \\, .\n\n$$\nThen we consider the sum\n$$\n\n\\begin{aligned}\n\\ell \\hat Y\n&=\n\\sum_{i=1}^\\ell \\hat X_{k_i}\n\\\\\n&=\n\\sum_{i=1}^\\ell \\sum_{j=1}^{m_i}\n\\frac{1}{ m_i \\sqrt d\\,  \\chi_\\rhot(k_i)}\na_{k_i, \\alpha_j} \\,  .\n\\end{aligned}\n\n$$\nAs $\\EE[\\ell \\hat Y] = \\ell Y$, using Hoeffding's inequality (<ref>) on the double sum with\n$t = \\epsilon \\ell$ and bounds\n$$\n\nb_{i} = -a_{i}\n= \\frac{1}{m_i \\sqrt d\\, \\chi_\\rhot(k_i)}   \\, ,\n\n$$\nwe find that\n(w.l.o.g. we assume that there are no $i$ with $\\chi_\\rhot(k_i)=0$)\n$$\n\\label{eq:hatY_Y_tail_bound_explicit}\n\\begin{aligned}\n\\PP[ |\\hat Y -Y| \\geq \\epsilon ] &= \\PP[ |\\ell \\hat Y -\\ell Y| \\geq \\ell \\epsilon ]\n\\\\\n&\\leq\n2 \\exp\\left(\n\\frac{- 2\\epsilon^2 \\ell^2 }{\\sum_{i=1}^\\ell \\sum_{j=1}^{m_i}\n\\frac{ 2^2 }{ m_i^2 d\\,  \\chi_\\rhot(k_i)^2 }}\n\\right)\n\\\\\n&=\n2 \\exp\\left(\n\\frac{- \\epsilon^2 \\ell^2 }{\\sum_{i=1}^\\ell\n\\frac{ 2 }{ m_i d\\,  \\chi_\\rhot(k_i)^2 }}\n\\right)\n\\end{aligned}\n\n$$\nWe wish that the tail bound\n$$\n\\label{eq:hatYtail}\n\\PP\\myleft[\\bigl| \\hat Y - Y \\bigr| \\geq \\epsilon \\myright] \\leq \\delta\n\n$$\nholds.\nTherefore, we impose the right-hand-side of (<ref>) to be bounded\nby $\\delta$, which is equivalent to\n$$\n\\label{eq:mi_cond}\n\\ln(2/\\delta)\n\\leq\n\\frac{ \\epsilon^2 \\ell^2 }{\\sum_{i=1}^\\ell\n\\frac{ 2 }{ m_i d\\, \\chi_\\rhot(k_i)^2 }} \\, .\n\n$$\nThe choice of $m_i$ as in (<ref>) guarantees that this bound it always satisfied and, thus, (<ref>) holds.\nThen combination of the tails bounds (<ref>) and (<ref>) with the union bound (<ref>) proves the confidence statement,\n$$\n\\label{eq:DFE_final_confidence}\n\\PP[|\\hat Y - \\fidelity(\\rhot,\\rhop)| \\leq 2\\epsilon]\n\\geq 1 - 2\\delta \\, .\n\n$$\n\nIn order to obtain the final sample complexity\u00a0(<ref>) note that $m_i$ is a random variable itself, since $k_i$ and hence $\\chi_{\\rhot}(k_i)$ is randomly chosen.\nBy the definition of the sampling (<ref>), for fixed $i$ we have\n$$\n\n\\begin{aligned}\n\\EE[m_i] &= \\sum_{k_i=1}^{d^2} m_i q_{k_i}\n\\\\\n&\\leq\n1+ \\frac{ 2 d }{\\ell \\epsilon^2 } \\ln(2/\\delta)   \\, ,\n\\end{aligned}\n\n$$\nwhere the $+1$ comes from the ceiling in (<ref>).\nUsing the bound (<ref>) on $\\ell$, the expected total number of measurements is\n$$\n\n\\EE\\, \\sum_{i=1}^\\ell m_i\n\\leq\n1 + \\frac{1}{\\epsilon^2 \\delta} + \\frac{ 2d }{ \\epsilon^2 } \\ln(2/\\delta) \\, .\n\n$$\n\nWe remark that DFE estimation can be extended to sets of observables that are arbitrary orthonormal bases of $\\Herm(\\CC^d)$.\nHowever, in this case the operator norm used to bound the eigenvalues $a_{k,\\alpha}$ and hence the sampling complexity can be larger.\nOne can generalize DFE further to frames that include over-complete bases, see Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe main contribution to the number of measurements in the derivation of the sample complexity above can be traced back to the application of Chebyshev's inequality in (<ref>).\nThis step can, however, be improved for the following class of states.\n\nWell-conditioned states\nWe call an operator $\\rho \\in \\Herm(\\CC^d)$ well-conditioned with parameter $\\alpha>0$ if for each $k\\in [d^2]$\neither $\\left|\\Tr[\\W_k \\rho]\\right|\\geq \\alpha$ or $\\Tr[\\W_k\\rho] = 0$.\n\nA prominent example for well-conditioned states are stabilizer states (<ref>).\nIt is easy to show that every stabilizer state $\\rhot$ on $n$ qubits with stabilizer $\\mc S$, (<ref>), is well-conditioned with parameter $\\alpha=1$:\n$$\n\n\\begin{aligned}\n\\Tr[\\W_k \\rhot]\n&=\n\\frac 1 d \\sum_{S \\in \\mc S} \\Tr[\\W_k S] \\in \\{-1,0,1\\}\\, ,\n\\end{aligned}\n\n$$\nwhere the sum evaluates to $1$ if $\\W_k \\in \\mc S$, to $-1$ if $-\\W_k \\in \\mc S$ and to $0$ otherwise.\nFor such well-conditioned states the sample complexity can be improved as follows.\n\n[label=thm:DFE_well-cond,fonttitle=]DFE, well-conditioned states [Unknown Author, \"Unknown Title\", ]\nLet $\\rhot\\in \\DM(\\CC^d)$ be a pure target state that is well-conditioned with parameter $\\alpha>0$.\nConsider the estimator $\\hat Y$ from Protocol\u00a0<ref> modified by setting $m_i=1$ for all $i \\in [\\ell]$ in step\u00a0(<ref>) and\n$$\n\\label{eq:sample_complexity_DFE_wc}\n\\ell \\coloneqq \\left\\lceil \\frac{2}{\\alpha^2\\epsilon^2} \\, \\ln(2/\\delta) \\right\\rceil\n\n$$\nin step\u00a0(<ref>).\nIf the state preparations are iid. given by $\\rhop\\in \\DM(\\CC^d)$\nthen the fidelity estimate $\\hat Y$ is an $\\epsilon$-accurate unbiased estimator of $\\fidelity(\\rhot,\\rhop)$ with confidence $1-\\delta$.\n\nWith probability $1$ we have $\\sqrt d \\chi_\\rhot(k_i) \\geq \\alpha$ for all $i\\in [\\ell]$.\nMoreover, $|\\sqrt d \\hat \\chi_\\rhop(k_i)| \\leq 1$.\nThe estimator from step\u00a0(<ref>) of Protocol\u00a0<ref> is hence bounded as\n$$\n\n|X_{k_i}| \\leq \\frac{1}{\\alpha}\n\n$$\nwith probability $1$.\nThe estimator $\\hat Y$ is, thus, bounded as $|\\hat Y| \\leq \\frac{ 1 }{\\alpha}$ almost surely.\nHoeffding's inequality\u00a0(<ref>) with $t=\\epsilon \\ell$ yields\n$$\n\\label{eq:appHoeff_wc}\n\\PP\\myleft[\\bigl|\\hat Y - \\Tr[\\rhot\\rhop]\\bigr|\\geq \\epsilon \\myright]\n\\leq\n2\\, \\exp\\myleft( - \\frac{\\ell\\, \\alpha^2 \\epsilon^2 }{2} \\myright) .\n\n$$\nImposing\n$$\n\n2\\, \\exp\\myleft( - \\frac{\\ell\\, \\alpha^2 \\epsilon^2 }{2} \\myright) \\leq \\delta\n\n$$\nand solving for $\\ell$ yields that\n$$\n\\label{eq:DFE_final_confidence_well_cond}\n\\PP[|\\hat Y - \\fidelity(\\rhot,\\rhop)| \\leq \\epsilon]\n\\geq 1 - \\delta\n\n$$\nfor $\\ell$ chosen as in Eq.\u00a0(<ref>).\n\nTheorem\u00a0<ref> tells us that\nfor well-conditioned states DFE has a sampling complexity independent of the system size.\nRef.\u00a0[Unknown Author, \"Unknown Title\", ] also investigates the idea of removing \u201cbad events\u201d which are those that violate the well-conditioning condition.\nMoreover, a two-step estimation procedure as in Theorem\u00a0<ref> is considered also for well-conditioned states.\n\nFinally, we look at how to turn DFE into a certification protocol with respect to the trace distance.\n\nThe details are worked out in the following exercise.\n[label=ex:estimation_to_certification]Certification w.r.t. the trace distance via DFE\nFix parameters $\\tilde \\epsilon, \\epsilon,\\delta>0$ with $\\tilde \\epsilon \\leq \\frac 12 \\epsilon^2$.\nLet $\\hat Y$ be the direct fidelity estimator of the fidelity $\\fidelity(\\rho,\\sigma)$ so that\n$|\\hat Y -\\fidelity(\\rho,\\sigma)|\\leq \\tilde \\epsilon$ with confidence $1-\\delta$.\nWe consider the protocol that accepts if\n$\\hat Y \\geq 1 - \\tilde \\epsilon$ and\nrejects otherwise.\nWe choose the trace distance\n$\\dist_{\\Tr}(\\rho,\\sigma) \\coloneqq \\frac 12 \\tnorm{\\rho-\\sigma}$ as the distance measure.\n\n*  Show that this protocol is an $\\epsilon$-certification test w.r.t. the trace distance in the sense of Exercise\u00a0<ref>, i.e., that the completeness and soundness conditions are satisfied with confidence $1-\\delta$.\n\n*  What is the resulting sampling complexity of DFE fore well-conditioned states?\n\n*  Let $\\epsilon'<\\epsilon$.\nTurn this protocol into a robust $(\\epsilon,\\epsilon')$-certification test, i.e., into an $\\epsilon$-certification test that is guaranteed to accept all states within an $\\epsilon'$-trace norm ball around $\\rhot$ with confidence $1-\\delta$.\n\nWe summarize the result in the following proposition.\nCertification w.r.t. the trace distance via DFE[label=ex:estimation_to_certification]Certification w.r.t. the trace distance via DFE\nFix parameters $\\tilde \\epsilon, \\epsilon,\\delta>0$ with $\\tilde \\epsilon \\leq \\frac 12 \\epsilon^2$.\nLet $\\hat Y$ be the direct fidelity estimator of the fidelity $\\fidelity(\\rho,\\sigma)$ so that\n$|\\hat Y -\\fidelity(\\rho,\\sigma)|\\leq \\tilde \\epsilon$ with confidence $1-\\delta$.\nWe consider the protocol that accepts if\n$\\hat Y \\geq 1 - \\tilde \\epsilon$ and\nrejects otherwise.\nWe choose the trace distance\n$\\dist_{\\Tr}(\\rho,\\sigma) \\coloneqq \\frac 12 \\tnorm{\\rho-\\sigma}$ as the distance measure.\n\n*  This protocol is an $\\epsilon$-certification test w.r.t. the trace distance in the sense of Proposition\u00a0<ref>, i.e., the completeness and soundness conditions are satisfied with confidence $1-\\delta$.\n\n*  The resulting sampling complexity of DFE for well conditioned states scales as $1/\\epsilon^4$.\n\n*  Let $\\epsilon'<\\epsilon$.\nThis protocol can be turned into a robust $(\\epsilon,\\epsilon')$-certification test, i.e., into an $\\epsilon$-certification test that is guaranteed to accept all states within an $\\epsilon'$-trace norm ball around $\\rhot$ with confidence $1-\\delta$.\n\nThe proof follows from Definition\u00a0<ref> by direct calculations.\nWe leave filling in the details as an exercise.\n\n### Random states and unitaries\nRandom ensembles of quantum states and unitary matrices find ubiquitous applications in quantum information processing and,\nin particular, in certification and estimation protocols.\nRoughly speaking, random unitary operations together with a fixed quantum measurement allow information about the entire state space to be gained quickly.\nArguably the simplest probability distribution on the unitary group $\\U(d)$ is given by the Haar measure $\\mu_{\\U(d)}$.\nIn general, for a compact Lie group the Haar measure is the unique left and right invariant probability measure, which generalizes the notion of a uniform measure.\nIn applications one is often interested in random variables that are polynomials in matrix elements of a Haar-random unitary $U$ and its complex-conjugate $U^\\ad$.\nIn this case, also all moments of the random variable are the expected value of such polynomials.\nIn this section we introduce the mathematical theory required to explicitly calculate such moments.\nTo this end, we observe that any polynomial $p_t(U, U^\\ad)$ of degree $\\dorder$ can be written as the contraction with two matrices $A, B\\in \\CC^{d\\dorder \\times d\\dorder}$\n$$\n\\label{eq:poly_as_contraction}\np_\\dorder(U, U^\\ad) = \\Tr[B U^{\\otimes \\dorder} A (U^\\ad)^{\\otimes \\dorder}]\\, .\n\n$$\nThis motivates the definition of the $\\dorder$-th moment operator\nof a probability measure $\\mu$ on $\\U(d)$ as\n$\\mo^{(\\dorder)}_{\\mu}: \\CC^{d\\dorder \\times d\\dorder} \\to \\CC^{d\\dorder \\times d\\dorder}$,\n$$\n\\label{eq:moment_op}\n\\begin{split}\n\\mo^{(\\dorder)}_{\\mu}(A)\n&=\n\\EE_{U\\sim \\mu}\\bigl[ U^{\\otimes \\dorder} A (U^\\ad)^{\\otimes \\dorder} \\bigr]\\\\\n&= \\int_{\\U(d)} U^{\\otimes \\dorder} A (U^\\ad)^{\\otimes \\dorder} \\rmd\\mu(U).\n\\end{split}\n\n$$\nIf we have an expression for the $\\dorder$-th moment operator for the Haar measure $\\mu_{\\U(d)}$, we can calculate the expectation value of arbitrary polynomials $p_\\dorder(U, U^\\ad)$ over $U\\sim \\mu_{\\U(d)}$ by a linear contraction (<ref>).\n\nThe crucial property that characterizes the $\\dorder$-th moment operator of $\\mu_{\\U(d)}$ is the following:\nconsider a fixed unitary $U \\in \\U(d)$ then a short calculation exploiting the unitary invariance of the Haar measure reveals that\n$$\n\\label{eq:mop:commutes}\nU^{\\otimes \\dorder} \\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(A)\n=\n\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(A) U^{\\otimes \\dorder}.\n\n$$\nWe find that $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(A)$ commutes with every unitary $U$ raised to the $\\dorder$-th tensor power.\n\nFor a set of endomorphisms $\\mathcal A \\subset \\L(W)$ on a vector space $W$ one calls the set\n$$\n\n\\operatorname{comm}(\\mathcal A)\n=\n\\{ B \\in \\L(W) \\mid BA = AB \\quad \\forall A \\in \\mathcal A \\}\n\n$$\nof all endomorphisms that commute with all elements of $\\mathcal A$ the commutant of $\\mathcal A$.\nThe following lemma establishes that not only does $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(A)$ commute with every unitary\nof the form $U^{\\otimes \\dorder}$ but it is in fact the orthogonal projector onto the commutant of $\\mc A = \\{U^{\\otimes \\dorder} | U\\in \\U(d)\\}$,\nwhere orthogonality is understood with respect to the Hilbert-Schmidt inner product (<ref>).\nAs becomes motivated shortly, we refer to\n$$\n\n\\Delta^{(\\dorder)}: \\U(d) \\to \\U(d^\\dorder)\n\\, , \\qquad\nU \\mapsto U^{\\otimes \\dorder}\n\n$$\nas the diagonal representation of $\\U(d)$.\n\n[label=lem:momentoperatorIsProjector]$\\dorder$-th moment operator\nThe $\\dorder$-th moment operator $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$ is the orthogonal projector onto $\\operatorname{comm}(\\Delta^\\dorder[\\U(d)])$, the commutant of the $\\dorder$-order diagonal representation of $\\U(d)$.\n\nWith (<ref>) we established that the range of $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$ is in $\\operatorname{comm}(\\Delta^\\dorder(\\U(d)))$.\nThe converse also holds since for $A \\in \\operatorname{comm}(\\Delta^\\dorder(\\U(d)))$ we calculate that $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(A) = A \\mo^{(\\dorder)}_{\\mu_{\\U(d)}}(\\1) = A$.\nThus, it remains to check the orthogonality\n$\n\\mo^{(\\dorder)\\,\\ad}_{\\mu_{\\U(d)}} = \\mo^{(\\dorder)}_{\\mu_{\\U(d)}}.\n$\nThe orthogonality requirement follows in very few lines of calculation using linearity and cyclicity of the trace.\n\nNote that the argument of the proof applies more generally and yields the analogous result for arbitrary groups equipped with a Haar measure, e.g. the uniform measure on a finite group.\n\nThe commutant of the diagonal representation of the unitary group can be\ncharacterized using a powerful result from representation theory:\nSchur-Weyl duality.\nTo set the stage for explaining the result we start by reviewing some basic definitions and results from representation theory.\n\n#### Representation theory\nLet us start with the most basic definitions.\nFor a proper introduction we refer to Simon's book\u00a0[Unknown Author, \"Unknown Title\", ] and to Goodman and Wallach's book [Unknown Author, \"Unknown Title\", ] for the representation theory of the standard matrix groups.\n\nLet $G$ and $H$ be groups.\n\n*  $f:G\\to H$ is a (group) homomorphism if $f(g_1 g_2) = f(g_1)f(g_2)$ for all $g_1,g_2\\in G$.\nNote that this condition implies that $f(e_G) = e_H$ and $f\\myleft(g^{-1}\\myright) = f(g)^{-1}$ for all $g\\in G$.\n\n*  Let $V$ be a vector space.\nBy $\\operatorname{GL}(V)$ we denote the general linear group over $V$, i.e. the group of invertible operators.\nA homomorphism $R: G \\to \\operatorname{GL}(V)$ is called a linear (group) representations.\n$R$ is a unitary representation if $R: G \\to \\U(\\H)$ is a homomorphism to a unitary group $\\U(\\H) \\subset \\L(\\H)$ on a Hilbert space $\\H$.\nHere, we are only concerned with such unitary representations and, hence, often omit the word \u201cunitary\u201d.\n\n*  A subspace $V\\subset \\H$ is said to be invariant if $R(g) V \\subseteq V$ for all $g\\in G$.\n$R$ is called irreducible if the only invariant subspaces are $\\{0\\}$ and $\\H$ itself.\nIrreducible representations are also called irreps for short.\n\n*  Two representations $R : G \\to \\U(\\H)$ and $\\tilde R : G \\to \\U(\\tilde \\H)$ are said to be unitarily equivalent if there is a unitary operator $W: \\H \\to \\tilde \\H$ such that $\\tilde R(g) = W  R(g) W^\\ad$ for all $g\\in G$.\n\nIf $R_i:G \\to \\H_i$ for $i=1,2$ are two representations of $G$ then\n$(R_1\\oplus R_2)(g) \\coloneqq R_1(g)\\oplus R_2(g)$ defines another representation $R_1\\oplus R_2: G \\to \\H_1\\oplus \\H_2$.\nThis representation has $\\H_1$ and $\\H_2$ as invariant subspaces.\nConversely, if a representation $R$ has a non-trivial invariant subspace $V$ then it can be decomposed as $R = R|_V \\oplus R_{V^\\perp}$.\nBy iterating this insight,\nwe have the following statement (see e.g. [Unknown Author, \"Unknown Title\", ]).\n\n[label=prop:irreps_decomp]Decomposition into irreps\nLet $R: G \\to \\L(\\H)$ be a unitary representation of a\ngroup $G$ on a finite-dimensional Hilbert space $\\H$.\nThen $(R,\\H)$ can be decomposed into a direct sum of irreps $(R_i,\\H_i)$ of $G$ as\n$$\n\\label{eq:irrep_decomp}\n\\H = \\bigoplus_i \\H_i\n\\quad \\text{and} \\quad\nR(g) = \\bigoplus_i R_i(g)\\, .\n\n$$\n\nSeveral irreps $R_{i_1}, \\dots, R_{i_m}$ in the decomposition (<ref>) might be unitarily equivalent to each other.\nThe maximum number $m$ is called the multiplicity of that irrep.\nThe space $\\CC^m$ in the resulting identification\n$$\n\n\\bigoplus_{j=1}^m R_{i_j} (g)\n\\cong\nR_{i_1}(g) \\otimes \\1_m  \\quad \\in \\L(\\H_1 \\otimes \\CC^m)\n\n$$\nis called the multiplicity space of $R_{i_1}$.\nThe decomposition (<ref>) is called multiplicity-free if all irreps $R_i$ are inequivalent, i.e., not isomorphic.\n\n[label=thm:Schurs_lemma]Schur's lemma\nLet $R : G \\to \\U(\\H)$ be an irrep of $G$ on $\\H$.\nIf $A \\in \\L(\\H)$ satisfies\n$$\n\\label{eq:SchursLemmaCond}\nA R(g) = R(g) A \\qquad \\forall g \\in G\n\n$$\nthen $A= c\\, \\1$ for some $c\\in \\CC$.\n\nThe condition (<ref>) implies that $R(h) A^\\ad = A^\\ad R(h)$ for all $h = g^{-1} \\in G$.\nHence, this condition also holds for $\\Re(A) \\coloneqq \\frac 12 (A+A^\\ad)$ and $\\Im(A) \\coloneqq \\frac 1{2\\i} (A-A^\\ad)$ and $A$ is a constant if they both are.\nHence, it is sufficient to prove the theorem for $A\\in \\Herm(\\H)$.\n\nLet $\\ket \\psi$ be an eigenvector with $A \\ket \\psi = \\lambda \\ket \\psi$ and\n$\\Eig_\\lambda(A) \\coloneqq \\{\\ket \\psi: \\  A\\ket \\psi = \\lambda\\psi\\}$ the full eigenspace.\nThen $R(g)\\ket \\psi \\in \\Eig_\\lambda(A)$ for all $g\\in G$ because $A R(g) \\ket \\psi = R(g) A \\ket \\psi = \\lambda R(g) \\ket\\psi$.\nSo, $\\Eig_\\lambda(A)$ is an invariant subspace.\nSince $\\Eig_\\lambda(A)\\neq \\{0\\}$ and $R$ is an irrep, $\\Eig_\\lambda(A) = \\H$ follows.\n[label=cor:irreps_abelian]Irreps of Abelian groups\nIf $G$ is Abelian then every irrep has dimension $1$.\n\nLet $R$ be an irrep of of an Abelian group $G$ on $\\H$.\nTheorem\u00a0<ref> implies that each $g\\in G$ has representation $R(g) = c\\, \\1$ for some constant $c$.\nHence, every subspace of $\\H$ is invariant under $R$.\nSince $R$ is an irrep this is only possible if $\\dim(\\H) = 1$.\n\nThere is also a slightly more general version of Schur's lemma:\n\n[label=thm:Schurs_lemmaII]Schur's lemma II\nLet $R : G \\to \\U(\\H)$ and $\\tilde R : G \\to \\U(\\tilde \\H)$ be two irreps of $G$ on finite-dimensional Hilbert spaces $\\H$ and $\\tilde \\H$.\nIf $A \\in \\L(\\H, \\tilde \\H)$ satisfies\n$$\n\\label{eq:SchursLemmaCondII}\nA R(g) = \\tilde R(g) A \\qquad \\forall g \\in G\n\n$$\nthen either $A = 0$ or $R_1$ and $R_2$ are unitarily equivalent up to a constant factor.\n\nThe condition\u00a0(<ref>) implies that for all $g\\in G$\n$$\n\nR(g) A^\\ad\n=\nA^\\ad \\tilde R(g)\n\n$$\nand, hence,\n$$\n\nR(g) A^\\ad A &= A^\\ad A R(g)\n\\\\\n\\tilde R(g) AA^\\ad &= AA^\\ad \\tilde R(g) \\, .\n\n$$\nSchur's lemma (Theorem\u00a0<ref>) implies that\n$A^\\ad A = c \\, \\1$ and\n$AA^\\ad =  \\tilde c \\, \\1$ for constants $c, \\tilde c$.\nSince the singular values of both operators have to coincide we find that $c=\\tilde c$.\nIt follows that either $c=0$ so that $A=0$ or that $W = A/\\sqrt{c}$ is a unitary.\nIn the latter case\n$$\n\\label{eq:intertwiningW}\nW R(g) = \\tilde R(g) W\n\n$$\nfor all $g\\in G$, i.e., $R$ and $\\tilde R$ are unitarily equivalent.\n\nA unitary $W$ relating two representations $R$ and $\\tilde R$ as in Eq.\u00a0(<ref>) is called an intertwining unitary of $R$ and $\\tilde R$.\n\n#### Schur-Weyl duality and the commutant of the diagonal action\nWe wish to calculate the moments of random variables depending on Haar-random unitaries.\nTherefore, we are interested in understanding the commutant of the diagonal representation of the unitary group.\nFormally, we define the diagonal representation of $\\U(d)$ on $(\\CC^d)^{\\otimes \\dorder}$ as\n$$\n\n\\Delta^\\dorder_d : \\U(d) \\to \\U\\myleft( (\\CC^d)^{\\otimes \\dorder} \\myright)\n\n$$\nby linearly extending the action\n$$\n\\label{eq:Ud-action}\n\\Delta^{\\dorder}_d (U) (\\ket{\\psi_1} \\otimes \\cdots \\ket{\\psi_\\dorder}) \\coloneqq (U \\ket\\psi_1) \\otimes \\cdots (U\\ket{\\psi_\\dorder})\\, .\n\n$$\n\nThe representation $\\Delta^\\dorder_d$ has a duality relation with another well-known representation on $\\mathbb {C^d}^\\dorder$: the  representation $\\pi_\\dorder$ of the symmetric group $\\Sym_\\dorder$ permuting the $\\dorder$ tensor components:\n$$\n\\begin{split}\\label{eq:Sk-action}\n\\pi_\\dorder &: \\Sym_k \\to \\U\\myleft( (\\CC^d)^{\\otimes \\dorder} \\myright) \\, , \\\\\n\\pi_\\dorder&(\\sigma)\\myleft(\\ket{\\psi_1}\\otimes \\dots \\otimes\\ket{\\psi_\\dorder}\\myright)\n\\coloneqq\n\\ket{\\psi_{\\sigma^{-1}(1)}}\\otimes \\dots \\otimes\\ket{\\psi_{\\sigma^{-1}(\\dorder)}} \\, .\n\\end{split}\n$$\nWe note that $\\pi_\\dorder(\\sigma)$ and $\\Delta_d(U)$ commute for any $\\sigma\\in \\Sym_\\dorder$ and $U\\in \\U(d)$.\n\nLet us consider the following two irreducible representations of the symmetric group which appear in the decomposition (<ref>) of $\\pi_\\dorder$ for any $\\dorder$.\nWe call $\\ket\\Psi \\in (\\CC^d)^{\\otimes \\dorder}$ symmetric if $\\pi_\\dorder(\\sigma)\\ket\\Psi = \\ket\\Psi$ for all $\\sigma \\in \\Sym_\\dorder$ and anti-symmetric if $\\pi_k(\\sigma)\\ket\\Psi = \\sign(\\sigma)\\ket\\Psi$  for all $\\sigma \\in \\Sym_\\dorder$.\nThe symmetric subspace $\\H_{\\sym^\\dorder}$\nand anti-symmetric subspace $\\H_{\\wedge^\\dorder}$ of $(\\CC^d)^{\\otimes \\dorder}$ are the subspaces consisting of all symmetric and all anti-symmetric vectors, respectively.\nBy $P_{\\sym^\\dorder}$ and $P_{\\wedge^\\dorder}$ we denote the orthogonal projectors onto these two subspaces.\n\nSymmetric subspace\n*  Calculate $P_{\\sym^\\dorder} \\ket \\psi$ for a product state $\\ket \\psi = \\ket{\\psi_1}\\otimes \\dots \\otimes \\ket{\\psi_\\dorder}$.\n\n*  Show that the dimension of the symmetric subspace $P_{\\sym^\\dorder} (\\CC^d)^{\\otimes \\dorder}$ is\n$$\n\\label{eq:dimSymSpace}\n\\Tr[P_{\\sym^\\dorder}] = \\binom{\\dorder+d-1}{d-1} \\, .\n\n$$\nHint: Argue first that this is the number of ways to distribute $\\dorder$ indistinguishable particles (bosons) into $d$ boxes (modes).\n*  Show that\n$$\n\\label{eq:psym_expansion}\n\\begin{split}\nP_{\\sym^\\dorder} &= \\frac1{k!} \\sum_{\\sigma \\in \\Sym_\\dorder} \\pi_\\dorder(\\sigma) \\\\\n\\text{and\\quad} P_{\\wedge^\\dorder} &= \\frac1{k!}\\sum_{\\sigma \\in \\Sym_\\dorder} \\sign(\\sigma)\\pi_\\dorder(\\sigma) \\, .\n\\end{split}\n\n$$\nSymmetric subspace\n*  The dimension of the symmetric subspace $P_{\\sym^\\dorder} (\\CC^d)^{\\otimes \\dorder}$ is\n$$\n\\else\\begin{equation}\\label{eq:dimSymSpace}\\fi\n\\Tr[P_{\\sym^\\dorder}] = \\binom{\\dorder+d-1}{d-1} \\, .\n\n$$\n\n*  The orthogonal projectors onto the symmetric and anti-symmetric subspace are\n$$\n\\else\\begin{equation}\\label{eq:psym_expansion}\\fi\n\\begin{split}\nP_{\\sym^\\dorder} &= \\frac1{k!} \\sum_{\\sigma \\in \\Sym_\\dorder} \\pi_\\dorder(\\sigma) \\\\\n\\text{and\\quad} P_{\\wedge^\\dorder} &= \\frac1{k!}\\sum_{\\sigma \\in \\Sym_\\dorder} \\sign(\\sigma)\\pi_\\dorder(\\sigma) \\, ,\n\\end{split}\n\n$$\nrespectively.\n\nThe first statement is a combinatorial one.\nThe trace of the symmetric projector is the number of ways to distribute $\\dorder$ indistinguishable particles (bosons) into $d$ boxes (modes), i.e., the dimension of the corresponding subspace of the bosonic subspace, which is known to be given by the binomial coefficient.\n\nThe second statement follows, e.g., for $P_{\\sym^\\dorder}$ by realizing that any symmetric vector in the range of $P_{\\sym^\\dorder}$ and that this operator is indeed a projector, i.e., that $P_{\\sym^\\dorder}$ is self-adjoint and $P_{\\sym^\\dorder}P_{\\sym^\\dorder} = P_{\\sym^\\dorder}$.\n\nFor the case of $\\dorder=2$ the decomposition into these two subspaces is very familiar.\nIt is easy to see that any matrix can be decomposed into a symmetric and an anti-symmetric part, which are orthogonal to each other.\nThis implies that\n$$\n\\label{eq:Schur-Weyl_k2}\n(\\CC^d)^{\\otimes 2}\n=\n\\H_{\\sym^2} \\oplus \\H_{\\wedge^2} \\, .\n\n$$\nNote that due to Corollary\u00a0<ref>, both the symmetric and the antisymmetric subspace are\nisomorphic to $\\CC^{m_{\\sym^2}}$ and\n$\\CC^{m_{\\wedge^2}}$, respectively;\nhere $m_{\\sym^2}$ and $m_{\\wedge^2}$ are the multiplicities of the two distinct one-dimensional irreps of $\\Sym_2$.\n\nFor $\\dorder > 2$ there is a similar decomposition with more summands called Schur-Weyl decomposition.\nThe Schur-Weyl decomposition relies on a duality relation between the commuting representations $\\Delta_d^\\dorder$ and $\\pi_\\dorder$.\nThe representations $\\Delta_d^\\dorder$ and $\\pi_\\dorder$ span each other's commutant as algebras.\n\n[label=thm:commutantOfDelta]Schur-Weyl duality [Unknown Author, \"Unknown Title\", ]\nFor the two commuting representations (<ref>) and (<ref>) it holds that\n$$\n\n\\operatorname{comm}(\\Delta_d^\\dorder(\\U(d))) = \\operatorname{span}\\{\\pi_\\dorder(\\Sym_\\dorder)\\} \\label{eq:commutant_as_perms}\n\n$$\nand\n$$\n\n\\operatorname{comm}(\\pi_\\dorder(\\Sym_\\dorder)) = \\operatorname{span}\\{\\Delta_d^\\dorder(\\U(d))\\}\\, .\n\n$$\n\nBy Schur's lemma such a duality relation implies that the multiplicity spaces of the irreducible representation of one representation are irreducible representations of the dual representation and vice versa.\nIn other words, $\\CC^d$ decomposes into multiplicity-free representations of the combined action $\\U(d) \\times \\Sym_k$.\nIn order to state this composition,\nwe write $\\lambda = (\\lambda_1, \\lambda_2 \\ldots, \\lambda_{l(\\lambda)}) \\vdash \\dorder$ for a partition of $\\dorder$ into $l(\\lambda)$ non-increasing, positive integers with $\\lambda_1\\geq 1$ and\nfulfilling\n$$\n\n\\dorder  = \\sum_{i=1}^{l(\\lambda)} \\lambda_i\\, .\n\n$$\nSuch partitions of integers label the irreducible representations of the symmetric group and the diagonal representation.\nAs a consequence of Schur-Weyl duality one can prove the following statement.\n\n[label=thm:Schur-Weyl]Schur-Weyl decomposition [Unknown Author, \"Unknown Title\", ]\nThe action of $\\U(d)\\times \\Sym_k$ on $(\\CC^d)^{\\otimes k}$ given by the commuting representations (<ref>) and (<ref>) is multiplicity-free and $(\\CC^d)^{\\otimes k}$ decomposes into irreducible components as\n$$\n\\label{eq:Schur-Weyl_decomp}\n(\\CC^d)^{\\otimes \\dorder }\n\\cong\n\\bigoplus_{\\lambda \\vdash \\dorder, l(\\lambda) \\leq d}  W_\\lambda \\otimes S_\\lambda \\, ,\n\n$$\nwhere $\\U(d)$ acts non-trivially only on $W_\\lambda$ and $\\Sym_k$ acts non-trivially only on $S_\\lambda$.\n\nFor any $\\dorder\\geq 2$, both $\\H_{\\sym^\\dorder}$ and $\\H_{\\wedge^\\dorder}$ occur as components in the direct sum\u00a0(<ref>).\n\nThe spaces $W_\\lambda$ are called Weyl modules and $S_\\lambda$ Specht modules.\nSchur-Weyl duality implies that the Weyl modules are the multiplicity spaces of the irreps of $\\Sym_k$ and, similarly,\nthe Specht modules are the multiplicity spaces of the irreps of $\\U(d)$.\n\nSchur-Weyl duality, Theorem\u00a0<ref>, and the resulting decomposition, Theorem\u00a0<ref>, give a simple characterization of the commutant of the diagonal action of the unitary group.\nThe relation (<ref>) allows one to derive an expression for the $\\dorder$-moment operator $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$\nas the orthogonal projector onto the span of the symmetric group.\nBut one has to be careful since $\\{\\pi^d_\\dorder(\\sigma)\\}_{\\sigma\\in \\Sym_\\dorder}$ is not an orthonormal basis.\nNote that it only becomes an orthogonal set asymptotically for large $k$, which can be exploited in some applications, e.g. in local random quantum circuits [Unknown Author, \"Unknown Title\", ].\nA general expression in terms of so-called Weingarten functions [Unknown Author, \"Unknown Title\", ] was derived by Collins and Sniady [Unknown Author, \"Unknown Title\", ], see also the Supplemental Material of Ref.\u00a0[Unknown Author, \"Unknown Title\", ]\nfor a convenient expression of their result and a summary of the derivation.\nFor our purposes we only need to derive an expression $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$ for certain special cases,\nnamely, for $\\dorder=2$ and when restricted to symmetric endomorphisms as its input.\n\nWe begin with the second moment, $\\dorder=2$.\n[label=prop:invariant_operators_k2]Second moment operator\nFor an operator $A \\in \\L(\\CC^d \\otimes \\CC^d)$, $d \\geq 2$, it holds that\n$$\n\\label{eq:secondMomentOperator}\n\\mo^{(2)}_{\\mu_{\\U(d)}}(A) = c_{\\sym^2} P_{\\sym^2} + c_{\\wedge^2} P_{\\wedge^2}\\,\n\n$$\nwith\n$\nc_{\\sym^2} = \\frac{2}{d(d+1)}\\Tr[A P_{\\sym^2}]\n$\nand $\nc_{\\wedge^2} = \\frac{2}{d(d-1)}\\Tr[A P_{\\wedge^2}]\n$.\n\nFrom\nLemma\u00a0<ref> and\nTheorem\u00a0<ref>\nwe know that $\\mo^{(2)}_{\\mu_{\\U(d)}}(A)$ is a linear combination of the identity $\\1$ and the swap operator $\\FF$ from (<ref>).\nFor $\\Sym_2$ the expansion of the projectors (<ref>) onto the symmetric and anti-symmetric subspace can be inverted resulting in $\\id = P_{\\sym^2} + P_{\\wedge^2}$ and $\\FF = P_{\\sym^2} - P_{\\wedge^2}$.\nThis establishes the form of (<ref>).\nSince $P_{\\sym^2}$ and $P_{\\wedge^2}$ are mutually orthogonal projectors and $\\mo^{(2)}_{\\mu_{\\U(d)}}$ is an orthogonal projector\nthe coefficients are given by $c_{\\sym^2} = \\Tr[A P_{\\sym^2}] / \\Tr[P_{\\sym^2}] = \\frac2{d(d+1)} \\Tr[AP_{\\sym^2}]$ and $c_{\\wedge^2}$ analogously.\n\nSecond, we allow for arbitrary $\\dorder$ but restrict the input of $\\mo_{\\mu_{\\U(d)}}^{(\\dorder)}$ to endomorphisms that are itself symmetric, i.e., of product form.\nIn this case we also find an orthogonal decomposition as given by the following lemma.\n[label=lem:sym_moment_operator]Moment operator on symmetric operators\nFor any operator $A \\in \\L(\\CC^{d})$ it holds that\n$$\n\n\\mo_{\\mu_{\\U(d)}}^{(\\dorder)} (A^{\\otimes \\dorder}) = \\sum_{\\lambda \\vdash k, l(\\lambda) \\leq d} c_\\lambda P_\\lambda\\, ,\n\n$$\nwith $P_\\lambda$ the orthogonal projector onto $W_\\lambda \\otimes S_\\lambda$ and\n$c_\\lambda = \\Tr(P_{\\lambda} A^{\\otimes k}) / \\Tr(P_{\\lambda})$.\nFurthermore, if the operator $A$ is of unit rank, then\n$$\n\n\\mo_{\\mu_{\\U(d)}}^{(\\dorder)} (A^{\\otimes \\dorder}) = c P_{\\sym^k}\\, ,\n\n$$\nwith $c = \\Tr(P_{\\sym^k} A^{\\otimes k}) / \\Tr(P_{\\sym^k})$.\n\nWe fix some $A \\in \\L(\\CC^{d})$ and denote\n$E \\coloneqq \\mo_{\\mu_{\\U(d)}}^{(\\dorder)}(A^{\\otimes k})$.\n\nBy the definition of the moment operator (<ref>),\n$E\n=\n\\int_{\\U(d)} (UAU^\\ad)^{\\otimes \\dorder} \\rmd\\mu_{\\U(d)}(U)$ and it becomes apparent that\n$E$ commutes with $\\pi^d_\\dorder (\\sigma)$ for any $\\sigma \\in \\Sym_\\dorder$.\nIn other words, $E \\in \\operatorname{comm}{\\Delta^\\dorder_d(\\U(d))} \\cap \\operatorname{comm}{\\pi^d_\\dorder(\\Sym_\\dorder)}$ by Lemma\u00a0<ref>.\nBy Schur's lemma (Theorem\u00a0<ref>) and the Schur-Weyl decomposition (<ref>), we thus conclude that\n$E$ acts proportionally to the identity on every Weyl module $W_\\lambda$ and Specht module $S_\\lambda$.\nDenoting the orthogonal projector onto $W_\\lambda \\otimes S_\\lambda$ as $P_\\lambda$, the  operator\n$E$ permits the decomposition $E = \\sum_{\\lambda \\vdash k, l(\\lambda) \\leq d} c_\\lambda P_\\lambda$ with $c_\\lambda \\in \\CC$.\nSince the projectors are mutually orthogonal the coefficients are given by $c_\\lambda = \\Tr(A^{\\otimes k} P_\\lambda) / \\Tr(P_\\lambda)$.\nThis establishes the lemma's first assertion for $E$.\n\nFinally, for unit rank $A$, i.e. $A = \\ketbra\\psi\\phi$ with $\\ket\\psi, \\ket\\phi \\in \\CC^d$, we observe that $P_{\\sym^k} A^{\\otimes k} P_{\\sym^k} = P_{\\sym^k} {\\ket\\psi}^{\\otimes n} {\\bra\\phi}^{\\otimes n}  P_{\\sym^k} = A^{\\otimes k}$. Hence, $c_\\lambda = 0$ for all $\\lambda$ that do not correspond to the symmetric subspace. This leaves us with the lemma's second expression for $E$.\n\n#### Uniformly random state vectors\nOne can also define a uniform distributed on pure quantum states in multiple equivalent ways.\nFirst, one can draw randomly from the complex sphere $\\sphereCd$, i.e. the set of normalized vectors in $\\CC^d$.\nIndeed, there is a unique uniform probability measure $\\mu_{\\sphereCd}$ on $\\sphereCd$ that is invariant under the canonical action of $\\U(d)$ on $\\CC^d$.\nBy definition we see that a column $\\ket\\psi = U\\ket 0$ of a Haar-randomly drawn unitary $U \\sim \\mu_{\\U(d)}$ is distributed\naccording to $\\mu_{\\sphereCd}$.\nFinally, we can switch to density matrices by factoring out a global phase.\nIn more detail, the complex projective space $\\Cproj^{d-1} \\coloneqq \\sphereCd/\\U(1)$ is the space of state vectors modulo a phase in $\\U(1)$, which can be identified with the space of pure density matrices $\\Cproj^{d-1} \\subset \\DM(\\CC^d)$.\nIt also has a uniform unitarily invariant probability distribution: a\nuniformly random pure state $\\ketbra \\psi\\psi$ can be obtained by drawing $\\ket\\psi\\sim \\mu_{\\sphereCd}$.\n\nWe can calculate the moments of polynomials that depend on states drawn uniformly from $\\mu_{\\sphereCd}$ using the\nmoment operator $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$.\nTo this end, note that any polynomial $p_\\dorder(\\ket\\psi, \\bra\\psi )$ of degree $\\dorder$ in the component of each $\\ket \\psi$ and $\\bra \\psi$\ncan be written as a contraction of ${\\ketbra\\psi\\psi}^{\\otimes\\dorder}$ with some operator in $\n\\L(\\CC^{d^k})$.\nFor this reason the following lemma summarizes everything we need.\n\n[label=lem:moments_rand_states,fonttitle=]Moment operator of random states\nLet $K^{(\\dorder)}_{\\mu_{\\sphereCd}}$ be the moment operator for $\\ket\\psi \\sim \\mu_{\\sphereCd}$ explicitly defined by\n$$\n\nK^{(\\dorder)}_{\\mu_{\\sphereCd}}\n\\coloneqq\n\\int_{\\sphereCd} (\\ketbra \\psi \\psi)^{\\otimes \\dorder} \\rmd \\mu_{\\sphereCd}(\\psi) \\, .\n\n$$\nIt holds that\n$$\n\nK^{(\\dorder)}_{\\mu_{\\sphereCd}} = \\frac{\\dorder!(d-1)!}{(\\dorder+d-1)!} P_{\\sym^k}\\, ,\n\n$$\nwhere $P_{\\sym^k}$ is the projector (<ref>) onto the symmetric subspace.\n\nAs $\\mu_{\\sphereCd }$ is $\\U(d)$-invariant,\nwe find $K_\\dorder = \\mo_{\\mu_{\\U(d)}}^{(\\dorder)}((\\ketbra\\psi\\psi)^{\\otimes\\dorder})$. Lemma\u00a0<ref> thus implies that $K_\\dorder = c P_{\\sym^k}$ with\n\nc = (P_^k (|\u03c8\u27e9\u27e8\u03c8|)^\u2297 k)/(P_^k).\n\nSince $P_{\\sym^k}$ acts trivially on $\\ket\\psi$ and it is normalized, the enumerator evaluates to $1$.\nThe denominator is the dimension of $P_{\\sym^\\dorder}$ given by (<ref>).\n\nUnitary, spherical and complex-projective k-designs\n\nWith our excursion to representation theory we derived expressions to calculate the moments of random variables on uniformly random states and unitaries.\nThe very same results can also be used for certain other interesting probability distributions.\nTo this end, note that if we want to control only the first $t$ moments of a random variable that is a polynomial of degrees $\\ell$ in a random state or unitary, then our calculation will only involve the moment operators $\\mo^{(\\dorder)}_{\\mu_{\\U(d)}}$ for $k \\leq t\\ell$.\nIn many applications it is sufficient to control the expectation value and the variance of low-degree polynomials.\nIn these cases, any probability distribution that reproduces the first couple of moments of the uniform distributions\ncan be used without changing the mathematical expressions.\nThis idea is formalized by the definition of $\\dorder$-designs.\n\n[label=def:unitary_design]Unitary $\\dorder$-design\nA distribution $\\mu$ on the unitary group $\\U(d)$ is a unitary $\\dorder$-design if its $\\dorder$-th moment operator (<ref>) coincides with the one of the Haar measure,\n$$\n\n\\mo^{(\\dorder)}_{\\mu}\n=\n\\mo_{\\mu_{\\U(d)}}^{(\\dorder)}.\n\n$$\nFurthermore, a subset $\\{U_1, \\dots, U_\\ng\\}\\subset \\U(d)$ is called a unitary $\\dorder$-design if its uniform distribution is one.\n\n($\\dorder-1$)-designs\nProve that a unitary $\\dorder$-design is also a unitary ($\\dorder-1$)-design for $\\dorder\\geq 2$.\n\nNote that by definition, any unitary $\\dorder$-design is also a unitary ($\\dorder-1$)-design for $\\dorder\\geq 2$.\n\nA famous example of a unitary design in the context of quantum computing is the Clifford group.\nThe Clifford group\nThe $n$-qubit Clifford group $\\Cl_n\\subset \\U(2^n)$ is the normalizer of the Pauli group $\\mcP_n$ (see Section\u00a0<ref>),\n$$\n\n\\Cl_n \\coloneqq \\{U \\in \\U(2^n;\\QQ):\n\\\nU \\mcP_n U^\\ad \\subset \\mcP_n \\} \\, ,\n\n$$\nwhere it is common to restrict to unitary matrices with complex rational entries, here denoted by\n$\\U(d;\\QQ)\\coloneqq \\U(d)\\cap (\\QQ^{d\\times d}+\\i \\QQ^{d\\times d})$, so that $\\Cl_n$ becomes a finite group.\nThis group is generated by the\nsingle qubit Hadamard gate $\\operatorname{H}$ and the phase gate $\\operatorname{S}$ given by\n(see, e.g.\u00a0[Unknown Author, \"Unknown Title\", ])\n$$\n\n\\begin{split}\n\\operatorname H = \\frac1{\\sqrt{2}}\n\\begin{pmatrix} 1 & 1 \\\\ 1 & -1 \\end{pmatrix}\n\\quad\\text{and}\\quad\n\\operatorname S = \\begin{pmatrix} 1 &  \\\\  & \\i \\end{pmatrix}\n\\end{split}\n\n$$\ntogether with the two-qubit  gate\n$$\n\n\\CNOT =\n\\ketbra 00 \\otimes \\1 + \\ketbra 11 \\otimes \\sigma_x\\, ,\n\n$$\nall acting locally on any qubit.\n\nTogether with the $\\operatorname{T} = \\sqrt{\\operatorname S}$ gate the Clifford group is\na universal gate set (see, e.g.\u00a0[Unknown Author, \"Unknown Title\", ]).\n\nThe Clifford group is a unitary $3$-design but not a unitary $4$-design [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nBeing a subgroup of the unitary group the commutant of the\ndiagonal action of the Clifford group for $k > 3$ is, thus, a strictly larger space than the span of the permutation group.\nA classification of the `missing generators' of the commutant was done by Gross et al.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nAnalogously to unitary designs, we can define spherical $k$-designs.\nFor a distribution $\\mu$ on the complex sphere $\\sphereCd$ we define the $\\dorder$-th moment operator as\n$$\n\nK^{(\\dorder)}_{\\mu}\n\\coloneqq\n\\int_{\\sphereCd } (\\ketbra \\psi \\psi)^{\\otimes \\dorder} \\rmd \\mu(\\psi) \\, .\n\n$$\n\n[label=def:t-design]Complex spherical/proj\u00adec\u00adtive $k$-design\nA distribution $\\mu$ on $\\sphereCd $ is a spherical $k$-design if\n$$\n\nK^{(k)}_{\\mu} = K_{\\mu_{\\U(d)}}^{(k)}.\n\n$$\nFurthermore, a subset $\\sphereCd $ is called a spherical $k$-design if its uniform distribution is $1$.\nThe corresponding distribution of $\\ketbra \\psi \\psi$ is called a complex projective $\\dorder$-design.\n\nSee also Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] for related definitions.\n\nAnalogously to the relation of the uniform measure on $\\U(d)$ and $\\sphereCd$,\na rather obvious but important example of a spherical $\\dorder$-designs it given by the orbits of a unitary $\\dorder$-design.\nIf $\\mu$ is a unitary $\\dorder$-design for $\\U(d)$ and $\\ket\\psi \\in \\CC^d$ then the induced distribution $\\tilde\\mu$ given by $U \\ket\\psi$ with $U \\sim \\mu$, is a complex spherical $\\dorder$-design.\n\nOne can use this relation to see that the Clifford group being a unitary $3$-design implies the analogous statement for stabilizer states.\n\nStabilizer states are $3$-designs\nThe set of all stabilizer states (<ref>) is known to be a $2$-design [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], actually even a $3$-design but not a $4$-design [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nOther examples for spherical designs that play important roles\nin quantum system characterization are MUBs and SICPOVM.\n\nMUBsMUBs are sets of bases with minimal overlaps.\nMore explicitly, two orthonormal bases $\\{\\ket{\\psi_i}\\}_{i \\in [d]}\\subset \\CC^d$ and $\\{\\ket{\\phi_i}\\}_{i \\in [d]}\\subset \\CC^d$ are said to be mutually unbiased if $|\\braket{\\psi_i}{\\phi_j}|^2 = \\frac 1d$ for all $i,j\\in [d]$.\nFor instance, if $U\\in \\U(d)$ is the discrete Fourier transform then the bases $\\{\\ket{i}\\}_{i \\in [d]}\\subset \\CC^d$ and $\\{U\\ket{i}\\}_{i \\in [d]}\\subset \\CC^d$ are mutually unbiased.\nThe number of MUBs in $\\CC^d$ is upper bounded by $d+1$ and, in prime power dimensions (e.g., for qubits), there are exactly $d+1$ MUBs [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nHowever, it is a well-known open problem to exactly obtain this number for all $d$.\nKlappenecker and Roettler [Unknown Author, \"Unknown Title\", ] showed that maximal sets of MUBs are complex spherical $2$-designs.\nSICPOVM\nA SICPOVM is given by a set of $d^2$ normalized vectors $\\{\\ket{\\psi_j}\\}_{j \\in [d^2]}\\subset \\sphereCd  \\subset \\CC^d$ satisfying\n$$\n\n|\\braket{\\psi_i}{\\psi_j}|^2 = \\frac{1}{d+1} \\qquad \\forall i\\neq j \\, .\n\n$$\n\u201cSymmetric\u201d refers to the inner products being all equal.\nZauner [Unknown Author, \"Unknown Title\", ] has investigated SICPOVM systematically.\nRenes et al.\u00a0[Unknown Author, \"Unknown Title\", ] have shown that SICPOVM are indeed $2$-designs.\nBoth works provide explicit constructions for small dimensions.\n\n### Shadow fidelity estimation\nAnother recently proposed approach to fidelity estimation makes use of estimating so-called classical shadows [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe principle idea of shadow estimation is to calculate the least-square estimator of a quantum state from recorded classical measurement outcomes with measurement setting drawn from a certain measurement frame.\nAs we see in this section such a POVM that allows for a quite explicit analysis is given by a complex projective $3$-design.\n\nFrom the state's least-square estimator one can construct estimators of multiple target functions of the state, which are linear functions or even higher degree polynomials.\nThe sampling complexity of the derived estimators can be captured by a so-called shadow norm that is defined in terms of the measurement frame.\nThe classical post-processing complexity is determined by the complexity of constructing the state estimator and evaluating the target functions.\nOperationally, the analyzed POVM measurement is assumed to be implementable by\nrandom unitaries from a suitable ensemble and a consecutive basis measurement.\nWhile shadow estimation is a rather broad and flexible framework,\nwe focus on the estimation of fidelities with pure target states using unitaries that form a unitary $3$-design, e.g., multi-qubit Clifford gates or suitable subgroups thereof.\nBesides being an instructive example for shadow fidelity estimation, the $3$-design setting can be equipped\nwith a performance guarantees that features a sampling complexity $\\LandauO(\\epsilon^{-2})$ that does not scale with the Hilbert space dimension.\nThis system-size-independent scaling is not achievable in general for other measurement frames.\n\nThe complete SFE protocol is the following.\n\n[label=protocol:SFE]SFE\nLet $\\mu$ be a distribution on $\\U(d)$,\n$\\{\\ket b: b \\in [d]\\}\\subset \\CC^d$ an orthonormal basis and $\\rhot\\in \\DM(\\CC^d)$ be a target state.\n\nThe protocol consists of the following steps applied to state preparations $\\{\\rhop_i\\}_{i=1}^\\np \\subset \\DM(\\CC^d)$.\nFor each $\\rhop_i$ perform the following steps:\n[(i)]\n\n*  Draw $U_i \\sim \\mu$.\n\n*  Perform the following experiment:\n[I)]\n\n*  Prepare $\\rhop_i$.\n\n*  Apply the gate $\\rhop_i \\mapsto U_i\\rhop_i U_i^\\ad$.\n\n*  Perform the basis measurement $\\mathcal B$ and record the outcome $b_i \\in \\{0, 1\\}^n$.\n\n*  Calculate\n$$\n\\label{eq:sfe:single_estimators}\n\\hat f_i = (d + 1) \\sandwich {b_i} {U_i\\rhot\\, U^\\ad_i} {b_i} - 1\\, .\n\n$$\n\nOutput the median of means estimator (<ref>) of $\\{\\hat f_i\\}_{i=1}^{n_\\rhop}$.\n\nWe present the protocol as iterations over combined experimental and classical pre- and post-processing steps.\nNote, however that one can complete the three stages separately:\nfirst, one can classically generate the complete sequence of $\\np$ random unitaries.\nThen, one can subsequently perform the quantum experiment, i.e. all repetitions of step\u00a0(<ref>).\nImportantly, at this stage not even the knowledge of the target state $\\rhot$ is required.\nStorage of the experimental outcomes, $\\np$ bit strings, requires $\\np\\log n$ bits.\nThese bit strings together with a prescription of the random sequence of unitaries are then taken as the input of the post-processing algorithm that calculates the median of means estimator.\nThe complexity the classical post-processing depends on the complexity of calculating the overlap of Eq. (<ref>).\nFor an arbitrary target state $\\rhot$ the effort of performing this task can scale exponentially in the number of qubits.\nIn contrast, for stabilizer states and Clifford group unitaries the Gottesman-Knill theorem, see e.g. the book by Nielsen and Chuang [Unknown Author, \"Unknown Title\", ], allows for an efficient computation of this expression.\n\nShadow fidelity estimation comes along with the following guarantee.\n\n[label=thm:SFE]Guarantee for SFE\nConsider Protocol\u00a0<ref> with $\\mu$ being a unitary $3$-design and $\\rhot$ a pure target state.\nChoose $\\delta \\in (0,1)$, $\\epsilon > 0$\nand a number\n$$\n\n\\np \\geq 160\\, \\frac1{\\epsilon^2} \\ln\\frac1\\delta\n\n$$\nsuch that it is a multiple of $k = \\lceil 8\\ln(1/\\delta) \\rceil$.\nThen, the median of means estimator of the protocol\nis an $\\epsilon$-accurate unbiased estimator of $\\fidelity(\\rhot, \\rhop)$ with confidence $1-\\delta$ for $\\np$ iid. state preparations;\nthe median is taken over $l = \\np / k$ means, each of which is an empirical mean of $k$ realizations of $\\hat f_i$.\n\nTheorem\u00a0<ref> shows that SFE requires a number of state copies that for arbitrary pure target states does not dependent on the Hilbert space dimension.\n\nWith the DFE protocol of Section\u00a0<ref> we already encountered another fidelity estimation protocol.\nIn contrast to SFE, recall that DFE features a sampling complexity independent of the Hilbert space dimension only for the class of well-conditioned states, cmp. Theorem\u00a0<ref>.\nKeep in mind, however, that in order to additionally ensure an efficient classical post-processing\nalso SFE requires further structure such as provided by stabilizer states.\nFinally, note that SFE and DFE, as presented here, make use of different type of measurement data. While SFE uses basis measurement randomly selected from a large set of bases, DFE uses the expectation values of observables.\nCorrespondingly, they differ in their requirements for experimental implementations.\n\nThe proof of the performance guarantee, Theorem\u00a0<ref>, proceeds in three steps:\nfirst, we have to establish that the SFE estimator actually estimates the fidelity for pure target states.\nTo derive the sampling complexity of the estimator a\nnatural attempt would be to employ Hoeffding's inequality.\nUnfortunately, the random variables $\\hat f_i$ defined in Eq.\u00a0(<ref>) only have bounds scaling as $\\LandauO(d)$.\nThis becomes exponentially large in the number of qubits and does not yield the desired scaling.\nThe main insight underlying the efficiency of shadow fidelity estimation\nis that due to the structure of the unitary $3$-design the variance\nof $\\hat f_i$ is still bounded in $\\LandauO(1)$.\nThus, as a second step we derive the bound for the variance.\nFinally, by combining both results we arrive at the sampling complexity using the tail bound for the median of mean estimator introduced in Theorem\u00a0<ref>.\nUsing the median of mean estimator allows us to derive a sampling complexity in $\\LandauO(\\ln \\delta^{-1})$ in the confidence $1-\\delta$.\nNote that simply using an empirical mean estimator in the SFE protocol can also be equipped with a guarantee with sampling complexity in $\\LandauO(\\delta^{-1})$ using Chebyshev's inequality, Theorem\u00a0<ref>.\nA mean estimator might in a practical parameter regime even be more precise compared to the median of mean estimator.\n\n[fonttitle=]Unbiasedness of SFE estimator\nConsider Protocol\u00a0<ref> with $\\mu$ being a unitary $2$-design and $\\rhot$  a pure target state.\nLet $\\hat f_i$ be a random variable (<ref>) w.r.t. a state preparation $\\rhop$.\nThen\n$$\n\\label{eq:SFE:Efi}\n\\EE[\\hat f_i]\n=\n\\fidelity(\\rhot, \\rhop),\n\n$$\nwhere the expectation value is taken over both, $U \\sim \\mu$ and the subsequent random measurement outcome.\n\nFor convenience we suppress writing the index $i$.\nBorn's rule for the probability of the measurement outcomes yields\n$$\n\\label{eq:SFE:p}\np(b) = \\sandwich{b}{U\\rhop\\, U^\\ad}{b}.\n\n$$\nThus, the expectation value over $U$ and the measurement reads\n$$\n\\begin{split}\n\\EE [\\hat f]\n&= \\EE_{U \\sim \\mu} \\Biggl[\\sum_{b=1}^d\n\\sandwich{b}{U\\rhop\\, U^\\ad}{b}\n\\left[(d + 1)  \\sandwich{b}{U\\rhot\\, U^\\ad}{b} - 1 \\right] \\biggr] .\n\\end{split}\n$$\nThe second term can be directly evaluated using the fact that we sum over a basis,\n$$\n\\label{eq:one-design-property}\n\\begin{split}\n\\sum_{b=1}^d \\EE_{U\\sim \\mu}\n\\sandwich b {U \\rhop \\,U^\\ad} b\n&= \\EE_{U\\sim \\mu}\\bigl[ \\Tr[U \\rhop\\, U^\\ad] \\bigr]\n\\\\\n&=\n\\Tr[\\rhop]\\, .\n\\end{split}\n\n$$\nThe first term can be calculated using the $3$-design property of $\\mu$.\nMore precisely, at this point we need only $\\mu$ to be a $2$-design.\nRecall that if $U \\sim \\mu$ is a unitary $k$-design then for any state $\\ket \\tau$ its orbit $\\ket \\phi = U\\ket \\tau$ with the induced measure $\\tilde \\mu$ is a state $k$-design.\nThus, using the swap-trick (<ref>) and Lemma\u00a0<ref> we calculate that\n$$\n\\nonumber\n\\EE_{U \\sim \\mu}&\\biggl[(d+1) \\sum_{b=1}^d\n\\sandwich{b}{U\\rhop\\, U^\\ad}{b}\n\\sandwich{b}{U\\rhot\\, U^\\ad}{b}\\biggr]\n\\\\\\nonumber\n&=\n(d+1) \\sum_{b=1}^d \\Tr\\myleft[\n\\EE_{U\\sim \\mu}\\Bigl[\\left(U^\\ad\\ketbra bb U\\right)^{\\otimes 2}\\Bigr]\n(\\rhop \\otimes \\rhot) \\FF\n\\myright] \\\\\\nonumber\n&=\n(d+1) \\sum_{b=1}^d \\Tr\\myleft[\n\\EE_{\\ket\\phi\\sim \\tilde\\mu}\\Bigl[\\left(\\ketbra \\phi \\phi\\right)^{\\otimes 2}\\Bigr]\n(\\rhop \\otimes \\rhot) \\FF\n\\myright] \\\\\\nonumber\n&= \\Tr\\left[ (\\1 + \\FF)(\\rhop \\otimes \\rhot) \\FF \\right]  \\\\\n&= \\Tr[\\rhot\\rhop] + \\Tr[\\rhop]\\, \\Tr[\\rhot] \\, .\n\n$$\nCombining both terms again and using that $\\Tr[\\rhot]=1$,\nwe find that\n$$\n\n\\EE[\\hat f] = \\Tr[\\rhot\\rhop] \\, .\n\n$$\nUsing that $\\rhot$ was assumed to be a pure state establishes the statement (<ref>).\n\nNext we bound the variance.\nVariance bound for SFE\nConsider Protocol\u00a0<ref> with $\\mu$ being a unitary $3$-design and $\\rhot$  a pure target state.\nLet $\\hat f_i$ be a random variable (<ref>) w.r.t. a state preparation $\\rhop$.\nThen\n$$\n\\label{eq:SFE:varbound}\n\\Var[\\hat f_i] < 5 \\, ,\n\n$$\nwhere the variance is taken over both, $U \\sim \\mu$ and the subsequent random measurement outcome.\n\nWe again suppress the index $i$.\nThe variance is\n$$\n\\label{eq:SFE:var}\n\\begin{split}\n\\Var[\\hat f] &= \\EE \\bigl[ \\hat f^2 \\bigr] - \\EE[\\hat f]^2 \\, .\n\\end{split}\n\n$$\nUsing Born's rule (<ref>), Eq.\u00a0(<ref>) and that $U \\ket b$ is distributed as a complex spherical $3$-design $\\tilde \\mu$,\nthe second moment can be written as\n$$\n\\nonumber\n\\EE \\bigl[ \\hat f^2 \\bigr]\n=\nd(d + 1)^2 &\\EE_{\\ket\\phi \\sim \\tilde\\mu}\\bigl[   \\sandwich \\phi \\rhop \\phi \\left| \\Tr[\\ketbra\\phi\\phi \\rhot ]\\right|^2 \\bigr]\n\\\\\n&- 2 \\EE[\\hat f] + \\Tr[\\rhop]\\, .\n\\label{eq:SFE:varFirstTerm}\n\n$$\nThe first term in this expression can be calculated using the $3$-design property of $\\tilde\\mu$\nand Lemma\u00a0<ref>,\n$$\n\n\\begin{split}\n\\EE_{\\ket\\phi \\sim \\tilde\\mu}&\\bigl[   \\sandwich \\phi \\rhop \\phi \\left| \\Tr[\\ketbra\\phi\\phi \\rhot ]\\right|^2 \\bigr]\n\\\\\n&=\n\\EE_{\\ket\\phi \\sim \\tilde\\mu} \\bigl[\n\\Tr[\\rhop\\ketbra\\phi\\phi] \\, \\Tr[\\rhot\\ketbra\\phi\\phi]^2\n\\bigr]\n\\\\\n&=\n\\Tr\\bigl[(\\rhop\\otimes \\rhot\\otimes \\rhot) \\EE_{\\ket\\phi \\sim \\tilde\\mu}[\\ketbra\\phi\\phi^{\\otimes 3}]\\bigr]\n\\\\\n&=\n\\frac{6}{d(d+1)(d+2)}\\,\n\\Tr\\bigl[(\\rhop\\otimes \\rhot\\otimes \\rhot) P_{\\sym^3}\\bigr] .\n\\end{split}\n\n$$\nWe recall that the projector $P_{\\sym^3}$ onto the symmetric representation of the symmetric group $\\Sym_3$ is given by the sum of all six permutations in $\\Sym_3$. Those are the identity, $3$ transpositions and the cyclic and anticyclic permutation.\nWriting out this sum and tracking the resulting contractions (which can be most conveniently done using tensor network diagrams) yields\n$$\n\\label{eq:SFE:varFirstTermExpr}\n\\begin{split}\n\\EE_{\\ket\\phi \\sim \\tilde\\mu}&\\bigl[   \\sandwich \\phi \\rhop \\phi \\left| \\Tr[\\ketbra\\phi\\phi \\rhot ]\\right|^2 \\bigr]\n\\\\\n&=\n\\frac{1}{d(d+1)(d+2)}\\,\n\\Bigl(\n\\Tr[\\rhop]\\, \\Tr[\\rhot]^2 %& \\text{(identity)}\n\\\\ &\\qquad \\qquad\n+ 2\\Tr[\\rhop\\rhot]\\, \\Tr[\\rhot]\n+ \\Tr[\\rhop] \\Tr[\\rhot^2] %& \\text{(transposition)}\n\\\\ &\\qquad \\qquad \\qquad\n+2 \\Tr[\\rhop\\rhot^2]\n\\Bigr) %&\\text{($3$-cycles)}\n\\\\\n&=\n\\frac{2+ 4\\fidelity(\\rhot,\\rhop)}{d(d+1)(d+2)}\n\\end{split}\n\n$$\nwhere we use the normalization of the states and that $\\rhot$ is pure in the last identity.\nCombining (<ref>), (<ref>) and using the expression (<ref>) from the previous lemma and (<ref>) we find the upper bound\n$$\n\n\\begin{split}\n\\Var[\\hat f] &= \\frac{d+1}{d+2}(2+4F) - 2F + 1 - F^2\n\\\\\n&<\n2(1+F) + 1-F^2\\leq 5\n\\end{split}\n\n$$\nwith $F \\coloneqq \\fidelity(\\rhot,\\rhop) \\in [0,1]$.\n\nWe have now the ingredients to simply invoke the median of means estimator (Theorem\u00a0<ref>) as the final step.\n\nBy Theorem\u00a0<ref> and the assumptions of Theorem\u00a0<ref> we have for the median of mean estimator $\\hat \\mu$\nwith confidence $1-\\delta$\n$$\n\n|\\hat \\mu - \\mu| \\leq \\sigma\\sqrt{\\frac{32 \\ln(1/\\delta)}\\np}\\, ,\n\n$$\nwhere $\\mu = \\EE[\\hat f_i]$ and $\\sigma^2 = \\Var[\\hat f_i]$.\nNow, (<ref>) implies that $\\mu = \\fidelity(\\rhot, \\rhop)$ and by (<ref>) we have $\\sigma < \\sqrt 5$.\nRequiring $|\\hat \\mu - \\fidelity(\\rhot, \\rhop)| \\leq \\epsilon$ and solving the right-hand sides leads to the sufficient condition $\\np \\geq 160\\, \\epsilon^{-2} \\ln (1 /\\delta)$.\n\nFurther reading\n\nShadow fidelity estimation builds on the idea of extracting an incomplete description\nof a quantum state in order to subsequently estimate its properties.\nFor such an incomplete description that correctly predicts the expectation of a set of observables\nAaronson coined the term `shadow' in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nThe broader framework for shadow estimation developed by Huang et al.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nallows the sampling complexity of different measurement frames to be derived and is also not restricted to estimating\nfidelities.\nSee also Paini and Kalev\u00a0[Unknown Author, \"Unknown Title\", ] for a parallel work analyzing the sampling complexity of estimating\nexpectation values of observables from measurement frames that are generated using a group.\nFinally, we note that the linear cross-entropy benchmarking protocol [Unknown Author, \"Unknown Title\", ] presented in Section\u00a0<ref>\nsimilarly to SFE exploits a unitary $3$-design as the measurement frame to achieve a sampling complexity scaling independently of the system size, as explicitly worked out by Helsen\u00a0et al. [Unknown Author, \"Unknown Title\", ].\n\n## Quantum processes\nIn the first part of this tutorial we presented different approaches to certify quantum states.\nFor the second part we now turn our attention to the certification of quantum processes, i.e. maps on quantum states.\n\nAs quantum technologies typically involve processing quantum states,\nthe task of their certification is omnipresent.\nFor example in quantum computing, processes of interest might be individual quantum gates, entire algorithms or a noise process that accounts for the deviation from the ideal functioning of a device.\n\nMany of the methods developed for quantum states can be employed to derive analogous results for quantum processes.\nIn principle, we can always arrive at a certificate for a quantum process by certifying its output states on a suitably large set of input states.\nSimilarly, maximally entangling the input of a quantum process with ancillary quantum systems allows one to operationally prepare a quantum state representing the quantum process via the so-called Choi- isomorphism.\n\nAfter reviewing the mathematical formalism for describing quantum processes and discussing several measures of quality, we briefly discuss examples of translating methods for direct state certification to quantum processes.\n\nThese approaches come with potentially severe drawbacks concerning the feasibility of the measurements.\nThe characterization of a quantum process always involves the preparation of input states and measurements on the output of the process.\nIn this task so-called SPAM errors can be a serious obstacle for a reliable characterization.\nThis has motivated the development of quantum characterization and verification methods that are robust against such SPAM errors to quite some extent.\nOne way to achieve this robustness are self-consistent approaches that aim at simultaneously characterizing quantum processes, the state-preparation and the measurement [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThese methods however require extensive effort in terms of the number of measurement settings, sampling complexity and classical post-processing, and deliver far more information than required for certification.\n\nAn important class of certification methods in the context of digital quantum computing are randomized benchmarking protocols [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nRB protocols extract performance measures for quantum gates by\nimplementing random gate sequences of different lengths and measuring the error that accumulates with the sequence length.\nBy studying the error dependence in the sequence length randomized benchmarking protocols\nare robust against SPAM errors.\nWe present two prototypical types of RB protocols targeting performance measures of a gate set and of individual gates\ntogether with the theoretical analysis in the simplest setup\nin Section\u00a0<ref>.\n\nFinally, in Section\u00a0<ref> we turn our attention to a method that is used in order to\ncertify the correct implementation of a quantum circuit in the context of demonstrating so-called quantum supremacy[We use the term `quantum (computational) supremacy' strictly in its established technical meaning [Unknown Author, \"Unknown Title\", ].]:\ncross-entropy benchmarking [Unknown Author, \"Unknown Title\", ].\n\n### Quantum processes and measures of quality\nA quantum process should model possible operations taking quantum states to quantum states.\nMathematically, a quantum process is, thus, a linear map taking density operators to density operators with suitable properties.\nTherefore, we start with introducing some notation related to linear maps between operator spaces.\n\nIn the following, let $\\H, \\K$ be finite-dimensional Hilbert spaces.\nThe vector space of linear maps from $\\L(\\H)$ to $\\L(\\K)$ is denoted by\n$\\M(\\H,\\K) \\coloneqq \\L(\\L(\\H), \\L(\\K))$.\nWe set $\\M(\\H)\\coloneqq \\M(\\H,\\H)$ and denote the identity by $\\id_\\H \\coloneqq \\1_{\\L(\\H)} \\in \\M(\\H)$.\nOften we just write $\\id$ when it is clear from the context what $\\H$ is.\nA map $\\Phi\\in \\M(\\H,\\K)$ is called Hermicity-preserving if\n$$\n\n\\Phi(\\Herm(\\H))\\subset \\Herm(\\K)\\, ,\n\n$$\npositive if\n$$\n\n\\Phi(\\PSD(\\H))\\subset \\PSD(\\K)\\, ,\n\n$$\nand\ntrace-preserving if\n$$\n\n\\Tr[\\Phi(X)] = \\Tr[X]\n\n$$\nfor all $X \\in \\L(\\H)$.\nNote that positive maps are also Hermicity-preserving.\n\nThe map $\\Phi$ is called CP if\n$\\Phi\\otimes \\id_{\\H'}$ is positive for all Hilbert spaces $\\H'$ with identity map $\\id_{\\H'}\\in \\M(\\H')$.\nThe set of CP maps is denoted by $\\CP(\\H,\\K) \\subset \\M(\\H,\\K)$ and forms a convex cone.\nWe set $\\CP(\\H)\\coloneqq \\CP(\\H,\\H)$.\nA CPT map is also called a quantum channel or just channel.\nThe subset of CPT maps is denoted by $\\CPT(\\H,\\K) \\subset \\CP(\\H,\\K)$ and forms a convex set.\nAgain, we set $\\CPT(\\H)\\coloneqq \\CPT(\\H,\\H)$.\n\nLastly, a map $\\Phi \\in \\M(\\H, \\K)$ is called unital if $\\Phi(\\1_\\H) = \\1_\\K$.\nNote that $\\Phi$ is trace-preserving if and only if its adjoint (w.r.t. the Hilbert-Schmidt inner product) $\\Phi^\\ad$ is unital.\n\nSo, essentially, quantum channels are maps that take density matrices to density matrices even when applied to a part of a larger system.\nUsual unitary dynamics is of the following form.\n\nExample (Unitary channels):\nWe use calligraphic letters to denote the adjoint representation $\\mcU \\in \\M(\\H)$ of a unitary $U\\in \\U(\\H)$ given by\n$$\n\n\\mc U(X) \\coloneqq U X U^\\ad \\, .\n\n$$\nThese maps are quantum channels and are called unitary (quantum) channels.\n\nUnitary channels are invertible and the inverses are again unitary channels.\n\nThe Choi- isomorphism\n\nThe Choi- isomorphism\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] provides a duality between CP maps and bipartite positive semidefinite operators and allows the identification of channels with certain states.\nIt has many applications in quantum information theory and related fields.\nIn particular, it gives a practical criterion to check whether a given map is a quantum channel.\nFurthermore, it allows us to derive certification methods for quantum processes from the already presented methods for quantum states.\n\nFor any vector space $V$, recall that there is the canonical isomorphism\n$$\n\\label{eq:VVast}\n\\L(V) = V\\otimes V^\\ast \\, ,\n\n$$\nwhere $V^\\ast \\coloneqq \\L(V,\\C)$ is the dual space of $V$.\nFurthermore, if $V$ is equipped with an inner product $\\braket \\argdot\\argdot$, we have\nthe canonical isomorphism $v \\mapsto (w \\mapsto \\braket vw)$ identifying $V \\stackrel{\\operatorname{hc}}{\\cong} V^\\ast$.\nFor linear maps on linear maps $\\M(\\H,\\K)$ this simple isomorphism induces a couple of identifications with other vector spaces.\n\nThe Choi-Jamio\u0142kowski isomorphism\n$$\n\n\\choi: \\M(\\H,\\K) \\to \\L(\\K\\otimes \\H)\n\n$$\nis one of these isomorphisms of vector spaces\ngiven by the following sequence of simple identifications:\n$$\n\\label{eq:CJvia_isomorphisms}\n\\begin{aligned}\n\\M(\\H,\\K)\n&=\n\\L(\\K)\\otimes \\L(\\H)^\\ast\n=\n\\K\\otimes \\K^\\ast \\otimes \\H^\\ast \\otimes \\H\n\\\\\n&\\cong\n\\K\\otimes \\H^\\ast \\otimes \\K^\\ast \\otimes \\H\n=\n\\L(\\K\\otimes \\H^\\ast)\n\\\\\n&\\stackrel{\\operatorname{hc}}{\\cong}\n\\L(\\K\\otimes \\H) \\, ,\n\\end{aligned}\n\n$$\nwhere the natural isomorphism (<ref>) is denoted by \u201c$=$\u201d,\nthe isomorphism of changing the order of the vector spaces by \u201c$\\cong$\u201d,\nand identification marked by \u201chc\u201d makes use of the Hilbert space isomorphism $\\H \\cong \\H^\\ast$.\n\nMore explicitly, the Choi-Jamio\u0142kowski isomorphism can be written in the following way.\nLet $(\\ket i)_{i \\in [\\dim(\\H)]}$ be a basis of $\\H$ and\n$$\n\n\\ket \\1 = \\sum_{i=1}^{\\dim(\\H)} \\ket{i,i} \\ \\in \\H\\otimes \\H\n\n$$\nthe unnormalized maximally entangled state.\nThe Choi matrix of $\\X\\in \\M(\\H,\\K)$ is given as\n$$\n\\label{eq:CJvia_max_ent_state}\n\\choi(\\X) = \\X\\otimes \\id (\\ketbra\\1\\1) \\, .\n\n$$\n\n[fonttitle=]Choi-Jamio\u0142kowski iso\u00admor\u00adphism\nShow that the characterizations of Choi-Jamio\u0142kowski isomorphism from (<ref>) and (<ref>) coincide. If you are familiar with tensor network diagrams, give a pictorial definition of the\nChoi-Jamio\u0142kowski isomorphism.\nMoreover, show that\n$$\n\\label{eq:choi_expectation}\n\\Tr[B \\X(A)\t] = \\Tr[ (B \\otimes A^\\T) \\choi(\\X)]\n\n$$\nfor all $\\X\\in \\M(\\H,\\K)$, $A \\in \\L(\\H)$ and $B \\in \\L(\\K)$.\n\nThis characterization of $\\choi(\\X)$ implies\n$$\n\\ifex\\else\\label{eq:choi_expectation}\\fi\n\\Tr[B \\X(A)\t] = \\Tr[ (B \\otimes A^\\T) \\choi(\\X)]\n\n$$\nfor all $\\X\\in \\M(\\H,\\K)$, $A \\in \\L(\\H)$ and $B \\in \\L(\\K)$,\nas can be seen by direct calculations with basis elements or tensor network diagrams.\n\nNow we can connect the Choi- isomorphism to the properties of quantum channels.\n\n[label=thm:CPT_conditions]CPT conditions\nFor any map $\\X \\in \\M(\\H,\\K)$ the following equivalences hold:\n\n*  $\\X$ is trace-preserving if and only if $\\Tr_\\K[\\choi(\\X)] = \\1$.\n\n*  $\\X$ is Hermicity-preserving if and only if $\\choi(\\X)$ is Hermitian.\n\n*  $\\X$ is completely positive if and only if $\\choi(\\X)$ is positive semidefinite.\n\nAs an exercise or see, e.g., [Unknown Author, \"Unknown Title\", ].\n\nFor completeness, we remark that another important consequence of the complete positivity of a map is the existence of so-called Kraus operators.\nThis gives another item that could be added to Theorem\u00a0<ref>:\n$\\X$ is a CP map if and only if there are (Kraus) operators $K_1, \\dots, K_{r} \\in \\L(\\H,\\K)$,\nwhere $r = \\rank(\\choi(\\X))$ so that\n$$\n\\label{eq:Kraus}\n\\X(A) = \\sum_{i=1}^r K_i A K_i^\\ad\n\n$$\nfor all $A\\in \\L(\\H)$.\nMoreover, $\\X$ is a CPT map if and only if (<ref>) holds with $\\sum_{i=1}^r K_i^\\ad K_i = \\1$.\n\nIn the context of quantum information theory, another normalization convention for the Choi- isomorphism is useful.\nFor $\\X\\in \\M(\\H, \\K)$ we set\n$$\n\\label{eq:jam_choi}\n\\jam(\\X) \\coloneqq \\frac{1}{\\dim(\\H)} \\choi(\\X)\n\n$$\nwith Choi matrix (<ref>).\nThe theorem tells us that $\\X$ is a quantum channel if and only if $\\jam(\\X)$ is a density matrix with the reduction to $\\H$ (obtained by tracing over $\\K$) being a maximally mixed state.\nThe so-called Choi state of a channel $\\X$ is\n$$\n\\label{eq:jam_def}\n\\jam(\\X) = \\X\\otimes \\id_\\H(\\phi^+) \\ \\in \\DM(\\K\\otimes \\H) \\, ,\n\n$$\nwhere\n$$\n\\label{eq:Phi_plus}\n\\phi^+ \\coloneqq \\frac{1}{\\dim(\\H)} \\ketbra\\1\\1 \\quad  \\in \\DM(\\H\\otimes\\H)\n\n$$\nis a maximally entangled state, i.e.,\nhas the strongest bipartite quantum correlations possible in a precise sense.\nIn particular, the Choi state can be prepared by applying the channel to this state.\n\nNote that not every bipartite state corresponds to a channel.\nIndeed, the Choi- isomorphism is an isomorphism of convex cones, $\\choi: \\CP(\\H,\\K) \\to \\PSD(\\K\\otimes \\H)$ but $\\CPT(\\H,\\K)$ is mapped to a proper subset of $\\DM(\\K\\otimes \\H)$.\nThe reason is that the trace-preservation constraint of channels corresponds to $\\dim(\\H)^2$ many equalities whereas the trace constraint of states is just one equality.\n\nAn important quantum channel and frequent model for noise processes appearing in quantum technologies is the\ndepolarizing channel.\nThe (quantum) depolarizing channel $\\depol : \\L(\\CC^d) \\to \\L(\\CC^d)$ with parameter $p \\in [0,1]$ is the linear map defined by\n$$\n\\label{eq:def:depolChannel}\n\\depol(X) \\coloneqq p X + (1-p) \\Tr[X] \\frac{\\1}{d}  \\, .\n\n$$\n\nDepolarizing channel\nFrom the definition of the depolarizing channel (<ref>) it is clear that $\\depol \\in \\M(\\CC^d)$.\nShow that $\\depol \\in \\CPT(\\CC^d)$ if and only if\n\n-1/d+1\u2264 p \u2264 1   .\n\nFor which of those values of $p$ is $\\depol$ also invertible and when is the inverse also a channel?\n\n#### Inner products of superoperators and fidelity measures\nThe vector space of linear maps $\\M(\\H, \\K)$ is also equipped with a canonical inner product\n(the Hilbert-Schmidt inner product for superoperators)\ngiven by\n$$\n\n\\langle \\X, \\Y \\rangle\n=\n\\Tr[\\X^\\ad \\Y]\n\n$$\nfor any $\\X,\\Y\\in \\M(\\H, \\K)$, where the trace can be calculated using an orthonormal basis $\\{E_0, E_1, \\ldots, E_{d^2 -1}\\}$ of $\\L(\\H)$ as\n$$\n\\label{eq:trace_channels}\n\\Tr[\\X]\n=\n\\sum_{i = 0}^{d^2-1} \\langle E_i , \\X(E_i) \\rangle\n=\n\\sum_{i = 0}^{d^2-1} \\Tr[ E_i^\\ad \\X(E_i) ]\\, .\n\n$$\nThe Hilbert-Schmidt inner product on $\\M(\\H, \\K)$ coincides with the inner product of the corresponding Choi matrices, i.e., for any $\\X,\\Y\\in \\M(\\H, \\K)$\n$$\n\n\\langle \\X, \\Y \\rangle\n=\n\\langle \\choi(\\X), \\choi(\\Y) \\rangle.\n\n$$\n\nWe now consider the case where $\\Y$ is a quantum channel and $\\X$ a unitary quantum channel.\nThen, as we see above, $\\jam(\\Y)$ and $\\jam(\\X)$ are quantum states (density matrices).\nMoreover, $\\jam(\\X)$ is a pure state.\nIn this case, the above Hilbert-Schmidt inner product with the proper normalization is the fidelity measure induced by the state fidelity (<ref>) via the Choi- isomorphism (<ref>),\n$$\n\\label{eq:def:EntanglementGateFidelity}\n\\efidelity(\\X, \\Y) \\coloneqq \\fidelity(\\jam(\\X),\\jam(\\Y)) =\\frac{1}{\\dim(\\H)^2} \\langle \\X, \\Y \\rangle \\, ;\n\n$$\nit is referred to as the entanglement (gate) fidelity.\n\nIn the context of digital quantum computing, another very prominent fidelity measure for quantum processes is following.\nThe average gate fidelity (AGF) between maps $\\X,\\Y\\in \\M(\\H, \\K)$ is defined as\n$$\n\\label{eq:def:AGV:HSdef}\n\\agf(\\X, \\Y)\n\\coloneqq\n\\int_{\\sphereCd} \\langle \\X(\\ketbra\\psi\\psi), \\Y(\\ketbra\\psi\\psi) \\rangle\\,  \\rmd \\mu_{\\sphereCd}(\\psi)\n\\, ,\n\n$$\nwhere the integral is taken according to the uniform Haar-invariant probability measure on state vectors of\nSection\u00a0<ref>.\nNote that the inner product here is the Hilbert-Schmidt inner product of $\\L(\\K)$ not $\\M(\\H, \\K)$.\nFrom the definition we see that the average gate fidelity $\\agf(\\X, \\Y)$ is a measure of closeness of $\\X$ and $\\Y$ that compares the action of $\\X$ and $\\Y$ on pure input states on average.\nIntuitively, if $\\X$ and $\\Y$ deviate only in their action on a low-dimensional subspace of $\\H$ they can still have an average gate fidelity close to $1$.\n\nFor any $\\X,\\Y\\in \\M(\\H,\\K)$\n$$\n\\label{eq:agf:covariance}\n\\agf(\\X, \\Y)  = \\agf(\\id, \\X^\\ad \\circ \\Y) \\, .\n\n$$\nThis motivates the definition\n$\n\\agf(\\X) \\coloneqq \\agf(\\id,\\X)\n$ for $\\X\\in \\M(\\H)$.\n\nThe average gate fidelity is intricately related to the Hilbert-Schmidt inner product on $\\M(\\H, \\K)$ [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (see also Ref.\u00a0[Unknown Author, \"Unknown Title\", ]).\n\n[label=prop:AGFasOverlap]Inner product and $\\agf$\nFor $\\X, \\Y \\in \\M(\\H, \\K)$ with $d = \\dim(\\H)$ it holds that\n$$\n\\label{eq:AGF_as_inner_product}\n\\langle \\X , \\Y \\rangle\n= d(d+1) \\agf(\\X,\\Y) - \\langle \\X(\\1), \\Y(\\1) \\rangle \\, .\n\n$$\n\nBy the virtue of (<ref>) which also holds for the inner products appearing in (<ref>) it suffices to prove the statement for $\\X = \\id$.\nUsing (<ref>) and denoting the transposition map as $T: \\L(\\H) \\to \\L(\\H)$, $A \\mapsto A^\\T$, we can rewrite the average gate fidelity as\n$$\n\n\\begin{split}\n\\agf&(\\id, \\Y) = \\int_{\\sphereCd} \\langle \\ketbra\\psi\\psi, \\Y(\\ketbra\\psi\\psi) \\rangle\\,\n\\rmd \\mu_{\\sphereCd}(\\psi) \\\\\n&= \\int_{\\sphere^{d-1}} \\Tr\\left[\n\\ketbra\\psi\\psi  \\Y(\\ketbra\\psi\\psi)\n\\right]\n\\rmd \\mu_{\\sphereCd}(\\psi) \\\\\n&= \\int_{\\sphereCd}\n\\Tr\\left[\n\\id\\otimes T\\left({\\ketbra\\psi\\psi}^{\\otimes 2}\\right) \\choi(\\Y)\n\\right]\n\\rmd \\mu_{\\sphereCd}(\\psi).\n\\end{split}\n\n$$\nDue to linearity, we can recast this expression with the moment operator $K^{(k)}_{\\mu_{\\sphereCd}}$ of random states\nand use the expression we derive in Lemma\u00a0<ref>. Then,\n$$\n\\label{eq:process:innerproductFavg}\n\\begin{split}\n\\agf&(\\id, \\Y)\n=\n\\Tr\\left[\n\\id\\otimes T \\left(K^{(2)}_{\\mu_{\\sphereCd}}\\right) \\choi(\\Y)\n\\right] \\\\\n&= \\frac{2}{d(d + 1)} \\Tr\\left[ \\id\\otimes T(P_{\\sym^2}) \\choi(\\Y)\\right] \\\\\n&= \\frac{1}{d(d + 1)}\\left(\\Tr\\left[ \\1 \\choi(\\Y) \\right] + \\Tr\\left[\\ketbra \\1\\1 \\choi(\\Y)\\right] \\right),\n\\end{split}\n\n$$\nwhere the last step follows from $P_{\\sym^2} = \\tfrac 12(\\1+\\FF)$ with the swap operator $\\FF$ from (<ref>)\nand $\\id \\otimes T (\\FF) = \\ketbra\\1\\1$.\nUsing (<ref>) this time the other way around,  we see that the first summand of (<ref>)\nis $\\Tr[ \\1 \\choi(\\Y) ]  = \\Tr[ \\1 \\otimes \\1 \\choi(\\Y) ] = \\Tr[ \\Y(\\1)] = \\langle \\id(\\1), \\Y(\\1) \\rangle$.\nFrom (<ref>) it directly follows that $\\choi(\\id) = \\ketbra\\1\\1$.\nHence, the second term of (<ref>) is\n$\n\\Tr\\left[\\ketbra \\1\\1 \\choi(\\Y)\\right]%\n= \\Tr\\left[\\choi(\\id)\\choi(\\Y)\\right]%\n= \\langle \\choi(\\id), \\choi(\\Y) \\rangle%\n= \\langle \\id, \\Y \\rangle\n$.\nPlugging these two expressions into (<ref>) and solving for $\\langle \\id, \\Y \\rangle$ yields the assertion of the proposition.\n\nProposition\u00a0<ref> implies that the average gate fidelity is an inner product, i.e., a conjugate symmetric non-degenerate form that is linear in its second argument.\nFor Hermicity-preserving $\\X$ and $\\Y$ the average gate fidelity is real, $\\agf(\\X,\\Y) \\in \\RR$.\nThus, on Hermicity-preserving maps it is symmetric,\n$$\n\n\\agf(\\X, \\Y) = \\agf(\\Y, \\X).\n\n$$\n\nAssociate to the average gate fidelity is\nthe average error rate or average infidelity,\n$$\n\n\\aer(\\X,\\Y)\n\\coloneqq\n1- \\agf(\\X,\\Y)\\,\n\n$$\nthat is also real-valued for Hermicity-preserving maps.\nWe set $\\aer(\\X) \\coloneqq 1-\\agf(\\X)$.\nFor unital, completely positive $\\X$, the average infidelity can be regarded as a distance to other quantum channels in the following sense:\n\nInfidelity as distance measure\nLet $\\X \\in \\CP(\\H, \\K)$ be unital. For all $\\Y \\in \\CPT(\\H, \\K)$ it holds that\n$\\aer(\\X, \\Y) \\geq 0$ and, $\\aer(\\X, \\Y) = 0$ if and only if $\\X = \\Y$.\n\nUsing Proposition\u00a0<ref>, we have\n$\\agf(\\Y) = \\frac1{d(d+1)}\\,\\langle \\id , \\Y \\rangle + \\frac1{d+1}$.\nThe overlap of the two CP maps can be bounded via the Cauchy-Schwarz inequality as\n$\\langle \\id , \\Y \\rangle \\leq \\fnorm{\\id} \\fnorm{\\Y}$ with equality if and only if $\\Y = \\id$.\nFor $\\Y\\in \\CPT(\\H)$ it holds that $\\fnorm{\\Y}^2 \\leq d^2$ and\n$\\fnorm{\\id}^2 = d^2$. This can be seen, e.g., from the basis expansion (<ref>) by choosing a unit-rank basis and applying the H\u00f6lder inequality (<ref>).\nTherefore, $\\langle \\id , \\Y \\rangle \\leq d^2$.\nWe conclude that $\\agf(\\Y) \\leq 1$ again with equality if and only if $\\Y = \\id$ which implies the assertion.\n\nIf $\\X^\\ad\\Y$ is trace-preserving, (<ref>) simplifies to\n$$\n\\label{eq:tr(agf)}\n\\langle \\X, \\Y \\rangle\n=\nd(d+1) \\agf(\\X, \\Y) - d\n\\, ,\n\n$$\nor, equivalently,\n$$\n\\label{eq:agf(tr)}\n\\agf(\\X, \\Y)\n=\n\\frac{\\langle \\X, \\Y \\rangle + d}{d(d+1)}\\,.\n\n$$\nWe conclude that for trace-preserving and unital quantum channels the average gate fidelity and the Hilbert-Schmidt inner product are affinely related with a proportionality constant in $\\LandauO(d^{-2})$.\nThis is the same scaling as appearing for the entanglement fidelity in (<ref>).\nMore precisely, we find the affine relation between the two fidelities\n$$\n\\label{eq:agfandFe}\n\\agf(\\X, \\Y) = \\frac{d \\, \\efidelity(\\X,\\Y) + 1}{d + 1}\\, ,\n\n$$\nstill assuming $\\X^\\ad\\Y$ being trace-preserving and one of $\\X$ and $\\Y$ being a unitary channel.\nFor two unitary channels $\\mc U, \\mc V \\in \\CPT(\\H)$ with $U, V\\in \\U(d)$ we can further simplify (<ref>) to\n$$\n\\label{eq:AGF_U}\n\\agf(\\mc V, \\mc U)\n=\n\\frac{|\\Tr[V^\\ad U]\\, |^2-d}{d(d+1)}\\, .\n\n$$\nFor $V = \\1$ this equality reflects that the average gate fidelity measures how close $U$ is to $\\1$ on average where the average is taken over its spectrum.\n\nFurthermore, the identity (<ref>) also connects the average gate fidelity to the Frobenius norm.\nThis, in turn, shows that the Frobenius norm is an average case error measure as well.\n\nLastly, beside the entanglement fidelity, the Hilbert-Schmidt inner-product, and the average gate fidelity, there is another\naffinely related measure of quality that is particularly convenient to work with in the analysis of randomized benchmarking:\nthe effective depolarizing parameter.\nHere, we define the effective depolarizing parameter only for trace-preserving maps via\nits linear relation to the fidelity.\nIf $\\X$ is not trace-preserving one can more generally define it by explicitly first projecting on unital maps.\nLet $\\X \\in \\M(\\H, \\K)$ be trace-preserving, its effective depolarizing parameter is\n$$\n\\label{eq:effectiveP}\np(\\X) \\coloneqq \\frac{d \\agf(\\X) - 1}{d - 1}\\, .\n\n$$\n\nTo justify its name let us have a look at the depolarizing channel $\\depol[p]$, which is defined in (<ref>) as the convex combination of $\\depol[1]=\\id$ and $\\depol[0]$.\nThe average gate fidelity of these extremal channel can be quickly calculated to be $\\agf(\\id) = 1$ and $\\agf(\\depol[0]) = \\frac1d$.\nThus, $\\agf(\\depol[p]) = p + \\frac{1-p}d$. Plugging this into the definition of the effective depolarizing parameter (<ref>) yields\n$$\n\\label{eq:effective_depol_parameter}\np(\\depol[p]) = p.\n\n$$\n\nAnother affinely related measure that is often used in this context is the $\\chi_{0,0}$-entry of the so-called $\\chi$-process matrix, see e.g. Ref. [Unknown Author, \"Unknown Title\", ] for further details.\n\n#### The diamond norm\nThe distance measures on quantum channels we encounter so far can be regarded as average error measures.\n\nA more pessimistic, worst-case error measure is induced by the trace-norm on operators, the so-called diamond norm.\nIt measures the operational distinguishability of quantum channels.\nHence, it plays an important role in the certification of quantum processes.\nIndeed, also error-correction thresholds require worst-case guarantees without additional assumption on the error model, see e.g. the discussion Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nAt the same time, certification schemes that directly deliver certificates in diamond norm are very resource intensive and typically practically infeasible.\nFor this reason, the connection of the diamond norm to the already introduced average error measures is the focus of this section.\n\nWe start with defining the ($1\\to 1$)-norm on $\\M(\\H,\\K)$ to be the operator norm induced by the trace norm,\n$$\n\n\\norm{\\X}_{1\\to 1}\n\\coloneqq\n\\sup_{\\tnorm{A} \\leq 1} \\tnorm{\\X(A)} \\, .\n\n$$\nNote that since the trace norm is a convex function, we have for any $\\X \\in \\M(\\H,\\K)$\n$$\n\\label{eq:dnorm_as_sup_unit_rank}\n\\norm{\\X}_{1\\to 1}\n=\n\\sup_{\\substack{\\lpnorm[2]{\\ket\\psi}=1,\\\\ \\lpnorm[2]{\\ket\\phi}=1}} \\bigl\\{ \\tnorm{\\X (\\ketbra\\psi\\phi)} \\bigr\\} \\, ,\n\n$$\ni.e., the supremum is attained for rank-$1$ operators $\\ketbra \\psi\\phi\\in\\L(\\H)$.\n\nIn order to operationally distinguish two quantum channels one can use ancillary systems and entangled states.\nThis motivates the definition of the diamond norm as the so-called complete boundedness (CB)-completion of the $(1\\to 1)$-norm.\nWe define the diamond norm of $\\X \\in \\M(\\H)$ by\n$$\n\\label{eq:def:dnorm}\n\\dnorm{\\X}\n\\coloneqq\n\\norm{\\X\\otimes \\id_{\\H}}_{1\\to 1}\\, .\n\n$$\nNote that this norm inherits the property (<ref>) from the $(1\\to 1)$-norm.\nFor the relevant case where $\\X \\in \\M(\\H)$ is Hermitian-preserving we even have [Unknown Author, \"Unknown Title\", ]\n\n=\nsup_[2]|\u03c8\u27e9=1{\u2297\ud835\udd40 (|\u03c8\u27e9\u27e8\u03c8|)}  ,\n\ni.e., the supremum is attained at a pure density operator $\\ketbra \\psi\\psi\\in\\DM(\\H\\otimes\\H)$.\nIf $\\X$ is additionally trace-preserving then its output\n$\\X\\otimes \\id (\\ketbra\\psi\\psi)$\nis also a density operator.\nHence, quantum channels are normalized in diamond norm:\n$$\n\n\\dnorm{\\X} = 1 \\qquad \\forall \\X \\in \\CPT(\\H,\\K) \\, .\n\n$$\n\nMoreover, the following theorem guarantees some further basic properties of the diamond norm.\nIt has good stability properties concerning composition of Hilbert spaces, is multiplicative under tensor products and submultiplicative under products.\n\n[label=thm:dnorm]Complete boundedness and (sub)multiplicativity\nFor any $\\X \\in \\M(\\H,\\K)$\n$$\n\\label{eq:dnorm:CB}\n\\dnorm{\\X}\n=\n\\sup_{\\H'} \\norm{\\X\\otimes \\id_{\\H'}}_{1\\to 1}\\, ,\n\n$$\nwhere the supremum is taken over all finite-dimensional Hilbert spaces $\\H'$.\nMoreover,\n$$\n\n\\dnorm{\\X \\otimes \\Y} &= \\dnorm{\\X}\\dnorm{\\Y}\n\\\\\n\\dnorm{\\X\\mc Z} &\\leq \\dnorm{\\X} \\dnorm{\\mc Z}\n\n$$\nfor all $\\X \\in \\M(\\H,\\K)$, $\\Y \\in \\M(\\H',\\K')$ and $\\mc Z \\in \\M(\\H',\\H)$.\n\nFor the proof we refer, e.g., to [Unknown Author, \"Unknown Title\", ] or recommend proving it as an exercise.\n\nTheorem\u00a0<ref> tells us that the diamond norm\nprecisely captures the maximum distinguishability of quantum channels\n$\\X,\\Y \\in \\CPT(\\H,\\K)$\nin the following sense.\nOne can prepare copies of a state $\\rho \\in \\DM(\\H\\otimes \\H')$ and apply either $\\X$ or $\\Y$ to the parts on $\\H$ to obtain states on $\\K\\otimes \\H'$.\nThen Proposition\u00a0<ref> tells us that\n$\\frac 12 \\tnorm{\\Phi\\otimes \\id_{\\H'}(\\rho)}$ is the distinguishability of the output states.\nTaking the supremum over all (pure) states $\\rho$ yields the distinguishability of $\\X$ and $\\Y$, which is given by the diamond distance\n$\\frac 12 \\dnorm{\\X-\\Y}$.\nIn particular, the theorem tells us that optimal distinguishability can be obtained by choosing $\\H'=\\H$ in a similar sense as it can be detected when a map is not CP just using $\\H'=\\H$, cp. Theorem <ref><ref>.\n\nAnother way to distinguish quantum processes is to prepare their Choi states and distinguish them, as characterized by Proposition\u00a0<ref> via the trace norm.\nThe following statements provide a relation of the two notions of distinguishability of quantum channels.\n\n[label=prop:dnorm_tnorm,fonttitle=]Diamond norm and trace norm\nFor any map $\\X \\in \\M(\\H,\\K)$\n$$\n\n\\tnorm{\\jam(\\X)}\n\\leq\n\\dnorm{\\X}\n\\leq\n\\dim(\\H) \\tnorm{\\jam(\\X)} \\, ,\n\n$$\nwhere $\\jam$ denotes the Choi- isomorphism (<ref>).\n\nThe upper bound can be improved.\nFor a Hermitian-preserving map $\\X\\in \\M(\\H,\\K)$ the improved bound implies [Unknown Author, \"Unknown Title\", ]\n$$\n\n\\dnorm{\\X}\\leq \\dim(\\H) \\pnorm[\\infty]{\\Tr_2[|\\jam(\\X)|]} \\, .\n\n$$\n\nWe prove the proposition in terms of $\\choi(\\X) = \\dim(\\H) \\jam(\\X)$.\nDenoting the Frobenius norm again by $\\fnorm{\\argdot}$,\nit holds that\n$$\n\n\\dnorm{\\X}\n=\n\\sup_{\\substack{A, B \\in \\L(\\H) \\\\  \\fnorm{A} = \\fnorm{B}=1}} \\bigl\\{ \\tnorm{(\\1\\otimes A) \\choi(\\X) (\\1\\otimes B)}\\bigr\\}\n\\, ,\n\n$$\nas can be seen from (<ref>) and rearranging the contractions.\nChoosing $A = B = \\1/\\sqrt{\\dim(\\H)}$ (corresponding to the maximally entangled state (<ref>)) establishes the lower bound.\nThe upper bound follows using H\u00f6lder's inequality (<ref>),\n$$\n\n\\begin{aligned}\n&\\tnorm{(\\1\\otimes A) \\choi(\\X) (\\1\\otimes B)} \\\\\n&\\qquad\\leq\n\\snorm{\\1 \\otimes A} \\tnorm{\\choi(\\X)} \\snorm{\\1\\otimes B}\n\\\\\n&\\qquad=\\snorm{\\1} \\snorm{A} \\tnorm{\\choi(\\X)} \\snorm{\\1}\\snorm{B}\n\\\\\n&\\qquad\\leq\n\\fnorm{A} \\fnorm{B} \\tnorm{\\choi(\\X)} \\, .\n\\end{aligned}\n\n$$\n\nThe diamond norm/trace norm inequalities are tight\nShow that the bounds in Proposition\u00a0<ref> are tight, i.e., that there are $\\X,\\Y\\in \\M(\\H,\\K)$ so that $\\tnorm{\\jam(\\X)} = \\dnorm{\\X}$ and\n$\\dnorm{\\Y} = \\dim(\\H) \\tnorm{\\jam(\\Y)}$.\n\nIt is not difficult to see that the bounds in Proposition\u00a0<ref> are tight, i.e., that there are $\\X,\\Y\\in \\M(\\H,\\K)$ so that $\\tnorm{\\jam(\\X)} = \\dnorm{\\X}$ and\n$\\dnorm{\\Y} = \\dim(\\H) \\tnorm{\\jam(\\Y)}$.\n\nThese results tell us that distinguishing quantum channels via their Choi states is in general not optimal.\n\nIt is non-obvious how the diamond norm can actually be computed in practice.\nWatrous has shown that the diamond norm can be computed efficiently (in the dimension) via a semi-definite program [Unknown Author, \"Unknown Title\", ].\nHowever, for the highly relevant special case where the map is a difference of two unitary channels the computation is much simpler.\n\n[label=prop:diamond_dist_unitaries]Diamond norm distance of unitary channels\nFor any $U,V \\in \\U(d)$ the diamond norm distance of the corresponding unitary channels is\n$$\n\n\\frac 12 \\dnorm{\\mcU-\\mc V}\n=\n\\sqrt{1-\\dist\\myleft( 0, \\conv\\{\\lambda_i\\}_{i\\in [d]} \\myright)^2} \\, ,\n\n$$\nwhere $\\lambda_i$ are the eigenvalues of $U^\\ad V$,\n$\\dist(\\argdot, \\argdot)$ denotes the Euclidean distance and $\\conv(\\argdot)$ the convex hull, both in the complex plane.\n\nThis proposition reflects that the diamond distance is a worst-case quantity, where the worst-case optimization is done over the spectrum of the \u201cunitary difference\u201d $U^\\ad V$.\nThe geometric interpretation of this result is reviewed and visualized in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn order to prove the proposition we write the matrices $U$ and $V$ as vectors.\nIn general, (column) vectorization is a map $\\vect \\argdot: \\CC^{n_1\\times n_2} \\to \\CC^{n_1 n_2}$ that stacks the columns of a matrix $A \\in \\CC^{n_1\\times n_2}$ on top of each other.\nFor all matrices $A$, $B$ and $C$ with fitting dimensions it holds that\n$$\n\\label{eq:matrix_product_vectorization}\n\\vect{ABC} = C^\\T \\otimes A \\vect{B},\n\n$$\nwhere $X\\otimes Y \\cong (X_{i,j}Y)_{i,j}$ (defined by a block matrix) denotes the Kronecker product of matrices $X$ and $Y$.\n\nStarting with (<ref>) and using the Choi- isomorphism (<ref>) and the vectorization rules for matrix products (<ref>),\nwe can write the diamond norm of the channel difference as\n$$\n\\nonumber\n&\\dnorm{\\mc U - \\mc V }\n\\\\\\nonumber\n&\\quad=\n\\sup_{\\substack{A \\in \\L(\\CC^d)\\\\ \\pnorm[2]{A} = 1}}\n\\myleft\\{ \\tnorm{ (\\1\\otimes A) (\\ketbra UU - \\ketbra VV) (\\1\\otimes A)}\\myright\\}\n\\\\\\nonumber\n&\\quad=\n\\sup_{\\pnorm[2]{A} = 1}\\myleft\\{ \\tnorm{ \\ketbra{AU}{AU} - \\ketbra{AV}{AV}}\\myright\\}\n\\\\\n&\\quad=\n\\sup_{\\pnorm[2]{A} = 1}\\myleft\\{ \\tnorm{ \\ketbra{A}{A} - \\ketbran{AU^\\ad V}{AU^\\ad V}} \\myright\\}\\, .\n\n$$\n\nUsing (<ref>) relating the trace-norm difference of two trace-normalized, hermitian, unit-rank matrices to their overlap yields\n$$\n\\nonumber\n\\frac 12\\dnorm{\\mc U - \\mc V }\n&=\n\\sup_{\\pnorm[2]{A} = 1 }\\myleft\\{ \\sqrt{1- \\left| \\braket{A}{AU^\\ad V} \\right|^2} \\myright\\}\n\\\\ \\nonumber\n&=\n\\sup_{\\pnorm[2]{A} = 1 }\\myleft\\{ \\sqrt{1- \\left|\\Tr[A^2 U^\\ad V]\\right|^2}\\myright\\}\n\\\\ \\nonumber\n&=\n\\sup_{\\rho \\in \\DM(\\CC^d)} \\myleft\\{ \\sqrt{1- \\left|\\Tr[\\rho\\, U^\\ad V]\\right|^2} \\myright\\}\n\\\\ \\nonumber\n&=\n\\sqrt{1- \\min_{\\rho \\in \\DM(\\CC^d)} \\left|\\Tr[\\rho\\, U^\\ad V]\\right|^2}\n\\\\\n&=\n\\sqrt{1- \\min_{\\rho \\in \\DM(\\CC^d)} \\left|\\Tr[\\rho \\diag(\\lambda)]\\right|^2}\\, ,\n\\label{eq:dnormUV}\n\n$$\nwhere $\\diag(\\lambda)$ is a diagonal matrix with the same eigenvalues as $U^\\ad V$.\nBy writing $\\rho = W\\diag(q)W^\\ad$ with a unitary matrix $W \\in \\U(d)$ and probability vector $q\\in [0,1]^d$ we expand the trace in terms of matrix elements as\n\n[\u03c1(\u03bb)]\n=\n\u2211_i,j=1^d \u03bb_i |W_i,j|^2 q_j   .\n\nNote that $T \\coloneqq \\bigl( \\left|W_{i,j}\\right|^2\\bigr)_{i,j\\in[d]}$ is a doubly stochastic matrix, i.e. its sums and columns are all probability vectors.\nHence, $p\\coloneqq Tq$ is a probability vector as well.\nTherefore, the minimization (<ref>) is equivalent to a minimization of $|\\langle p, \\lambda \\rangle|^2$ over probability vectors $p$, i.e.,\n\n1/2 U -  V    =\n\u221a(1- min_p \u2208 [0,1]^d\n\u2211_i p_i=1{| \u2211_i p_i \u03bb_i |^2  })\n=\n\u221a( 1 - (0,{\u03bb_i}) )  .\n\nPractical certification schemes for quantum processes will typically certify w.r.t. the Hilbert-Schmidt overlap, average gate fidelity or an equivalent quantity.\nIn terms of the infidelity $r(\\X) = 1 - \\agf(\\X)$, the diamond norm and the average gate fidelity are in general related by the following inequalities.\n\n[label=prop:infidelityDiamond]Infidelity and diamond norm [Unknown Author, \"Unknown Title\", ]\nFor any $\\X \\in \\CPT(\\CC^d)$ it holds that\n$$\n\n\\begin{split}\n\\frac{d+1}{d}\\, r(\\X)\n\\leq\n\\frac 12 \\dnorm{\\id-\\X}\n\\leq\n\\sqrt{d(d+1) r(\\X)} \\, .\n\\end{split}\n\n$$\n\nThe proof\ncombines Proposition\u00a0<ref>\nwith the Fuchs-van-de-Graaf inequality (<ref>).\nLatter yields\n$$\n\\label{eq:choiFuchsVanDeGraaf}\n\\begin{split}\n&1 - \\fidelity( \\jam (\\id), \\jam(\\X)) \\\\\n&\\qquad\\leq \\frac12\\| \\jam(\\id) - \\jam(\\X) \\|_1 \\leq \\sqrt{ 1 - \\fidelity( \\jam (\\id), \\jam(\\X))} \\, ,\n\\end{split}\n\n$$\nwhere we already drop a square-root on the lower bound.\n\nSince $\\jam(\\id) = \\frac1d \\ketbra\\1\\1$ is of unit rank and Hermitian, it holds that\n$\\fidelity(\\jam (\\id), \\jam(\\X)) = \\langle \\jam(\\id), \\jam(\\X)\\rangle = \\efidelity(\\id, \\X)$.\nWe can cast this in terms of the average gate fidelity via (<ref>),\n$$\n\\label{eq:fidelityFavg}\n\\fidelity(\\jam (\\id), \\jam(\\X)) =\n\\frac{d+1}d \\agf(\\X) - \\frac1d \\,.\n\n$$\nPlugging (<ref>) into (<ref>) yields\n$$\n\\label{eq:fidjambound}\n\\begin{split}\n&\\frac{d+1}d(1 - \\agf(\\X)) \\\\\n&\\qquad\\leq \\frac12\\| \\jam(\\id) - \\jam(\\X) \\|_1 \\leq \\sqrt{\\frac{d+1}d} \\sqrt{ 1 - \\agf( \\X)}.\n\\end{split}\n\n$$\nFinally, from Proposition\u00a0<ref>\nthe proposition's assertion follows.\n\nProposition\u00a0<ref> leaves us with unsatisfactory state of affairs in two regards:\nfirst, the upper bound of the diamond norm introduces a dimensional factor $\\LandauO(d)$.\nIn the context of quantum computing, this leaves us with a potentially large factor scaling exponentially $\\LandauO(2^n)$ with the number\nof qubits $n$.\nSecond, the upper bound scales with the square-root of the infidelity.\nFor unitary quantum channels one can in fact tighten the lower-bound to $\\sqrt{r(\\X)}$ [Unknown Author, \"Unknown Title\", ].\nThe lower-bound for unitary quantum channels indicates that the square-root scaling is unavoidable in general.\nPractically, this means that to certify in diamond norm requires a certificate in infidelity that is orders of magnitude smaller.\nParticularly, for small system sizes this can be a key obstacle for the certification of the worst-case performance of quantum processes.\n\nFortunately, if a quantum process is highly incoherent, i.e. far away from being unitary, one can derive a linear scaling of\nthe diamond-norm distance in the infidelity.\nThe incoherence can be controlled by the so-called unitarity introduced by Wallman et al. [Unknown Author, \"Unknown Title\", ].\nFor $\\X \\in \\M(\\H)$ the unitarity is defined as\n$$\n\nu(\\X) = \\frac d{d-1} \\agf(\\X', \\X'),\n\n$$\nwhere $d = \\dim \\H$ and $\\X' \\in \\M(\\H)$ is defined by\n$$\n\n\\X'(A) = \\X(A) - \\Tr[\\X(A)] \\1/\\sqrt{d}\\, .\n\n$$\nOne can straightforwardly check that $u(\\mc U) = 1$ for every unitary channel $\\mc U$.\nOn the other hand, in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] a lower-bound on $u$ in terms of the infidelity $r$ was derived\nfor trace-decreasing maps.\nFor $\\X \\in \\M(\\H)$, $d \\coloneqq \\dim(\\H)$, and $\\Tr(\\X(\\1)) \\leq \\Tr(\\1)$ it holds that\n$$\n\\label{eq:def:umin}\nu(\\X) \\geq u_\\text{min} =\\left(1 - \\frac{d}{d-1}\\, r(\\X) \\right)^2 \\, .\n\n$$\n\nKueng et al.\u00a0[Unknown Author, \"Unknown Title\", ] established that quantum channels saturating this lower bound exhibit a\nlinear scaling of the diamond norm distance in terms of the infidelity.\n\n[label=thm:RiKbound]Worst-case bound for incoherent channels [Unknown Author, \"Unknown Title\", ]\nLet $\\X \\in \\CPT(\\H)$ be unital.\nThen\n$\\dnorm{\\id - \\X} \\in \\LandauO(r(\\X))$ if $u(\\X) = u_\\text{min} + \\LandauO(r^2(\\X))$ with $u_\\text{min}$ defined in (<ref>).\n\nThe result implies that the infidelity is indeed particularly sensitive to depolarizing noise.\nWe leave it with this qualitative statement and refer to Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for a quantitative\nstatement. See also Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Direct quantum process certification\nWe saw in Section\u00a0<ref>, that\nquantum states can be certified with measurement strategies resembling the optimal POVM $P^+$ for distinguishing quantum states of Proposition\u00a0<ref>.\nBy means of the Choi- isomorphism strategies for quantum states can be lifted to quantum processes:\noperationally, one prepares the Choi state (<ref>) by applying the process to a state that is maximally entangled with an ancillary system. Then one certifies the Choi state using a protocol for quantum states.\nThe resulting process certification protocols certifies with respect to the entanglement gate fidelity (<ref>), which coincides with the state fidelity of the Choi states.\nRefs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] use the direct state certification method of Section\u00a0<ref>\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] in\nthis way.\n\nMoreover, for certain measurement strategies the protocol can be performed without\nusing entanglement with ancillary systems.\nThese, prepare-and-measure versions use an effective measurement strategy $\\Omega$ of the form [Unknown Author, \"Unknown Title\", ]\n$$\n\n\\Omega = \\sum_{i} p_i N_i\\otimes \\rho_i^\\T\\, .\n\n$$\nFor this measurement strategy the expectation value in the Choi state is\n$$\n\n\\Tr[\\Omega \\jam(\\tilde{\\mcU})]\n=\n\\sum_{i} p_i \\Tr[(N_i\\otimes \\rho_i^\\T) \\jam(\\tilde{\\mcU})]\n\n$$\nand can be recast, thanks to Eq.\u00a0(<ref>), as\n$$\n\\label{eq:PAM}\n\\Tr[(N_i\\otimes \\rho_i^\\T) \\jam(\\tilde{\\mcU})]\n=\n\\Tr[N_i\\tilde{\\mcU}(\\rho_i)] \\, .\n\n$$\nWhile the dichotomic POVM defined by $N_i\\otimes \\rho_i^\\T$ for each $i$\noriginally acts on the Choi state $\\jam(\\tilde{\\mcU})$,\nthe form (<ref>) suggests a simpler, straightforward experimental implementation of the dichotomic POVM:\none prepares the state $\\rho_i$, applies the channel $\\mcU$ under scrutiny, and measures the dichotomic POVM\ngiven by $N_i$ on the state $\\tilde{\\mcU}(\\rho_i)$.\nThus, effective measurement strategies of the form [Unknown Author, \"Unknown Title\", ] can indeed be implemented\nby simple prepare-and-measure schemes.\n\nFor Clifford unitaries this method yields a simple direct certification test.\nThe Choi state of a Clifford unitary channel is a stabilizer state and can hence be verified with the methods of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] discussed in Section\u00a0<ref>.\nThe following proposition gives a theoretical guarantee for this protocol. It can be derived as a corollary of the results of Section\u00a0<ref>.\n\nDirect certification of Clifford operations, [Unknown Author, \"Unknown Title\", ]\nLet $\\mc C$ be an $n$-qubit Clifford operation.\nWe consider the state certification of Protocol\u00a0<ref> applied to its Choi state $\\jam(\\mc C)$, which is a stabilizer state.\nThis yields an $\\epsilon$-certification test of $\\jam(\\mc C)$ w.r.t. infidelity from $\\np$ independent such state preparations for\n$$\n\n\\np \\geq 2\\, \\frac{\\ln(1/\\delta)}{\\epsilon}\n\n$$\nwith confidence $1-\\delta$.\nMoreover, the target $\\jam(\\mc C)$ is accepted with probability $1$.\n\nThis test corresponds to a similar certification test of $\\mc C$ w.r.t. entanglement gate infidelity $1-\\efidelity$ and can be implemented as a prepare-and-measure scheme via (<ref>).\n\nFurther reading\n\nThe three works of Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] all follow the presented certification strategy based on direct state certification. Moreover, they discuss several additional aspects:\nLiu et al. [Unknown Author, \"Unknown Title\", ] study non-trace-preserving processes and measurements,\nZhu and Zhang [Unknown Author, \"Unknown Title\", ] analyze the general multi-qudit case and strategies based on projective $2$-designs, and\nZeng et al. [Unknown Author, \"Unknown Title\", ] discuss entanglement property detection.\n\nSimilar to direct state certification also fidelity estimation protocols can be lifted to quantum processes.\nTo this end, one applies the state fidelity estimation to the output of the process applied to randomly chosen input states.\nThe original DFE proposal by Flammia and Liu [Unknown Author, \"Unknown Title\", ] already includes the application to quantum channels by sampling from the eigenstates of multi-qubit Pauli operators as the input states. Furthermore, simplifications arising for Clifford gates are discussed.\nSee also the parallel work by da Silva et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nA strategy to estimate the average gate fidelity by inputting states drawn at random from complex projective $2$-designs was studied by Bendersky et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nReich et al.\u00a0[Unknown Author, \"Unknown Title\", ] determined the minimal number of required input states for the fidelity estimation of quantum processes.\nSee also the related work by Hofmann\u00a0[Unknown Author, \"Unknown Title\", ].\nReich et al. also provide a quantitative comparative overview over all the before-mentioned approaches in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Randomized benchmarking\nThe schemes presented in the previous section fail in the presence of sizeable SPAM errors.\nIn the context of digital quantum computing, this sensibility to SPAM errors is dramatically reduced by so-called RB protocols [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThese protocols can extract certain  quantitative measures of a quantum process\nassociated to a quantum gate set.\nThe process can be, for example, a certain gate, an error channel or an error map associated to the deviation of a quantum gate set from its ideal implementation.\nWhile still concerned with the physical layer of a quantum device, randomized benchmarking protocols already make explicit use of a gate layer, the abstraction at the heart of digital quantum computing.\n\nRB comprises a large zoo of different protocols.\nTherefore, we begin with a fairly general description.\nThe principle idea to achieve the SPAM-(error) robustness is the following:\nafter preparing an input state, one applies the quantum process under scrutiny multiple times in sequences of different lengths before performing a measurement.\nThereby, the effect of the process on the measurement is attenuated with increasing sequences length.\nAt the same time, errors in the state preparation and measurements enter the measured quantities only linearly and are independent of the sequence length.\nIn this way, fitting the attained signals for different sequence lengths with functions depending on the length reveals properties of the quantum process disentangled from the SPAM errors.\n\nA prototypical RB protocol implements this rough idea for\na digital quantum computer as follows.\nLet $\\gset \\subset \\U(d)$ be a subgroup of unitary operations and $\\phi: \\gset \\to \\M(\\CC^d)$ be their implementation on a quantum computer.\nIn simple RB protocols $\\phi(g)$ just models the faulty implementation of $\\mcG$ on the actual device.\nMore generally, the targeted implementation of the protocol can also include, e.g., a non-uniform sampling over the group or the implementation of another fixed gate after $\\mcG$.\nAlso in these cases $\\phi$ is the faulty version of the targeted implementation.\n\nNote that the assumption of the existence of such a map $\\phi$ already encodes assumptions on the quantum device and its noise process:\nthe map $\\phi$ might model the compilation into elementary gates, effects and imperfections of the physical control, and noise.\nAll these steps are not allowed to depend on the gate sequence the gate is part of, the overall time that evolves during the protocol, or other external variables.\nThis noise can in particular be described as context-independent and Markovian.\n\nWith these ingredients we can state a prototypical RB protocol,\nsee Figure\u00a0(Figure fig:RB) for an illustration.\n\n< g r a p h i c s >\n\nIllustration of a prototypical RB protocol.\nAfter the preparation of an initial state, one applies a random sequence of unitaries\n$g = (g_1, \\ldots , g_m)$ succeeded by an inversion gate and final measurement of $M$.\nThis experiment is repeated for different sequences and different sequence lengths $m$.\nIn the classical postprocessing, the decay parameter of resulting empirical estimates for different sequence lengths m are extracted and reported as the RB parameters.\n[label=protocol:standardRB]Prototypical RB\nLet $\\gset  \\subset \\U(d)$ be a subgroup,\n$\\rho \\in \\DM(\\CC^d)$ an initial state, and\n$\\mset = \\{\\mop, \\1-\\mop\\}\\subset \\PSD(\\CC^d)$ a measurement.\nFurthermore, let $\\mathfrak{M} \\subset \\mathbb N$ be\na set of sequence lengths.\n\nFor every sequence length $m \\in \\mathfrak{M}$, we perform the following procedure multiple times.\n\nDraw a\nsequence $g = (g_1, \\ldots, g_m)$ of $m$ group elements i.i.d. uniformly at random.\nCalculate the inverse elements $g_\\text{inv} =  g_1^{-1}g_2^{-1} \\cdots g_m^{-1}$ of the sequence.\n\nFor each sequence preform the following experiment:\n\n*  Prepare $\\rho$\n\n*  Apply\n$S_g = \\phi(g_\\text{inv})\\phi(g_m) \\ldots \\phi(g_2) \\phi(g_1)$, i.e. the\nsequence of  implementations of $g$ followed by the implementation of $g_\\text{inv}$, to $\\rho$.\n\n*  Perform the measurement $\\mset$.\n\nMultiple repetitions of the experiment yield an estimator $\\hat p_g$ for\nthe probabilities\n$$\n\\label{eq:RB:p_g}\np_g(m) = \\Tr\\left[M S_g \\rho\\right]\n\n$$\n\nRepeating these steps for different random sequences, we can calculate an estimator $\\hat p(m)$ for\n$$\n\np(m) = \\EE_{g_1}\\EE_{g_2} \\cdots \\EE_{g_m} p_{(g_1, g_2, \\ldots g_m)}(m).\n\n$$\n\nPost-processing: extract the decay parameters of the data $\\mathfrak M \\to [0,1]$, $m \\mapsto \\hat p(m)$ and report as the\nRB parameters.\n\nMore generally, RB protocols might go beyond Protocol\u00a0<ref> in various ways: for example, by calculating the inverse of a sequence only up to specific gates, using a different measure than the uniform measure for drawing the group elements of the sequence, or performing a measurement POVM with multiple outputs or measurements adapted to the sequence.\nIn addition, the post-processing might combine different RB data series in order to get simpler decay signatures.\n\nThe first step in the theoretical analysis of RB protocols is to establish the fitting model of the RB data $p(m)$.\nIdeally, $p(m)$ is well-approximated by a single exponential decay.\nSubsequently, the RB decay parameters can in certain settings be connected to the average gate fidelity of a noise process effecting the implementation map, as we now discuss.\n\nThe data model of most RB protocols can be understood as estimating the $m$-fold self-convolution of the implementation map [Unknown Author, \"Unknown Title\", ].\nMore precisely, for $\\phi, \\psi: \\gset \\to \\M(\\CC^d)$ we can define a convolution operation as\n$$\n\\label{eq:RB:convolution}\n\\phi \\ast \\psi(g) = \\EE_{\\tilde g} \\phi(g {\\tilde g}^{-1})\\psi(\\tilde g).\n\n$$\nNote that this definition naturally generalizes, e.g., the discrete circular convolution on vectors in $\\CC^n$, which can be seen as an operation on functions on the finite group $(\\ZZ_n, +) \\to \\mathbb \\CC$.\nWith the convolution (<ref>), we can rewrite the averages of the RB sequences as\n$$\n\n\\EE_{g} S_g &= \\EE_{g_1, g_2, \\ldots, g_m}\n\\phi(g_1^{-1}g_2^{-1} \\cdots g_m^{-1})\\phi(g_m) \\cdots \\phi(g_2)\\phi(g_1)\n\\nonumber\\\\ \\nonumber\n&= \\EE_{h_1, h_2, \\ldots, h_m}\n\\phi(h_m^{-1})\\phi(h_{m} h_{m-1}^{-1})  \\cdots\\phi(h_2h_1^{-1})\\phi(h_1) \\\\\n&= \\phi^{\\ast (m+1)}(\\id),\n\n$$\nwhere the replacements $h_1 = g_1$ and $h_j = g_j h_{j-1}$ for $j\\in \\{2, \\dots, m\\}$ have been made the second equality,\n$\\id$ denotes the identity element of $\\gset{}$ and $\\phi^{\\ast k}$ denotes the $k$-fold convolution of $\\phi$ with itself.\nIn expectation the RB data $p(m)$ is thus a contraction defined by $M$ and $\\rho$ of the $(m+1)$-fold self-convolution of $\\phi$ evaluated at the identity element.\n\nIn the simplest instance of an RB protocol one can directly calculate this expression:\nnamely, when $\\gset{}$ is a unitary $2$-design, the targeted implementation is simply the action of $\\gset{}$ as quantum gates, and the noise in $\\phi$ can be modeled by a single gate-independent quantum channel $\\Lambda \\in \\CPT(\\CC^d)$.\nDenoting by $\\mathcal G$ the (adjoint) action of $g$ as the unitary channel $X \\mapsto \\mathcal G (X) = g X g^\\ad$,\nwe have the noise model\n$$\n\\label{eq:gate_indep_noise}\n\\phi(g) = \\Lambda \\circ \\mcG \\,.\n\n$$\nWith this ansatz for $\\phi$ we can calculate that\n$$\n\\label{eq:RB:convolution2Design}\n\\EE_{g \\in {\\gset^m}} S_g = \\phi^{\\ast(m + 1)}(\\id) = \\Lambda \\left[\\EE_{g \\in \\gset} \\mcG^\\dagger \\Lambda \\mcG \\right]^m.\n\n$$\n\nThe operator $\\tw_\\mu: \\M(\\mathbb C^d) \\to \\M(\\mathbb C^d)$,\n$\\mathcal X \\mapsto \\EE_{U \\sim \\mu}[ \\mc U \\mc X \\mc U^\\ad ]$ appearing in (<ref>) is the so-called (channel) twirling map and appears\nin different contexts in quantum information.\nIf we write out the twirling map with the individual unitaries it reads\n$$\n\n\\tw_\\mu(\\X) = ( \\rho \\mapsto \\EE_{U \\sim \\mu}[ U \\X(U^\\ad ( \\rho)\\, U)U^\\ad ]\\, ).\n\n$$\nIt becomes apparent that $\\tw_\\mu$ is related to second moment operator $\\mo^{(2)}_\\mu$ from Eq.\u00a0(<ref>) by\na simple vector space isomorphisms.\nRecall that for a unitary $2$-design $\\mu$ Proposition\u00a0<ref> gives us an explicit description of $\\mo^{(2)}_\\mu$.\nWe can track the isomorphism to derive the following convenient expression.\n\n[label=thm:channel-twirling]Twirling of channels [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nLet $\\X \\in \\M(\\CC^d)$ be trace-preserving and $\\mu$ be a unitary $2$-design.\nThen\n$$\n\\label{eq:Xtw_depol}\n\\tw_\\mu(\\X)\n=\n\\depol[p(\\X)] \\, ,\n\n$$\nwhere $\\depol[p]$ is the depolarizing channel (<ref>) and $p(\\X)$ is the effective depolarizing parameter defined in Eq.\u00a0(<ref>).\n\nFirst we note that any map $\\X \\in \\M(\\CC^d)$ is uniquely determined by\n$(\\mc X \\otimes \\id)(\\FF)$, which is a similar construction as the Choi- isomorphism.\nThis isomorphism is given by $\\Tr_{2}[(\\mc X \\otimes \\id)(\\FF) (\\1\\otimes A)] = \\X(A)$\nbut its explicit form is not needed.\nHence, we can make the isomorphisms between the twirling map $\\tw_\\mu$ and the second moment operator $\\mo^{(2)}_\\mu$ from (<ref>) explicit by writing\n$$\n\n&(\\tw_\\mu(\\mc X) \\otimes \\id)(\\FF)\n\\nonumber\n\\\\\n&\\ =\n\\EE_{U \\sim \\mu}\n\\left[\n(U \\otimes \\1)\n\\X \\otimes \\id\n\\left(\n(U^\\ad \\otimes \\1) \\FF (U \\otimes \\1)\n\\right)\n(U^\\ad \\otimes \\1)\n\\right]\n\\nonumber\\\\\n&\\ =\n\\EE_{U \\sim \\mu}\n\\left[\n(U \\otimes \\1)\n\\X \\otimes \\id\n\\left(\n(\\1 \\otimes U) \\FF (\\1 \\otimes U^\\ad)\n\\right)\n(U^\\ad \\otimes \\1)\n\\right]\n\\nonumber\\\\\n&\\ =\n\\EE_{U \\sim \\mu}\n\\left[\n(U \\otimes U)\n\\X \\otimes \\id\n\\left(\n\\FF\n\\right)\n(U^\\ad \\otimes U^\\ad)\n\\right] \\nonumber\\\\\n&\\ = \\mo_\\mu^{(2)}(\\X \\otimes \\id (\\FF)) \\, .\n\n$$\nFor a unitary $2$-design $\\mu$, $\\mo_\\mu^{(2)}$ coincides with the second moment operator of the Haar measure.\nSchur-Weyl duality (Theorem\u00a0<ref>) tells us that\n$$\n\n\\mo_\\mu^{(2)}(\\X \\otimes \\id (\\FF)) \\in \\operatorname{span}\\{ \\1,  \\FF\\}\\, .\n\n$$\nObserving that $\\depol[0]\\otimes \\id(\\FF) = \\1 / d$ and trivially $\\depol[1] \\otimes \\id (\\FF) = \\FF$, we\nconclude that\n$$\n\n\\tw_\\mu(\\X) \\in \\operatorname{span}\\{ \\depol[0], \\depol[1]\\}\\, .\n\n$$\nFurthermore, one quickly checks that if $\\X$ is trace-preserving so is $\\tw_\\mu(\\X)$.\nHence, $\\tw_\\mu(\\X)$ is an affine combination of $\\depol[0]$ and $\\depol[1]$.\nThus,\n$\\tw_\\mu(\\X) = \\depol[p]$ holds for some $p \\in \\CC$ and it remains to determine $p$.\nOne way forward is a straight-forward calculation using the expressions for the coefficients provided by Proposition\u00a0<ref>.\nA shortcut is to calculate the effective depolarization of both sides.\nDue to the unitary invariance of $\\mu_{\\sphereCd}$, it follows from\n(<ref>) that\n$\\agf(\\X) = \\agf(\\tw(\\X))$\nand correspondingly for the affinely related effective depolarization parameter that $p(\\X) = p(\\tw(\\X))$.\nCombined with $p(\\depol[p]) = p$ from Eq.\u00a0(<ref>) yields the theorem's assertion.\n\nTheorem\u00a0<ref> allows us to explicitly calculate the RB data model from Eq.\u00a0(<ref>).\nTo this end, a short calculation reveals that $\\depol^m = \\depol[p^m]$.\nWith this we find\nthe RB data model to be\n$$\n\\label{eq:RBdata_derivation}\n\\begin{aligned}\np(m)\n&=\n\\Tr[\\tilde M\\Lambda \\depol[p(\\Lambda)^m] (\\tilde \\rho)]\n\\\\\n&=\np(\\Lambda)^m \\Tr[\\tilde M\\Lambda(\\tilde \\rho)] + (1-p(\\Lambda)^m) \\Tr[\\tilde M\\Lambda(\\1/d)]\n\\\\\n&=\np(\\Lambda)^m \\Tr[\\tilde M\\Lambda(\\tilde \\rho-\\1/d)] + \\Tr[\\tilde M\\Lambda(\\1/d)] \\, ,\n\\end{aligned}\n\n$$\nwith $\\tilde M$ and $\\tilde \\rho$ denoting the potentially faulty implementation of the measurement $M$ and initial state $\\rho$.\nIn terms of the so-called SPAM constants\n$$\n\n\\begin{aligned}\nA &\\coloneqq \\Tr[\\tilde M\\Lambda(\\tilde \\rho-\\1/d)] \\, ,\n\\\\\nB &\\coloneqq \\Tr[\\tilde M\\Lambda(\\1/d)] \\, ,\n\\end{aligned}\n\n$$\nwe obtain the simple RB fitting model\n$$\n\\label{eq:RB_fitting}\np(m) = A\\, p^m + B\\, .\n\n$$\nThus, fitting a single exponential decay to the estimator $\\hat p(m)$ yields estimates $\\hat p$, $\\hat A$ and $\\hat B$ for the model parameters $p$, $A$ and $B$.\nIn particular,\nthe estimated RB decay parameter $\\hat p$ is an estimator for the effective depolarizing parameter $p(\\Lambda)$ of the error channel $\\Lambda$.\nRecall that the effective depolarizing parameter is affinely related to the average gate fidelity (<ref>) via Eq.\u00a0(<ref>).\nFrom the RB decay parameter, we thus equivalently obtain an estimate for the average gate fidelity of the noise channel $\\Lambda$ as\n$$\n\\label{eq:RB:AGFestimation}\n\\hatagf\n= \\left(1 - \\frac1d\\right) \\hat p + \\frac1d.\n\n$$\nNote that the resulting estimate of the average gate fidelity (<ref>) is indeed robust against SPAM errors, which only enter the SPAM constants $A$ and $B$.\n\nDeriving rigorous performance guarantees for the estimator RB estimator $\\hat p$ is involved: it requires the analysis of confidence regions of the estimator $\\hat p_g(m)$ of the probability (<ref>) that is a random variable of the quantum measurement statistics and $\\hat p(m)$ obtained by the subsampling of the sequences $g$.\nFurthermore, the error of these estimators for each $m$ enters the errors of the fidelity estimator via the exponential fitting procedure.\nThis step depends on the choice of algorithm and the estimated sequence lengths.\n\nUsing the fact that $\\hat p(m)$ is the mean estimator of a bounded random variable, one can use Hoeffding's inequality (Theorem\u00a0<ref>)\nto derive confidence intervals for an overall sampling complexity that is independent of the number of qubits in the regime of high fidelity.\nSuch bounds however are prohibitively large for practical implementations.\nA refined analysis by Wallman and Flammia [Unknown Author, \"Unknown Title\", ] derived tighter  bounds for short sequences and small number of qubits.\nHowever, bounds that are practical and scalable in the number of qubits require a careful analysis of the variance of the estimator $\\hat p_g(m)$ over the choice of the random sequences.\nFor $\\gset{}$ being the Clifford group, Helsen et al. [Unknown Author, \"Unknown Title\", ] work out explicit variance bounds for the estimator $\\hat p_g(m)$ and derived sampling complexities for $\\hat p(m)$ that are practical, independent of the number of qubits and scale favorable with the sequence length.\nTo this end,\nthey\nemployed a refined representation theoretical analysis of the commutant of the $4$-th order diagonal action of the Clifford group [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] in order to calculate the corresponding moment operator; an endeavor that is complicated by the fact that the Clifford group itself is not a unitary $4$-design.\n\nA rigorous analysis of a simplified fitting procedure was derived in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nTherein (again using trivial bounds on the variance) the authors show that a ratio estimator for the infidelity $r = 1 - p$ that employs the estimates of $p(m)$ for two different sequence length has multiplicative error using an efficient number of samples again in the regime of high fidelity.\n\nAll of these performance guarantees indicate that in principle RB protocols can be efficiently scalable in the number of qubits.\nTo ensure also an efficient classical pre-processing of the prototypical RB protocol it is\nimportant to have an efficiently tractable group structure so that the inverse of the gate sequence can be computed.\n\nFor the important example of the Clifford group, the Gottesman-Knill theorem, see e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ], allows the efficient computation the inverse of a sequence $g_m \\cdots g_2 g_1$ in polynomial time (w.r.t. the number of qubits).\nFurthermore, since the Clifford group is a unitary $3$-design [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ],\nit meets the requirement of Theorem\u00a0<ref>.\nFor this reason the presented analysis applies to the Clifford group under the assumption of gate-independent noise.\n\nIt is natural to ask of additional examples\nof groups that constitute a unitary $2$-design and are covered by the presented analysis without modifications.\nBut it has been established that these two requirements are already surprisingly restrictive. A complete classification of so-called $2$-groups ($2$-design groups) is summarized in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nIn fact, if one requires a family of $2$-groups that can be constructed for an arbitrary number of qubits, one is left with subgroups of the Clifford group or $\\SU(d)$ itself as the only examples [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nWe provide more details how the analysis of the prototypical RB protocol can be generalized in the further-reading paragraph at the end of the section.\nNow, we want to discuss another variant of RB that is particularly important as tool for certifying quantum gates.\n\nInterleaved randomized benchmarking\n\nThe prototypical RB protocol yields estimates of the effective depolarizing parameter or the average gate fidelity of the average error channel of a gate set.\nIn contrast, interleaved RB protocols  [Unknown Author, \"Unknown Title\", ] allow one to extract the effective depolarizing parameter of individual gates from a group with respect to their ideal implementation provided the noise is sufficiently incoherent.\n\nIn an interleaved RB protocol one performs in addition to\nthe standard RB protocol a modified version, where the random sequences\nare interleaved with the specific target gate.\nThe second experiment yields estimates for the effective depolarization parameter of the error channel associated to the group concatenated\nwith the error channel of the individual target gate.\nUnder certain assumptions the effective depolarization parameter of the implementation of the target gate can\nbe estimated from the decay parameters of both RB protocols.\n\n[label=protocol:modifiedRB]Interleaved RB\nFor $\\gset\\subset \\U(d)$ and a target gate $\\gt\\in \\gset$\n\n*  follow Protocol\u00a0<ref>,\n\n*  follow Protocol\u00a0<ref> but modify the sequences to be\n$$\n\ng = (g_1, \\gt, g_2, \\gt, g_3, \\ldots, \\gt , g_m),\n\n$$\nwhere $\\gt$ is the target gate and $g_i \\in \\gset$ for $i \\in [m]$ are drawn uniformly at random.\nThe inverse $g_\\text{inv}$ is also calculated w.r.t. the modified sequence $g$.\n\nThe output of the protocol are the decay parameters of both experiments.\n\nFor the analysis we again consider a `mostly' gate-independent noise model and assume that $\\gset$ is a unitary $2$-design.\nIn the noise model we assume that the same noise channel\n$\\Lambda \\in \\CPT(\\H)$\nfollows the ideal implementation of all gates but the target gate, i.e.,\n$$\n\\label{eq:tildeG}\n\\phi(g) = \\Lambda \\circ \\mathcal G\n\n$$\nfor all $ g \\in \\gset \\setminus \\{\\gt\\}$.\n\nThe first step of the protocol is the unmodified RB protocol.\nIf we neglect that $\\phi$ deviates from the form Eq.\u00a0(<ref>) on $\\gt$,\nwe can apply the analysis of the previous section for gate-independent noise and\nconclude that the protocol outputs and estimator for the effective depolarizing constant $p(\\Lambda)$.\nFor example, for a large group it is plausible to neglect the contribution of the noise associated to the $\\gt$ gate to the group average.\n\nIt remains to analyze the second protocol.\nIn analogy to Eq.\u00a0(<ref>) we can in general rewrite\n\n_g_1, \u2026, g_m   S_g\n\n= _g_1, \u2026, g_m   \u03d5(g_1^-1^-1g_2^-1^-1\u2026 g_m^-1)\n\u00d7\u03d5(g_m) \u03d5() \u2026\u03d5(g_2) \u03d5() \u03d5(g_1)\n\n= _g_1, \u2026, g_m   \u03d5(g_m^-1)\u2026\n\u00d7\u03d5(g_3g_2^-1^-1)\u03d5()\u03d5(g_2g_1^-1^-1)\u03d5()\u03d5(g_1),\n\nby substituting $g_i$ with $g_i g_{i-1}^{-1} \\gt^{-1}$ for all $i > 1$.\n\nInserting the noise model\u00a0(<ref>) yields\n$$\n\\begin{split}\n\\EE_{g_1, \\ldots, g_m} S_g %\n= \\Lambda \\left[%\n\\EE_{g \\in \\gset{}}\\,%\n\\mcG^\\ad \\Gt^\\ad \\phi(\\gt)\\Lambda\\mcG%\n\\right]^m%\n\\end{split}\n$$\n\nThis is the same expression as Eq.\u00a0(<ref>) with $\\Lambda$ replaced by $\\Gt^\\ad \\phi(\\gt) \\Lambda$.\nHence, applying the same arguments as in the analysis of the standard RB protocol for unitary $2$-designs yields\na single-exponential fitting model with\ndecay parameter estimating the effective depolarizing parameter $p(\\Gt^\\ad\\phi(\\gt) \\Lambda)$.\nThe second part of the interleaved RB protocol, thus, yields an estimate of the effective depolarizing parameter or equivalently, via Eq.\u00a0(<ref>), of the fidelity of the error map $\\Gt^\\ad\\phi(\\gt)$ of the target gate $\\Gt$ concatenated with the error channel $\\Lambda$.\n\nFrom $p(\\Lambda)$ and $p(\\Gt^\\ad\\phi(\\gt)\\Lambda)$ it is indeed possible to infer $p(\\Gt^\\ad\\phi(\\gt))$.\nIn meaningful practical regimes this however requires additional control the unitarity of $\\Lambda$ [Unknown Author, \"Unknown Title\", ]:\nfor sequences of unitary channels the infidelity of their composition can scale quadratically in the sequence length in leading order.\nIn contrast, highly non-unitary channels will feature a close to linear scaling in the sequence length.\nThus, using the unitary one can derive bounds for fidelity measures of\ncomposite channels that exploit the linear scaling.\nWe simply state the required bound without proof for interleaved RB:\n[label=thm:comp-channel-bound,fonttitle=]Composite channel bound [Unknown Author, \"Unknown Title\", ]\nFor any two quantum channels $\\mc X, \\mc Y$ it holds that\n$$\n\\label{eq:comp-channel-bound}\n\\left| p(\\mc X)\n- \\frac\n{p(\\mc X\\mc Y)p(\\mc Y)}\n{u(\\mc Y)}\n\\right|\n\\leq\n\\sqrt{\n1 - \\frac\n{p(\\mc Y)^2}\n{u(\\mc Y)}\n}\n\\sqrt{\n1 - \\frac\n{p(\\mc X \\mc Y)^2}\n{u(\\mc Y)}\n}\n\n$$\n\nWith an estimate for the unitarity $\\hat u(\\Lambda)$, Theorem\u00a0<ref> allows the estimation of the effective depolarizing constant and thus the average gate fidelity of the target gate by\n$$\n\n\\hatagf(\\phi(\\gt), \\Gt)\n=\n\\frac{d - 1}d \\, \\frac{\\hat p(\\Gt^\\ad \\phi(\\gt))\\hat p(\\Lambda)}{\\hat u^{\\Lambda}} + \\frac1d\n\n$$\nup to a systematic error that is given by evaluating the right-hand side of Eq.\u00a0(<ref>).\nThe systematic error is small in the regime where $u(\\Lambda) \\approx p(\\Lambda)^2$ which is the case if $\\Lambda$ is decoherent.\nThe unitarity of $\\Lambda$ can be estimated using variants of the RB protocol itself developed in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nAlternatively, one can just assume that the error is sufficiently incoherent, i.e. that $| 1 - p(\\Lambda)^2 / u(\\Lambda)| \\leq \\epsilon$.\nConditioned on this external belief, one obtains the simpler estimator\n$$\n\n\\hatagf(\\phi(\\gt), \\Gt)\n=\n\\frac{d - 1}d \\, \\frac{\\hat p(\\Gt^\\ad \\phi(\\gt))}{\\hat p(\\Lambda)} + \\frac1d\n\n$$\nthat comes with a systematic error that is controlled in $\\epsilon$.\nThereby, interleaved RB can be used to arrive at average-performance certificates of individual quantum gates.\n\nWe have already seen that for interleaved RB controlling the unitarity is helpful in deriving tighter error bounds.\nIn addition, estimating the unitarity can also yield relevant worst-case performance bounds in terms of the average gate fidelities using Theorem\u00a0<ref>.\n\nFurther reading\n\nRandomized benchmarking was originally developed in a series of work focusing on the unitary group and Clifford gates [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe early analyses used the gate-independent noise model (<ref>), which we also assume here.\nIn many applications this is however a questionable assumption.\nAfter first perturbative approaches to derive the RB signal model under gate-dependent noise by Magesan et al.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and Proctor et al.\u00a0[Unknown Author, \"Unknown Title\", ], Wallman rigorously derived the fitting model for unitary $2$-designs in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nUsing the elegant description of the RB data as the $m$-fold convolution of the implementation map, recently proposed by Merkel et al.\u00a0[Unknown Author, \"Unknown Title\", ], one can abstractly understand the result as follows: as the standard discrete circular convolution, the convolution operator of maps on a group can be turned into a (matrix) multiplication using a Fourier transform.\nThis abstract Fourier transform for functions on the group is defined to be a function on the irreducible representations of the group.\nIn the case of RB, this function is matrix-valued, and we observe matrix powers of the Fourier transforms for every irreducible representation superimposed by a linear map.\nFor every irreducible representation, for sufficiently large $m$, the matrix powers are proportional to the $m$-th power of the largest eigenvalue of the matrix-valued Fourier transformation. Contributions from other eigenvalues are suppressed.\nIn this sense RB is akin to the power method of numerical linear algebra but in Fourier space [Unknown Author, \"Unknown Title\", ].\nA rigorous analysis requires to perturbatively bound the contribution of the subleading eigenvalues.\nFor unitary $2$-groups the adjoint representation decomposes into two irreducible representations,\nthe trace representation and the unital part of the quantum channel. For close to trace-preserving maps the trace representation will only contribute a very slow decay, i.e. a constant contribution to the fitting model, and the RB decay parameter is the dominant eigenvalue of the unital representation.\nWallman [Unknown Author, \"Unknown Title\", ] derived norm bounds for the contribution of subleading eigenvalues and showed that the contribution is exponentially suppressed with the sequence length.\nFurthermore, Wallman showed that there is a gauge choice of the gate set such that the decay parameter can be connected to the average gate fidelity of the average error channel over the gate set.\nFor qubits this gauge was demonstrated to yield a physical gate set by Carignan-Dugas et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nThe physicality of this gauge is, however, in general not guaranteed and a counter example is given by Helsen et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nAs discussed by Proctor et al.\u00a0[Unknown Author, \"Unknown Title\", ], this complicates the interpretation of the RB decay rates as related to average fidelities that have a clear physically interpretation.\n\nWhile the Clifford gates are definitely a prominent use case in the benchmarking of digital quantum computers, more flexible RB protocols require analyzing groups that are not a unitary $2$-design.\n\nRandomized benchmarking protocols for other groups were developed in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThese protocols, for example, allow inclusion of the $T$-gate in the gate set [Unknown Author, \"Unknown Title\", ] or characterization of leakage between qubit registers by using tensor copies of the Clifford group [Unknown Author, \"Unknown Title\", ].\nAs the adjoint representation of other groups typically decomposes into multiple irreducible representation, RB data is expected to feature multiple decays in general.\nFor a description of a flexible post-processing scheme for general RB type data and performance guarantees see Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn order to isolate the different decays, multiple RB variants have been developed.\nThese either rely on directly preparing a state that has high overlap with only one irreducible representation or cleverly combining data from different RB experiments to achieve the same effect.\nMany of these techniques can be understood as variants of the character benchmarking protocol developed by Helsen et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nCharacter benchmarking uses inversions of the RB sequence not to the identity but randomly drawn gates from the group.\nIn the classical post-processing data sequences of different end gates are linearly combined by weighting them according to the character formulas.\nThereby, the data is projected onto the irreducible representation of the respective character and can be subsequently fitted by a single decay.\n\nInterleaved RB was proposed in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and demonstrated in practice.\nAlready standard RB provides a trivial bound for individual gates of the group by simply\nattributing the average error to a single gate.\nIn the original proposal of interleaved RB, the analysis\ndoes not allow for rigorous certificates that go significantly beyond this trivial bound for\nfew qubits [Unknown Author, \"Unknown Title\", ].\nA general bound by Kimmel et al.\u00a0[Unknown Author, \"Unknown Title\", ], was considerably refined using the unitarity by Carignan-Dugas et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nThereby it was established that if the error channel is sufficiently incoherent interleaved RB yields\nrigorous certificates for individual gates with reasonable error bars.\nThere exist multiple variants of the interleaved RB scheme [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nAnother class of interleaved RB was introduced in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. Here, the average gate fidelity of individual gates is inferred from measurements of random sequences of gates that are drawn from the symmetry group of the gate. The individual gates are not part of the group itself and are also not included in the inversion of the sequence.\n\nAnother practically very interesting variation of RB arises when one does not draw the gates from the uniform but another distribution over the group [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nFor example, drawing the sequences randomly from the generating gates of the group, reduces the required sequence lengths [Unknown Author, \"Unknown Title\", ].\n\nOther quantities that can be measured by variants of the RB protocols are the unitarity [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], measures for the losses, leakage, addressability and cross-talk [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Furthermore, RB of operations on the logical level of an error correcting quantum architecture was proposed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nCombining different relative average gate fidelities obtained by interleaved RB schemes can be used to acquire tomographic information about the error channel providing actionable advise to an experimentalist beyond a mere benchmarking and certification [Unknown Author, \"Unknown Title\", ].\nUsing SPAM-robust data, these tomography schemes are in addition resource optimal for the unitary gates [Unknown Author, \"Unknown Title\", ] and Clifford gates [Unknown Author, \"Unknown Title\", ].\nFor Pauli channels tomographic information can be efficiently obtained performing a character RB protocol on multiple qubits simultaneously [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nA general framework with few theorems that establishes the RB fitting model of essentially all known RB schemes under gate-dependent noise is developed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nThe central assumption employed therein to control contributions from subdominant eigenvalues of the Fourier transformation is a closeness condition to a reference representation in diamond norm averaged over all group elements.\nMoreover, a unifying review of RB is provided.\n\n### Cross-entropy benchmarking\nThe final protocol we discuss in this tutorial is XEB [Unknown Author, \"Unknown Title\", ].\nXEB gained importance recently:\nit was used in order to experimentally collect evidence that a quantum computer can perform a task that basically no existing classical computer can solve in a reasonable amount of time [Unknown Author, \"Unknown Title\", ].\n\nIn Ref.\u00a0[Unknown Author, \"Unknown Title\", ] XEB is performed in two distinct variants:\none variant aims at extracting fidelity measures averaged over random sequences of individual gates.\nThis protocol can be regarded as a special case of the character randomized benchmarking protocol [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nthat we have touched upon in Section\u00a0<ref>.\nThe second variant aims at certifying the correct sampling from the measurement output distribution of a single specific circuit.\nThis second variant of XEB is the focus of this section.\nIt can be seen as an instance of a certification protocol on the application layer of a digital quantum computer.\nIn consequence, it is commonly also referred to as a verification protocol for sampling tasks.\nBut the application, sampling from a distribution encoded in a quantum circuit,\nis deliberately chosen very close to the physical layer.\n\nXEB was proposed as a protocol in the context of demonstrating quantum supremacy.\nExperimentally demonstrating that a quantum computer can outperform current classical computers in some task is regarded as one of the\nmayor milestones in developing quantum computing technologies.\nThe accuracy of the quantum operations and numbers of qubits of today's\ndevices do not permit instances of interesting quantum algorithms\nthat solve problems without known efficient algorithms, such as Shor's algorithm for integer factorization,\nat least not problem instances that come even close to being troublesome for a classical computer [Unknown Author, \"Unknown Title\", ].\nThis motivated the proposal of demonstrating quantum supremacy in\nthe task of generating samples from a probability distribution that is specified as the measurement distribution of a quantum circuit.\nThis is a task that a quantum computer solves very naturally even though it might not be of any practical use [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nAt the same time one can prove that certain random ensembles of quantum circuits yield probability distributions that can not be efficiently sampled from on a classical computer [Unknown Author, \"Unknown Title\", ].\n\nBesides establishing evidence for the hardness of solving the sampling task on a classical computer,\na crucial ingredient in demonstrating\nquantum supremacy\nis a certification protocol that\nguarantees that one has implemented the correct distribution.\n\nThe approach taken in Ref.\u00a0[Unknown Author, \"Unknown Title\", ] is to\nbuild trust in the correct functioning of the device for\ncircuits that are still amenable to calculating a couple of outcome probabilities on a classical super-computer.\nTo this end, the XEB protocol was used.\nThe measures that XEB tries to estimate are the cross-entropy difference and its variant the cross-entropy fidelity.\n\nCross-entropy and cross-entropy fidelity\n\nIn the context of certifying a sampling task it is natural to directly consider\nmeasures of quality that compare two probability densities describing the measurement outcomes.\nWhile the measures we have studied in this tutorial so far are concerned with the physical layer,\nmeasures directly comparing two probabilities can be regarded as measures on the application layer.\n\nFor a quantum circuit $U$ acting on $n$ qubits, we denote its measurement probability mass function in a basis $\\{\\ket x\\}_{x \\in [d]}$ after preparing a fixed initial state $\\ket \\psi$ by $p_U: [d] \\to [0,1]$ with\n$$\n\\label{eq:def:measdist}\np_U(x) = \\left|\\sandwich x U \\psi \\right|^2.\n\n$$\n\nA well-known statistical measure [Unknown Author, \"Unknown Title\", ] to relate two\nprobability mass functions $q, p: [d] \\to [0,1]$ is the cross-entropy\n$$\n\nH_X(q,p) = - \\sum_{x \\in [d]} q(x) \\ln(p(x)).\n\n$$\nFor $p=q$ we find that $H_X(q,q) = -\\sum_{x} q(x) \\ln( q(x)) \\eqqcolon H(q)$ is the standard Shannon entropy.\nOne can show that $H(q)$ is the minimal value of the cross-entropy $H_X(q,p)$, a relation known as Gibbs' inequality [Unknown Author, \"Unknown Title\", ].\n\nIn the context of quantum supremacy demonstrations one expects the target probability distribution that one aims to implement to\nbe of Porter-Thomas shape.\nWe say that a probability mass function $p: [d] \\to [0,1]$ is of Porter-Thomas shape if\nthe tail distribution of $p(x)$ regarded as a random variable for $x$ drawn uniformly at random from $[d]$\nis well-approximated by an exponential decay function,\n$$\n\\label{eq:xeb:porter-thomas}\n\\PP_{x \\sim p_\\mathrm{uni}}[p(x) > p] \\approx \\e^{-d p}\\, ,\n\n$$\nwhere $p_\\mathrm{uni}$ denotes the uniform distribution.\nNote that while the left-hand side of Eq.\u00a0(<ref>) is discontinuous, the right-hand side allows\nus to approximately think of the distribution of $p(x)$ as being described by the continuous probability density\n$p_\\mathrm{PT}(p) = d\\e^{-d p}$ of the Porter-Thomas distribution [Unknown Author, \"Unknown Title\", ].\nWe use this description in our theoretical analysis multiple times.\n\nThe motivation to study distributions of Porter-Thomas shape stems from considering Haar random unitaries in place of the quantum circuit $U$ and is further illuminated in the following exercise.\n\nDensities of Porter-Thomas shape [Unknown Author, \"Unknown Title\", ]\nFor $U \\in \\U(d)$ drawn from the Haar measure $\\mu_{\\U(d)}$\none can show that the squared absolute value $p = |U_{ij}|^2$ of its matrix entries $\\{U_{ij}\\}$ have the probability density function\n$p_\\mathrm{abs}(p) =\n(d - 1)(1-p)^{d-2}$.\nIn the limit of $d \\gg 1$, $p_\\mathrm{abs}(p)$ is described by the Porter-Thomas distribution [Unknown Author, \"Unknown Title\", ]\n$$\n\\label{eq:p_PT}\np_{\\mathrm{PT}}(p) = d\\exp(-dp) \\, .\n\n$$\n\nArgue that for a fixed $U$ and again in the limit of large $d$\nthe probability mass function $p_U$ is of Porter-Thomas shape.\n\nAssuming that $p_U$ is of Porter-Thomas shape, show that\n$$\n\\label{ex:porter-thomas:hxpp}\n% H_X(p_U, p_U) =\nH(p_U) &= \\ln(d) + \\gamma - 1, \\\\\n\\label{ex:porter-thomas:hxup}\nH_X(p_\\mathrm{uni}, p_U) &= \\ln(d) + \\gamma,\n\n$$\nwhere $\\gamma$ is the Euler\u2013Mascheroni constant and $p_\\mathrm{uni}(x) = 1 / d$ is the uniform probability mass function.\n\nHint: Recall the definite integral formulas $\\int_0^\\infty p \\ln(p)\\, \\e^{-p} \\rmd p = 1 - \\gamma$ and $\\int_0^\\infty \\ln(p)\\, \\e^{-p} \\rmd p = \\gamma$.\nThe motivation to study distributions of Porter-Thomas shape stems\nfrom considering Haar random unitaries in place of the quantum circuit $U$ and is further illuminated in the following box.\n\nDensities of Porter-Thomas shape\nFor $U \\in \\U(d)$ drawn from the Haar measure $\\mu_{\\U(d)}$\none can show that the squared absolute values of its matrix entries have the probability density function\n$p_\\mathrm{abs}(p) =\n(d - 1)(1-p)^{d-2}$.\nIn the limit of $d \\gg 1$, $p_\\mathrm{abs}(p)$ is described by the Porter-Thomas distribution [Unknown Author, \"Unknown Title\", ]\n$$\n\\ifex\\else\\label{eq:p_PT}\\fi\np_{\\mathrm{PT}}(p) = d\\exp(-dp)\\, .\n\n$$\nNote the similarity with the density of the $\\chi^2$-distribution with $2$ degrees of freedom.\nFor fixed $U$\nand again in the limit of large $d$,\none can hence argue that\nthe probability mass function $p_U$ is of Porter-Thomas shape [Unknown Author, \"Unknown Title\", ].\n\nAssuming that $p_U$ is of Porter-Thomas shape, Boxio et al.\u00a0[Unknown Author, \"Unknown Title\", ] showed that\na straightforward calculation reveals\n$$\n\\ifex\\else\\label{ex:porter-thomas:hxpp}\\fi\nH_X(p_U, p_U) = H(p_U) &= \\ln(d) + \\gamma - 1, \\\\\n\\ifex\\else\\label{ex:porter-thomas:hxup}\\fi\nH_X(p_\\mathrm{uni}, p_U) &= \\ln(d) + \\gamma,\n\n$$\nwhere $\\gamma$ is the Euler\u2013Mascheroni constant and $p_\\mathrm{uni}(x) = 1 / d$ is the uniform probability mass function.\n\nThe introduction of the so-called cross-entropy difference\nas a performance measure in quantum supremacy sampling tasks\nbrought the cross-entropy into focus.\n\nCross-entropy difference\nRef.\u00a0[Unknown Author, \"Unknown Title\", ] introduced the cross-entropy difference as a performance\nmeasure in sampling tasks\n$$\n\\label{eq:dxe}\n\\dxe(q, p) \\coloneqq H_X(p_\\mathrm{uni},p) - H_X(q, p)\\, ,\n\n$$\nwhere $p_\\mathrm{uni}$ is the uniform distribution.\nThe cross-entropy difference, thus, measures the excess in cross-entropy that $q$ has with $p$ beyond the uniform distribution.\n\nIn the previous box we argue that for Haar-random unitaries the corresponding measurement densities\n$p_U$ are generically of Porter-Thomas shape.\nThe motivation of the cross-entropy difference is highly relying on this observation.\nBy definition, we have that $\\dxe(p_\\mathrm{uni}, p) = 0$ for any $p$.\nIf $p$ is of Porter-Thomas shape, Eqs.\u00a0(<ref>) and (<ref>) show that $\\dxe(p, p) = 1$.\nNote however that there still exist probability distributions that score even higher in cross-entropy difference than\n$p$ itself.\n\nAnother measure introduced in this context\nis the cross-entropy fidelity [Unknown Author, \"Unknown Title\", ]\n$$\n\\label{eq:XEF}\nF_X(q, p_U) = \\sum_{x \\in [d]} q(x) (d p_U(x) - 1 ).\n\n$$\n\nBefore discussing the XEB protocol to estimate $H_X$ and $F_X$ let us illuminate the\nmotivation of $F_X$ in the context of certifying sampling tasks.\n\nFirst, the cross-entropy fidelity can be regarded as a linear proxy to the cross-entropy difference\nand, as such, as a simpler version of it.\nThe shift of minus one in the definition of $F_X$ is chosen such that\n$F_X(p_\\text{uni}, p) = 0$ for $p_\\text{uni}$ the uniform density and any probability density $p$.\nIf $p_U$ is assumed to be of Porter-Thomas shape\none can calculate that $F_X(p_U, p_U) = 1$.\nThis motivates the expectation that performing high in cross-entropy fidelity indicates successfully\nsolving the sampling task for typical random circuits $U$.\n\nNote that if $U$ is drawn at random from a unitary $2$-design $\\mu$,\nwe can reproduce the Porter-Thomas value of $F_X(p_U, p_U)$ in expectation over $U$ using Lemma\u00a0<ref>:\nwe first calculate\n$$\n\\nonumber\n\\EE_{U\\sim \\mu}\\left[p^2_U(x) \\right] %\n&= \\EE_{U\\sim \\mu}\\myleft[ |\\sandwich x U \\psi|^4\\myright]\n\\\\\\nonumber\n&= {\\bra x}^{\\otimes 2} \\,\n\\EE_{U\\sim \\mu}\n\\myleft[ (U \\ketbra\\psi\\psi U^\\dagger)^{\\otimes 2} \\myright]\n{\\ket x}^{\\otimes 2}\n\\\\\\nonumber\n&= \\frac{{\\bra x}^{\\otimes 2} P_{\\sym^2} {\\ket x}^{\\otimes 2}}{\\Tr(P_{\\sym^2})} \\\\\n&= \\frac2{d(d+1)}\n\\label{eq:xeb:fx:exp}\n\n$$\nande hence find that\n$$\n%\n\\begin{split}%\n\\EE_{U\\sim \\mu} [F_X(p_U, p_U) ]\n&= \\sum_{x \\in [d]} d\\, \\EE_{U\\sim \\mu}\\myleft[p^2_U(x)\\myright] - 1 \\\\\n&= \\frac{2 d}{d + 1} - 1 =\\frac{d-1}{d+1}\n\\\\\n&= 1 + \\LandauO(1/d) \\, .\n\\end{split}\n\n$$\nThus, if $U$ is drawn from a distribution, where we have suitable control over higher moments we can hope to\nproof concentration around the expectation with high probability for large $d$.\nFor Haar random unitaries Levy's lemma [Unknown Author, \"Unknown Title\", ] directly yields a corresponding statement.\n\nFor the moment, we leave this as a motivation for the estimating $F_X$ and $H_X$ and\nturn to the XEB protocol.\n\nCross-entropy benchmarking protocol\n\nThe crucial structural insight of XEB is that $F_X$ and $H_X$ are both of the form\n$$\n\\label{eq:xeb:fform}\nE_f = \\sum_{x \\in [d]} q(x) f(p_U(x))\n\n$$\nwith $f(p) = f_F(p) = d p - 1$ for the cross-entropy fidelity and $f(p) = f_H(p) = -\\ln(p)$ for the cross-entropy.\nThis observation suggests a simple protocol, akin to importance sampling (Section\u00a0<ref>), for empirically estimating both quantities if we have access to samples of one of the distributions.\n\n[label=protocol:xeb]XEB [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nLet $U$ be a description of a quantum circuit, $\\ket{\\psi} \\in \\CC^d$ be an initial states and $\\mathcal B = \\{\\ket x\\}_{x \\in [d]}$ an orthonormal basis of $\\CC^d$.\n\n*  Prepare $U\\ket{\\psi}$ on a quantum computer and measure in the basis $\\mathcal B$ a number of $m$ times to collect the measurement outcomes $\\mathcal O = (\\tilde x_1,\\ldots, \\tilde x_m) \\in [d]^m$.\n\n*  Calculate on a classical computer for each $\\tilde x \\in \\mathcal O$ the value of $p_U(\\tilde x)$.\n\n*  Return the estimator\n$$\n\n\\hat E_f = \\frac1{|\\mathcal O|}\\sum_{\\tilde x \\in \\mathcal O} f(p_U(\\tilde x)),\n\n$$\nwhere $f$ is $f_F$ or $f_H$ for estimating the cross-entropy fidelity or cross-entropy, respectively.\n\nIt is important to keep in mind that step\u00a0<ref>\nrequires that a classical computer can compute individual probabilities of the circuit.\nFor this reason, XEB cannot be used directly for circuits that are not classically simulable.\nInstead, one can investigate the performance on restricted subclasses of circuits that are still tractable on a\npowerful classical computer and from these results extrapolate the performance in the regime where one expects quantum\nsupremacy.\n\nIf we assume that the target distribution $p_U$ is defined using a Haar-randomly drawn unitary $U$, we can derive a guarantee for Protocol\u00a0<ref> for\nthe linear cross-entropy using the techniques that we presented in this tutorial.\nSuch a guarantee was derived by Hangleiter\u00a0[Unknown Author, \"Unknown Title\", ].\n\n[label=thm:XEBsampling]Linear XEB sampling complexity [Unknown Author, \"Unknown Title\", ]\nLet $U \\in \\U(d)$ be a Haar random unitary, $\\ket{\\psi}\\in \\CC^d$ and $\\mathcal B = \\{\\ket x\\}_{x=1}^d \\subset \\CC^d$ an orthonormal basis. Denote by $p_U$ the associated measurement probability mass function (<ref>) and by $\\tilde p_{U}$ the implemented probability mass function.\nChoose $\\epsilon, \\delta > 0$ and\n$$\n\nm \\geq \\frac{\\e^2}{2\\epsilon^2} \\ln^2\\left(\\frac{2d}\\delta\\right)\\, \\ln\\left(\\frac2\\delta\\right) \\, .\n\n$$\nThen, Protocol\u00a0<ref> returns with confidence $1-\\delta$\nan unbiased $\\epsilon$-accurate estimator $\\hat E_f$ for\n$F_X(\\tilde p_U, p_U)$.\n\nThe proof of the theorem relies on bounding the range of the random variable $p_U(\\tilde x)$ and applying\nthe Hoeffding's inequality (<ref>).\nWe have already seen that for $U$ drawn from the Haar measure, $p_U$ is asymptotically of Porter-Thomas shape.\nIn particular, large probabilities in $p_U$ are exponentially suppressed.\nFor this reason, we expect that with high probability over the choice of $U$,\n$p_U(x)$ will be bounded for all $x$.\nThe following lemma makes this expectation explicit.\n\n[label=lem:PUbound]$p_U$ is bounded w.h.p.\nLet $U \\in \\U(d)$ be a Haar random unitary and $\\{\\ket x\\}_{i=1}^d$ be\nan orthonormal basis of $\\CC^d$.\nThen,\nthe measurement probability mass function $p_U: [d] \\to [0,1]$, $p_U(x) = \\left|\\sandwich x U 0 \\right|^2$, fulfills\n$p_U(x) \\leq b$ for all $x$ with probability of at least\n$1 - d \\e^{- d b / \\e}$.\n\nOne way to prove the lemma is via the Porter-Thomas density (<ref>).\nWe follow a more self-contained strategy by calculating the moments of $p_U$.\nThen, the bound on the moments can be translated to an exponential tail bound\nusing the following consequence of Markov's inequality.\n\n[label=thm:subexponentialtailbound]Sub-exponential tail bound, e.g. [Unknown Author, \"Unknown Title\", ]\nLet $X$ be a random variable satisfying\n$$\n\n\\EE[|X|^k]^{1/k} \\leq \\alpha \\beta^{1/k} k\n\n$$\nfor all $k \\geq 2$.\nThen, for all $t \\geq 2$,\n$$\n\n\\Pr[|X| \\geq \\e \\alpha t ] \\leq \\beta \\e^{-t}\\, .\n\n$$\n\nApplying Markov's inequality (<ref>) and the theorem's assumption gives for $k \\geq 2$\n$$\n\n\\begin{split}\n\\Pr[|X| \\geq \\e \\alpha t] &= \\Pr[|X|^k \\geq (\\e \\alpha t)^k]  \\\\\n&\\leq \\frac{\\EE[|X|^k]}{(\\e \\alpha t)^k} \\leq \\beta \\e^{-k} \\left(\\frac kt\\right)^k \\, .\n\\end{split}\n\n$$\nNow choosing $k = t$ yields the claim.\n\nWe start by calculating the moments of $p_U(x)$ as a random variable depending on $U \\sim \\mu_{\\U(d)}$.\nFirst note that by definition $p_U(x) = \\left|\\sandwich x U 0\\right|^2 = \\left|\\braket x \\psi\\right|^2$ with $\\psi$ drawn uniformly from the sphere $\\sphereCd{}$.\nUsing the moment operator $K^{(k)}_{\\mu_{\\sphereCd}}$ for $\\ket\\psi \\sim \\mu_{\\sphereCd}$, Lemma\u00a0<ref> and (<ref>), we find that for all $x \\in [d]$\n$$\n\n\\begin{split}\n&\\!\\!\\!\\!%\n\\EE_{U \\sim \\mu_{\\U(d)}}[ p_U(x)^{k}] \\\\\n&= \\EE_{\\ket\\psi \\sim \\mu_{\\sphereCd{}}}\\left[ {\\bra x}^{\\otimes k} (\\ketbra\\psi\\psi)^{\\otimes k} {\\ket x}^{\\otimes k}  \\right] \\\\\n&= {\\bra x}^{\\otimes k} K^{(k)}_{\\mu_{\\sphereCd}} {\\ket x}^{\\otimes k}   \\\\\n&= \\frac{k! (d-1)!}{(k + d - 1)!} (\\bra x)^{\\otimes k} P_{\\sym^k} {\\ket x}^{\\otimes k} \\\\\n&=  \\frac{k! (d-1)!}{(k + d - 1)!} \\norm{\\ket x}^{k} =\n\\binom{k + d - 1}{k}^{-1} .\n\\end{split}\n\n$$\nDue to the inequality $\\binom{n}{k} \\geq (n/k)^k$, it holds for $k \\geq 1$ that\n$\\binom{d + k - 1}k \\geq \\left( \\frac{d + k - 1}k \\right)^k \\geq (d / k)^k$ and,\nthus,\n$$\n\n\\EE_{U \\sim \\mu_{\\U(d)}}[ p_U(x)^k] = \\binom{k + d -1}k^{-1} \\leq k^k d^{-k}\\, .\n\n$$\nBy Theorem\u00a0<ref>, this moment bound translates into the tail bound\n$$\n\n\\Pr[p_U(x) \\geq t] \\leq \\e^{-d t / \\e}\\,\n\n$$\nfor $t \\geq 2\\e / d $.\nFinally, using the union bound we conclude that\n$$\n\n\\Pr[p_U(x) \\geq t\\quad\\forall x \\in [d]] \\leq d\\e^{-d t / \\e}\\, ,\n\n$$\nwhich completes the proof.\n\nLet $d = 2^n$. The estimator $\\hat E_f$ is the sum of $m$ i.i.d. random variables $f(p_U(\\tilde x))$.\nBy the form (<ref>) it is clear that $\\hat E_f$ is an unbiased estimator for $E_f$.\nThe estimator $\\hat E_f$ is the sum  of $m$ i.i.d. random variables $f(p_U(\\tilde x))$.\nUsing Lemma\u00a0<ref> $p_U(x) \\leq b \\coloneqq \\frac \\e d \\ln\\myleft(\\frac{2d}{\\delta}\\myright)$  with probability $1 - \\delta / 2$.\nThus, with the same probability, the random variable $f(p_U(\\tilde x))$, with $f = f_F$ as defined below (<ref>), is bounded by $db - 1 = \\e \\ln(2d /\\delta)$.\nNow Hoeffding's inequality (<ref>), with failure probability $\\delta / 2$ yields the statement.\n\nFollowing the same strategy, one can also derive a sampling complexity in\n$\\LandauO\\bigl(\\epsilon^{-2}\\ln^2(d)\\ln(1/\\delta)\\bigr)$\nfor estimating the cross-entropy $H_X(\\tilde p_U, p_U)$ by Protocol\u00a0<ref> [Unknown Author, \"Unknown Title\", ].\nSince the cross-entropy $f(p_U(\\tilde x))$ involves the logarithm, the\nupper bound on the range of $p_U$ of Lemma\u00a0<ref> is no longer sufficient to ensure boundedness of the random variables that enter the estimator.\nIn addition, one needs a lower bound on the range of $p_U$.\nThis is not possible with our bounds on the moments.\nInstead, one has to explicitly calculate the tail distribution (<ref>).\n\nFrom an estimate of the cross-entropy one can calculate an estimate of the cross-entropy difference by shifting with $H_X(p_\\text{uni}, p_U)$.\nIf the ideal circuit is sufficiently close to a Haar-random unitary, one can analytically calculate $H_X(p_\\text{uni}, p_U)$.\nAlternatively, taking the average of the values calculated in step\u00a0<ref> provides a numerical estimate for $H_X(p_\\mathrm{uni}, p_U)$.\n\nUltimately, theoretical results for the hardness of sampling tasks require closeness of the probability mass functions\nin TV distance or TV norm\n$$\n\n\\norm{q - p}_\\mathrm{TV} = \\frac12 \\sum_{x \\in [d]} | q(x) - p(x) |.\n\n$$\nWithout additional assumptions, it is not possible to derive a TV norm bound from the cross-entropy.\nA counter example is discussed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nTherein, Bouland\u00a0et al.\u00a0also hint at a possible bail out.\nAn insightful presentation of the argument is also given in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\nVery close to the desired bound is Pinsker's inequality [Unknown Author, \"Unknown Title\", ]\n$$\n\n\\norm{q - p}_\\text{TV} \\leq \\sqrt{\\frac{D_\\mathrm{KL}(q, p)}2}\n\n$$\nthat bounds the TV norm in terms of the\nKullback-Leibler divergence $D_\\text{KL}(q, p) \\coloneqq H_X(q, p) - H(q)$.\nThe Kullback-Leibler divergence $D_\\text{KL}(q, p_U)$ is unfortunately not of the form (<ref>) and cannot\nbe directly estimated by a XEB protocol.\nIn addition to the estimate of the cross-entropy, the $D_\\mathrm{KL}(q, p_U)$ requires an estimate of the entropy of the implemented mass function $q$.\nIf we assume that the noise in our implementation only increases the entropy such that $H(q) \\geq H(p)$,\nwe can avoid this obstacle and swap $H(q)$ for $H(p)$, the entropy of the ideal probability mass function.\nThus, instead of $D_\\text{KL}(q,p)$ we consider $D_\\mathrm{XE}(q,p) = H_X(q,p) - H(p)$.\nIf $H(q) \\geq H(p)$, then $D_\\text{KL}(q, p) \\leq D_\\text{XE}(q,p)$ and a TV norm bound is given\nin terms of $D_\\mathrm{XE}(q,p)$ via Pinsker's inequality.\n\nSimilar to the cross-entropy difference\u00a0(<ref>) $D_\\mathrm{XE}(q,p)$ can be estimated by\nmeasuring $H_\\text{XE}(q,p)$ with Protocol\u00a0<ref> and either estimating the shift\n$H(p)$ analytically or numerically from the computed values $p_U(\\tilde x_i)$ of step\u00a0<ref>.\nIf the ideal probability mass function is of Porter-Thomas shape then\none can calculate that $D_\\mathrm{XE}(q, p) = 1 - d_\\mathrm{XE}(q,p)$ and the above discussion can be translated to the cross-entropy difference.\n\nFurther reading\n\nThe idea of demonstrating quantum supremacy in the task of sampling from certain probability distribution that naturally arise\nin quantum systems goes back to the proposal of boson sampling in a linear optics [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nEven earlier, Terhal and DiVicenzo derived evidence for the hardness of the sampling task associated with simulating\nrestricted classes of quantum circuits [Unknown Author, \"Unknown Title\", ].\nBesides random circuit sampling [Unknown Author, \"Unknown Title\", ] multiple supremacy proposals exist, e.g. for\nother restricted classes of quantum computations\n[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nor for processes arising in quantum simulation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], see also Ref.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nA series of additional theoretical works collects evidence for the robust hardness of the resulting approximate sampling tasks, e.g. [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and more fine-grained statements about the sufficient scaling [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIt was realized early on that the verification of quantum supremacy is a daunting task\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nOne might hope that it is possible to perform a non-interactive black-box verification.\nSuch a verification certifies the sampling task solely from the samples itself.\nUnfortunately, the same features of a probability distribution that guarantee the classical hardness of the sampling task\nprohibit the efficient verification from samples on a classical computer [Unknown Author, \"Unknown Title\", ].\nOptimal but non-efficient strategies for general verification problems were studied in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe focus on cross-entropy estimation for the quantum supremacy verification [Unknown Author, \"Unknown Title\", ].\nAnother measure of the form (<ref>) is employed in the HOG test  which\nuses a heavy-side function as $f$ [Unknown Author, \"Unknown Title\", ]. A refined notion of the heavy outcome generation test is the BOG test proposed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nNote that these protocols still require an efficient simulation of the quantum circuit on another computing device.\nOne approach to overcome this bottleneck is to run the quantum circuit as part of a larger circuit that includes so-called traps, subcircuits that can be efficiently simulated [Unknown Author, \"Unknown Title\", ].\n\nNaturally, approaches for quantum state and processes certification can also be used to verify a sampling task under a various assumptions.\n\nIt is an ongoing endeavor to develop classical strategies for spoofing verification protocols for quantum supremacy with successes reported e.g. in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and for collecting evidence for the hardness of classical spoofing [Unknown Author, \"Unknown Title\", ].\n\nAn extensive, recent overview over verification and certification methods in the context of quantum supremacy can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nACKNOWLEDGEMENTS\n\nOur present work builds on countless insightful discussions\non the topic of quantum system characterization and beyond\nwith many friends and colleagues over the last years.\n\nAmong those are a couple that we explicitly thank for valuable support while drafting this tutorial.\nWe thank Raphael Brieger for comments on the presentation of the lecture notes preceding this tutorial.\nWe are grateful to Dominik Hangleiter for countless exciting and enlightening discussions on\nvarious topics of the tutorial, especially on the anatomy of certification protocols, DFE and cross-entropy benchmarking.\nWe are grateful to him for graciously providing a draft of his thesis \u2014a valuable resource on the certification of quantum supremacy\u2014 and helpful comments on the tutorial.\nWe thank Richard Kueng for explanations and discussions on SFE and quantum channels as well as valuable feedback on the tutorial.\nI.R. thanks Jonas Helsen, Emilio Onorati, Albert Werner, and Jens Eisert for valuable and insightful discussions on RB,\nJonas Haferkamp, Markus Heinrich, Felipe Montealegre-Mora and David Gross for discussions on\nSchur-Weyl duality, Yi-Kai Liu for discussions on DFE and RB.\nFurthermore, the section on the anatomy of certification protocols\nbuilds on many enjoyable conversations with Nathan Walk.\nWe are grateful to Susane Calegari for contribution to the illustrations and valuable feedback on the draft.\nThe work of I.R. has been funded by the DFG (EI 519/9-1, EI 519/14-1, and CRC 183).\nThe work by M.K. is supported by\nthe Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) via the Emmy Noether grant 441423094.\n\nACRONYMS\n[POVM].5NISQnoisy and intermediate scale quantumPOVMpositive operator valued measurePVMprojector-valued measureCPcompletely positiveCPTcompletely positive and trace preservingDFEdirect fidelity estimationMUBsmutually unbiased basesSICsymmetric, informationally completeSFEshadow fidelity estimationRBrandomized benchmarkingXEBcross-entropy benchmarkingSPAMstate preparation and measurementTVtotal variationHOGheavy outcome generationBOGbinned outcome generation./myapsrev4-2"}
{"prompt": "What mathematical concepts are used in the paper 'ICARUS-Q: Integrated Control and Readout Unit for Scalable Quantum Processors'?", "completion": "\n\nAPS/123-QED\n# ICARUS-Q: Integrated Control and Readout Unit for Scalable Quantum Processors\n\n[The author to whom correspondence may be addressed: ]yungszen@utm.my\nFaculty of Science and Centre for Sustainable Nanomaterials (CSNano), Universiti Teknologi Malaysia, 81310 UTM Johor Bahru, Johor, Malaysia\n\nAdvinno Technologies Pte.\u00a0Ltd., 22, Sin Ming Lane, #05-75 Midview City\n573969, Singapore\n\nQuantum Research Centre, Technology Innovation Institute, Accelerator 2 building, on Plot M12, PO Box 9639, Masdar City, Abu Dhabi, UAE\n\nTIF Lab, Dipartimento di Fisica, Universit\u00e0 degli Studi di Milano and INFN Sezione di Milano, via Celoria 16, 20133, Milan, Italy\nTheoretical Physics Department, CERN, Esplanade des Particules 1, 1211 Meyrin, Switzerland\nQuantum Research Centre, Technology Innovation Institute, Accelerator 2 building, on Plot M12, PO Box 9639, Masdar City, Abu Dhabi, UAE\n\nrdumke@ntu.edu.sg\n\nWe present a control and measurement setup for superconducting qubits based on Xilinx 16-channel radio-frequency system-on-chip (RFSoC) device.\nThe proposed setup consists of four parts: multiple RFSoC boards, a setup to synchronise every digital to analog converter (DAC), and analog to digital converter (ADC) channel across multiple boards, a low-noise direct current (DC) supply for tuning the qubit frequency and cloud access for remotely performing experiments.\nWe also design the setup to be free of physical mixers. The RFSoC boards directly generate microwave pulses using sixteen DAC channels up to the third Nyquist zone which are directly sampled by its eight ADC channels between the fifth and the ninth zones.\n\n## Introduction\nSuperconducting qubits in the dilution refrigerator are controlled and measured with room temperature electronics. A typical superconducting qubit is designed with its transition energy in the order of a few GHz, and requires arbitrary and precise microwave generation and detection for control and measurement. As the number of qubits increases, the number of microwave channels required increases linearly. Therefore, designing a qubit control system that is scalable, compact and cost-effective, while maintaining its precision, speed, and features, is imperative.\n\nApart from the microwave circuits for frequency up/down-conversion, a basic qubit control system consists of digital to analog converters (DACs), and analog to digital converters (ADCs) and stable current sources; the DACs generate the microwave pulses that travel into the fridge, the ADCs digitise the analog signals that travel out from the fridge, and the current source tunes the qubit frequencies. Some of the earlier microwave control systems for electron spin and superconducting qubits\u00a0[Unknown Author, \"Unknown Title\", ], relied on benchtop arbitrary waveform generators (AWGs) for the microwave generation\u00a0[Tseitlin, Mark, Quine, Richard W, Rinard, George A, Eaton, Sandra S, Eaton, Gareth R, \"Digital EPR with an arbitrary waveform generator and direct detection at the carrier frequency\", 2011] [Doll, Andrin, Pribitzer, Stephan, Tschaggelar, Ren\u00e9, Jeschke, Gunnar, \"Adiabatic and fast passage ultra-wideband inversion in pulsed EPR\", 2013] [Yap, Yung Szen, Tabuchi, Yutaka, Negoro, Makoto, Kagawa, Akinori, Kitagawa, Masahiro, \"A Ku band pulsed electron paramagnetic resonance spectrometer using an arbitrary waveform generator for quantum control experiments at millikelvin temperatures\", 2015] [Riste, Diego, Poletto, Stefano, Huang, M-Z, Bruno, Alessandro, Vesterinen, Visa, Saira, O-P, DiCarlo, Leonardo, \"Detecting bit-flip errors in a logical qubit using stabilizer measurements\", 2015] [Raftery, J, Vrajitoarea, A, Zhang, G, Leng, Z, Srinivasan, SJ, Houck, AA, \"Direct digital synthesis of microwave waveforms for quantum computing\", 2017] [Zaw, Lin Htoo, Tan, Yuanzheng Paul, Nguyen, Long Hoang, Budoyo, Rangga P, Park, Kun Hee, Koh, Zhi Yang, Landra, Alessandro, Hufnagel, Christoph, Yap, Yung Szen, Koh, Teck Seng, others, \"Ghost Factors in Gauss Sum Factorization with Transmon Qubits\", In Press]. The recent trends however are favoring field programmable gate array (FPGA)\u00a0[Kaufmann, Thomas, Keller, Timothy J, Franck, John M, Barnes, Ryan P, Glaser, Steffen J, Martinis, John M, Han, Songi, \"DAC-board based X-band EPR spectrometer with arbitrary waveform control\", 2013] [Ryan, Colm A, Johnson, Blake R, Rist\u00e8, Diego, Donovan, Brian, Ohki, Thomas A, \"Hardware for dynamic quantum computing\", 2017] [Salath\u00e9, Yves, Kurpiers, Philipp, Karg, Thomas, Lang, Christian, Andersen, Christian Kraglund, Akin, Abdulkadir, Krinner, Sebastian, Eichler, Christopher, Wallraff, Andreas, \"Low-latency digital signal processing for feedback and feedforward in quantum computing and communication\", 2018] [Lin, Jin, Liang, Fu-Tian, Xu, Yu, Sun, Li-Hua, Guo, Cheng, Liao, Sheng-Kai, Peng, Cheng-Zhi, \"High performance and scalable AWG for superconducting quantum computing\", 2018] [Sun, Lihua, Liang, Futian, Lin, Jin, Guo, Cheng, Xu, Yu, Liao, Shengkai, Peng, Chengzhi, \"Scalable self-adaptive synchronous triggering system in superconducting quantum computing\", 2020] [Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020] [Xu, Yilun, Huang, Gang, Balewski, Jan, Naik, Ravi, Morvan, Alexis, Mitchell, Bradley, Nowrouzi, Kasra, Santiago, David I, Siddiqi, Irfan, \"QubiC: An Open-Source FPGA-Based Control and Measurement System for Superconducting Quantum Information Processors\", 2021] [Yang, Yuchen, Shen, Zhongtao, Zhu, Xing, Wang, Ziqi, Zhang, Gengyan, Zhou, Jingwei, Deng, C, Liu, S, An, Q, \"FPGA-based electronic system for the control and readout of superconducting qubit systems\", 2021] for their higher number of channels (i.e.\u00a0cost per channel), versatility, and the form factor. Typically, two DAC channels are required, per qubit, for qubit driving; additionally, one DAC channel is shared among five or more qubits for frequency-multiplexed readout schemes \u00a0[Lanting, TM, Cho, Hsiao-Mei, Clarke, John, Holzapfel, WL, Lee, Adrian T, Lueker, M, Richards, PL, Dobbs, Matt A, Spieler, Helmuth, Smith, A, \"Frequency-domain multiplexed readout of transition-edge sensor arrays with a superconducting quantum interference device\", 2005] [Chen, Yu, Sank, D, O'Malley, P, White, T, Barends, R, Chiaro, B, Kelly, J, Lucero, E, Mariantoni, M, Megrant, A, others, \"Multiplexed dispersive readout of superconducting phase qubits\", 2012] [Hornibrook, JM, Colless, JI, Mahoney, AC, Croot, XG, Blanvillain, S, Lu, H, Gossard, AC, Reilly, DJ, \"Frequency multiplexing for readout of spin qubits\", 2014].\n\nThe latest family of FPGA by Xilinx known as the Zynq UltraScale+ radio-frequency system-on-chip (RFSoC)\u00a0[Unknown Author, \"Unknown Title\", ] hosts a wide-variety of features that are advantages for qubit control and measurement.  To the best of our knowledge, this family of devices feature the highest number of independent DAC and ADC channels within a single chip with high sampling rates and is equipped auto-synchronisation between channels. The device also has digital up/down converters using internal complex mixers and a 48-bit numerically-controlled oscillator (NCO), and two processors.\nThese features which are available at a fraction of the cost and size to that of other commercial off-the-shelf devices, makes the RFSoC particularly enticing for applications such as radar\u00a0[Fagan, Rory, Robey, Frank C., Miller, Luke, \"Phased array radar cost reduction through the use of commercial RF systems on a chip\", 2018],  communications\u00a0[Farley, Brendan, Erdmann, Christophe, Vaz, Bruno, McGrath, John, Cullen, Edward, Verbruggen, Bob, Pelliconi, Roberto, Breathnach, Daire, Lim, Peng, Boumaalif, Ali, others, \"A programmable RFSoC in 16nm FinFET technology for wideband communications\", 2017] and quantum computing\u00a0[Gebauer, Richard, Karcher, Nick, Gusenkova, Daria, Spiecker, Martin, Gr\u00fcnhaupt, Lukas, Takmakov, Ivan, Winkel, Patrick, Planat, Luca, Roch, Nicolas, Wernsdorfer, Wolfgang, others, \"State preparation of a fluxonium qubit with feedback from a custom FPGA-based platform\", 2020] [Stefanazzi, Leandro, Treptow, Ken, Wilcer, Neal, Stoughton, Chris, Montella, Salvatore, Bradford, Collin, Cancelo, Gustavo, Saxena, Shefali, Arnaldi, Horacio, Sussman, Sara, others, \"The QICK (Quantum Instrumentation Control Kit): Readout and control for qubits and detectors\", 2021] [Martina Esposito, Arpit Ranadive, Luca Planat, Sebastian Leger, Dorian Fraudet, Vincent Jouanny, Olivier Buisson, Wiebke Guichard, C\u00e9cile Naud, Jos\u00e9 Aumentado, Florent Lecocq, Nicolas Roch, \"Observation of two-mode squeezing in a traveling wave parametric amplifier\", 2021].\n\nFirst announced in late 2018, the RFSoC has three generations of devices where only the first two are available at the time of writing\u00a0[Unknown Author, \"Unknown Title\", ]. Within the first generation of RFSoC devices, the two top devices are XCZU28DR and XCZU29DR.  There primary differences between them are: the number of channels (8 versus 16\u00a0channels of DACs and ADCs) and the maximum sampling rate of the ADCs (4.096\u00a0GS/s versus 2.058\u00a0GS/s, respectively).\n\nA single RFSoC board (ZCU111 by Xillinx) that is populated with the XCZU28DR (equipped with eight 6.554\u00a0GS/s DAC channels and eight 4.096\u00a0GS/s ADC channels) has been used as a control and measurement system for superconducting quantum computers\u00a0[Gebauer, Richard, Karcher, Nick, Gusenkova, Daria, Spiecker, Martin, Gr\u00fcnhaupt, Lukas, Takmakov, Ivan, Winkel, Patrick, Planat, Luca, Roch, Nicolas, Wernsdorfer, Wolfgang, others, \"State preparation of a fluxonium qubit with feedback from a custom FPGA-based platform\", 2020] [Stefanazzi, Leandro, Treptow, Ken, Wilcer, Neal, Stoughton, Chris, Montella, Salvatore, Bradford, Collin, Cancelo, Gustavo, Saxena, Shefali, Arnaldi, Horacio, Sussman, Sara, others, \"The QICK (Quantum Instrumentation Control Kit): Readout and control for qubits and detectors\", 2021] [Martina Esposito, Arpit Ranadive, Luca Planat, Sebastian Leger, Dorian Fraudet, Vincent Jouanny, Olivier Buisson, Wiebke Guichard, C\u00e9cile Naud, Jos\u00e9 Aumentado, Florent Lecocq, Nicolas Roch, \"Observation of two-mode squeezing in a traveling wave parametric amplifier\", 2021]. Here, we develop a scalable setup based on multiple synchronised XCZU29DR RFSoC boards, where each board features sixteen 6.554\u00a0GS/s DAC channels and sixteen 2.058\u00a0GS/s ADC channels per board and operates without physical IQ mixers.\n\n## Implementation\n< g r a p h i c s >\n\nOverall circuit diagram. Several units of RFSoC boards, each with an RFSoC device (XCZU29DR by Xilinx), are used to directly generate and sample microwave signals in the GHz frequencies using its higher Nyquist zones (with the help of filters). The boards are synchronised to a master reference clock (VHF Citrine Gold, Wenzel) and triggers from a programmable\u00a0[Unknown Author, \"Unknown Title\", ] TTL pulse generator (PulseBlaster PB24-100-4K, Spincore). The triggers are also synchronised to the same clock using a d-type flip-flop circuit. The trigger source board runs a custom firmware which takes in the master oscillator signal as the reference clock. To tune the superconducting qubits, low noise current sources are merge with microwave pulses using bias-tees, located at the mixing chamber stage. The biasing for the flip-flop clock input has been omitted for clarity. The worker PC is connected to the trigger source via PCIe, and to the current sources via USB. The RFSoC boards are controlled from the PC via SSH over Ethernet through the network switch.\n\nThe developed setup in Fig.\u00a0<ref> consists of several parts.\nThe RFSoC board, codename ICARUS-Q (Integrated Control And Readout Unit for Scalable Quantum processors), runs with an embedded Linux kernel that receives commands and transfers data in/out of the board via Ethernet.\nIn our approach, an alias in the higher Nyquist zone\u00a0[Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020] of the DAC signal is used to address the GHz-range qubit transition and direct sampling of the high-frequency signals by the ADCs at a lower sampling rate (Sec.\u00a0<ref> \u2013 <ref>). Multiple RFSoC boards are synchronised with each other using a master oscillator and trigger signals that are synchronised to the same master oscillator (Sec.\u00a0<ref>).\nFor tunable superconducting qubits, the Josephson junction of the qubit is replaced by a DC-SQUID loop. This allows the qubit to be tuned with a magnetic flux, which is coupled into the loop from a current carrying wire close to the loop.\nTo support this, low-noise DC sources are integrated into the setup for tuning the qubits (Sec.\u00a0<ref>).\nThe RFSoC boards, trigger and current sources are connected to a PC, which runs a worker program that communicates with a cloud server to remotely run experiments (Sec.\u00a0<ref>).\n\nThe RFSoC board used in this work is available commercially (HTG-ZRF16, HiTech Global) and is populated with one unit of XCZU29DR RFSoC device (see Fig.\u00a0<ref> for photo) that comes with sixteen 14-bit DAC (6.554\u00a0GS/s) and sixteen 12-bit ADC (2.058\u00a0GS/s) differential pins.\nOn the RFSoC board, these are converted to single-ended signals using baluns (which support frequencies from 10\u00a0MHz to 8\u00a0GHz) and SSMC ports (support frequencies up to 12.4\u00a0GHz) for all of the DAC and ADC channels.\nDespite a rated sampling rate of 6.554\u00a0GS/s for the DACs and 2.096\u00a0GHz for the ADCs, our setup reaches a limit of 6.144\u00a0GS/s for the DACs and 1.96608\u00a0GS/s for the ADCs. This limit occurs because RFSoC FPGA is linked to the master clock and the sampling rates are multiples of the master clock (122.88\u00a0MHz).\n\nIn our setup, more DAC channels are needed than ADC channels. To allocate more of the limited FPGA block RAM memories\u00a0[Unknown Author, \"Unknown Title\", ] to the DACs, we reduced the number of active ADC channels to eight.\n\n< g r a p h i c s >\n\nICARUS-Q. (a) The RFSoC board (HTG-ZRF16), hosted within a casing, contains a unit of XCZU29DR RFSoC by Xilinx. (b) The front panel view of the enclosed RFSoC board.\n\n### FPGA Logic\nThis section describes the FPGA logic that enables data movement between the PC and the quantum processor (see Fig.\u00a0(Figure fig:wholelogic)).\nThe conversions between data and signals are performed by the ADCs and DACs, which are activated by the external triggers. For the current FPGA design with sixteen active DACs and eight active ADCs, we utilised around 50\nThe HTG-ZRF16 also contains a two-stage clock distribution logic for phase synchronisation of the ADCs and DACs.\nThe FPGA also encompasses the Ethernet, microSD card and DDR memories on the HTG-ZRF16 board. In the following parts, we described the FPGA logics for the DAC and ADC implementations.\n\n< g r a p h i c s >\n\nSome of the features on the HTG-ZRF16 board that are used in this setup. The board takes in multiple triggers and a clock signal as reference for the FPGA logic. The clock distribution subsystem distributes it to the FPGA as well as the DACs and ADCs tiles. The DACs and ADCs tiles generates differential microwave signals, which are converted to single-ended signals and transmitted out via SSMC ports. The board also supports communication via microSD card and Ethernet.\n\n#### FPGA Logic for DAC waveforms generation\n< g r a p h i c s >\n\nThe FPGA logic for the DAC waveforms generation. The figure shows the data flow from the processor system (PS), going through the DDR memory and into the AXI Stream FIFO before it is sent out through the sixteen DAC channels. A multi-tile synchronisation logic ensures that all channels are synchronised.\n\nThe arbitrary waveforms are generated using RFSoC DAC (see Fig.\u00a0<ref>).\nThe sixteen DAC channels are powered by four DAC `tiles' inside the RFSoC chip. In order to ensure synchronous output of all DACs within a single board, multi-tiles synchronisation logic inside the RFSoC is utilised to calibrate the `tile-to-tile' time skew.\n\nThe DAC data flow starts from loading the waveform of interests into the programmable logic (PL) DDR memory. PL DDR memory is a physical SODIMM memory module connected to the PL-FPGA. The waveforms data are then moved into AXI Stream FIFO (First-In, First-Out) of each DAC channels. This is essential to allow the DAC playback to start simultaneously for all channels. However, due to the memory capacity limit of the internal block RAMs, individual AXI Stream FIFO can store up to 65,536 samples of DAC waveform of each channel.\n\nThe DAC waveform playback supports loopback function. When enabled, it allows the waveforms to be reloaded into AXI Stream FIFO without the need of reloading the waveform data from a host computer, thus reducing the overhead time of re-arming the DAC for next DAC playback.\n\nOnce the waveforms data are loaded into AXI Stream FIFO of each channel, the system will wait for an external trigger event from the external control logic before starting the DAC waveform playback. The trigger signal from external control logic applies to all DAC channels so the output can be streamed out via the SSMC connectors simultaneously. The external control logic also supports the waveform data swap. When enabled, the waveforms of upper eight channels can be swapped to the lower eight channels to support more advanced pulse sequences (see Sec.\u00a0<ref> for more information).\n\n#### FPGA Logic for ADC waveforms acquisition\n< g r a p h i c s >\n\nThe FPGA logic for the ADC waveforms acquisition. The data from the eight ADC channels are streamed to the AXI Stream FIFO gets moved into the DDR memory via the ADC Arbiter and DMA Logic, only when a trigger is received. The ADC arbiter and DMA logic then transfers the data to the programmable logic (PL) memory for storage when an instruction is received from the processor system (PS). A multi-tile synchronisation logic ensures that all channels are synchronised.\n\nIn our firmware, the waveform acquisition system is powered by eight ADC channels of the RFSoC (see Fig.\u00a0<ref>). The analog input is fed into RFSoC ADC via SSMC connectors. ADC digitise the incoming waveform continuously, but is not streamed to the AXI Stream FIFO without the external ADC trigger.\n\nWhen the external ADC trigger event occurs, 65,536 samples of digitised waveform data for each ADC channel will be stored in the FPGA AXI Stream FIFO. The data stored in AXI Stream FIFO is moved to the external DDR4 SODIMM, awaiting subsequent process/instruction from ZYNQ Processor System (PS). The data can be stored in both HEX or ASCII file format depending on the applied settings for subsequent analysis. The ADC trigger will be re-armed after the acquired data has completely the transfer to the ZYNQ Processor System.\n\n### Microwave Generation & Detection\nThe RFSoC has gained some degree of attention and its performance has been tested by several groups\u00a0[Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020] [Liu, Chao, Jones, Michael E, Taylor, Angela C, \"Characterizing the performance of high-speed data converters for RFSoC-based radio astronomy receivers\", 2021].\nThe on-board DACs output arbitrary waveform, generated from 65,536 samples at variable sampling rates, up to 6.144\u00a0GS/s. At its maximum sampling rate, this translates to about 10\u00a0$\\mu$s of waveform points. The ADC also stores equal number samples but operates at 1.96608\u00a0GS/s, resulting in a waveform of about 33\u00a0$\\mu$s.\nAfter triggering the DAC channels, there is a minimum delay of about 30\u00a0$\\mu$s before triggering the next pulse.\nTo further evaluate the performance of the DACs and the ADCs, we performed several tests and describe their results in the following.\n\n#### Arbitrary Waveform Generation\nIn a typical quantum computer experiment, rectangular or Gaussian-shaped pulses are common but pulses with arbitrary phases and amplitudes\u00a0[Motzoi, Felix, Gambetta, Jay M, Rebentrost, Patrick, Wilhelm, Frank K, \"Simple pulses for elimination of leakage in weakly nonlinear qubits\", 2009] [Economou, Sophia E, Barnes, Edwin, \"Analytical approach to swift nonleaky entangling gates in superconducting qubits\", 2015] are also often used.\nSome quantum information processing applications also requires the use of non-gate-based signals such as  optimal control theory\u00a0[Khaneja, Navin, Brockett, Roger, Glaser, Steffen J, \"Time optimal control in spin systems\", 2001] [Tabuchi, Yutaka, Negoro, Makoto, Kitagawa, Masahiro, \"Design method of dynamical decoupling sequences integrated with optimal control theory\", 2017] [Werninghaus, Max, Egger, Daniel J, Roy, Federico, Machnes, Shai, Wilhelm, Frank K, Filipp, Stefan, \"Leakage reduction in fast superconducting qubit gates via optimal control\", 2021], adiabatic quantum computation, continuous variable quantum computing\u00a0[Song, Chao, Zheng, Shi-Biao, Zhang, Pengfei, Xu, Kai, Zhang, Libo, Guo, Qiujiang, Liu, Wuxin, Xu, Da, Deng, Hui, Huang, Keqiang, others, \"Continuous-variable geometric phase and its manipulation for quantum computation in a superconducting circuit\", 2017], etc.\nIn our setup, the modulated pulses are numerically designed and generated up to 3.072 GHz (one half of the DAC's maximum sampling rate).\nTo demonstrate true arbitrary waveform generation capabilities, we tested the DAC with pink noise and compared the generated signal against the calculated waveform datapoints (see Fig.\u00a0(Figure fig:pinknoise)).\nThe pink noise waveform was calculated using the Voss algorithm\u00a0[Unknown Author, \"Unknown Title\", ] and the signal was generated by the DAC at two different sampling rates: 1.96608\u00a0GS/s and 6.144\u00a0GS/s. Both waveforms were sampled using the ADC at 1.96608\u00a0GS/s.\n\n< g r a p h i c s >\n\nPink noise generated by the DAC at (a) 1.96608\u00a0GS/s and (b) 6.144\u00a0GS/s.\nThe pink noise waveform was calculated using the Voss algorithm\u00a0[Unknown Author, \"Unknown Title\", ] and the DACs were fed back directly into the ADCs without any filters for sampling.\nFor both runs, the generated waveform was sampled with the ADC at 1.96608\u00a0GS/s. All plots stop at their respective Nyquist frequencies, which is one half of the sampling frequency.\n\nIn Fig.\u00a0(Figure fig:pinknoise)(a), the DAC samples and the ADC data are plotted in frequency domain, respectively. The frequency profiles bear a qualitative resemblance with each other across the frequency components, except below 1\u00a0MHz. We attribute this to the balun's supported frequency range (10\u00a0MHz\u20138\u00a0GHz) where frequencies below 10\u00a0MHz are attenuated, akin to a high pass filter.\n\n#### Nyquist Zone Implementation\nThe Shannon-Nyquist sampling theorem states that a signal can be adequately generated or sampled at frequencies below half of the sampling rate. This frequency threshold is known as Nyquist frequency.\nHowever, generating or sampling signals in discrete-time creates aliases that are mirrored repeatedly across multiples of the Nyquist frequency\u00a0[Soliman, Samir S, Srinath, Mandyam D, \"Continuous and discrete signals and systems\", 1990] [Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020].  Each \u201csegment\u201d of the frequency domain is commonly referred to as Nyquist zones.\nWith careful planning, one can utilise frequencies above the first zone without upgrading existing electronics\u00a0[Erdmann, Christophe, Cullen, Edward, Brouard, Damien, Pelliconi, Roberto, Verbruggen, Bob, Mcgrath, John, Collins, Diarmuid, De La Torre, Marites, Gay, Pierrick, Lynch, Patrick, others, \"16.3 A 330mW 14b 6.8 GS/s dual-mode RF DAC in 16nm FinFET achieving- 70.8 dBc ACPR in a 20MHz channel at 5.2 GHz\", 2017] [Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020] [Stefanazzi, Leandro, Treptow, Ken, Wilcer, Neal, Stoughton, Chris, Montella, Salvatore, Bradford, Collin, Cancelo, Gustavo, Saxena, Shefali, Arnaldi, Horacio, Sussman, Sara, others, \"The QICK (Quantum Instrumentation Control Kit): Readout and control for qubits and detectors\", 2021].\n\nFor controlling the qubits, we digitally generate shaped sine wave pulses directly in the GHz frequency range and use them in their respective Nyquist zones, which also naturally preserves the phase coherence of the qubit. As such, this method does not require a local oscillator nor its modulation.\n\nHowever, there are implications for using this approach. The voltage in time domain, $v(t)$ described by:\n$$\n\nv(t) = \\left[x(t)\\sum_{k=-\\infty}^\\infty \\delta(t-kT)  \\right] \\ast  r(t),\n\n$$\nis affected by the \u201creconstruction waveform\u201d, $r(t)$\u00a0[Kalfus, William D, Lee, Diana F, Ribeill, Guilhem J, Fallek, Spencer D, Wagner, Andrew, Donovan, Brian, Rist\u00e8, Diego, Ohki, Thomas A, \"High-fidelity control of superconducting qubits using direct microwave synthesis in higher Nyquist zones\", 2020]. Here, $x(t)$ is the analytical function we sample, $\\delta(t-kT)$ is the Dirac delta function, and $T$ is the sampling period. The Fourier transform of $v(t)$ is:\n$$\n\nV(\\omega) = \\left[ X(\\omega) \\ast \\sum_{n=-\\infty}^\\infty\\delta(\\omega T - 2 \\pi n) \\right] \\times R(\\omega).\n\\label{eq:nyq_freq}\n\n$$\nwhere, $X(\\omega)$ is the Fourier transform of $x(t)$, and $R(\\omega)$ is a sinc function that is determined by the DACs operational mode\u00a0[Unknown Author, \"Unknown Title\", ]. The RFSoC used here supports two modes: the non-return-to-zero (NRZ) mode and the mixed mode. The respective reconstruction waveforms in the Fourier space are two different sinc functions:\n$$\n\nR_{\\mathrm{NRZ}}(\\omega) = T e^{-i\\omega T/2}  \\mathrm{sinc} \\left( \\frac{\\omega T}{2}\\right)\n\\label{eq:nrz}\n\n$$\nand\n$$\n\nR_{\\mathrm{mix}}(\\omega) = \\frac{\\omega T^2}{4} e^{-i(\\omega T - \\pi)/2}  \\mathrm{sinc}^2 \\left( \\frac{\\omega T}{4}\\right)\n\\label{eq:mix}\n\n$$\nrespectively.\n\nTherefore, when using the ADC with its higher Nyquist zones, we expect the signal-to-noise ratio (SNR) to degrade to an extent. We investigated this by using the ADC at 1.96608\u00a0GS/s to sample various signals generated at higher frequencies (zones) which were aliased to 800\u00a0MHz within the first zone of the ADC.\n\nThe DAC decoder mode was set to normal (NRZ) mode for this test.\n\n< g r a p h i c s >\n\nSNR measurements of DAC output at different ADC Nyquist zones. The signal in the first zone is at 800 MHz and the ones in the higher zones are its aliases. The DAC output is passed through filters to only select the alias frequency that corresponds to each ADC Nyquist zone. For example: The DAC outputs a 4732.16 MHz signal (using its second zone) and is filtered with a 2.7-6.0 GHz bandpass filter; it is sampled in the ADC's as 800 MHz (using its fifth zone). The SNRs were calculated in frequency domain using the signal peak amplitude and the average noise within a bandwidth of 100 MHz.\n\nThe 800\u00a0MHz signal from the RFSoC DAC, in the first Nyquist zone of the ADC sampling rate, is measured to have $\\text{SNR} \\approx 2\\times{}10^{3}$ (see Fig.\u00a0<ref>). The 7.06432\u00a0GHz signal, the 8$^{\\text{th}}$ Nyquist zone alias of the 800\u00a0MHz, is in the similar range of the typical qubit transition frequency. At this frequency, the SNR is measured to be around $4\\times{}10^{2}$, which is around 5 times lower than when using 800\u00a0MHz.\n\n#### Power-Frequency Dependence\nOur approach to use the higher Nyquist zone involves a power dependency as defined in Eq.\u00a0<ref>. Since superconducting qubits are controlled and readout in the frequency domain at unique frequencies, we decided to investigate its output power-frequency dependence, particularly in between the DAC Nyquist zones. We measured the DACs output power using a spectrum analyzer from 4.5\u00a0GHz to 10\u00a0GHz, which is around the typical range for superconducting qubits and their readout resonators\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] [Krinner, Sebastian, Storz, Simon, Kurpiers, Philipp, Magnard, Paul, Heinsoo, Johannes, Keller, Raphael, Luetolf, Janis, Eichler, Christopher, Wallraff, Andreas, \"Engineering cryogenic setups for 100-qubit scale superconducting circuit systems\", 2019]. The results are presented in Fig.\u00a0<ref> where Eqs.\u00a0<ref> and <ref> were fitted to the measured DAC output power for the normal (NRZ) and the mix modes respectively.\n\nFor the normal (NRZ) mode, the output power dipped at 6.144\u00a0GHz as expected. Between 7\u201310\u00a0GHz, the power averaged at $-24.1 \\pm 2.4$\u00a0dBm, which improved slightly between 7\u20139\u00a0GHz (in terms of standard deviation) to $-23.1 \\pm 1.8$\u00a0dBm. Although the power variation is higher compared to microwave synthesizers or high-end benchtop AWGs, these error margin are not expected to pose significant problems since the qubits would be characterised/calibrated periodically at fixed frequencies. For the mix-mode, the expected power dip takes place at 12.288\u00a0GHz (double the sampling rate). The average power for this mode was at $-20.4 \\pm 5.7$\u00a0dBm between 7\u201310\u00a0GHz, and $-16.9 \\pm 2.3$\u00a0dBm between 7\u20139\u00a0GHz.\n\n< g r a p h i c s >\n\nOutput power of the RFSoC DAC from 4.5 to 10\u00a0GHz, corresponding to parts of the first three Nyquist zones. The zones are delineated by the dashed lines.\n\nThe output power was observed to deviate downwards from the fitted plots at higher frequencies. We attribute this observation to the on-board balun's supported frequency range (10\u00a0MHz\u20138\u00a0GHz), beyond which some attenuation is to be expected, similarly to the power spectra in Sec.\u00a0<ref>\u2014except acting as a low pass filter here.\n\n### Multi-channel and Multi-board Operation\nIn order to scale up the number of DAC and ADC channels used to control and measure the qubits, the channels need to be able to output the waveforms at a synchronised timing and phase.\nThere are two kinds of synchronisation we ought to achieve: (1) intra-board inter-channel synchronisation, and (2) inter-board synchronisation.\n\nWithin a RFSoC board, the inter-channel synchronisation is achieved through the multi-tile synchronisation (MTS) logic in the firmware, which utilises the on-board phase-locked loop (PLL) to lock the channel outputs to the external reference clock. The inter-board synchronisation, on the other hand, is achieved by carefully distributing the single master oscillator to all of the boards such that they have the same reference clock signal for synchronisation. To generate and sample the waveforms via the DACs and the ADCs,  in a synchronised fashion, hardware triggers are implemented.\nTo prevent metastability of sampling the external trigger by the RFSoC, the trigger signals are first synchronised to the master clock signal using an external d-type flip-flop (see Fig.\u00a0(Figure fig:flipflop)). The synchronised triggers are then distributed to multiple RFSoC boards.  This ensures that every RFSoC board samples the trigger at the same clock cycle\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWith the master clock, MTS and synchronised triggers, phase coherence between pulses was preserved for all channel across with multiple boards without the use of any local oscillator.\n\n< g r a p h i c s >\n\nSchematic of the d-type flip-flop circuit.\nThe two independent falling-edge trigger signals for the DAC outputting and the ADC sampling (Q1 and Q2) are provided by the trigger source (D1 and D2) and are synchronised to a master oscillator using a dual-channel d-type flip-flop.\nAn appropriate DC bias is supplied to the clock input of the flip-flop, so that the AC clock signal from the oscillator moves through the on/off levels.\n\nUsing the MTS logic and the trigger signal through the d-type flip-flop, the DAC outputs from two RFSoC boards were synchronised (see Fig.\u00a0(Figure fig:multiboard)). The oscillations in the trigger signal are caused by the leakage of the clock signal through the flip-flop, but did not affect the trigger reception by the RFSoC boards. The slight delay on Board B is caused by the difference in the lengths of the trigger distribution paths - which can be easily corrected by exactly matching the cable lengths (or by introducing delays in the software).\n\n< g r a p h i c s >\n\nSynchronisation of the DAC channels from multiple boards. (a) Using a synchronised to the trigger signal, 10 runs of the DAC were captured. (b-d) The DAC outputs from two RFSoC boards (Boards A and B) were connected to an oscilloscope and synchronisation between channels of the same board and between multiple boards were achieved.\n\n### Feedback Control\nHaving the ability to switch the waveform in real-time (nanosecond-scale) allows for the possibility to correct the qubit state in the midst of running quantum circuits. The RFSoC integrates waveform switching based on hardware trigger signal. Upon receiving the switching trigger, the outputs of the DAC channels in the upper memory banks (0 through 7) switches to those in the lower memory banks (8 through 15) within a few nanoseconds (see Fig.\u00a0(Figure fig:feedback)).\n\n< g r a p h i c s >\n\nDAC playback switching with hardware trigger signals. (a) The switching trigger sent to the RFSoC. (b) The DAC trigger sent to the RFSoC. (c-d) Upon receiving the switching trigger, the upper DAC memory banks (DACs 0 to 7) switches with  the lower banks (DACs 8 to 15). The delay from the trigger to completion of switching of the channels took approximately $20 \\pm5$ ns.\n\n### Measurements with Superconducting Qubit\nThe control system was used for experiments with a non-tunable superconducting qubit to demonstrate its capabilities.\nFor the following qubit measurements, the low noise bias circuit described in Section\u00a0<ref> was not used.\nWe also upgraded the trigger source (PulseBlaster PB12-100-4K-PCIe) to receive the master clock directly without the need to use the flip-flop circuit.\nThe qubit is a transmon with a single Josephson junction on silicon substrate, placed in a 3D aluminium cavity. Two DAC channels, for driving the qubit and the cavity respectively, were combined through a microwave combiner and fed through the input port of the cavity. The readout port of the cavity was connected to an ADC channel.\n\n#### Cavity Power Sweep\nWe first demonstrate the ability of the system to perform qubit readout by driving a readout signal through the cavity and measuring the response as shown in Fig.\u00a0(Figure fig:powersweep). A range of readout frequencies from 5.117\u00a0GHz to 5.127\u00a0GHz were swept to test the frequency precision of the device. The sampling rate of the DAC was set at 5.89824\u00a0GS/s and the ADC was set at 1.96608\u00a0GS/s.\nThese sampling rates were chosen based on the cavity and qubit frequencies and the corresponding output powers at different Nyquist zones. For this experiment, the DAC is operating at the second Nyquist zone and the ADC at the fifth Nyquist zone.\n\nFurthermore, we test the voltage control of the instrument by varying the drive power to resolve the dispersive shift of the cavity without the use of RF attenuators. While the maximum driving power of the device was unable to fully resolve the bare frequency of the cavity, we are able to resolve the dispersive shift of 3.8\u00a0MHz and the dressed cavity frequency at -12\u00a0dB.\n\n< g r a p h i c s >\n\nCavity transmission response. We plot the amplitude of the Fourier transform of the readout signal from the ADC as a function of DAC power and cavity driving frequency. The cavity was driven for 10\u00a0$\\mu$s near its resonance frequency over 20\u00a0dB of power with a rest period of 200\u00a0ms. At each point, the amplitude was averaged over 100 shots. The dressed cavity frequency is at 5.12375\u00a0GHz and from the data we are able to resolve the frequency at -12\u00a0dB. The bare frequency of 5.12\u00a0GHz is slightly visible at the highest power of the instrument.\n\n#### Rabi Spectroscopy\nNext, we move on to demonstrating qubit control with the RFSoC. We do this with Rabi spectroscopy, varying the length of the qubit driving pulse and measuring the cavity response (see Fig.\u00a0(Figure fig:rabi)). The qubit was driven at its resonance frequency of 3.357\u00a0GHz on the second Nyquist zone on DAC channel 1, tile 1 and measured with a readout pulse of length 5\u00a0$\\mu$s on DAC channel 13, tile 4. We also compare this to a separate experimental setup AWG (described in Ref.\u00a0[Zaw, LH, Tan, YP, Nguyen, Lh, Budoyo, RP, Park, Kh, Koh, Zy, Landra, A, Hufnagel, C, Yap, YS, Koh, TS, Dumke, R, \"Ghost factors in Gauss-sum factorization with transmon qubits\", 2021]).\n\n< g r a p h i c s >\n\nRabi oscillation of the qubit using (a) AWG and (b) RFSoC DAC, respectively. The qubit was driven with pulse durations up to 300\u00a0ns in 3\u00a0ns intervals. Each point was averaged over 1000 measurements. Through a sine wave fit, we approximate the Rabi oscillation frequency $f_{\\text{Rabi}}$ as 23.3\u00a0MHz for the AWG and 23.5\u00a0MHz for the RFSoC. We also obtain the $\\pi$-pulse duration $t_{\\pi}$ of 21.5\u00a0ns for the AWG and 21.2\u00a0ns for the RFSoC.\n\nFrom the oscillation, we are able to drive and resolve the 3\u00a0ns step rotations of the qubit. Hence, we demonstrate the ability of the RFSoC to perform and measure arbitrary rotations of the qubit and synchronise DACs on separate tiles.\n\n#### Ramsey Spectroscopy\nWe further test the phase stability of the system over half of the available DAC playback time through a Ramsey experiment (see Fig.\u00a0(Figure fig:ramsey)). We apply two $\\pi/2$-pulses separated by flight time $\\tau$ before readout.\nFrom the Ramsey fringes, we do not observe significant deviations compared to AWG in 5\u00a0$\\mu$s of free evolution time. Hence, the system appears to be stable during full playback.\n\nFurthermore, we perform Ramsey experiment with the feedback control (see Fig.\u00a0(Figure fig:ramsey_fb)) to swap the waveform memory banks as described in Section\u00a0<ref>. The switching of the memory banks is carried out in between the two $\\pi/2$-pulses of the Ramsey sequence. Similarly, we do not observe significant deviations when using the feedback control for the Ramsey experiment.\n\n< g r a p h i c s >\n\nRamsey fringes. We vary $\\tau$ up to 5\u00a0$\\mu$s and a apply a frequency detuning of 1\u00a0MHz using (a) the AWG and (b) the RFSoC. Each point was averaged over 1000 measurements. The data is fitted to a sine wave with an exponential decay, yielding an oscillation of frequency 1.367\u00a0MHz and dephasing time of 6.66\u00a0$\\mu$s for the RFSoC and similar values of 1.38\u00a0MHz and 6.52\u00a0$\\mu$s for the AWG, respectively.\n\n< g r a p h i c s >\n\nRamsey fringes performed with the feedback control (i.e.\u00a0swapping of the DAC memory banks). (a) To test the effects of the feedback, we carried out a Ramsey experiment where the first $\\pi/2$-pulse originated from the original memory bank and the second $\\pi/2$-pulse was generated from the swapped the memory bank.  The Ramsey fringes (b) without and (c) with feedback control. Each point was averaged over 1000 measurements. The fits yield dephasing times of 4.84\u00a0$\\mu$s and 5.08\u00a0$\\mu$s, respectively. This experiment was performed at a different cooldown as compared to Fig.\u00a0(Figure fig:ramsey).\n\n#### Quantum State Tomography\nLastly, using $t_{\\pi}$ and $t_{\\pi/2}=t_{\\pi}/2$ obtained from the results of Rabi spectroscopy, we perform Quantum State Tomography (QST) with Maximum Likelihood Estimate (MLE) using $I, X, X/2, Y/2$ as pre-rotation gates for the $\\frac{1}{\\sqrt{2}}(\\ket{0} - i\\ket{1})$ state to evaluate the state fidelity (see Fig.\u00a0(Figure fig:tomography01)).\n\n< g r a p h i c s >\n\nQuantum State Tomography for $\\frac{1}{\\sqrt{2}}(\\ket{0} - i\\ket{1})$. The figure shows the (a) real and (b) imaginary parts of the Maximum Likelihood Estimate (MLE) fit. A $\\pi/2$-pulse is applied before prerotation. The state fidelity from MLE is $99.8\\%$.\n\nWith this measurement, we demonstrate the ability of the ICARUS-Q platform to perform qubit control and measurement. We have also described the implementation of a single qubit algorithm on the RFSoC in the Appendix.\n\n### Low Noise DC Biasing (Circuit)\nFor driving the bias circuit current, needed to set the idle frequency of the tunable qubits, we have developed a low-noise bipolar current source that can be controlled via software from the main computer.\nIn the design process we adopted the following considerations. (i) Ultra-low noise: as any noise in the current is directly affecting the coherence properties of the qubit, the current noise of the supply should be as low as possible. (ii) Ultra-low current drift: any drift in the current directly alters the qubit properties and should therefore be suppressed. (iii) Current bandwidth: depending on the design, the change of one flux quantum through the SQUID loop typically corresponds to a change in current of sub-milliampere to a few milliampere. The current range of the source needs to be able to generate a change of at least one flux quantum. In addition the source should be bipolar. (iv) Automation: the source should be addressable via a standard protocol like USB or Ethernet in order to integrate it into the software workflow.\n\nFig.\u00a0(Figure fig:DCSourceSetup) shows the basic design of our current source. The current controller is embedded on a PCB board together with a microcontroller and a DAC that sets the current value. Each PCB hosts 4 current controllers, which are connected to the experiment via SMA cables. In order to set a current value on a certain current controller, the host PC sends the corresponding DAC value and channel number to the microcontroller, which programs the DAC via a serial interface. For the microcontroller we chose a Teensy 4.1 (PJRC.com LLC), which contains an Ethernet interface. Through the Ethernet interface we are able to control multiple PCBs from our host PC.\n\n< g r a p h i c s >\n\nWorking principle of the DC current source. A host PC sends current values data to a microcontroller via an Ethernet interface. Subsequently the microcontroller changes the setpoint of the current control circuit via reprogramming the DAC.\n\n#### Current Controller Circuit\nIn the following we give a description of the current controller circuit. In the design, we followed the paper by Ref.\u00a0[Yang,Yu-Meng , Xie,Hong-Tai , Ji,Wen-Chao , Wang,Yue-Fei , Zhang,Wei-Yong , Chen,Shuai , Jiang,Xiao , \"Ultra-low noise and high bandwidth bipolar current driver for precise magnetic field control\", 2019] with some modifications.\nFig.\u00a0(Figure fig:DCSourceCircuit) shows a simplified schematic of the setup.\nFor clarity, details like supply voltages, decoupling capacitors and connectors have been omitted.\n\nAt the heart of the current controller is an operational amplifier that acts as a current source and is configured as an integrator circuit. We chose to use an OPA547 (Texas Instruments Inc.) for this purpose as it can supply large currents of up to 500\u00a0mA and has a low input noise density of $70~\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$ at 1\u00a0kHz. The current output of the amplifier is stabilised using a sense resistor, R$_{\\text{sense}}$, that converts the current to a voltage $V_{\\mathrm{sense}}$. Subtracting $V_{\\mathrm{sense}}$ from a given set voltage, $V_{\\mathrm{set}}$, generates a feedback signal that is used for integral control of the current. In this case, the amplifier itself is acting as the integrator.\n\nIt is important that each part in the circuit has low noise and drift. For sensing the current we chose a metal foil resistor (Vishay Foil Resistor) with a resistance of 500 $\\Omega$ and a temperature coefficient of $\\pm2~\\mathrm{ppm}/^\\circ$C. To acquire $V_{\\mathrm{sense}}$, we first buffer the high-side and low-side of the sense resistor independently using zero-drift operational amplifiers (ADA4522-2, Analog Devices Inc.). The buffered signals are then fed into a precision operational amplifier (AD8422, Analog Devices Inc.) to obtain $V_{\\mathrm{sense}}$. For the subsequent determination of the feedback signal another AD8422 chip is used to obtain $V_{\\mathrm{sense}}-V_{\\mathrm{set}}$.\n\n< g r a p h i c s >\n\nCurrent control circuit. The output current of an operational amplifier is stabilised by integral feedback. The setpoint is generated by a DAC, which is referenced to a precise voltage reference. Details like supply voltages, decoupling capacitors and connectors have been omitted for clarity.\n\nFor generating the set voltage $V_{\\mathrm{set}}$, we are using a AD5063 (Analog Devices Inc.) DAC, which has a resolution of 16-bit and is programmable via a serial interface.\nAs this current source should be bipolar, we are operating the DAC in its bipolar mode, which allows us to set the output voltage from $-V_{\\mathrm{ref}}$ to $+V_{\\mathrm{ref}}$, where $V_{\\mathrm{ref}}$ is the reference voltage supplied to the DAC.\nIt is crucial that $V_{\\mathrm{ref}}$ has low noise and low drift, as it directly influences the output current of the source.\nTo generate $V_{\\mathrm{ref}}$ we are using a ADR4520 (Analog Devices Inc.) voltage reference, which has a temperature coefficient of $\\pm2 ~\\mathrm{ppm}/^\\circ$C and a peak-to-peak noise of 1 $\\mu$V in the frequency range of 0.1\u201310 Hz.\nThe output voltage of the ADR4520 chip is $2.048$ V, which results in an output range of $V_{\\mathrm{set}}$ from $-2.048$ V to $+2.048$ V.\n\nIn our supply design, the current range is given by the sense resistor and the maximum absolute value of $V_{\\mathrm{set}}$. For our choice we get a current range of $\\pm V_{\\mathrm{ref}}/R_{\\mathrm{sense}} = \\pm 4.096$ mA, which is sufficient for our experiments. We are supplying the current controlling amplifier with a voltage of $\\pm 12$ V. This results in a compliance voltage of the supply of $12~\\mathrm{V} - V_{\\mathrm{ref}} \\approx 9.9~\\mathrm{V}$.\n\n#### Current Supply Performance\nTo demonstrate the noise and stability of the current source, we performed measurements of the current amplitude noise and probed the long-term behaviour by measuring the Allan deviation of the current source. Moreover, we tested the current source in experiment by tuning the frequency of a superconducting qubit.\n\n< g r a p h i c s >\n\nHigh frequency amplitude noise of the DC current source. The total  noise in the band of 0.1 Hz to 10 kHz is $1.3\\times 10^{-7}~\\text{A}_{\\text{rms}}$.\n\nWe evaluated the current noise and Allan deviation by DC coupling 1\u00a0mA of current to the $50~\\Omega$ input of a 12-bit digital oscilloscope (LeCroy, Waverunner 610Zi). To determine the current noise, the measured voltage was digitised with a sampling rate of 2\u00a0MS/s and a total measurement time of 30\u00a0s. The full amplitude range of the oscilloscope was set to 80\u00a0mV, which corresponded to a current resolution of 390\u00a0nA. From the time series data we calculated the current amplitude noise using Fast Fourier Transform (FFT). Fig.\u00a0(Figure fig:DCSourceNoise) shows a typical current amplitude noise spectrum. It can be seen that the broadband noise of the supply is below $3\\times 10^{-6}~\\mathrm{A}/\\sqrt{\\mathrm{Hz}}$. Taking the mean value of the amplitude noise in the band of 0.1\u00a0Hz\u201310\u00a0kHz and multiplying it by the square root of the same range, we obtain a total noise value of $5.45\\times 10^{-6}~\\text{A}_{\\text{rms}}$ (0.1\u00a0Hz\u201310\u00a0kHz).\nComparing Fig.\u00a0(Figure fig:DCSourceNoise) to Ref.\u00a0[Yang,Yu-Meng , Xie,Hong-Tai , Ji,Wen-Chao , Wang,Yue-Fei , Zhang,Wei-Yong , Chen,Shuai , Jiang,Xiao , \"Ultra-low noise and high bandwidth bipolar current driver for precise magnetic field control\", 2019], our setup is most likely limited by the noise floor of the  oscilloscope. This, however,  represents the upper limit of our current source noise density.\n\n< g r a p h i c s >\n\nStability measurement of the current source. Depicted (solid line) is the fractional overlapping Allan deviation of a 18 hours long-term current measurement. The bias stability is about $4\\times 10^{-4}$ at 500\u00a0s averaging time. Comparison to a white noise slope (dotted-dashed line) shows that for shorter averaging time the deviation is caused by white noise.\n\nIn order to evaluate the stability of the current source, we performed a long-term measurement of the current, using a sampling rate of 500\u00a0S/s. The full amplitude range of the oscilloscope was set to 40\u00a0mV, which corresponded to a current resolution of 195\u00a0nA. From the time series data we calculated the fractional overlapping Allan deviation. Fig.\u00a0(Figure fig:DCSourceAllan) (blue line) shows the Allan deviation of the current for a 18 hours long measurement. It can be seen that the bias stability of the source is about $4\\times 10^{-4}$ at an averaging time of 500\u00a0s. For comparison we also plot the slope of a white noise source (dotted-dashed line). For smaller averaging times, the source of the Allan deviation of the current is consistent with white noise.\n\n< g r a p h i c s >\n\nTransmission spectrum of a cavity dispersively coupled to a tunable superconducting transmon qubit. Shown are the spectra for current values from -2.0\u00a0mA to 2.0\u00a0mA. In this range the frequency of the qubit is going through 3 periodic changes. A continuous wave using a vector network analyzer was used for the readout drive.\n\nAfter characterising the noise performance of the current source, we tested its capabilities of tuning a superconducting circuit. In this case we measured the transmission of a cavity, which was dispersively coupled to a tunable superconducting transmon qubit. Due to the dispersive coupling, a shift of the qubit frequency directly reflects in the shift of the cavity resonance frequency.\nWe measured the transmission spectrum of the cavity for various bias currents applied to the qubit. Fig.\u00a0(Figure fig:DCSourceLinearity) shows a 2D map of the cavity transmission over a current range of -2.0\u00a0mA to +2.0\u00a0mA. It can be seen that the frequency of the resonator shifts with applied bias current as expected\u00a0[Koch, Jens, Yu, Terri M., Gambetta, Jay, Houck, A. A., Schuster, D. I., Majer, J., Blais, Alexandre, Devoret, M. H., Girvin, S. M., Schoelkopf, R. J., \"Charge-insensitive qubit design derived from the Cooper pair box\", 2007]. Over the measured current range we observe roughly 3 periods of qubit frequency oscillation.\nMeasurement of the qubit decoherence as a function of bias current is outside the scope of this work.\n\n### Software Control & Cloud Access\nIn this section we provide an overview of the layout implemented for software\ncontrol of the RFSoC systems and the cloud-based execution scheduler of pulse\nexperiments.\n\n#### Software Control\nFollowing the layout presented in Section\u00a0<ref>, the RFSoC board used in this project has commands for board configuration, external clock locking, channel synchronisation and starting the FPGA.\n\nThese commands are executed by a central computer (worker) through the use of the Secure Shell (SSH) protocol. We define a Python class  that handles the transfer of user-defined waveforms into the RFSoC, processing of ADC data from the device and execution of the board commands. This class is the interface between experimenter and the RFSoC and provides remote control of the instrument. As this class is written in Python, it can be used alongside other Python instrumentation packages such as \u00a0[Unknown Author, \"Unknown Title\", ],\n[Unknown Author, \"Unknown Title\", ] and \u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe worker communicates with other instruments such as the trigger\nsource for the RFSoc boards, via respective connections. Through these connections, the worker is able to control the triggering for the DACs and the ADCs.  On the worker we define a Python function  that runs a pulse experiment.\nThis function takes in user-defined trigger timings, number of repetitions and pulse sequence and sets up the trigger control and the RFSoC. Then, it starts both devices and runs the pulse sequence. On completion, it returns the FPGA ADC data as the results of the experiment.\n\n#### Cloud Access\nAs the input and output of  is well defined,\nwe can expose it as a cloud service to run experiments remotely. In\nFig.\u00a0(Figure fig:cloud-schematic), we explain our implementation of\nhosting the remote experiment execution on a cloud platform. With this\napproach, we have the Flask server\u00a0[Unknown Author, \"Unknown Title\", ] and Redis\u00a0[Unknown Author, \"Unknown Title\", ]\ndatabase act as a broker between the user and the worker. Neither\nparty directly communicates with each other and the API follows a\nstrict format. Hence, we are able to create a secure environment to\nexecute our experiments remotely.\n\n< g r a p h i c s >\n\nA schematic overview of the cloud access layout\ndeployed in this work. Our implementation of cloud-based\nexperimental control. A user submits the trigger timings,\nnumber of repetitions and the pulse sequence to a\nFlask\u00a0[Unknown Author, \"Unknown Title\", ] server hosted on an Amazon Web Services\n(AWS) EC2 client\u00a0[Unknown Author, \"Unknown Title\", ]. We provide an Application\nProgramming Interface (API) on the Flask server for the user\nto submit and retrieve job results. The job is then stored\non a Redis\u00a0[Unknown Author, \"Unknown Title\", ] database. On the worker, we have a\nPython program  that queries the\ndatabase for new jobs and runs them with\n. The results are then uploaded\nonto the Redis database for the user to retrieve.\n\nFinally, the currently layout will be interfaced to the Qibo\nframework\u00a0[Stavros Efthymiou, Sergi Ramos-Calderer, Carlos Bravo-Prieto, Adri\u00e1n P\u00e9rez-Salinas, Diego Garc\u00eda-Mart\u00edn, Artur Garcia-Saez, Jos\u00e9 Ignacio Latorre, Stefano Carrazza, \"Qibo: a framework for quantum simulation with hardware acceleration\", 2020] in order to automate the process\nof circuit execution.\n\n## Conclusion\nOur setup for superconducting qubit control and measurement was designed with the following goals in mind: to be scalable, to minimise the number of microwave components/instruments to be managed and calibrated, and to have remote access capabilities for the experimenter.\nTo these ends, we opted for the Xilinx RFSoC device with sixteen channels of DAC and ADC with high sampling rate to support direct generation and detection of microwave signals at 5\u20138\u00a0GHz. The approach avoids using physical IQ mixers and eliminates the periodic calibration associated with the mixers.\nWe also designed a circuit that synchronised several RFSoC boards together using a master clock and triggers for the DAC and ADC channels.\nA low-noise DC source was also developed to tune the qubit based on Ref.\u00a0[Yang,Yu-Meng , Xie,Hong-Tai , Ji,Wen-Chao , Wang,Yue-Fei , Zhang,Wei-Yong , Chen,Shuai , Jiang,Xiao , \"Ultra-low noise and high bandwidth bipolar current driver for precise magnetic field control\", 2019].\nThe remote access to the experiment was implemented with an API to a database on a server, where the user can submit abstracted experimental parameters and retrieve the results.\n\nIn the near-term future, a few enhancements to the capabilities are being considered.\nIn particular, the use of more features on the RFSoC device such as the utilising the on-board mixer as an alternative waveform generation and sampling method.\nAt the moment, the readout signals are processed by the master PC, which can be an issue when dealing with a significantly larger number of qubits. To distribute the data processing load, a future consideration is to use the DSP slices on every RFSoC to process its respective ADC data.\nBy combining the feedback control feature and the DSP slices as a fast readout system, it may be possible to signal the switching trigger to activate and the correction pulses can be sent to the appropriate channels according to the qubit state\u00a0[Salath\u00e9, Yves, Kurpiers, Philipp, Karg, Thomas, Lang, Christian, Andersen, Christian Kraglund, Akin, Abdulkadir, Krinner, Sebastian, Eichler, Christopher, Wallraff, Andreas, \"Low-Latency Digital Signal Processing for Feedback and Feedforward in Quantum Computing and Communication\", 2018].\nThe current setup has a relatively low duty cycle for the experiments, which is mostly due to the output data file generation and transferring it out of the RFSoC to the master PC. Improving the experiment duty cycle is currently a work in progress.\nAdditionally, to further support larger number of samples, we will work on memory optimisation and will also consider faster DDR RAMs (such as QUAD channel RAMs) for direct streaming to/from the channels.\n\nWith all of the important features integrated into a single chip, one can consider the idea of migrating the RFSoC device from room temperature into the dilution refrigerator\u00a0[Pauka, SJ, Das, K, Kalra, R, Moini, A, Yang, Y, Trainer, M, Bousquet, A, Cantaloube, C, Dick, N, Gardner, GC, others, \"A cryogenic CMOS chip for generating control signals for multiple qubits\", 2021] for improved SNR and fewer connections to room temperature electronics.\nThis would provide an alternative implementation of cryogenic control electronics based on commercially available devices, in contrast to other possible technologies such as Josephson arbitrary waveform synthesizer\u00a0[Sirois, Adam J., Castellanos-Beltran, Manuel, Fox, Anna E., Benz, Samuel P., Hopkins, Peter F., \"Josephson Microwave Sources Applied to Quantum Information Systems\", 2020] or single-flux technology (SFQ) pulse drivers\u00a0[Leonard, E., Beck, M. A., Nelson, J., Christensen, B.G., Thorbeck, T., Howington, C., Opremcak, A., Pechenezhskiy, I.V., Dodge, K., Dupuis, N.P., Hutchings, M.D., Ku, J., Schlenker, F., Suttle, J., Wilen, C., Zhu, S., Vavilov, M.G., Plourde, B.L.T., McDermott, R., \"Digital Coherent Control of a Superconducting Qubit\", 2019].\nNext, further developments are to take place in the next generations of RFSoC upon their availability.\n\nThis work was supported by the National Research Foundation Singapore, the Ministry of Education  Singapore, Defence Science and Technology Agency Singapore, DSO National Laboratories Singapore and in part by the Air Force Research Laboratory (AFRL) under contract #FA9550-19-S-0003.\n\nAUTHOR DECLARATIONS\n\nConflict of Interest\n\nThe authors have no conflicts to disclose.\n\nAuthor Contributions\n\nKun Hee Park:\u00a0Conceptualization (equal); Data curation (equal); Formal analysis (equal); Investigation (equal); Methodology (equal); Software (equal); Visualization (equal); Writing - original draft (lead); Writing - review & editing (lead).\nYung Szen Yap:\u00a0Conceptualization (equal); Data curation (equal); Formal analysis (equal); Investigation (equal); Methodology (equal); Software (equal); Visualization (equal); Writing - original draft (lead); Writing - review & editing (lead).\nYuanzheng Paul Tan:\u00a0Conceptualization (equal); Data curation (equal); Formal analysis (equal); Investigation (equal); Methodology (equal); Software (equal); Visualization (equal); Writing - original draft (equal); Writing - review & editing (equal).\nChristoph Hufnagel:\u00a0Conceptualization (equal); Formal analysis (equal); Investigation (equal); Methodology (equal); Software (equal); Visualization (equal); Writing - original draft (equal); Writing - review & editing (equal).\nLong Hoang Nguyen: Resources (equal); Software (equal); Visualization (equal).\nKarn Hwa Lau:\u00a0Software (equal); Writing - review & editing (equal).\nPatrick Bore: Data curation (equal); Formal analysis (equal); Investigation (equal); Software (equal); Writing - review & editing (equal).\nStavros Efthymiou:\u00a0Writing - original draft (equal).\nStefano Carrazza:\u00a0Writing - original draft (equal).\nRangga P. Budoyo:\u00a0Resources (equal).\nRainer Dumke:\u00a0Conceptualization (lead); Funding acquisition (lead); Methodology (lead); Project administration (lead); Supervision (lead); Writing - original draft (equal); Writing - review & editing (equal).\n\nDATA AVAILABILITY\n\nThe data that support the findings of this study are available from the corresponding author upon reasonable request.\n\nAPPENDIX\n\nGauss Sum Factorization\n\nGauss sum factorization is an algorithm using qubit superposition to factorize large numbers\u00a0[Gilowski, M, Wendrich, T, M\u00fcller, T, Jentsch, C, Ertmer, W, Rasel, EM, Schleich, WP, \"Gauss Sum Factorization with Cold Atoms\", 2008]. While the current implementation for superconducting qubits does not yield an advantage over classical factorization algorithms, this algorithm can be used to demonstrate qubit control.\n\nUsing the $\\pi$-pulse and $\\pi/2$-pulse from the earlier sections, we apply the factorization algorithm (Fig.\u00a0(Figure fig:fig1)) using the ICARUS-Q RFSoC for $N=263193$ and $M=15$.\n\nWe inspect the discernability $\\mathcal{D}$ between factors and non-factors. The greater the value of $\\mathcal{D}$, the easier it is to identify actual factors over non-factors. $\\mathcal{D}$ is determined by the difference between the probabilities for the worst performing factor and the non-factor closest to 1. In an earlier work\u00a0[Zaw, LH, Tan, YP, Nguyen, Lh, Budoyo, RP, Park, Kh, Koh, Zy, Landra, A, Hufnagel, C, Yap, YS, Koh, TS, Dumke, R, \"Ghost factors in Gauss-sum factorization with transmon qubits\", 2021], we have calculated the upper limit of $\\mathcal{D}$ as $0.67$. In this experiment, we have obtained a value of $\\mathcal{D}$ as 0.195 (see Fig.\u00a0(Figure fig:fig2)) compared to the previously reported experimental value of 0.4. The difference between these two experiments are the qubits and the number of measurements per data point, which causes the different discernibility. Hence, we have successfully demonstrated the execution of the factorization algorithm on the ICARUS-Q platform.\n\n< g r a p h i c s >\n\nPulse sequence for Gauss sum factorization. A $\\pi/2$-pulse phase shifted by $\\pi/2$ is used to rotate the qubit to the superposition state. Next, a train of $m$ $\\pi$ pulses is applied to the qubit. The phase of the first $\\pi$-pulse is 0 and the $k$-th pulse is $(-1)^k\\pi(2k-1)N/l$ where $N$ is the number to factorize and $l$ is the trial factor. Finally, a $\\pi/2$-pulse phase shifted by $\\pi/2$ is used to rotate the system back to the computational basis. If $l$ is a factor of $N$, the phase will be an integer number of $\\pi$ and the $\\pi$-pulse train will be in phase, causing the final $\\pi/2$ rotation to rotate the system to $\\ket{1}$. Otherwise, an arbitrary rotation of the system will occur. The sequence is repeated for $m$ in 1 to $M$, where $M$ is the total number of pulses to be used and the results are averaged by $M$. This is to reduce the impact of arbitrary non-factor rotations that may end up near $\\ket{1}$. A delay $\\tau$ is applied between pulses.\n\n< g r a p h i c s >\n\nExcited state probability for each trial factors up to 200 in the factorization of $263193$. We apply the preprocessing technique in \u00a0[Zaw, LH, Tan, YP, Nguyen, Lh, Budoyo, RP, Park, Kh, Koh, Zy, Landra, A, Hufnagel, C, Yap, YS, Koh, TS, Dumke, R, \"Ghost factors in Gauss-sum factorization with transmon qubits\", 2021] to skip over multiples of $2$ and $5$ as they provide bad contrast compared to the actual factors. The expected factors in this regime are $3, 7, 21, 83, 151$ (highlighted in red). We can see that the major peaks near 1 correspond to the factors, allowing us to identify factors and composite factors. The lowest excited state probability for the factors is 0.834 while the highest excited state probability of the non-factors is 0.639 at $l=27$. The behaviour of this non-factor is discussed in more detail in Ref.\u00a0[Zaw, LH, Tan, YP, Nguyen, Lh, Budoyo, RP, Park, Kh, Koh, Zy, Landra, A, Hufnagel, C, Yap, YS, Koh, TS, Dumke, R, \"Ghost factors in Gauss-sum factorization with transmon qubits\", 2021].\n\n"}
{"prompt": "What are the main findings of the paper 'Paper 2006.04718'?", "completion": "\n\nAIP/123-QED\n\nMaterials loss measurements using superconducting microwave resonators]Materials loss measurements using superconducting microwave resonators\n\ncoreyrae.mcrae@colorado.edu\n\nDepartment of Physics, University of Colorado, Boulder, Colorado 80309, USA\n\nNational Institute of Standards and Technology, Boulder, Colorado 80305, USA\n\nJILA, University of Colorado, Boulder, Colorado 80309, USA\n\nBoulder Cryogenic Quantum Testbed, University of Colorado, Boulder, Colorado 80309, USA\n\nDepartment of Physics, University of Colorado, Boulder, Colorado 80309, USA\n\nNational Institute of Standards and Technology, Boulder, Colorado 80305, USA\n\nJILA, University of Colorado, Boulder, Colorado 80309, USA\n\nBoulder Cryogenic Quantum Testbed, University of Colorado, Boulder, Colorado 80309, USA\n\nDepartment of Physics, University of Colorado, Boulder, Colorado 80309, USA\n\nNational Institute of Standards and Technology, Boulder, Colorado 80305, USA\n\nNational Institute of Standards and Technology, Boulder, Colorado 80305, USA\n\nHRL Laboratories,\nMalibu, California 90265, USA\n\nGoogle Inc.,\nMountain View, California 94043, USA\n\nNational Institute of Standards and Technology, Boulder, Colorado 80305, USA\n\nGoogle Inc.,\nMountain View, California 94043, USA\n\nBoulder Cryogenic Quantum Testbed, University of Colorado, Boulder, Colorado 80309, USA\n\nThe performance of superconducting circuits for quantum computing is limited by materials losses. In particular, coherence times are typically bounded by two-level system (TLS) losses at single photon powers and millikelvin temperatures. The identification of low loss fabrication techniques, materials, and thin film dielectrics is critical to achieving scalable architectures for superconducting quantum computing. Superconducting microwave resonators provide a convenient qubit proxy for assessing performance and studying TLS loss and other mechanisms relevant to superconducting circuits such as non-equilibrium quasiparticles and magnetic flux vortices. In this review article, we provide an overview of considerations for designing accurate resonator experiments to characterize loss, including applicable types of loss, cryogenic setup, device design, and methods for extracting material and interface losses, summarizing techniques that have been evolving for over two decades. Results from measurements of a wide variety of materials and processes are also summarized. Lastly, we present recommendations for the reporting of loss data from superconducting microwave resonators to facilitate materials comparisons across the field.\n\nINTRODUCTION\n\nSuperconducting quantum computers consist of two basic components: the qubit, which is used to manipulate quantum information, and the superconducting microwave resonator, a multipurpose component used for qubit protection and readout <cit.> as well as qubit-qubit coupling <cit.> and quantum memory <cit.>.\n\nAt millikelvin temperatures and single photon powers, loss in both qubits and resonators is thought to be dominated by coupling to two-level systems (TLS) that may be present in device materials. Microwave energy in the device can couple to an ensemble of defects in nearby amorphous material, causing energy decay <cit.>. Although the origin of TLS loss is still up for debate <cit.>, it is known that TLS loss is generated largely in bulk dielectrics and at the interfaces between materials <cit.>. Resonators are useful test structures for measuring TLS loss due to their simplicity in design, fabrication and measurement, and their sensitivity to loss at low temperatures and photon number. Resonators can also be measured over a wider range of photon occupation and temperatures than qubits, allowing for exploration of defects over a large experimental parameter regime. While some loss mechanisms are specific to qubit implementations and Josephson junction circuit elements, non-junction-related loss mechanisms can be investigated with resonators.\n\nAccurate resonator measurements allow us to engineer interfaces and circuit designs to identify regions that contribute to loss as well as to identify low-loss materials in order to decrease the qubit footprint and enable multilayer architectures. Resonator measurements can also provide information about losses due to microwave and cryogenic experimental issues, including magnetic <cit.> and radiative <cit.> losses.\n\nIn this review, we introduce the general properties of superconducting microwave resonators (Sec.\u00a0<ref> and summarize in detail the best practices of resonator measurements. These include the evaluation of applicable losses mechanisms (Sec.\u00a0<ref>), cryogenic and electronic experimental set-up (Sec.\u00a0<ref>), and experimental decisions involved in device design and fabrication (Sec.\u00a0<ref>). Finally, we present a summary of existing TLS loss measurements (Sec.\u00a0<ref>) and suggest additional parameters to report in future studies. This provides an overview of metrics that are comparable across various material sets and device implementations.\n\nTHE SUPERCONDUCTING MICROWAVE RESONATOR\n\nA basic resonator circuit, Fig.\u00a0(Figure fig:circuits), consists of an inductive component with inductance $L$ coupled to a capacitive component with capacitance $C$. Energy stored in the resonator oscillates between the inductor (stored as current) and the capacitor (stored as charge) with a resonance frequency $f_0$ determined by\n$$\n\nf_0 = \\frac{1}{2 \\pi \\sqrt{L C}},\n\n$$\nneglecting any external coupling. To take advantage of commercial microwave test and measurement equipment as well as commercial RF components, superconducting microwave resonators for quantum computing are generally designed to have resonance frequencies between 4 and 8 GHz. The resonator circuits commonly consist of thin film superconducting metals and thin film dielectrics, with typical thicknesses in the range of hundreds of nanometers, patterned on a crystalline dielectric substrate hundreds of micrometers thick <cit.>.\n\nIn practice, the resonator, like all superconducting circuits, is coupled to energy dissipation channels, causing loss and reducing its ability to store energy. For superconducting microwave resonators, loss is low compared to normal metal resonators due to the low dissipation nature of the superconducting metal. We can combine all the resonator losses into an effective resistance $R$.\nThe resonator also has input impedance $Z_{in}$, defined as:\n$$\n\nZ_{in} = (\\frac{1}{R} + \\frac{1}{i \\omega L} + i \\omega C)^{-1},\n\n$$\n$Z_{in}$ can be plotted as a function of frequency and behaves as a Lorentzian, similar to that in Fig.\u00a0(Figure fig:S21plot)(a)-(c).\n\nTo quantify resonator performance, we define a dimensionless quantity, the quality factor, as\n$$\n\nQ = \\frac{2 \\pi f_0 W}{P_{\\mathrm{R}}},\n\n$$\nwith total time-averaged energy $W$ and power loss due to the resistor defined as\n$$\n\nP_{\\mathrm{R}} = \\frac{|V|^2}{2R},\n\n$$\nwhere $V$ is the voltage on the resistor $R$ <cit.> for a parallel RLC resonator\u00a0(Fig.\u00a0(Figure fig:circuits)). In general terms, the quality factor describes the ratio of the total energy stored near resonance and the total energy loss in the system. Qualitatively, as  $Q$ increases, the resonance line-shape becomes sharper.\n\n< g r a p h i c s >\n\nCircuit diagrams of three measurement orientations of parallel RLC resonators. (a) Resonator in hanger mode, capacitively coupled to a feedline for measurement in transmission. $V_g$ is the source voltage, $R_0$ is the source and load impedance which is often equal to the transmission characteristic impedance $Z_0$ for impedance matching, and $V_{2}$ is the load voltage. The arrows on the voltages indicate the direction of the microwaves being measured. (b) Resonator in transmission mode, capacitively coupled to an input and an output feedline. (c) Resonator in reflection mode, capacitively coupled to the end of a feedline.\n\n< g r a p h i c s >\n\nSimulated $S_{21}$ response of a 5 GHz resonator\u00a0[Fig.\u00a0(Figure fig:circuits)\u00a0(a)] in hanger mode with $Q_i=22,000$ and $Q_c=2,200$, with the red dot indicating resonance frequency, on (a) the complex plane, (b) amplitude as a function of frequency, and (c) phase as a function of frequency. The resonator impedance $Z_{in}$ has similar Lorentzian behavior.\n\n< g r a p h i c s >\n\nThree common resonator implementations. (a) Al on Si lumped element resonator with a meandered inductor (below) connected to an interdigitated capacitor (above) and inductively coupled to a feedline. (b) Al on Si $\\lambda$/4 CPW resonator capacitively coupled to a feedline. (c) 3D resonant cavity made of high purity Al.\n\nA resonator is normally connected to the measurement circuit through capacitive and/or inductive coupling, which contributes to the resonator quality factor. Thus, the total quality factor $Q$ can be divided into an internal and coupling component, as\n$$\n\n\\frac{1}{Q} = \\frac{1}{Q_i} + \\frac{1}{Q_c},\n\n$$\nwhere $Q_c$ is the coupling quality factor and is defined as the rate at which energy stored in the resonator escapes into the larger circuit, and $Q_i$ is the internal quality factor and is defined as the rate at which energy is lost to parasitic effects of the environment. The loading will shift the resonance frequency  downwards, which is normally negligible as long the coupling capacitance and inductance is small compared to the C and L values of the resonator.\n\n$Q_c$ is a design parameter as it is determined by specifying the admittance to ground through coupling capacitance and mutual inductance between the resonator and transmission feedline. Conversely, $Q_i$ is determined by the intrinsic losses within the resonator itself, and can thus be used as a performance metric of the resonator.\n\nThe inverse of resonator $Q_i$ is sometimes represented as the loss tangent, as\n$$\n\n\\frac{1}{Q_i} = \\tan{\\delta} \\simeq \\delta\n\n$$\nfor loss $\\delta$ and $\\tan{\\delta} < 10^{-2}$. Loss is a convenient metric for distinguishing between multiple contributions to performance, as loss contributions add linearly. $Q_i$, $\\tan{\\delta}$, and $\\delta$ are all used to compare resonator performance in different contexts, where $\\tan{\\delta}$ and $\\delta$ are generally used to denote performance when loss mechanisms are being analyzed, and $Q_i$ is used to compare general performance, especially for high-performance devices.\n\nAlthough $\\tan{\\delta}$ conventionally refers to dielectric loss, $\\delta$ will be used in this review to refer to any loss, regardless of dissipation channel.\n\nResonators are typically characterized with a vector network analyzer (VNA). To measure a resonator with a VNA, microwave signals are sent into the circuit input port (port 1) through a feedline coupled to the resonator, and the response is measured through the output port (port 2). The amplitude and phase of the signal are sampled, achieving an $S_{21}$ measurement. The complex $S_{21}$ can be visualized by breaking it into a magnitude and phase component, or into a real and imaginary component, as shown in Fig.\u00a0(Figure fig:S21plot). One can extract $Q_i$, $Q_c$ and $f_0$ from this data by fitting to a Lorentzian model over several bandwidths surrounding the resonance frequency.\n\nResonator circuits can be designed in several form factors. Fig.\u00a0(Figure fig:resonator_micrograph) shows examples of three common resonator geometries. Lumped element resonators [Fig.\u00a0(Figure fig:resonator_micrograph)(a)] consist of discrete inductive and capacitive components connected together. Distributed element resonators like coplanar waveguide (CPW) [Fig.\u00a0(Figure fig:resonator_micrograph)(b)] and microstrip resonators do not have discrete capacitors and inductors, but rather consist of a transmission line segment with some capacitance and inductance per unit length. These are usually meandered in order to minimize their on-chip footprint. 3D cavity resonators [Fig.\u00a0(Figure fig:resonator_micrograph)(c)] differ from the types above as they are not formed by integrated circuits on a chip but rather as empty volumes within superconducting walls, the geometrical boundary conditions of which determine resonant modes. Both superconducting qubits and input/output circuitry can be coupled to the 3D cavity modes via radiative antennae. By completely eliminating bulk dielectric loss and storing a large fraction of the energy in vacuum, 3D cavities can attain the highest quality factors of these three types of resonators. While machined blocks of superconducting metal are bulky, micromachined 3D cavities embedded within stacks of bonded silicon wafers have reached quality factors as high as 300 million <cit.>, and show promise for use in multilayer microwave integration\n<cit.>.\nAdditionally, microwave resonators that do not fit neatly into these three categories include those featuring planar multilayer structures such as vacuum-gap transmission lines <cit.>.\n\nCurrently, in the field of superconducting quantum computing, CPW resonators are most commonly implemented due to their ease of design, single-layer lithographic fabrication, and ability to circumvent lossy dielectrics. CPWs consist of a center conductor several micrometers wide separated from ground planes on either side by a gap of a few micrometers. The conductor and ground planes are composed of superconducting metal and are positioned on a dielectric substrate.\n\nMEASUREMENT SETUP\n\nA dilution refrigerator (DR) is commonly used to cool devices to millikelvin operating temperatures. Fig.\u00a0(Figure fig:cryosetup) shows a typical DR wiring diagram for resonator control and readout between millikelvin and ambient temperatures. In order to minimize noise and sufficiently thermalize input cables at 4\u00a0K and 15\u00a0mK stages, a series of cryogenic attenuators, sometimes combined with filters, are connected along the input line. Amplifiers and isolators are connected to the output in order to allow signal readout through a vector network analyzer (VNA) <cit.>. An adiabatic demagnetization refrigerator (ADR) can be set up similarly for this purpose, but the presence of magnetic fields may detract from the reliability of the measurement.\n\nDue to the extreme environment, small measurement signal, and susceptibility to environmental coupling, superconducting microwave resonators can be deceptively difficult to measure accurately. Impedance mismatches in the measurement largely come from components inside the DR, which are not commonly included in calibration and can affect measurement accuracy. Microwave setup, measurement mode, thermalization, and number of photons inside the resonator all play significant roles in measurement outcomes. Magnetic shielding and IR absorption and filtering can be implemented to minimize losses due to trapped vortices and RF induced quasiparticles, as discussed in Sec.\u00a0<ref>.\n\nSample packaging can also affect measurement outcomes. Unless carefully designed, box modes can be present that couple to the resonator. Normal metals situated close to the device such as in silver paint can lead to irreproducible high power losses. Al, Cu, and gold-coated Cu are all commonly used packaging materials and exhibit different magnetic shielding and thermalization behavior. Refer to [Lienhard, Benjamin, Braum\u00fcller, Jochen, Woods, Wayne, Rosenberg, Danna, Calusine, Greg, Weber, Steven, Veps\u00e4l\u00e4inen, Antti, O'Brien, Kevin, Orlando, Terry P, Gustavsson, Simon, others, \"Microwave packaging for superconducting qubits\", 2019] and [Rosenberg, D, Weber, S, Conway, D, Yost, D, Mallek, J, Calusine, G, Das, R, Kim, D, Schwartz, M, Woods, W, others, \"3D integration and packaging for solid-state qubits\", 2019] for detailed discussions.\n\n< g r a p h i c s >\n\nStandard wiring diagram of a measurement setup for a superconducting resonator in a dilution refrigerator (DR). A vector network analyzer (VNA) is used for resonator excitation and readout. On the input line (left), attenuators at each temperature stage are used for thermalization and minimizing thermal noise. On the output (right), 40\u00a0dB double stage isolators can be implemented for blocking radiation from the output line. A high mobility electron transistor (HEMT) at 4\u00a0K and an amplifier at room temperature are used to amplify the output signal.\n\n### Microwave Components and Wiring\nStainless steel coaxial cables are widely used in superconducting quantum computing experiments, especially to connect the room temperature plate of the refrigerator to the 4\u00a0K plate, due to their low loss, moderate thermal conductivity, and low passive thermal loads. From 4\u00a0K down to 15\u00a0mK, cables made of superconductors such as NbTi are commonly used to reduce loss and increase thermal isolation. At the base temperature plate, cryogenic coaxial semi-rigid cables are used for connecting different components and devices. Besides the cable materials, thermalizing microwave lines can be achieved with cavity attenuators <cit.> and specialized microwave attenuators <cit.>.\n\nIn order to reduce the room temperature thermal noise to at least two orders of magnitude lower than the single photon power level, the input line needs roughly 60\u00a0dB of added attenuation <cit.>, which is typically achieved by placing attenuators at different temperature stages, as in Fig.\u00a0(Figure fig:cryosetup).\nWhile the input signal is heavily attenuated, the output line has at least two stages of amplification, the first being a 40\u00a0dB high electron mobility transistor (HEMT) amplifier located at the 4\u00a0K stage, where $T_{noise}$\u00a0$\\sim$\u00a02.2\u00a0K, about an order of magnitude higher than vacuum noise at 6 GHz. This is followed by a 30\u00a0dB amplifier at room temperature to amplify the output signal sufficiently for VNA measurement. Based on the Friis formula <cit.>, the noise factor of the first amplifier sets the noise floor of the amplification chain. Thus, although HEMT is a high gain low noise amplifier, a quantum limited amplifier like a Josephson parametric amplifer\u00a0(JPA) <cit.> or Josephson parametric converter\u00a0(JPC) <cit.> can be used to increase the signal to noise ratio\u00a0(SNR).\n\nOn the output, the same level of attenuation as the input is required. Since the HEMT can block radiation from above the 4\u00a0K plate, a double-stage isolator with total isolation of nearly 40\u00a0dB is commonly mounted to the 15\u00a0mK stage. As these isolators contain magnets, careful placement is essential in order to avoid magnetic loss.\n\n### Impedance Matching and Calibration\nSMA connectors, coaxial cables, wirebonds, and on-chip transmission lines often have impedances deviating from $50~\\Omega$. A mismatch between these components and the $50~\\Omega$ VNA source impedance creates unwanted reflections, causing ripples in the transmission baseline and an asymmetric resonance lineshape, and impeding $Q_i$ and $Q_c$ extraction. These reflections can also lead to overestimation of power at the resonator. Calibration of the microwave environment can correct these errors. The commonly used two-port thru-reflect-line (TRL) and short-open-load-thru (SOLT) calibration methods <cit.> require known standards at cryogenic temperatures which are not easily obtained. In addition, the non-reciprocal microwave environment increases the calibration difficulty: directional couplers or circulators and microwave switches are needed to separate reflection signals from calibration elements. Thus, it is common to perform bench top calibration using the VNA manufacturer calibration kit and assume coaxial cables and microwave components perform similarly at room temperature and when cooled. However, the electrical and mechanical properties of the materials of cables and other components at low temperature will change, and thus cause impedance mismatches when applying the room temperature calibration. [Ranzani, Leonardo, Spietz, Lafe, Popovic, Zoya, Aumentado, Jos\u00e9, \"Two-port microwave calibration at millikelvin temperatures\", 2013] demonstrates a method for two-port calibration at base temperature which implements a calculation of the error matrix elements and uses extra setup hardware. A millikelvin calibration method performed by the VNA itself is an existing goal in the superconducting quantum computing field. Since $S_{21}$ is the crucial parameter in these experiments, one-port calibration alone could be effective enough for calibrating the measurement setup chain.\n\n### Measurement Mode and Fitting\nA resonator can be measured in three commonly used modes: hanger\u00a0[Fig.\u00a0(Figure fig:circuits)(a)] <cit.>, transmission\u00a0[Fig.\u00a0(Figure fig:circuits)(b)] <cit.>, and reflection\u00a0[Fig.\u00a0(Figure fig:circuits)(c)] <cit.>. The hanger mode is realized by coupling a resonator to a transmission feedline which is connected to the measurement environment directly. This mode results in a Lorentzian lineshape with a dip in magnitude at the resonance frequency and a phase shift lower than $\\pi$. As illustrated in Fig.\u00a0(Figure fig:circuits)(a), the total complex $S_{21}(f)$ can be represented by the ratio of the output voltage $V_2$ to the source voltage $V_g$ as $S_{21}$=2$V_{2}/V_g$, or in terms of quality factor, as\n$$\n\\label{eqn:hanger}\nS_{21}(f) =1-\\frac{\\frac{Q}{Q_c}}{1+2 i Q \\frac{f-f_{0}}{f_{0}}},\n\n$$\nwhere $f_{0}$ is the resonance frequency. One advantage of hanger mode is its natural frequency multiplexing: devices can be designed such that multiple resonators share a microwave input and output line on a single package or chip.\n\nTransmission mode is commonly used for directly measuring half-wave ($\\lambda/2$) CPW resonators <cit.>. It results in a Lorentzian line shape with a peak in magnitude at the resonance frequency and a $\\pi$ phase shift <cit.>. The total complex $S_{21}(f)$ can be represented as\n$$\n\\label{eqn:transmission}\nS_{21}(f) = \\frac{\\frac{Q}{Q_c}}{1+2 i Q \\frac{f-f_{0}}{f_{0}}},\n\n$$\nwhich is a mirror image of a hanger-type resonance. A drawback of inline transmission resonator measurements is that calibrating unity transmission is difficult because cable loss and resonator loss become indistinguishable <cit.>, thus reducing quality factor accuracy.\n\nThe reflection mode is realized by coupling the resonator to the input microwave transmission directly through a capacitor or inductor and then measuring the reflection. Since the reflected signal cannot be detected directly at the input port, a non-reciprocal device must be adopted. By using a circulator or a directional coupler to separate the incoming signal to the resonator and the reflection from the resonator, the transmission $S_{21}$ can represent the reflection to the input and can be described by <cit.>\n$$\n\\label{eqn:reflection}\nS_{21}(f) =1-\\frac{2\\frac{Q}{Q_c}}{1+2 i Q \\frac{f-f_{0}}{f_{0}}},\n\n$$\ndiffering from the hanger case by a factor of 2 in signal. The line shape is also a Lorenztian dip in magnitude, but the phase shift can be $2\\pi$, $\\pi$ or less than $\\pi$, depending the ratio between $Q_i$ and $Q_c$.\n\nEqs.\u00a0<ref>-<ref> assume perfect impedance matching to the environment and a flat, featureless background, which are assumptions rarely satisfied by measured $S_{21}$ data. In order to extract $Q_c$, $Q_i$ and $f_0$ from measurement, some background normalization or removal method, as well as a correction of the rotation angle $\\phi$, must be implemented. $\\phi$ describes the rotation of the resonance circle in an Im($S_{21}$) v.s. Re($S_{21}$) plot, as in Fig.\u00a0(Figure fig:S21plot)\u00a0(a), with respect to the off-resonance point (1,0) as well as the asymmetry of the resonance lineshape in an $S_{21}$ v.s. $f$ plot [Fig.\u00a0(Figure fig:S21plot)\u00a0(b) and (c)] <cit.>.\n\nA summary of common fitting models and methods for hanger mode measurements are outlined below. To the authors' knowledge, there exist no methods for correcting rotation caused by impedance mismatch in transmission and reflection measurement modes, leading to inaccuracies not present in hanger mode fitting.\n\nThe $\\phi$\u00a0rotation method ($\\phi$RM) <cit.> was the first fitting method to take impedance mismatch into account, with the model\n$$\n\\label{eqn:phiRM}\nS_{21}(f) =1-\\frac{\\frac{Q}{Q_c} e^{i\\phi}}{1+2 i Q \\frac{f-f_{0}}{f_{0}}},\n\n$$\nwhere $e^{i\\phi}$ is used to account for circuit asymmetry. A circle fit, rotation and translation to origin, and phase angle fit are implemented to determine an initial guess of parameters, followed by a direct fit to Eq.\u00a0<ref>.\n\nThe diameter correction method (DCM) <cit.> modifies the $\\phi$RM as\n$$\n\\label{eqn:DCM}\nS_{21}(f) =1-\\frac{Q / \\hat {Q}_c}{1+2 i Q \\frac{f-f_{0}}{f_{0}}},\n\n$$\nwhere $\\hat {Q}_c = Q_c e^{-i\\phi}$ is the complex coupled quality factor. By accounting for the origin of the rotation as a component of $Q$, a correction of $1/(\\cos(\\phi)-1)$ is applied to the $Q_i$ value, which increases in magnitude with increasing circuit asymmetry.\n\nThe inverse $S_{21}$ method (INV) <cit.> uses the model $$\n\\label{eqn:INV}\nS_{21}^{-1}(f) = 1+\\frac{Q_i}{Q^{\\ast}_c}e^{i \\phi}\\frac{1}{1+2 i Q_i \\frac{f-f_{0}}{f_{0}}},\n\n$$\nwhere $Q_c^* = (Z_0/|Z|) Q_c$ is the rescaled coupling quality factor,\n$Z_0$ is the cable impedance, and $Z = |Z|e^{i\\phi}$ is half the inverse sum of the environment impedances on the input and output sides of the resonator. Similarly to the DCM model, the coupled quality factor is used to absorb the impedance mismatch in order to return $Q_i$ accurately. However, unlike DCM, INV cannot be used to determine $Q_c$ without environment impedance, which is very difficult or impossible to determine.\n\nIn practice, DCM and INV give largely similar values for $Q_i$, though an exhaustive comparison has yet to be performed, while $\\phi$RM systematically overestimates $Q_i$ as a function of $\\phi$. Python fitting code exists for all fitting methods mentioned above,[https://github.com/Boulder-Cryogenic-Quantum-Testbed/measurement/] as well as the lesser-known closest pole and zero method (CPZM) <cit.>, and allows for straightforward comparison between these methods.\n\nIn measured $S_{21}$ data, total signal transmission is shifted from $0$\u00a0dB by the total attenuation, losses and amplification in the measurement setup. As well, a nonlinear background exists due to external reflections, which cause ripples in transmission, and parasitic modes, which cause broad resonance features. Normalization is required in order to fit the data into the models above.\n\nWhen $Q$ is high enough, the resonance linewidth is much smaller than the background features and a linear normalization can be used by performing a linear fit to off-resonant points on either side of the resonance. Alternatively, a high-temperature background removal can be performed <cit.> by heating the circuit to $T_c/2 < T < T_c$, where thermally-populated quasiparticles decrease $Q_i$ to the point that a resonance is no longer visible, and using the resulting spectrum as a background to be subtracted from the resonance data.\n\nThe effects of normalization on reported $Q_i$ and $Q_c$ are not well-understood, so the use of a traceable protocol is essential for fit reproducibility.\n\n### Temperature and Thermalization\nIn order to avoid thermally-populated quasiparticle loss\u00a0<cit.>, resonator measurements are normally performed at temperatures lower than one tenth of the superconducting transition temperatures $T_c$ of the electrode material. Common superconductors used in microwave circuits have $T_c$ between 1.2 and 18\u00a0K. DR systems are ideal for resonator measurements as their standard base temperature is less than 20\u00a0mK and can operate at base temperature indefinitely. A low measurement temperature is also critical for reporting accurate TLS loss, as TLS loss decreases as temperature increases in the low temperature regime (as shown in Fig.\u00a0(Figure fig:TLSTheoCurves)). Insufficient sample thermalization keeps the resonator at a higher temperature than the cold plate of the refrigerator and artificially lowers the loss extracted from measurement. Thus, to avoid systematically under-reporting loss, thermalization the resonator is crucially important.\n\nResonator thermalization methods include using oxygen-free high thermal conductivity copper to act as an ideal cold resistor and thermal link for sample thermalization, and shielding the sample from black-body radiation from higher temperature stages. On-chip refrigeration can also be performed <cit.> at the cost of both increasing the amount of processing the chip is exposed to as well as adding normal metal to the sample, which itself can introduce loss. However, there is ambiguity in the literature about the degree to which chips are thermalized in conventional work. As reported by [Geerlings, K, Shankar, S, Edwards, E, Frunzio, L, Schoelkopf, RJ, Devoret, MH, \"Improving the quality factor of microwave compact resonators by optimizing their geometrical parameters\", 2012], when mounted on the mixing chamber plate of a dilution refrigerator with temperature of $\\textrm{15~mK}$, the effective sample temperature could be as high as $\\textrm{50~mK}$.\n\n### Vortex Loss Mitigation\nVortex loss has been shown to cause up to 10$\\%$ of measured loss, and can be suppressed by magnetic field shielding <cit.>. Because magnetic shielding is effective and can be easily implemented <cit.>, it is commonly utilized in loss measurements. The use of vortex-pinning hole arrays <cit.> is another widely-used method, requiring at least 6\u00a0$\\mathrm{\\mu}$m of separation between the vortex-pinning hole arrays and the CPW center trace <cit.> in order to avoid increasing TLS participation. Trenching a slot on the center strip of CPW resonator is another straightforward method for reducing loss due to trapped vortices <cit.>. Single vortices trapped at current anti-nodes of CPW resonators can reduce quasiparticle loss <cit.>. Although these vortex trapping techniques can help achieve higher $Q_i$ values, implementing them adds an extra level of complexity of fabrication and measurement.\n\n### Measurement Variability\nResonator loss variability has been observed for a single resonator over different cooldowns <cit.>, for nominally identical resonators on different chips <cit.>, and for a single resonator over time <cit.>. All of these types of resonator loss variability warrant more in-depth study.\n\nRepeated measurements of the exact same resonator have been shown to yield different $Q_i$ values at both low and high power, though the variation at high power is more pronounced (at a difference of up to two times or more), but show no change in intrinsic TLS loss <cit.>. This cooldown-to-cooldown variability can be attributed to changes in power-independent losses, and emphasizes the benefit of performing a TLS loss extraction rather than reporting the low power loss.\n\nResonators exposed to the same processing conditions on the same chip can fall within a range of $Q_i$ and $Q_c$ values. [Ohya, S, Chiaro, B, Megrant, A, Neill, C, Barends, R, Chen, Y, Kelly, J, Low, D, Mutus, J, O\u2019Malley, PJJ, others, \"Room temperature deposition of sputtered TiN films for superconducting coplanar waveguide resonators\", 2013] reports $Q_c$ values varying by more than an order of magnitude, and $Q_i$ varying by up to an order of magnitude. It is possible to explain the change of $Q_c$ by small variations in microwave set-up and environment between measurements. Variations in $Q_i$ indicate that there are some subtleties in fabrication that are difficult to control. Thus, the loss measurement of a single resonator could have associated uncertainty of up to an order of magnitude.\n\nTime fluctuations of $1/Q_i$ due to TLS loss have been seen to scale with the magnitude of the loss and fluctuate at $\\sim 20\\%$ of the mean <cit.>. Further characterization of this phenomenon is warranted.\n\nMETHODS FOR MATERIALS LOSS MEASUREMENTS USING RESONATORS\n\n< g r a p h i c s >\n\nRegions of TLS loss in a planar superconducting circuit with electric field lines shown in black.  Light green: superconducting metal (no TLS contribution). Dark green: Metal-air (MA) interface. Light pink: Dielectric substrate. Dark pink: Substrate-air (SA) interface. Red: Metal-substrate (MS) interface. Light blue: thin film dielectric in a parallel-plate configuration.\n\nThe term \u201cmaterials loss\u201d encompasses all forms of intrinsic loss induced in a superconducting microwave resonator due to its constituent materials and interfaces. The main source of materials loss in planar devices is TLS loss, but other types such as piezoelectric loss are applicable in rare instances.\n\nMaterials loss is present in three general regions, as shown in Fig.\u00a0(Figure fig:lossschematic): in bulk dielectrics such as substrates, in thin film dielectrics such as Josephson junctions and deposited dielectrics, and in surfaces and interfaces between materials. In high performance superconducting microwave circuits for quantum information, surfaces and interfaces can have the highest loss, up to $10^{-2}$ <cit.>, while intrinsic crystalline bulk dielectric substrates can have the lowest, $\\le 10^{-7}$, <cit.> and deposited dielectrics vary between $10^{-2}$ and $10^{-5}$ <cit.>.\n\n3D cavity resonators obviate both radiative and bulk dielectric losses by maximizing the participation of vacuum. They are susceptible only to loss in the cavity wall's surface oxide and conductor loss extending into the wall a distance of the London penetration depth <cit.>. Cavities have also been used intentionally to measure bulk dielectric loss <cit.>.\n\nThe low power loss $\\delta_{\\mathrm{LP}}$, the resonator-induced intrinsic TLS loss $F \\delta^0_{\\mathrm{TLS}}$ or simply the material's intrinsic TLS loss $\\delta^0_{\\mathrm{TLS}}$ are the most common metrics used to compare losses. The TLS loss is extracted from a power or temperature sweep using Eq.\u00a0<ref> or Eq.\u00a0<ref>, while $\\delta_{\\mathrm{LP}}$ is the loss at some \u201clow enough\u201d power, typically on the order of a single photon occupation in the resonator, where it is expected that TLS loss contribution is dominant. This is often determined empirically when loss plateaus at low power.\n\nDue to their sensitivity to TLS, resonators are seemingly ideal devices for measuring the intrinsic losses of dielectric materials and extracting the TLS loss of materials. However, measuring the TLS loss of a single material can prove difficult. Every interface, substrate, and deposited dielectric contributes to the filling factor, i.e., the total TLS loss in proportion to the amount of capacitive energy stored in it (see Sec.\u00a0<ref> for more information). Therefore, the device must be carefully designed, and loss extraction analysis methods are often required, in order to determine an accurate and precise TLS loss value for a single region or material of interest. Dielectric loss has been measured using a wide variety of device structures including CPW resonators, distributed-element microstrip resonators, lumped element resonators with parallel plate capacitors, and lumped element resonators with interdigitated capacitors.\n\n### Form Factor\nChanges in the design of planar, multilayer, distributed, or lumped element resonators can be used to optimize the resonator's sensitivity to bulk or surface dielectric losses. Since TLS loss is capacitive <cit.>, the design of the resonator's capacitor determines the TLS regions to which it is sensitive. Planar devices are sensitive to surface dielectric losses, whether they are CPW <cit.> or IDC <cit.> designs. While they are also compatible with measurements of a wide variety of subsequently-added dielectrics, only a fraction of the electric field will be stored in the added material, implying that the planar devices will have a low sensitivity to the bulk TLS loss of these deposited dielectrics. Since CPWs are also used in high performance superconducting quantum circuits for algorithm implementation, these resonators can be used as a proxy and measured in order to improve the quantum devices themselves, in addition to their use as a direct TLS measurement technique.\n\nOn the other hand, multilayer devices involving deposited dielectrics and multiple wiring layers (such as microstrip or parallel plate lumped element resonators) can concentrate fields in the thin film or bulk dielectric of interest. Multilayer resonators also have a lower participation of native surface oxides, which are difficult to control during processing and often require simulation to disentangle their loss from the loss of interest. However, these devices necessitate more fabrication steps and can thus introduce unwanted interface losses that are difficult to distinguish from the loss of interest.\n\nIt has been assumed that lumped element inductors introduce a negligible fraction of capacitance into lumped element resonators <cit.> thus allowing their TLS loss contribution to be ignored. However, recent study shows that depending on the magnitude of loss in the capacitor compared to the generally high magnitude of interface loss, this assumption does not necessarily hold <cit.>.\n\nIn 3D cavity resonators, losses due to surface oxide and conductor loss can be effectively scaled as the ratio of surface area to volume, depending on the cavity geometry.  Alternatively, a piece of bulk dielectric material of interest can be inserted inside a 3D cavity for loss study <cit.>. In cases where the resonant mode is supported by currents traversing a joint in the cavity's construction, the conductor loss at such joints has been studied and reduced by employing In bonds <cit.>.\n\n### Resonator Coupling\nA resonator is coupled to a feedline by creating a capacitive or inductive link. The fraction of the resonator's total capacitance or inductance respectively that is used for this circuit element should be carefully tuned to ensure a close match between $Q_i$ and $Q_c$ at the temperature and power of interest in order to measure the resonator's loss accurately. For $Q_c \\ll Q_i$, $Q_c$ dominates the signal vs.\u00a0frequency lineshape and the accuracy of measured $Q_i$ is decreased. For $Q_c \\gg Q_i$, the resonator becomes difficult to measure due to reduced signal <cit.>. Thus, in order to be able to accurately measure resonator $Q_i$, we must either first estimate the order of magnitude of $Q_i$ or measure a series of resonators with varied $Q_c$ values and use the data from the resonator with the closest match between $Q_i$ and $Q_c$.\n\nTheoretically, if an accurate equivalent circuit model of a resonator measurement setup is known, the coupling loss can be calculated by $1/Q_c=\\mathrm{Re}[Y(\\omega_0)]Z_r$, where $Y(\\omega_0)$ is the total admittance to ground through the coupling components at resonance frequency and $Z_r=\\sqrt{\\frac{L}{C}}$ is the characteristic impedance of the resonator <cit.>. Performing microwave simulations of the design with lossless materials (i.e., $Q = Q_c$) and estimating the total $Q$ by measuring the bandwidth of the resonance dip or peak is a standard way to determine $Q_c$ for a given design prior to fabrication and measurement. Other simulation methods have also been developed that greatly improve the speed of measurement by examining the impedance of a virtual internal port <cit.>. While these ideal simulations can predict $Q_c$, box modes, standing waves along the feedline, and stray couplings can cause variation in actual devices as seen in large arrays of resonators <cit.>.\n\n### Filling Factor\nRegardless of the form factor of the resonator chosen, the experimenter must be careful to allocate the contribution of materials to the overall loss measured by the resonator. The resonator-induced intrinsic TLS loss, $F \\delta^0_{TLS}$ depends on both the intrinsic TLS loss, $\\delta^0_{TLS}$, of the material as well as what fraction of the capacitive energy is stored in the material of interest, its dielectric participation ratio or filling factor $F$. Each material in the device, including substrate, native oxides, interfaces, and deposited dielectrics, will have its own filling factor.\n\nThe filling factor of a dielectric can approach 100 $\\% $ in the case of a thick parallel plate capacitor, or be extremely small, $< 10^{-9}$ as in the surface oxide of a 3D cavity <cit.>. Depending on the goal of the experimental study, design choices can be made to either decrease the total loss of a component by decreasing its associated $F$, or by maximizing the electric field in the material of interest in order to increase $F$ and make the experiment more sensitive to loss in that material.\n\nIn planar circuits such as CPWs, the filling factor depends on the thickness of the dielectric as well as the geometry of the electrodes.  In a CPW, the width of the center trace and gap between center trace and ground plane have a significant effect on the measured loss of the resonator <cit.>. Higher performance devices can be achieved by increasing conductor width, while higher sensitivity to TLS loss can be achieved with narrower conductors  <cit.>. Similar effects can be seen in lumped element resonators, where increasing the distance between capacitors leads to reduced participation of the surface oxides and bulk TLS <cit.>.\n\nIn addition to resonators, it is also possible to take advantage of the geometry dependence to reduce TLS loss in qubits. Indeed, [Chang, Josephine B, Vissers, Michael R, C\u00f3rcoles, Antonio D, Sandberg, Martin, Gao, Jiansong, Abraham, David W, Chow, Jerry M, Gambetta, Jay M, Beth Rothwell, Mary, Keefe, George A, others, \"Improved superconducting qubit coherence using titanium nitride\", 2013] has unambiguously shown improved coherence times as the finger/gap of the interdigitated capacitor (IDC) increases from 2 to 30 $\\mu m$ for both Al and TiN qubits. Although quite effective, moving to larger geometries increases the footprint of qubit as well as the radiation loss, requiring optimizations to be made.\n\nThe removal of dielectric material is another method for decreasing TLS loss. This can be done by etching excess substrate in the gaps of the CPW, trenching the substrate <cit.>, while keeping in mind that the removal of substrate reduces the effective dielectric constant. This decrease in capacitance per unit size changes the impedance and requires larger devices to maintain the same $f_0$. In addition, the relocation of the substrate's native oxide from the edges and corners of the CPW conductors has an outsized effect since the electric field diverges near the the corners of the electrodes <cit.>, significantly reducing the filling factor of this surface.\n\nDetailed simulations using 3D finite element solvers are often necessary to precisely calculate the amount of TLS loss, particularly of low filling factor or low loss materials. Finite element models have been used to calculate the filling factor of different resonator geometries <cit.>, deposited dielectrics <cit.>, metal and substrate surfaces in CPW resonators <cit.>, the effect of trenching the Si gap in CPW resonators <cit.>, and the effect of different etches on interface loss <cit.>. 3D resonators have also been simulated <cit.> in order to determine the effects of surface loss of the cavity.\n\nSeveral rules of thumb exist that give intuition into filling factor behavior. Roughly, scaling up the CPW or IDC conductor width and gap by a factor of 2 decreases the interface contribution by a factor of 2 as well <cit.>. Trenching of the gap reduces the contribution of the bulk substrate and any substrate surface dielectric loss linearly, for depths less than or equal to the CPW conductor width <cit.>, though for deep aspect ratio or isotropic etches <cit.>, this simple relationship is no longer accurate.\n\n### Resonator Fabrication\nThe total TLS loss of even the simplest resonator depends on all materials in the circuit, as shown in Fig.\u00a0(Figure fig:lossschematic): substrate bulk and surface, superconductor surface oxide, deposited dielectrics, and interfaces between materials, which are affected by processing used to fabricate the circuit.\n\nSince the performance of a device with multi-step fabrication can be affected by all the steps in the fabrication process <cit.>, resonators included as in situ witnesses (i.e.  resonators fabricated from just a single step in the process) are an important diagnostic tool for process monitoring and iterative improvements to performance. Alternatively, a large number of wafers or devices could be fabricated from a wide variety of processes <cit.>. These resonators can aid in analysis of loss added by each constituent step.\n\n### Power and Temperature Sweeps\nWhile the applications of some microwave resonators, e.g. photon detectors or MKIDs, are at high photon numbers, quantum information applications require operation at single photon occupation. Power sweeps down to the single photon regime are necessary to measure TLS loss and predict how the devices would perform in qubit circuits. It can be very difficult to determine the actual power within the resonator, but estimation methods exist. The average number of photons in the resonator can be estimated from the power at the input of the resonator, applied power $P_{\\mathrm{app}}$, as <cit.>:\n$$\n\n< n > = \\frac{< E_{int} >}{\\hbar \\omega_0} = \\frac{2}{\\hbar \\omega_0^2} \\frac{Z_0}{Z_r} \\frac{Q^2}{Q_c} P_{\\mathrm{app}},\n\n$$\nwhere $Z_0$ is the characteristic impedance of the microwave environment to which the resonator is coupled, $Z_r$ is the resonator characteristic impedance, and $< E_{int} >$ is the average energy stored within the resonator.\n\nTo understand the dominant loss mechanism in a resonator material system, it takes much more than measuring loss at the lowest cryostat temperature at single photon powers. Measuring the temperature and power dependence of loss can be used to elucidate a great deal about the dominant loss mechanism present in the device under test. Both power and temperature sweeps can be used to fit for TLS loss in a superconducting microwave resonator. By measuring loss as a function of power at a temperature well below where the TLS are unsaturated, $T_{bath} \\ll \\frac{\\hbar\\omega}{2k_{B}}$, the TLS model in Eq.\u00a0<ref> can be used to determine $\\delta_{TLS}^0$. Additionally, measuring loss as a function of temperature at low powers and fitting to the same equation yields similar results. Ideally, fits to the saturation of both temperature and power dependent loss are measured to find self-consistent results. Deviations could be an indication that an assumption about the temperature or power at the device are not accurate <cit.>.\n\nIn addition to dependence on loss, the frequency of the resonator itself can shift depending on microscopic loss effects among the ensemble of TLS. In [Gao, Jiansong, \"The physics of superconducting microwave resonators\", 2008], a method is shown to measure resonance frequency shift as a function of temperature at any power and fit to Eq.\u00a0<ref> to determine $\\delta_{TLS}^0$. However, [Pappas, David P, Vissers, Michael R, Wisbey, David S, Kline, Jeffrey S, Gao, Jiansong, \"Two level system loss in superconducting microwave resonators\", 2011] states that measuring loss as a function of power or temperature determines the TLS loss in a narrow frequency band near resonance, while measuring resonance frequency as a function of temperature determines wide-band TLS loss. Since the off-resonance TLS remain unsaturated, the measurement can be performed at powers far above the single photon limit required by other measurements, reducing measurement time.\n\nAccurate extraction of TLS loss from temperature sweep data is only possible when the frequency shift is dominated by TLS around $T_{bath} \\sim \\frac{\\hbar\\omega}{2k_{B}}$. This condition is met by Nb resonators with the characteristic hook shape seen in Fig.\u00a0(Figure fig:TLSTheoCurves) and Fig.\u00a0(Figure fig:experimental_scurve). However, for lower $T_c$ materials such as Al, a frequency shift in the opposite direction can arise from large thermal quasiparticle population in the superconductor. From Eq.\u00a0<ref>, increased temperature leads to decrease in frequency and quality factor, as shown in Fig.\u00a0(Figure fig:Quasiparticle_temp_expt). When both effects are present, such as in [Chang, Josephine B, Vissers, Michael R, C\u00f3rcoles, Antonio D, Sandberg, Martin, Gao, Jiansong, Abraham, David W, Chow, Jerry M, Gambetta, Jay M, Beth Rothwell, Mary, Keefe, George A, others, \"Improved superconducting qubit coherence using titanium nitride\", 2013], the anomalous temperature-dependent shifts will produce fits with unphysical TLS loss extraction results. Therefore, superconductors of low $T_c$ and high kinetic inductance are not suitable for using temperature sweeps to study TLS loss. On the other hand, there exist regimes in which TLS loss is sufficiently small compared to conductor loss that temperature sweeps reveal much more about properties of the superconductor than TLS loss of nearby materials <cit.>.\n\n< g r a p h i c s >\n\nPower and temperature dependence of the loss of a Nb on $\\mathrm{Al_2O_3}$ microstrip resonator with an interlayer of sputtered $\\mathrm{SiO_2}$ <cit.>. Loss $\\delta$ as a function of (a) mean photon number $\\mathrm{\\langle n \\rangle}$ at 20 mK, and (b) temperature $T$ at $\\mathrm{\\langle n \\rangle \\sim 1}$. (c) Resonance frequency $f_0$ as a function of temperature. Data (points) is fit to models in Eq.\u00a0<ref> and Eq.\u00a0<ref> (lines). Figure adapted with permission from Gao, J., The physics of superconducting microwave resonators, Ph.D. thesis, California Institute of Technology (2008).\n\n< g r a p h i c s >\n\nFrequency shift and quality factor (inset, same temperature range) as a function of temperature of an Al resonator dominated by conductor loss. At temperatures a significant fraction of $T_{c}$ (here 1.18 K), quasiparticles contribute to loss in the superconducting film. Theory curves (red) are from a fit to the real and imaginary parts of Eq.\u00a0<ref> and include a numerical integration of Mattis-Bardeen theory of AC surface conductivity. TLS loss contributes negligibly in this case, evidenced by these monotonically decreasing curves, and by power independence over many orders of magnitude in photon number. Adapted from Minev, Z., Pop, I., and  Devoret, M., \u201cPlanar superconducting whispering gallery mode resonators,\u201d Appl. Phys. Lett. 103, 142604 (2013), with the permission of AIP Publishing.\n\nMATERIALS LOSS EXPERIMENTS AND ANALYSIS\n\n< g r a p h i c s >\n\nSummary of thin film superconductor loss measurements of hero devices. CPW resonator loss as a function of width of the gap between conductor and ground plane for the highest performance device of each type. Solid markers: $F \\delta_{\\mathrm{TLS}}^0$ values. Open markers: $\\delta_{\\mathrm{LP}}$ values. Superconducting microwave resonators patterned from Al (circles), TiN (squares), Nb (diamonds), and other superconductors (stars) are shown. Marker color denotes reference in which each measurement is reported, with associated colors and references shown in Table\u00a0(Table tab:metalstable). Grey curves are guides to the eye showing a rough linear correlation between gap and $F$, with dark grey curve denoting the current performance limit of on-chip superconducting microwave resonators.\n\nTables summarizing a selection of existing measurements in literature for $\\delta_{LP}$ and $F \\delta^0_{TLS}$ are given for deposited dielectrics (Table (Table tab:dielectricstable)) and interfaces associated with thin film superconducting metals (Table (Table tab:metalstable) and Fig.\u00a0(Figure fig:review_scatter)). Conductor loss limits are listed in Table\u00a0(Table tab:bulkmetalstable). Variables not satisfactorily accounted for in these comparisons include the impact of resonator geometry and filling factor, resonance frequency, $Q_{i}/Q_{c}$ matching, miscellaneous fabrication differences, the presence or absence of magnetic shielding, IR filtering and isolation, and differences in measurement base temperature and sample thermalization. In particular, in order to compare results across experiments, the filling factor of the TLS material must be known. For CPWs, the filling factor can be estimated from the conductor width $w$ and gap $g$ between the conductor and ground planes, where $F \\propto w,g$ roughly holds. For experiments that only report the low power loss, in order to compare to TLS loss values, the high-power loss must be orders of magnitude smaller than the low power loss, and it must be demonstrated that the low power regime is being reached.\n\nOf special note, uncontrolled thermalization, unwanted noise, and unshielded magnetic fields can lead to systematic under- or over-reporting of loss. It is the opinion of the authors that, at minimum, base temperature and power dependent sweeps be published along with filling factors of the TLS material, $Q_c$, and resonator fitting information. Other parameters that would be highly useful include etch type and material deposition parameters.\n\nDue to the numerous variables affecting the reported loss values, is it difficult to make definite conclusions from literature comparisons. However, some trends can be seen. They are outlined below along with noteworthy results from individual studies.\n\n### Substrates\nHigh-purity crystalline substrates, float-zone intrinsic or other high resistivity Si and $\\mathrm{Al_2O_3}$ are common, but other substrates have also been investigated <cit.>. Although their intrinsic losses may be very low, even with extreme geometries the high $F$ of substrates significantly reduces the performance of resonators and qubits <cit.>.\n\nAs shown in Table\u00a0(Table tab:metalstable), there are no significant trends in total TLS loss between devices on Si and on $\\mathrm{Al_2O_3}$.\n\n### Metal Deposition\nDeposition parameters of the metal can influence TLS loss, typically through the metal-air interface.  Stress, stoichiometry, impurities and crystal growth mode can all influence the amount of TLS loss <cit.>.\n\nEpitaxial materials have generally higher performance than amorphous materials. Whether the benefit is due to crystallinity or overall cleanliness is disputed, but superconductors grown epitaxially have demonstrated lower TLS loss than other growth methods <cit.>.\n\nAs shown in Table\u00a0(Table tab:metalstable), there is a wide range of performance in Al, TiN, and Nb devices. In terms of hero devices (Fig.\u00a0(Figure fig:review_scatter)), those patterned from Al and TiN have reached the lowest TLS loss values, with Nb and other superconductors such as Re and Ta trailing behind. [Place, Alex P. M., Rodgers, Lila V. H., Mundada, Pranav, Smitham, Basil M., Fitzpatrick, Mattias, Leng, Zhaoqi, Premkumar, Anjali, Bryon, Jacob, Sussman, Sara, Cheng, Guangming, Madhavan, Trisha, Babla, Harshvardhan K., Jaeck, Berthold, Gyenis, Andras, Yao, Nan, Cava, Robert J., de Leon, Nathalie P., Houck, Andrew A., \"New material platform for superconducting transmon qubits with coherence times exceeding 0.3 milliseconds\", 2020] have shown promising results with epi-Ta electrodes in a qubit, but resonator loss measurements have not been reported.\n\n3D cavities can have orders of magnitude smaller TLS filling factor and omit bulk dielectric substrates altogether. Therefore, they are more sensitive probes of quasiparticle loss in the bulk superconductors from which they are constructed. Upper bounds on this bulk superconductor surface loss from several recent works in 3D cavities are included in Table\u00a0(Table tab:bulkmetalstable). As with planar fabricated resonators, the performance is influenced by the metal purity and surface treatments.\n\n### Interfaces\nLosses at the metal-substrate and substrate-air interfaces are thought to contribute significantly to overall loss, and much effort has been made to explore deposition and cleaning techniques to mitigate and understand these induced losses <cit.>. As the interface between the superconductor and the substrate may be the largest source of TLS loss <cit.>, surface treatments prior to deposition are especially important. Cleaning the substrate surface and removing surface oxide with RCA-1, HF, HMDS, and/or annealing has been demonstrated to improve resonator performance <cit.>. Additional surface treatments to passivate the Si surface have also been shown to be beneficial <cit.>. However, ion cleaning of Si substrates in particular prior to deposition is associated with higher surface dielectric loss <cit.>.  Studies have shown that $\\mathrm{Al_2O_3}$ substrates with rougher surfaces, or those with adsorbates, may contribute higher loss <cit.>.\n\nThe liftoff or etch process used to fabricate the resonator is also important to its performance.  Etching may affect the sidewalls of the superconductor as well as alter the surface of the underlying substrate <cit.>. In multilayer processes, Ar ion cleaning is used to remove metal oxides and create good electrical contact. However, this cleaning also damages the substrate and induces loss <cit.>. Liftoff processes have been optimized <cit.> to minimize the amount of substrate subject to Ar cleaning either by reducing the area of the layer, or by including a separate, small, higher loss \"bandage\" layer that connects the large area low loss electrodes <cit.>. Post-liftoff O$_2$ descum steps are also found to reduce loss  <cit.>.\n\n### Deposited Dielectrics\nWhile the highest performance substrate-based resonators are typically single-layer and do not have deposited dielectrics, more complex circuits implement multilayer processing and deposited dielectrics. However, deposited dielectrics have been found to possess widely varying losses (Table\u00a0(Table tab:dielectricstable)). The lowest documented loss $\\sim~10^{-5}$ occurs in a wide variety of materials <cit.>, and materials that have demonstrated high loss ($\\sim 10^{-3}$) are also varying.\n\n### Josephson Junctions\nA crucial dielectric barrier in superconducting qubit circuits is the tunnel barrier oxide in the Josephson junction of the qubit itself. The vast majority of these Josephson junctions are made from Al$_2$O$_3$ grown at room temperature. This thin Al$_2$O$_3$ present in tunnel junctions is a source of TLS loss. Bulk loss of an amorphous Al$_2$O$_3$ junction has been measured to be on the order of $10^{-3}$ <cit.>. The fluxonium qubit, with its lower resonant frequency, can maintain long coherence times despite containing an array of large-area junctions with losses $\\sim 10^{-4}$ <cit.>. Crystalline Al$_2$O$_3$ barriers have shown promising losses around $6\\times10^{-5}$ <cit.>.\n\nOne current design philosophy is to statistically avoid strongly coupled TLS in Josephson junctions by minimizing the junction volume <cit.>. While current qubit designs have been engineered to avoid the loss from the tunnel barrier dielectric, lower loss tunnel barriers or interfaces could enable new, less constrained designs, and continued improvements in the tunnel barrier are a fruitful topic for ongoing research.\n\nCONCLUSIONS AND OUTLOOK\n\nSuperconducting microwave resonator measurements are an effective way to probe low power cryogenic losses in bulk and thin film dielectrics, interfaces between materials, and surface oxides. In this regime, TLS loss is often the dominant type of materials loss, and can be distinguished from other losses by its unique association with the capacitor and by its power and temperature dependence. Experiments probing the temperature, power, frequency, geometric and magnetic field dependence of loss can be used to determine the interplay between various loss mechanisms.\n\nIn order to perform accurate measurements, experiments must be carefully designed and executed. Common pitfalls producing inaccurate resonator measurement results include:\n\n* A lack of thermalization, which leads to artificially low reported intrinsic TLS loss;\n\n* The measurement of low power loss (in the place of TLS loss) when power-independent losses are large, which produces a seemingly high intrinsic TLS loss;\n\n* Measuring in reflection mode, which could report inaccurate $Q_i$ values due to impedance mismatches that cannot be corrected;\n\n* Measuring in transmission mode, which has the same drawback as above plus insufficient baseline information, making separating $Q_c$ and $Q_i$ impossible; and\n\n* Using a resonator design with a low filling factor for the material of interest, if other loss mechanisms are not negligible.\n\nMany different methods have been used to determine interface, thin film, and bulk dielectric loss at low powers and temperatures in superconducting quantum circuits. A review of the current body of work in this field lacks strong conclusions due to the many discrepancies in reporting of experimental parameters. The state-of-the-art in terms of planar superconducting geometries give losses in the low $10^{-6}$ range, which has been shown for several materials sets. Deposited dielectric performance is currently limited to $\\sim 10^{-5}$.\n\nPromising directions for future work can be divided into two subfields: loss metrology, and materials research.\n\nFruitful future projects in loss metrology include investigations into: thermalization of samples (including the impact of the sample box material and design, mounting method, and thermalization time); precise and unobtrusive calibration for millikelvin $S_{21}$ measurements; time fluctuations in $Q_i$ and $Q_c$ (including the effect of sampling rates and power regime); and resonator fitting (especially regime-dependent variations between DCM and INV models). Continuing to report noise values and further develop techniques for measuring noise could also be important for obtaining a complete picture of loss mechanisms in resonators.\n\nIn terms of materials research, we anticipate continued performance improvement in both dielectrics and superconducting metals. Towards reducing TLS loss, promising avenues include interface engineering and development of novel dielectrics.  Given the diversity of substrates, metals, and passivation layers currently employed, there exist materials or conditions that have yet to be explored to their full potential. Separately, planar resonators and 3D cavities alike will benefit from development of superconducting bonding. In the former case, high quality superconducting enclosures will be helpful to mitigate radiative loss and parasitic modes. In the case of 3D cavities, low-loss superconducting bonds enable scalable geometric constructions, including multilayer microwave integrated quantum circuits.\n\nThe authors advocate that future work in this area report TLS loss rather than low power loss, and publish base temperature, associated $Q_c$ values, and filling factors of the target materials for more accurate comparison between experiments and to avoid limiting the value of published results.\n\nIdeally, TLS loss would be extracted using both power- and temperature-dependent sweeps to demonstrate self-consistent results, although that is not always possible due to the additional complexity in experimental set-up. The inclusion of multiple or repeated resonator measurements, periodically in the same cooldown and over repeated cooldowns, as well as the use of a traceable resonator fit, would also strongly increase experimental reliability. Finally, the simultaneous measurement of multiple resonator parameters such as loss, frequency shift, and noise can yield a more comprehensive picture of TLS behavior, as well as reveal non-TLS loss mechanisms that may be present.\n\nDATA AVAILABILITY\n\nData sharing is not applicable to this article as no new data were created or analyzed in this study.\n\nThe authors would like to thank David Fork for his guidance, as well as Eric Rosenthal, Johannes Hubmayr, Katarina Cicak, Sisira Kanhirathingal, Daniel Sank, and Bob Buckley for their expertise and assistance with the writing process. This research was supported by the US Department of Energy (Award No. de-sc0019199).\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'Analytic control methods for high fidelity unitary operations in a weakly nonlinear oscillator'?", "completion": "\n\n2pt\n2pt\n\n# Analytic control methods for high fidelity unitary operations in a weakly nonlinear oscillator\n\nInstitute for Quantum Computing and Department of Applied Mathematics, University of Waterloo, Waterloo, Ontario, Canada N2L 3G1\n\nInstitute for Quantum Computing and Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, Canada N2L 3G1\n\nInstitute for Quantum Computing and Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, Canada N2L 3G1\n\nInstitute for Quantum Computing and Department of Physics and Astronomy, University of Waterloo, Waterloo, Ontario, Canada N2L 3G1\n\nIn qubits made from a weakly anharmonic oscillator the leading source of error at short gate times is leakage of population out of the two dimensional Hilbert space that forms the qubit. In this paper we develop a general scheme based on an adiabatic expansion to find pulse shapes that correct this type of error. We find a family of solutions that allows tailoring to what is practical to implement for a specific application.  Our result contains and improves the previously developed DRAG technique [F. Motzoi, et. al., Phys. Rev. Lett. 103, 110501 (2009)] and allows a generalization to other non-linear oscillators with more than one leakage transition.\n\n03.67.Lx, 02.30.Yy, 85.25.-j\n\n## Introduction\nThe physical realization of quantum information processing in\nsuperconducting circuits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has enjoyed\nremarkable progress over the last decade. While initially decoherence limited single qubits to only a few coherent oscillations [Unknown Author, \"Unknown Title\", ], high precision, general quantum conrol is now possible over single- and few-qubit systems.\nThis is evident by the demonstration of high-fidelity nonclassical states of\ntwo-qubit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and three-qubit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] systems, harmonic oscillators [Unknown Author, \"Unknown Title\", ], and the demonstration of small quantum algorithms [Unknown Author, \"Unknown Title\", ].\n\nThis success is partially due to our current understanding of sources of noise and the development of techniques and systems that are  resilient to these noise sources. Examples include the optimum working point [Unknown Author, \"Unknown Title\", ] and the introduction of low-dispersion qubits like the transmon [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and the capacitively shunted flux\nqubit [Unknown Author, \"Unknown Title\", ]. On the other hand, a promising route to success are qubits that contains only a minimal number of elements, such as the phase qubit  [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. What these systems have in common is a weakly anharmonic energy level structure, i.e., the states that are outside of the qubit subspace spanned by $|0\\rangle$ and $|1\\rangle$ are only separated from each other and the qubit subspace by energies only slightly different than the qubit frequency.\n\nHaving a weakly anharmonic qubit poses a challenge in the implementation of quantum gates. It is known [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] that the time evolution operator of a linearly driven harmonic oscillator is a combination of a coherent displacement operator tracking the classical trajectory\nof the driven oscillator and a global phase factor. This evolution encompasses all energy levels and cannot be reduced to a single-qubit rotation. Spectroscopically, this can be understood as follows: a single qubit rotation is typically implemented by a pulse of radiation resonant with the qubit energy splitting.\nIn a harmonic oscillator, all energy splittings are the same, so driving one transition drives all others at the same time. A system starting initially in an energy eigenstate will quickly be driven into a superposition over many energy eigenstates. By this token, it is crucial that a qubit is nonlinear [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], that is that the transition frequency of the qubit levels is different by an amount $\\Delta$ from the transition frequencies to the non-qubit levels. Spectroscopically, we would expect that whenever the bandwidth of the pulse comes close to $\\Delta$, i.e., when its duration becomes short on the scale of $1/\\Delta$, we expect\nsignificant leakage to higher states. Thus, it is a challenge to implement fast single-qubit gates in weakly anharmonic systems. The implementation of faster gates is important as it allows more gates to be executed in a given coherence time, an important step toward high-fidelity quantum logic.\n\nWhile superconducting qubits are the most well known example of qubits made from weakly anharmonic oscillators, there are many other examples. In fact, it has been shown that no physical particle can be a true qubit[Unknown Author, \"Unknown Title\", ]. Examples of leakage states include higher vibrational states in optical lattices [Unknown Author, \"Unknown Title\", ], polarized spin states in the singlet-triplet qubits [Unknown Author, \"Unknown Title\", ], and auxiliary states in ion traps [Unknown Author, \"Unknown Title\", ] and Rydberg atoms [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn this paper, we outline a suite of strategies to implement single-qubit quantum gates in qubits singled out from the spectrum of an anharmonic oscillator.\nWe develop an adiabatic expansion technique that leads to order-by-order constraint equations on a toggling-frame transformation and the control fields. The space of solutions contains the DRAG strategy proposed in Ref. [Unknown Author, \"Unknown Title\", ] and re-analyzed in the presence of an oscillator bath in Ref. [Unknown Author, \"Unknown Title\", ] as a special case, as well as simpler versions of DRAG that do not require time-dependent energy bias or phase ramping, similar to those\nimplemented in Refs. [Unknown Author, \"Unknown Title\", ] and [Unknown Author, \"Unknown Title\", ]. Additionally, we derive optimal solutions to a given order by minimizing the errors manifested by the fields in the next higher order.\n\nThe outline of the paper is as follows: in Sec. <ref> we review qubits made from anharmonic oscillator and introduce their rotating-wave description. Sec. <ref> describes Gaussian pulses and shows how they lead to both phase and population errors. In Sec. <ref> we extend the DRAG scheme of Ref. [Unknown Author, \"Unknown Title\", ] to find a wealth of different pulse shapes that give improved performance over Gaussian shaping. In Sec. <ref> we apply the generalized scheme to cases where there are more then one leakage level. Finally we conclude in Sec. <ref>.\n\n## The system\n### Lab frame Hamiltonian\nWe consider a qubit formed by the two lowest levels (which we generalize in sec.\u00a0<ref>) of an anharmonic oscillator. These levels are separated in energy by $\\hbar\\omega$, where $\\omega$ is the transition frequency. The $j^\\mathrm{th}$ higher levels are different to $\\hbar j\\omega$ by $\\hbar \\Delta_j$, where $\\Delta_j$ is known as the anharmonicity. That is, the Hamiltonian for the nonlinear oscillator of dimension $d$ is ($\\hbar=1$)\n$$\n\nH_\\mathrm{fr}=\\sum_{j=1}^{d-1}(j\\omega+\\Delta_j)\\Pi_j,\n\\label{eq:hamiltonian}\n$$ where $\\Pi_j=\\ket{j}\\bra{j}$ is the projection operator onto the $j^\\mathrm{th}$ energy level. Without loss of generality we set $\\Delta_1=0$. This is illustrated in Fig. (Figure fig:Ham) with the qubit levels being $\\ket{0}$ and $\\ket{1}$ (green).\nFor many nonlinear oscillators the anharmonicity takes the form $\\Delta_j=\\Delta_2(j-1)j/2$, which we will call the standard nonlinear oscillator (SNO), essentially a Duffing oscillator within the rotating wave approximation [Unknown Author, \"Unknown Title\", ]. For the lowest few levels, superconducting qubits of the transmon [Unknown Author, \"Unknown Title\", ], phase qubit [Unknown Author, \"Unknown Title\", ], and capacitively shunted flux qubit  [Unknown Author, \"Unknown Title\", ] types are well approximated by a SNO. Furthermore,  motional states in optical lattices [Unknown Author, \"Unknown Title\", ], collective modes of ion traps [Unknown Author, \"Unknown Title\", ] and nanomechanical oscillators [Unknown Author, \"Unknown Title\", ] are also described as SNOs.\n\n< g r a p h i c s >\n\n(color online) Energy level diagram of the system we are considering. The qubit is formed by the $\\ket{0}$ and $\\ket{1}$ (green) levels and we aim to have complete control in this subspace when leakage to the $\\ket{2}$ and then $\\ket{3}$ etc.\u00a0is possible (red arrows). The dotted black lines indicate the positions the energy levels would be at if the system was a harmonic oscillator of frequency $\\omega$.\n\nWe will assume that control in this system is due to some dipole-like interaction that only allows single photon transitions. As for harmonic oscillators, this is a good approximation because parity forbids all other transitions. The control Hamiltonian is\n$$\n\\label{eq:controlham}\nH_\\mathrm{ct}(t)=\\mathcal{E}(t)\\sum_{j=1}^{d-1}\\lambda_{j-1}\\sigma^x_{j-1,j},\n\n$$ where $\\mathcal{E}(t)$ is the drive amplitude,  $\\sigma^x_{j,k}=\\ket{j}\\bra{k}+\\ket{k}\\bra{j}$ is one of the effective Pauli spin operators for levels $j$ and $k$, and $\\lambda_j$ is a dimensionless parameter that weighs the relative strength of driving the $\\ket{j}\\rightarrow \\ket{j+1}$ transition versus the $\\ket{0}\\rightarrow \\ket{1}$ transition.  In our model we take $\\lambda_0=1$ and leave the $\\lambda_j$'s as input parameters. For a harmonic oscillator controlled via a dipole interaction with an external field $\\lambda_j=\\sqrt{j}$;\nhowever, in appendix <ref> we show that in cavity or circuit QED architectures $\\lambda_j$ can differ substantially from this value.\n\nFor the functional form of the drive $\\mathcal{E}(t)$ we will assume that  $\\left|\\mathcal{E}(t)\\right| \\ll \\omega$ (weak driving regime) and introduce envelope shaping of the driving field at carrier frequency $\\omega_d$.  This leads to\n$$\n\\label{eq:controls}\n\\mathcal{E}(t)=\\Omega_x(t)\\cos(\\omega_d t + \\phi_0)+\\Omega_y(t)\\sin(\\omega_d t + \\phi_0).\n\n$$\nAs per convention, the two quadratures amplitudes $\\Omega_x(t)$ and $\\Omega_y(t)$ can be amplitude modulated using a waveform generator and then mixed back together with the carrier to give this form of control field. Here,\n$\\phi_0$ is the relative phase between the envelope and the carrier at the start of the operation. This phase is irrelevant if the rotating wave approximation can be made, as will be shown in the next section.\n\n### Rotating frame Hamiltonian\nFor quantum information processing it is highly suitable to define operations with respect to the frame rotating at the  driving frequency  $\\omega_d$. In this frame we have three independent controls: $\\delta(t) = \\omega(t)-\\omega_d$ (the qubit detuning), $\\Omega_x(t)$ and $\\Omega_y(t)$, which, projected to the qubit subspace, control application of the three Pauli spin operators $\\sigma_{0,1}^z$, $\\sigma_{0,1}^x$, and $\\sigma_{0,1}^y$, respectively. For example, the identity operation is achieved by setting all the controls to zero. Note that here we have assumed that $\\delta$ is controlled by shifting the qubit frequency. This is not necessary and, as shown in appendix <ref>, this can be achieved by a time dependent phase in Eq. (<ref>). To move to the rotating frame we define the unitary\n$$\n\\label{eq:rot}\nR(t)=\\sum_{j=1}^{d-1}\\exp\\left[-i j\\omega_d t \\right]\\Pi_j,\n\n$$ which determines the transformed Hamiltonian\n$$\n\\label{eq:rotransf}\nH^R(t)=R^\\dagger(t)  H(t) R(t)+i\\dot R^\\dagger(t) R(t),\n\n$$ where $H(t)=H_\\mathrm{fr}+H_\\mathrm{ct}(t)$. Explicitly we have\n$$\n\n\\begin{split}\nH^R(t)=&\\sum_{j=1}^{d-1}(j\\delta+\\Delta_j)\\Pi_j + \\left[\\frac{\\Omega(t)}{2}e^{-i\\omega_d t-i\\phi_0}+\\mathrm{h.c.}\\right]\\\\&\\times\\sum_{j=1}^{d-1}\\lambda_{j-1}\\left[\\ket{j}\\bra{j-1}e^{i\\omega_d t}+\\mathrm{h.c.}\\right],\\end{split}\n\n$$ where h.c. stands for hermitian conjugate and $\\Omega(t) = \\Omega_x(t)+i\\Omega_y(t)$.\n\nAssuming that $\\omega_d$ is larger then any other rate or frequency in this frame we can perform the rotating wave approximation (i.e.\u00a0time average the fast rotating terms to zero). For the SNO case this amounts to restricting the dimension $d$ to be less then $\\sqrt{2\\omega/\\Delta}$, specifically $d= 7$. After this approximation we can write the Hamiltonian as\n$$\n\\label{eq:rotHamstep}\nH^R(t)&=&\\sum_{j=1}^{d-1}(j\\delta+\\Delta_j)\\Pi_j\\\\\n&\\ & + \\ \\sum_{j=1}^{d-1}\\lambda_{j-1}\\left[\\frac{\\Omega(t)}{2}\\ket{j}\\bra{j-1}+\\mathrm{h.c}\\right].\\nonumber\n\n$$\nHere we have included the $\\phi_0$ into the energy states ($\\ket{j}\\rightarrow e^{ij\\phi_0}\\ket{j}$), and we see that within the rotating wave approximation the relative phase between the envelope and the carrier at the start of the operation is irrelevant.\nFinally, Eq. (<ref>) can be rewritten as\n$$\n\\label{eq:rotHam}\n\\begin{split} H^R(t)=&\\sum_{j=1}^{d-1}(j\\delta(t)+\\Delta_j)\\Pi_j \\\\&+\\sum_{j=1}^{d-1}\\lambda_{j-1}\\left[\\frac{\\Omega_x(t)}{2}\\sigma_{j-1,j}^x +\\frac{\\Omega_y(t)}{2}\\sigma_{j-1,j}^y\\right],\n\\end{split}\n\n$$ where $\\sigma_{j,k}^y=-i\\ket{j}\\bra{k}+i\\ket{k}\\bra{j}$ for $k>j$.  We see that if we can restrict the system to the lowest two levels then all rotations in the single qubit space can be achieved by independent controls; however, in general, this is not true. In Sec.\u00a0<ref> we show that the higher level transitions lead to a combination of a phase and leakage error [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. This has been experimentally measured in Refs. [Unknown Author, \"Unknown Title\", ] and [Unknown Author, \"Unknown Title\", ].\n\n## Gaussian shaping and errors\nOur goal is to implement gates contained within the qubit subspace. That is, we want to shape $\\Omega_x(t)$, $\\Omega_y(t)$ and $\\delta(t)$ in Eq. (<ref>)  so that\n$$\n\\label{eq:ideal}\nU_\\mathrm{ideal} = \\mathcal{T}\\exp\\left[-i\\int_{0}^{t_g}H^R(t)dt\\right] = e^{i\\phi}U_\\mathrm{qb}\\oplus U_{\\mathrm{rest}},\n\n$$  where $t_g$ is the gate time, $\\mathcal{T}$ is the time ordering operator, $U_\\mathrm{qb}$ is a unitary that acts only in the qubit subspace, $U_{\\mathrm{rest}}$ acts only outside of the qubit space, and $\\phi$ describes a relative phase.  Therefore, $U_{\\mathrm{rest}}$ as well as the phase $\\phi$ are  completely irrelevant for operations in the Hilbert space formed by the qubit.\n\nTo demonstrate the typical set of errors we choose $U_\\mathrm{qb} =\\sigma_{0,1}^x$, the NOT gate. For a leakage-free qubit this would be implemented by simply setting $\\delta(t)=0$, ${\\Omega}_x(t)=\\Omega_G(t)$, and ${\\Omega}_y(t)=0$, with the only requirement that that $\\int_{0}^{t_g}{\\Omega}_G (t)dt=\\pi$. To reduce the leakage to the third level, the standard result prior to Ref. [Unknown Author, \"Unknown Title\", ] was to use Gaussian modulation of the envelope  [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In this case $\\Omega_G(t)$ takes the form\n$$\n\\label{eq:gaussian}\n\\Omega_G(t)=\nA\\frac{\\exp\\left[-\\frac{(t - t_g/2)^2}{2\\sigma^2}\\right]-\\exp\\left[-\\frac{t_g^2}{8\\sigma^2}\\right]}{\\sqrt{2\\pi \\sigma^2}\\mathrm{erf}[t_g/\\sqrt{8}\\sigma]-t_g\\exp[-t_g^2/8\\sigma^2]},\n\n$$\nwhere $t\\in [0,t_g]$,  $\\sigma$ is the standard deviation and $A$ is chosen such that the correct amount of rotation is implemented (e.g. $A=\\pi$ for a NOT). This functional form is chosen to enforce that the pulse start and end at zero. In the limit that $t_g\\rightarrow\\infty$ we recover the standard Gaussian function. The motivation for Gaussian shaping is that the small and strictly limited frequency bandwidth  $(1/\\sigma)$ ensures little excitation at the leakage transition frequency. For short pulses however, there is still significant spectral weight at $\\Delta_2$. This is shown in Fig. (Figure fig:Guas) (a, c, e) where the Fourier transforms of $\\Omega_G(t)$ are plotted for $\\sigma =\\{1/3,2/3,3/2\\}2\\pi/\\Delta_2$ and $t_g=4\\sigma$ respectively.\n\n< g r a p h i c s >\n\n(color online) Fourier transforms of the control fields (a, c, e) and populations (b, d, f) of the ground (blue solid), first (red dotted), and second excited (green dash) in a simulation of a NOT gate with a Gaussian amplitude pulse for a $d=5$ SNO. In (a, b) $\\sigma=2\\pi/3\\Delta_2$, (c, d) $\\sigma=4\\pi/3\\Delta_2$, and (e, f) $\\sigma=3\\pi/\\Delta_2$ and the gate time is taken to be $4\\sigma$.\n\nTo quantify this error, we use the gate fidelity averaged over all input states existing in the qubit Hilbert space,\n$$\n\n\\begin{split}\nF_g\t=&\\int d\\psi ~\\mathrm{Tr}\\left[U_\\mathrm{ideal} \\ket{\\psi}\\bra{\\psi} U_\\mathrm{ideal}\\dg \\mathcal{E}(\\ket{\\psi}\\bra{\\psi})\\right],\n\\end{split}\n\n$$ where $\\mathcal{E}(\\rho)$ is the actual process in the full Hilbert space. Using an argument similar to Ref. [Unknown Author, \"Unknown Title\", ] gives\n$$\n\n\\begin{split}\\label{eq:fid}\nF_g\t=&\\frac{1}{6}\\sum_{j=\\pm x, \\pm y, \\pm z}\\mathrm{Tr}\\left[U_\\mathrm{ideal} \\rho_j U_\\mathrm{ideal}\\dg \\mathcal{E}(\\rho_j)\\right],\n\\end{split}\n\n$$\nwhere $\\rho_j$ are the six axial states on the Bloch sphere, and $U_\\mathrm{ideal}$ is defined in Eq. (<ref>). To demonstrate the errors arising from Gaussian shaping we consider a $d=5$ SNO and numerically calculate the gate error ($1-F_g$) for $\\sigma =\\{1/3,2/3,3/2\\}2\\pi/\\Delta_2$ and $t_g=4\\sigma$. We find gate errors of $0.198$, $0.0160$, and $0.0030$ respectively.\n\nTo understand these error values we plot the populations of the first three levels in Fig. (Figure fig:Guas) (b, d, f). The ground state populations are given by the blue solid line; the red dotted line shows the first excited state; the green dashed line is the second excited state. We observe that for the shortest gate, $\\sigma=2\\pi/3\\Delta_2$,  the error after the pulse is mostly residual population of the third and higher level. This is what we refer to as the leakage error. For longer gates, e.g. $\\sigma=4\\pi/3\\Delta_2$, the residual population does not account for the calculated error. This error is mostly a phase error resulting from the finite population of the third level during the pulse. Even though the final state is restricted to the computational levels, the admixture of the third level leads to a phase shift on the second level, resulting in a net phase error at the end of the pulse. At the longest time when the population of the third level is nearly negligible there is still a large gate error. From these results we conclude that Gaussian shaping is of limited performance even if the pulse bandwidth is somewhat smaller than $\\Delta_2$. Thus a more advanced pulse is needed. In Ref. [Unknown Author, \"Unknown Title\", ], we provided a simple scheme and in the next section we will review this and generalize the result.\n\n## Simple adiabatic control pulses\n### General procedure for DRAG solutions\nTo go beyond the Gaussian control methods presented above, we introduce the Derivative Removal by Adiabatic Gate (DRAG) technique, generalizing the result of Ref. [Unknown Author, \"Unknown Title\", ].\nIn this technique we want to find a time-dependent unitary transformation $A(t)$ such that the effective Hamiltonian\n$$\n\\label{eq:Heff}\nH_\\mathrm{eff}(t) = A^\\dagger (t) H(t) A(t) + i \\dot{A}^{\\dagger}(t) A(t).\n\n$$ has the form $H_\\mathrm{qb}(t)\\oplus H_\\mathrm{rest}(t)$ where $H_\\mathrm{qb}(t)$ is a Hamiltonian in the effective qubit subspace and $ H_\\mathrm{rest}(t)$ generates evolution in the rest of the system. The direct sum form implies that if the state of the system starts in the qubit subspace, then it remains there during and after the pulse. We impose the  additional requirement that $A(0) = A(t_g) = \\openone$, i.e. the frame transformation vanishes at the boundaries. Both conditions together imply that we have decoupled the computational subspace from the leakage subspace since the qubit subspace is mapped back onto itself by the end of the pulse.  In Ref. [Unknown Author, \"Unknown Title\", ] we restricted the problem to a $d=3$ system and found a solution to the problem of generating a NOT gate. It is straightforward to generalize this work to design pulses that account for higher order corrections, larger dimensional embeddings, general target gates, and an expanded library of control fields by considering more complicated frame transformations to that considered in Ref. [Unknown Author, \"Unknown Title\", ]. We now classify valid choices for the transformation $A(t)$ that satisfies the above constraints.\n\nTo simplify the following arguments we consider a basis for the Lie algebra $\\mathfrak{u}(d)$, as opposed to $\\mathfrak{su}(d)$, with elements $\\{\\sigma_{j,k}^x, \\sigma_{j,k}^y, \\Pi_l \\}$.  Here $1\\leq l\\leq d-1$ and $0\\leq j<k\\leq d$.\nWith respect to this basis we wish to implement a Hamiltonian in the qubit subspace of the form\n$$\n\nH_\\mathrm{qb}(t)= {\\frac{1}{2}}\\left[h_x(t)\\sigma^x_{0,1}+\nh_y(t)\\sigma^y_{0,1}\\right] + \\frac{1}{2}h_z(t) \\left(\\Pi_0 - \\Pi_1\\right) .\n\\label{eq:Hwantq}\n$$\nPhysically this amounts to setting\nconditions  on the control fields and the frame transformation such that\n$$\n\\label{eq:conds}\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^x_{0,1}]=h_x(t),  \\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^y_{0,1}]= h_y(t),  \\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t)  \\left(\\Pi_0 - \\Pi_1 \\right)]= h_z(t), \\label{eq:conds2}\\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^x_{0,k}]=0~  \\mathrm{for}~2 \\leq k \\leq d-1,\\label{eq:conds2a}\\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^y_{0,k}]=0~  \\mathrm{for}~2 \\leq k \\leq d-1,\\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^x_{1,k}]=0~  \\mathrm{for}  ~2 \\leq k \\leq d-1,\\\\\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) \\sigma^y_{1,k}]=0~  \\mathrm{for}~  2 \\leq k \\leq d-1.\\label{eq:conds3}\n\n$$\nThe three first equations define the controls in the qubit subspace whereas the last four impose the condition of no leakage. There are no further conditionsso that the dynamics strictly inside the leakage subspace remains arbitrary.\n\nTo find a scheme that satisfies Eqs. (<ref>) \u2013 (<ref>) we write $A(t)=\\exp[-i S(t)]$ where $S(t)$ is an arbitrary Hermitian operator that we decompose as\n$$\n\nS(t) = \\sum_{j=1} s_{z,j}(t) \\Pi_j + \\sum_{j<k} s_{x,j,k}(t) \\sigma^x_{j,k} +  \\sum_{j<k}s_{y,j,k}(t) \\sigma^y_{j,k},\n\n$$ and by assuming a power series in a small parameter $\\epsilon$, we can write each element as\ns_\u03b1,j,k(t) = \u2211_n=1^\u221e s^(n)_\u03b1,j,k(t) \u03f5^l,\nwhere $\\alpha =x,y,$ or $z$. This ensures that the transformation is perturbative with respect to the parameter $\\epsilon$. We take $\\epsilon=1/t_g\\Delta$ as a small parameter, implying that, for the fast gates we are interested in, $\\Omega_G/\\Delta$ will be of order $\\epsilon$. Furthermore, since we are interested in unitary operations, we will define a dimensionless time and Hamiltonian whereby $\\int_0^{t_g} H(t)dt =\\int_0^1 \\bar H(t)dt$ (so $\\bar H(t)=t_g H$).  Doing this allows us to write the Hamiltonian for the system in Eq. (<ref>) as\n$$\n\\label{eq:dimHam}\n\\bar H(t) =\\frac{1}{\\epsilon} H_0 + \\bar\\delta(t) H_{z} + \\frac{\\bar\\Omega_{x}(t)}{2} H_{x}+ \\frac{\\bar\\Omega_{y}(t)}{2}  H_{y},\n\n$$ where\n$$\n\nH_0 &=& \\sum_{j=2}^{d-1} \\frac{\\Delta_j}{\\Delta_2}\\Pi_j,\\\\\nH_z &=& \\sum_{j=1}^{d-1}j \\Pi_j,\\\\\nH_x &=& \\sum_{j=1}^{d-1} \\lambda_{j-1} \\sigma_{j-1,j}^x, \\\\\nH_y &=& \\sum_{j=1}^{d-1} \\lambda_{j-1} \\sigma_{j-1,j}^y.\n\n$$ Here $\\bar\\delta(t)$, $\\bar\\Omega_{x}(t)$, and $\\bar\\Omega_{y}(t)$ are dimensionless versions of the previously defined matrix elements scaled by the rule $\\bar\\delta(t)=t_g \\delta(t)$. Note we have dropped the $R$ superscript and assume from now on we are in the rotating frame.\n\nFor the control fields we also write a series expansions\n$$\n\n\\bar\\Omega_{x}(t)&=& \\sum_{n=0}^{\\infty} \\epsilon^n \\bar\\Omega^{(n)}_{x}(t), \\\\\n\\bar\\Omega_{y}(t)&=& \\sum_{n=0}^{\\infty} \\epsilon^n \\bar\\Omega^{(n)}_{y}(t), \\\\\n\\bar\\delta(t)&=& \\sum_{n=0}^{\\infty} \\epsilon^n \\bar\\delta^{(n)}(t),\n\n$$\nand by the results presented in appendix <ref>, the constraints Eqs. (<ref>) \u2013 (<ref>) can be rewritten as\n$$\n\\label{eq:controlcon}\n\\bar\\Omega_{x}^{(n)}(t) & =& h_x^{(n)}(t)-\\mathrm{Tr} [ {H}_\\mathrm{extra}^{(n)}(t) \\sigma^x_{0,1} ], \\\\\u00e7\u00ac\n\\bar\\Omega_{y}^{(n)}(t) &=& h_y^{(n)}(t)- \\mathrm{Tr} [ {H}_\\mathrm{extra}^{(n)}(t) \\sigma^y_{0,1} ], \\\\\n\\bar\\delta^{(n)}(t) & =& \\mathrm{Tr} [ {H}_\\mathrm{extra}^{(n)}(t)\\left(\\Pi_0 - \\Pi_1 \\right)]-h_z^{(n)}(t), \\label{eq:controlcon2}\n\n$$ where ${H}_\\mathrm{extra}^{(n)}(t)$ contains terms generated by the lower orders of the transformation and the controls.\nIt is a rather complicated expression which can be derived following the procedure in appendix <ref> and the first few orders are listed in Eqs. (<ref>) \u2013 (<ref>).  For the leakage constraints Eqs. (<ref>) \u2013 (<ref>), we also derive in appendix <ref> the following constraints on the frame transformation:\n$$\n\n\\label{eq:framecon}\ns^{(n+1)}_{y,0,k}(t)&=&-\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)}(t) \\sigma^x_{0,k}],\\\\\ns^{(n+1)}_{x,0,k}(t)&=&\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)} (t)\\sigma^y_{0,k}]\\label{eq:framecon2b},\\\\\ns^{(n+1)}_{y,1,k}(t)&=&\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)} (t)\\sigma^x_{1,k}] -  \\frac{\\bar\\Omega_x^{(n)}(t)\\lambda_1\\delta_{k,2}}{2}, \\label{eq:framecon2a}\\nonumber\\\\\\\\\ns^{(n+1)}_{x,1,k}(t)&=&\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)}(t)\\sigma^y_{1,k}] + \\frac{\\bar\\Omega_y^{(n)}(t)\\lambda_1\\delta_{k,2}}{2}.\\nonumber\\\\\n\\label{eq:framecon2}\n\n$$\nThe coefficients $s^{(n+1)}_{x,0,1}(t)$, $s^{(n+1)}_{y,0,1}(t)$, and $s^{(n+1)}_{z,i}(t)$ are free parameters in our theory.  Choosing a different functional form for them result in different DRAG solutions. In the next section we will give some practical examples for this choice.\n\n### Zero, first, and second order DRAG solutions\n#### Zero order solution\nFor definiteness we choose the target Hamiltonian to be $\\Omega_{G}(t) \\sigma^x_{01}/2$ corresponding to rotations around the $x$-axis. Rotations around the $y$-axis will follow a similar procedure, and $z$-axis rotations are trivial. For this target Hamiltonian we require $h_x(t)=t_g\\Omega_G(t)$, $h_y(t)=0$, and $h_z(t)=0$. For simplicity, we take $h_x^{(0)}(t)=t_g\\Omega_G(t)$ and  $h_x^{(n)}(t)=0$ for $n>0$, and we take $h_y^{(n)}(t)=h_z^{(n)}(t)=0$ for $n\\geq0$. From Eq. (<ref>), the zeroth order expression $H_\\mathrm{extra}^{(0)}(t)$ is zero. This implies that the control constraints in Eqs. (<ref>) \u2013 (<ref>), for order zero, are\n$$\n\n\\begin{split}\n\\label{eq:zerodim}\n\\bar\\Omega_{x}^{(0)}  (t)=   t_g\\Omega_G(t) ,\\quad \\bar\\Omega_{y}^{(0)} (t)= 0, \\quad \\bar\\delta^{(0)}  (t)= 0,\n\\end{split}\n\n$$ giving control solutions\n$$\n\n\\begin{split}\\label{eq:zero}\n\\Omega_{x} (t)=  \\Omega_G(t) ,\\quad \\Omega_{y} (t)= 0,\\quad \\delta  (t)= 0.\n\\end{split}\n\n$$ These are the controls used in Sec. <ref> and here we will use them as a benchmark for the higher order solutions. In Fig. (Figure fig:DragFig3), we plot the error, $1-F_g$  with $F_g$ given by Eq. (<ref>) (blue dashed line), between a NOT gate an a unitary from the control field given by Eq. (<ref>) with $A=\\pi$ and $t_g=4\\sigma$ for a SNO with $d=5$. In this figure it is clearly seen that the error associated with these controls is quite large; for fast gate times this error is unacceptable for quantum information processing, and long gate times will have additional error arising from decoherence.\n\n< g r a p h i c s >\n\n(color online) Gate error for the implementation of a NOT gate in a $d=5$ SNO as a function of $\\sigma$, with $t_g=4\\sigma$, and a Gaussian shaped pulse. The blue dotted line is the zeroth order solution. The black dash line is the first order $Z$-only correction. The red dash-dot-dot line is the first order $Y$-only correction. The green dash-dot line is the first order correction from the controls presented in Ref. [Unknown Author, \"Unknown Title\", ]. The purple solid line is for the optimal first order correction.\n\n#### First order solution\nTo determine the first order solutions we need $H_\\mathrm{extra}^{(1)}(t)$, which requires determining the frame transformation conditions for $S^{(1)}(t)$. From Eqs. (<ref>) \u2013 (<ref>), these are\n$$\n\n\\begin{split}\ns^{(1)}_{x,0,k}(t) = &0,\\quad s^{(1)}_{y,0,k}(t) =0,\\\\ s^{(1)}_{x,1,k}(t) = &0,\\quad s^{(1)}_{y,1,k} (t)= -\\lambda_1 t_g\\Omega_{G}(t)\\delta_{k,2}/2.\n\\end{split}\n\n$$\nUsing Eq. (<ref>) for $H_\\mathrm{extra}^{(1)}(t)$, the first order corrections to the control fields are\n$$\n\\label{eq:controlfeilds}\n\\bar\\Omega_{x}^{(1)} (t) &=&  2\\dot{s}^{(1)}_{x,0,1} (t) ,\\\\\n\\bar\\Omega_{y}^{(1)}(t) &=&   2 \\dot{s}^{(1)}_{y,0,1} (t)-s^{(1)}_{z,1} (t)t_g\\Omega_G (t),\\\\\n\\bar\\delta^{(1)} (t) &=&\\dot{s}^{(1)}_{z,1}(t) + 2 s^{(1)}_{y,0,1}(t)t_g\\Omega_G(t) + \\frac{\\lambda_1^2 t_g^2\\Omega_G^2(t)}{4}.\\nonumber\\\\\n\n$$\nHere we see that there is a continuous family of DRAG pulses; however, in this section we will consider four particular solutions. In all of these solutions we take ${s}^{(1)}_{x,0,1} (t)=0$ as it has no influence on our choice for $\\bar\\Omega_{y}^{(1)}(t)$ and $\\bar\\delta^{(1)} (t)$.\n\nThe first solution we consider is one where the control field $\\Omega_{y}(t)=0$. This is achieved by setting $s^{(1)}_{z,1} (t)= 2 \\dot{s}^{(1)}_{y,0,1} (t)/t_g\\Omega_G (t)$, resulting in\n$$\n\n\\begin{split}\n\\bar\\delta^{(1)} (t) = &\\frac{2 \\ddot{s}^{(1)}_{y,0,1} (t)}{t_g\\Omega_G (t)} - \\frac{2 \\dot{s}^{(1)}_{y,0,1} (t)\\dot\\Omega_G (t)}{t_g\\Omega_G^2 (t)}\\\\&+ 2 s^{(1)}_{y,0,1}(t)t_g\\Omega_G(t) + \\frac{\\lambda_1^2 t_g^2\\Omega_G^2(t)}{4}.\n\\end{split}\n\n$$ The simplest solution that satisfies $S^{(1)}(0)=S^{(1)}(t_g)=0$ is $s^{(1)}_{y,0,1}(t)=0$. In this case the controls become\n$$\n\n\\begin{split}\n\\Omega_{x}(t) =&  \\Omega_G ,\\quad\n\\Omega_{y}(t) =  0, \\quad\n\\delta(t) = \\frac{\\lambda_1^2 \\Omega_G^2(t)}{4\\Delta_2}.\n\\end{split}\n\n$$ For the SNO considered in Fig. (Figure fig:DragFig3), the error for this control set is plotted as the black dashed line. It clearly has a much lower error then the standard Gaussian amplitude modulation control, and we will refer to this as the $Z$-only correction.\n\nThe second control solution we consider is when the control field $\\delta(t)=0$. This is achieved by setting $s^{(1)}_{y,0,1}(t)=-\\dot{s}^{(1)}_{z,1}(t)/2t_g\\Omega_G(t) -{\\lambda_1^2 t_g\\Omega_G(t)}/{8}$, which results in\n$$\n\n\\begin{split}\n\\bar\\Omega_{y}^{(1)}(t) =& -\\frac{\\ddot{s}^{(1)}_{z,1}(t)}{t_g\\Omega_G(t)}+\\frac{\\dot{s}^{(1)}_{z,1}(t)\\dot\\Omega_G(t)}{t_g\\Omega^2_G(t)}\\\\&  -\\frac{\\lambda_1^2 t_g\\dot\\Omega_G(t)}{4}-s^{(1)}_{z,1} (t)t_g\\Omega_G (t).\n\\end{split}\n\n$$ Again, the simplest solution that satisfies $S^{(1)}(0)=S^{(1)}(t_g)=0$ is $s^{(1)}_{z,1}(t)=0$. In this case, the controls become\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  -\\frac{\\lambda_1^2 \\dot\\Omega_G(t)}{4\\Delta_2},\\quad\n\\delta(t) =  0,\n\\end{split}\n\n$$ and, for the SNO considered in the numerical demonstration, the error for this control set is plotted in Fig. (Figure fig:DragFig3) as the red dash-dot-dot line. Its error rate is lower then both the standard Gaussian controls and the $Z$-only correction. This is the control procedure used in Ref. [Unknown Author, \"Unknown Title\", ] and Ref. [Unknown Author, \"Unknown Title\", ], where it was referred to as simple DRAG and half derivative respectively. Here we will refer to this as simply $Y$-only correction.\n\nThe third control solution we consider is what we refer to as the optimal first order solution. This is achieved by minimizing the elements in $H_\\mathrm{extra}^{(2)}(t)$ such that the second order corrections to the control fields are zero. From Eq. (<ref>), we require calculating the second order frame transformations. From Eqs. (<ref>) \u2013 (<ref>) these are\n$$\n\n\\label{eq:framecon2or2}\ns^{(2)}_{y,0,2}&=&-\\frac{1}{2}t_g\\Omega_G \\lambda_1 (t_g\\Omega_G+ s^{(1)}_{y,0,1}),\\\\\ns^{(2)}_{x,0,2}&=&-\\frac{1}{2}t_g\\Omega_G \\lambda_1 s^{(1)}_{x,0,1},\\\\\ns^{(2)}_{y,1,2}&=&-\\lambda_1\\dot{s}^{(1)}_{x,0,1},\\\\\ns^{(2)}_{x,1,2}&=&\\frac{1}{2}\\lambda_1(2\\dot\\Omega_G+2\\dot s^{(1)}_{y,0,1}-2t_g \\Omega_G s^{(1)}_{z,1} + t_g\\Omega_G s^{(1)}_{z,2}).\\nonumber\\\\\n\n$$\nUsing these expressions and requiring that the matrix elements of $H_\\mathrm{extra}^{(2)}(t)$ are zero in the qubit subspace (and elements coupling to the qubit subspace are zero) results in ${s}^{(1)}_{x,0,1}(t)={s}^{(1)}_{z,1}(t)=0$ and ${s}^{(1)}_{y,0,1}(t)=-t_g\\Omega_G(t)\\lambda_1/4$.  Substituting these into Eq. (<ref>) gives the controls fields\n$$\n\n\\begin{split}\n\\Omega_{x}(t) =& \\Omega_G(t) ,\\quad\n\\Omega_{y}(t)=  -\\frac{\\dot\\Omega_G(t)\\lambda_1}{2\\Delta_2},\\\\\n\\delta (t)=& \\frac{\\Omega_G^2(t)}{4\\Delta_2}[\\lambda_1^2 -2\\lambda_1].\n\\label{eq:env_from_s}\n\\end{split}\n\n$$ This optimal first order solution is plotted in Fig. (Figure fig:DragFig3) as the solid purple line. Its error is substantially lower the the other first order correction methods.\n\nFinally for completeness we also present the first order DRAG solution presented in Ref. [Unknown Author, \"Unknown Title\", ]. This occurs when we choose ${s}^{(1)}_{x,0,1}(t)={s}^{(1)}_{z,1}(t)=0$ and ${s}^{(1)}_{y,0,1}(t)=-\\Omega_G(t)/2$, resulting in\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  -\\frac{\\dot\\Omega_G(t)}{\\Delta_2},\\quad\\\\\n\\delta(t) =& \\frac{ \\Omega_G^2(t)}{4\\Delta_2}[\\lambda_1^2-4].\n\\end{split}\n\n$$ This solution can be intuitively derived from an interaction picture; however, there is nothing optimal about this choice. In Fig. (Figure fig:DragFig3),  the green dash-dot line shows how the error scales with this control set.  We see that for the first order solution, the error is larger than both the optimal and the $Y$-only correction methods. That is, the first order solution of Ref. [Unknown Author, \"Unknown Title\", ] is not optimal.\n\n#### Second order solution\nThe higher order solutions become impractical to solve in generality because the number of terms grows quickly with increasing order.  However, we can easily find the second and higher order corrections to the different first order solutions.  To do this, it is simplest to use a computer algebra system as the expressions for $H_\\mathrm{extra}^{(2)}(t)$ and $H_\\mathrm{extra}^{(3)}(t)$ are rather involved [see Eqs. (<ref>) and (<ref>)]. We find that\nthe corrections to the above four cases only change the $\\Omega_{x}(t)$ field. In the $Z$-only case,  $\\Omega_{x}(t)$ becomes\n$$\n\n\\Omega_{x}(t) =   \\Omega_G(t) +\\frac{\\lambda_1^2\\Omega_G^3}{8\\Delta_2^2},\n\n$$ in the $Y$-only case, $\\Omega_{x}(t)$ becomes\n$$\n\n\\Omega_{x}(t) =   \\Omega_G(t) - \\frac{\\lambda_1^2(\\lambda_1^2-4)\\Omega_G^3}{32\\Delta_2^2},\n\n$$ and the control set presented in Ref. [Unknown Author, \"Unknown Title\", ] gives\n$$\n\n\\Omega_{x}(t) =   \\Omega_G(t) + \\frac{(\\lambda_1^2-4)\\Omega_G^3}{8\\Delta_2^2}.\n\n$$ To demonstrate these correction we plot in Fig. (Figure fig:DragFig4) the second order solutions. The line marking and colors are the same as in Fig. (Figure fig:DragFig3) with the exception that they now refer to second order solutions (all except the blue dotted line, which remains the zero order solution, and the purple solid line, which is the first order optimal solution). We see that the second order only makes small improvements to the $Y$-only (red dash-dot-dot) and $Z$-only (black dashed) first order solutions. Remarkably, the original DRAG scheme from Ref. [Unknown Author, \"Unknown Title\", ] (green dash-dot) is improved substantially when corrected to second order. It is for this reason that we argue this is the best solution for implementing a DRAG correcting pulse.\n\nWe have not proven the DRAG solution to be optimal, and it seems likely that a better second order solution exists. To find the optimal solution, the matrix elements of $H_\\mathrm{extra}^{(3)}(t)$ in the qubit subspace and the elements that couple to it must be minimized.  We have not computed this solution due to the complexity of $H_\\mathrm{extra}^{(3)}(t)$ as well as the already outstandingly low error of the original DRAG solution.\n\n< g r a p h i c s >\n\n(color online) Gate error for the implementation of a NOT gate in a $d=5$ SNO as a function of $\\sigma$, with $t_g=4\\sigma$, and a Gaussian shaped pulse. The blue dotted line is the zeroth order solution. The black dash line is the second order $Z$-only correction. The red dash-dot-dot line is the second order $Y$-only correction. The green dash-dot line is the second order correction from the controls presented in Ref. [Unknown Author, \"Unknown Title\", ]. The purple solid line is for the optimal first order correction.\n\n### Numerically optimized first order solutions\nGiven the ease of implementing the first order solutions, in this section we consider the problem of numerically optimizing a value for the control fields with the following ansatz\n$$\n\n\\begin{split}\n\\Omega_{x}(t) =& \\alpha\\Omega_G(t) ,\\quad\n\\Omega_{y}(t)=  -\\beta\\frac{\\dot\\Omega_G(t)}{\\Delta_2},\\\\\n\\delta (t)=& \\gamma\\frac{\\Omega_G^2(t)}{\\Delta_2}+\\delta_0,\n\\end{split}\n\n$$ where $\\alpha$, $\\beta$, $\\gamma$  and $\\delta_0$ are fit parameters. We consider a SNO with $\\Delta_2=-2\\pi$, $\\lambda_{j-1}=\\sqrt{j}$, $d=5$, and a control field given by Eq. (<ref>) with $A=\\pi$ and $t_g=4\\sigma$ (same as before). In Fig. (Figure fig:Numerical) we plot the gate error as a function of $\\sigma$ for different optimizations. The optimization procedure was done with Mathematica with a working precision of 10. In Fig. (Figure fig:Numerical) (a) we consider the case when $\\delta_0=0$, and we find that optimizing the weighting of the control fields only improves the first order solutions slightly. This is expected as the second order solutions require different functional forms for the controls.\nHowever, when we allow $\\delta_0$ to be non-zero, we find some interesting results. For the numerical parameters considered, we find that implementing a time varying $\\delta(t)$ ($\\gamma\\neq 0$) does not lead to any improvements. This is seen in Fig. (Figure fig:Numerical) (b) where we show that the error arising  from an optimized Gaussian with added constant detuning (blue dotted line) is approximately equal to the optimized $Z$-only correction with an added constant detuning (black dashed line).  Furthermore, the optimized $Y$-only correction with an added constant detuning (red dash-dot-dot) is approximately equal to the optimal first order solution with an added constant detuning (solid purple).  We also find that for the solutions with the derivative for the $Y$-control (solid purple and red dash-dot-dot) the gate error is much lower then in the other cases (blue dotted and black dashed). This gate error is approximately equal to those found with the second order corrections from Fig. (Figure fig:DragFig4) (green dash-dot line).  We conjecture from these numerics that the optimal DRAG-like solution can be obtained by applying a pulse to the $x$-axis (and its derivative to the $y$-axis) with a frequency that is not equal to the transition frequency of qubit.\n\n< g r a p h i c s >\n\n(color online) Gate error for the implementation of a NOT gate in a $d=5$ SNO as a function of $\\sigma$, with $t_g=4\\sigma$, and a Gaussian shaped pulse. Panel (a) is for optimized first order solutions. The blue is for optimized $\\alpha$ with $\\beta=\\gamma=\\delta_0=0$ (zeroth order solution). The black dashed is for optimized $\\alpha$ and $\\gamma$ with $\\beta=\\delta_0=0$ ($Z$-only solution). Red dash-dot-dot is optimized $\\alpha$ and $\\beta$ with $\\gamma=\\delta_0=0$ ($Y$-only solution). Purple solid line is for optimized $\\alpha$, $\\beta$, and $\\gamma$ with $\\delta_0=0$ (optimal first order solution). Panel (b) is the same as (a) but with $\\delta_0$ being optimized.\n\n## Leakage extension\nIn this section, we show that the DRAG technique can be applied to systems with more then one leakage transition. To show this we consider the two cases shown in Fig. (Figure fig:Ext). We note that these are arbitrary examples, and the theory is more general then considered here [see appenix C].\n\n< g r a p h i c s >\n\n(color online) Energy level diagrams for systems that can also be model by our theory. In (a) we consider the case when the qubit has leakage from both its $\\ket{0}$ and $\\ket{1}$ level. In (b) we consider the case when the qubit has leakage from its $\\ket{1}$ level to more then one higher level.\n\n### Leakage from both logical states\nThe first case we consider is a qubit defined in the intermediate states of an anharmonic oscillator [Fig.\u00a0(Figure fig:Ext) (a)].\nThis situation is important if the anharmonic oscillator is going to be used for qudit logic, as done in Ref. [Unknown Author, \"Unknown Title\", ], or for state tomography of the qudit, as done in Ref. [Unknown Author, \"Unknown Title\", ].\nIn this case, we rewrite the free and coupling Hamiltonian as\n$$\n\nH_\\mathrm{fr}&=&\\sum_{j=-N}^{N}(j\\omega+\\Delta_j)\\Pi_j,\\\\\nH_\\mathrm{ct}(t)&=&\\mathcal{E}(t)\\sum_{j=-N+1}^{N}\\lambda_{j-1}\\sigma^x_{j-1,j},\n\\label{eq:hamiltonianB}\n$$ where $N=(d-1)/2$ and again we take $\\Delta_0=\\Delta_1=0$. Moving to a interaction frame similar to Eq. (<ref>) (the sum range is change to be consistent with  the above) we find a dimensionless rotating frame Hamiltonian equivalent to Eq. (<ref>) with\n$$\n\nH_0 &=& \\sum_{j=-N,\\neq0,1}^{N} \\frac{\\Delta_j}{\\Delta_2}\\Pi_j,\\\\\nH_z &=& \\sum_{j=-N}^{N}j \\Pi_j,\\\\\nH_x &=& \\sum_{j=-N+1}^{N}\\lambda_{j-1} \\sigma_{j-1,j}^x, \\\\\nH_y &=& \\sum_{j=-N+1}^{N} \\lambda_{j-1} \\sigma_{j-1,j}^y.\n\n$$\nUsing the results of appendix <ref>, the zero order dimensionless controls are the same as Eq. (<ref>), implying that the zeroth order controls are given by Eq. (<ref>).  To find the first order corrections we follow a similar procedure to Sec. <ref>. The frame constraints from Eqs. (<ref>) and (<ref>)  become\n$$\n\ns^{(n+1)}_{y,0,k}(t)&=&-\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)}(t) \\sigma^x_{0,k}]-\\frac{\\Delta_2\\bar\\Omega_x^{(n)}(t)\\lambda_{-1}\\delta_{k,-1}}{2\\Delta_{-1}},\\nonumber\\\\\\\\\ns^{(n+1)}_{x,0,k}(t)&=&\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)} (t)\\sigma^y_{0,k}]+\\frac{\\Delta_2\\bar\\Omega_y^{(n)}(t)\\lambda_{-1}\\delta_{k,-1}}{2\\Delta_{-1}},\\nonumber\\\\\n\n$$ while Eqs. (<ref>) and (<ref>) remain the same.\nWith  $H_\\mathrm{extra}^{(1)}(t)$ given by Eq. (<ref>) we find the first order frame transformation to be\n$$\n\n\\begin{split}\ns^{(1)}_{x,0,k}(t) = &0,\\quad s^{(1)}_{y,0,k}(t) =-\\frac{\\lambda_{-1}\\Delta_{2} t_g\\Omega_{G}(t)\\delta_{k,-1}}{2\\Delta_{-1}},\\\\ s^{(1)}_{x,1,k}(t) = &0,\\quad s^{(1)}_{y,1,k} (t)= -\\frac{\\lambda_1 t_g\\Omega_{G}(t)\\delta_{k,2}}{2},\n\\end{split}\n\n$$\nand the dimensionless first order control fields are\n$$\n\n\\bar\\Omega_{x}^{(1)} (t) &=&  2\\dot{s}^{(1)}_{x,0,1} (t) ,\\\\\n\\bar\\Omega_{y}^{(1)}(t) &=&   2 \\dot{s}^{(1)}_{y,0,1} (t)-s^{(1)}_{z,1} (t)t_g\\Omega_G (t),\\\\\n\\bar\\delta^{(1)} (t) &= &\\dot{s}^{(1)}_{z,1}(t) + 2 s^{(1)}_{y,0,1}(t)t_g\\Omega_G(t) \\\\&&+ \\frac{t_g^2\\Omega_G^2(t)}{4}\\textstyle{\\left(\\lambda_1^2 -\\frac{\\Delta_{2}}{\\Delta_{-1}}\\lambda_{-1}^2 \\right).}\n\n$$\nFrom this we find the control fields for $Z$-only correction are\n$$\n\n\\begin{split}\n\\Omega_{x}(t) =&  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  0,\\quad\\\\\n\\delta(t) =& \\frac{ \\Omega_G^2(t)}{4}{\\textstyle{ \\left[\\frac{\\lambda_{1}^2}{\\Delta_2}-\\frac{\\lambda_{-1}^2}{\\Delta_{-1}}\\right]}},\n\\end{split}\n\n$$\nthe $Y$-only are\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  -\\frac{\\dot\\Omega_G(t)}{4}{\\textstyle{\\left[\\frac{\\lambda_{1}^2}{\\Delta_2}-\\frac{\\lambda_{-1}^2}{\\Delta_{-1}}\\right],}}\\quad\\\\\n\\delta(t) =& 0,\n\\end{split}\n\n$$\nand the optimal first order control field corrections (after minimizing  $H_\\mathrm{extra}^{(2)}(t)$) are\n$$\n\n\\Omega_{x}(t) &= &  \\Omega_G(t) ,\\\\\n\\Omega_{y}(t) &=&  -\\frac{\\dot\\Omega_G(t)}{2\\Delta_2}{\\textstyle{\\sqrt{\\lambda_1^2+{{\\frac{\\Delta_2^2}{\\Delta_{-1}^2}}}\\lambda_{-1}^2}},}\\\\\n\\delta(t) &=&\\frac{ \\Omega_G^2(t)}{4\\Delta_2}{\\textstyle{\\left[\\lambda_1^2-\\frac{\\Delta_2^2}{\\Delta_{-1}^2}\\lambda_{-1}\\right]}}.\n\n$$\nTo numerically demonstrate an improvement over the zeroth order solution we consider a SNO (of $d=6$) where we want to control the $2\\rightarrow3$ transition. In this case, we relabel $j=2$ to 0 and so on, rescaling the coupling so that the new $0\\rightarrow1$ transition is unity. This results in setting $\\Delta_3=3\\Delta_2$, $\\Delta_{-1}=\\Delta_2$, $\\Delta_{-2}=3\\Delta_2$, and $\\lambda_0=1$, $\\lambda_{1}=\\sqrt{4/3}$, $\\lambda_2=\\sqrt{5/3}$ $\\lambda_{-1}=\\sqrt{2/3}$, $\\lambda_{-2}=\\sqrt{1/3}$. In Fig. (Figure fig:DragFig7), the gate error for  implementing a NOT gate is shown as a function of $\\sigma$ for the same Gaussian shaped pulse as considered in Sec. <ref>. Here we observe that the DRAG technique improves the gate fidelities substantially when compared to the zeroth order solution and has error rates comparable to that of the case with only one leakage channel.\n\n< g r a p h i c s >\n\n(color online) Gate error for the implementation of a NOT gate when there is leakage above and below the qubit subspace. The system considered is explained in the text. The blue dotted line is the zeroth order solution. The black dash line is the first order $Z$-only correction. The red dash-dot-dot line is the first order $Y$-only correction. The purple solid line is for the optimal first order correction.\n\n### Leakage from the excited state to more then one auxiliary level\nIn the second case, shown in Fig. (Figure fig:Ext) (b), we consider a qubit made from the lowest 2 levels of a system which is coupled to many other transitions, all transitions having only a small energy cost (approximately $\\Delta_2$).   This is an interesting example as it shows how this theory can be easily generalized.\nIn this case we rewrite the free and coupling Hamiltonians as\n$$\n\nH_\\mathrm{fr}&=&\\omega\\Pi_1+\\sum_{j=2}^{d-1}(2\\omega+\\Delta_j)\\Pi_j,\\\\\nH_\\mathrm{ct}(t)&=&\\mathcal{E}(t)\\bigg(\\lambda_0\\sigma^x_{0,1}+\\sum_{j=2}^{d-1}\\lambda_{j-1}\\sigma^x_{1,j}\\bigg).\n\\label{eq:hamiltonianC}\n$$\nTo eliminate the fast degrees of freedom we move to a rotating frame and make the standard rotating wave approximation. The procedure is similar to Sec. <ref> with the replacement of  Eq. (<ref>) by\n$$\n\nR(t)=\\exp\\left(-i \\omega_d t \\right)\\Pi_1+\\sum_{j=2}^{d-1}\\exp\\left(-i 2\\omega_d t \\right)\\Pi_j.\n\n$$ This results in a dimensionless rotating frame Hamiltonian equivalent to Eq. (<ref>) with\n$$\n\nH_0 &=& \\sum_{j=2}^{d-1} \\frac{\\Delta_j}{\\Delta_2}\\Pi_j,\\quad\nH_z = \\Pi_1+\\sum_{j=2}^{d} 2\\Pi_j,\\nonumber\\\\\nH_x &=& \\lambda_0\\sigma^x_{0,1}+\\sum_{j=2}^{d-1}\\lambda_{j-1}\\sigma^x_{1,j}, \\quad\nH_y = \\lambda_0\\sigma^x_{0,1}+\\sum_{j=2}^{d-1}\\lambda_{j-1}\\sigma^y_{1,j}.\\nonumber\n\n$$ Again, we find the zeroth order controls given by Eq. (<ref>).  To find the first order corrections, we follow a similar procedure as in Sec. <ref>, finding that the frame constraints Eqs. (<ref>) and (<ref>) remain the same, but Eqs. (<ref>) and (<ref>)  are changed to\n$$\n\ns^{(n+1)}_{y,1,k}(t)&=&-\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)} (t)\\sigma^x_{1,k}]-\\frac{\\bar\\Omega_x^{(n)}(t)\\lambda_{k-1}\\Delta_2}{2\\Delta_k},\\nonumber\\\\\\\\\ns^{(n+1)}_{x,1,k}(t)&=&\\frac{\\Delta_2}{2 \\Delta_k}\\mathrm{Tr}[{H}_\\mathrm{extra}^{(n)}(t)\\sigma^y_{1,k}]+\\frac{\\bar\\Omega_y^{(n)}(t)\\lambda_{k-1}\\Delta_2}{2\\Delta_k}. \\nonumber\\\\\n\n$$\nFrom the above with  $H_\\mathrm{extra}^{(1)}(t)$ given by Eq. (<ref>), we find the first order frame transition to be\n$$\n\n\\begin{split}\ns^{(1)}_{x,0,k}(t) = &0,\\quad s^{(1)}_{y,0,k}(t) =0,\\\\ s^{(1)}_{x,1,k}(t) = &0,\\quad s^{(1)}_{y,1,k} (t)= -\\frac{\\lambda_{k-1} t_g\\Omega_{G}(t)\\Delta_{2}}{2\\Delta_k}.\n\\end{split}\n\n$$\nThis gives the dimensionless first order control fields\n$$\n\n\\begin{split}\n\\bar\\Omega_{x}^{(1)} (t) =&  2\\dot{s}^{(1)}_{x,0,1} (t) ,\\\\\n\\bar\\Omega_{y}^{(1)}(t) =&   2 \\dot{s}^{(1)}_{y,0,1} (t)-s^{(1)}_{z,1} (t)t_g\\Omega_G (t),\\\\\n\\bar\\delta^{(1)} (t) = &\\dot{s}^{(1)}_{z,1}(t) + 2 s^{(1)}_{y,0,1}(t)t_g\\Omega_G(t) \\\\&+ \\frac{t_g^2\\Omega_G^2(t)\\Delta_{2}}{4}{\\textstyle{\\left(\\sum_{k=2}^{d-1}\\frac{\\lambda_{k-1}^2}{\\Delta_{k}} \\right).}}\n\\end{split}\n\n$$\nFrom this, we find the control fields for the $Z$-only correction are\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  0,\\quad\\\\\n\\delta(t) =& \\frac{ \\Omega_G^2(t)}{4}{\\textstyle{\\sum_{k=2}^{d-1}\\frac{\\lambda_{k-1}^2}{\\Delta_{k}},}}\n\\end{split}\n\n$$\nfor the $Y$-only correction are\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  -\\frac{\\dot\\Omega_G(t)}{4}{\\textstyle{\\sum_{k=2}^{d-1}\\frac{\\lambda_{k-1}^2}{\\Delta_{k}} ,}}\\quad\\\\\n\\delta(t) =& 0,\n\\end{split}\n\n$$\nand the optimal first order control field corrections (after minimizing  $H_\\mathrm{extra}^{(2)}(t)$) are\n$$\n\n\\begin{split}\n\\Omega_{x}(t) = &  \\Omega_G(t) ,\\quad\n\\Omega_{y}(t) =  -\\frac{\\dot\\Omega_G(t)}{2\\Delta_2}{\\textstyle{\\sqrt{\\sum_{k=2}^{d-1}\\frac{\\Delta_{2}^2\\lambda_{k-1}^2}{\\Delta_{k}^2}},}}\\quad\\\\\n\\delta(t) =& \\frac{ \\Omega_G^2(t)}{4\\Delta_2}{\\textstyle{\\left[\\sum_{k=2}^{d-1}\\frac{\\Delta_{2}^2\\lambda_{k-1}^2}{\\Delta_{k}^2}-2\\sqrt{\\sum_{k=2}^{d-1}\\frac{\\Delta_{2}^2\\lambda_{k-1}^2}{\\Delta_{k}^2}} \\right].}}\n\\end{split}\n\n$$\nWe note that these solutions are identical to the previous solutions with a single leakage channel where $\\lambda_1=\\tilde{\\lambda}$,\n$$\n\n\\tilde{\\lambda} \\equiv {\\textstyle{\\sqrt{\\sum_{k=2}^{d-1}\\frac{\\Delta_{2}^2\\lambda_{k-1}^2}{\\Delta_{k}^2}}}}.\n\n$$\n\nTo numerically demonstrate an improvement over the zeroth order solution, we consider the implementation of a NOT gate for a $d=6$ system with $\\lambda_j=1$ for all $j$ and $\\Delta_3=2\\Delta_2$, $\\Delta_{4}=3\\Delta_2$, $\\Delta_{5}=4\\Delta_2$ (note these are different parameters from the anharmonic oscillator considered in Sec.\u00a0<ref>). The results are plotted in Fig. (Figure fig:DragFig8), where again, it is clearly seen that the DRAG technique improves the zeroth order solution.\n\n< g r a p h i c s >\n\n(color online) Gate error for the implementation of a NOT gate when there is many leakage transitions for the excited state. The system considered is explained in the text. The blue dotted line is the zeroth order solution. The black dash line is the first order $Z$-only correction. The red dash-dot-dot line is the first order $Y$-only correction. The purple solid line is for the optimal first order correction.\n\n## Conclusions\nIn this paper we have presented a general technique for designing simple controls fields for single qubit unitary operations in weakly non-linear oscillators, which we refer to as the DRAG  (Derivative Removal by Adiabatic Gate) technique.  We first consider a qubit formed by the two lowest levels of an anharmonic oscillator with only the one photon transition elements being non-zero. In this system, the largest source of error for fast gates (small gate times) is leakage from the $\\ket{1}$ state to the $\\ket{2}$ state. Our technique provides a simple control methodology that perturbatively removes this error, thereby allowing high fidelity single qubit gates. The essential idea of this method is to apply a $y$-field that is proportional to the derivative of the original control pulse.  It contains the DRAG solution presented in Ref. [Unknown Author, \"Unknown Title\", ] as well as a large collection of control pulses that also correct for this leakage error, which, for example, require fewer control fields.  The lowest error obtained requires this derivative correction as well as a frequency shift.  Furthermore, we show that this methodology can be easily extended to other weakly non-linear oscillators with more then one leakage transition.\n\nIn this paper, we considered Gaussian pulses due to their favorable spectral properties, however, our theory is independent of the initial form of the pulse shape.  A future research direction could be to find the optimal pulse shape for the leakage problem.  Furthermore, while the pulses found here are robust to first order in variations in the control parameters it would be interesting to search for pulses with higher order robustness properties.\n\nWe acknowledge, E. J. Pritchett for a carefull reading of the manuscript, B. Khani, J. M. Chow, L. DiCarlo, E. Lucero, J. M. Martinis and R. J. Schoelkopf for valuable discussions. J.M.G. was supported by CIFAR, DARPA/MTO QuEST program through a grant from AFOSR, Industry Canada, MITACS, MRI and NSERC. F.M., S.T.M., and\nF.K.W.\u00a0were supported by NSERC through the discovery grants and\nQuantumWorks. This research was also funded by the Office of the Director of National\nIntelligence (ODNI), Intelligence Advanced Research Projects Activity\n(IARPA), through the Army Research Office. \u00a0All statements of fact, opinion\nor conclusions contained herein are those of the authors and should not be\nconstrued as representing the official views or policies of IARPA, the ODNI,\nor the U.S. Government.\n\nTYPICAL FUNCTIONAL FORMS FOR $\\lambda_j$\n\nIn this appendix, we discuss the different possible values $\\lambda_j$ for the realistic models of direct driving [Unknown Author, \"Unknown Title\", ] and the cavity [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or circuit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] QED\narchitecture.\nIn cases where the system is a SNO and is driven\ndirectly, $\\lambda_j$ is well approximated by the harmonic oscillator matrix elements, namely  $\\lambda_j \\approx \\sqrt{j}$. This, for\nexample, occurs for the phase qubit when it is driven by a time-varying\nbias current [Unknown Author, \"Unknown Title\", ] and the transmon when it is driven by time-varying gate voltage [Unknown Author, \"Unknown Title\", ]. Essentially, these systems are very nearly harmonic oscillators and the controls are almost proportional to the quadrature operator.\n\nIn the cavity or circuit QED\narchitecture, the anharmonic oscillator is coupled to a resonator and is control by driving the resonator far off-resonance. In this case, $\\lambda_j$ can take on essentially any value. To see this, we start by writing the full Hamiltonian for the multi-level anharmonic oscillator and resonator as\n$$\n\\label{eq:JC}\n\\begin{split}\nH_\\mathrm{JC} =& \\omega_r a^\\dagger a + \\sum_{j=1}^{d-1}(j\\omega+\\Delta_j)\\Pi_j \\\\&+ \\sum_{j=1}^{d-1} g_{j-1,j}\\left( \\ket{j-1}\\bra{j}a^\\dagger+\\ket{j}\\bra{j-1}a\\right),\n\\end{split}\n\n$$ again $\\Delta_0=\\Delta_1=0$. This is a generalized Jaynes-Cummings Hamiltonian [Unknown Author, \"Unknown Title\", ] with $\\omega_r$ being the resonator frequency, and $g_{j,k}$ being the vacuum Rabi coupling for the $j$ to $k$ levels. Again we have assumed that the anharmonic oscillator only allows one photon transitions.\n\nIf $|\\omega'_{j-1,j}-\\omega_r|\\gg |g_{j-1,j}|$ for all $j$ where $\\omega'_{j-1,j}=\\omega+\\Delta_j-\\Delta_{j-1}$ then diagonalization of Eq. (<ref>) can be performed to lowest order in $g_{j-1,j}/(\\tilde\\omega_{j-1,j}-\\omega_r)$ by the canonical transformation $H_\\mathrm{JC}^\\mathrm{D}= D^\\dagger H_\\mathrm{JC} D$ where\n$$\n\\label{eq:D}D=\\exp\\left[\\sum_{j=1}^{d-1} \\frac{g_{j-1,j}}{\\omega'_{j-1,j}-\\omega_r}( a^\\dagger \\ket{j-1}\\bra{j}-a \\ket{j}\\bra{j-1})\\right]\n$$  to give\n$$\n\n\\begin{split}\nH_\\mathrm{JC}^D=&(\\omega_r-\\chi_{01}) a^\\dagger a + \\sum_{j=1}^{d-1}\\left(j\\omega+\\Delta_j+\\chi_{j-1,j}\\right)\\Pi_j\\\\&+\\sum_{j=1}^{d-1}(\\chi_{0,1}+\\chi_{j-1,j}-\\chi_{j,j+1})a^\\dagger a\\Pi_j.\n\\end{split}\\label{eq:HJCD}\n\n$$ Here $\\chi_{j-1,j}={g_{j-1,j}^2}/{(\\omega'_{j-1,j}-\\omega_r)}$ is the Lamb shift induced on the  anharmonic oscillator by the resonator and the last term in Eq. (<ref>) is the ac-Stark shift [Unknown Author, \"Unknown Title\", ].  Assuming that the dressed cavity is in vacuum  then Eq. (<ref>) is well approximated by Eq. (<ref>) with\n$$\n\\label{eqs:replace}\n\\omega&\\rightarrow&\\tilde\\omega=\\omega+\\chi_{0,1}\\\\\n\\Delta_j&\\rightarrow&\\tilde\\Delta_j=\\Delta_j+\\chi_{j-1,j}-j\\chi_{0,1}\n\n$$ and the tilde implies dressed values for the transition frequency and anharmonicity from the resonator.\n\nAs stated above, the control is usually through the resonator and is represented by the Hamiltonian\n$$\nH_\\mathrm{dr}(t)=\\varepsilon(t)(a+a^\\dagger)\n$$ which under the transformation Eq. (<ref>) becomes\n$$\nH^D_\\mathrm{dr}(t)=\\varepsilon(t)\\left(a+a^\\dagger + \\sum_{j=1}^{d-1} \\frac{g_{j-1,j}}{\\omega'_{j-1,j}-\\omega_r}\\sigma_{j-1,j}^x\\right). \\label{eq:Hdr}\n$$ Assuming that $\\varepsilon(t)$ is a sinusoidal with a  frequency close to the qubit then Eq. (<ref>) is well approximated by Eq. (<ref>) with\n$$\n\n\\mathcal{E}(t)&=&\\frac{g_{0,1}}{\\omega'_{0,1}-\\omega_r}\\varepsilon(t)\\\\\n\\lambda_{j-1}&=&\\frac{g_{j-1,j}(\\omega'_{0,1}-\\omega_r)}{g_{0,1}(\\omega'_{j-1,j}-\\omega_r)}.\\label{eq:lambda}\n\n$$\n\nTo demonstrate the functional form of $\\lambda_1$, we will assume the anharmonic oscillator is in the SNO limit; $\\omega'_{j-1,j}=\\omega+(j-1)\\Delta_2$, and $g_{j-1,j}=\\sqrt{j}g_{0,1}$. In this case, Eq. (<ref>) becomes\n$$\n\\label{eq:lambdaSNO}\n\\lambda_{j-1} = \\frac{\\sqrt{j}}{1+(j-1)\\Delta_2/(\\omega-\\omega_r)},\n$$ and is plotted in In Fig. (Figure fig:Lambda) as a function of the bare anharmonicity in units of $(\\omega-\\omega_r)$. Here, it is clearly seen that $\\lambda_1$ is of not equal to $\\sqrt{2}$ and actually changes sign at the point ($\\omega-\\omega_r=-\\Delta_2$). This point invalidates the diagonalization for the second level and can not be treated under this model. Away from this point the values obtained from this model approximate the real situation. This was confirmed in Ref. [Unknown Author, \"Unknown Title\", ] where the experimental value for $\\lambda_1$ for the operation point used was found to agree with Eq. (<ref>). However, we propose that $\\lambda_j$ should be used as a fitting parameter in any experiment as effects such as higher modes of the resonator and higher order perturbation will result in additional corrections to this value [Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\n(color online) Ratio of coupling strength of the $\\ket{1}\\rightarrow\\ket{2}$ transition to the $\\ket{0}\\rightarrow\\ket{1}$ transition as a function of anharmonicity for control through a resonator (solid  blue) and direct drive (dashed red).\n\n## Detuning control for fixed frequency qubits\nAs a starting point for our control methods, we argue that the system can be explained by a Hamiltonian of the form displayed in Eq. (<ref>), with $\\delta(t)$, $\\Omega_x(t)$, and $\\Omega_y(t)$ are independent control parameters. We argued that $\\delta(t)$ is achieved by tuning the qubit frequency. Here, we show that it can also be achieved for fixed frequency qubits by changing the control field. In place of Eq. (<ref>), we assume that input field is of the form\n$$\n\\label{eq:controls2}\n\\begin{split}\n\\mathcal{E}(t)=&\\Omega_x(t)\\cos\\left[\\omega_d t + \\int_0^t\\delta(s)ds\\right]\\\\&+\\Omega_y(t)\\sin\\left[\\omega_d t +\\int_0^t\\delta(s)ds\\right]\n\\end{split}\n\n$$\n\nNow following the same procedure as in Sec. <ref> with $\\mathcal{E}(t)$ replaced by Eq. (<ref>) we can define a frame transformation $R(t)$\nby\n$$\n\nR(t)=\\sum_{j=1}^{d-1}\\exp\\left\\{-i j\\left[\\omega_d t+ \\int_0^t\\delta(s)ds \\right]\\right\\}\\Pi_j,\n\n$$ and by using Eq. (<ref>) we find an effective Hamiltonian of the form\n$$\n\n\\begin{split}\nH^R(t)=&\\sum_{j=1}^{d-1}(j\\delta(t)+j\\delta_0+\\Delta_j)\\Pi_j\\\\& + \\left[\\frac{\\Omega(t)}{2}e^{-i\\omega_d t-i\\int_0^t\\delta(s)ds}+\\mathrm{h.c.}\\right]\\\\&\\times\\sum_{j=1}^{d-1}\\lambda_{j-1}\\left[\\ket{j}\\bra{j-1}e^{i\\omega_d t+i\\int_0^t\\delta(s)ds}+\\mathrm{h.c.}\\right],\\end{split}\n\n$$  where $\\Omega(t) = \\Omega_x(t)+i\\Omega_y(t)$. Now provided we can make the rotating wave approximation this simplifies to Eq. (<ref>).\n\nNote Eq. (<ref>) may appear that is requires more control then is available but this is not true. Using simple trigonometric identities, this can be rewritten as\n$$\n\\label{eq:controls3}\n\\begin{split}\n\\mathcal{E}(t)=&\\Omega'_x(t)\\cos\\left[\\omega_d t \\right]+\\Omega'_y(t)\\sin\\left[\\omega_d t \\right]\n\\end{split}\n\n$$\nwhere\n$$\n\n\\Omega_x'(t) &=&\\Omega_x(t)\\cos\\left[\\int_0^t\\delta(s)ds \\right]+\\Omega_y(t)\\sin\\left[\\int_0^t\\delta(s)ds \\right]\\nonumber\\\\\\\\\n\\Omega_y'(t) &=&\\Omega_y(t)\\cos\\left[\\int_0^t\\delta(s)ds \\right]-\\Omega_x(t)\\sin\\left[\\int_0^t\\delta(s)ds \\right].\\nonumber\\\\\n\n$$ This is known as phase ramping [Unknown Author, \"Unknown Title\", ].\n\n## General leakage removal\nIn this appendix, we give the general theory for finding adiabatic pulses for controlling subsystems of a larger system. The systems that will obey this theory are those in which transitions out of the subspace occur an energy cost $\\Delta$. Furthermore, we assume this cost is the largest rate in the problem so that we  can form a perturbation expansion around $\\epsilon=1/t_g\\Delta$, where $t_g$ is the gate time. To be more specific, imagine a Hilbert space that can be partitioned into two subspaces, $\\mathcal{H} = \\mathcal{H}_{\\rm{control}}\\oplus \\mathcal{H}_{\\rm{leakage}}$, where we wish to perform some quantum gate solely in the control subspace, but with control Hamiltonians $H_m$ that act on the complete Hilbert space. That is, the general Hamiltonian for this system is\nH(t) = H_0 + \u2211_m u_m(t) H_m,\nwhere we require that $H_0$ takes the form\nH_0 = 0 \u2295\u0394\u2211_k \u0394_k/\u0394 \u03a0_k.\nHere $\\Pi_k=\\ket{k}\\bra{k}$ and we note that $H_0$ only has support on the leakage subspace.  Since, $\\Delta$ is assumed to be large then $H_0$ is the dominant term in the Hamiltonian, and the leakage subspace is off-resonant.  It is less clear what constraints must be placed on the control Hamiltonians, $H_m$.  Certainly, if we wish to perform a general gate on the control subspace, then they must be controllable on that subspace, however, in order to completely eliminate leakage errors there are additional constraints, which we now determine.\n\nThe general protocol to determine these extra constraints arising from leakage is to first determine the Hamiltonian in the control subspace that implements the desired gate. That is, find the functions $h_l(t)$ of the Hamiltonian $H_\\mathrm{sp}$\n\nH_sp = \u2211_l=1^d_c^2-1 h_l(t)B_l\nwhere $B_l$ is some orthogonal basis for operators in the control subspace of dimension $d_c$, that implement the desired gate. Next we define an effective Hamiltonian $H_\\mathrm{eff}(t)$ in the complete space by Eq. (<ref>) with the only requirement on $A$ being that $A(0) = A(t_g) = \\openone$ so that the frame transformation vanishes at the boundaries. The constraints on this effective Hamiltonian to be satisfied are\n$$\n\\label{eq:gconds}\n&&\\hspace{-5mm}\\mathrm{Tr}[ H_\\mathrm{eff}(t) B_l]=h_l(t),  \\\\\n&&\\hspace{-5mm}\\bra{j} H_\\mathrm{eff}(t)\\ket{k}=0~ \\mathrm{for}~0 \\leq j < d_c~\\mathrm{and}~d_c \\leq k < d,\\label{eq:gconds2}\n\n$$ Here Eq. (<ref>) constrains the $H_\\mathrm{eff}(t)$ to be equivalent to Eq. (<ref>) and Eq. (<ref>)  cancel the coupling between the control subspace and the leakage subspace. If theses constraints can be satisfied we have found a control set $\\{u_m(t)\\}$ that implements the desired gate with out leakage. In practice, this will not be possible but using the following procedure we can develop a perturbative approach.\n\nThe adiabatic transformation $A$ can be written as $A(t) = e^{-i S(t)}$ and we can write both $H(t)$ and the frame transformation $S(t)$ as power series in the small parameter $\\epsilon$, as\n$$\n\nH(t) = \\frac{1}{\\epsilon}H_0+\\sum_{n=0}^{\\infty} \\epsilon^n  H^{(n)}(t).\n\n$$ and\nS(t) = \u2211_n=1^\u221e S^(n)(t) \u03f5^l.\nNote the power expansion starts at $n=1$ as we restrict the transformation to be a perturbation in $\\epsilon$.\nRewriting Eq.\u00a0(<ref>) in terms of $S$, as opposed to $A$, we obtain\n$$\n\n\\begin{split}\nH_\\mathrm{eff}(t) =& \\sum_{j=0}^{\\infty} \\left( \\textrm{ad}[i S(t)] \\right)^j H(t) /j! \\\\\n&+ i \\frac{\\partial}{\\partial t} \\left(\\sum_{j=0}^\\infty  (i)^j S^j(t)/j! \\right) \\left(\\sum_{k=0}^\\infty (-i)^k S^k(t)/k! \\right),\n\\end{split}\n\n$$\nwhere $\\textrm{ad}[A]$ is the linear superoperator defined by $\\textrm{ad}[A] B = [A,B] $ and we have used a Baker-Campbell-Hausdorff (BCH) and Taylor expansion for the first and last term respectively.  From this form of $H_\\mathrm{eff}(t)$ we can isolate powers of $\\epsilon$ and arrive at\n$$\n\\label{eq:rec}\nH_\\mathrm{eff}^{(n)}(t)=H_\\mathrm{extra}^{(n)}(t)+H^{(n)}(t) + i [S^{(n+1)}(t),H_0]\n\n$$ for $n\\geq0$. Here $H_\\mathrm{extra}^{(n)}(t)$ is a rather complicated expression which for the first few orders is\n\n$$\n\\label{eq:hextra}\nH_\\mathrm{extra}^{(0)} (t)&=& 0 \\\\\nH_\\mathrm{extra}^{(1)}(t) &=&  i [S^{(1)}(t),H^{(0)}(t)]- [S^{(1)}(t),[S^{(1)}(t),H_0]]/2-\\dot{S}^{(1)}(t).\\label{eq:hextra1}\\\\\nH_\\mathrm{extra}^{(2)}(t) &=&  i [S^{(2)}(t),H^{(0)}(t)]+i [S^{(1)}(t),H^{(1)}(t)]- [S^{(1)}(t),[S^{(1)}(t),H^{(0)}(t)]]/2- [S^{(1)}(t),[S^{(2)}(t),H_0]]/2\\nonumber\\\\&&\n- [S^{(2)}(t),[S^{(1)}(t),H_0]]/2-i[{S}^{(1)}(t),[{S}^{(1)}(t),[{S}^{(1)}(t),H_0]]]/6+i[\\dot{S}^{(1)}(t),{S}^{(1)}(t)]/2-\\dot{S}^{(2)}(t).\\label{eq:hextra2}\n\\\\\nH_\\mathrm{extra}^{(3)}(t) &=&  i [S^{(3)}(t),H^{(0)}(t)]+i [S^{(2)}(t),H^{(1)}(t)]+i [S^{(1)}(t),H^{(2)}(t)]  - [S^{(1)}(t),[S^{(1)}(t),H^{(1)}(t)]]/2\\nonumber\n\\\\\n&&- [S^{(1)}(t),[S^{(2)}(t),H^{(0)}(t)]]/2- [S^{(2)}(t),[S^{(1)}(t),H^{(0)}(t)]]/2-i[S^{(1)}(t),[S^{(1)}(t),[S^{(1)}(t),H^{(0)}(t)]]/6\\nonumber\n\\\\\n&&- [S^{(1)}(t),[S^{(3)}(t),H_0]]/2- [S^{(3)}(t),[S^{(1)}(t),H_0]]/2-[S^{(2)}(t),[S^{(2)}(t),H_0]]/2\\nonumber\\\\&&-i[{S}^{(1)}(t),[{S}^{(1)}(t),[{S}^{(2)}(t),H_0]]]/6\n-i[{S}^{(2)}(t),[{S}^{(1)}(t),[{S}^{(2)}(t),H_0]]]/6-i[{S}^{(1)}(t),[{S}^{(2)}(t),[S^{(1)}(t),H_0]]]/6\\nonumber\\\\&&+[{S}^{(1)}(t),[{S}^{(1)}(t),[{S}^{(1)}(t),[S^{(1)}(t),H_0]]]/24\n+i[\\dot{S}^{(1)}(t),{S}^{(2)}(t)]/2+i[\\dot{S}^{(2)}(t),{S}^{(1)}(t)]/2\\nonumber\\\\&&-[{S}^{(1)}(t),[\\dot{S}^{(1)}(t),{S}^{(1)}(t)]/6-\\dot{S}^{(3)}(t).\\label{eq:hextra3}\n\n$$\nThis expansion bears some formal similarity to the Schrieffer-Wolf/van-Vleck/adiabatic elimination expansion [Unknown Author, \"Unknown Title\", ] which means that a compact closed expression to any order is unlikely to exist.\nThis expression for $H_\\mathrm{eff}^{(n)}(t)$ is useful as it allows us to separate the free variables $H^{(n)}(t)$ and $S^{(n+1)}(t)$ for the order $n$ expression from those that are used to satisfy the conditions in Eqs. (<ref>) and (<ref>) for order $n-1$, which only occur in the expression for $H_\\mathrm{extra}^{(n)}(t)$. To see this more clearly we can used the above to rewrite Eq. (<ref>) for each order $n$ as\n\n\u2211_m u_m^(n)Tr[H_mB_l] = h_l^(n) -Tr[H_extra^(n)(t)B_l].\nfor $0< l< d_c^2$ where  $h_l^{(n)}$ is the $n^\\mathrm{th}$ order expression for $h_l$. Furthermore Eq. (<ref>) for each order $n$ becomes\n\nS_j,k^(n+1)=i\u0394/\u0394_k  \u27e8j| [H_extra^(n)(t)+\u2211_mu_m^(n) H_m ]|k\u27e9\nfor $0 \\leq j \\leq d_c$ and $d_c \\leq k < d$.\nHere we have used that $H_0 $ has no weight in the control subspace. Since $H_\\mathrm{extra}^{(n)}$ only depends on $S_{j,k}^{(n)}$, $H_0$, and $H^{(n-1)}$ then Eqs. (<ref>) and (<ref>) are well formed.  The components of $S^{(n+1)}(t)$ that haven't yet been defined are free parameters in our theory.  Choosing a different functional form for the remaining matrix elements gives us the different forms of a DRAG solution.  It is necessary that the frame transformation vanish at $t= 0$ and $t=t_g$, which may restrict some of the freedoms we have in assigning value to the otherwise unconstrained elements of $S^{(n+1)}(t)$.  At each order of approximation, specifying the values of $H^{(n)}(t)$  and $S^{(n+1)}(t)$ fully determines $H_\\mathrm{extra}^{(n+1)}(t)$ and so we can iterate this procedure indefinitely, though at some point the derivatives of $S$ that appear in $H_\\mathrm{eff}(t)$ will likely become large, causing the adiabatic expansion to break down.\n\n10\n\nMakhlin2001\nY.\u00a0Makhlin, G.\u00a0Sch\u00f6n, and A.\u00a0Shnirman, Rev. Mod. Phys. 73, 357\n(2001).\n\nYou2003\nJ.\u00a0Q. You and F.\u00a0Nori, Phys. Rev. B 68, 064509 (2003).\n\nInsight\nJ.\u00a0Clarke and F.\u00a0Wilhelm, Nature 453, 1031 (2008).\n\nSchoelkopf2008\nR.\u00a0J. Schoelkopf and S.\u00a0M. Girvin, Nature (London) 451, 664 (2008).\n\nNakamura1999\nY.\u00a0Nakamura, Y.\u00a0A. Pashkin, and J.\u00a0S. Tsai, Nature (London) 398, 786\n(1999).\n\nSteffen2006\nM.\u00a0Steffen, M.\u00a0Ansmann, R.\u00a0C. Bialczak, N.\u00a0Katz, E.\u00a0Lucero, R.\u00a0McDermott,\nM.\u00a0Neeley, E.\u00a0M. Weig, A.\u00a0N. Cleland, and J.\u00a0M. Martinis, Science\n313, 1423 (2006).\n\nAnsmann2009\nM.\u00a0Ansmann, H.\u00a0Wang, R.\u00a0C. Bialczak, M.\u00a0Hofheinz, E.\u00a0Lucero, M.\u00a0Neeley, A.\u00a0D.\nO'Connell, D.\u00a0Sank, M.\u00a0Weides, J.\u00a0Wenner, A.\u00a0N. Cleland, and J.\u00a0M. Martinis,\nNature 461, 504 (2009).\n\nDiCarlo2009\nL.\u00a0DiCarlo, J.\u00a0M. Chow, J.\u00a0M. Gambetta, L.\u00a0S. Bishop, B.\u00a0R. Johnson, D.\u00a0I.\nSchuster, J.\u00a0Majer, A.\u00a0Blais, L.\u00a0Frunzio, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf,\nNature 460, 240 (2009).\n\nChow2010\nJ.\u00a0M. Chow, L.\u00a0DiCarlo, J.\u00a0M. Gambetta, A.\u00a0Nunnenkamp, L.\u00a0S. Bishop,\nL.\u00a0Frunzio, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev. A\n81, 062325 (2010).\n\nDiCarlo2010\nL.\u00a0DiCarlo, M.\u00a0D. Reed, L.\u00a0Sun, B.\u00a0R. Johnson, J.\u00a0M. Chow, J.\u00a0M. Gambetta,\nL.\u00a0Frunzio, S.\u00a0M. Girvin, M.\u00a0H. Devoret, and R.\u00a0J. Schoelkopf,\nNature 467, 574\u2013578 (2010).\n\nNeeley2010\nM.\u00a0Neeley, R.\u00a0C. Bialczak, M.\u00a0Lenander, E.\u00a0Lucero, M.\u00a0Mariantoni, A.\u00a0D.\nO'Connell, D.\u00a0Sank, H.\u00a0Wang, M.\u00a0Weides, J.\u00a0Wenner, Y.\u00a0Yin, T.\u00a0Yamamoto, A.\u00a0N.\nCleland, and J.\u00a0M. Martinis, Nature 467, 570\u2013573 (2010).\n\nHofheinz2009\nM.\u00a0Hofheinz, H.\u00a0Wang, M.\u00a0Ansmann, R.\u00a0C. Bialczak, E.\u00a0Lucero, M.\u00a0Neeley, A.\u00a0D.\nO'Connell, D.\u00a0Sank, J.\u00a0Wenner, J.\u00a0M. Martinis, and A.\u00a0N. Cleland, Nature\n(London) 459, 546 (2009).\n\nVion2002\nD.\u00a0Vion, A.\u00a0Aassime, A.\u00a0Cottet, P.\u00a0Joyez, H.\u00a0Pothier, C.\u00a0Urbina, D.\u00a0Esteve, and\nM.\u00a0H. Devoret, Science 296, 886 (2002).\n\nKoch2007\nJ.\u00a0Koch, T.\u00a0M. Yu, J.\u00a0Gambetta, A.\u00a0A. Houck, D.\u00a0I. Schuster, J.\u00a0Majer,\nA.\u00a0Blais, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev. A\n76, 042319 (2007).\n\nSchreier2008\nJ.\u00a0A. Schreier, A.\u00a0A. Houck, J.\u00a0Koch, D.\u00a0I. Schuster, B.\u00a0R. Johnson, J.\u00a0M.\nChow, J.\u00a0M. Gambetta, J.\u00a0Majer, L.\u00a0Frunzio, M.\u00a0H. Devoret, S.\u00a0M. Girvin, and\nR.\u00a0J. Schoelkopf, Phys. Rev. B 77, 180502 (2008).\n\nSteffen2010\nM.\u00a0Steffen, S.\u00a0Kumar, D.\u00a0P. DiVincenzo, J.\u00a0Rozen, G.\u00a0A. Keefe, M.\u00a0B. Rothwell,\nand M.\u00a0B. Ketchen, Phys. Rev. Lett. 105, 100502 (2010).\n\nMartinis2002\nJ.\u00a0M. Martinis, S.\u00a0Nam, J.\u00a0Aumentado, and C.\u00a0Urbina, Phys. Rev. Lett.\n89, 117901 (2002).\n\nSteffen2006a\nM.\u00a0Steffen, M.\u00a0Ansmann, R.\u00a0McDermott, N.\u00a0Katz, R.\u00a0C. Bialczak, E.\u00a0Lucero,\nM.\u00a0Neeley, E.\u00a0M. Weig, A.\u00a0N. Cleland, and J.\u00a0M. Martinis, Phys. Rev. Lett.\n97, 050502 (2006).\n\nMartinis09c\nJ.\u00a0Martinis, Quantum Information Processing 8, 81 (2009).\n\nHusimi53\nK.\u00a0Husimi, Prog. Theor. Phys. 9, 381 (1953).\n\nFeynman65\nR.\u00a0Feynman and A.\u00a0Hibbs, Quantum mechanics and path integrals\n(McGraw-Hill, 1965).\n\nKhani2009\nB.\u00a0Khani, J.\u00a0M. Gambetta, F.\u00a0Motzoi, and F.\u00a0K. Wilhelm, Physica Scripta\nT137, 014021 (5pp) (2009).\n\nWu02\nL.-A. Wu and D.\u00a0Lidar, J. Math. Phys. 43, 4506 (2002).\n\nManeshi08\nS.\u00a0Maneshi, J.\u00a0Kanem, C.\u00a0Zhuang, M.\u00a0Partlow, and A.\u00a0Steinberg, Phys. Rev. A\n77, 022303 (2008).\n\nPetta05\nJ.\u00a0Petta, A.\u00a0Johnson, J.\u00a0Taylor, E.\u00a0Laird, A.\u00a0Yacobi, M.\u00a0Lukin, C.\u00a0Marcus,\nM.\u00a0Hanson, and A.\u00a0Gossard, Science 309 (2005).\n\nHaeffner08\nH.\u00a0Haeffner, C.\u00a0Roos, and R.\u00a0Blatt, Phys. Rep. 469, 155 (2008).\n\nUrban09\nE.\u00a0Urban, T.\u00a0Johnson, T.\u00a0Henage, L.\u00a0Isenhower, D.\u00a0Yavuz, T.\u00a0Walker, and\nM.\u00a0Saffman, Nat. Phys. 5, 110 (2009).\n\nGaetan09\nA.\u00a0Ga\u00ebtan, Y.\u00a0Mirosnychenko, T.\u00a0Wilk, A.\u00a0Chotia, M.\u00a0Viteau, D.\u00a0Comparat,\nP.\u00a0Pillet, A.\u00a0Browaeys, and P.\u00a0Grangier, Nat. Phys. 5, 115 (2009).\n\nHaroche2006\nS.\u00a0Haroche and J.-M. Raimond, Exploring the quantum: atoms, cavities and\nphotons (Oxford University Press, Oxford, 2006).\n\nMotzoi2009\nF.\u00a0Motzoi, J.\u00a0M. Gambetta, P.\u00a0Rebentrost, and F.\u00a0K. Wilhelm, Phys. Rev. Lett.\n103, 110501 (2009).\n\nPoudel10\nA.\u00a0Poudel and M.\u00a0Vavilov, Effect of Ohmic environment on optimally\ncontrolled flux-biased phase qubit, Phys. Rev. B 82, 144528 (2010).\n\nChow2010a\nJ.\u00a0M. Chow, L.\u00a0DiCarlo, J.\u00a0M. Gambetta, F.\u00a0Motzoi, L.\u00a0Frunzio, S.\u00a0M. Girvin,\nand R.\u00a0J. Schoelkopf, Phys. Rev. A 82, 040305(R) (2010).\n\nLucero2010\nE.\u00a0Lucero, J.\u00a0Kelly, R.\u00a0C. Bialczak, M.\u00a0Lenander, M.\u00a0Mariantoni, M.\u00a0Neeley,\nA.\u00a0O'Connell, D.\u00a0Sank, H.\u00a0Wang, M.\u00a0Weides, J.\u00a0Wenner, T.\u00a0Yamamoto,\nA.\u00a0Cleland, and J.\u00a0Martinis, Phys. Rev. A 82, 042339 (2010) .\n\nKozinsky07\nJ.\u00a0M. Martinis, K.\u00a0B. Cooper, R.\u00a0McDermott, M.\u00a0Steffen, M.\u00a0Ansmann, K.\u00a0D.\nOsborn, K.\u00a0Cicak, S.\u00a0Oh, D.\u00a0P. Pappas, R.\u00a0W. Simmonds, and C.\u00a0C. Yu, Phys.\nRev. Lett. 95, 210503 (2005).\n\nSteffen2003\nM.\u00a0Steffen, J.\u00a0M. Martinis, and I.\u00a0L. Chuang, Phys. Rev. B 68, 224518\n(2003).\n\nChow2009\nJ.\u00a0M. Chow, J.\u00a0M. Gambetta, L.\u00a0Tornberg, J.\u00a0Koch, L.\u00a0S. Bishop, A.\u00a0A. Houck,\nB.\u00a0R. Johnson, L.\u00a0Frunzio, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev.\nLett. 102, 090502 (2009).\n\nLucero2008\nE.\u00a0Lucero, M.\u00a0Hofheinz, M.\u00a0Ansmann, R.\u00a0C. Bialczak, N.\u00a0Katz, M.\u00a0Neeley, A.\u00a0D.\nO'Connell, H.\u00a0Wang, A.\u00a0N. Cleland, and J.\u00a0M. Martinis, Phys. Rev. Lett.\n100, 247001 (2008).\n\nBauer1984\nC.\u00a0Bauer, R.\u00a0Freeman, T.\u00a0Frenkiel, J.\u00a0Keeler, and A.\u00a0J. Shaka, J. Magn. Reson.\n58, 442 (1984).\n\nBowdrey2002\nM.\u00a0D. Bowdrey, D.\u00a0K.\u00a0L. Oi, A.\u00a0J. Short, K.\u00a0Banaszek, and J.\u00a0A. Jones, Phys.\nLett. A 294, 258 (2002).\n\nNeeley2009\nM.\u00a0Neeley, M.\u00a0Ansmann, R.\u00a0C. Bialczak, M.\u00a0Hofheinz, E.\u00a0Lucero, A.\u00a0D. O'Connell,\nD.\u00a0Sank, H.\u00a0Wang, J.\u00a0Wenner, A.\u00a0N. Cleland, M.\u00a0R. Geller, and J.\u00a0M. Martinis,\nScience 325, 722 (2009).\n\nBianchetti2010\nR.\u00a0Bianchetti, S.Filipp, M.\u00a0Baur, J.\u00a0M. Fink, C.\u00a0Lang, L.\u00a0Steffen,\nM.\u00a0Boissonneault, A.\u00a0Blais, and A.\u00a0Wallraff, Phys. Rev. Lett. 105, 223601 (2010).\n\nMiller2005\nR.\u00a0Miller, T.\u00a0E. Northup, K.\u00a0M. Birnbaum, A.\u00a0Boca, A.\u00a0D. Boozer, and H.\u00a0J.\nKimble, J. Phys. B 38,  (2005).\n\nBlais2004\nA.\u00a0Blais, R.-S. Huang, A.\u00a0Wallraff, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys.\nRev. A 69, 062320 (2004).\n\nWallraff2004\nA.\u00a0Wallraff, D.\u00a0I. Schuster, A.\u00a0Blais, L.\u00a0Frunzio, R.-S. Huang, J.\u00a0Majer,\nS.\u00a0Kumar, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Nature (London) 431,\n162 (2004).\n\nLeek2009a\nP.\u00a0J. Leek, S.\u00a0Filipp, P.\u00a0Maurer, M.\u00a0Baur, R.\u00a0Bianchetti, J.\u00a0M. Fink,\nM.\u00a0G\u00f6ppl, L.\u00a0Steffen, and A.\u00a0Wallraff, Phys. Rev. B 79, 180511\n(2009).\n\nJaynes1963\nE.\u00a0T. Jaynes and F.\u00a0W. Cummings, Proc. IEEE 51, 89 (1963).\n\nGambetta2006\nJ.\u00a0Gambetta, A.\u00a0Blais, D.\u00a0I. Schuster, A.\u00a0Wallraff, L.\u00a0Frunzio, J.\u00a0Majer, M.\u00a0H.\nDevoret, S.\u00a0M. Girvin, and R.\u00a0J. Schoelkopf, Phys. Rev. A 74, 042318\n(2006).\n\nBoissonneault2009\nM.\u00a0Boissonneault, J.\u00a0M. Gambetta, and A.\u00a0Blais, Phys. Rev. A 79,\n013819 (2009).\n\nPatt1992\nS.\u00a0L. Patt, J. Magn. Reson. 96, 94 (1992).\n\nShavitt80\nI.\u00a0Shavitt and L.\u00a0Redmon, J. Chem. Phys. 73, 5711 (1980).\n\n"}
{"prompt": "Please summarize the paper titled 'Laser-annealing Josephson junctions for yielding scaled-up superconducting quantum processors.'.", "completion": "\n\n# Laser-annealing Josephson junctions for yielding scaled-up superconducting quantum processors.\n\nIBM Quantum, IBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nAs superconducting quantum circuits scale to larger sizes, the problem of frequency crowding proves a formidable task. Here we present a solution for this problem in fixed-frequency qubit architectures. By systematically adjusting qubit frequencies post-fabrication, we show a nearly ten-fold improvement in the precision of setting qubit frequencies. To assess scalability, we identify the types of `frequency collisions' that will impair a transmon qubit and cross-resonance gate architecture. Using statistical modeling, we compute the probability of evading all such conditions, as a function of qubit frequency precision. We find that without post-fabrication tuning, the probability of finding a workable lattice quickly approaches 0. However with the demonstrated precisions it is possible to find collision-free lattices with favorable yield. These techniques and models are currently employed in available quantum systems and will be indispensable as systems continue to scale to larger sizes.\n\n## Introduction\nRealizing robust large-scale quantum information processors  is one of the foremost challenges in quantum science. Many practical applications have been proposed for robust quantum computers, including estimating the ground state energy of chemical compounds and implementing machine learning algorithms [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Quantum advantage relative to classical computers can be realized without full fault-tolerance, but requires large quantum circuits that a classical computer cannot simulate [Unknown Author, \"Unknown Title\", ]. Recent demonstrations have shown qubit circuits nearly at the threshold for demonstrating quantum advantage [Unknown Author, \"Unknown Title\", ]. Much work remains in order to realize fault-tolerant quantum processors; however,  scale-up of solid-state quantum circuits has shown consistent and ongoing progress [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. As the qubit circuits are scaled up, they must maintain high one- and two-qubit gate fidelities, high qubit connectivity, and low cross-talk error which can be measured in a holistic sense via the quantum volume of the circuit [Unknown Author, \"Unknown Title\", ]. Lattices of fixed-frequency transmon qubits represent a promising architecture for building systems of larger sizes [Unknown Author, \"Unknown Title\", ]. A growing number of systems at the 20 to 50-qubit scale are now available to users through cloud access. A variety of technical challenges confront further system scaling, including improving 3-dimensional circuit integration and qubit coherence. High on the list of such challenges is the issue of `frequency crowding.'\n\nFixed frequency transmon qubits using the two-qubit cross-resonance (CR) gate form a promising architecture for scaling up quantum systems. Fixed-frequency transmons are largely insensitive to charge or flux noise, and have achieved coherence times of 100 $\\mu$s and growing. The CR gate, a hardware-efficient all-microwave gate [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], is readily used to entangle these qubits with gate fidelities above 99\n\nMaintaining high gate fidelities for all pairs in a lattice will require solving this `frequency crowding' problem by precise setting of qubit frequencies to specified values, as characterized by a standard deviation $\\sigma_f$. To achieve low $\\sigma_f$, the tunnel-junction conductance must be controlled with high precision. Transmon frequency $f_{01}$ follows $h f_{01} \\simeq \\sqrt{8 E_J E_C} - E_C$, where Josephson energy $E_J = \\frac{\\hbar I_c}{2 e}$ is many times greater than charging energy $E_C = \\frac{e^2}{2 C}$ [Unknown Author, \"Unknown Title\", ]. In typical transmons, a photolithographically defined capacitance $C$ has dimensions in the tens to hundreds of microns and varies little from qubit to qubit. The critical current $I_c$ is set by a tunnel barrier of area $\\sim$ 100 $\\times$ 100 nm and thickness a few nm, and is thus challenging to fabricate with precision better than a few percent [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, tunnel barrier resistance $R_n$ is readily measurable to precision better than 0.1\n\nCareful design of lattices can enable error correction codes while at the same time minimizing the likelihood of `frequency collisions' and therefore the required $\\sigma_f$ for fabrication yield [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Yet even the most robust designs require a fractional $\\sigma_f$  of 0.25\n\nIn this paper, we introduce an adaptive post-fabrication trimming technique that we use to incrementally adjust $R_n$ on a qubit-by-qubit basis, thereby overcoming inherent variability in both initial qubit fabrication and the laser anneal. For the first time, an improvement in qubit frequency precision is demonstrated in terms of narrowed frequency distributions. Crucially, we demonstrate qubit frequency imprecision $\\sigma_f$ of the same magnitude as the imprecision of predicting $f_{01}$ from $R_n$. To estimate the scalability of this technique for the fabrication of error-corrected lattices, we employ a statistical yield model based on $\\sigma_f$ relative to specific collision bounds. This model predicts the severity of the frequency crowding problem for different topologies and scales of error corrected multi-qubit lattices as a function of code distance. The model demonstrates that using conventional transmon fabrication, scaled-up qubit lattices will fail to evade `frequency collisions'. However, our novel trimming technique achieves adequate $\\sigma_f$ for scalable fabrication of distance-3 through distance-7 heavy-square and heavy-hexagon codes. In particular, this technique enables the high yield fabrication of the distance-3 and distance-5 heavy-hexagon lattices currently deployed as IBM cloud connected systems [Unknown Author, \"Unknown Title\", ].\n\n## Results\nFrequency Precision $\\sigma_f$ From Transmon Fabrication\n\nTo assess the $\\sigma_f$ resulting from qubit fabrication, we developed a test vehicle containing a large number of identically-fabricated qubits (<ref>). We cooled the chip in a dilution refrigerator and used dispersive readout through half-wave microwave resonators to measure qubit frequencies [Unknown Author, \"Unknown Title\", ]. We measured the frequencies of 31 qubits to a precision better than 100 kHz using a Ramsey fringe method. The qubit frequencies had random variation $\\sigma_f = 132.3$ MHz (<ref>), or 2.3\n\n< g r a p h i c s >\n\n(a) Chip type used to assess $\\sigma_f$. False-colored image. 36 fixed-frequency transmon qubits, each including a 500 $\\times$ 320 micron planar capacitor and a $\\sim 0.1 \\times 0.1$ micron Al/AlOx/Al tunnel junction, are prepared identically on a 20 $\\times$ 10 mm Si substrate. A half-wavelength coplanar waveguide resonator at each qubit enables dispersive readout. Resonators are frequency-multiplexed in groups of 12. (b) Transmon frequency vs $R_n$. Power law fit of pre-tuned population. Inset histogram (10 MHz bins) shows residual scatter in frequency relative to fit line. (c) Distributions of qubit frequencies. Initial median was 5.7025 GHz and spread $\\sigma_f = 132.3$ MHz (red histogram, 70 MHz bins). Using selective laser-anneal (figure (Figure fig:LaserTuneSchematic)) we prepared these qubits into two distinct frequency populations with medians 5.430 and 5.7046 GHz. (Black histograms, 10 MHz bins) Each population is outlined by a gaussian curve centered at its local median frequency. Combined spread is $\\sigma_f = 14.0$ MHz.\n\n### Tuning Using Selective Laser Anneal\n< g r a p h i c s >\n\n(a) Schematic of apparatus, \u201cLaser Annealing of Stochastically Impaired Qubits\u201d (LASIQ). A 532 nm (frequency doubled) diode-pumped solid-state laser is used as the laser annealing source. Active power calibration is accomplished via a half-wave plate and PBS combination, with feedback from a Si-PD. A piezoelectric mirror mount actively aligns the beam to the junction center via image pattern recognition . The beam is shaped as necessary to avoid direct illumination of the junction, and beam size is condensed $4\\times$ using a dual-objective setup [Unknown Author, \"Unknown Title\", ]. (b) Iterative anneal demonstration. Adaptive anneal progression towards $R_n$ targets in 20 tunnel junctions. Greater fractional tuning requires greater anneal powers and anneal numbers. Abbreviations: SHG: second harmonic generation, PBS: polarizing beam splitter, Si-PD: silicon photodiode, AM: alignment mirror, BS: beam shaper, TEC: thermoelectric cooler.\n\nTo reduce $\\sigma_f$, we developed a technique for selective laser anneal to shift tunnel resistance $R_n$ by pre-calibrated increments. (See <ref> and <ref>). We demonstrate the achievable frequency control of this technique by shifting the 31 measured qubits into a two-frequency pattern. We employed an $R_n$ vs $f$ correlation (<ref>) to designate the target resistances. We shifted 16 junctions to one target $R_n$ and 15 to another target $R_n$. After tuning, the group of 16 junctions had median resistance 7.984 k$\\Omega$ and the group of 15 had median resistance 8.798 k$\\Omega$. The 31 junctions reached their targets with an overall precision of $\\sigma_R = 51 \\Omega$, about 0.61\n\n## Discussion\nOur post-fabrication trimming reduced $\\sigma_f$ by 9.5$\\times$ compared to initial fabrication. To assess whether this level of precision is sufficient to reliably prepare lattices of fixed-frequency transmons capable of error-correcting codes, we must quantify the frequency-crowding problem. Transmon qubits are weakly anharmonic and have decreasing transition energies at higher levels. Therefore, degeneracies among the $\\ket{0} \\rightarrow \\ket{1}$, $\\ket{1} \\rightarrow \\ket{2}$ and $\\ket{0} \\rightarrow \\ket{2}$ transitions of nearby qubits can all contribute to `frequency collisions.' We must consider the relative frequencies of both nearest-neighbors and next-nearest-neighbors in the lattice [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Fig (Figure fig:lattices_and_freqs) illustrates the relative positions of nearest-neighbor and next-nearest-neighbor qubits in a section of lattice, and <ref> lists the seven cases most likely to lead to gate errors [Unknown Author, \"Unknown Title\", ]. We can think of them qualitatively as follows: Type 1 causes hybridization of states in $Q_j$ and $Q_k$, while in type 2 the CR pulse excites $Q_j$ into the non-computational $\\ket{2}$ state. Type 3 excites $Q_k$ to the $\\ket{2}$ state, but does not require a CR tone. In condition 4, $ZX$ is weak, which implies long gate times and increased gate error [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In type 5, the CR gate addresses an additional neighboring qubit. In type 6, when one qubit is the target of a CR gate, its next-nearest-neighbor leaks to the $\\ket{2}$ state. Type 7 causes $Q_j$ to leak to the $\\ket{2}$ state during a CR gate.\n\nType     Definition     Participants     Bounds\n[0.5ex]\n1     $f_{j,01} = f_{k,01}$     Nearest-neighbor qubits $Q_j$, $Q_k$     $\\pm$ 17 MHz\n\n2     $f_{j,02} = 2f_{k,01}$     Control qubit $Q_j$, target qubit $Q_k$     $\\pm$ 4 MHz\n\n3     $f_{j,01} = f_{k,12}$     Nearest-neighbor qubits $Q_j$, $Q_k$     $\\pm$ 30 MHz\n\n4     $f_{k,01} < f_{j,12}$ or $f_{j,01} < f_{k,01}$      Control qubit $Q_j$, target qubit $Q_k$     \u2014\n\n5     $f_{i,01} = f_{k,01}$     $Q_j$ is control to $Q_i$ and/or $Q_k$ & is nearest-neighbor to both.     $\\pm$ 17 MHz\n\n6     $f_{i,01} = f_{k,12}$ or $f_{i,12} = f_{k,01}$     $Q_j$ is control to $Q_i$ and/or $Q_k$ & is nearest-neighbor to both.     $\\pm$ 25 MHz\n\n7     $f_{j,02} = f_{k,01} + f_{i,01}$     $Q_j$ is control to $Q_i$ and/or $Q_k$ & is nearest-neighbor to both.     $\\pm$ 17 MHz\n\nSeven most likely types of `frequency collision'. For bus-coupled transmon qubits employing cross-resonance gates and having anharmonicity $\\sim - 330$ MHz. Relative qubit positions illustrated in inset of <ref>. Bounds for types 1,2,3 are estimated from model results [Unknown Author, \"Unknown Title\", ] as the region where gate errors due to `frequency collision' exceed $\\sim$ 1\n\nAround each of the `frequency collisions' described in  <ref>, we can designate a window of undesired frequencies. This breaks the frequency space into allowed and forbidden regions. Type 4 listed in <ref> defines forbidden zones where $ZX$ coupling is too low. For the other six conditions, we forbid regions where the `frequency collision' is the dominant source of gate error. Existing multi-qubit systems with CR gates typically exhibit two-qubit gate errors of 1 to 2\n\nA useful lattice of qubits should enable high quantum volume and fault-tolerant operation while avoiding all of the `frequency collisions' and forbidden regions presented in <ref>. Both lattice layout and the pattern of qubit frequencies are relevant. We consider three types of lattices: square, `heavy-square' and `heavy-hexagon' (<ref>). Lattices comprise qubits and two-qubit connections, each qubit being linked to no more than four neighbors. In many practical implementations, these links comprise microwave-resonant buses. A square lattice facilitates `surface code' fault-tolerant codes [Unknown Author, \"Unknown Title\", ]. Recent literature describes hybrids of the surface code with Bacon-Shor type codes, which can be employed in `heavy hexagon' and `heavy square' lattices to achieve fault-tolerance, albeit with lower error thresholds than the surface code [Unknown Author, \"Unknown Title\", ]. In addition to the data and ancilla qubit roles employed in the surface code, these hybrid codes assign a portion of the lattice as `flag' qubits.\n\nIn the square lattice, every qubit in the bulk of the lattice lies on a degree-four vertex, while some at edges have degree two or degree three. If we populate the square lattice with 5 distinct frequencies of qubits, $f_5 > f_4 > f_3 > f_2 > f_1$, with appropriate spacing between the frequencies, we can avoid all the forbidden regions of  <ref> [Unknown Author, \"Unknown Title\", ]. In <ref>, we illustrate this pattern for square lattices capable of distance-5 ($d = 5$) rotated surface codes. Condition 4 of <ref> requires $f_{control} > f_{target}$, so the pattern also fixes the direction of CNOT gate for each pair.\n\nIn contrast to the square lattice, the `heavy square' lattice includes both degree-two and degree-four vertices in the bulk. Degree-one, -two or -three vertices appear at the edges. We take advantage of this pattern to make all the degree-two vertices control qubits, using a three-frequency pattern $f_3 > f_2 > f_1$. Since every control qubit (frequency $f_3$) is linked to at most two target qubits, we need only two properly-chosen target-qubit frequencies ($f_1$ and $f_2$) to satisfy conditions 5, 6 and 7 of <ref>, as shown in <ref>. A third type of lattice, the `heavy hexagon', uses a similar scheme. Here the bulk of the lattice includes degree-three and degree-two vertices. Additional degree-two and degree-one vertices lie at the edges. In this lattice, all of the `frequency collisions' and forbidden regions can be satisfied using only three frequencies $f_3 > f_2 > f_1$, with all control qubits residing on degree-two vertices with frequency $f_3$.\n\n< g r a p h i c s >\n\nLattice and frequency-pattern examples. Lattices are capable of $d=5$ codes. Patterns of qubit frequencies avoid all conditions in <ref>. Statistical model is applied to these examples and to equivalent lattices at $d = 3$ and $d = 7$. (See Supplementary Figures 1-9.) Square lattice includes 49 qubits in 5-frequency pattern. Heavy-square lattice includes 73 qubits in 3-frequency pattern. Heavy-hexagon lattice includes 65 qubits in 3-frequency pattern. In a portion of the heavy-hexagon lattice, we indicate qubits' intended gate roles: control (black circles) or target (white circles); as well as code roles: data (D), ancilla (A) or flag (F) [Unknown Author, \"Unknown Title\", ]. Inset shows relative positions of qubits for collision definitions of <ref>. $Q_j$ is coupled to nearest-neighbors $Q_i$ and to $Q_k$. Qubits $Q_i$ and $Q_k$ are next-nearest-neighbors.\n\n< g r a p h i c s >\n\nFrequency-crowding trends as a function of $\\sigma_f$. Results of Monte Carlo simulation. (See <ref>.) (a) Average number of collisions. and (b) Fraction of cases having zero `frequency collisions'. Simulation was applied to the lattices and frequency patterns shown in <ref>, capable of distance-5 codes, as well as to $d = 3$ and $d = 7$ scale lattices of square, heavy-square or heavy-hexagon type. (See Supplementary Figures 1-9 for lattice layouts and <ref> for numbers of qubits.) Color-coded dotted lines in part (b) are fits of each lattice yield to expression $\\left[ \\int_{-\\infty}^{(\\Delta f / \\sigma_f)} e^{-\\frac{1}{2} x^2} dx \\right]^N$, where $N$ is the number of qubits and $\\pm \\Delta f$ defines an allowable `window' around frequency set-points. (See <ref>.) Using this expression, two solid red lines predict yield for the heavy-hexagon lattice type at 300 and 1000 qubits, using $\\Delta f = $ 27.99 and 26.32 MHz, respectively. See <ref> for estimation of $\\Delta f$ as a function of qubit number.\n\nWe use a Monte Carlo model to quantify the frequency-crowding in each lattice type. We sample the qubits at random frequencies drawn from normal distributions characterized by $\\sigma_f$, and count the collisions defined in <ref>. (See <ref>.) In <ref>, we show the mean number of `frequency collisions' predicted by the Monte Carlo model for each lattice type and frequency pattern, as a function of $\\sigma_f$. As $\\sigma_f \\rightarrow 0$, the lattice approaches the ideal patterns of  <ref>, and has zero `frequency collisions'. As $\\sigma_f$ increases, the number of  `frequency collisions' rises steadily. As $\\sigma_f \\rightarrow f_{01} - f_{12}$, the different conditions appearing in <ref> all become likely, and a limiting number of `frequency collisions' is reached. Yield follows the inverse trend, as seen in <ref>. As $\\sigma_f$ increases, the likelihood of finding a `collision free' chip falls off sharply. While the step sizes between frequencies $f_1$ to $f_5$ are important, absolute frequency values are not. Setting $f_1= 5.0$, $f_2 = 5.07$ and $f_3 = 5.14$ GHz works as well as $f_1= 5.05$, $f_2 = 5.12$ and $f_3 = 5.19$ GHz.\n\nThe yield and mean collision number are a function of the several different collision types and bounds, so they are not readily susceptible to an analytic formulation. However, we can propose a simplified model for yield: in order for a lattice to be collision-free, every qubit in the lattice must fall within some frequency `window' $\\pm \\Delta f$ relative to its setpoint. Presuming the qubit frequencies are normally distributed, the probablity of this occurring goes as the cumulative distribution function, raised to the power $N$, where $N$ is the number of qubits: $\\left[ \\int_{-\\infty}^{(\\Delta f / \\sigma_f)} e^{-\\frac{1}{2} x^2} dx \\right]^N$. In the yield plot in <ref>, we fit this expression to find $\\Delta f$ for each lattice.\n\nThese model results allow us to predict how different lattice types and frequency patterns will respond to fabrication imprecision. As shown in <ref>, if imprecision $\\sigma_f$ is greater than 30 MHz, any $d = 5$ lattice will exhibit $>10$ `frequency collisions' of one or another of the types listed in <ref>, causing the affected gates to have error rates above $\\sim$ 1\n\nThe as-fabricated $\\sigma_f$ seen in <ref> is 132.3 MHz. (See <ref>) The Monte Carlo modeling finds that for a heavy-hexagon lattice at $d=3$ scale this $\\sigma_f$ can enable 0.1\n\nAs seen from the Monte Carlo analysis, the laser-anneal rework method can scale to the $>$ 100 qubit size, enabling a well-chosen lattice and frequency pattern to implement $d = 7$ error-correction codes free of frequency-crowding. To examine needs for the next generation of chips up to the 1000-qubit level, we can coarsely estimate requirements by extrapolating the fixed window model for the heavy-hexagon lattice as shown in <ref>. While the $\\sigma_f$ = 14.0 MHz demonstrated here enables practical yield up to the 100 to 200 qubit scale, it is clear that roughly a factor of two further improvement is needed to scale towards 1000 qubits. Since this precision is also better than the resistance-to-frequency prediction precision shown in this work, development of further refinements in tuning and frequency prediction approaches will be necessary as the scale of fixed-frequency transmon circuits surpass the 100 qubit milestone.\n\n< g r a p h i c s >\n\nYield scaling for heavy hexagon lattice. Fixed window size model. (left axis) Model yields for $\\sigma_f$ ranging from the 14 MHz demonstrated in this work to 6 MHz that would optimize future scaling yield beyond the 1000Q level. (right axis) Fixed window size fits to the d=3, d=5 and d=7 heavy hexagon lattice, as well as a fit of these values to expression $A + B \\cdot \\log(N_{QB}) $, extrapolated from 20 to 1000 qubits. This trend illustrates varying frequency crowding constraints as a function of lattice size.\n\n2c||$\\sigma_f = 132.3$ MHz \t    2c||$\\sigma_f = 14$ MHz\n\n4-7\nLattice & \t    Code \t    Qubits\t    Mean \t\t    Yield of \t\t    Mean \t\t    Yield of \t\t\t    $\\Delta f$\n\nfrequency \t    distance\t    \t \t    number\tof\t    collision-\t    number\tof\t    collision-\t\t    Window\n\npattern \t\t   \t \t     \t\t    collisions \t    free devices\t    collisions \t    free devices \t\t    (MHz)\n\nSquare, \t    $d = 3$     17 \t\t    9 \t\t\t     $\\ll 0.1\\%$ \t    3\t\t\t    6\n5-frequency \t    $d = 5$     49 \t\t    35 \t\t\t    $\\ll 0.1\\%$ \t    10 \t\t\t    $<0.1\\%$ \t\t   13.23\n\n$d = 7$     97 \t\t    78\t\t    $\\ll 0.1\\%$ \t    23\t\t\t    $\\ll 0.1\\%$ \t\t   12.12\n\nHeavy \t\t    $d = 3$     25 \t\t    10 \t\t    $\\ll 0.1\\%$ \t\t    0.4\t\t    67\nsquare, 3-\t    $d = 5$     73 \t\t    33\t\t    $\\ll 0.1\\%$ \t\t    1.5\t\t    27\nfrequency \t    $d = 7$     145 \t    70 \t\t    $\\ll 0.1\\%$ \t\t    3.5\t\t    6\nHeavy \t\t    $d = 3$     23 \t\t    8 \t\t    $0.1\\%$ \t\t    0.4\t\t\t    70\nhexagon, \t    $d = 5$     65 \t\t    25 \t\t    $\\ll 0.1\\%$ \t\t    1.2\t\t    33\n3-frequency \t    $d = 7$     127 \t    51\t \t    $\\ll 0.1\\%$ \t\t    2.7\t\t    8\n\nMonte-Carlo model predictions of mean number of collisions and yield of collision-free chips. Full results of Monte-Carlo model of frequency-crowding appear in <ref>. Here we show values for as-fabricated precision $\\sigma_f = 132.3$ MHz, and for demonstrated frequency precision of the laser-anneal method, $\\sigma_f = 14$ MHz. (<ref>) in different lattices and frequency patterns (<ref> and Supplementary Figures 1-9). The $\\Delta f$ values correspond to the fit lines in <ref>: in order for the device to be collision-free, every qubit in the lattice must fall within $\\pm$ this `window', relative to its set-point.\n\n## Methods\nnaturemag\n\nACKNOWLEDGEMENTS\n\nWe acknowledge funding from the Intelligence Advanced Research Projects Activity (IARPA) under contract W911NF-16-1-0114, for the multi-qubit test vehicle and frequency-vs-resistance correlation studies. We thank N. Bronn, M. Carroll, C. Chamberland, A. Cross, J. Gambetta, J. Ku, M. Malekakhlagh, D. McKay, B. Plourde, E. Pritchett, A. Rosenbluth, M. Takita, J. Timmerwilke and G. Zhu for helpful discussions. We thank E. Porter for coding assistance, Y. Martin and R. Haight for assistance in constructing the laser optics, and R. Patel for photomicroscopy.\n\n"}
{"prompt": "Please summarize the paper titled 'Effective Hamiltonian models of the cross-resonance gate'.", "completion": "\n\n# Effective Hamiltonian models of the cross-resonance gate\n\nEffective Hamiltonian methods are utilized to model the two-qubit cross-resonance gate for both the ideal two-qubit case and when higher levels are included. Analytic expressions are obtained in the qubit case and the higher-level model is solved both perturbatively and numerically with the solutions agreeing well in the weak drive limit. The methods are applied to parameters from recent experiments and accounting for classical cross-talk effects results in good agreement between theory and experimental results.\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\n## Introduction\nImplementing high-fidelity quantum operations is a central problem in the field of experimental quantum information processing (QIP). Building a universal fault-tolerant quantum computer requires the ability to perform a high-fidelity two quantum-bit (qubit) entangling gate and, while many proposals have been put forth for implementing two-qubit gates, few experimental demonstrations have achieved fidelities near those determined by fault-tolerant analyses\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The cross-resonance (CR) gate\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has recently been utilized in superconducting circuit systems\u00a0[Unknown Author, \"Unknown Title\", ] to achieve a two-qubit CNOT gate with high fidelity exceeding 0.99\u00a0[Unknown Author, \"Unknown Title\", ] and has been used in small-scale multi-qubit demonstrations of fault-tolerant protocols\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Here we provide a theoretical analysis of the CR gate and outline effective Hamiltonian methods that can be used to obtain a description of the gate dynamics. The techniques developed are directly applicable in realistic systems as shown by the improved experimental calibration and high two-qubit gate fidelity of Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nBroadly speaking, the goal of effective Hamiltonian theory is to model some set of complex dynamics on a large system via a more compact Hamiltonian on a set of smaller subsystems or subspaces. Effective Hamiltonian methods have been utilized in various areas of physics and chemistry including nuclear, atomic-molecular, optical, and condensed matter systems. In particular, techniques for the adiabatic elimination of higher energy levels in a system have been widely studied, common examples including the Schrieffer-Wolff transformation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and Born-Oppenheimer approximation\u00a0[Unknown Author, \"Unknown Title\", ]. Here we restrict attention to effective Hamiltonian constructions based on unitary (canonical) operations that transform the Hamiltonian $H$ on the full Hilbert space $\\mathcal{H}$ into a block-diagonal Hamiltonian $\\Heff$ with the two-block case corresponding to the standard Schrieffer-Wolff transformation.\n\nWe outline the perturbative construction of an effective Hamiltonian where the desired block-diagonal form is enforced at each order. The advantage of the perturbative construction lies in obtaining analytical expressions for components of $\\Heff$ that hold in the weak perturbation limit. The second construction is based on an exact multi-block-diagonalization technique\u00a0[Unknown Author, \"Unknown Title\", ] which finds the block-diagonal Hamiltonian that is closest to the true Hamiltonian under the principle of least action. This method has the advantage of being valid in the strong drive regime however it is not possible to compute general analytic expressions for the Hamiltonian components except in simple cases such as the basic two-qubit model. These methods are applied to obtain an effective model for the CR gate Hamiltonian in the two-qubit model as well as when higher levels are included. As a concrete example we use the parameters of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] and find good agreement between the perturbative and exact multi-block diagonalization approaches in the weak-drive limit with higher levels included. However a discrepancy is found between the theory and experiment since Ref.\u00a0[Unknown Author, \"Unknown Title\", ] finds the presence of extra unwanted terms in the Hamiltonian. We propose classical cross-talk between the two transmons from the CR drive as a potential source for this discrepancy and extend the analysis to include this effect. After doing so we find very good agreement between the theoretical predictions and experimental results of Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe paper is structured as follows. First in Sec.\u00a0<ref> we describe the starting Hamiltonian for the analysis which consists of two transmons dispersively coupled to a resonator. We outline a method to find an effective block-diagonal Hamiltonian for the two transmon-resonator system which when projected onto the zero-excitation subspace of the resonator provides an effective Hamiltonian for the two transmon system alone. Next in Sec.\u00a0<ref> we model the transmons as ideal qubits and find an analytic expression for the effective CR Hamiltonian under the principle of least action. In Sec.\u00a0<ref> we model the transmons as Duffing oscillators and find perturbative expressions that hold in the weak-drive limit. We also perform a numerical analysis of the exact block-diagonalization technique using the parameters of Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. In Sec.\u00a0<ref> we analyze classical cross-talk occurring from the CR drive to model the results of Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. For clarity of the presentation the mathematical methods and details of effective Hamiltonian theory are contained in the appendix (Sec.\u00a0<ref>) with the main text focused mainly on discussion of the application of the methods to the CR gate.\n\n## Initial Hamiltonian and effective two-transmon Hamiltonian\nWe start with a Hamiltonian describing the standard cQED\u00a0[Unknown Author, \"Unknown Title\", ] set-up of two transmons\u00a0[Unknown Author, \"Unknown Title\", ], modeled as Duffing oscillators, coupled to a bus resonator\n$$\n\nH_\\text{sys}=\\sum_{j=1}^2\\left(\\bar{\\omega}_jb_j^{\\dagger}b_j + \\frac{\\delta_1}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-\\openone)\\right) + \\omega_r c^\\dagger c \\nonumber \\\\\n+ \\sum_{j=1}^2g_j(b_j^\\dagger c + b_jc^{\\dagger}),\n\n$$\nwhere we set $\\hbar = 1$. Here $\\bar{\\omega}_jb_j^{\\dagger}b_j + \\frac{\\delta_j}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-\\openone)$ is the Duffing Hamiltonian of the $j$'th transmon ($j=1,2$) with $\\bar{\\omega}_j$ and $\\delta_j$ being the $01$ transition frequency and anharmonicity of the $j$'th transmon respectively. The resonator Hamiltonian $\\omega_r c^\\dagger c$ is a single-mode harmonic oscillator with fundamental frequency $\\omega_r \\gg \\bar{\\omega}_{1(2)}$. Each transmon is coupled to the resonator by a Jaynes-Cummings Hamiltonian with coupling strength $g_j$ and since we are in the dispersive regime,\n$$\n\n\\left|\\frac{g_j}{\\Delta_{j,r}}\\right| & \\ll 1,\n\n$$\nwhere $\\Delta_{j,r} = \\bar{\\omega}_j - \\omega_r$ is the detuning of the $j$'th transmon to the resonator. Note the total number of excitations is a symmetry of the system as the total excitation operator commutes with $H_\\text{sys}$.\n\nLet us write $H_\\text{sys}$ as the sum of two Hamiltonians $H_{\\text{sys},0}$ and $H_{\\text{sys},1}$\n$$\n\nH_{\\text{sys},0} &= \\sum_{j=1}^2\\left(\\bar{\\omega}_jb_j^{\\dagger}b_j + \\frac{\\delta_1}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-\\openone)\\right) + \\omega_r c^\\dagger c, \\nonumber \\\\\nH_{\\text{sys},1} &=  \\sum_{j=1}^2g_j(b_j^\\dagger c + b_jc^{\\dagger}),\n\n$$\nwhere $H_{\\text{sys},0}$ is diagonal and $H_{\\text{sys},1}$ contains all of the coupling terms so is off-diagonal. Moving into the frame rotating at $\\omega_r$ via the unitary\n$$\n\nR&= e^{-it\\omega_r\\left(b_1^\\dagger b_1 + b_2^\\dagger b_2 + c^\\dagger c\\right)},\n\n$$\ngives\n$$\n\nH_\\text{sys}&=\\sum_{j=1}^2\\left(\\Delta_{j,r} b_j^{\\dagger}b_j + \\frac{\\delta_j}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-\\openone) \\right) \\nonumber \\\\\n&+ \\sum_{j=1}^2g_j(b_j^\\dagger c + b_jc^{\\dagger}),\n\n$$\nwhere $\\Delta_{j,r} = \\bar{\\omega}_j-\\omega_r$. In this frame the diagonal part of $H_\\text{sys}$ is independent of the resonator photon number. Therefore $H_\\text{sys}$ is the direct sum of infinitely many identical copies (blocks) where each copy corresponds to a photon number $\\{0,1,2,...\\}$,\n$$\n\n\\text{diag}(H_\\text{sys}) &=\n\\left[ \\begin{array}{cccccc}\n0_p\t&\t\\:\t&\t\\: \t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t1_p\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t 2_p\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:.\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:.\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:.\t\\\\\n\\end{array} \\right].\n\n$$\nAll of the photon number blocks $j_p$ describe the same two-transmon Hamiltonian and each block can be broken into sub-blocks labeled by excitation number of the transmons\n$$\n\nj_p &=\n\\left[ \\begin{array}{cccccc}\n0\t&\t\\:\t&\t\\: \t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\{\\Delta_{i,r}\\}\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t\\{2\\Delta_{i,r}+\\delta_i, \\Delta_{1,r} + \\Delta_{2,r}\\}\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:.\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:.\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:.\t\\\\\n\\end{array} \\right].\n\n$$\nHence we can denote every possible excitation block by the label $(j_P,k_T)$ where \u201cP\" refers to photon and \u201cT\" refers to transmon.\n\nNow, since the photon number blocks $j_p$ support the same Hamiltonian, the blocks $(m_P,k_T)$ and $(r_P,k_T)$ have the exact same form for $m \\neq r$ and we can group all of the levels with the same transmon excitation number into a single infinite-dimensional block. The first block corresponds to zero excitations in the transmons\n$$\n\n\\{(0_P,0_T), (1_P,0_T),....,(m_P,0_T),...\\} \\nonumber \\\\\n= \\{|0_P\\rangle \\otimes |00\\rangle, |1_P\\rangle \\otimes |00\\rangle,....,|m_P\\rangle \\otimes |00\\rangle,...\\},\n\n$$\nat 0 energy scale, the second block corresponds to one transmon excitation\n$$\n\n\\{(0_P,1_T),....,(m_P,1_T),...\\} \\nonumber \\\\\n=  \\{|0_P\\rangle \\otimes |01\\rangle, |0_P\\rangle \\otimes |10\\rangle,....,|m_P\\rangle \\otimes |01\\rangle,|m_P\\rangle \\otimes |10\\rangle,...\\},\n\n$$\nat the energy scale $\\{\\Delta_{1,r},\\Delta_{2,r}\\}$, and the third block corresponds to two transmon excitations\n$$\n\n& \\{(0_P,2_T),....,(m_P,2_T),...\\}\\nonumber \\\\\n&=  \\{|0_P\\rangle \\otimes |02\\rangle, |0_P\\rangle \\otimes |11\\rangle, |0_P\\rangle \\otimes |20\\rangle,....,\\nonumber \\\\\n& \\: \\: \\: \\: \\: \\: |m_P\\rangle \\otimes |02\\rangle, |m_P\\rangle \\otimes |11\\rangle, |m_P\\rangle \\otimes |20\\rangle,...\\},\n\n$$\nat an energy scale of $\\{2\\Delta_{1,r}+\\delta_1, \\Delta_{1,r} + \\Delta_{2,r}, 2\\Delta_{2,r}+\\delta_2\\}$. The fourth block will correspond to three transmon excitations and four energies of the same order, and in general the $k$'th block will correspond to $k-1$ transmon excitations and $k$ different energies of the same order.\n\nHence $\\text{diag}(H_\\text{sys})$ is written as\n$$\n\n\\text{diag}(H_\\text{sys}) &=\n\\left[ \\begin{array}{cccccc}\n0_T\t&\t\\:\t&\t\\: \t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t1_T\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t 2_T\t&\t\\:\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:.\t&\t\\:\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:.\t&\t\\:\t\\\\\n\\:\t&\t\\:\t&\t \\:\t&\t\\:\t&\t\\:\t&\t\\:.\t\\\\\n\\end{array} \\right],\n\n$$\nwhere each block $k_T$ has energy approximately on the order of $k\\Delta_{j,r}$. Since the coupling terms preserve total excitation number there are no coupling terms connecting elements within each block. All coupling terms connect different blocks which are detuned on the order of $\\Delta_{j,r}$, that is there are only couplings between the blocks $((j+1)_P,(k-1)_T)$ and $((j-1)_P,(k+1)_T)$. Since these blocks are detuned on the order of $\\Delta_{j,r}$, which is assumed to be much larger than the coupling strengths $g_j$, the couplings can be adiabatically eliminated to give an effective block-diagonal Hamiltonian for the whole system as outlined via the methods in Sec.\u00a0<ref>. In the dispersive regime where $\\omega_r$ is much larger than the transmon frequencies one can obtain an effective Hamiltonian for the two transmons by projecting onto the zero-excitation subspace of the bus which gives\n$$\n\nH_\\text{sys}^{(0)}=\\sum_{j=1}^2\\left(\\tilde{\\omega}_jb_j^{\\dagger}b_j + \\frac{\\delta_j}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-1)\\right) \\nonumber \\\\\n+ J(b_1^\\dagger b_2 + b_1b_2^{\\dagger}),\\label{eq:Hsys0}\n\n$$\nwhere $\\tilde{\\omega}_1$ and $\\tilde{\\omega}_2$ are the dressed qubit frequencies and to lowest order the exchange coupling is given by\n$$\n\nJ&=\\frac{g_1g_2(\\bar{\\omega}_1+\\bar{\\omega}_2 - 2\\omega_r)}{2(\\bar{\\omega}_1-\\omega_r)(\\bar{\\omega}_2-\\omega_r)}.\n\n$$\nThe general drive Hamiltonian is modeled as\n$$\n\\label{eq:DriveHam}\nH_\\text{d} &=\\sum_{j=1}^2\\left[\\Omega_{X_j}(t)\\cos(\\omega_{d_j}t) + \\Omega_{Y_j}(t)\\sin(\\omega_{d_j}t)\\right](b_j^{\\dagger} + b_j),\n\n$$\nwhere $\\omega_{d_j}$ is the drive frequency on transmon $j$ and $\\Omega_{X_j}(t)$, $\\Omega_{Y_j}(t)$ are the drive amplitudes on the quadratures of transmon $j$. For now we will focus mainly on the case of only a drive term on the $X$ quadrature of qubit 1 (control) which gives a total Hamiltonian\n$$\n\nH_\\text{T}= H_\\text{sys}^{(0)}+H_\\text{d} \\nonumber \\\\\n=\\sum_{j=1}^2\\left(\\tilde{\\omega}_jb_j^{\\dagger}b_j + \\frac{\\delta_j}{2}b_j^{\\dagger}b_j(b_j^{\\dagger}b_j-1) \\right) + J(b_1^\\dagger b_2 + b_1b_2^{\\dagger})\\nonumber \\\\\n+\\sum_{j=1}^2\\left[\\Omega_{X_j}(t)\\cos(\\omega_{d_j}t) + \\Omega_{Y_j}(t)\\sin(\\omega_{d_j}t)\\right](b_j^{\\dagger} + b_j).\\label{eq:TotalHam}\n\n$$\nWe take $H_\\text{T}$ to form the basis of our analysis and analyze the ideal qubit model next.\n\n## Effective CR Hamiltonian for a qubit model\nIn the qubit model the anharmonicity is infinite so the qubit subspace is perfectly isolated and $H_\\text{T}$ is given by\n$$\n\nH_\\text{T} = \\sum_{j=1}^2 \\tilde{\\omega}_jb_j^{\\dagger}b_j  + J(b_1^\\dagger b_2 + b_1b_2^{\\dagger})  + \\Omega(t)\\cos(\\tilde{\\omega}_2 t)(b_1^{\\dagger} + b_1),\n\n$$\nwhere $b_j$ is a two-level operator, the control qubit is driven at the frequency of the target qubit, and for simplicity we assume $\\Omega (t) = \\Omega$ is a constant amplitude drive on the $X$ quadrature of the control qubit only. We derive an exact expression for the full qubit CR Hamiltonian using the method of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] and find an effective $ZX$ term that agrees with expressions derived previously using alternative methods\u00a0[Unknown Author, \"Unknown Title\", ]. First, we move into the frame rotating at $\\tilde{\\omega}_2$ on both qubits and make the RWA by ignoring fast-rotating terms. Writing $\\cos(\\tilde{\\omega}_2 t) = (e^{-i\\tilde{\\omega}_2 t} + e^{i\\tilde{\\omega}_2 t})/2$, defining\n$$\n\nR=e^{-i\\tilde{\\omega}_2\\left(b_1^\\dagger b_1 + b_2^\\dagger b_2\\right)t},\n\n$$\nand ignoring fast-rotating terms gives the Hamiltonian\n$$\n\nH_R &= R^\\dagger H_\\text{T} R -i R^\\dagger \\dot{R} \\nonumber \\\\\n&= \\Delta b_1^{\\dagger}b_1 + J(b_1^\\dagger b_2 + b_1b_2^{\\dagger}) + \\frac{\\Omega}{2}\\left(b_1^\\dagger + b_1\\right) \\nonumber \\\\\n&=\n\\left[ \\begin{array}{cccc}\n0\t\t\t&\t0\t\t\t\t&\t \\Omega/2\t\t&\t0\\\\\n0\t\t\t&\t0\t\t\t\t&\t J\t\t\t\t&\t \\Omega/2\\\\\n\\Omega/2\t&\tJ\t\t\t\t&\t \\Delta\t\t\t&\t0\\\\\n0\t\t\t&\t \\Omega/2\t\t&\t 0\t\t\t\t&\t\\Delta\\\\\n\\end{array} \\right],\n\n$$\nwhere $\\Delta =\\tilde{\\omega}_1-\\tilde{\\omega}_2$. From the form of $H_R$ there are naturally two $2\\times 2$ blocks, one corresponding to the states $|00\\rangle$, $|01\\rangle$ with energy scale $0$ and the other corresponding to the states $|10\\rangle$, $|11\\rangle$ with energy scale $\\Delta$. Using the method of Sec.\u00a0<ref>, which in this case corresponds to the standard Schrieffer-Wolff transformation, one can find the closest block-diagonal Hermitian matrix to $H_R$ under the principle of least action. Let $X$ be the eigenvector matrix of $H_R$, that is, $X$ has columns consisting of the normalized eigenvectors of $H_R$. Let $\\overline{X}$ be the unnormalized version of $X$ with columns given by\n\n$$\n\n\\left[ \\begin{array}{c}\n\\frac{ \\left(J^2 + \\sqrt{J^2(J^2+\\Omega^2)}\\right) \\left(\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2-2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{J\\Omega^2}\\\\\n-\\frac{ \\left(\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2-2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{\\Omega}\t\\\\\n\\frac{ \\left(J^2 - \\sqrt{J^2(J^2+\\Omega^2)}\\right)}{J\\Omega}\\\\\n1\\\\\n\\end{array} \\right], \\nonumber  \\\\\n\\left[ \\begin{array}{c}\n\\frac{ \\left(J^2 - \\sqrt{J^2(J^2+\\Omega^2)}\\right) \\left(\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2+2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{J\\Omega^2}\\\\\n-\\frac{ \\left(\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2+2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{\\Omega}\t\\\\\n\\frac{ \\left(J^2 + \\sqrt{J^2(J^2+\\Omega^2)}\\right)}{J\\Omega}\\\\\n1\\\\\n\\end{array} \\right], \\nonumber  \\\\\n\\left[ \\begin{array}{c}\n\\frac{ -\\left(J^2 + \\sqrt{J^2(J^2+\\Omega^2)}\\right) \\left(-\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2-2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{J\\Omega^2}\\\\\n\\frac{ \\left(-\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2-2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{\\Omega}\t\\\\\n\\frac{ \\left(J^2 - \\sqrt{J^2(J^2+\\Omega^2)}\\right)}{J\\Omega}\\\\\n1\\\\\n\\end{array} \\right], \\nonumber  \\\\\n\\left[ \\begin{array}{c}\n\\frac{ \\left(-J^2 + \\sqrt{J^2(J^2+\\Omega^2)}\\right) \\left(-\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2+2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{J\\Omega^2}\\\\\n\\frac{ \\left(-\\Delta + \\sqrt{2J^2 + \\Delta^2+\\Omega^2+2 \\sqrt{J^2(J^2+\\Omega^2)}}\\right)}{\\Omega}\t\\\\\n\\frac{ \\left(J^2 + \\sqrt{J^2(J^2+\\Omega^2)}\\right)}{J\\Omega}\\\\\n1\\\\\n\\end{array} \\right].\\nonumber\n\n$$\nApproximating\n$$\n\n\\frac{ \\left(J^2 \\pm \\sqrt{J^2(J^2+\\Omega^2)}\\right)}{J\\Omega} \\sim 1,\n\n$$\nand re-scaling the eigenvectors implies $\\overline{X}$ takes the form\n$$\n\n\\left[ \\begin{array}{c}\n1\\\\\n-1\\\\\n- \\frac{ \\Omega }{(\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega-J)^2})}\\\\\n\\frac{ \\Omega }{(\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega-J)^2})}\\\\\\\\\n\\end{array} \\right],\n\\left[ \\begin{array}{c}\n1\\\\\n1\\\\\n- \\frac{ \\Omega }{(\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega+J)^2})}\\\\\n-\\frac{ \\Omega }{(\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega+J)^2})}\\\\\\\\\n\\end{array} \\right],\n\n$$\n$$\n\n\\left[ \\begin{array}{c}\n1\\\\\n-1\\\\\n\\frac{ \\Omega }{(-\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega-J)^2})}\\\\\n-\\frac{ \\Omega }{(-\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega-J)^2})}\\\\\\\\\n\\end{array} \\right],\n\\left[ \\begin{array}{c}\n1\\\\\n1\\\\\n\\frac{ \\Omega }{(-\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega+J)^2})}\\\\\n\\frac{ \\Omega }{(-\\Delta + \\sqrt{J^2 + \\Delta^2+(\\Omega+J)^2})}\\\\\\\\\n\\end{array} \\right].\n\n$$\nThe least-action unitary $T$ that block-diagonalizes $H_R$ is given by\n$$\n\nT&=X X_{BD}^\\dagger X_P^{-\\frac{1}{2}},\n\n$$\nwhere $X_{BD}$ is the block-diagonalization of $X$ and $X_P= X_{BD} X_{BD}^\\dagger$. We have\n$$\n\n\\left(\\overline{X}_P\\right)^{-\\frac{1}{2}}(1:2,1:2) &=\n\\left[ \\begin{array}{cc}\n\\frac{1}{\\sqrt{2}} & 0 \\\\\n0 & \\frac{1}{\\sqrt{2}} \\\\\n\\end{array} \\right],\n\n$$\nand $\\left(\\overline{X}_P\\right)^{-\\frac{1}{2}}(3:4,3:4)$ is the $2\\times 2$ matrix\n$$\n\n\\left[ \\begin{array}{cc}\na & b \\\\\nb & a \\\\\n\\end{array} \\right],\n\n$$\nwhere\n$$\n\na&= \\frac{ -2\\Delta + \\sqrt{J^2 + \\Delta^2 + (\\Omega-J)^2} +  \\sqrt{J^2 + \\Delta^2 + (\\Omega+J)^2}}{2\\sqrt{2}\\Omega} \\nonumber \\\\\nb&= \\frac{ - \\sqrt{J^2 + \\Delta^2 + (\\Omega-J)^2} +  \\sqrt{J^2 + \\Delta^2 + (\\Omega+J)^2}}{2\\sqrt{2}\\Omega}.\n\n$$\nIgnoring terms of order $J^2$ gives the following unnormalized columns for $T$,\n$$\n\n\\left[ \\begin{array}{c}\n\\sqrt{2}\\\\\n0\\\\\n\\frac{ -\\sqrt{2}\\Omega }{(\\Delta + \\sqrt{ \\Delta^2+ \\Omega^2})}\\\\\n0\\\\\\\\\n\\end{array} \\right],\n\\left[ \\begin{array}{c}\n0\\\\\n\\sqrt{2}\\\\\n0\\\\\n\\frac{-\\sqrt{2}\\Omega }{(\\Delta + \\sqrt{ \\Delta^2+ \\Omega^2})}\\\\\\\\\n\\end{array} \\right],\\nonumber \\\\\n\\left[ \\begin{array}{c}\n\\sqrt{2}\\\\\n0\\\\\n\\frac{-\\sqrt{2}\\Omega}{( \\Delta - \\sqrt{\\Delta^2 + \\Omega^2})}\\\\\n0\\\\\\\\\n\\end{array} \\right],\n\\left[ \\begin{array}{c}\n0\\\\\n\\sqrt{2}\\\\\n0\\\\\n\\frac{-\\sqrt{2}\\Omega}{( \\Delta - \\sqrt{\\Delta^2 + \\Omega^2})}\\\\\\\\\n\\end{array} \\right].\n\n$$\nFinally computing the block-diagonal of $H_R$ and moving back to the physical frame consisting of the transmons rotating at their respective frequencies gives the block-diagonal Hamiltonian $H_\\text{CR}$ with $2\\times 2$ blocks given by\n$$\n\n\\frac{1}{2}\\left[ \\begin{array}{cc}\n\\Delta-\\sqrt{\\Delta^2 + \\Omega^2} &  -\\frac{J \\Omega}{\\sqrt{\\Delta^2 + \\Omega^2}} \\\\\n-\\frac{J \\Omega}{\\sqrt{\\Delta^2 + \\Omega^2}} & \\Delta-\\sqrt{\\Delta^2 + \\Omega^2}  \\\\\n\\end{array} \\right].\n\n$$\n$$\n\n\\frac{1}{2}\\left[ \\begin{array}{cc}\n-\\Delta+\\sqrt{\\Delta^2 + \\Omega^2} & \\frac{J \\Omega}{\\sqrt{\\Delta^2 + \\Omega^2}} \\\\\n\\frac{J \\Omega}{\\sqrt{\\Delta^2+ \\Omega^2}} & -\\Delta+\\sqrt{\\Delta^2 + \\Omega^2}\\\\\\\\\n\\end{array} \\right].\n\n$$\nThe $ZX$ term is thus given by\n$$\n\n\\text{tr}\\left(H_\\text{CR} \\left[\\frac{ZX}{2}\\right]\\right) &= -\\frac{J \\Omega}{\\sqrt{\\Delta^2 + \\Omega^2}},\n\n$$\nwhere by virtue of the system Hamiltonian definition, the two-qubit Pauli operators are scaled by $\\frac{1}{2}$ (in an $n$-qubit system they are scaled by $\\frac{1}{2^{n-1}}$). The Stark-shift term on the control qubit is given by\n$$\n\n\\text{tr}\\left(H_\\text{CR} \\left[\\frac{ZI}{2}\\right]\\right) &= \\Delta-\\sqrt{\\Delta^2 + \\Omega^2},\n\n$$\nand so in total\n$$\n\nH_\\text{CR} &= \\left(\\Delta-\\sqrt{\\Delta^2 + \\Omega^2}\\right) \\frac{Z\\mathbbm{1}}{2} -\\left(\\frac{J \\Omega}{\\sqrt{\\Delta^2 + \\Omega^2}}\\right)\\frac{ZX}{2}.\n\n$$\n\n## Effective CR Hamiltonian for a higher-level model\nFor a model including higher levels the approach is to first dress $H_\\text{sys}^{(0)}$ in Eq.\u00a0<ref> and then rotate the drive term into this frame. The system is then moved into the frame rotating at the target qubit frequency on both qubits and an RWA is performed. In this rotating frame the control $|0\\rangle$ and $|1\\rangle$ states define two subspaces that are far detuned by $\\sim \\Delta$ and an effective block-diagonal Hamiltonian is obtained via the perturbative analysis of Sec.\u00a0<ref>. Unlike the qubit case, exact analytical expressions are not straightforward to obtain and so realistic parameters are used for the exact method of Sec.\u00a0<ref>. For these parameters we find that the perturbative expressions and the exact block-diagonalization agree up to medium power drives of $\\Omega \\sim 50$ MHz with the exact method holding for much larger values of $\\Omega$.\n\nTo start we assume that $\\frac{J}{|\\tilde{\\omega}_1-\\tilde{\\omega}_2|} \\ll 1$ and obtain an effective diagonal Hamiltonian for $H_\\text{sys}^{(0)}$. Letting $U$ be the diagonalizing (dressing) unitary the effective diagonal Hamiltonian is given by\n$$\n\n\\tilde{H}_\\text{sys}^{(0)} = U^\\dagger H_\\text{sys}^{(0)} U,\n\n$$\nwhere to second order in the two-qubit subspace\n$$\n\n\\tilde{H}_\\text{sys}^{(0)} &= \\omega_1 \\frac{Z\\openone}{2} + \\omega_2 \\frac{\\openone Z}{2} + \\xi\\frac{ZZ}{2},\n\n$$\nwith\n$$\n\n\\omega_1 &= -\\tilde{\\omega}_1 - \\frac{J^2}{\\Delta} - \\xi, \\\\\n\\omega_2 &= -\\tilde{\\omega}_2 + \\frac{J^2}{\\Delta} - \\xi, \\\\\n\\xi &= -\\frac{J^2(\\delta_1+\\delta_2)}{(\\Delta + \\delta_1)(\\delta_2-\\Delta)}.\\label{eq:ZZ}\n\n$$\nThe presence of higher levels has produced an effective $ZZ$ interaction in the two-qubit subspace. The drive term of Eq.\u00a0<ref> is rotated into this frame by applying the diagonalizing unitary $U$,\n$$\n\\label{eq:Hddiag}\n\\tilde{H}_\\text{d} &= \\sum_{j=1}^2\\left[\\Omega_{X_j}(t)\\cos(\\omega_{d_j}t) + \\Omega_{Y_j}(t)\\sin(\\omega_{d_j}t)\\right] \\tilde{B}_j,\n\n$$\nwhere $\\tilde{B}_j = U^\\dagger (b_j^{\\dagger} + b_j)U$ for $j=1,2$.\n\nWe set $\\omega_{d_1}=\\omega_{d_2}=\\omega_d$ and the Hamiltonian in the dressed frame is given by\n$$\n\nH(t)=\\tilde{H}_\\text{sys}^{(0)} + \\tilde{H}_\\text{d}(t),\n\n$$\nMoving into the frame rotating at $\\omega_d$ on both transmons and making the RWA as outlined in Sec.\u00a0<ref> gives the Hamiltonian\n$$\n\nH_\\text{RWA}&=\\tilde{H}_\\text{drift}+\\tilde{H}_\\text{d,RWA},\n\n$$\nwhere\n$$\n\n\\tilde{H}_\\text{drift}&:=\\tilde{H}_\\text{sys}^{(0)}-\\tilde{H}_A, \\nonumber \\\\\n\\tilde{H}_\\text{d,RWA}&:= (R^\\dagger \\tilde{H}_d R)^\\text{RWA}, \\nonumber \\\\\n\\tilde{H}_A &= \\omega_d(b_1^\\dagger b_1 +  b_2^\\dagger b_2),\n\n$$\nand the matrix elements of $ (R^\\dagger H_\\text{d,diag}R)^\\text{RWA}$ are given by the cases in Eq.\u00a0<ref>. The drive frequency on the control transmon, $\\omega_d$, is set to be the average of the dressed target transmon frequencies over the ground and excited states of the control transmon,\n$$\n\n\\omega_d &= \\frac{\\tilde{H}_\\text{sys}^{(0)}(11)-\\tilde{H}_\\text{sys}^{(0)}(10) + \\tilde{H}_\\text{sys}^{(0)}(01)-\\tilde{H}_\\text{sys}^{(0)}(00)}{2}.\\label{eq:omegad}\n\n$$\n\nWe suppose the states are ladder-ordered as $\\{00,01,10,11,02,20,03,12,21,30,....,0d,...,d0\\}$ with $F$ denoting the permutation matrix that moves to ladder ordering from standard Kronecker ordering. To second order in $J$ the $\\{00,01\\}$ subspace has energy $\\frac{J^2}{\\Delta}$, the $\\{10,11\\}$ subspace has energy $\\Delta + \\frac{J^2}{\\Delta}$, and $\\text{\\{rest\\}}$ is assumed to be detuned from both of these subspaces. Loosely speaking, the energy of the state $|jk\\rangle$ is given by\n$$\n\nj\\Delta + \\frac{j(j-1)}{2}\\delta_1 + \\frac{k(k-1)}{2}\\delta_2,\n\n$$\nso that $H_\\text{drift}$ is naturally partitioned according to the relative detunings with respect to $\\omega_d$. Therefore the space can be partitioned as $\\{00,01\\},\\{10,11\\},\\{\\text{rest}\\}$. The off-diagonal elements have a magnitude set by $\\Omega  \\left(\\frac{J}{\\Delta}\\right)^m$ for $m \\geq 0$. Let us now analyze the perturbative approach to obtain analytic expressions in the weak-drive limit and then investigate the exact method under the principle of least action.\n\n### Effective perturbative Hamiltonian\nUnder the assumption $\\frac{\\Omega}{\\Delta} \\ll 1$ a canonical transformation can be perturbatively constructed to find an effective block-diagonal Hamiltonian via the method outlined in Sec\u00a0<ref>. We assume the drive term in Eq.\u00a0<ref> contains only a drive on the $X$ quadrature of the control with a constant amplitude $\\Omega$. The unperturbed Hamiltonian, denoted $H_0$, can be defined in a few different ways. For instance it can be defined via the block-diagonals of $H_{\\text{RWA}}$,\n$$\n\nH_0&=P_{0001}H_\\text{RWA}P_{0001} + P_{1011}H_\\text{RWA}P_{1011} \\nonumber \\\\\n&+ P_{\\text{rest}}H_\\text{RWA}P_{\\text{rest}},\n\n$$\nwith perturbative term given by\n$$\n\nH_1&=\\frac{H_\\text{RWA}-H_0}{\\Omega},\n\n$$\nso that\n$$\n\nH_\\text{RWA} &= H_0 + \\lambda H_1.\n\n$$\n\nUnfortunately, defining $H_0$ to be block-diagonal does not provide simple analytic expressions for the effective block-diagonal Hamiltonian components because one needs to analytically compute the inverse of $H_0$ (see Sec.\u00a0<ref>). As a result, we approach the construction by defining an unperturbed Hamiltonian via the diagonals of $H_{\\text{RWA}}$\n$$\n\nH_0&= \\text{diag}(H_{\\text{RWA}}),\n\n$$\nand define the perturbative term by\n$$\n\nH_1&=\\frac{H_\\text{RWA}-H_0}{\\Omega}.\n\n$$\nAt each order we enforce block-diagonality as usual where the diagonal unperturbed Hamiltonian is treated as block-diagonal. In this picture all terms of the Hamiltonian containing the drive are included in the perturbation Hamiltonian and the inverse of $H_0$ is simple to compute. The order parameter is given by $\\lambda=\\Omega$ and\n$$\n\nH_\\text{RWA} &= H_0 + \\lambda H_1.\n\n$$\n\nThe perturbation proceeds as follows. The effective Hamiltonian takes the form\n$$\n\n\\Heff &=\\sum_{m=0}^\\infty \\lambda^m H^{(m)},\n\n$$\nwhere $H^{(0)} = H_0$ is diagonal (block-diagonal) and for $m > 0$,\n$$\n\nH^{(m)} &= i\\left[S^{(m)},H_0\\right] + H_x^{(m)},\n\n$$\nwith $H_x^{(m)}$ defined in Sec.\u00a0<ref>. We define the $m$'th order approximation to $\\Heff$ by\n$$\n\nH_\\text{eff}^{(m)} &=H^{(0)}+\\lambda H^{(1)} + \\lambda^2 H^{(2)} + ... + \\lambda^m H^{(m)}.\n\n$$\nwhere at each order $H^{(m)}$ is enforced to be block-diagonal by the choice of $S^{(m)}$. Usually for $m=1$, $H_x^{(1)} = H_1$ is orthogonal to the desired form of $\\Heff^{(m)}$ and so $S^{(1)}$ typically eliminates the first-order term $H^{(1)}$. Here however by choosing $H_0$ to be diagonal, $H_1$ has non-zero super/sub-diagonals of order $\\frac{J}{\\Delta}\\Omega$. Therefore while we assume as usual that $S^{(1)}$ is off-block-diagonal, the non-zero super/sub-diagonals of $H_1$ survive to give a contribution at first order in $\\Omega$ so that $H_\\text{eff}^{(1)}$ has leading diagonals of order $ \\frac{J}{\\Delta}\\Omega$ and unchanged diagonal elements (which have shifts of order $\\frac{J^2}{\\Delta}$ from the dressing) .\n\nKeeping terms to first order in $J$,\n$$\n\nH_x^{(2)} &= -\\frac{1}{2}\\left[S^{(1)},\\left[S^{(1)},H_0\\right]\\right] + i\\left[S^{(1)},H_1\\right]\n\n$$\nhas sub/super diagonals equal to 0 and contributions of order $\\Omega^2$ on the diagonals. Thus the second order term contributes only to the diagonals and the off-diagonals of $H_\\text{eff}^{(2)}$ are the same as in the first-order expression,\n$$\n\nH_\\text{eff}^{(1)}[1,2] = H_\\text{eff}^{(2)}[1,2] = -\\frac{J\\Omega_{X,1}}{2\\Delta}, \\nonumber \\\\\nH_\\text{eff}^{(1)}[3,4] = H_\\text{eff}^{(2)}[3,4] = -\\frac{J\\Omega_{X,1}(\\Delta-\\delta_1)}{2\\Delta(\\Delta + \\delta_1)}.\n\n$$\nGoing to third-order one again obtains corrections to the off-diagonals and we use the third-order effective Hamiltonian for the analytic expressions of the Hamiltonian. Moving back into the physical frame to restore the correct energies relative to the respective qubit frequencies gives the final Hamiltonian $H_\\text{CR}$,\n$$\n\nH_\\text{CR} = H_\\text{eff} + \\left(\\omega_d - \\omega_{d_1}\\right)F(b^\\dagger b \\otimes \\openone)F^\\dagger.\n\n$$\nwhere\n$$\n\n\\omega_{d_1} &= \\frac{\\tilde{H}_\\text{sys}^{(0)}(11)-\\tilde{H}_\\text{sys}^{(0)}(01) + \\tilde{H}_\\text{sys}^{(0)}(10)-\\tilde{H}_\\text{sys}^{(0)}(00)}{2}\n\n$$\nis the dressed frequency of the control qubit.\n\nThe ZX coefficient to third order is given by\n$$\n\n\\frac{ZX}{2}_\\text{coeff} &= \\frac{ZX}{2}_\\text{linear} \\nonumber \\\\\n& + \\frac{ J\\Omega^3 \\delta_1^2 (3 \\delta_1^3 + 11 \\delta_1^2 \\Delta + 15 \\delta_1 \\Delta^2 + 9 \\Delta^3)\n}{ 2\\Delta^3 (\\delta1 + \\Delta)^3 (\\delta_1 + 2 \\Delta)(3 \\delta_1 + 2 \\Delta)},\n\n$$\nwhere\n$$\n\n\\frac{ZX}{2}_\\text{linear}  &= -\\frac{J\\Omega}{\\Delta}\\left(\\frac{\\delta_1}{\\delta_1+\\Delta}\\right),\n\n$$\nand the full set of Pauli coefficients is given in Sec.\u00a0<ref>. The poles in the $ZX$ expression occur at $\\Delta = 0$, $-\\frac{\\delta_1}{2}$, $-\\delta_1$, $-\\frac{3\\delta_1}{2}$.  The point $\\Delta = 0$ corresponds to the qubits on-resonance and the point $\\Delta=-\\delta_1$ corresponds to the $\\omega_{01}^{(1)}=\\omega_{12}^{(2)}$. The points $\\Delta=-\\frac{\\delta_1}{2}$ and $\\Delta=-\\delta_1$, $-\\frac{3\\delta_1}{2}$ are two-photon processes, the first of which corresponds to $\\omega_{01}^{(1)}=\\frac{\\omega_{02}^{(2)}}{2}$. If these points are avoided one expects the perturbative expressions to model the system well in the weak drive limit.\n\n### Effective Hamiltonian from principle of least action\nAn effective block-diagonal CR Hamiltonian obtained under the principle of least action (outlined in Sec.\u00a0<ref>) provides a valid model in the limit of strong drives where the perturbative model breaks down. Since a general analytic expression for the effective Hamiltonian can not be obtained we use the device parameters of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] to form the basis of our study; $\\omega_1/2\\pi = 5.114  \\: \\text{GHz}$, $\\omega_2/2\\pi = 4.914 \\: \\text{GHz}$, $\\delta_ 1/2\\pi = -0.330 \\: \\text{GHz}$, $\\delta_2/2\\pi = -0.330\\: \\text{GHz}$, $g_1/2\\pi = 0.098 \\: \\text{GHz}$, $g_2/2\\pi = 0.083 \\: \\text{GHz}$, $\\omega_r/2\\pi = 6.31 \\: \\text{GHz}$, and $\\xi/2\\pi = 277 \\: \\text{kHz}$. Using the approximation from Eq.<ref>\n$$\n\n\\xi &= -\\frac{2J^2(\\delta_1+\\delta_2)}{(\\Delta_{12}+\\delta_1)(\\delta_2-\\Delta_{12})},\n\n$$\nthe exchange coupling rate is given by $J/2\\pi= 3.8 \\: \\text{MHz}$. Fig.\u00a0(Figure fig:Allcoeffs_Sarah) contains all of the relevant Pauli coefficients except $ZI$ which is given in Fig.\u00a0(Figure fig:ZI) and diverges quickly since the control qubit is driven far off-resonance. The presence of higher-levels and finite anharmonicity produces a large $IX$ term in the Hamiltonian that is not present in the pure qubit model. The $ZX$ and $IX$ coefficients have the largest magnitude and so the other coefficients are also contained alone in Fig.\u00a0(Figure fig:IZ_ZY_IY_ZZ). The $IZ$ and $ZZ$ terms do not deviate significantly from their initial values as the drive amplitude increases. Note that the non-zero offset of the $ZZ$ coefficient corresponds to the static $ZZ$ term.\n\nImportantly, there is no $IY$ term present which is also expected from the perturbative expressions for the Pauli coefficients in Sec.\u00a0<ref>. This is in contrast to the experimental results of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] where there is a large $IY$ component for this for set of parameters. We revisit this discrepancy in Sec.\u00a0<ref>.\n\n< g r a p h i c s >\n\nPauli coefficients for model with higher levels.\n\n< g r a p h i c s >\n\nZI Pauli coefficient for model with higher levels.\n\n< g r a p h i c s >\n\nIY, IZ, ZY, and ZZ Pauli coefficients for model with higher levels.\n\nFig.\u00a0(Figure fig:ZX_Sarah) contains expressions for the $ZX$ term from the different Hamiltonian models; principle of least action, first order perturbative expression, third-order perturbative expression, and the ideal qubit limit. As expected the perturbative expressions match the principle of least action for weak $\\Omega$ but diverge as $\\Omega$ grows large. In addition there is a significant deviation between the $ZX$ coefficient for the perfect qubit model and that from the principle of least action which indicates the presence of higher levels with finite anharmonicity needs to be taken into account for accurate Hamiltonian modeling.\n\n< g r a p h i c s >\n\nVarious expressions for $ZX$ term.\n\nNext, both the frequency of the control transmon, $\\omega_1$, and the drive amplitude $\\Omega$ are swept with $\\Delta/2\\pi$ varied from 0 to 600 MHz and $\\Omega/2\\pi$ from 0 to 100 MHz. From the poles in the expressions of the Pauli coefficients found in Sec.\u00a0<ref> one expects that when $\\Delta = -\\frac{\\delta_1}{2}$, $-\\delta_1$, $-\\frac{3\\delta_1}{2}$, $\\Heff$ will be a poor model for $H$. A method for quantifying how well $\\Heff$ captures the full dynamics is discussed in Sec.\u00a0<ref>.\n\nThe $ZX$ coefficient is shown in Fig.\u00a0(Figure fig:ZX_2D_Sarah) and up to $-\\delta_1$ there is a sizable $ZX$ rate, however past this point the rate quickly goes to 0. Intuitively this phenomenon is explained by the fact that when two transmons are detuned by an amount greater than their anharmonicity, they begin to look like harmonic oscillators with respect to each other. Therefore since entanglement can not be created between two harmonic oscillators, the $ZX$ term approaches 0 as the detuning $\\Delta$ grows large.\n\n< g r a p h i c s >\n\nTwo-dimensional $ZX$ coefficient sweep (color scale in MHz).\n\n## Modeling classical cross-talk from CR drive\nIn Ref.\u00a0[Unknown Author, \"Unknown Title\", ] a CR gate with the parameters of Sec.\u00a0<ref> was calibrated based on the block-diagonal effective Hamiltonian in a scheme called partial Hamiltonian tomography. A large $IY$ term was found to be present but clearly the results of Sec.\u00a0<ref> predict no such term can arise from from the Hamiltonian model considered to this point. One potential model for the source of this term that we investigate here is classical cross-talk induced on the target from driving the control.\n\nTo analyze this model we go back to Eq.\u00a0<ref> and allow for a drive term on the target qubit whose amplitude and phase depend on the drive on the control. The total drive term then takes the form\n$$\n\\label{eq:Hddiagtwo}\n\\tilde{H}_d&= \\Omega(t)\\cos(\\omega_dt+\\phi_c)\\tilde{B}_1 \\nonumber \\\\\n&+ A\\Omega(t)\\cos(\\omega_dt+ \\phi_t) \\tilde{B}_2,\n\n$$\nwhere $\\tilde{B}_j = U^\\dagger (b_j^{\\dagger} + b_j)U$ for $j=1,2$, $A \\leq 1 $ is a scale factor modeling the amplitude of the cross-talk term, and $\\phi_t$ is the phase lag that occurs on the target. The values of these parameters depend on the form of the cross-talk channel. Since the cross-talk term corresponds directly to a rotation on the target qubit, the condition for block-diagonalization $\\frac{\\Omega}{\\Delta_{12}} \\ll 1$ is unchanged and the methods discussed here can be used to obtain an effective Hamiltonian.\n\nUsing the parameters of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] we find the following values for $A$, $\\phi_c$, and $\\phi_t$,\n$$\n\nA&=0.071,\\nonumber \\\\\n\\phi_c&=\\pi,\\nonumber \\\\\n\\phi_t&=-0.62,\n\n$$\nproduces the Pauli coefficients seen in Fig.\u00a0(Figure fig:Allcoeffs_Sarah_target) which agree well with those in Fig. 2b of Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. It is important to note that this agreement only suggests classical cross-talk as a potential source for the presence of the $IY$ term in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. Potential sources of cross-talk channels are an area of current investigation.\n\n< g r a p h i c s >\n\nVarious Pauli coefficients.\n\n## Discussion\nWe have provided detailed theoretical models of the cross-resonance gate via effective block-diagonal Hamiltonian techniques. For the idealized qubit model, analytic expressions for the Hamiltonian components using the principle of least action\u00a0[Unknown Author, \"Unknown Title\", ] were obtained. The only two non-zero components are a large Stark shift term on the control qubit from off-resonant driving as well as the $ZX$ term required for generating entanglement. For the realistic transmon model effective Hamiltonians were constructed via both a perturbative approach as well as the principle of least action. These two approaches agree well in the weak drive limit and predict non-zero Pauli coefficients of the form $A \\otimes B$ with $A \\in \\{I,Z\\}$, $B \\in \\{I,X,Z\\}$. The presence of extra Hamiltonian terms compared to those from the ideal qubit case implies higher levels play an important role to understand the precise error terms for implementing a two-qubit gate.\n\nIn the experiment of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] an $IY$ term was found to be present in contrast to what is predicted from our analysis with a single CR drive on the control transmon. We propose this discrepancy is a result of classical cross-talk between the two transmons and generalized the model to include this effect via an additional phase-shifted drive term on the target transmon. For a set of realistic model parameters we found good agreement between the theoretical results here and those of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] which implies classical cross-talk may be a significant issue in real systems. Understanding the cross-talk channels leading to drive terms on the target transmon is an important area of further research.\n\nVarious interesting questions remain as directions for future research. First, it is useful to understand whether the perturbative construction converges to that of the principle of least action. For the standard two-block Schrieffer-Wolff transformation the perturbative construction does converge to exact unitary rotation and ideally this property holds for the multi-block case as well. It will also be interesting to apply these methods to larger multi-qubit systems, especially in the context of finding points to avoid in frequency space when dealing with fixed-frequency transmons in a circuit-QED architecture. The results from a multi-qubit analysis will have an impact on future design considerations in superconducting circuit systems.\n\n## acknowledgments\nThe authors thank Andrew Cross and Sarah Sheldon for helpful discussions and comments. This work was supported by the Army Research Office under contract W911NF-14-1-0124.\n\n## Effective Hamiltonians\n### Effective Hamiltonian from principle of least action\nSuppose one is given a Hamiltonian $H$ on the Hilbert space $\\mathcal{H}$ with eigenvalues $E_a$ and eigenvectors $|s_a\\rangle$;\n$$\n\\nonumber\nH &= \\sum_a E_a |s_a\\rangle\\langle s_a |.\n\n$$\nA Hermitian matrix $H_\\text{eff}$ is said to be an effective Hamiltonian for $H$ with respect to the orthogonal subspaces $\\{\\mathcal{K}_a\\}$ ($\\cup _a \\mathcal{K}_a = \\mathcal{H}$) if the following are satisfied,\n\n* $H_\\text{eff}$ has the same energy spectrum as $H$,\n\n* $H_\\text{eff}$ only has support on the $\\mathcal{K}_a$.\n\nSuppose each subspace $\\mathcal{K}_a$ has dimension $d_{\\mathcal{K}_a}$ and let $P_{\\mathcal{K}_a}$ be the projector onto $\\mathcal{K}_a$. We set an orthonormal basis for each $\\mathcal{K}_a$, denoted $\\{|q^{\\mathcal{K}_a}_b\\rangle\\}$, $b=1,...,d_{K_a}$, to be the standard basis for working in coordinates. Note that for each $\\mathcal{K}_a$ any linear combination of the $|q^{\\mathcal{K}_a}_b\\rangle$ is still supported only on $\\mathcal{K}_a$. The full orthonormal basis for $\\mathcal{H}$ comprised of the union of these bases will be denoted $\\{|q_a\\rangle\\}$. $H_\\text{eff}$ is uniquely defined by a unitary matrix $T$ that maps the eigenvectors of $H$, $|s_a\\rangle$, to the eigenvectors $|r_a\\rangle$ of $H_\\text{eff}$ with the eigenvalues being preserved since $T$ is unitary. From the desired form of $H_\\text{eff}$ having support only on the $\\mathcal{K}_a$, the sole restriction on the $|r_a\\rangle$ is that the first $d_{\\mathcal{K}_1}$ vectors have support only on $\\mathcal{K}_1$, the next $d_{\\mathcal{K}_2}$ have support only on $\\mathcal{K}_2$, and so on.\n\nLet us now discuss how to actually compute $T$. The first step is to map the eigenvalues of $H$ onto the $\\{|q_j\\rangle\\}$ basis via the eigenvector matrix $X$ of $H$ so that all of the freedom in computing $T$ comes from choosing a block-diagonal (with respect to $\\{|q_j\\rangle\\}$) unitary matrix $F$. Since $H = \\sum_a E_a |s_a\\rangle\\langle s_a |$, the columns of $X$ are equal to $|s_j\\rangle$ when written with respect to the basis $\\{|q_k\\rangle\\}$,\n$$\n\\label{eq:S2def}\nX&=\\sum_j|s_j\\rangle\\langle q_j|,\n\n$$\nand so\n$$\n\nX^\\dagger H X &= \\left(\\sum_j|q_j\\rangle\\langle s_j| \\right)\\left(\\sum_a E_a |s_a\\rangle\\langle s_a |\\right)\\left(\\sum_k|s_k\\rangle\\langle q_k| \\right)\\nonumber \\\\\n&= \\sum_a E_a |q_a\\rangle\\langle q_a |. \\nonumber\n\n$$\nThe unitary matrix $F$ now rotates into the desired eigenbasis $\\{|r_j\\rangle\\}$ and since the $|r_j\\rangle$ only have support on the subspaces $\\mathcal{K}_a$, $F$ represented in $|q_j\\rangle$ is a unitary block-diagonal matrix.\n\nThe total block-diagonalizing unitary $T$ can be written as the composition of $F$ with $X$ where $X$ is given in Eq.\u00a0<ref> and\n$$\n\\label{eq:F2def}\nF&=\\sum_j|r_j\\rangle\\langle q_j|.\n\n$$\n\nIt is clear the freedom in choosing $H_\\text{eff}$ comes entirely from choosing $F$. Ideally, one would like to obtain a unique $H_\\text{eff}$ given $H$. The approach given in Ref.\u00a0[Unknown Author, \"Unknown Title\", ] is to solve the following optimization problem:\n$$\n\\label{eq:argmin}\n\\text{argmin}_{F}\\left(\\|T-\\mathcal{I}\\|_2\\right),\n\n$$\nwhich means to find the unitary matrix $F$ that minimizes the 2-norm (Euclidean) distance between $T$ and $\\mathcal{I}$. The unique solution of this problem is given by\n$$\n\nF&=\\frac{X_{BD}}{\\sqrt{X_{BD}X_{BD}^\\dagger}},\\nonumber\n\n$$\nwhere $X_{BD}$ is the projection of $X$ onto the subspaces $\\mathcal{K}_a$ and is assumed to be non-singular. Intuitively this can be thought of as first rotating $H$ into its eigenvalue matrix and attempting to rotate back to $H$ under the constraint of block-diagonality.\n\nThere are a variety of different metrics one could use to quantify the extent to which $H_\\text{eff}$ captures the dynamics of $H$. For instance one could directly compute the objective function in Eq.\u00a0<ref>. Alternatively, one can see that $H=H_\\text{eff}$ if and only if $X=X_{BD}$ and if the eigenvectors of $H$ are highly mixed across different blocks then the quality of $H_\\text{eff}$ as a model of $H$ decreases. As a result one can define a simple figure of merit, denoted $I(\\Heff)$, to be the normalized sum of the squared magnitudes of the eigenvectors of $H$ after being projected onto the subspaces $\\mathcal{K}_a$,\n$$\n\nI(\\Heff) &= \\frac{\\text{tr}\\left(X_{BD}X_{BD}^\\dagger\\right)}{\\text{dim}(\\mathcal{H})} = \\frac{\\|X_{BD}\\|_2^2}{\\text{dim}(\\mathcal{H})}.\\nonumber\n\n$$\nSince\n$$\n\n0 \\leq \\text{tr}\\left(X_{BD}X_{BD}^\\dagger\\right) \\leq \\text{dim}(\\mathcal{H}),\\nonumber\n\n$$\n$I(\\Heff) \\in [0,1]$. A plot of $I(\\Heff)$ for the parameters of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] is contained in Fig.\u00a0(Figure fig:IHeff_2D_Sarah) where the control transmon frequency is fixed $\\omega_1/2\\pi = 5.114$ GHz. As expected $I(\\Heff)$ deviates from 1 near the poles predicted from the perturbative analysis in Sec.\u00a0<ref>\n\n< g r a p h i c s >\n\n$I(\\Heff)$ with transmon detuning and drive power.\n\n### Effective Hamiltonian from perturbative construction of canonical transformations\nIn this section we will discuss how to perturbatively obtain a canonical transformation $U=e^{-i S}$ and an effective Hamiltonian $\\Heff$ that describes the dynamics of our system. We will focus our attention on the case where we have an unperturbed Hamiltonian $H_0$ that we can solve exactly and a perturbative term $H_1$ with order parameter $\\lambda$ such that\n$$\n\nH&=H_0+\\lambda H_1. \\nonumber\n\n$$\nObtaining $\\Heff$ from $H$ depends on the desired form we would like $\\Heff$ to have.  Here, we derive an iterative procedure to build the Hermitian matrix $S$ which provides the desired form of the Hamiltonian. Common examples of this method corresponds to diagonalization of $H$ and modeling the dynamics on the low-energy subspace as in the standard Schrieffer-Wolff (SW) transformation. We apply these methods to provide a complete perturbative solution to the simultaneous block-diagonalization of $H$ into an arbitrary number of blocks. In the case of two blocks the standard SW transformation is recovered.\n\nThe Hermitian operator $S$ in $U=e^{-iS}$ can be expanded as\n$$\n\nS &=\\sum_{n=1}^{\\infty}\\lambda^nS_n.\\nonumber\n\n$$\nComputing powers of $S$ results in the expressions\n$$\n\nS&= \\lambda S_1 + \\lambda^2 S_2 + \\lambda^3 S_3 + \\lambda^4 S_4 +...\\nonumber \\\\\nS^2 &=  \\lambda^2 S_1^2 + \\lambda^3 (S_1 S_2 + S_2S_1) + \\lambda^4(S_2^2 + S_1S_3 + S_3S_1) + ...\\nonumber \\\\\nS^3 &= \\lambda^3  S_1^3 + \\lambda^4 (S_1^2 S_2 +S_1S_2S_1 + S_2S_1^2 ) +...\\nonumber \\\\\nS^4 &= \\lambda^4 S_1^4 + ....\\nonumber\n\n$$\nWe can expand $U=e^{\\pm iS}$ in an exponential series to obtain\n$$\n\ne^{\\pm i S} &= \\openone \\pm i(\\lambda S_1 + \\lambda^2 S_2 + \\lambda^3 S_3 + \\lambda^4 S_4 + ...) \\nonumber \\\\\n&- \\frac{1}{2!} (\\lambda^2 S_1^2 + \\lambda^3 (S_1S_2 + S_2 S_1 + ...) \\nonumber \\\\\n&+ \\lambda^4 (S_2^2 + S_1S_3 + S_3S_1 +...))\\nonumber \\\\\n& \\mp \\frac{i}{3!} (\\lambda^3 S_1^3 + \\lambda^4(S_1^2S_2 + S_1S_2S_1 + S_2S_1^2) + ...) \\nonumber \\\\\n&+ \\frac{1}{4!}\\left(\\lambda^4 S_1^4 + ...\\right) + ...\\nonumber\n\n$$\nCollecting in powers of $\\lambda$ we have\n$$\n\ne^{\\pm i S} &= \\openone + \\lambda(\\pm i S_1) + \\lambda^2 \\left(\\pm i S_2-\\frac{1}{2}S_1^2\\right) \\nonumber \\\\\n&+ \\lambda^3\\left(\\pm i S_3 - \\frac{1}{2}(S_1S_2 + S_2 S_1) \\mp \\frac{i}{6} S_1^3\\right) \\nonumber \\\\\n&+ \\lambda^4 \\Bigg(\\pm i S_4 - \\frac{1}{2}(S_2^2 + S_1S_3 + S_3S_1) \\nonumber \\\\\n&\\mp \\frac{i}{6} (S_1^2S_2 + S_1S_2S_1 + S_2 S_1^2) + \\frac{1}{24}S_1^4\\Bigg).\\label{eq:exponentials}\n\n$$\nWriting\n$$\n\ne^{iS}(H_0 + \\lambda V)e^{-iS} &= e^{iS}H_0e^{-iS} + \\lambda e^{iS}V e^{-iS},\\nonumber\n\n$$\nwe first deal with $e^{iS}H_0e^{-iS}$ from which an expression for $ \\lambda e^{iS}V e^{-iS}$ will follow in a straightforward manner.\n\nExpanding the exponentials in Eq.\u00a0(<ref>) and collecting powers in $\\lambda$ gives the following coefficients at each order.\n\n$\\lambda^0$: $H_0$.\n\n$\\lambda^1$: $i[S_1,H_0]$.\n\n$\\lambda^2$:  $-\\frac{1}{2}[S_1,[S_1,H_0]] = -\\frac{S_1^2}{2}H_0 - H_0\\frac{S_1^2}{2} + S_1H_0S_1$,\n$$\n\ni[S_2,H_0] &= iS_2H_0-iH_0S_2. \\nonumber\n\n$$\n\n$\\lambda^3$: $i[S_3,H_0]$,\n$$\n\n-\\frac{i}{6}[S_1,[S_1,[S_1,H_0]]] \\nonumber \\\\\n= i\\Big(\\frac{3S_1^2H_0S_1}{6} - \\frac{3S_1H_0S_1^2}{6} + \\frac{H_0S_1^3}{6} - \\frac{S_1^3H_0}{6}\\Big),\\nonumber\n\n$$\nand\n$$\n\n-\\frac{1}{2}\\left([S_1,[S_2,H_0]] + [S_2,[S_1,H_0]]\\right) \\nonumber \\\\\n= \\frac{1}{2}\\Big(2S_1H_0S_2 + 2S_2H_0S_1 - H_0S_1S_2 \\nonumber \\\\\n- H_0S_2S_1 - S_1S_2H_0 - S_2S_1H_0\\Big). \\nonumber\n\n$$\n$\\lambda^4$: $i[S_4,H_0]$,\n$$\n\n-\\frac{i}{6}\\left([S_1,[S_1,[S_2,H_0]]] + [S_1,[S_2,[S_1,H_0]]] + [S_2,[S_1,[S_1,H_0]]]\\right) \\nonumber \\\\\n= \\frac{i}{6}H_0\\left(S_1^2S_2 + S_1S_2S_1 + S_2S_1^2\\right) \\nonumber \\\\\n+ -\\frac{i}{6}\\left(S_1^2S_2 + S_1S_2S_1 + S_2 S_1^2\\right)H_0\\nonumber \\\\\n-\\frac{i}{2}S_1H_0(S_1S_2 + S_2S_1) - \\frac{i}{2}S_2H_0S_1^2 \\nonumber \\\\\n+ \\frac{i}{2}S_1^2H_0S_2 + \\frac{i}{2}(S_1S_2 + S_2S_1)H_0S_1, \\nonumber\n\n$$\n$$\n\n\\frac{1}{24}[S_1,[S_1,[S_1,[S_1,H_0]]]] \\nonumber \\\\\n= \\frac{1}{24}\\left(H_0S_1^4 - 4S_1H_0S_1^3 + 6S_1^2H_0S_2^2 - 4S_1^3H_0S_2 + S_1^4H_0\\right), \\nonumber\n\n$$\n$$\n\n-\\frac{1}{2}[S_2,[S_2,H_0]] &= -\\frac{1}{2}\\left(H_0S_2^2 - 2S_2H_0S_2 + S_2^2H_0\\right), \\nonumber\n\n$$\n$$\n\n-\\frac{1}{2}\\left([S_1,[S_3,H_0]] + [S_3,[S_1,H_0]]\\right) \\nonumber \\\\\n= -\\frac{1}{2}\\Big(H_0(S_1S_3 + S_3S_1) - 2S_1H_0S_3 - 2S_3H_0S_1 \\nonumber \\\\\n+ (S_1S_3 + S_3S_1)H_0\\Big). \\nonumber\n\n$$\nThis gives to $5$'th order in $\\lambda$\n$$\n\ne^{iS}H_0e^{-iS} = H_0 + \\lambda\\left( i[S_1,H_0]\\right) \\nonumber \\\\\n+ \\lambda^2\\left( i[S_2,H_0]-\\frac{1}{2}[S_1,[S_1,H_0]]\\right) \\nonumber \\\\\n+ \\lambda^3\\Big(i[S_3,H_0] -\\frac{i}{6}[S_1,[S_1,[S_1,H_0]]] \\nonumber \\\\\n-\\frac{1}{2}\\left([S_1,[S_2,H_0]] + [S_2,[S_1,H_0]]\\right)\\Big) \\nonumber \\\\\n+ \\lambda^4 \\Bigg(i[S_4,H_0] -\\frac{i}{6}\\Big([S_1,[S_1,[S_2,H_0]]] \\nonumber \\\\\n[S_1,[S_2,[S_1,H_0]]] + [S_2,[S_1,[S_1,H_0]]]\\Big) \\nonumber \\\\\n+ \\frac{1}{24}[S_1,[S_1,[S_1,[S_1,H_0]]]] -\\frac{1}{2}[S_2,[S_2,H_0]] \\nonumber \\\\\n-\\frac{1}{2}\\left([S_1,[S_3,H_0]] + [S_3,[S_1,H_0]]\\right)\\Bigg).\\nonumber\n%+ O(\\lambda^5).\n\n$$\nReplacing $H_0$ with $\\lambda V$ we see that to $5$'th order in $\\lambda$\n$$\n\ne^{iS}\\lambda Ve^{-iS} = \\lambda V + \\lambda^2\\left( i[S_1,V]\\right) \\nonumber \\\\\n+ \\lambda^3\\left( i[S_2,V]-\\frac{1}{2}[S_1,[S_1,V]]\\right) \\nonumber \\\\\n+ \\lambda^4\\Big(i[S_3,V] -\\frac{i}{6}[S_1,[S_1,[S_1,V]]] \\nonumber \\\\\n-\\frac{1}{2}\\left([S_1,[S_2,V]] + [S_2,[S_1,V]]\\right)\\Big).\\nonumber\n%+ O(\\lambda^5).\n\n$$\nHence in total\n$$\n\ne^{iS}(H_0+\\lambda V)e^{-iS} = H_0 + \\lambda(i[S_1,H_0] + V) \\nonumber \\\\\n+ \\lambda^2\\left(i[S_2,H_0]  -\\frac{1}{2}[S_1,[S_1,H_0]] + i[S_1,V]\\right) \\nonumber \\\\\n+ \\lambda^3\\Big(i[S_3,H_0] -\\frac{i}{6}[S_1,[S_1,[S_1,H_0]]] \\nonumber \\\\\n-\\frac{1}{2}\\left([S_1,[S_2,H_0]] + [S_2,[S_1,H_0]]\\right) \\nonumber \\\\\n+  i[S_2,V]-\\frac{1}{2}[S_1,[S_1,V]]\\Big) \\nonumber \\\\\n+ \\lambda^4 \\Bigg(i[S_4,H_0] -\\frac{i}{6}\\Big([S_1,[S_1,[S_2,H_0]]] + [S_1,[S_2,[S_1,H_0]]] \\nonumber \\\\\n+ [S_2,[S_1,[S_1,H_0]]]\\Big)  + \\frac{1}{24}[S_1,[S_1,[S_1,[S_1,H_0]]]]\\nonumber \\\\\n-\\frac{1}{2}[S_2,[S_2,H_0]] -\\frac{1}{2}\\left([S_1,[S_3,H_0]] + [S_3,[S_1,H_0]]\\right) \\nonumber \\\\\n+ i[S_3,V] -\\frac{i}{6}[S_1,[S_1,[S_1,V]]] \\nonumber \\\\\n-\\frac{1}{2}\\left([S_1,[S_2,V]] + [S_2,[S_1,V]]\\right)\\Bigg) \\nonumber \\\\\n+ O\\left(\\lambda^5\\right).\\label{eq:Totaleq}\n\n$$\nEq.\u00a0<ref> can be written in a more compact fashion by defining two sequences of functions $\\left\\{f_j = f_j\\left(\\{A_i\\}_{i=1}^{j+1}\\right)\\right\\}_{j=0}^\\infty$ and $\\left\\{H^{(j)} = H^{(j)}\\left(\\{A_i\\}_{i=1}^{j+2}\\right)\\right\\}_{j=0}^\\infty$ where the $A_i$ are indeterminate variables indicating the number of inputs to each function,\n$$\n\ne^{iS}(H_0+\\lambda V)e^{-iS} &= \\sum_{k=0}^\\infty \\lambda^k H^{(k)}\\left(\\{S_j\\}_{j=1}^k,H_0,V\\right) \\nonumber \\\\\n&=  \\lambda^0 \\left[f_0(H_0)\\right] \\nonumber \\\\\n& +\\lambda^1  \\left[f_1(\\{S_j\\}_{j=1}^1,H_0) + f_0(V)\\right] \\nonumber \\\\\n& +\\lambda^2  \\left[f_2(\\{S_j\\}_{j=1}^2,H_0) + f_1(\\{S_j\\}_{j=1}^1,V)\\right] \\nonumber \\\\\n& +\\lambda^3  \\left[f_3(\\{S_j\\}_{j=1}^3,H_0) + f_2(\\{S_j\\}_{j=1}^2,V)\\right] \\nonumber \\\\\n& +\\lambda^4  \\left[f_4(\\{S_j\\}_{j=1}^4,H_0) + f_3(\\{S_j\\}_{j=1}^3,V)\\right] \\nonumber \\\\\n& + O\\left(\\lambda^5\\right). \\nonumber\n\n$$\nThe $f_j$ can be constructed in a straightforward manner which allows for the computation of the perturbation to any order. First, write all decompositions of $k>0$ into a sum of non-negative integers as follows\n$$\n\nk &: \\: \\: (k),\\nonumber \\\\\nk-1&: \\: \\: (k-1,1), (1,k-1), \\nonumber \\\\\nk-2&: \\: \\: (k-2,1,1),(1,k-2,1),(1,1,k-2),\\nonumber \\\\\n& \\: \\: \\: \\: \\: \\:  (k-2,2),(2,k-2), \\nonumber \\\\\nk-3&: \\: \\: (k-3,1,1,1),(1,k-3,1,1),(1,1,k-3,1),\\nonumber \\\\\n& \\: \\: \\: \\: \\: \\:  (1,1,1,k-3),(k-3,1,2),(k-3,2,1), \\nonumber \\\\\n& \\: \\: \\: \\: \\: \\:  (1,k-3,2),(2,k-3,1),(1,2,k-3),(2,1,k-3), \\nonumber \\\\\n. \\nonumber \\\\\n. \\nonumber \\\\\n. \\nonumber \\\\\n0 &: \\: \\: (1,1,1,...,1),\\nonumber\n\n$$\nwhere $(1,1,1,...,1)$ has $k$ indices. We now take each $(j_1,...,j_b)$ from the above expression and make the assignment\n$$\n\n(j_1,...,j_b) \\rightarrow \\frac{i^b}{b!}[S_{j_1},[S_{j_2},...,[S_{j_{n-1}},[S_{j_n},H_0]]...]].\\nonumber\n\n$$\nAs an example we compute the fifth order expression. We have\n$$\n\n(5), \\nonumber \\\\\n(4,1), (1,4), \\nonumber \\\\\n(3,1,1),(1,3,1),(1,1,3),\\nonumber \\\\\n(3,2),(2,3),\\nonumber \\\\\n(2,1,1,1),(1,2,1,1),(1,1,2,1),(1,1,1,2),\\nonumber \\\\\n(2,2,1),(2,1,2),(1,2,2),\\nonumber \\\\\n(1,1,1,1,1).\\nonumber\n\n$$\nThis gives\n$$\n\nf_5(\\{S_j\\}_{j=1}^5,H_0) \\nonumber \\\\\n= \\frac{i}{1!}[S_5,H_0] \\nonumber \\\\\n- \\frac{1}{2!}\\left([S_4,[S_1,H_0]] + [S_1,[S_4,H_0]]\\right) \\nonumber \\\\\n- \\frac{i}{3!} \\Big([S_3,[S_1,[S_1,H_0]]] + [S_1,[S_3,[S_1,H_0]]] \\nonumber \\\\\n+ [S_1,[S_1,[S_3,H_0]]] + [S_3,[S_2,H_0]] + [S_2,[S_3,H_0]]\\Big) \\nonumber \\\\\n+ \\frac{1}{4!}\\Big( [S_2,[S_1,[S_1,[S_1,H_0]]]] +  [S_1,[S_2,[S_1,[S_1,H_0]]]] \\nonumber \\\\\n+  [S_1,[S_1,[S_2,[S_1,H_0]]]] +  [S_1,[S_1,[S_1,[S_2,H_0]]]] \\nonumber \\\\\n+ [S_2,[S_2,[S_1,H_0]]] + [S_2,[S_1,[S_2,H_0]]] + [S_1,[S_2,[S_2,H_0]]]\\Big) \\nonumber \\\\\n+ \\frac{i}{5!} [S_1,[S_1,[S_1,[S_1,[S_1,H_0]]]]].\\nonumber\n\n$$\nCombining this with the expression for $f_4\\left(\\{S_j\\}_{j=1}^4,V\\right)$ already computed gives the full fifth order term\n$$\n\n\\lambda^5 \\Bigg[\\frac{i}{1!}[S_5,H_0] - \\frac{1}{2!}\\left([S_4,[S_1,H_0]] + [S_1,[S_4,H_0]]\\right) \\nonumber \\\\\n- \\frac{i}{3!} \\Big([S_3,[S_1,[S_1,H_0]]] + [S_1,[S_3,[S_1,H_0]]] \\nonumber \\\\\n+ [S_1,[S_1,[S_3,H_0]]]  + [S_3,[S_2,H_0]] + [S_2,[S_3,H_0]]\\Big) \\nonumber \\\\\n+ \\frac{1}{4!}\\Big( [S_2,[S_1,[S_1,[S_1,H_0]]]] +  [S_1,[S_2,[S_1,[S_1,H_0]]]] \\nonumber \\\\\n+  [S_1,[S_1,[S_2,[S_1,H_0]]]] +  [S_1,[S_1,[S_1,[S_2,H_0]]]] \\nonumber \\\\\n+ [S_2,[S_2,[S_1,H_0]]] + [S_2,[S_1,[S_2,H_0]]] \\nonumber \\\\\n+ [S_1,[S_2,[S_2,H_0]]]\\Big) + \\frac{i}{5!} [S_1,[S_1,[S_1,[S_1,[S_1,H_0]]]]]  \\nonumber \\\\\n+ \\Bigg(i[S_4,V] -\\frac{i}{6}\\Big([S_1,[S_1,[S_2,V]]] + [S_1,[S_2,[S_1,V]]] \\nonumber \\\\\n+ [S_2,[S_1,[S_1,V]]]\\Big) + \\frac{1}{24}[S_1,[S_1,[S_1,[S_1,V]]]]\\nonumber \\\\\n-\\frac{1}{2}[S_2,[S_2,V]] -\\frac{1}{2}\\left([S_1,[S_3,V]] + [S_3,[S_1,V]]\\right)\\Bigg)\\Bigg].\\nonumber\n\n$$\n\nNow that we can compute each $f_j$ we are able to recursively compute every order $H^{(j)}$. What remains is to compute the $S_j$ which is done by noting that at each order, $H^{(k)}\\left(\\{S_j\\}_{j=1}^k,H_0,V\\right)$ contains only one term with $S_k$ in it, $i[S_k,H_0]$. Hence one can write\n$$\n\\label{eq:Hm}\nH^{(m)}\\left(\\{S_j\\}_{j=1}^m,H_0,V\\right) \\nonumber \\\\\n= i[S_m,H_0] + H_x^{(m)}\\left(\\{S_j\\}_{j=1}^{m-1},H_0,V\\right),\\label{eq:Hm}\n\n$$\nand assuming $\\{S_j\\}_{j=1}^{k-1}$ have already been computed, $H_x^{(k)}$ can be computed as well. Hence one need only solve for $S_k$ at each order to compute $H^{(k)}$. $S_k$ is computed by ensuring $H^{(k)}$ satisfies the required form set by the problem. We now illustrate the method with two examples, diagonalization and block-diagonalization.\n\n#### Example 1: Diagonalization\nSuppose we want our effective dynamics to be diagonal at each order $m$, that is we want $H^{(m)}$ to be diagonal for every $m$ ($H_0$ is diagonal and $V$ is a perturbation containing off-diagonal components). We have\n$$\n\nH^{(0)} &= H_0, \\nonumber \\\\\nH_x^{(1)} &= H_1.\\nonumber\n\n$$\nOne can see from Eq.\u00a0(<ref>) that if $H^{(m)}$ is diagonal\n$$\n\n\\sum_pE_p^{(m)} |p\\rangle\\langle p| &= i \\sum_pE_p^{(0)}(S^{(m)}|p\\rangle\\langle p| - |p\\rangle\\langle p|S^{(m)}) \\nonumber \\\\\n& + H_x^{(m)}.\n\n$$\nWithout loss of generality we can assume that $S$ is an off-diagonal matrix (has diagonal entries of $0$) and so the above is satisfied if\n$$\n\nE_p^{(m)} &= \\langle p|H_x^{(m)} |p\\rangle, \\nonumber \\\\\n\\langle p|S^{(m)}|q\\rangle &= \\frac{-i\\langle p |H_x^{(m)} |q\\rangle}{E_p^{(0)} - E_q^{(0)}}, p \\neq q.\\nonumber\n\n$$\n\n#### Example 2: Block-Diagonalization\nSuppose we want our effective dynamics to be block-diagonal at each order $m$, that is we want $H^{(m)}$ to be block-diagonal for every $m$ ($H_0$ is block-diagonal and $V$ is a perturbation containing off-block-diagonal components). We have\n$$\n\nH^{(0)} &= H_0, \\nonumber \\\\\nH_x^{(1)} &= H_1.\\nonumber\n\n$$\nOne can see from Eq.\u00a0(<ref>) that if $H^{(m)}$ is block-diagonal\n$$\n\nH^{(m)} & = H_1^{(m)} \\oplus ... \\oplus H_k^{(m)} \\oplus ... \\nonumber\n\n$$\nthen acting subspace projectors $P_j$ and $P_k$ on both sides of Eq.\u00a0(<ref>) gives\n$$\n\nP_j  H_1^{(m)} \\oplus ... \\oplus H_k^{(m)} \\oplus ... P_k \\nonumber \\\\\n= i \\Big(P_j S^{(m)} ( H_1^{(0)} \\oplus ... \\oplus H_k^{(0)} \\oplus ...) P_k \\nonumber \\\\\n- P_j  ( H_1^{(0)} \\oplus ... \\oplus H_k^{(0)} \\oplus ...) S^{(m)}\\Big) P_k + P_j H_x^{(m)} P_k, \\nonumber\n\n$$\n$$\n\nH_j^{(m)}\\delta_{j,k} = i(P_j S^{(m)} P_k H_k^{(0)} - H_j^{(0)} P_j S^{(m)} P_k) + H_{x_{j,k}}^{(m)}, \\nonumber\n\n$$\nand\n$$\n\ni H_{x_{j,k}}^{(m)} + H_j^{(m)} \\delta_{j,k} = S_{j,k}^{(m)}H_k^{(0)} - H_j^{(0)} S_{j,k}^{(m)}. \\nonumber\n\n$$\nSince $S$ is an off-block-diagonal matrix (has block-diagonal entries of $0$) we have\n$$\n\nH_j^{(m)} &=  H_{x_{j,j}}^{(m)}, \\text{if} \\: j=k, \\nonumber \\\\\nH_j^{(0)} S_{j,k}^{(m)} - S_{j,k}^{(m)}H_k^{(0)}  &= - i H_{x_{j,k}}^{(m)},  \\text{if } \\:  j \\neq k. \\nonumber\n\n$$\n\nIn the case that $H^{(0)}$ is diagonal we can solve easily for $S^{(m)}$ at each order,\n$$\n\n\\langle p|S_{j,k}^{(m)}|q\\rangle &= \\frac{-i\\langle p |H_{x_{j,k}}^{(m)} |q\\rangle}{\\langle p| H_j^{(0)} |p \\rangle - \\langle q |H_k^{(0)} |q\\rangle}. \\nonumber\n\n$$\nHowever if $H^{(0)}$ is not diagonal we need to use the following matrix-vector correspondence. For any $A$, $B$, $C$\n$$\n\n(A\\otimes B)\\text{vec}(C) &= \\text{vec}(ACB^T), \\nonumber\n\n$$\nwhere \u201c$\\text{vec}$\" is defined as $\\text{vec}(|a\\rangle \\langle b|) = |a\\rangle \\otimes |b\\rangle$.\nHence\n$$\n\nAB-BC = D\\nonumber &\\Leftrightarrow \\nonumber \\\\\nAB\\openone^T - \\openone BC = D &\\Leftrightarrow \\nonumber \\\\\n\\text{vec}(AB\\openone^T) - \\text{vec}( \\openone BC) = \\text{vec}(D) &\\Leftrightarrow \\nonumber \\\\\n(A\\otimes \\openone - \\openone \\otimes C^T) \\text{vec}(B) = \\text{vec}(D) &\\Leftrightarrow \\nonumber \\\\\n\\text{vec}(B) = (A\\otimes \\openone - \\openone \\otimes C^T)^{-1}\\text{vec}(D) &\\Leftrightarrow \\nonumber \\\\\nB = \\text{mat}\\left(  (A\\otimes \\openone - \\openone \\otimes C^T)^{-1}\\text{vec}(D)\\right). \\nonumber\n\n$$\nLetting\n$$\n\nA&= H_j^{(0)} \\nonumber \\\\\nB&= S_{j,k}^{(m)}\\nonumber \\\\\nC&= H_k^{(0)} \\nonumber \\\\\nD&=  - i H_{x_{j,k}}^{(m)}, \\nonumber\n\n$$\nallows for $S_{j,k}^{(m)}$ to be solved at each order $m$.\n\n#### Summary of results for perturbative construction\nThe main result is\n$$\n\n\\Heff &= U^\\dagger H U = \\sum_{m=0}^\\infty \\lambda^m H^{(m)}, \\nonumber\n\n$$\nwhere\n$$\n\nH^{(m)} &= H^{(m)}\\left(\\{S_j\\}_{j=1}^m,H_0,H_1\\right) \\nonumber \\\\\n&= i[S_m,H_0] + H_x^{(m)}\\left(\\{S_j\\}_{j=1}^{m-1},H_0,H_1\\right). \\nonumber\n\n$$\n\nAt each order $m$, $H_x^{(m)}$ is a function of only $\\{S_1,...,S_{m-1}\\}$ and so can be computed since we assume the lower order $\\{S_1,...,S_{m-1}\\}$ are known. Hence $H^{(m)}\\left(\\{S_j\\}_{j=1}^m,H_0,H_1\\right)$ has only one term containing $S_m$, $i[S_m,H_0]$. Solving for $S_m$ subject to the desired dynamics allows for computation of $H^{(m)}$. For instance in the case of the SW transformation, the desired dynamics is to have $H^{(m)}$ be block-diagonal on $H_l$ and $H_e$.\n\nWe have\n$$\n\nH^{(0)} &= H_0, \\nonumber \\\\\nH_x^{(1)} &= H_1. \\nonumber\n\n$$\nIf $H^{(m)}$ is block-diagonal\n$$\n\nH^{(m)} & = H_1^{(m)} \\oplus ... \\oplus H_k^{(m)} \\oplus ... \\nonumber\n\n$$\nthen since $S$ can without loss of generality be an off-block-diagonal matrix (the block-diagonal entries of $S$ are $0$)\n$$\n\nH_j^{(m)} &=  H_{x_{j,j}}^{(m)}, \\text{if} \\: j=k, \\nonumber \\\\\nH_j^{(0)} S_{j,k}^{(m)} - S_{j,k}^{(m)}H_k^{(0)}  &= - i H_{x_{j,k}}^{(m)},  \\text{if } \\:  j \\neq k. \\nonumber\n\n$$\nNote that if $H^{(0)}$ is diagonal then\n$$\n\n\\langle p|S_{j,k}^{(m)}|q\\rangle &= \\frac{-i\\langle p |H_{x_{j,k}}^{(m)} |q\\rangle}{\\langle p| H_j^{(0)} |p \\rangle - \\langle q |H_k^{(0)} |q\\rangle}. \\nonumber\n\n$$\nIf $H^{(0)}$ is not diagonal we use the following matrix-vector correspondence\n$$\n\n(A\\otimes B)\\text{vec}(C) &= \\text{vec}(ACB^T),\\nonumber\n\n$$\nwhich holds for any $A$, $B$, $C$, where \u201c$\\text{vec}$\" is defined as $\\text{vec}(|a\\rangle \\langle b|) = |a\\rangle \\otimes |b\\rangle$.\nHence\n$$\n\nAB-BC= D\\nonumber &\\Leftrightarrow B = \\text{mat}\\left(  (A\\otimes \\openone - \\openone \\otimes C^T)^{-1}\\text{vec}(D)\\right). \\nonumber\n\n$$\nLetting $A= H_j^{(0)}$, $B= S_{j,k}^{(m)}$, $C= H_k^{(0)}$, and $D=  - i H_{x_{j,k}}^{(m)}$ allows us to solve for $S_{j,k}^{(m)}$ at each order $m$.\n\n## Making the RWA in the Duffing model case\nWe move into a frame rotating at $\\omega_d$ on both qubits. The unitary operator $R$ corresponding to this frame transformation is defined by the Hamiltonian $\\tilde{H}_A = \\omega_d(b_1^\\dagger b_1 +  b_2^\\dagger b_2)$,\n$$\n\nR&=e^{-i\\left[ \\omega_d(b_1^\\dagger b_1 +  b_2^\\dagger b_2)\\right]t}. \\nonumber\n\n$$\nThis gives the Hamiltonian\n$$\n\n\\tilde{H}_\\text{sys}^{(0)}-\\tilde{H}_A + R^\\dagger \\tilde{H}_d R &=: \\tilde{H}_\\text{drift} + R^\\dagger \\tilde{H}_d R. \\nonumber\n\n$$\nLet us now focus on the term $R^\\dagger \\tilde{H}_d R$ and make the RWA, which amounts to ignoring all excitations of energy cost $2\\omega_d$ or higher.\n\nWe have\n$$\n\n&R^\\dagger \\tilde{H}_d R \\nonumber \\\\\n&= \\sum_{j=1}^2\\left[\\Omega_{X_j}(t)\\cos(\\omega_dt) + \\Omega_{Y_j}(t)\\sin(\\omega_dt)\\right]R^\\dagger \\tilde{B}_j R \\nonumber \\\\\n&= \\sum_{j=1}^2\\Big[\\Omega_{X_j}(t)\\left(\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}\\right) - \\nonumber \\\\\n& \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\:  i\\Omega_{Y_j}(t)\\left(\\frac{e^{i\\omega_dt} -  e^{-i\\omega_dt}}{2}\\right)\\Big]R^\\dagger \\tilde{B}_j R.\\nonumber\n\n$$\nFirst, let's analyze the term $R^\\dagger \\tilde{B}_1 R$,\n$$\n\nR^\\dagger \\tilde{B}_1 R &= e^{-i\\omega_d(b_1^\\dagger b_1 + b_2^\\dagger b_2)t} \\tilde{B}_1 e^{i\\omega_d(b_1^\\dagger b_1 + b_2^\\dagger b_2)t}. \\nonumber\n\n$$\nLet\n$$\n\n\\tilde{B}_1 &= \\sum_{i_1,i_2,j_1,j_2}\\tilde{B}_1^{i_1,i_2,j_1,j_2}|i_1d+i_2\\rangle \\langle j_1d + j_2|, \\nonumber\n\n$$\nand\n$$\n\ne^{-i\\omega_d(b_1^\\dagger b_1 + b_2^\\dagger b_2)t} &= \\sum_{i_1,i_2}e^{-i\\omega_dt(i_1+i_2)}|i_1d + i_2\\rangle\\langle i_1d+i_2|, \\nonumber\n\n$$\nwhere the index in each sum is taken from $0$ to $d-1$. If $\\vec{i}=(i_1,i_2)$, $\\vec{j}=(j_1,j_2)$ then\n$$\n\nR^\\dagger \\tilde{B}_1 R &= \\sum_{\\vec{i},\\vec{j}}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_1^{\\vec{i},\\vec{j}}|i_1d+i_2\\rangle \\langle j_1d + j_2|. \\nonumber\n\n$$\nand so if\n$$\n\n\\Omega_j :=\\Omega_{X_j}(t)\\left(\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}\\right) -i\\Omega_{Y_j}(t)\\left(\\frac{e^{i\\omega_dt} -  e^{-i\\omega_dt}}{2}\\right),\\nonumber\n\n$$\nthen\n$$\n\nR^\\dagger \\tilde{H}_d R \\nonumber \\\\\n=\\Omega_1\\sum_{\\vec{i},\\vec{j}}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_1^{\\vec{i},\\vec{j}}|i_1d+i_2\\rangle \\langle j_1d + j_2| \\nonumber \\\\\n+ \\Omega_2\\sum_{\\vec{i},\\vec{j}}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_2^{\\vec{i},\\vec{j}}|i_1d+i_2\\rangle \\langle j_1d + j_2|. \\nonumber\n\n$$\nNow we want to ignore all terms rotating at $2\\omega_2$ or higher. Let us focus on the $\\Omega_{X_1}(t)$ term first. We  have\n$$\n\n\\Omega_{X_1}(t)\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_1^{\\vec{i},\\vec{j}}\\nonumber \\\\\n=\\frac{\\Omega_{X_1}(t)}{2}\\tilde{B}_1^{\\vec{i},\\vec{j}}\\Big[e^{i\\omega_dt(1-i_1-i_2+j_1+j_2)} \\nonumber \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: + e^{-i\\omega_dt(1+i_1+i_2-j_1-j_2)}\\Big],\\nonumber\n\n$$\n$$\n\n-i\\Omega_{Y_1}(t)\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_1^{\\vec{i},\\vec{j}}\\nonumber \\\\\n=\\frac{-i\\Omega_{Y_1}(t)}{2}\\tilde{B}_1^{\\vec{i},\\vec{j}}\\Big[e^{i\\omega_dt(1-i_1-i_2+j_1+j_2)} \\nonumber \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\:  - e^{-i\\omega_dt(1+i_1+i_2-j_1-j_2)}\\Big], \\nonumber\n\n$$\n$$\n\n\\Omega_{X_2}(t)\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_2^{\\vec{i},\\vec{j}}\\nonumber \\\\\n=\\frac{\\Omega_{X_2}(t)}{2}\\tilde{B}_2^{\\vec{i},\\vec{j}}\\Big[e^{i\\omega_dt(1-i_1-i_2+j_1+j_2)} \\nonumber \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: + e^{-i\\omega_dt(1+i_1+i_2-j_1-j_2)}\\Big], \\nonumber\n\n$$\n$$\n\n-i\\Omega_{Y_2}(t)\\frac{e^{i\\omega_dt} + e^{-i\\omega_dt}}{2}e^{-i\\omega_dt(i_1+i_2-j_1-j_2)}\\tilde{B}_2^{\\vec{i},\\vec{j}}\\nonumber \\\\\n=\\frac{-i\\Omega_{Y_2}(t)}{2}\\tilde{B}_2^{\\vec{i},\\vec{j}}\\Big[e^{i\\omega_dt(1-i_1-i_2+j_1+j_2)} \\nonumber \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\:  - e^{-i\\omega_dt(1+i_1+i_2-j_1-j_2)}\\Big]. \\nonumber\n\n$$\nLooking at the terms in the brackets on the right-hand side we see that\n\n|i_1+i_2-j_1-j_2| \u2260 1   then\n\ne^i\u03c9_dt(1-i_1-i_2+j_1+j_2) = 0, e^-i\u03c9_dt(1+i_1+i_2-j_1-j_2) = 0,\ni_1+i_2-j_1-j_2 = 1    then\n\ne^i\u03c9_dt(1-i_1-i_2+j_1+j_2) = 1, e^-i\u03c9_dt(1+i_1+i_2-j_1-j_2) = 0,\ni_1+i_2-j_1-j_2 = -1    then\n\ne^i\u03c9_dt(1-i_1-i_2+j_1+j_2) = 0, e^-i\u03c9_dt(1+i_1+i_2-j_1-j_2) = 1.\n\nHence, in total,\n$$\n\\label{eq:Cases}\n%\\[\n\\begin{cases}\n\\mbox{if } |i_1+i_2-j_1-j_2| \\neq 1 \\:  \\text{then}    (RH_\\text{d,diag}R^{\\dagger})_{i_1,i_2,j_1,j_2}=0 , \\\\\n\\mbox{if } i_1+i_2-j_1-j_2 = 1  \\: \\text{then} \\\\\n(R\\tilde{H}_dR^{\\dagger})_{i_1,i_2,j_1,j_2} =\n\\frac{\\Omega_{X_1}(t)-i\\Omega_{Y_1}(t)}{2}\\tilde{B}_1^{\\vec{i},\\vec{j}} \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\:          +    \\frac{\\Omega_{X_2}(t)-i\\Omega_{Y_2}(t)}{2}\\tilde{B}_2^{\\vec{i},\\vec{j}}   ,              \\\\\n\\mbox{if } i_1+i_2-j_1-j_2 = -1  \\: \\text{then} \\nonumber \\\\\n(R\\tilde{H}_d R^{\\dagger})_{i_1,i_2,j_1,j_2}= \\frac{\\Omega_{X_1}(t)+i\\Omega_{Y_1}(t)}{2}\\tilde{B}_1^{\\vec{i},\\vec{j}} \\\\\n\\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\: \\:          +    \\frac{\\Omega_{X_2}(t)+i\\Omega_{Y_2}(t)}{2}\\tilde{B}_2^{\\vec{i},\\vec{j}}.  \\\\\n\\end{cases}\n%\\]\n\n$$\nThe full rotating wave approximated Hamiltonian becomes\n$$\n\nH_\\text{RWA}&=\\tilde{H}_\\text{drift}+\\tilde{H}_\\text{d,RWA},\\nonumber\n\n$$\nwhere\n$$\n\n\\tilde{H}_\\text{drift}&:=\\tilde{H}_\\text{sys}^{(0)}-\\tilde{H}_A, \\nonumber \\\\\n\\tilde{H}_\\text{d,RWA}&:= (R^\\dagger \\tilde{H}_d R)^\\text{RWA}, \\nonumber \\\\\n\\tilde{H}_A &= \\omega_d(b_1^\\dagger b_1 +  b_2^\\dagger b_2),\n\n$$\nand the matrix elements of $ (R^\\dagger H_\\text{d,diag}R)^\\text{rwa}$ are as defined by the above cases.\n\n## Pauli coefficients\nThe full set of Pauli coefficients of the form $A \\otimes B$ for $A \\in \\{I,Z\\}$ and $B \\in \\{I,X,Y,Z\\}$ are given below.\n$$\n\n\\frac{IX}{2}_\\text{coeff} &=-\\frac{J\n\\Omega}{\\Delta+\\delta_1}\n+ \\frac{\\Delta \\delta_1 J \\Omega^3}{(\\Delta+\\delta_1)^3 (2\n\\Delta+\\delta_1) (2 \\Delta+3 \\delta_1)},\\nonumber\n\n$$\n$$\n\n\\frac{IY}{2}_\\text{coeff} &=0,\\nonumber\n\n$$\n$$\n\n\\frac{IZ}{2}_\\text{coeff} &= \\frac{J^2 \\Omega^2}{2} \\Bigg(\\frac{\\delta_1^3-2 \\delta_1\n\\Delta^2-2 \\Delta^3}{\\delta_1 \\Delta^2\n(\\delta_1+\\Delta)^2 (\\Delta-\\delta_2)}+\\frac{\\delta_1^2+\\Delta^2}{\\Delta^2\n\\delta_2 (\\delta_1+\\Delta)^2}\\nonumber \\\\\n&+\\frac{6 \\text{$\\delta\n$1}^5+4 \\delta_1^4 \\Delta-6 \\delta_1^3 \\Delta^2+7 \\delta_1^2 \\Delta^3+12 \\delta_1 \\Delta^4+4 \\Delta^5}{\\Delta^2 (\\delta_1+\\Delta)^2 (2 \\delta_1+\\Delta)^2 (\\delta_1+2 \\Delta) (3 \\delta_1+2 \\Delta)}\\nonumber \\\\\n&+\\frac{2}{\\delta_1\n(\\delta_1+\\Delta) (\\delta_1+\\Delta-\\delta_2)} \\nonumber \\\\\n&+\\frac{2}{(\\delta_1+\\Delta)\n(\\delta_1+\\Delta-\\delta_2)^2}+\\frac{1}{\\Delta (\\Delta-\\delta_2)^2}\\Bigg),\\nonumber\n\n$$\n$$\n\n\\frac{ZI}{2}_\\text{coeff} &=-\\frac{\\delta_1 \\Omega ^2}{2\\Delta (\\delta_1+\\Delta)} \\nonumber \\\\\n&+ \\frac{J^2 \\Omega ^2}{2\n(\\delta_1+\\Delta)^3} \\Bigg(\\frac{2 \\left(\\delta_1^2+\\delta_1\n\\Delta+\\Delta^2\\right) (\\delta_1+\\Delta)}{\\delta_1 \\Delta (\\delta_2-\\Delta)}\\nonumber \\\\\n&+\\frac{1}{2} \\delta_1 \\Big(\\frac{4 \\delta_1^2}{\\Delta^3}+\\frac{11 \\delta_1}{\\Delta^2}+\\frac{3 \\delta_1}{(2 \\delta_1+\\Delta)^2} \\nonumber \\\\\n&- \\frac{2}{\\delta_1+2\n\\Delta}-\\frac{6}{3 \\delta_1+2 \\Delta}+\\frac{12}{\\Delta}\\Big)\\nonumber \\\\\n&+\\frac{2 (\\delta_1+\\Delta)^2}{\\delta_1 (\\delta_1+\\Delta-\\delta_2)}+\\frac{2 (\\delta_1+\\Delta)^2}{(\\delta_1+\\Delta-\\delta_2)^2}-\\frac{2 \\delta_1 (\\delta_1+\\Delta)}{\\Delta \\delta_2}\\Bigg),\\nonumber\n\n$$\n$$\n\n\\frac{ZX}{2}_\\text{coeff} &= -\\frac{J\\Omega}{\\Delta}\\left(\\frac{\\delta_1}{\\delta_1+\\Delta}\\right) \\nonumber \\\\\n&+ \\frac{ J\\Omega^3 \\delta_1^2 (3 \\delta_1^3 + 11 \\delta_1^2 \\Delta + 15 \\delta_1 \\Delta^2 + 9 \\Delta^3)\n}{ 2\\Delta^3 (\\delta1 + \\Delta)^3 (\\delta_1 + 2 \\Delta)(3 \\delta_1 + 2 \\Delta)},\\nonumber\n\n$$\n$$\n\n\\frac{ZY}{2}_\\text{coeff} &=0,\\nonumber\n\n$$\n$$\n\n\\frac{ZZ}{2}_\\text{coeff} &=\\frac{J^2}{2 (\\delta_1+\\Delta)^2} \\Bigg(\\Omega^2 \\Bigg(\\frac{\\delta_1^3-2 \\delta_1\n\\Delta^2-2 \\Delta^3}{\\delta_1 \\Delta^2\n(\\delta_2-\\Delta)} \\nonumber \\\\\n&+\\frac{1}{2} \\left(\\frac{4 (3 \\delta_1+\\Delta) \\left(\\delta_1^2+\\delta_1 \\Delta+\\Delta^2\\right)}{\\Delta^2 (2 \\delta_1+\\Delta)^2}-\\frac{16 \\Delta}{3 \\delta_1^2+8\n\\delta_1 \\Delta+4 \\Delta^2}\\right)\\nonumber \\\\\n&+\\frac{2\n\\delta_1}{\\Delta \\delta_2}-\\frac{2 (\\delta_1+\\Delta)}{(\\delta_1+\\Delta-\\delta_2)^2}-\\frac{2 (\\delta_1+\\Delta)}{\\delta_1\n(\\delta_1+\\Delta-\\delta_2)}\\Bigg) \\nonumber \\\\\n&+\\frac{2\n(\\delta_1+\\Delta) (\\delta_1+\\delta_2)}{\\Delta-\\delta_2}\\Bigg).\\nonumber\n\n$$\n\n10\n\nDennis2002\nE.\u00a0Dennis et\u00a0al., Journal of Mathematical Physics 43, 4452 (2002).\n\nHarrington2007\nR.\u00a0Raussendorf and J.\u00a0Harrington, Phys. Rev. Lett. 98, 190504 (2007).\n\nParaoanu\nG.\u00a0S. Paraoanu, Phys. Rev. B 74, 140504 (2006).\n\nRigetti10\nC.\u00a0Rigetti and M.\u00a0Devoret, Phys. Rev. B 81, 134507 (2010).\n\nGambetta2017\nJ.\u00a0M. Gambetta, J.\u00a0M. Chow, and M.\u00a0Steffen, Nat. Phys. JQI 3, 2\n(2017).\n\nSheldon2016\nS.\u00a0Sheldon et\u00a0al., Phys. Rev. A 93, 060302 (2016).\n\nChow2014\nJ.\u00a0M. Chow et\u00a0al., Nat. Comm. 5, 4015 (2014).\n\nCorcoles2015\nA.\u00a0D. C\u00f3rcoles et\u00a0al., Nat. Comm. 6, 6979 (2015).\n\nTakita2016\nM.\u00a0Takita et\u00a0al., Phys. Rev. Lett. 117, 210505 (2016).\n\nTakita2017\nM.\u00a0Takita et\u00a0al., Phys. Rev. Lett. 119, 180501 (2017).\n\nSW\nJ.\u00a0R. Schrieffer and P.\u00a0A. Wolff, Phys. Rev. 149, 491 (1966).\n\nBravyi11\nS.\u00a0Bravyi, D.\u00a0DiVincenzo, and D.\u00a0Loss, Ann. Phys. 326, 2793 (2011).\n\nBornOpp\nM.\u00a0Born and R.\u00a0Oppenheimer, Annalen der Physik 389, 457 (1927).\n\nCederbaum\nL.\u00a0S. Cederbaum, J.\u00a0Schirmer, and H.\u00a0D. Meyer, Journal of Physics A:\nMathematical and General 22, 2427 (1989).\n\nBHW04\nA.\u00a0Blais et\u00a0al., Phys. Rev. A 69, 062320 (2004).\n\nKoch07\nJ.\u00a0Koch et\u00a0al., Phys. Rev. A 76, 042319 (2007).\n\n"}
{"prompt": "What are the key contributions of the paper 'Demonstration of Two-Qubit Algorithms with a Superconducting Quantum Processor'?", "completion": "\n\nnaturemag\nnature\n\n# Demonstration of Two-Qubit Algorithms with a Superconducting Quantum Processor\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartment of Physics and Astronomy and Institute for Quantum Computing, University of Waterloo, Waterloo, Ontario N2L 3G1, Canada\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nAtominstitut der \u00d6sterreichischen Universit\u00e4ten, TU-Wien, A-1020 Vienna, Austria\n\nD\u00e9partement de Physique, Universit\u00e9 de Sherbrooke, Sherbrooke, Qu\u00e9bec J1K 2R1, Canada\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nDepartments of Physics and Applied Physics, Yale University, New Haven, CT 06511, USA\n\nBy harnessing the superposition and entanglement of physical states, quantum computers could outperform\ntheir classical counterparts in solving problems of technological impact, such as factoring large numbers and searching databases\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. A quantum processor executes algorithms by applying a programmable sequence of gates to an initialized register of qubits, which coherently evolves into a final state containing the result of the computation. Simultaneously meeting the conflicting requirements of long coherence, state preparation, universal gate operations, and qubit readout makes building quantum processors challenging.\nFew-qubit processors have already been shown in nuclear magnetic resonance\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], cold ion trap\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and optical\u00a0[Unknown Author, \"Unknown Title\", ] systems, but a solid-state realization has remained an outstanding challenge.\nHere we demonstrate a two-qubit superconducting processor and the implementation of the Grover search\u00a0[Unknown Author, \"Unknown Title\", ] and Deutsch\u2013Jozsa\u00a0[Unknown Author, \"Unknown Title\", ] quantum algorithms. We employ a novel two-qubit interaction, tunable in strength by two orders of magnitude on nanosecond time scales, which is mediated by a cavity bus in a circuit quantum electrodynamics (cQED) architecture\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThis interaction allows generation of highly-entangled states with concurrence up to $\\mathbf{94}\\boldsymbol{\\%}$.\nAlthough this processor constitutes an important step in quantum computing with integrated circuits, continuing efforts to increase qubit coherence times, gate performance and register size will be required to fulfill the promise of a scalable technology.\n\nOver the last decade, superconducting circuits\u00a0[Unknown Author, \"Unknown Title\", ] have made considerable progress on all the\nrequirements necessary for an electrically-controlled, solid-state quantum computer.\nCoherence times\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]  have risen by three orders of magnitude to $\\sim 1\\,\\us$, single-qubit gates\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] have reached error rates of\n$1\\%$, engineered interactions\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] have produced two-qubit entanglement at a level of $60\\%$ concurrence\u00a0[Unknown Author, \"Unknown Title\", ], and qubit readout\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has attained measurement fidelities $\\sim 90\\%$. However, combining these achievements in a single device\nremains challenging. One approach to integration is the quantum bus architecture\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], which uses an on-chip transmission line cavity to couple, control, and measure qubits.  We augment the architecture in Ref.\u00a0Majer07 with flux-bias lines that tune individual qubit frequencies, permitting single-qubit phase gates.\nBy pulsing the qubit frequencies to an avoided crossing where a $\\sigma_{z}\\otimes\\sigma_{z}$ interaction turns on, we are able to realize a two-qubit conditional phase (c-Phase) gate. Operation in the strong-dispersive regime\u00a0[Unknown Author, \"Unknown Title\", ] of cQED allows joint readout\u00a0[Unknown Author, \"Unknown Title\", ] that can efficiently detect two-qubit correlations. Combined with single-qubit rotations, this enables tomography of the two-qubit state. Through an improved understanding of spontaneous emission\u00a0[Unknown Author, \"Unknown Title\", ] and careful microwave engineering, we are now able to combine state-of-the-art $\\sim1\\,\\us$ coherence times into a two-qubit device. This allows sufficient time to concatenate $\\sim10$ gates, realizing simple algorithms with fidelity greater than\n$80\\%$.\n\nOur processor, shown in Fig.\u00a0(Figure fig:fig1)a, is a 4-port superconducting device comprising two transmon qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] ($\\QL$ and $\\QR$) inside a microwave cavity bus, and flux-bias lines proximal to each qubit. The cavity, normally off-resonance with the qubit transition frequencies $\\FreqL$ and $\\FreqR$, couples the qubits by virtual photon exchange and shields them from the electromagnetic continuum. As previously demonstrated\u00a0[Unknown Author, \"Unknown Title\", ],  microwave pulses resonant with $\\FreqL$ or $\\FreqR$ applied to the cavity input port provide frequency-multiplexed single-qubit $x$- and $y$-rotations with high fidelity\u00a0[Unknown Author, \"Unknown Title\", ] and selectivity. Pulsed measurement of the homodyne voltage $\\VH$ on the output port of the cavity provides qubit readout. The remaining two ports create local magnetic fields that tune the qubit transition frequencies. Each qubit has a split Josephson junction, so its frequency depends on the flux $\\Phi$ through the loop according to $ h f \\approx \\sqrt{8\\EC^{\\vphantom{m}}\\EJmax \\lvert \\cos(\\Phi/\\Phi_0)|}-\\EC$, where $\\EC$ is the charging energy, $\\EJmax$ is the maximum Josephson energy, $h$ is Planck's constant, and $\\Phi_0$ is the flux quantum.\nBy employing short-circuited transmission lines with a bandwidth from dc to $2\\,\\GHz$, we\ncan tune $\\FreqL$ and $\\FreqR$ by many $\\GHz$ using room temperature voltages $\\VL$ and $\\VR$.\nStatic tuning of qubit transitions using the flux-bias lines is demonstrated in Fig.\u00a0(Figure fig:fig1)b.\n\n< g r a p h i c s >\n\nTwo-qubit cQED device, and cavity/qubit characterization.\na,\u00a0Optical micrograph of 4-port device with a coplanar waveguide cavity  bus coupling two transmon qubits (insets), and local flux-bias lines providing fast qubit tuning. Microwave pulses at the qubit transition frequencies $\\FreqL$ and $\\FreqR$ drive single-qubit rotations, and\na pulsed measurement of the cavity homodyne voltage $\\VH$ (at frequency $\\FC$) provides two-qubit readout.\nThe flux-bias lines (bottom-left and top-right ports)  are coplanar waveguides with short-circuit termination next to their target qubit. The termination geometry allows current on the line\nto couple flux through the split junctions (b, inset). b,\u00a0Grey scale images of cavity transmission and of qubit spectroscopy as a function of $\\VR$, showing local tuning of $\\QR$ across the avoided crossing  with $\\QL$ (point\u00a0III) and across the vacuum Rabi splitting with the cavity (point\u00a0IV).\nSemi-transparent lines are theoretical best fits obtained from numerical diagonalization of a generalized Tavis\u2013Cummings Hamiltonian\u00a0[Unknown Author, \"Unknown Title\", ].\nPoints\u00a0I and\u00a0II are the operating points of the processor. Preparation, single-qubit operations and measurements are performed at point\u00a0I, and a c-Phase gate is achieved by pulsing into point\u00a0II.\n\nThe spectrum of single excitations (Fig.\u00a0(Figure fig:fig1)b) shows the essential features of the cavity-coupled two-qubit Hamiltonian and allows a determination of the relevant system parameters (see Methods). When the qubits are tuned to their maximum frequencies, point\u00a0I, they are far detuned from the cavity and from each other, so that interactions are small.\nThis point is therefore used for state preparation, single-qubit rotations and measurement, in the computational\nbasis $\\ket{0,0}$, $\\ket{0,1}$, $\\ket{1,0}$, and $\\ket{1,1}$,  where $\\ket{l,r}$ denotes excitation level $l$ ($r$) for $\\QL$ ($\\QR$).\nOperation at this point is also desirable because it is a flux sweet spot\u00a0[Unknown Author, \"Unknown Title\", ] for both qubits, providing\nlong coherence, with relaxation and dephasing times $T_{1,\\mathrm{L(R)}}=1.3 (0.8)\\,\\us$ and\n$T_{2,\\mathrm{L(R)}}^{\\ast}=1.8 (1.2)\\,\\us$, respectively. Tuning $\\QR$ into resonance with the cavity, point\u00a0IV,\nreveals a vacuum Rabi splitting\u00a0[Unknown Author, \"Unknown Title\", ] from which the qubit-cavity interaction strength is extracted.\nTuning $\\QR$ into resonance with $\\QL$, point\u00a0III, shows an avoided crossing resulting from a cavity-mediated, qubit-qubit transverse interaction\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] investigated previously\u00a0[Unknown Author, \"Unknown Title\", ]. In this work, we perform two-qubit gates at point\u00a0II, where no interactions are immediately apparent on examining the one-excitation manifold.=-1\n\nHowever, a useful two-qubit interaction is revealed in the two-excitation spectrum, shown in Fig.\u00a0(Figure fig:fig2)a.\nAs $\\VR$ is swept away from point\u00a0I, the non-computational higher-level transmon excitation $\\ket{0,2}$\ndecreases more rapidly than the computational state $\\ket{1,1}$, and these states would become degenerate at point\u00a0II.\nBut as shown in Fig.\u00a0(Figure fig:fig2)b, there is a large $(160\\,\\MHz)$ cavity-mediated interaction between these levels, producing a frequency shift $\\zeta/2\\pi$ of the lower branch with respect to the sum $\\FreqL+\\FreqR$, in good agreement with a numerical diagonalization of the generalized Tavis\u2013Cummings Hamiltonian\u00a0[Unknown Author, \"Unknown Title\", ] (see Methods).\n\n< g r a p h i c s >\n\nOrigin and characterization of the controlled-phase gate.\na,\u00a0Flux dependence of transition\nfrequencies from the ground state $\\ket{0,0}$ to the two-excitation\nmanifold. Spectroscopy measurements (points) show an avoided crossing between the  computational\nstate  $\\ket{1,1}$ and the non-computational state $\\ket{0,2}$ at point\u00a0II, in good agreement with numerical diagonalization of the Hamiltonian (dashed curves).\nb, This avoided crossing causes the transition frequency to $\\ket{1,1}$ to deviate from the sum of the transition frequencies\nto $\\ket{0,1}$ and $\\ket{1,0}$. c,\u00a0The coupling strength $\\zeta/2\\pi = f_{01}+f_{10}-f_{11} $ of the effective $\\sigma_{z}^{\\mathrm{L}} \\otimes \\sigma_{z}^{\\mathrm{R}}$ interaction, obtained both from spectroscopy (solid curve) and from time-domain experiments (points) (see text for details).\nNumerical diagonalization and perturbation theory (Supplementary Information) for 3-level transmons\nagree reasonably with data. The perturbation calculation diverges at the avoided crossing.\nPerturbation theory for 2-level qubits gives the wrong magnitude and sign for $\\zeta$,\nand demonstrates that the higher transmon excitations are necessary for the interaction.\nTime-domain measurement and theory both give $\\zeta/2\\pi\\simeq 1.2\\,\\MHz$ at point\u00a0I.\nThe tunability of $\\zeta$ over two orders of magnitude  provides an excellent on-off ratio for the c-Phase gate.\n\nThis shift is the mechanism at the heart of our\nconditional phase gate. Flux pulses, adiabatic with respect to the $\\ket{1,1}\\leftrightarrow\\ket{0,2}$ avoided crossing, produce phase gates\n\nU=[       1       0       0       0;       0 e^i\u03d5_01       0       0;       0       0 e^i\u03d5_10       0;       0       0       0 e^i\u03d5_11 ]\n\nin the computational Hilbert space. Here, $\\phi_{lr}=2\\pi \\int\\delta\\!f_{lr}(t)\\,\\mathrm{d}t$ is the dynamical phase acquired by $\\ket{l,r}$, and\n$\\delta\\!f_{lr}$ is the deviation of $f_{lr}$ from its value at point\u00a0I. A $\\VR$ pulse into point\u00a0II\nsuch that $\\int\\zeta(t)\\, \\mathrm{d}t=(2 n +1)\\pi$ with integer $n$ implements a c-Phase, because\n$\\phi_{11}=\\phi_{01}+\\phi_{10}-\\int\\zeta(t)\\,\\mathrm{d}t$.\nThis method of realizing a c-Phase by adiabatically using the avoided crossing between computational and non-computational states\nis generally applicable to any qubit implementation with finite anharmonicity, such as transmons\u00a0[Unknown Author, \"Unknown Title\", ] or phase qubits\u00a0[Unknown Author, \"Unknown Title\", ].\nA similar approach involving higher excitation levels but with non-adiabatic pulses was previously proposed\u00a0[Unknown Author, \"Unknown Title\", ].\nThe negative anharmonicity permits the phase gate at point\u00a0II to occur before the onset of transverse coupling\nat point\u00a0III.\n\nControl of $\\zeta$ by two orders of magnitude provides an excellent on-off ratio for the c-Phase gate. As shown in Fig.\u00a0(Figure fig:fig2)c, measurements of $\\zeta$ obtained from  spectroscopy and from time-domain experiments show very good agreement. The time-domain method measures the  difference in the precession frequency of $\\QL$  in two Ramsey-style experiments where a $\\VR$-pulse of varying duration ($0$\u2013$100\\,\\ns$) is  inserted between $\\pi/2$ rotations of $\\QL$,  with $\\QR$ either in the ground state $\\vert0\\rangle$ or excited into state $\\vert1\\rangle$.\nUsing the time-domain approach, we measure a residual  $\\zeta/2\\pi\\approx1.2\\,\\MHz$ at point\u00a0I (star).  The theoretical $\\zeta$ obtained by numerical diagonalization shows reasonable agreement with the data, except for a scale factor that is likely due to higher modes of the cavity, not included in the calculation.\n\nThe controlled phase interaction allows universal two-qubit gates. As an example, we produce high-fidelity entangled states on demand (Fig.\u00a0(Figure fig:fig3)). The pulse sequence in Fig.\u00a0(Figure fig:fig3)a generates any of the four Bell states,\n\n|\u03a8^\u00b1\u27e9 = 1/\u221a(2)(|0,0\u27e9\u00b1|1,1\u27e9)   |\u03a6^\u00b1\u27e9 = 1/\u221a(2)(|0,1\u27e9\u00b1|1,0\u27e9),\n\ndepending on the choice of c-Phase gate $\\cPhij$ applied $(\\cPhij\\ket{l,r} = (-1)^{\\delta_{il}\\delta_{jr}} \\ket{l,r})$. These gates\nare realized through fine control of the dynamical phases $\\phi_{01}$ and $\\phi_{10}$ in a  $30\\,\\ns$ $\\VR$-pulse close to point\u00a0II and back.\nWe tune $\\phi_{01}$ over $2\\pi$ by making small adjustments to the rising and falling edges of the $\\VR$-pulse, and $\\phi_{10}$ with a simultaneous weak $\\VL$-pulse.\n\nTo detect the entanglement, we first reconstruct the two-qubit density matrix $\\rho$ by quantum state tomography using joint dispersive readout\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. A pulsed measurement of the cavity homodyne voltage  $\\VH$ measures the operator\n\nM=\u03b2_1\u03c3_z^L + \u03b2_2\u03c3_z^R + \u03b2_12\u03c3_z^L\u2297\u03c3_z^R,\n\nwhere the $\\sigma$ are two-qubit Pauli operators\u00a0[Unknown Author, \"Unknown Title\", ]. Operation in the\nstrong-dispersive regime\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] makes $|\\beta_{12}|\\sim |\\beta_1|, |\\beta_2|$, enhancing sensitivity to two-qubit correlations. A complete set of 15 linearly independent measurement operators is built using single-qubit rotations prior to measuring $M$. An ensemble average of each operator is obtained by executing the sequence in Fig.\u00a0(Figure fig:fig3)a  450,000 times. The 15 measured values are then input to a maximum likelihood estimator[Unknown Author, \"Unknown Title\", ] of $\\rho$ (see Supplementary Information).\n\nA[c][c][1.0]$\\Rypt$\nB[c][c][1.0]$\\cPhij$\nC[c][c][1.0]$\\Rtomo$\nD[c][c][1.0]$\\beta_1 \\sigma_{z}^{\\mathrm{L}} + \\beta_2 \\sigma_{z}^{\\mathrm{R}}$\nE[c][c][1.0]$+\\beta_{12} \\sigma_{z}^{\\mathrm{L}}\\otimes\\sigma_{z}^{\\mathrm{R}}$\nF[c][c][1.0]$|\\Psi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0,0\\rangle+|1,1\\rangle\\right)$\nG[c][c][1.0]$|\\Psi^{-}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0,0\\rangle-|1,1\\rangle\\right)$\nH[c][c][1.0]$|\\Phi^{+}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0,1\\rangle+|1,0\\rangle\\right)$\nJ[c][c][1.0]$|\\Phi^{-}\\rangle = \\frac{1}{\\sqrt{2}}\\left(|0,1\\rangle-|1,0\\rangle\\right)$\n\n< g r a p h i c s >\n\nEntanglement on demand.\na,\u00a0Gate sequence generating two-qubit entanglement and detection via quantum state\ntomography. Starting from $\\ket{0,0}$, simultaneous $\\pi/2$ rotations on both qubits create an equal superposition of the four computational states. A c-Phase $\\cPhij$ then phase shifts $\\ket{i,j}$ in the superposition and  produces entanglement. A final $\\pi/2$ rotation on $\\QL$ evolves the entangled state into one of the four Bell states depending on the $\\cPhij$ applied.\nb\u2013e,\u00a0 Real part of maximum-likelihood density matrix $\\rhoML$ of the entangler output for\n$\\cPhtw$, $\\cPhz$, $\\cPhth$, and $\\cPho$, respectively (imaginary elements of $\\rhoML$ are less than 0.03, 0.02, 0.07, 0.08).\nExtracted metrics for the four entangler outputs include purity $P=0.87\\pm0.02,0.92\\pm0.02 ,0.88\\pm0.02 ,0.79\\pm0.03$, fidelity to the ideal Bell state $F=0.91\\pm0.01, 0.94\\pm0.01, 0.90\\pm0.01, 0.87\\pm0.02$ and concurrence $C=0.88\\pm0.02, 0.94\\pm0.01, 0.86\\pm0.02, 0.81\\pm0.04$. The uncertainties correspond to the standard deviation in 16 repetitions of generation-tomography for each entangler.\n\nThe inferred density matrices $\\rhoML$  reveal highly-entangled states in all four cases (Fig.\u00a0(Figure fig:fig3)b\u2013e).\nWe quantify performance using the metrics of  purity, $P(\\rho)=\\tr(\\rho^2)$, fidelity to the target state $\\ket{\\psi}$,\n$F(\\rho,\\psi)= \\langle \\psi | \\rho | \\psi \\rangle$,\nand concurrence\u00a0[Unknown Author, \"Unknown Title\", ], $C$, computable from $\\rhoML$.\nNote that there are several common definitions of fidelity in the literature, and our definition is the square of the fidelity used in Refs.\u00a0Steffen06 and Filipp08. Values for $P$, $F$ and $C$ for the\nfour cases are given in the caption to Fig.\u00a0(Figure fig:fig3).  These values significantly extend the current state of the art for solid-state entanglement\u00a0[Unknown Author, \"Unknown Title\", ], and provide evidence that we have a high-fidelity universal set of two-qubit gates.\n\nOne- and two-qubit gates can be concatenated to realize simple algorithms, such as Grover's quantum search\u00a0[Unknown Author, \"Unknown Title\", ] shown in Fig.\u00a0(Figure fig:fig4). Given a function $f(x)$ on the set $x\\in\\{0,1,2,3\\}$ such that $f(x)=1$ except at some $x_0$, where $f(x_0)=-1$, this well-known algorithm can determine $x_0=2i+j$ with a single call of an oracle $O=\\cPhij$, which encodes $f(x)$ in a quantum phase.\n\nWe can examine the functioning of the algorithm by interrupting it after each step and performing state tomography. Figure\u00a0(Figure fig:fig4)b\u2013g clearly shows all the features of a quantum processor, namely the use of maximally superposed states to exploit quantum parallelism (Fig.\u00a0(Figure fig:fig4)c), the encoding of information in the entanglement between qubits (Fig.\u00a0(Figure fig:fig4)d,\u00a0e), and the interference producing an answer represented in a final computational basis state. The fidelity of the final state (Fig.\u00a0(Figure fig:fig4)g) to the expected output ($\\ket{1,0}$ for the case  $O=\\cPhtw$ shown) is $85\\%$. Similar performance is obtained for the other three oracles (Table\u00a0(Table tab:summary)).=-1\n\nWe have also programmed and executed the Deutsch\u2013Jozsa algorithm\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The two-qubit version of this algorithm determines whether an unknown function $f_i(x)$, mapping a one-bit input to a one-bit output, is constant ($f_0(x)=0$ or $f_1(x)=1$) or balanced ($f_2(x)=x$ or $f_3(x)=1-x$), doing so with a single call of the function. The algorithm applies the function once to a superposition of the two possible inputs and employs the concept of quantum phase kick-back\u00a0[Unknown Author, \"Unknown Title\", ] to encode the result in the final state of one qubit (here, $\\QL$) while leaving the other untouched ($\\QR$). The gate sequence realizing the algorithm and the output tomographs for the four cases are shown in\nSupplementary Fig.\u00a0S1.\n\nThe performance of both algorithms is summarized in Table\u00a0(Table tab:summary). Although there are undoubtedly significant systematic errors remaining, the overall fidelity is nonetheless similar to that expected from the ratio $(\\sim100\\,\\ns/1\\,\\us)$ of the total duration of gate sequences to the qubit coherence times.\n\nIn summary, we have demonstrated the experimental realization of two-qubit quantum algorithms using a superconducting circuit.\nThe incorporation of local flux control and joint-dispersive readout into cQED, together with a ten-fold increase in\nqubit coherence over previous two-qubit devices, has enabled on-demand generation and detection of entanglement and the\nimplementation of the Grover and Deutsch\u2013Jozsa algorithms. Superconducting circuits could eventually perform more complex quantum algorithms on many qubits, provided that coherence lifetimes and the resulting gate fidelities can be further improved.\n\nA[c][c][1.0]$\\Rypt$\nB[c][c][1.0]$\\Rypt$\nC[c][c][1.0]$O$\nD[c][c][1.0]$\\Rypt$\nE[c][c][1.0]$\\Rypt$\nF[c][c][1.0]$\\cPhz$\nG[c][c][1.0]$\\Rypt$\nH[c][c][1.0]$\\Rypt$\nJ[c][c][1.0]$\\Rtomo$\nK[c][c][1.0]$\\Rtomo$\n\n< g r a p h i c s >\n\nImplementation of Grover's search algorithm.\na, Concatenation of single-qubit and c-Phase gates implementing one iteration of Grover searching. Without loss of generality,\nwe have replaced the Walsh\u2013Hadamard transformations  $W=\\Rxp\\Rypt$ in the usual description of the algorithm\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nwith $\\Rypt$ rotations in order to eliminate 6 single-qubit rotations and complete the sequence in $104\\,\\ns$. (Supplementary Fig.\u00a0S3 shows\nthe microwave and flux pulses implementing the sequence.)\nThe orange box is the oracle $O=\\cPhij$ that encodes the solution $x_0=2i+j$ to the search problem in a quantum phase. Note that the first half of the algorithm is identical to the entangling sequence in Fig.\u00a0(Figure fig:fig3), while the second half is essentially its mirror image.\nb\u2013g, Real part of $\\rhoML$ obtained by state tomography after each  step of the algorithm with oracle $O=\\cPhtw$.\nStarting from $\\ket{0,0}$ (b), the qubits are simultaneously rotated into a maximal superposition state (c). The oracle then marks\nthe solution, $\\ket{1,0}$, by inverting its phase (d). The $\\Rypt$ rotation on $\\QL$ turns the state into the Bell state $\\lvert\\Psi^\n+\\rangle$, demonstrating that the state is highly entangled at this stage. The $\\Rypt$ rotation on $\\QR$ produces a state identical to (d) (data not shown). The application of $\\cPhz$ undoes the entanglement, producing a  maximal superposition state (f). The final rotations yield an output state (g) with fidelity $F=85\\%$ to the correct answer, $\\ket{1,0}$.\n\n## Methods\n### Device fabrication\nA $180\\,\\nm$ film of Nb was dc-magnetron sputtered on the epi-polished surface of an R-plane corundum ($\\alpha$-$\\Sapphire$) wafer (2\" diameter, $430\\,\\um$ thickness). Coplanar waveguide structures (cavity and flux-bias lines) were  patterned by optical lithography and\nfluorine-based reactive ion etching of Nb.  Transmon features (interdigitated capacitors and split junctions) were patterned on individual\n$2\\, \\mm \\times7\\,\\mm$ chips using electron-beam lithography,  double angle evaporation of Al ($20/90\\,\\nm$) with intermediate oxidation\n($15\\%\\,\\mathrm{O}_2$ in Ar at $15\\,\\mathrm{Torr}$ for $12\\,\\mathrm{min}$), and lift-off.\n\nA completed device was cooled to $13\\,\\mK$ in a $\\Hethree$-$\\Hefour$ dilution refrigerator.\nA diagram of the refrigerator wiring is shown in Supplementary Fig.\u00a0S2.\nCareful microwave engineering of the sample holder and on-chip wirebonding\nacross ground planes were required to suppress spurious resonance modes on- and off-chip.\nSimulations using $\\mathrm{Sonnet}^\\circledR$ software provided guidance with this iterative process.\nThe sample was enclosed in two layers of Cryoperm magnetic shielding, allowing high-fidelity operation of the processor during\nunattended overnight runs.\n\nSummary of algorithmic performance.\n\n< g r a p h i c s >\n\nFidelity of the reconstructed output states of the Grover and Deutsch\u2013Jozsa algorithms to their ideal outputs. These results suggest that, if combined with single-shot readout, the two algorithms executed with this processor would give the correct answer with probability far exceeding the $50\\%$ success probability of the best classical algorithms limited to single calls of the oracle\u00a0[Unknown Author, \"Unknown Title\", ] or function.\n\n### cQED Theory\nThe Tavis-Cummings\u00a0[Unknown Author, \"Unknown Title\", ] Hamiltonian generalized to multi-level transmon qubits\u00a0[Unknown Author, \"Unknown Title\", ] is\n$$\n\n\\label{eq:Ham}\nH &=&\\wcav a^{\\dag}a + \\\\\n& &\\sum_{q\\in\\{\\!\\mathrm{L},\\mathrm{R}\\!\\}} \\Bigl( \\sum_{j=0}^{N} \\omega_{0j}^q \\lvert j\\rangle_q\\langle j\\rvert_q + (a+a^{\\dag}) \\!\\!\\sum_{j,k=0}^{N} g_{jk}^{q}\\lvert j\\rangle_q\\langle k\\rvert_q \\Bigr). \\nonumber\n\n$$\nHere, $\\wcav$ is the bare cavity frequency, $\\omega^q_{0j}=\\omega_{0j}(\\ECq, \\EJq)$  is the transition frequency for qubit $q$ from ground to excited state $j$, and $g_{jk}^q=g_q n_{jk}(\\ECq, \\EJq)$, with  $g_q$ a bare qubit-cavity coupling and $n_{jk}$ a level-dependent coupling matrix element. The dependence of these parameters on qubit charging energy $\\ECq$ and Josephson energy $\\EJq$ is indicated. The flux control enters through $\\EJq=\\EJqmax\\lvert\\cos(\\pi\\Phi_q/\\Phi_0)\\rvert$, with  $\\Phi_q$ the flux through the qubit loop, and a linear flux-voltage relation $\\Phi_q=\\alpha_{q\\mathrm{L}} \\VL + \\alpha_{q\\mathrm{R}}\\VR +\\Phi_{q,0}$, accounting for crosstalk ($\\sim30\\%$) and offsets. The above parameters are tightly constrained by the combination of spectroscopy and transmission data shown (Figs.\u00a0(Figure fig:fig1)b, (Figure fig:fig2)a and (Figure fig:fig2)b) and transmission data (not shown) for the $\\QL$-cavity vacuum Rabi splitting. By simultaneously fitting the spectra given by numerical diagonalization of the Hamiltonian (truncated to  $N=5$ qubit levels and 5 cavity photons) to these data, we obtain $E_{\\mathrm{JL(R)}}^{\\mathrm{max}}/h= 28.48\\,(42.34)\\,\\GHz$, $E_{\\mathrm{CL(R)}}/h= 317\\,(297)\\,\\MHz$,  $g_{\\mathrm{L(R)}}/2\\pi = 199\\,(183)\\,\\MHz$,\nand $\\wcavontpi = 6.902\\,\\GHz$. The cavity linewidth is $\\kappa/2\\pi = 1\\,\\MHz$.=-1\n\nAcknowledgements We thank V.\u00a0Manucharyan and E.\u00a0Boaknin for experimental contributions,\nand M.\u00a0H.\u00a0Devoret, I.\u00a0L.\u00a0Chuang and A.\u00a0Nunnenkamp for discussions.\nThis work was supported by LPS/NSA under ARO Contract No. W911NF-05-1-0365,\nand by the NSF under Grants No. DMR-0653377 and No. DMR-0603369.\nWe acknowledge additional support from CIFAR, MRI, MITACS, and NSERC (JMG),\nNSERC, CIFAR, and the Alfred\u00a0P.\u00a0Sloan Foundation (AB), and\nfrom CNR-Istituto di Cibernetica, Pozzuoli, Italy (LF).\n\n"}
{"prompt": "What are the main findings of the paper 'Microwave-activated conditional-phase gate for superconducting qubits'?", "completion": "\n\n4pt\n4pt\n\n# Microwave-activated conditional-phase gate for superconducting qubits\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nIBM T.J. Watson Research Center, Yorktown Heights, NY 10598, USA\n\nWe introduce a new entangling gate between two fixed-frequency qubits statically coupled via a microwave resonator bus which combines the following desirable qualities: all-microwave control, appreciable qubit separation for reduction of crosstalk and leakage errors, and the ability to function as a two-qubit conditional-phase gate. A fixed, always-on interaction is explicitly designed between higher energy (non-computational) states of two transmon qubits, and then a conditional-phase gate is `activated' on the otherwise unperturbed qubit subspace via a microwave drive. We implement this microwave-activated conditional-phase gate with a fidelity from quantum process tomography of $\\sim 87\\%$.\n\n03.67.Ac, 42.50.Pq, 85.25.-j\n\nSuperconducting qubits are a prime candidate for scaling towards larger quantum processors. Improvements to coherence times for Josephson junction-based qubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] have made possible high-fidelity universal gates as well as the characterization of gate verification and validation methods\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. As systems evolve towards quantum error-correction architectures such as the two-dimensional surface code [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], it is increasingly important to devise and characterize different entangling gate schemes to determine suitability for large-scale implementations.\n\nThere have been multiple incarnations of universal entangling two-qubit gates for superconducting qubits, whether as $i\\text{SWAP}$, controlled-NOT (CNOT), or conditional-Phase (c-Phase), each with their own set of advantages and disadvantages. One class of gates include all of those which rely on the dynamical flux-tunability of either the underlying qubits, or some separate  sub-circuit. This includes the direct-resonant $i\\text{SWAP}$ (DRi) \u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the higher-level resonance induced dynamical c-Phase (DP) [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and any variant gates induced via a dynamic tunable coupling [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Another class of gates contains all those in which the qubits have fixed-frequencies, and only a microwave-modulated passive coupling in place either directly or via a coupling circuit such as a resonator bus\u00a0[Unknown Author, \"Unknown Title\", ]. The gates in this class include the resonator sideband induced $i\\text{SWAP}$ (RSi)\u00a0[Unknown Author, \"Unknown Title\", ], the cross-resonance (CR) gate which generates a CNOT [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the Bell-Rabi (BR) single-step entanglement gate [Unknown Author, \"Unknown Title\", ], the wait c-Phase (WP) gate from an always on $ZZ$ interaction\u00a0[Unknown Author, \"Unknown Title\", ], and the driven resonator induced c-Phase (RIP)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe primary advantage of the dynamically tunable class of gates (DRi and DP) is the ability to operate the qubits in very different regimes: one in which the qubits are independent with negligible interaction, and one where the two-qubit interaction is maximized. In the first regime, single-qubit gates can be applied trivially without the need for specialized decoupling schemes as the qubits will not experience significant crosstalk errors. In the second regime, the qubits can be tuned to optimize the two-qubit interaction so as to enable the shortest possible gate times. This means simple single-qubit gates, the possibility of strong two-qubit interactions, and low crosstalk errors are enabled by DRi and DP. The main disadvantages of such gates are the reliance on flux-tunable qubits, which can have reduced coherence times due to flux-noise\u00a0[Unknown Author, \"Unknown Title\", ], the risk of interacting with other energy levels in the system during tuning, and additional circuit and control complexity due to on-chip tunable flux controls or couplers which support dynamical tunability.\n\n< g r a p h i c s >\n\n(color online)\u00a0Level diagram and two-qubit Rabi amplitude spectroscopy. (a) Representative two-transmon energy ladder up to the three-excitation manifold. An interaction of strength $\\sqrt{3}J$ between the $\\ket{12}$ and $\\ket{03}$ levels (upper right pink shaded box) gives rise to the MAP interaction, as it causes the energy difference between $\\ket{11}$ and $\\ket{12}$, denoted $E_B$, to be different from the energy difference between $\\ket{01}$ and $\\ket{02}$, denoted $E_A$. An off-resonant drive tone from $E_A$ will then result in a different phase on the $\\ket{11}$ state relative to the other states in the computational basis states shaded in grey. (b) Density plot of Rabi amplitude spectroscopy. By varying the amplitude of a Rabi drive pulse and sweeping over frequency, it becomes possible to identify the full two-transmon energy landscape in cavity transmission. Starting from the right at higher frequencies and sweeping left, first the $f_{01}$=5.68 GHz transition of Q2 is encountered, which has a linear fringing pattern with increasing drive amplitude, subsequently followed by multi-photon transitions to the higher levels of Q2. Around 5.18 GHz, the $f_{01}$ of Q1 is observed, and it happens to overlap closely to the $f_{05}/5$ 5-photon transition of Q2. This observed resonance for these transmons which have identical anharmonicities, satisfies the condition necessary to observe the MAP interaction (exercise left for the reader).\n\nFor the case of the microwave two-qubit gates listed above, the qubits are fixed in frequency, and thereby can be parked at `sweet-spots' of coherence or made to be un-tunable from the start. Furthermore, the addressing hardware and shaped-microwave controls become analogous to those of single-qubit gates. There is additional circuit complexity for some of the schemes, specifically the RSi and CR gates require local microwave addressability for each qubit. The most significant disadvantages for the fixed-frequency gates are tradeoffs to either coherence or single-qubit control in order to have stronger two-qubit interactions. For RSi and RIP, the two-qubit gate interaction is optimized through having stronger resonator-qubit coupling strengths, $g$. Yet, inherent to both schemes is a step in which real photons exist in the cavity, and with large $g$, this can lead to significant dephasing due to photons during the operation [Unknown Author, \"Unknown Title\", ]. As for CR, BR, and WP, the qubit-qubit detunings which would give the strongest two-qubit interaction, also happen to result in reduced single-qubit addressability, although this error can be mitigated via optimal-control schemes.\n\nIn this paper, we introduce an additional entangling gate to the lexicon of two-qubit gates: the microwave-activated c-Phase (MAP) gate. The MAP gate combines the higher-level resonant interactions introduced in the DP gate with the simple microwave controls of fixed-frequency transmons, while also permitting the transition between separate regimes for single-qubit control and two-qubit interaction, turned on or off via microwaves. The key to the MAP gate interaction lies in going beyond three levels of the transmon, and pre-defining a resonance condition in the three-excitation manifold. By designing transmons such that the $\\ket{03}$ energy transition aligns with the $\\ket{12}$ transition [$\\ket{nm}$ refers to $n$ excitations in qubit 1 (Q1) and $m$ excitations in qubit 2 (Q2)], these levels are split by the inter-qubit interaction ($\\sqrt{3}J$ in this manifold) and the degeneracy between the $\\ket{02}\\leftrightarrow \\ket{01}$ and the $\\ket{12}\\leftrightarrow \\ket{11}$ transition is removed. The net result is that an applied external drive near resonance with the $\\ket{n2}\\leftrightarrow \\ket{n1}$ transition induces a $ZZ$ interaction, much like the ac-Stark effect. Here, we implement the MAP gate on a pair of transmon qubits coupled via a resonator bus designed with a detuning so as to align the $\\ket{03}$ and $\\ket{12}$ transitions. We characterize the interaction and tune-up a c-Phase gate which is verified via quantum process tomography (QPT) with a gate fidelity of 87\n\nThe MAP scheme relies on the presence of higher levels in the two transmons, but unlike the DP gate, does not require any resonance condition between higher levels and computational states (i.e.\u00a0$\\ket{00}$, $\\ket{01}$, $\\ket{10}$, $\\ket{11}$). Rather, by careful control over the design of the transmons, through  capacitance and/or Josephson junction critical currents, it is possible to tailor the two different transmon energy spectra to experience a resonance condition involving only higher level non-computational states.\n\nIn the case where the energy corresponding to $\\ket{03}$ is aligned with the energy corresponding to $\\ket{12}$ [see level diagram of Fig.\u00a0(Figure fig:1)(a)], the interaction between the transmons will result in a splitting of these levels by $2\\xi$ where\n$$\n\n\\xi = \\frac{1}{2}\\left(\\sqrt{4J_{12,03}^2+\\Delta_{12,03}^2}+\\Delta_{12,03}\\right).\n\n$$ Here $J_{12,03}$ is the matrix element for the interaction between the 12 and 03 levels and $\\Delta_{12,03}$ is the difference between the bare energies of the 12 and 03 levels. For a transmon, $J_{12,03}$ is approximately equal to $\\sqrt{3}J$ and $\\Delta_{12,03}$ is approximately equal to $\\omega_1-\\omega_2-2\\delta_2$ where $\\omega_1$ and $\\omega_2$ are the 0-1 transition energies of the two transmons and $\\delta_2$ is the anharmonicity of the second transmon.\nAs illustrated in Fig.\u00a0(Figure fig:1)(a) the transition energies between $\\ket{11}$ and $\\ket{12}$ [labeled $E_B$] and $\\ket{01}$ and $\\ket{02}$ [labeled $E_A$] differ by an amount $\\xi$, i.e. $\\xi$ can be viewed as a conditional anharmonicity.\n\nThe basic principle of the MAP gate is to use this energy difference to induce a gate via the ac-Stark effect [Unknown Author, \"Unknown Title\", ]. The ac-Stark shift of an energy level occurs when an external drive with amplitude $\\Omega$ is nearly resonant with a transition involving that level. The level then shifts by an amount equal to the power of the external drive $\\Omega^2$ divided by the difference $\\Delta_d$ between the transition frequency and the drive frequency, provided that the ratio $\\Omega^2/\\Delta_d$ is small. At second order in perturbation theory, we find that the conditional-phase gate has a rate\n$$\n\n\\zeta=(E_{11}-E_{01}-E_{10})/\\hbar\\approx\\zeta_0+\\frac{\\Omega^2}{2\\Delta_d}\\zeta_2\n\n$$\nwhere $\\Delta_d=\\Delta_{12,11}-\\omega_d$. Here\n$$\n\n\\zeta_0 = J_{11,20}J_{11,02}\\left(\\frac{1}{\\Delta_{11,20}}+\\frac{1}{\\Delta_{11,02}}\\right)\n\n$$\nis the always-on component of the rate, and\n$$\n\n\\zeta_2 = \\frac{J_{12,03}^2}{J_{12,03}^2+\\Delta_d(\\omega_d-\\Delta_{03,11})}\n\n$$\nis the microwave-activated component.\nWhile this is a reasonable approximation in the small drive limit [see Fig.\u00a0(Figure fig:x)], we find that as the drive strength is increased numerical simulations predict a saturation of this rate. Understanding this saturation will be a topic of future research.\n\n< g r a p h i c s >\n\n(color online)\u00a0Perturbative theory. (a) At weak drive strengths (below $5$ MHz here), perturbation theory (dashed blue line) agrees with a six level numerical simulation (solid black line). Experiments are performed at higher drive strengths, where perturbation theory does not apply, and the gate rate of the numerical simulation is seen to saturate. Transition frequencies are taken from Rabi amplitude spectroscopy measurements [Fig.\u00a0(Figure fig:1)b] and drive frequencies correspond to those in Fig.\u00a0(Figure fig:3). (b) At a drive strength of $5$ MHz, the perturbation theory (dashed blue line) agrees with numerics (solid black line) if the drive frequency is sufficiently far from a transition.\n\n< g r a p h i c s >\n\n(color online)\u00a0MAP interaction tune-up. (a) Pulse protocol for the simple MAP gate tune-up, involving a standard  Ramsey-type experiment, where the phase on Q2 is observed via time-separated $X_{\\pi/2}$ pulses (gate length 40 ns), in the two cases of Q1 in ground or excited state. The MAP interaction is tuned via a microwave pulse tuned near $f_{12}$ of Q2 of varying amplitude and duration $\\Delta t$ applied on any drive line. (b) The population of the $\\ket{1}$ state for Q2, show different Ramsey fringes for starting in $\\ket{00}$ (cyan circles) versus $\\ket{10}$ (purple squares), and a $[ZZ]_{\\pi}$ gate occurs at 514 ns (dashed line). (c) A modified cross-resonance, refocused MAP gate protocol which includes a composite pulse of total time $\\Delta t$ consisting of three parts: two drive pulses on Q1 at an activation frequency near $f_{12}$ of Q2, separated by refocusing pulses $X_{\\pi}$ on both Q1 and Q2. The Ramsey experiment is modified with a $Y_{\\pi/2}$ at the end to observe out-of-phase fringes (d) controlled on the state $\\ket{00}$ (cyan circles) or $\\ket{10}$ (purple squares). A $[ZZ]_{\\pi}$ gate is indicated at the first out-of-phase fringe (dashed line) at a total gate time of 510 ns. Note that the upwards trend of the Q2 $\\ket{1}$ state population is a result of relaxation, as in the actual experiment protocol an additional $X_{\\pi}$ is applied at the end to both qubits to undo the effect of the refocusing $X_{\\pi}$ pulses.\n\nFor our experiment, we design two transmons ($\\omega_1/2\\pi$=5.166 GHz and $\\omega_2/2\\pi$=5.668 GHz) with a detuning close to twice the anharmonicity, $\\delta_2/2\\pi = -220$ MHz. Fig.\u00a0(Figure fig:1)(b) shows a Rabi amplitude spectroscopy landscape, where a strong Rabi-drive pulse of varying amplitude is applied to the coupling cavity ($\\omega_r/2\\pi$=8.646 GHz) of two transmons. Fringes are observed for each transition from the ground state to the $n$th level of transmon Q1 or Q2 [labeled $f_{0n}$ for each transmon in Fig.\u00a0(Figure fig:1)(b)]. The two transmons shown satisfy the MAP condition from the observation that the $f_{01}$ transition of Q1 aligns with the $f_{05}/5$ five-photon transition of Q2, which is generally $2\\delta_2/2\\pi$ detuned\u00a0[Unknown Author, \"Unknown Title\", ] from the $f_{01}$ transition of Q2.\n\nThe MAP interaction is tuned via a Ramsey experiment on Q2 as illustrated in Fig.\u00a0(Figure fig:2)(a). Conditioned on the state of Q1, different Ramsey fringes [Fig.\u00a0(Figure fig:2)(b)] are observed when a drive $\\Omega$ at $\\omega_{\\text{d}}/2\\pi\\sim f_{12}$ of Q2 is applied to the system. A two-qubit c-Phase gate generator $[ZZ]_{\\pi}=\\text{exp}(-i\\frac{\\pi}{4}(Z\\otimes Z))$ is realized when the fringes are $\\pi$ out of phase, indicated by the dashed line at a gate time $\\Delta t$ = 514 ns. Although the data in Fig.\u00a0(Figure fig:2)(b) is for $\\Omega$ applied directly to Q2, the interaction can also be driven through the bus resonator, or in a CR-like scheme via the Q1 excitation-port, as indicated in Fig.\u00a0(Figure fig:2)(a).\n\n< g r a p h i c s >\n\n(color online) MAP interaction versus frequency and power. (a)\u00a0Phase difference between modified MAP scheme Ramsey experiments starting in $\\ket{00}$ and $\\ket{10}$ swept versus drive frequency and pulse length, with (b)\u00a0extracted minimum $[ZZ]_{\\pi}$ two-qubit gate length. Dashed line at 5.43 GHz, located outside leakage region (5.443 to 5.466 GHz) containing transitions to $\\ket{12}$ and $\\ket{03}$. (c)\u00a0Phase difference for modified MAP scheme Ramsey experiments starting in $\\ket{00}$ and $\\ket{10}$ swept versus drive power at 5.43 GHz. (d)\u00a0Extracted minimum $[ZZ]_{\\pi}$ two-qubit gate length for (c). Solid black lines are from six-level numerical simulations.\n\nThe MAP drive $\\Omega$ can result in additional control errors to both qubits, particularly phase errors $ZI$ or $IZ$ due to the ac-Stark effect, and leakage to higher-levels of Q2 when $\\omega_{\\text{d}}/2\\pi$ is too close to $f_{12}$ of Q2. These can be mitigated with the modified MAP protocol shown in Fig.\u00a0(Figure fig:2)(c), which turns the interaction into a two-qubit Clifford generator\u00a0[Unknown Author, \"Unknown Title\", ]. In this protocol, the MAP drive is split in half, sandwiched around refocusing $X_{\\pi}$ gates on both qubits, and applied only in the CR-like fashion to Q1. The refocusing pulses remove single-qubit phase errors and the CR-like driving of Q1 gives additional protection from leakage to higher levels of Q2. We observe the effect of different Q1 input states on the output of Q2 by ending the Ramsey sequence with a $Y_{\\pi/2}$, which results in the oscillations shown in Fig\u00a0(Figure fig:2)(d). Here, a $[ZZ]_{\\pi}$ is indicated by the dashed line at a total gate time (two MAP drives of 235 ns and single-qubit gate of 40 ns) of 510 ns. The contrast reduction and upward drift in signal is likely due to relaxation, decoherence and higher-order leakage effects.\n\nWe perform the refocused MAP gate scheme at varying $\\omega_{\\text{d}}/2\\pi$ and powers $\\Omega^2$ to characterize the interaction. Fig.\u00a0(Figure fig:3)(a) shows the phase difference between the Ramsey fringes when starting in $\\ket{10}$ and $\\ket{00}$, scanning over the drive frequency. We plot the extracted optimal gate time for a $[ZZ]_{\\pi}$ versus  $\\omega_{\\text{d}}/2\\pi$ in Fig.\u00a0(Figure fig:3)(b), which diverges in the region between 5.443 to 5.466 GHz, due to direct leakage channels to $\\ket{12}$ and $\\ket{03}$. Nonetheless, the MAP gate is clearly observable at frequencies detuned from this leakage regime. By parking outside this region with a drive frequency of 5.43 GHz, we scan the MAP interaction versus $\\Omega^2$ [(Figs.\u00a0(Figure fig:3)(c-d)], saturating to a minimum total gate length of 510 ns.\n\nA six-level numerical simulation is performed, with energy-level frequencies extracted from Rabi amplitude spectroscopy experiments for both qubits. The simulations are shown as solid black lines in Fig.\u00a0(Figure fig:3). We find that these numerical simulations reproduce key features of the experiment. However, the gate time is very dependent on the exact values for the frequencies and only small variations in these values lead to very different predicted gate times. While perturbation theory predicts the behavior at low drive powers, an exact model that explains the gate duration at high powers will be the topic of future investigations. It should also be appreciated that from a control implementation standpoint, the MAP gate is considerably simpler than CR\u00a0[Unknown Author, \"Unknown Title\", ] or BR\u00a0[Unknown Author, \"Unknown Title\", ], as there is not a stringent requirement that the phase of the drive be particularly locked to other controls in the system.\n\n< g r a p h i c s >\n\n(color online)\u00a0Quantum process tomography for $[ZZ]_{\\pi}$ with gate time $\\Delta t$ = 510 ns. (a) Experimentally extracted Pauli transfer matrix with gate fidelity $F_{\\text{mle}}=0.8717$. (b) Ideal Pauli transfer matrix representation of ideal $[ZZ]_{\\pi}$ (with form $(X\\otimes X)\\text{exp}(-i\\frac{\\pi}{4}(Z\\otimes Z))$).\n\nFinally, we perform QPT (Fig.\u00a0(Figure fig:4)) by preparing an overcomplete set of 36 states generated by $\\{I, X_{\\pi},X_{\\pm\\pi/2},Y_{\\pm\\pi/2}\\}$, applying the 510 ns $[ZZ]_{\\pi}$ gate, and performing full state tomography using the bus resonator as a joint readout\u00a0[Unknown Author, \"Unknown Title\", ]. We use a semidefinite post-processing algorithm and the Pauli transfer matrix representation\u00a0[Unknown Author, \"Unknown Title\", ] to represent the process matrix, from which we obtain\na gate fidelity of $F_{\\text{mle}}=0.8717$ [$F_{\\text{raw}}=0.876$, $\\eta=-0.0285$ (sum of negative eigenvalues of Choi matrix)].\nThis result is in agreement with the relaxation and decoherence times $(T_1,\\,T_2)$ of $(6,\\,4)$ $\\mu$s for both qubits and the total gate time of 510 ns, likely with some contribution from state preparation and measurement (SPAM) errors\u00a0[Unknown Author, \"Unknown Title\", ]. SPAM errors can to lead to non-physical effects that make determination of error bars difficult\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThis experiment represents a proof-of-principle of the MAP gate. Further improvements in gate speed will be possible with more accurate frequency placement of the qubits as well as pulse shaping including amplitude and frequency modulations. Preliminary simulations suggest that gate speeds on the order of $1/J$ should be possible, and clearly further theoretical work is necessary to optimize gate performance.\n\nIn conclusion, we have demonstrated a microwave-activated c-Phase gate, utilizing a fixed resonance condition in the higher-energy manifolds of two transmon qubits. With a refocused implementation of the MAP gate, we achieve an optimal $[ZZ]_{\\pi}$ in 510 ns and extract gate fidelity of $\\approx 87\\%$ from QPT. The refocused MAP gate is easily extendable to randomized benchmarking methods\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and will be explored in future work. The MAP scheme can be further generalized to any pair of multi-level quantum systems, defining static resonance conditions in non-computational energy states which can be driven to change relative phases on computational states. For superconducting qubits, the MAP scheme is a gate for consideration in larger fixed-frequency quantum processors, but places more stringent boundaries on fabrication.\n\nWe acknowledge contributions from A.\u00a0D.\u00a0C\u00f3rcoles, D.\u00a0DiVincenzo, G.\u00a0A.\u00a0Keefe, J.\u00a0Rohrs, M.\u00a0B.\u00a0Rothwell, and J.\u00a0R.\u00a0Rozen. We acknowledge support from IARPA under contract W911NF-10-1-0324. All statements of fact, opinion or conclusions contained herein are those of the authors and should not be construed as representing the official views or policies of the U.S. Government.\n\n33\nfxundefined [1]\nifx#1\n\nfnum [1]\n#1firstoftwo\nsecondoftwo\n\nfx [1]\n#1firstoftwo\nsecondoftwo\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12`&12`#12`1\u03022`_12`\nstartlink[1]\nendlink[0]\n\nrl [1]href #1\n\n@bib@innerbibempty\n\n[Paik et\u00a0al.(2011)Paik,\nSchuster, Bishop, Kirchmair,\nCatelani, Sears, Johnson,\nReagor, Frunzio, Glazman,\nGirvin, Devoret, and Schoelkopf]Paik2011\nauthor author H.\u00a0Paik, author D.\u00a0I. Schuster,\nauthor L.\u00a0S. Bishop, author G.\u00a0Kirchmair, author\nG.\u00a0Catelani, author\nA.\u00a0P. Sears, author\nB.\u00a0R. Johnson, author\nM.\u00a0J. Reagor, author\nL.\u00a0Frunzio, author L.\u00a0I. Glazman, author S.\u00a0M.  Girvin, author M.\u00a0H.  Devoret,  and author R.\u00a0J.  Schoelkopf, http://link.aps.org/doi/10.1103/PhysRevLett.107.240501 journal journal Phys. Rev. Lett. volume 107, pages 240501 (year\n2011)NoStop\n[Corcoles et\u00a0al.(2011)Corcoles, Chow, Gambetta, Rigetti, Rozen, Keefe, Beth\u00a0Rothwell, Ketchen, and Steffen]Corcoles2011\nauthor author A.\u00a0D. Corcoles, author J.\u00a0M. Chow,\nauthor J.\u00a0M. Gambetta, author C.\u00a0Rigetti, author\nJ.\u00a0R. Rozen, author\nG.\u00a0A. Keefe, author\nM.\u00a0Beth\u00a0Rothwell, author\nM.\u00a0B. Ketchen,  and author\nM.\u00a0Steffen, http://apl.aip.org/resource/1/applab/v99/i18/p181906_s1 journal journal Applied Physics Letters volume 99, pages 181906 (year\n2011)NoStop\n[Rigetti et\u00a0al.(2012)Rigetti, Gambetta, Poletto, Plourde, Chow, Corcoles, Smolin, Merkel, Rozen, Keefe, Rothwell, Ketchen, and  Steffen]Rigetti2012\nauthor author C.\u00a0Rigetti, author J.\u00a0M. Gambetta, author S.\u00a0Poletto,\nauthor B.\u00a0L.\u00a0T. Plourde,\nauthor J.\u00a0M. Chow, author A.\u00a0D. Corcoles, author\nJ.\u00a0A. Smolin, author\nS.\u00a0T. Merkel, author\nJ.\u00a0R. Rozen, author\nG.\u00a0A. Keefe, author\nM.\u00a0B. Rothwell, author\nM.\u00a0B. Ketchen,  and author\nM.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevB.86.100506 journal\njournal Phys. Rev. B volume 86,  pages 100506 (year 2012)NoStop\n[Chang et\u00a0al.(2013)Chang,\nVissers, Corcoles, Sandberg,\nGao, Abraham, Chow,\nGambetta, Rothwell, Keefe,\nSteffen, and Pappas]Chang2013\nauthor author J.\u00a0B. Chang, author M.\u00a0R. Vissers,\nauthor A.\u00a0D. Corcoles, author M.\u00a0Sandberg, author\nJ.\u00a0Gao, author D.\u00a0W. Abraham, author J.\u00a0M.  Chow, author J.\u00a0M. Gambetta, author M.\u00a0B. Rothwell, author G.\u00a0A. Keefe,\nauthor M.\u00a0Steffen,  and  author D.\u00a0P. Pappas, http://dx.doi.org/10.1063/1.4813269 journal journal Appl. Phys. Lett. volume 103, pages 012602 (year 2013)NoStop\n[Chow et\u00a0al.(2012)Chow,\nGambetta, Corcoles, Merkel,\nSmolin, Rigetti, Poletto,\nKeefe, Rothwell, Rozen,\nKetchen, and Steffen]Chow2012\nauthor author J.\u00a0M. Chow, author J.\u00a0M. Gambetta,\nauthor A.\u00a0D. Corcoles, author S.\u00a0T. Merkel, author\nJ.\u00a0A. Smolin, author\nC.\u00a0Rigetti, author S.\u00a0Poletto, author G.\u00a0A.  Keefe, author M.\u00a0B. Rothwell, author J.\u00a0R. Rozen,\nauthor M.\u00a0B. Ketchen,  and  author M.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevLett.109.060501 journal journal Phys. Rev. Lett. volume 109, pages 060501 (year\n2012)NoStop\n[Magesan et\u00a0al.(2012)Magesan, Gambetta, Johnson, Ryan, Chow, Merkel, da\u00a0Silva, Keefe, Rothwell, Ohki, Ketchen, and Steffen]Magesan2012\nauthor author E.\u00a0Magesan, author J.\u00a0M. Gambetta, author B.\u00a0R. Johnson, author C.\u00a0A. Ryan,\nauthor J.\u00a0M. Chow, author S.\u00a0T. Merkel, author\nM.\u00a0P. da\u00a0Silva, author\nG.\u00a0A. Keefe, author\nM.\u00a0B. Rothwell, author\nT.\u00a0A. Ohki, author\nM.\u00a0B. Ketchen,  and author\nM.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevLett.109.080505 journal journal Phys. Rev. Lett. volume 109, pages 080505 (year\n2012)NoStop\n[Gambetta et\u00a0al.(2012)Gambetta, Corcoles, Merkel, Johnson, Smolin, Chow, Ryan, Rigetti, Poletto, Ohki, Ketchen, and Steffen]Gambetta2012\nauthor author J.\u00a0M. Gambetta, author A.\u00a0D. Corcoles, author S.\u00a0T. Merkel, author B.\u00a0R. Johnson,\nauthor J.\u00a0A. Smolin, author J.\u00a0M. Chow, author\nC.\u00a0A. Ryan, author\nC.\u00a0Rigetti, author S.\u00a0Poletto, author T.\u00a0A.  Ohki, author M.\u00a0B. Ketchen,  and author M.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevLett.109.240504\njournal journal Phys. Rev. Lett. volume 109, pages 240504 (year\n2012)NoStop\n[Poletto et\u00a0al.(2012)Poletto, Gambetta, Merkel, Smolin, Chow, Corcoles, Keefe, Rothwell, Rozen, Abraham, Rigetti, and Steffen]Poletto2012\nauthor author S.\u00a0Poletto, author J.\u00a0M. Gambetta, author S.\u00a0T. Merkel, author J.\u00a0A. Smolin,\nauthor J.\u00a0M. Chow, author A.\u00a0D. Corcoles, author\nG.\u00a0A. Keefe, author\nM.\u00a0B. Rothwell, author\nJ.\u00a0R. Rozen, author\nD.\u00a0W. Abraham, author\nC.\u00a0Rigetti,  and author\nM.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevLett.109.240505 journal journal Phys. Rev. Lett. volume 109, pages 240505 (year\n2012)NoStop\n[Corcoles et\u00a0al.(2012)Corcoles, Gambetta, Chow, Smolin, Ware, Strand, Plourde, and Steffen]Corcoles2012arx\nauthor author A.\u00a0D. Corcoles, author J.\u00a0M. Gambetta, author J.\u00a0M. Chow,\nauthor J.\u00a0A. Smolin, author M.\u00a0Ware, author\nJ.\u00a0D. Strand, author\nB.\u00a0L.\u00a0T. Plourde,  and author\nM.\u00a0Steffen, http://arxiv.org/abs/1202.5533 journal journal\narXiv:1210.7011v2 [quant-ph]  (year 2012)NoStop\n[Merkel et\u00a0al.(2012)Merkel,\nGambetta, Smolin, Poletto,\nCorcoles, Johnson, Ryan,  and Steffen]Merkel2012arx\nauthor author S.\u00a0T. Merkel, author J.\u00a0M. Gambetta, author J.\u00a0A. Smolin, author S.\u00a0Poletto,\nauthor A.\u00a0D. Corcoles, author B.\u00a0R. Johnson, author\nC.\u00a0A. Ryan,  and author\nM.\u00a0Steffen, @noop  journal journal arXiv:1211.0322v1 [quant-ph]  (year 2012)NoStop\n[Bravyi and Kitaev(1998)]Bravyi1998\nauthor author S.\u00a0Bravyi and author A.\u00a0Kitaev, http://arxiv.org/abs/quant-ph/9811052 journal journal arXiv:quant-ph/9811052 ,  (year 1998)NoStop\n[Raussendorf and Harrington(2007)]Raussendorf2007\nauthor author R.\u00a0Raussendorf and author J.\u00a0Harrington, http://link.aps.org/doi/10.1103/PhysRevLett.98.190504 journal\njournal Phys. Rev. Lett. volume 98,  pages 190504 (year 2007)NoStop\n[Bialczak et\u00a0al.(2010)Bialczak, Ansmann, Hofheinz, Lucero, Neeley, O/'Connell, Sank, Wang, Wenner, Steffen, Cleland, and Martinis]Bialczak2010\nauthor author R.\u00a0C. Bialczak, author M.\u00a0Ansmann,\nauthor M.\u00a0Hofheinz, author E.\u00a0Lucero, author\nM.\u00a0Neeley, author A.\u00a0D. O/'Connell, author D.\u00a0Sank, author H.\u00a0Wang, author J.\u00a0Wenner,\nauthor M.\u00a0Steffen, author A.\u00a0N. Cleland,  and author J.\u00a0M. Martinis, http://dx.doi.org/10.1038/nphys1639 journal journal Nat Phys volume 6, pages\n409 (year 2010)NoStop\n[Dewes et\u00a0al.(2012)Dewes,\nOng, Schmitt, Lauro,\nBoulant, Bertet, Vion, and  Esteve]Dewes2012\nauthor author A.\u00a0Dewes, author F.\u00a0R. Ong,\nauthor V.\u00a0Schmitt, author R.\u00a0Lauro, author\nN.\u00a0Boulant, author P.\u00a0Bertet, author D.\u00a0Vion,  and author D.\u00a0Esteve, http://link.aps.org/doi/10.1103/PhysRevLett.108.057002 journal journal Phys. Rev. Lett. volume 108, pages 057002 (year\n2012)NoStop\n[DiCarlo et\u00a0al.(2009)DiCarlo, Chow, Gambetta, Bishop, Johnson, Schuster, Majer, Blais, Frunzio, Girvin, and Schoelkopf]dicarlo_2009\nauthor author L.\u00a0DiCarlo, author J.\u00a0M. Chow,\nauthor J.\u00a0M. Gambetta, author L.\u00a0S. Bishop, author\nB.\u00a0R. Johnson, author\nD.\u00a0I. Schuster, author\nJ.\u00a0Majer, author A.\u00a0Blais, author L.\u00a0Frunzio, author S.\u00a0M.  Girvin,  and author R.\u00a0J.  Schoelkopf, 10.1038/nature08121 journal journal Nature volume\n460, pages 240 (year 2009)NoStop\n[Strauch et\u00a0al.(2003)Strauch, Johnson, Dragt, Lobb, Anderson, and Wellstood]Strauch:2003ss\nauthor author F.\u00a0W. Strauch, author P.\u00a0R. Johnson, author A.\u00a0J. Dragt,\nauthor C.\u00a0J. Lobb, author J.\u00a0R. Anderson,  and author F.\u00a0C. Wellstood, 10.1103/PhysRevLett.91.167005 journal journal\nPhysical Review Letters volume 91 (year\n2003), 10.1103/PhysRevLett.91.167005NoStop\n[Yamamoto et\u00a0al.(2010)Yamamoto, Neeley, Lucero, Bialczak, Kelly, Lenander, Mariantoni, O'Connell, Sank, Wang, Weides, Wenner, Yin,\nCleland, and Martinis]Yamamoto2010\nauthor author T.\u00a0Yamamoto, author M.\u00a0Neeley,\nauthor E.\u00a0Lucero, author R.\u00a0C. Bialczak, author\nJ.\u00a0Kelly, author M.\u00a0Lenander, author M.\u00a0Mariantoni, author A.\u00a0D.  O'Connell, author D.\u00a0Sank, author H.\u00a0Wang, author M.\u00a0Weides, author\nJ.\u00a0Wenner, author Y.\u00a0Yin, author A.\u00a0N.  Cleland,  and author J.\u00a0M.  Martinis, http://link.aps.org/doi/10.1103/PhysRevB.82.184515 journal\njournal Phys. Rev. B volume 82,  pages 184515 (year 2010)NoStop\n[Niskanen et\u00a0al.(2007)Niskanen, Harrabi, Yoshihara, Nakamura, Lloyd, and Tsai]Niskanen:2007if\nauthor author A.\u00a0O. Niskanen, author K.\u00a0Harrabi,\nauthor F.\u00a0Yoshihara, author Y.\u00a0Nakamura, author\nS.\u00a0Lloyd,  and author\nJ.\u00a0S. Tsai, 10.1126/science.1141324 journal journal\nScience volume 316, pages 723\n(year 2007)NoStop\n[Bialczak et\u00a0al.(2011)Bialczak, Ansmann, Hofheinz, Lenander, Lucero, Neeley, O'Connell, Sank, Wang, Weides, Wenner, Yamamoto, Cleland, and Martinis]Bialczak2011\nauthor author R.\u00a0C. Bialczak, author M.\u00a0Ansmann,\nauthor M.\u00a0Hofheinz, author M.\u00a0Lenander, author\nE.\u00a0Lucero, author M.\u00a0Neeley, author A.\u00a0D.  O'Connell, author D.\u00a0Sank, author H.\u00a0Wang, author M.\u00a0Weides, author\nJ.\u00a0Wenner, author T.\u00a0Yamamoto, author A.\u00a0N.  Cleland,  and author J.\u00a0M.  Martinis, http://link.aps.org/doi/10.1103/PhysRevLett.106.060501 journal journal Phys. Rev. Lett. volume 106, pages 060501 (year\n2011)NoStop\n[Majer et\u00a0al.(2007)Majer,\nChow, Gambetta, Koch,\nJohnson, Schreier, Frunzio,\nSchuster, Houck, Wallraff,\nBlais, Devoret, Girvin, and  Schoelkopf]majer_coupling_2007\nauthor author J.\u00a0Majer, author J.\u00a0M. Chow,\nauthor J.\u00a0M. Gambetta, author J.\u00a0Koch, author\nB.\u00a0R. Johnson, author\nJ.\u00a0A. Schreier, author\nL.\u00a0Frunzio, author D.\u00a0I. Schuster, author A.\u00a0A.  Houck, author A.\u00a0Wallraff, author A.\u00a0Blais,\nauthor M.\u00a0H. Devoret, author S.\u00a0M. Girvin,  and author R.\u00a0J. Schoelkopf, 10.1038/nature06184 journal journal\nNature volume 449, pages 443\n(year 2007)NoStop\n[Leek et\u00a0al.(2009)Leek,\nFilipp, Maurer, Baur,\nBianchetti, Fink, Goppl,\nSteffen, and Wallraff]Leek:2009ht\nauthor author P.\u00a0J. Leek, author S.\u00a0Filipp,\nauthor P.\u00a0Maurer, author M.\u00a0Baur, author\nR.\u00a0Bianchetti, author\nJ.\u00a0M. Fink, author\nM.\u00a0Goppl, author L.\u00a0Steffen,  and author A.\u00a0Wallraff, 10.1103/PhysRevB.79.180511\njournal journal Physical Review B volume 79 (year 2009),  10.1103/PhysRevB.79.180511NoStop\n[Paraoanu(2006)]Paraoanu2006\nauthor author G.\u00a0S. Paraoanu, http://link.aps.org/doi/10.1103/PhysRevB.74.140504\njournal journal Phys. Rev. B volume 74, pages 140504 (year\n2006)NoStop\n[Rigetti and Devoret(2010)]Rigetti2010\nauthor author C.\u00a0Rigetti and author M.\u00a0Devoret, http://link.aps.org/doi/10.1103/PhysRevB.81.134507\njournal journal Phys. Rev. B volume 81, pages 134507 (year\n2010)NoStop\n[Chow et\u00a0al.(2011)Chow,\nCorcoles, Gambetta, Rigetti,\nJohnson, Smolin, Rozen,\nKeefe, Rothwell, Ketchen,  and Steffen]Chow2011\nauthor author J.\u00a0M. Chow, author A.\u00a0D. Corcoles,\nauthor J.\u00a0M. Gambetta, author C.\u00a0Rigetti, author\nB.\u00a0R. Johnson, author\nJ.\u00a0A. Smolin, author\nJ.\u00a0R. Rozen, author\nG.\u00a0A. Keefe, author\nM.\u00a0B. Rothwell, author\nM.\u00a0B. Ketchen,  and author\nM.\u00a0Steffen, http://link.aps.org/doi/10.1103/PhysRevLett.107.080502 journal journal Phys. Rev. Lett. volume 107, pages 080502 (year\n2011)NoStop\n[Poletto and Lucero(2013)]Poletto2013_inprep\nauthor author S.\u00a0Poletto and author E.\u00a0Lucero, @noop  journal journal in\npreparation  (year 2013)NoStop\n[Gambetta(2012)]Gambetta2012aps\nauthor author J.\u00a0M. Gambetta, in @noop  booktitle Bulletin of\nthe American Physical Society, APS March Meeting 2012, Volume 57, Number\n1 (year 2012)NoStop\n[Paik(2013)]Paik_inpreparation2013\nauthor author H.\u00a0Paik, @noop  journal journal in\npreparation  (year 2013)NoStop\n[Yoshihara et\u00a0al.(2006)Yoshihara, Harrabi, Niskanen, Nakamura, and Tsai]yoshihara_decoherence_2006\nauthor author F.\u00a0Yoshihara, author K.\u00a0Harrabi,\nauthor A.\u00a0O. Niskanen, author Y.\u00a0Nakamura,  and author J.\u00a0S. Tsai, 10.1103/PhysRevLett.97.167001 journal journal\nPhys. Rev. Lett. volume 97, pages\n16001 (year 2006)NoStop\n[Gambetta et\u00a0al.(2006)Gambetta, Blais, Schuster, Wallraff, Frunzio, Majer, Devoret, Girvin, and Schoelkopf]gambetta_qubit-photon_2006\nauthor author J.\u00a0Gambetta, author A.\u00a0Blais,\nauthor D.\u00a0I. Schuster, author A.\u00a0Wallraff, author\nL.\u00a0Frunzio, author J.\u00a0Majer, author M.\u00a0H.  Devoret, author S.\u00a0M.  Girvin,  and author R.\u00a0J.  Schoelkopf, 10.1103/PhysRevA.74.042318\njournal journal Phys. Rev. A volume 74, pages 042318 (year\n2006)NoStop\n[Cohen-Tannoudji et\u00a0al.(1992)Cohen-Tannoudji, Dupont-Roc, and Grynberg]ct_atom_photon_interactions\nauthor author C.\u00a0Cohen-Tannoudji, author J.\u00a0Dupont-Roc,  and author G.\u00a0Grynberg, title Atom-photon interactions,   (publisher Wiley Inter-Science, year\n1992)NoStop\n[Koch et\u00a0al.(2007)Koch,\nYu, Gambetta, Houck,\nSchuster, Majer, Blais,\nDevoret, Girvin, and Schoelkopf]koch_charge-insensitive_2007\nauthor author J.\u00a0Koch, author T.\u00a0M. Yu,\nauthor J.\u00a0Gambetta, author A.\u00a0A. Houck, author\nD.\u00a0I. Schuster, author\nJ.\u00a0Majer, author A.\u00a0Blais, author M.\u00a0H.  Devoret, author S.\u00a0M.  Girvin,  and author R.\u00a0J.  Schoelkopf, 10.1103/PhysRevA.76.042319\njournal journal Phys. Rev. A volume 76, pages 042319 (year\n2007)NoStop\n[Filipp et\u00a0al.(2009)Filipp,\nMaurer, Leek, Baur,\nBianchetti, Fink, Goppl,\nSteffen, Gambetta, Blais,  and Wallraff]filipp_joint_2009\nauthor author S.\u00a0Filipp, author P.\u00a0Maurer,\nauthor P.\u00a0J. Leek, author M.\u00a0Baur, author\nR.\u00a0Bianchetti, author\nJ.\u00a0M. Fink, author\nM.\u00a0Goppl, author L.\u00a0Steffen, author J.\u00a0M.  Gambetta, author A.\u00a0Blais,  and author A.\u00a0Wallraff, 10.1103/PhysRevLett.102.200402 journal journal Phys. Rev. Lett. volume 102, eid 200402 (year\n2009)NoStop\n[Magesan et\u00a0al.(2011)Magesan, Gambetta, and Emerson]Magesan2011\nauthor author E.\u00a0Magesan, author J.\u00a0M. Gambetta,  and author J.\u00a0Emerson, http://link.aps.org/doi/10.1103/PhysRevLett.106.180504\njournal journal Phys. Rev. Lett. volume 106, pages 180504 (year\n2011)NoStop\n\n"}
{"prompt": "Please summarize the paper titled 'Supplemental Material for'.", "completion": "\n\napsrev4-1\n\n# Supplemental Material for\n\u201cStrong quantum computational advantage using a superconducting quantum processor\u201d\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nHenan Key Laboratory of Quantum Information and Cryptography, Zhengzhou 450000, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nQuantumCTek Co., Ltd., Hefei 230026, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\nHenan Key Laboratory of Quantum Information and Cryptography, Zhengzhou 450000, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Institute of Technical Physics, Chinese Academy of Sciences, Shanghai 200083, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nQuantumCTek Co., Ltd., Hefei 230026, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\nQuantumCTek Co., Ltd., Hefei 230026, China\n\nHefei National Laboratory for Physical Sciences at the Microscale and Department of Modern Physics, University of Science and Technology of China, Hefei 230026, China\nShanghai Branch, CAS Center for Excellence in Quantum Information and Quantum Physics, University of Science and Technology of China, Shanghai 201315, China\nShanghai Research Center for Quantum Sciences, Shanghai 201315, China\n\n## Quantum processor design and fabrication\nWe designed a state of the art programmable quantum processor, consists of 66 Transmon\u00a0[Unknown Author, \"Unknown Title\", ] qubits in a two-dimensional array, with another 110 Transmon qubits as couplers for adjustable coupling between neighboring qubits, as illustrated in Fig.\u00a01 in the main text.\nThe 66 qubits are divided into 11 groups, with 6 qubits in a group sharing a readout Purcell filter\u00a0[Unknown Author, \"Unknown Title\", ].\nTaking advantage of the flip-chip technology, all qubits and couplers are placed on the same layer, and all readout and control lines are on the other layer.\nEach qubit is controlled by an control line which combines both microwave drive (XY control) and flux bias (Z control), and capacitively coupled to a quarter wave resonator which is coupled to a Purcell filter for dispersive readout.\nThe qubit-qubit coupling of nearest-neighbor qubits are contributed by two parts: direct capacitive coupling and indirect coupling through the coupler.\nEach coupler has an individual flux bias line, with which the effective qubit-qubit coupling strength can be tuned from $\\sim +5 \\text{MHz}$ to $\\sim -50 \\text{MHz}$ by changing the coupler frequency.\nThe two-qubit gates are implemented with a coupling strength of about $10 \\text{MHz}$.\n\nOur quantum processor consists of two separate chips, the top chip and the bottom chip. High purity aluminum thin film are grown on sapphire substrate by molecular beam epitaxy (MBE) for both chips\u00a0[Megrant, Anthony, Neill, Charles, Barends, Rami, Chiaro, Ben, Chen, Yu, Feigl, Ludwig, Kelly, Julian, Lucero, Erik, Mariantoni, Matteo, O\u2019Malley, Peter JJ, others, \"Planar superconducting resonators with internal quality factors above one million\", 2012]. Control and readout circuits are fabricated on the bottom chip using optical lithography. To suppress crosstalk, airbridges are fabricated to shield critical circuits\u00a0[Dunsworth, A, Barends, R, Chen, Yu, Chen, Zijun, Chiaro, B, Fowler, A, Foxen, B, Jeffrey, E, Kelly, J, Klimov, PV, others, \"A method for building low loss multi-layer wiring for superconducting microwave devices\", 2018]. 66 qubits and 110 adjustable couplers are fabricated on the top chip using an aluminum evaporation and lift-off process. After dicing and testing, the two separated chips are bonded together with indium bumps\u00a0[Foxen, B, Mutus, JY, Lucero, E, Graff, R, Megrant, A, Chen, Yu, Quintana, C, Burkett, B, Kelly, J, Jeffrey, E, others, \"Qubit compatible superconducting interconnects\", 2017] [Rosenberg, D, Kim, D, Das, R, Yost, D, Gustavsson, S, Hover, D, Krantz, P, Melville, A, Racz, L, Samach, GO, others, \"3D integrated superconducting qubits\", 2017]. After chip fabrication, the processor is wire-bounded to a printed circuit board inside a sample box with gold-plated shielding inside and $\\mu-$metal shielding outside. Finally, the packaged processor is mounted to the cold plate of a dilution refrigerator and connected to room temperature electronics through alternators, filters and amplifiers.\n\n## Experimental setup\nThe experimental wiring setup for qubit/coupler controls and frequency-multiplexed readouts is shown in Fig.\u00a0(Figure fig.wiring). The control and readout signals are generated by digital-to-analog converters (DAC) at room temperature, then attenuated by a series of attenuators and filtered by several low-pass filters.\n\nIn order to improve the signal-to-noise ratio of the readout signal, we use the Josephson parametric amplifier (JPA) for the first stage amplification at base temperature. Then\nthe readout signal is amplified by a high-electron mobility transistor (HEMT) amplifier at the 4 K stage and  further amplified by a room-temperature amplifiers after getting out of the dilution refrigerator.\n\nThe room temperature electronic equipment in this experiment includes 330 DAC channels, 11 ADC modules, 11 DC channels and 34 microwave source channels.\n\n< g r a p h i c s >\n\nThe schematic diagram of control electronics and wiring. Each qubit has a XY control line and and a Z control line, which are combined together via a bias tee before connected to the quantum processor. In the dilution refrigerator, attenuators and filters are installed at various stages to reduce noise. Josephson parametric amplifiers (JPA) , high electron mobility transistors (HEMT) and room-temperature amplifiers are used to amplify the readout signals. At room temperature, digital-to-analog converters (DAC), microwave sources and mixers are used to generate pulses for qubit XY control, readout probing pulses and JPA pump. Qubit Z and coupler control pulses are also generated by DACs. DC sources are used to provide the flux bias of JPAs. The readout signals amplified by the room-temperature amplifiers are  digitized and demodulated by ADC modules.\n\n## Gate and Readout Calibration\n### Part1: Rough calibration on 66 qubits\n#### Basic Calibration\nAfter cooling down, we perform basic calibrations to determine whether the processor can work properly, this process involves all 66 qubits, 110 couplers, 66 readout resonators and 11 JPAs. The calibration procedure is listed bellow.\n\n* Identify the the readout resonator frequency for each qubit,  measure the dispersive frequency shift and measure its dependency with the qubit flux bias.\n\n* Find a JPA DC bias, pump frequency and pump power configuration that produces high signal-to-noise ratio for the corresponding readout signals.\n\n* Measure the response of readout resonator versus coupler bias, then bias the coupler to a safe point where coupling strength of neighboring qubits is small, $\\sim+5$MHz typically.\n\n* Run Rabi experiments to calibrate $\\pi$ and $\\pi/2$ pulse amplitudes.\n\n* Perform coarse readout  calibration to improve readout fidelity by optimizing readout frequency, length and amplitude.\n\n* Tune coupler bias to minimize the qubit-qubit coupling via $|10\\rangle$ - $|01\\rangle$ swap experiment.\n\n* Perform qubit spectroscopy measurements and extract the mapping between the qubit bias amplitude and the qubit frequency.\n\n* Measure $T_1$, $T_2$ versus qubit frequency.\n\n* Measure the step response of the bias control line to characterize the Z pulse distortion by running a Ramsey experiment\u00a0[Yan, Zhiguang, Zhang, Yu-Ran, Gong, Ming, Wu, Yulin, Zheng, Yarui, Li, Shaowei, Wang, Can, Liang, Futian, Lin, Jin, Xu, Yu, others, \"Strongly correlated quantum walks with a 12-qubit superconducting processor\", 2019].\n\n* Perform XY-crosstalk measurement.\n\n* Synchronise the timing between the qubit microwave drive, qubit bias, and coupler bias.\n\nAs qubit idle frequency arrangement and coupling between qubits are not yet optimized at this stage,  we typically divide the qubits into 2 groups and couplers into 4 groups for some calibration experiments, calibration for each group are performed in parallel. Basic calibration results indicates that the quantum processor can work properly and we proceed to optimize the frequency arrangement with the coherence and XY-crosstalk data.\nThere are three types of operating frequencies: idle, interaction and readout. When optimizing the frequency arrangement, we have to consider the following factors: coherence, two-level-system (TLS), residual coupling between qubits, XY-crosstalk and Z pulse distortions.\n\nAfter the optimal operating frequencies are determined, we proceed to\n\ncalibrate and optimize single-qubit gate, readout and two-qubit gate parameters in parallel.\n\n#### Readout, Single-Qubit Gate and Two-Qubit Gate Calibration\ni. Single-Qubit Gate Calibration\n\nThe optimized idle frequency arrangement is displayed in Fig.\u00a0<ref>(a). We set all qubit idle frequencies to the target idle frequencies by adjusting qubit flux biases. Next, we turn off the qubit-qubit coupling by adjusting the coupler flux bias. Then we fine tune the XY drive pulse amplitudes, pulse shaping parameters of the cosine-envelop microwave of 25ns length. Finally, we benckmark the fidelities of single qubit gates with single-qubit cross-entropy benchmarking (XEB)\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019].\n\nGate errors of some qubits are still too high($\\textgreater0.3\\%$) for the random quantum circuit benchmarking tasks after this first round of calibration.\n\nFor these qubits, we measure XEB gate fidelity versus idle frequencies around initial idle frequency and choose a new optimal idle frequency.\n\nAfter the above calibration procedure, we obtained high fidelity single-qubit gates with an average XEB pauli error 0.14\n\nii. Readout Calibration\n\nTo improve readout fidelity and reduce readout crosstalk, we set the qubit readout frequencies to a different frequency arrangement optimized for readout, which is displayed in Fig.\u00a0<ref>(e). At this new frequency setting, we rerun the basic readout calibrations to optimize readout frequency, length and amplitude.\nAfter this calibration procedure, the readout error is mainly limited by qubit relaxation. To reduce the influence of the relaxation, we enhance the effective qubit lifetime by driving the qubit to higher levels during the readout\u00a0[Elder, Salvatore S., Wang, Christopher S., Reinhold, Philip, Hann, Connor T., Chou, Kevin S., Lester, Brian J., Rosenblum, Serge, Frunzio, Luigi, Jiang, Liang, Schoelkopf, Robert J., \"High-Fidelity Measurement of Qubits Encoded in Multilevel Superconducting Circuits\", 2020].\n\nWe calibrate the readout fidelities by preparing all qubits at $|0\\rangle(|1\\rangle)$ and count the events of successfully identify the readout result as $|0\\rangle(|1\\rangle)$. Simultaneous readout error of $|0\\rangle$ and $|1\\rangle$ are 3.46\n\nWe also compare the fidelity results with that obtained from preparing the qubits at random bit strings as a sanity check. The results of random bit string measurement show that identification error of a single qubit has increased by an average of $0.14\\%$ and the 56-qubit state readout fidelity is lower with a factor of $0.93$. This factor is used to correct the estimated fidelities in the random quantum circuit benchmarking tasks.\n\n< g r a p h i c s >\n\nSingle-qubit gate pauli error $e_1$, two-qubit gate pauli error $e_2$ and readout error $e_r$ of the 66 qubits and 110 couplers of the Zuchongzhi processor.\n\n< g r a p h i c s >\n\nThe relaxation time $T_{1}$ and dephasing time $T_2^*$ of the 66 qubits of the Zuchongzhi processor.\n\n< g r a p h i c s >\n\nThe typical distribution of 66-qubit parameters over the Zuchongzhi processor.\n\niii. Two-Qubit Gate Calibration\n\nThe two-qubit gate of our experiment, the iSWAP-like gate\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019], is realized by tuning the two qubits from their idle frequencies into resonance and turning on the coupling.\n\nConsidering the effects of decoherence and leakage, we set the total time duration of the iSWAP-like gates to 32ns, which includes the pulse rise/fall time of 3ns and interaction time of 26ns. With this setting, we finely calibrate the detuning of the two qubits and the  coupling strength of the corresponding coupler to obtain a full swap  from one qubit to another. After that, we optimize the interaction time in order to minimize leakage to higher energy levels. We generally perform these calibration steps iteratively until the parameters converge, typically within two or three iterations.\n\nAfter the calibration of iSwap-like gate paramegters, we benchmark gate performance with XEB. Unlike single qubit gates, iSwap-like gates are parameterized gates each with four parameters as described by the unitary model in the main text, with the experimental results of XEB and the generic unitary model, we learn these parameters through an optimization process to maximize the overall fidelity of XEB.  With the optimized parameters, we fit the final XEB error and speckle purity benchmarking(SPB) error[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019]. We obtained high fidelity two-qubit gates with an average XEB pauli error 0.76\n\n### Part2: Fine-tune on 56 qubits\n< g r a p h i c s >\n\nThe qubit interaction frequencies of the 94 two-qubit gate of the 56 selected qubits.\n\nAfter rough calibrations on 66 qubits, we can estimate the XEB fidelity of a specific quantum circuit with $n$ qubits and $m$ cycles according to Eq.\u00a0<ref>. For random quantum circuit sampling, as the circuit scale increases its fidelity decreases, a large number of samples is required to ensure the uncertainty of the fidelity is much less than the fidelity itself in case of low fidelity. As a trade-off between number of samples and sampling time, we only compile our random circuit sampling tasks to a subset of the processor of up to 56 qubits. We achieved 56-qubit 20-cycle random circuit sampling, an intractable task for classical simulation, within an acceptable sampling time.\n\nTo switch from the 66-qubit pattern to the 56-qubit pattern, we just turn off the couplings between the selected qubits and the unused qubits.\nThen, we recalibrate the readout, single-qubit gate and two-qubit gate parameters. In addition, for the qubits on which two-qubit XEB pauli error is higher than 1.5\n\nAfter all the calibrations and optimizations, the average readout error is 4.52\n\n### Summary of system parameters\nThe system parameters of our quantum processor are summarized in Table\u00a0(Table tableSummary).\n\nParameters    Median    Mean    Stdev.    Figure\n\nQubit maximum frequency (GHz)    4.811    4.809    0.096    Fig.\u00a0<ref>\n\nQubit idle frequency (GHz)    4.653    4.653    0.095    Fig.\u00a0<ref>\n\nQubit anharmonicity  (MHz)    -246.5    -248.2    5.3    Fig.\u00a0<ref>\n\nQubit readout frequency (GHz)    4.400    4.083    0.492    Fig.\u00a0<ref>\n\nReadout drive frequency (GHz)    6.409    6.407    0.103    Fig.\u00a0<ref>\n\n$T_1$ at idle frequency ($\\mu$s)    30.8    30.6    7.1    Fig.\u00a0<ref>\n\n$T_2^*$ at idle frequency ($\\mu$s)    5.1    5.3    2.7    Fig.\u00a0<ref>\n\n66-qubit readout $e_{r}$ (\n66-qubit 1Q XEB $e_{1}$ (\n66-qubit 2Q XEB $e_{2}$ (\n56-qubit readout $e_{r}$ (\n56-qubit 1Q XEB $e_{1}$ (\n56-qubit 2Q XEB $e_{2}$ (\n\nSummary of system parameters.\n\n## Software System\nA 66-qubit superconducting quantum processor is a high-dimensional, highly constrained analogy system with system parameters susceptible to environmental changes and often drifts with time, to execute high fidelity quantum circuits, more than 400 DAC, ADC, microwave source and DC source channels need to be controlled with cutting edge precision. Operating such a complex quantum system requires considerable advancement in software as compared to  operating small quantum systems. We have developed a software system for intermediate scale superconducting quantum systems called QOS(Quantum Operating System) that is capable of operating quantum systems of more than 1000 qubits.\n\n< g r a p h i c s >\n\nSoftware architecture.  The QOS system consists of four major modules, the Hardware module , the Kernel module, the Routine module and the Service module. Other supporting modules are not shown.\n\nThe major functionalities of QOS are abstract away hardware details, manage resources and implement quantum operations. The first two functionalities are similar to that of a classical computer operating system, the last is unique to a quantum operating system.\n\nAs mentioned before, a large scale quantum processor is a complicated system, directly managing such a complex system is intractable for experiment users, the QOS system abstract away system details and manages all the  resources for the user. Resources of a quantum computer system includes hardware and software. We categorize hardware into two categories, classical hardware and quantum hardware. Classical hardware includes DAC, ADC, microwave source, DC source and all other control electronics, quantum hardware includes the quantum processor and the quantum amplifiers. To mange all the resources, QOS manages a registry system to represent and keep track of the settings/configurations of all the resources.  The registry is organized in a tree structure and holds all the settings of the classical hardware, quantum hardware and software configurations. Each user maintains independent registry settings for their own experiments. About 20k entries of registry settings are used to run the quantum processor in this work.\n\nFig.\u00a0<ref> shows the basic architecture of the the QOS system, it consists of four major modules, the Hardware module, the Kernel module, the Routine module and  the Service module. Other supporting modules includes the Data Storage module, the Registry module, the Waveform module and the Utility module etc. Most of the software components are  abstractions of the hardware system components.\n\nThe Hardware module hosts a library of drivers of classical hardware, on top of this, a hardware abstraction layer(HAL) is introduced to provide an unified API for the Kernel module to interface with hardware, making upper stream modules hardware model agnostic and can be adapted to hardware provided by differ vendors with minimum effort. Mock drivers are also provided to facilitate off-line testing without real hardware.\n\nUnlike a classical processor, on which all the basic computing units like logical gates and registers are hardware components, a superconducting quantum processor is just a physical quantum system, all computing units like quantum gates and quantum registers have to be implemented by software. The most essential functionality of a quantum software system is to implement quantum operations and transform a quantum physical device into a quantum computing processor. This is done by the Kernel module and makes it the most important module. The Kernel module is an abstraction of the physical system, including the quantum processor device and the controlling electronics, it consists of the following sub-modules, the Quantum Processor(QPU), the Hardware Adapter, the User and the QThread.\n\nControlling superconducting qubits to implement high fidelity quantum gates is a complex task, when the system size scales up, the requirement on software performance is very demanding. To be scalable, the software system has to be able parse quantum operations in parallel. Entanglement is an intrinsic feature of a quantum system, implement parallel operation on an entangled system is a non trivial task. We use the Actor Model\u00a0[Hewitt, Carl, Bishop, Peter, Steiger, Richard, \"A universal modular actor formalism for artificial intelligence\", 1973] for the implementation of the kernel module. Each hardware component is modeled as an actor, called Agent with those representing quantum components called QAgent in particular, types of agent used in this work are listed below:\n\n* Transmon, of the QAgent class, each represents a Transmon\u00a0[Unknown Author, \"Unknown Title\", ] type or Transmon type compatible qubit, responsible for managing all the settings of the qubit and implementing single qubit quantum operations.\n\n* TTG, tunable coupler of the Transmon qubit as used on the Zuchongzhi processor, responsible for managing all the settings of the coupler and implementing two qubit quantum operations.\n\n* MuxReadout, represents a multiplexed qubit state readout unit.\n\n* IMPA, represents an impedance matched parameter amplifier\u00a0[Mutus, Josh Y, White, Theodore C, Barends, Rami, Chen, Yu, Chen, Zijun, Chiaro, Ben, Dunsworth, Andrew, Jeffrey, Evan, Kelly, Julian, Megrant, Anthony, others, \"Strong environmental coupling in a Josephson parametric amplifier\", 2014].\n\n* QProcessor, a controlling agent of all the agents, including qubits, couplers, readouts, amplifiers, hardware manager etc.\n\n* Hardware Adapter, represents one piece of classical hardware, DAC, ADC, microwave source etc.\n\n* Hardware Manager, a controlling agent of all the classical hardware agents.\n\n* QThread, a software abstraction that represents a quantum thread or quantum process on a quantum processor.\n\n* User, a software abstraction that is responsible for managing user specific resources, conducting user transactions like authentication and authorization etc.\n\nOpcode     Example     Meaning\n\nSET     SET Q01 2 3.14     Set value of the selected setting entry of index 2 of Q01 to 3.14\n\nCMT     CMT Q01 0     Commit settings change, waveforms regenerated, caches refreshed etc.\n\nExample: commit settings change of type 0 for Q01\n\nI     I Q01 50     Idle gate. Example: Q01 idle for time duration 50\n\nX, Y, Z     X2M Q01     XY gates. Example: -X/2 gate on Q01\n\nX2P, X2M, Y2P, Y2M\n\nH     H Q01     H gate\n\nXY     XY Q01 0.785     $\\pi$ rotation around the axis of azimuth 0.785 rad in the XY plane\n\nXY2P, XY2M     XY2P Q01 0.785     $+\\pi/2$($-\\pi/2$) rotation around the axis of azimuth 0.785 rad\n\nXY2M Q01 0.785     in the XY plane\n\nX12     X12 Q01     $|1\\rangle \\leftrightarrow |2\\rangle$ driving gate\n\nX23     X23 Q01     $|2\\rangle \\leftrightarrow |3\\rangle$ driving gate\n\nZ     Z Q01     Z gate on Q01\n\nS, SD     SD Q01     $S$, $S^{\\dagger}$ gate\n\nT, TD     T Q01     $T$, $T^{\\dagger}$ gate\n\nRX, RY, RZ     RY Q01 0.785     Arbitrary rotation around the X, Y or Z axis with the specified angle\n\nRXY     RXY Q01 0.785 3.14     Q01 rotation of 3.14 rad around the the axis of azimuth angle 0.785\n\nin the XY-plane\n\nAXY     AXY Q01 20 0.75 0.785 -1e6 0.55     Arbitary XY rotation. Example: Q01 arbitrary rotation around the the axis of\n\nazimuth angle 0.785 in the XY-plane with pulse length 20,\n\npulse amplitude 0.75, -1e6 detuning and 0.55 DRAG alpha\n\nCZ, CNOT, SWP, ISWP    CZ G0701     Two qubit gates. Example: CZ gate on coupler G0701\n\nSISWP\n\nCP, FSIM     FSIM G0701 1     Parameterized two qubit gates, with an index to indicate which\n\nparameter set to use. Example: FSIM gate of index 1 on coupler G0701\n\nDTN     DTN Q01 100 -2e6 0     Detune Q01 -2e6MHz for a duration 100 at time offset 0\n\nMEASURE, M     M Q01     Measure qubit Q01\n\nPLS, PLSXY     PLS Q01 1 100 10 0.8 0 0 1     Put a pulse of a waveform index 1 at time 100 with the specified\n\nparameters for Q01\n\nB     B Q01 R01     Establish a time barrier between Q01 and R01\n\nSWD, SWA     SWA Q01 0.8     SET work bias duration, amplitude. The work bias amplitude\n\ndetermines $f_{01}$\n\nMOV,\u00a0...     MOV G0701 0 1     Classical instructions. Example: set value 1 to classical register 0 of G0701\n\nQuantum Control Instruction Set (QCIS)\n\nBy introducing the concept of agent, we decouple the highly entangle quantum processor as well as the shared classical controlling electronics into a collections of separated components, with all the entanglement resolved by the related agents and transparent to upper stream modules. We use a highly decentralized architecture for the agents, all agents function concurrently and directly communicate with each other when necessary. For the only tow central agents, the QProcessor and the Hardware Manager, they only assume minimum light weighted functionalities like instruction dispatching and synchronization to avoid any performance bottle neck. With this architecture, we can process large scale complex quantum operations in a fully concurrent manner, pushing software performance to its limits.\n\nMulti-processing or multi-threading is supported through QThread, one can run multiple experiments concurrently, new experiments can be created and executed immediately without waiting for previous experiments to finished. When an experiment is started, typically one QThread is created with a new context holding a view of the registry and other dynamic settings in each involved QAgent, exposing only a few selected setting entries to be dynamically set for parameter sweeping. Tasks of this experiment is configured with settings from these contexts and executed through time slicing with other QThreads with round-robin scheduling. Several QThreads operating upon distinct agent sets can be configured to run simultaneously to save hardware time. A QThread will go into hibernation after idling for some time to yield resources, and will be awakened upon arrival of new tasks. Multi-user is also support through user, multiple users can run experiments concurrently with completely different settings. QOS works in a server-client mode, a dedicated RPC(Remote Procedure Call) framework is developed for users to interface with QOS, web service and cloud service are also supported.\n\nWe introduce the Quantum Control Instruction Set(QCIS) for the full control of a superconducting quantum processor as list in table\u00a0<ref>. QCIS offers a unified API for operating a quantum processor, with QCIS, we can control the Zuchongzhi system exactly the same way as programming a classical computer. Program written with QCIS are called QProgram. All experiments in this work are implemented with this instruction set. As an example, sweep with the following code snippet executes a tuning of all the iSWAP-like gate related parameters for a swap experiment on G0701, the TTG QAgent between qubits Q01 and Q07:\n\nlanguage=Python,\n\nmorekeywords=SET, X2P, Y2P, XY2P, MOV, CMT, X, FSIM, B, M,\nbasicstyle=,\n\nnumberstyle=,\nframe=tb,\ntabsize=4,\ncolumns=fixed,\nshowstringspaces=false,\nshowtabs=false,\nkeepspaces,\ncommentstyle=,\ncomment=[l]//,\nmorecomment=[s]/**/,\ncommentstyle=,\n\nkeywordstyle=\n[\nbasicstyle=,\n]\nSET G0701 0 30      // set FSIM gate duration to 30*\nSET G0701 1 6       // set qubit pulse rise/fall edge duration to 6\nSET G0701 2 2       // set coupler pulse rise/fall edge duration to 2\nSET G0701 3 -10e6   // set FSIM gate qubit_0 detune to -10e6\nSET G0701 4 20e6    // set FSIM gate qubit_1 detune to 20e6\nSET G0701 5 15e6    // set coupler coupling strength to 15e6\nMOV G0701 0 1       // set value 1 to classical register 0 to indicate that the\n// index of  the FSIM gate for the following CMT action is 1\nCMT G0701 0         // commit settings change, waveforms will be regenerated,\n// caches refreshed etc.\nX Q07               // X gate on Q07\nFSIM G0701 1        // execute the FSIM gate indexed 1 on G0701**\nB Q07 Q01           // establish a time barrier before measurement\nB Q07 R01           // establish a time barrier before measurement\nM Q07               // measure Q07\nM Q01               // measure Q01\n/*\n*: at the creation of QThread, related setting entries are selected and indexed\n**: a coupler can implement multiple FSIM gates of different parameters\n*/\n\nThe following QProgram executes one of the random circuit sampling task in this work:\n\n[\nbasicstyle=,\n]\nX2P Q01\nY2P Q02\nX2P Q03\nY2P Q04\nXY2P Q07 0.785398163397448\nX2P Q08\nY2P Q09\nXY2P Q10 0.785398163397448\nX2P Q11\nXY2P Q12 0.785398163397448\nXY2P Q13 0.785398163397448\nX2P Q14\nXY2P Q15 0.785398163397448\nX2P Q16\nXY2P Q17 0.785398163397448\nXY2P Q19 0.785398163397448\nX2P Q20\nXY2P Q21 0.785398163397448\nXY2P Q22 0.785398163397448\nY2P Q23\nXY2P Q25 0.785398163397448\nXY2P Q26 0.785398163397448\n// ... 30 lines not shown\nXY2P Q61 0.785398163397448\nXY2P Q62 0.785398163397448\nY2P Q63\nY2P Q64\nFSIM G1003 1\nFSIM G1104 1\nFSIM G1408 1\nFSIM G1509 1\n// ... 1809 lines not shown\nM Q50\nM Q51\nM Q52\nM Q53\nM Q55\nM Q56\nM Q57\nM Q58\nM Q59\nM Q61\nM Q62\nM Q63\nM Q64\n\nThe Routine module is a standard library of quantum experiments, implemented mainly for bringing up a superconducting quantum processor. Basic routines are called Samplers. A sampler creates a QThread, provides a task generator for the QThread which then throttles tasks to QPU to be executed. Measured results are send back as an asynchronous stream, which can be subscribed by data handlers to do data processing on the fly. Data handlers could be simple data saving routines, data visualizers or sophisticated pattern recognition routines in data analyzers of a calibrator. All samplers except a few special cases are implemented to run experiments for multiple QAgents in parallel. Upon samplers, calibrators are build to implement a specific calibration task, a calibrator builds one or several samplers with parameters like sweep ranges defined by the specific calibration task, run the sampling tasks, analyze the sampled data and generate a calibration result CalResult for each of its calibration target. The calibration results are then validate by one or several Validators to check whether they are solid. On top of calibrators, a Calibration Controller manages all the calibrators and schedules then to run in a specific scheme, collects calibration results from different calibrators, render results into Calibration Report and update related setting entries according to the results. The calibration controller can run in several modes, fully automated run as a directed graph\u00a0[Kelly, Julian, O'Malley, Peter, Neeley, Matthew, Neven, Hartmut, Martinis, John M, \"Physical qubit calibration on a directed acyclic graph\", 2018], run selected calibrators in a specified series or just run a single calibrator. High flexibly is provided in calibration mode to meet the needs of  experiments, a calibrator can be triggered to run a partial calibration on a subset of its responsible agents or run a series of calibration dividing then into subgroups as opposed to calibrate all agents in parallel. With calibrators and calibration controller, the bring up/calibration procedure can be largely automated.\n\n< g r a p h i c s >\n\nExperiment workflow. The QOS system works in a pipe-lined mode with back pressure control, together with parallel processing at all pipeline stages, software overhead is greatly reduced.\n\nAs a superconducting quantum system is unstable and its parameters drifts with time, fast calibration is key to success. Performance is not just crucial for the kernel, we also designed all the samplers and calibrators with high performance in mind. We use a pipe-lined workflow for the whole system as show in FIG.\u00a0(Figure fig_s_software_2) to minimize software processing overhead. As a result, QOS can run heavy weight experiments like parallel randomized benchmarking on large scale quantum processor with negligible software time overhead. In this work of 66 qubits and 110 couplers, we can perform one round of routine calibration in less than one hour, which includes single qubit gate calibration, single qubit gate XEB fidelity calibration for all the qubits, two qubit gate calibration, two qubit gate XEB fidelity calibration and learn iSWAP-like gate parameters for all the couplers. This experiment time consumption will not grow considerably as it is only limited by hardware time.\n\n## Random quantum circuits\nIn each cycle of the random quantum circuit, single-qubit gates chosen randomly from $\\{\\sqrt X, \\sqrt Y, \\sqrt W \\}$ are first applied on all qubits, and then two-qubit gates, iSWAP-like gate, are applied to pairs of qubits. There are four types of patterns for two-qubit gate, labeled by A, B, C and D respectively, which determine which two-qubit gates are executed on each layer. Different from the single-qubit gates, the four patterns of A, B, C, and D are implemented in the sequence of ABCDCDAB.\n\nIn our experiments, we implement random quantum circuits (RQCs) on the quantum processor, and evaluate the time consumption of simulating these quantum circuits on the traditional supercomputer. So far, there are mainly two types of algorithms for simulating large RQCs: (1) tensor network algorithms\u00a0[Markov, Igor L, Shi, Yaoyun, \"Simulating quantum computation by contracting tensor networks\", 2008] [Guo, Chu, Liu, Yong, Xiong, Min, Xue, Shichuan, Fu, Xiang, Huang, Anqi, Qiang, Xiaogang, Xu, Ping, Liu, Junhua, Zheng, Shenggen, others, \"General-purpose quantum circuit simulator with projected entangled-pair states and the quantum supremacy frontier\", 2019] [Villalonga, Benjamin, Boixo, Sergio, Nelson, Bron, Henze, Christopher, Rieffel, Eleanor, Biswas, Rupak, Mandr\u00e0, Salvatore, \"A flexible high-performance simulator for verifying and benchmarking quantum circuits implemented on real hardware\", 2019] [Villalonga, Benjamin, Lyakh, Dmitry, Boixo, Sergio, Neven, Hartmut, Humble, Travis S, Biswas, Rupak, Rieffel, Eleanor G, Ho, Alan, Mandr\u00e0, Salvatore, \"Establishing the quantum supremacy frontier with a 281 pflop/s simulation\", 2020] [Huang, Cupjin, Zhang, Fang, Newman, Michael, Cai, Junjie, Gao, Xun, Tian, Zhengxiong, Wu, Junyin, Xu, Haihong, Yu, Huanjun, Yuan, Bo, others, \"Classical simulation of quantum supremacy circuits\", 2020] [Pan, Feng, Zhang, Pan, \"Simulating the Sycamore quantum supremacy circuits\", 2021] [Guo, Chu, Zhao, Youwei, Huang, He-Liang, \"Verifying Random Quantum Circuits with Arbitrary Geometry Using Tensor Network States Algorithm\", 2021] and (2) Schr\u00f6dinger-Feynman algorithm (SFA). The time-consuming of the SFA is significantly connected to the structure of four patterns A, B, C, and D, which could be regarded as a criteria for designing the structure of RQCs. The basic procedure of SFA can be summarized as follows: (1) Firstly, cut a $n$-qubit quantum circuit into two partitions with $n_1$ and $n_2$ qubits. (2) Then by summing all simulation paths that are the product of the terms of the Schmidt decomposition of all cross-partition gates, one could obtain the output state of the quantum circuit. The computational complexity of the algorithm is proportional to $(2^{n_1} + 2^{n_2})r^g$, where $r$ is the Schmidt rank, and $g$ is the number of the cross-partition gates. The iSWAP-like gate used in our scheme has the Schmidt rank of $r=4$. Thus, when evaluating the runtime of the SFA, one needs to find the optimal cut with $n_1$, $n_2$ and $g$ that makes the simulation task to become the easiest. In addition, for a circuit cut, if the following formations occur, both $r$ and $g$ may be reduced, resulting in a reduction in the computational complexity of the SFA algorithm:\n\n1) Wedge formation. As shown in Fig.\u00a0<ref>, a wedge formation is formed when two consecutive cross-partition gates share a qubit, which can reduce the Schmidt decomposition of resulting three-qubit unitary to only four terms. Equivalently, every wedge reduces a cross-partition gate, and provides a speedup of a factor of 4.\n\n2) DCD formation. The DCD formation often happens at the boundary. Specifically, the DCD formation appears when there are three successive two-qubit gates acting on the qubit pairs $(a,b)$, $(b,c)$ and $(a,b)$, and these three gates can be fused in one (the two gates on qubit pairs $(a,b)$ can be fused). A DCD formation provides a speedup of a factor of 4.\n\n3) Formation of iSWAP-like gates at the start and end of the circuit. The iSWAP-like gate is the product of a iSWAP and controlled phase gate, and the iSWAP gate can be applied either at the beginning or at the end of the sequence. We apply this transformation to all iSWAP-like gates at the beginning (end) of the circuit that affect qubits that are not affected by any other two-qubit gate before (after) in the circuit. The iSWAP is then applied to the input (output) qubits and their respective one-qubit gates trivially, and the bond dimension remaining from this iSWAP-like gate is 2, corresponding to a controlled phase gate, as opposed to the bond dimension 4 of the original iSWAP-like gate. Thus, A iSWAP-like gate that appears at the same time in the cross-partition and the beginning (or end) of the circuit can provide a speedup of a factor of 2.\n\n< g r a p h i c s >\n\nWedge formation. The gate highlighted in blue and green on the cut line are crosspartition gates. A wedge is formed when two consecutive crosspartition gates share a qubit.\n\nTo ensure the computational complexity and classical hardness with low depth, the number of cross-partition gates $g$ on the optimal cut should be large enough, and the four patterns should be carefully designed to avoid the occurrence of above three formations as much as possible.\n\nFigure\u00a0<ref>(a) shows an example of the topology of a quantum processor. The red dot represents the qubit, and the black line represents the two-qubit gate between two qubits. These two-qubit gates can be divided into two categories: ${G_{45^\\circ }}$ and ${G_{135^\\circ }}$, which are represented as 45 degree lines (see Fig.\u00a0<ref>(b)) and 135 degree lines (see Fig.\u00a0<ref>(b)), respectively. For efficient implementation on the quantum hardware, every two different two-qubit gates in each pattern should not share the same qubit. Thus, pattern ${G_{45^\\circ }}$ is split into pattern A and pattern B (see Fig.\u00a0<ref>(c)). Similarly, pattern ${G_{135^\\circ }}$ is split into pattern C and pattern D (see Fig.\u00a0<ref>(d)). Patterns A, B, C, and D could have different structures, and once pattern A (or C) is determined, then the structure of pattern B (or D) is determined. To design the optimal patterns of A, B, C, and D for a specific quantum processor, a search strategy is proposed as shown below:\n\n(1) Set constraints, including the topology of the processor, the circuit depth of RQC, the sequence of four patterns (usually ABCDCDAB), and the maximum permissible number of two-qubit gates in the partition.\n\n(2) Set the structures of patterns of A, B, C, and D.\n\n(3) According to the conditions in (1) and (2), search for the optimal cuts with the least number of effective crosspartition gates, where the number of effective crosspartition gates $L$ is determined using the following formula,\n$$\n\nL=g_{\\text{cut}}-g_{\\text{wedge}}-g_{\\text{DCD}}-\\frac{g_{{\\text{start,end}}}}{2}\n\\label{eq:1}\n\n$$\nwhere $g_{\\text{cut}}$ is the number of crosspartition gates, $g_{\\text{wedge}}$ is the number of wedge formations, $g_{\\text{DCD}}$ is the number of DCD formations, and $g_{{\\text{start,end}}}$ is the number of the formations of iSWAP-like gates at the start and end of the circuit. Step (3) outputs the optimal cut and the number of corresponding effective crosspartition gates, denoted as $\\text{Min}_L$, which determines the computational complexity of SFA for simulating the circuit designed with the set patterns.\n\nRepeat steps (2) and (3) to search for the optimal patterns that have the  maximum $\\text{Min}_L$. Figure\u00a0<ref> and Figure\u00a0<ref> show the optimal patterns of A, B, C, and D that we have searched for 56-qubit RQC with 20 cycles and the corresponding promising cut, respectively.\n\n< g r a p h i c s >\n\nThe relationship of A, B, C, and D patterns. (a) An example of the topology of a quantum processor. The red dot represents the qubit, and the black line represents the two-qubit gate between two qubits. (b) These two-qubit gates can be divided into two categories: ${G_{45^\\circ }}$ and ${G_{135^\\circ }}$, which are represented as 45 degree lines and 135 degree lines, respectively. (c) The pattern ${G_{45^\\circ }}$ is split into pattern A and pattern B. (d) The pattern ${G_{135^\\circ }}$ is split into pattern C and pattern D. Patterns A, B, C, and D could have different structures, here we list some examples of pattern C.\n\n< g r a p h i c s >\n\nCoupler activation patterns for 56 qubits. Coupler activation pattern for 56 qubits that determines which qubits are allowed to interact simultaneously in a cycle.\n\n< g r a p h i c s >\n\nQubit ordering and optimal cut for 56-qubit circuit with 20 cycles. This order determines which qubits are used for $n$ qubits experiments. The green lines form the optimal cut for 56-qubit circuit with 20 cycles.\n\n## XEB result analysis\n### XEB fidelity\nFor a set of bitstrings $\\{q_i\\}$, the cross-entropy benchmarking (XEB) fidelity is estimated from the ideal probabilities $\\{p_i=p_s(q_i)\\}$ as\n$$\n\nF_l = \\langle Dp\\rangle  - 1\n\\label{linearXEB}\n\n$$\n$$\n\nF_c = \\langle \\log (Dp)\\rangle  + \\gamma\n\\label{logarithmicXEB}\n\n$$\nwhere $F_l$ is the linear XEB, $F_c$ is logarithmic XEB, and $\\gamma\\approx 0.577$ is the Euler-Mascheroni constant.\n\n### Prediction of circuit fidelity\nAs shown in Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019], the predicted fidelity $F$ could be calculated from a simple multiplication of individual operation fidelities as\n\n$$\n\nF{\\rm{ = }}\\prod\\limits_{g \\in {G_1}} {(1 - {e_g})} \\prod\\limits_{g \\in {G_2}} {(1 - {e_g})} \\prod\\limits_{q \\in Q} {(1 - {e_q})}\n\\label{fidelitycal}\n\n$$\nwhere $e_g$ are the individual gate Pauli errors, $G_1$ and $G_2$ are the set of single-qubit gates and two-qubit gates, respectively, $Q$ is the set of qubits, and $e_q$ are the state preparation and measurement errors of individual qubits.\n\n### Performance of patch circuits and elided circuits\nConsidering that it is unrealistic to verify the fidelity of the large-scale quantum circuits on current supercomputer, thus two verifiable quantum circuits, patch circuits and elided circuits, are introduced to provide approximate predictions of system performance. In the patch circuits, all two-qubit gates across the partitions are elided, which is essentially two disconnected circuits running in parallel. Compared to patch circuits, only a fraction of the two-qubit gates along the cut during a few early cycles of the sequence is elided in the elided circuits.\n\nWe evaluate the efficacy of using patch circuits and elided circuits for performance estimation via a direct comparison with full circuits. In Fig.\u00a0<ref>, the XEB fidelities measured by full, patch and elided circuit of systems from 15 to 56 qubits with 10 cycles are displayed. The fidelities derived from patch and elided circuits exhibit a consistent exponential decay with system size, and are in good agreement with the fidelities obtained with the corresponding full circuits. The average ratio of patch circuit and elided circuit fidelity to full circuit fidelity over all verification circuits are found to be 1.05 and 1.10, with a standard deviation of 8\n\n< g r a p h i c s >\n\nPerformance of patch circuits and elided circuits. Patch, elided and full circuit XEB fidelity from 15 to 56 qubits with 10 cycles, showing patch and elided circuits yields a fidelity value that is in good agreement with the one obtained with the corresponding full circuits. Each data point is averaged over 6 quantum circuit instances.\n\n### Distribution of bitstring probabilities\nFor a circuit with sufficient depth, the distribution should be consistent with the theoretical prediction. For the bitstrings with fidelity using linear XEB, the theoretical PDF for the bitstring probability $p$ is\n$$\n\nP_l (x|\\hat{F_l} ) = (\\hat{F_l} x+(1-\\hat{F_l} ))e^{-x}\n\n$$\nwhere $x \\equiv Dp$ is bitstring probability scaled by the dimension $D$.\n\nThe PDF for logarithmic XEB is\n$$\n\nP_c (x|\\hat{F_c}) = (1+\\hat{F_c}(e^x-1))e^{x-e^x}\n\n$$\nwhere $x \\equiv log(Dp)$.\n\nFor our elided quantum circuit with 56 qubits and 20 cycles, we sample around $1.9 \\times 10^7$ bitstrings from each of 10 instances and calculate the linear XEB $\\hat{F_l}$ or logarithmic XEB $\\hat{F_c}$. Then we calculate the ideal probability $p$ of each bitstring to check whether it fits the theoretical curve $P_l (x|\\hat{F_l} ) $ and $P_c (x|\\hat{F_c}) $. The result of one circuit instance is shown in Fig.\u00a0<ref>.\n\n< g r a p h i c s >\n\nDistribution of bitstring probabilities from a 56-qubit 20 -cycle circuit. The theoretical curve is computed with the experimental XEB fidelity and experimental data is counted by histogram.  (a) The theoretical curve $P_l (x|\\hat{F_l} )$ and experimental distribution of $Dp$. (b) The theoretical curve $P_c(x|\\hat{F_c} )$ and experimental distribution of log($Dp$).\n\n< g r a p h i c s >\n\nThe Kolmogorov-Smirnov test results. $D_{KS}$ and p-values are shown for linear XEB (upper) and log XEB (lower).\n\nWe further use Kolmogorov-Smirnov test (K-S test)\u00a0[Lehmann, Erich L, Romano, Joseph P, \"Testing statistical hypotheses\", 2006] to quantify the agreements between experiment data and theoretical curve. K-S test quantifies a distance between the empirical cumulative distribution and the hypothetic cumulative distribution function, denoted as $D_{KS}$. $D_{KS}$ can be converted to $p$-value according to  Kolmogorov distribution function. We use $p$-value to judge whether the hypothesis is good. We use kstest function in the scipy package\u00a0[Jones, Eric, Oliphant, Travis, Peterson, Pearu, others, \"SciPy: Open source scientific tools for Python\", 2001] with the null hypothesis of $F=\\hat{F}$. For comparison, we implement KS-test with the null hypothesis of $F=0$ as well.\n\nWe measure the XEB and do KS-test with bitstrings from ten instances combined. The linear XEB and logarithmic XEB  fidelities from the combined bitstrings are $\\hat{F_l}=6.60 \\times 10^{-4}$ and $\\hat{F_c}=5.80 \\times 10^{-4}$, respectively. The KS-test results are shown in table\u00a0(Table: Results of combined Kolmogorov-Smirnov test for random circuits with 56-qubit, 20 cycles.). With null hypothesis of $F=0$, the p-value is around $9.7\\times 10^{-11}$. We can reject the null hypothesis confidently.\n\n1|l|     2c|linear XEB         4c|log XEB\nhypothesis                 $F=\\hat{F_l}$     $F=0$                   $F=\\hat{F_c}$       3c|$F=0$\n$p$-value                    0.23              $9.7\\times 10^{-11}$     0.66                3c|$9.7\\times 10^{-11}$\n\nResults of combined Kolmogorov-Smirnov test for random circuits with 56-qubit, 20 cycles.\n\n### Statistical uncertainties\nWe estimate the statistical uncertainty of XEB measurements with standard error-on-mean formula\n$$\n\\begin{array}{l}\n\\hat{\\sigma}_{F_{l}}=D \\sqrt{\\operatorname{Var}(p) / N_{s}}, \\\\\n\\hat{\\sigma}_{F_{c}}=\\sqrt{\\operatorname{Var}(\\log Dp) / N_{s}},\n\\end{array}\n\\label{eq.3}\n\n$$\nwhere Var($x$) is the variance estimator of sample $\\{x_i\\}$. We use inverse-variance weighting to estimate the fidelity and statistical uncertainty of all nine 56-qubit and 20-cycle random circuits, yields the results of $\\hat{F_{l}} = (6.62\\pm 0.72)\\times 10^{-4}$ for linear XEB and $\\hat{F_{c}} = (5.82\\pm 0.92)\\times 10^{-4}$ for logarithmic XEB. The theoretical prediction of the statistical uncertainty of linear XEB $\\hat{F_{l}}$ and logarithmic XEB  $\\hat{F_{c}}$ are\n\n$$\n\\begin{array}{l}\n\\hat{\\sigma}_{F_{l}}=\\sqrt{\\left(1+2 F-F^{2}\\right) / N_{s}},\\\\\n\\hat{\\sigma}_{F_{c}}=\\sqrt{\\left(\\pi^{2} / 6-F^{2}\\right) / N_{s}},\n\\end{array}\n$$\nwhich are calculated as $\\hat{\\sigma}_{F_{l}} = 7.2\\times 10^{-5}$ and $\\hat{\\sigma}_{F_{c}} = 9.2\\times 10^{-5}$, respectively, indicating good agreements between experiment and theory.\n\nWe further use bootstrap method to verify the estimate of statistical uncertainties. For a 56-qubit 20-cycle circuit, we sample  bitstrings from experiment and calculate their ideal probabilities to be the original sample. We acquire 2500 bootstrap samples from the original one and compute $F=\\hat{F_l}$, $F=\\hat{F_c}$ of every sample. We expect the set of $F=\\hat{F}$ follow Gaussian distribution under the central limit theorem. The fidelity distribution of bootstrap samples with Gaussian fit are shown in Fig.\u00a0<ref>.\nWe compare the statistical uncertainty obtained from equation (<ref>), Gaussian fit and the standard deviation of the bootstrap distribution. The results are $2.41, 2.40, 2.36(\\times 10^{-4})$ for $\\hat{\\sigma}_{F_{l}}$ and $3.09, 3.16, 3.07(\\times 10^{-4})$ for $\\hat{\\sigma}_{F_{c}}$. It indicates great consistency within $3\\%$ relative difference.\n\n< g r a p h i c s >\n\nFidelity distribution of bootstrap samples. (a) Linear XEB distribution. (b) Log XEB distribution.\n\n## classical simulation\nThe efficiency of Schr\u00f6dinger simulator\n\nIn the hybrid Schr\u00f6dingerFeynman algorithm (SFA) simulator, each path is simulated using the Schr\u00f6dinger algorithm (SA). The Schr\u00f6dinger algorithm is a full state vector simulator for simulating quantum circuit. It computes all $2^n$ amplitudes, where $n$ is the number of qubits. In this section, we will test the performance of the Schr\u00f6dinger simulator.\n\nFollowing the work in Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019], gate fusion\u00a0[Smelyanskiy, Mikhail, Sawaya, Nicolas PD, Aspuru-Guzik, Al\u00e1n, \"qHiPSTER: The quantum high performance software testing environment\", 2016] and single precision arithmetic are used in our simulator. We simulate quantum circuits on a single node server that has 1536 GB memory and four CPUs (Intel-Xeon-Gold-6254, 3.1G) with 18 cores each. To compare with the performance of the Schr\u00f6dinger simulator in Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019], we test random circuits with different sizes at depth 14. The run times are listed in Table \u00a0(Table tab:Schrodinger simulator). Results show that the performance of our simulator is basically the same as that of Google\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019].\n\nnumber of qubits       crun time in seconds\n(ours)     crun time in seconds\n(Google's\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019])\n\n$30 $     24        NA\n\n$32$     93         111\n\n$33$     190        NA\n\n$34$     362        473\n\n$36$     1836       1954\n\nCircuit simulation run times using Schr\u00f6dinger simulator.\n\n### Tensor network simulator\nTensor network contraction (TNC) algorithm translates the task of computing a single or a branch of amplitudes into contracting a tensor network, where each tensor corresponds to a quantum gate operation. The complexity of TNC algorithm is controled by the largest intermediate tensor which appears during the contraction, which is also related to the tree width of the line graph corresponding to the tensor network. As a result the ultimate performance of TNC algorithm is determined by the underlying tensor contract path. In this work we use the python package cotengra to find an optimal tensor contraction path, which has been demonstrated to be able to reproduce the state of the art results in Ref.\u00a0[Huang, Cupjin, Zhang, Fang, Newman, Michael, Cai, Junjie, Gao, Xun, Tian, Zhengxiong, Wu, Junyin, Xu, Haihong, Yu, Huanjun, Yuan, Bo, others, \"Classical simulation of quantum supremacy circuits\", 2020] [Pan, Feng, Zhang, Pan, \"Simulating the Sycamore quantum supremacy circuits\", 2021]. For each random quantum circuit, we repeated the 100 path search procedure to determine the optimal tensor contraction path and use its corresponding number of floating point operations for contraction as the estimated computational cost.\n\nIn the main text, the modified frugal rejection sampling\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] [Markov, Igor L, Fatima, Aneeqa, Isakov, Sergei V, Boixo, Sergio, \"Quantum supremacy is both closer and farther than it appears\", 2018] with acceptance probability $1$ is used to estimate the cost of tensor network algorithm on specific circuits\u00a0[Villalonga, Benjamin, Boixo, Sergio, Nelson, Bron, Henze, Christopher, Rieffel, Eleanor, Biswas, Rupak, Mandr\u00e0, Salvatore, \"A flexible high-performance simulator for verifying and benchmarking quantum circuits implemented on real hardware\", 2019] [Huang, Cupjin, Zhang, Fang, Newman, Michael, Cai, Junjie, Gao, Xun, Tian, Zhengxiong, Wu, Junyin, Xu, Haihong, Yu, Huanjun, Yuan, Bo, others, \"Classical simulation of quantum supremacy circuits\", 2020]. In Ref.\u00a0[Pan, Feng, Zhang, Pan, \"Simulating the Sycamore quantum supremacy circuits\", 2021], a subspace sampling trick is proposed, which has been proven to be able to fool linear XEB. However, it is easy to distinguish this type of sampling, since some positions in the sampled bitstrings are fixed to 0, such as $x_1x_2x_3x_400000000$, where $x_i$ is a variable bit.\n\nIn Ref.\u00a0[Huang, Cupjin, Zhang, Fang, Newman, Michael, Cai, Junjie, Gao, Xun, Tian, Zhengxiong, Wu, Junyin, Xu, Haihong, Yu, Huanjun, Yuan, Bo, others, \"Classical simulation of quantum supremacy circuits\", 2020] [Pan, Feng, Zhang, Pan, \"Simulating the Sycamore quantum supremacy circuits\", 2021], the actual cost of tensor network contraction using GPU is provided, which could be regard as reference to estimate the actual cost of our circuit in supercomputer, such as Summit (Summit has 27,648 GPUs in total, but Fugaku has no GPUs, therefore we utilize Summit to determine the actual cost). Take the results in Ref.\u00a0[Huang, Cupjin, Zhang, Fang, Newman, Michael, Cai, Junjie, Gao, Xun, Tian, Zhengxiong, Wu, Junyin, Xu, Haihong, Yu, Huanjun, Yuan, Bo, others, \"Classical simulation of quantum supremacy circuits\", 2020] as an example, it would cost 833.75s to generate one perfect sample for a tensor network with $6.66\\times 10^{18}$ contraction cost using Summit. Thus, it would cost $\\frac{{1.10 \\times {{10}^{22}}}}{{6.66 \\times {{10}^{18}}}} \\times 833.75\\text{s}{\\rm{ = }}15.9$ days and $\\frac{{2.08 \\times {{10}^{24}}}}{{6.66 \\times {{10}^{18}}}} \\times 833.75\\text{s}{\\rm{ = }}8.24$ years to reproduce the same results as the 53-qubit 20-cycle circuit in Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] and our 56-qubit 20-cycle circuit using Summit.\n\n### Computational cost estimation of SFA for the sampling task\nHere, we estimate the computational cost of simulating 56 qubit full-circuits using SFA. For the 56-qubit random circuit with 20 cycles, there are 42 gates cross the cut. The iSWAP-like gate has a Schmidt rank of 4. However, the first one and last three iSWAP-like gates can be simplified to cphase with a Schmidt rank of 2. In the case of simulating quantum circuit with $100\\%$ fidelity, a total of $ 4 ^ {38} \\times 2^4$ paths must be calculated. By using the technique of prefix\u00a0[Markov, Igor L, Fatima, Aneeqa, Isakov, Sergei V, Boixo, Sergio, \"Quantum supremacy is both closer and farther than it appears\", 2018] to optimize the simulator, we set a prefix of 35 cross gates (a cross gate can be simplified to a cphase gate), thus requiring $4^{34}\\times 2^{1}$ separate runs.\n\nWe simulate the quantum circuit for the first 10 prefix values on a single node server that has 1536 GB memory and four CPUs (Intel-Xeon-Gold-6254, 3.1G) with 18 cores each.\n\nThe average execution time for each prefix is 19560 seconds using single core and single thread. Thus, it is estimated that it will consume $1.06\\times 10^{18}$ core (two hyperthreads) hours to simulate the 56-qubit 20-cycle circuit with 0.0662\n\n# of qubits     cycle     number of paths     fidelity     run time (years)\n\n$53 $     20        $4^{31}\\times2^4$     0.224$\\%$      1,332\n\n$56 $     20        $4^{38}\\times2^4$ (balance)     0.0662$\\%$      15,887,738\n\n$56 $     20        $4^{35}\\times2^6$ (imbalance)     0.0662$\\%$      8,612,623\n\nRun times of SFA using 7,630,848 CPU cores (the most powerful supercomputer Fugaku has a total of 7,630,848 cores).\n\nWe note that in the results in Table\u00a0(Table tab:qsimhruntime), we also provide a result of using the imbalance cut shown in Fig.\u00a0<ref>, which consumes less time ($5.76\\times10^{17}$ core hours) but consumes more storage space. In addition, we did not consider the DCD formation in our estimation. The DCD formation appears twice in our 56-qubit 20-cycle circuit, and also twice in Google's 53-qubit 20-cycle circuits. Thus, after considering the simulating speedup by DCD formation, we have\n$$\n\n\\frac{{{T_{56\\_20}}}}{{{T_{53\\_20}}}} = \\frac{{\\frac{{8612623~\\text{years}}}{{{4^2}}}}}{{\\frac{{1332~\\text{years}}}{{{4^2}}}}} \\approx 6466\n\n$$\nwhere ${{T_{56\\_20}}}$ and ${{T_{53\\_20}}}$ are the run time of simulating our 56-qubit 20 cycle circuit and Google's 53-qubit 20-cycle circuit, respectively. That is, using the SFA algorithm, the computational cost of simulating our 56-qubit 20-cycle circuit is about 6466 times that of Google's 53-qubit 20-cycle circuit.\n\n< g r a p h i c s >\n\nImbalance cut. We set the allowed imbalance of two partitions to 20 ($n_1-n_2\\le20$), and employ the search strategy in Section IV to find the optimal cut. The number of qubits in the two partitions are 32 and 24, respectively.\n\n### Classical speedup for imbalanced gates\nThe iSWAP-like$(\\theta ,\\phi )$ gate has the following Schmidt singular values:\n$$\n\n{\\lambda _1} &= \\sqrt {1 + 2 \\cdot |cos(\\phi /2)cos\\theta | + co{s^2}\\theta },\\\\\n{\\lambda _2} &= \\sin (\\theta ),\\\\\n{\\lambda _3} &= \\sin (\\theta ),\\\\\n{\\lambda _4} &= \\sqrt {1 - 2 \\cdot |cos(\\phi /2)cos\\theta | + co{s^2}\\theta },\n\n$$\n\nWe have $\\theta  \\approx \\pi /2$ and $\\phi  \\approx \\pi /6$ in our experiment, so ${\\lambda _i} \\approx 1,{\\kern 1pt} {\\kern 1pt} \\forall i \\in \\{ 1,2,3,4\\} $. When simulating the random circuit sampling with a target fidelity using SFA simulator, inbalanced iSWAP-like gates can provide acceleration for the simulation.  According to the Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019],\n\nif $100\\%$ fidelity is required, a total of $ 4 ^ g $ paths must be calculated. However, given a target fidelity, $F$, one need consider only the top $S$ paths with the highest weight, making\n$$\n\nF = \\sum\\nolimits_{i = 1}^S {\\frac{{{W_i}}}{{{4^g}}}},\n\n$$\nwhere ${W_i} = \\lambda _{{i_1}}^2\\lambda _{{i_2}}^2 \\ldots \\lambda _{{i_g}}^2$ is the weight of each path arising from this decomposition. For comparison, if all iSWAP-like gates are balanced with $\\theta {\\rm{ = }}\\pi /2$, the number of paths needs to be considered is $F \\times {4^g}$. Thus, imbalanced gates provides a\nspeedup equal to $\\frac{S}{{F \\times {4^g}}}$.\n\n< g r a p h i c s >\n\nCumulative probability distribution of $|{\\delta _\\theta }|$ for iSWAP-like gates. In experiment, we have an average $|\\delta_{\\theta}| \\approx 0.036$ for all iSWAP-like gates. The resulted speedup of classical simulation is less than an order.\n\n< g r a p h i c s >\n\nClassical speedup given by the imbalance gates. We assume all iSWAP-like gates deviate from $\\pi/2$ by the same $\\delta_{\\theta}$ and calculate the speedup with given $g$ and $F$. Left: speedup with varied fidelity $F$ and fixed $g=42$. Right: speedup with varied g and fixed $F=0.0662 \\%$.\n\n< g r a p h i c s >\n\nRuntime advantage region of different error rates. The colored regions indicate classical runtime advantage beyond the quantum computer within the limit of supercomputer memory. Runtime advantage depends on the circuit depth $m$ and number of qubits $n$. Red and blue region indicates SA advantage and SFA advantage, respectively. The black contours indicate runtime of quantum computer.\n\nFrom (a) to (c), the average error rates of quantum computer are $2\\times, 1\\times, 0.5\\times$ our current experimental error rates.\n\nIn our experiment, the iSWAP-like gate that need to be decomposed is iSWAP-like$(\\pi/2 \\pm {\\delta _\\theta },\\phi  \\approx \\pi /6)$, and $|{\\delta _\\theta }|$ has values of around 0.036 radians (see Fig.\u00a0<ref>). The speedup can be achieved from the imbalanced gates is shown in Fig.\u00a0<ref>. For the case of random circuit sampling with $n=56$ qubits and $m=20$ cycles, the fidelity is around $F=0.0662\\%$ and the number of iSWAP-like gate need to be decomposed is $g=42$ using SFA simulator, the speedup estimated would be well below an order of magnitude (see Fig.\u00a0<ref>).\n\n### Quantum runtime advantage region\nTensor network algorithms may have higher simulation efficiency at low depths. However, for large-scale quantum circuit with high depth, SFA is still the most efficient algorithm at present. In this section, we first analyze the scaling of the computational cost of SA and SFA, then we give a rough estimate of the quantum runtime advantage region. There may be other classical simulator with better performance, but this estimate is just to illustrate the importance of improving the fidelity of quantum operations, including quantum gates and readouts.\n\nFor a $n$-qubit quantum circuit with $m$ cycles, the runtime of SA is estimated as\n$$\n\nT_{\\text{SA}} = C_{\\text{SA}} ^{-1} \\cdot mn \\cdot 2^n\n\n$$\nwhere the constant $C_{\\text{SA}}$ is fit to the actual runtime of a state-of-the-art supercomputer. SA needs $2^{n+1}$ bytes to store the complex state vector. Considering that state-of-the-art supercomputers have less than 3 PB of memory, the maximum number of qubits that can be simulated using the SA simulator is 51 at most.\n\nFor SFA, the runtime is proportional to the number of paths and the time to simulate patches. In Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019], the circuit is cut into 2 patches.\n\nHowever, for larger-scale quantum circuits, we can cut the circuit into more than 2 patches. According to the Ref.\u00a0[Zlokapa, Alexander, Boixo, Sergio, Lidar, Daniel, \"Boundaries of quantum supremacy via random circuit sampling\", 2020],  we need to simulate the $2^{kpBm\\sqrt{n}}F$ paths for $p$ patches, where  $k=1/2+1/p$, $B=0.24$, and $F$ is the fidelity of circuit. The time to simulate each patch scales with $2^{n/p}$. In addition, we compute the partial amplitudes of min$(F^{-2},2^n)$ bitstrings after simulating each patch. In total, the runtime is\u00a0[Zlokapa, Alexander, Boixo, Sergio, Lidar, Daniel, \"Boundaries of quantum supremacy via random circuit sampling\", 2020]\n$$\n\nT_{\\text{SFA}}=C_{\\text{SFA}}^{-1} 2^{kpBm \\sqrt{n}} F (p 2^{n/p} + \\text{min}(F^{-2},2^n)),\n\n$$\nwhere $C_{\\text{SFA}}$ is fit to the actual runtime of a state-of-the-art supercomputer. We can optimize the runtime with  $F^{-2} = p 2^{n/p}$ for $n>\\text{log}_{2}(p) /(1-1/p)$. SFA requires $2p2^{n/p}$ bytes per path. Assuming that each path is simulated by a single core, then we estimate the total memory footprint to be $10^6 \\cdot 2p2^{n/p}$ for a supercomputer with 1M cores. Memory usage limits the number of patches, which should be taken into account when optimizing the runtime of SFA.\n\nWe compare the runtime of classical simulation with quantum runtime to give a rough estimate of the quantum runtime advantage region. For this purpose, we use the classical fitting constants in Ref.\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] to continue the discussion.\n$$\n\n\\begin{aligned}\n&C_{\\text{SA}}= 0.015 \\times 10^6 \\text{GHz}  \\\\\n&C_{\\text{SFA}}= 3.3 \\times 10^6 \\text{GHz}\n\\end{aligned}\n\\label{eq.9}\n\n$$\n\nThe runtime of quantum computer is proportional to the number of samples. To ensure the standard deviation is less than the fidelity, i.e. $\\sigma \\leq F_{\\text{XEB}}$, at least $1/F^2$ samples are required. The runtime of quantum computer scales as\n$$\n\nT_{\\text{Q}} = \\frac{1}{C_{\\text{QC}} \\cdot F^2}\n\n$$\nwhere $C_{\\text{QC}}=\\frac{1}{230}$MHz is the actual sampling rate of our quantum computer.\n\nTo compare the runtime of different methods, we fit constants in Eq.\u00a0<ref> and $F$ from Eq.\u00a0<ref> into the runtime estimation discussed above and optimize the runtime of SFA. In addition, the memory constraint is taken into account. The result is shown in Fig.<ref>. The quantum advantage region (white) indicates the ability of quantum computer beyond classical computer. It is worth mentioning that the quantum advantage region enlarges rapidly when error rates decline, indicating the importance of low error rates.\n\napsrev4-1\n\n"}
{"prompt": "What are the key contributions of the paper 'Flat-band localization and interaction-induced delocalization of photons'?", "completion": "\n\nleft=0.8in,right=0.8in,top=0.8in,bottom=0.8in\n\n# Flat-band localization and interaction-induced delocalization of photons\n\nPrinceton University, Department of Electrical and Computer Engineering\n\nPrinceton University, Department of Electrical and Computer Engineering\n\nPrinceton University, Department of Electrical and Computer Engineering\n\nPrinceton University, Department of Electrical and Computer Engineering\n\nAdvances in quantum engineering have enabled the design, measurement, and precise control of synthetic condensed matter systems [Unknown Author, \"Unknown Title\", ].\nThe platform of superconducting circuits offers two particular capabilities [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]: flexible connectivity of circuit elements that enables a variety of lattice geometries, and circuit nonlinearity that provides access to strongly interacting physics.\nSeparately, these features have allowed for the creation of curved-space lattices [Unknown Author, \"Unknown Title\", ] and the realization of strongly correlated phases [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and dynamics [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] in one-dimensional chains and square lattices.\nMissing in this suite of simulations is the simultaneous integration of interacting particles into lattices with unique band dispersions, such as dispersionless flat bands.\nAn ideal building block for flat-band physics is the Aharonov-Bohm cage [Unknown Author, \"Unknown Title\", ]: a single plaquette of a lattice whose band structure consists entirely of flat bands.\nHere, we experimentally construct an Aharonov-Bohm cage and observe the localization of a single photon, the hallmark of all-bands-flat physics.\nUpon placing an interaction-bound photon pair into the cage, we see a delocalized walk indicating an escape from Aharonov-Bohm caging [Unknown Author, \"Unknown Title\", ].\nWe further find that a variation of caging persists for two particles initialized on opposite sites of the cage.\nThese results mark the first experimental observation of a quantum walk that becomes delocalized due to interactions and establish superconducting circuits for studies of flat-band-lattice dynamics with strong interactions.\n\nFlat electronic bands quench the kinetic energy of electrons and provide a lattice environment that is uniquely susceptible to interactions, disorder, and particle statistics.\nAs a result, they can host a wide range of phenomena, from itinerant ferromagnetism in spinful systems [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to the fractional quantum Hall effect [Unknown Author, \"Unknown Title\", ], fractional Chern insulator states [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and strongly correlated phases observed in magic-angle twisted bilayer graphene [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThe role of flat bands in high-temperature superconductivity [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and quantum thermalization [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], as well as searches for novel flat-band materials [Unknown Author, \"Unknown Title\", ], are also active areas of research.\n\nMany types of flat bands have been theoretically explored and classified, frequently within the tight-binding model of solids where flat bands can result from specific features in lattice geometry [Unknown Author, \"Unknown Title\", ].\nA simple example is the one-dimensional rhombus lattice, which contains three sites per unit cell and exhibits a flat middle band that touches dispersive bands above and below (see Fig. (Figure fig:setup)a).\nAs with many flat bands, the eigenstates within the band can be written in a basis of real-space eigenfunctions known as compact localized states [Unknown Author, \"Unknown Title\", ].\nThese states are characterized by a strict boundedness on the number of sites involved in the particle wavefunction, reflecting stronger localization than the more typical exponential localization of Wannier functions.\nAt the same time, because dispersive bands are present in the band structure, an initially localized particle generically contains contributions from dispersive states and will delocalize across the lattice over time.\n\nA type of extreme localization, in which every band of the spectrum is flat, emerges in select lattices and specific values of magnetic flux, including the rhombus lattice with $\\pi$ flux.\nThe effect of magnetic flux on localization depends heavily on lattice geometry and can be understood through the Aharonov-Bohm effect.\nMore specifically, the tight-binding electron accumulates an Aharonov-Bohm phase as it hops around a closed loop of the lattice, or plaquette.\nAdditionally, the lattice plaquettes are arranged in such a way that causes complete destructive wavefunction interference beyond some region of the lattice and localizes the electron to a finite number of sites.\nThis phenomenon is known as Aharonov-Bohm \u201ccaging\u2019\u2019 [Unknown Author, \"Unknown Title\", ].\nIn the rhombus lattice, Aharonov-Bohm caging occurs at a magnetic field of half a flux quantum through each plaquette, corresponding to a geometric phase of $\\pi$.\nAll three bands become flat and a complete basis of only compact localized states becomes possible (Fig. (Figure fig:setup)b).\nAccordingly, any initially localized particle will be in a superposition of a finite number of compact localized states and therefore will remain bounded in time.\n\nCrucially, because of strict boundedness, the key physics of Aharonov-Bohm caging can be accessed through a single plaquette of the rhombus lattice with $\\pi$ flux.\nIn this four-site system, the eigenstates (Fig. (Figure fig:setup)d) exhibit similarities to the compact localized states of its lattice counterpart, despite having energies that differ from the continuum limit.\nIn particular, none of these states extend across an entire plaquette, purely due to the same destructive wavefunction interference effects that give rise to Aharonov-Bohm caging in a lattice.\n\nIn this work, we leverage the flexible connectivity of superconducting circuits in a novel manner to realize one of these plaquettes, which we refer to as an Aharonov-Bohm cage.\nTo allow geometric phase accumulation for microwave photons, which do not inherently respond to magnetic fields due to their neutral charge, we realize a $\\pi$-flux synthetic gauge field via a negative tunneling between two sites in the plaquette.\nWe show how this negative tunneling allows us to turn on caging, by comparison to an analogous device without synthetic field.\nNext, we use on-site interactions between particles to demonstrate a bound particle pair escaping the cage.\nFinally, we find that unbound particle pairs remain caged in a multi-particle variation of Aharonov-Bohm caging.\n\n[c]0.5\n\n< g r a p h i c s >\n\n[c]0.49\n\nFlat-band lattices and Aharonov-Bohm caging with transmon qubits.\n(a) The rhombus lattice with its band structure and the depiction of a compact localized state.\n(b) By adding a $\\pi$-flux synthetic magnetic field, all bands become flat and are spanned by compact localized states. The dashed lattice bonds indicate tunneling of opposite sign from the other tunnel couplings.\n(c) Eigenbasis for a single plaquette of the zero-flux rhombus lattice.\n(left) Measured two-tone spectroscopy with all qubits on resonance.\n(right) Eigenenergies and eigenstates calculated using exact diagonalization.\n(d) Same as (c) but for the  $\\pi$-flux rhombus plaquette.\n(e) False-color image of zero-flux plaquette device, with zoomed insets highlighting the difference between the zero- (left) and $\\pi$-flux (right) plaquette designs.\n(f) We rotate the rightmost qubit by 90 degrees to introduce a geometric phase of $\\pi$. This rotation modifies how upper (white outline) and lower (black outline) electrodes are capacitively coupled and changes the sign of the upper right tunneling term.\n(g) Experimental sequences used in this work, which consist of initialization, time evolution with all qubits on resonance, and readout. In the first experiment (white boxes), we initialize the left qubit in the first excited state and detune one of the four qubits for readout. In the second (white and yellow boxes), we instead initialize the left qubit in the second excited state with two sequential pulses. In the third experiment (white and blue boxes), we initialize the left and right qubits in the first excited state and detune two of the four qubits for simultaneous readout. In all experiments, we vary the qubits that are detuned for readout to extract average populations for each qubit.\nIn (f) and (g), subscripts L, T, B, R refer to the left, top, bottom, and right qubits, respectively.\n\nCIRCUIT DEVICE\n\nThe sites of our plaquettes are flux-tunable transmon qubits which can be approximated as anharmonic oscillators for microwave photons.\nTo implement the zero-flux rhombus plaquette, all four qubits are placed in the same orientation as shown in the main image of Fig. (Figure fig:setup)e.\nEach qubit has a large capacitor comprised of an upper and a lower electrode (shaded green), and tunnel coupling between neighboring qubits is given by capacitance between two of their electrodes.\nWith upper electrodes capacitively coupled only to lower electrodes of neighboring qubits, the accumulated phase of a single photon traversing this loop is zero.\nTo generate the $\\pi$-flux synthetic field, we rotate one transmon (the rightmost) clockwise by 90 degrees relative to the others.\nAs shown in Fig. (Figure fig:setup)f, in doing so, the (formerly) lower electrode of the right qubit now couples to the lower electrode of the top qubit, while all other electrodes remain coupled as before.\nA single photon traversing this loop then picks up an additional minus sign when hopping between the top and right sites [Unknown Author, \"Unknown Title\", ], i.e. a geometric phase of $\\pi$.\nWe note that the choice of qubit to rotate and its rotation direction amount to a gauge choice, reflected in where the change in sign of tunneling occurs.\n\nThe resulting Hamiltonian for the two devices (in units where the reduced Planck constant $\\hbar=1$) is given by:\n$$\n\n\\hat{H} = &- \\sum_{\\langle i,j\\rangle} t_{ij} (b^\\dagger_i b_j + b_i b^\\dagger_j)\\nonumber\\\\\n&+ \\sum_i \\left(\\omega_i b^\\dagger_i b_i + \\frac{U_i}{2} b^\\dagger_i b_i (b^\\dagger_i b_i - 1)\\right) \\label{eq:H}\n\n$$\nwhere the summations over sites $i$ and neighboring sites $\\langle i, j\\rangle$ are taken over the left (L), top (T), bottom (B), and right (R) qubits.\nHere, $b_i$ is the bosonic annihilation operator and $\\omega_i$ is the frequency of qubit $i$.\nFor the gauge choice in this work, the tunneling $t_{ij}$ is positive between all qubits in the zero-flux rhombus.\nRotation of the rightmost qubit for the $\\pi$-flux rhombus corresponds to changing the sign of tunneling between the right and top qubits ($t_\\mathrm{RT} < 0$) while preserving its magnitude.\nOn-site attractive interactions $U_i<0$ are mediated by the negative qubit anharmonicity of transmon qubits.\nBoth devices operate in the strongly interacting regime where the ratio of interaction strength to tunneling is approximately 13.5.\nNext-nearest neighbor coupling was designed to be negligible at less than $t_{ij} / 70$ and is not included in the model.\n\nWe probe each of the two devices via two-tone spectroscopy to confirm that their eigenenergies match the expected energies obtained by exact diagonalization of the corresponding four-site Hamiltonian.\nWith all four qubits tuned into resonance with each other, we measure transmission through the feedline at the top-qubit resonator frequency while varying the frequency of the pump tone.\nTransmission peaks indicate that the resonator frequency has dispersively shifted, which occurs when the pump tone is resonant with a plaquette eigenenergy and excites the top qubit.\nThe results are shown in Figs. (Figure fig:setup)c and d for the zero- and $\\pi$-flux rhombi, respectively, and are consistent with calculation.\nThe measured spectral dependence on one of the qubit frequencies is included as Extended Data Fig. (Figure fig:spec).\n\nThe experiments that follow probe non-equilibrium dynamics and consist of state initialization, time evolution, and readout (Fig. (Figure fig:setup)g).\nFor Hamiltonian time evolution, we set the frequencies of all of the qubits to $\\omega_i/2\\pi = 4.45$ GHz.\nAt this target frequency, the qubits have depolarization times exceeding 43 $\\mu s$ and nearest-neighbor tunneling amplitudes of approximately $2\\pi\\!\\times\\!11.7$ MHz.\nState initialization and readout are performed via a single feedline (shaded purple in Fig. (Figure fig:setup)e), with four half-wave resonators (shaded yellow) dispersively coupled to each qubit.\nIn these steps, the frequency of each qubit can be dynamically set between $4.4$ and $5.7$ GHz by varying the current supplied to its individual flux bias line (shaded blue, Fig. (Figure fig:setup)e).\nA full table of device parameters can be found in Supplementary Information Tabs. (Table tab:params) and (Table tab:t).\n\nCAGING OF A SINGLE PARTICLE\n\nAharonov-Bohm caging can be made apparent through a single-particle quantum walk [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nMuch like the walk in a one-dimensional chain [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the ensuing dynamics result from wavefunction interference.\nHere, destructive interference bounds the quantum walk in an Aharonov-Bohm cage, while constructive interference allows a fully delocalized walk over all four sites of the plaquette with zero flux.\n\nThe experiment begins with initialization of the leftmost qubit, detuned from the target qubit frequency, in the first excited state (see Fig. (Figure fig:setup)d).\nThis is equivalent to placing a single particle (microwave photon) on that site.\nWe then quench the left qubit into resonance with the other three qubits at the target qubit frequency.\nAfter evolution under the Hamiltonian (Eq. <ref>) for a variable time, we diabatically detune and measure the state of one qubit.\nRepeated measurements across all qubits then provide access to the average site-resolved occupation of all four sites.\nThe results for zero and $\\pi$ flux, corrected for readout errors, are shown in Fig. (Figure fig:1particle)a and b (upper), respectively.\nDuplicate time axes are included in units of $\\tau_{\\mathrm{swap}} = 2\\pi / 4\\bar{t}$: the time it takes for a photon to swap between two qubits with tunnelling rate $\\bar{t}$, where $\\bar{t} = 2\\pi\\!\\times\\!11.75 \\,(2\\pi\\!\\times\\!11.66)$ MHz is the average rate for the zero-flux ($\\pi$-flux) device.\nSimulation results with zero on-site disorder and independently measured tunneling and decoherence are plotted below.\n\n< g r a p h i c s >\n\nAharonov-Bohm caging of a single particle. (a) Average qubit populations in the first excited state $|1\\rangle$ as a function of time after quench into resonance (upper), for the zero-flux plaquette. Appreciable populations are observed on all four sites, even at short times, indicating a fully delocalized walk. Insets show average qubit populations in the initial state and after approximately $1/2$ and $1$ swap times.\n(b) In the $\\pi$-flux plaquette, the single particle remains bounded to three of the four sites as a result of Aharonov-Bohm caging. Here insets correspond to approximately $0$, $1/\\sqrt{2}$, and $\\sqrt{2}$ swap times.\nIn both (a) and (b), simulated time evolution with zero on-site disorder is shown in the lower half.\nPopulation time series are also represented as color plots for visibility and use the colorbar in the lower right of the figure.\nDuplicate time axes are included to indicate time in units of a photon swap time, $\\tau_{\\mathrm{swap}}$ (see main text for details).\nFor data in this and subsequent figures, error bars indicate 95\n\nWe find a bounded quantum walk in the $\\pi$-flux rhombus, indicating successful Aharonov-Bohm caging.\nWithin the first swap time after quench, the particle begins to delocalize over the top and bottom sites in the plaquette regardless of flux.\nShortly thereafter, however, the walks deviate.\nIn the zero-flux rhombus, the top and bottom paths constructively interfere and result in a periodic walk across all four qubits, as demonstrated by the insets in Fig. (Figure fig:1particle)a, upper.\nThis does not occur for the $\\pi$-flux rhombus: interference is destructive on the rightmost site, suppressing particle population below 5\nConsequently, the particle remains bounded to the left, top, and bottom sites (insets in Fig. (Figure fig:1particle)b, upper) as expected for caging.\n\nThe agreement between experimental measurement and simulation indicates that our control over qubit frequencies is consistent with achieving negligible on-site disorder and sufficient to realize caging.\nThe slight deviation from ideal caging is instead limited predominantly due to disorder in the coupling strengths between qubits, which amounts to a spread of approximately 2.5\nThis coupling-strength disorder results in coherent beating which is highlighted at long timescales (Extended Data Fig. (Figure fig:longtimes)).\n\nDOUBLONS ESCAPING THE CAGE\n\nWe next consider the walk of two particles initialized on the same site, referred to as a doublon.\nThese doublon states span a subspace of the entire two-particle Hilbert space; the complement is spanned by two-particle states where the particles sit on different sites, which we will refer to as \u201cparticle-particle\u201d Fock states.\nIn the presence of strong interactions, the doublon states are energetically well-separated from the particle-particle states.\nIn this subspace, doublons hop as a bound pair and experience a gauge field that is twice that of a single particle.\nThe Aharonov-Bohm cage for a single particle, then, has no effect on a strongly interacting doublon.\n\nWe access the strongly interacting regime with our devices by designing interaction energies in excess of tunneling amplitudes by an order of magnitude.\nThe doublon walk begins with two photons on the left site and continues with time evolution under the Hamiltonian as before, where on-site energies are now tuned to ensure that the second excited states of all qubits are on resonance.\nAfter a variable time, we measure the population of the second excited state and extract readout-error-corrected average doublon occupations of all sites.\n\n< g r a p h i c s >\n\nEscape of an interacting photon pair. (a) Average qubit populations in the second excited state $|2\\rangle$ as a function of time after quench into resonance (upper), for the zero-flux plaquette. The walk remains fully delocalized as with a single particle, but at reduced timescales.\n(b) Much like in the zero-flux plaquette, the doublon walk extends across the full $\\pi$-flux plaquette. (Inset plot) Direct comparison of right-qubit populations (R pop.) for doublon (2p, $|2\\rangle$ population) and single-particle (1p, $|1\\rangle$ population) walks in the $\\pi$-flux plaquette, highlighting the doublon escape in contrast to single-particle caging.\nIn both (a) and (b), inset plaquettes show average qubit populations in the initial state and after approximately $1/2$ and $1$ doublon-renormalized swap times. Simulated time evolution with zero on-site disorder, but including measured tunneling disorder and qubit decoherence, is shown in the lower half.\nThe shaded gray regions indicate the total evolution time shown in Fig. (Figure fig:1particle).\nPopulation time series are also shown as color plots for visibility and use the colorbar in the lower right of the figure.\n\nDoublons in the zero-flux rhombus delocalize in a manner qualitatively similar to single photons (Fig. (Figure fig:2particle)a).\nDoublon dynamics in the $\\pi$-flux rhombus, however, markedly differ from single-photon caging in that the doublon does not remain bounded away from the rightmost site (Fig. (Figure fig:2particle)b inset plot).\nRather, the doublon fully explores the plaquette almost as if it were in the zero-flux plaquette, i.e. it escapes this Aharonov-Bohm cage.\n\nWe note that in both plaquettes, the doublon tunneling amplitude is reduced by almost an order of magnitude compared to the single-particle tunneling.\nThese timescales result from doublons hopping via a second-order process, with rate given by $2t^2/U$ for bare tunneling $t$ and negative anharmonicity $U$.\nThis effective tunneling provides another way of understanding the doublon escape: all four tunneling rates $2t_{ij}^2/U$ have the same sign regardless of the sign of $t_{ij}$, yielding zero flux.\nAdditionally, the doublon-population oscillation amplitudes decrease over time, largely due to the weak hybridization between the doublon and particle-particle states, leading to coherent beating of the measured doublon population (see Supplementary Information for additional discussion).\n\nPARTICLE-PARTICLE FOCK-STATE CAGING\n\nFinally, we investigate the time dynamics of particle-particle Fock states and find a variation of Aharonov-Bohm caging.\nThese states, where two particles sit on different sites and are not bound by interactions, comprise the second and remaining sector of two-particle states.\nIn fact, strong interactions energetically separate these states from the doublons, making the individual particles behave approximately as hard-core bosons.\n\nFor these experiments, we initialize one photon on the left site and one photon on the right (the $|\\mathrm{LR}\\rangle$ state).\nAfter time evolution, we perform simultaneous readout on all qubit pairs to extract average particle-particle Fock-state populations at various points in time and plot the results in Fig. (Figure fig:interactingwalk)a and b.\nThe particle-particle dynamics in the zero-flux plaquette are dominated by full-contrast swaps between the $|\\mathrm{LR}\\rangle$ and $|\\mathrm{TB}\\rangle$ states.\nIn contrast, we find a bounded walk in the $\\pi$-flux plaquette not in real space, but instead characterized by suppressed population transfer to the $|\\mathrm{TB}\\rangle$ Fock state.\nWe refer to this variation of caging as \u201cFock-state caging\".\n\n< g r a p h i c s >\n\nParticle-particle Fock-state caging (a) Average populations of each of the six particle-particle Fock states for variable time after quench into resonance. The initial state (left inset) consists of one photon on the left site and one photon on the right. Other insets show Fock-state populations at approximately $1/(2\\sqrt{2})$ and $1/\\sqrt{2}$ swap times.\nIn insets, particle-particle Fock-state populations are shown via the corresponding segment that extends across two sites of the plaquette, e.g. the horizontal segment corresponds to $|\\mathrm{LR}\\rangle$.\nThe top panel plots the population of particle-particle Fock states of next-nearest-neighbor sites, while the middle panel shows nearest-neighbor particle-particle Fock state population. (b) Same, but for the $\\pi$-flux plaquette. Insets show Fock state populations of the initial state and at approximately $1/2$ and $1$ swap times. (c) Simulated time evolution with zero flux and with zero on-site disorder for all six particle-particle Fock state combinations, incorporating measured tunneling disorder and qubit decoherence. Hamiltonian adjacency graphs depict the particle-particle dynamics. (d) Same as c, but for the $\\pi$-flux plauqette. Here, the Hamiltonian adjacency graph describes a caging-like effect where tunneling of opposite sign and states with relative phase $\\pi$ (teal shading) cause destructive interference and $|\\mathrm{TB}\\rangle$ remains unpopulated.\n\nThis bounded phenomenon is a direct consequence of Aharonov-Bohm caging extended to multi-particle sectors, seen through the corresponding Hamiltonian adjacency graphs in Figs. (Figure fig:interactingwalk)c and d.\nIn these graphs, each node represents a particle-particle Fock state; doublon states are omitted in this hard-core limit.\nTwo nodes are connected by edges if the Fock states are tunnel-coupled, and edges are weighted according to the coupling sign and magnitude.\nIn this configuration space, time evolution of the $|\\mathrm{LR}\\rangle$ state corresponds to a single-particle walk on the adjacency graph beginning on the $|\\mathrm{LR}\\rangle$ node.\nWithout a synthetic field, delocalization proceeds across the entire particle-particle subspace.\nWhereas, with $\\pi$ flux, destructive interference much like in Aharonov-Bohm caging prohibits evolution to the $|\\mathrm{TB}\\rangle$ state.\nIn other words, Fock-state caging results from the interplay of geometric phase accumulation and Fock-state configurational-space topology, rather than real-space lattice topology as in Aharonov-Bohm caging.\nIn multi-plaquette systems and the infinite lattice itself, this Fock-state caging may give rise to an interacting two-particle real-space caging effect [Unknown Author, \"Unknown Title\", ]; see Extended Data Fig. (Figure fig:tripleplaquette) for supporting evidence from simulations on a chain of three plaquettes.\n\nThe oscillating populations between the $|\\mathrm{LR}\\rangle$ and $|\\mathrm{TB}\\rangle$ states in the zero-flux rhombus display a beating effect.\nThis coherent beating can be attributed to weak hybridization between the doublon and particle-particle states as in the doublon walk, reflecting a slight deviation of our device parameters from the hard-core regime (see Supplementary Information for details).\nInterestingly, the $\\pi$-flux rhombus does not host beating of these populations beyond what can be attributed to tunneling-rate disorder.\nThe absence of beating suggests that the Fock-state caging effects are independent of interaction strength.\nIn the regime of finite interactions, doublon states must be included in the adjacency graph; even so, we find that the resulting configuration-space topology maintains the complete destructive interference necessary for Fock-state caging.\n\nOUTLOOK\n\nOur work experimentally demonstrates the Aharonov-Bohm caging of a single particle and the subsequent escape of deeply bound doublons from the cage.\nWe realize this cage in a rhombus plaquette by engineering a negative tunnel coupling between exactly two of the transmon qubits to thread a $\\pi$-flux synthetic magnetic field through the plaquette.\nAdditionally, we consider the correlated dynamics of two photons initialized on opposite sides of the plaquette and find a type of caging not in real space, but in the configurational space of particle-particle Fock states.\nThese results establish a critical building block for studies of all-bands-flat lattices with strong interactions [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and inform future studies in other flat-band lattices with superconducting circuits, both in one- [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and two-dimensions.\nFor example, larger system sizes and increased coherence may enable the characterization of disorder and thermalization in a flat band [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nCombined with dissipative stabilizers [Unknown Author, \"Unknown Title\", ], equilibrium states may also be within reach [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nFinally, other platforms such as ultracold atoms can be used [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to study fermions [Unknown Author, \"Unknown Title\", ] and nonitinerant spin models [Unknown Author, \"Unknown Title\", ], implement longer-range interactions in these flat-band lattices [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], or measure transport between two reservoirs [Unknown Author, \"Unknown Title\", ].\n\n10\nurl<#>1urlprefixURL\n\naltman_quantum_2021\nauthorAltman, E. et\u00a0al.\ntitleQuantum Simulators: Architectures and\nOpportunities.\njournalPRX Quantum volume2,\npages017003 (year2021).\n\ncarusotto_photonic_2020\nauthorCarusotto, I. et\u00a0al.\ntitlePhotonic materials in circuit quantum\nelectrodynamics.\njournalNature Physics\nvolume16, pages268\u2013279\n(year2020).\n\nleykam_artificial_2018\nauthorLeykam, D., authorAndreanov, A. &\nauthorFlach, S.\ntitleArtificial flat band systems: from lattice models to\nexperiments.\njournalAdvances in Physics: X\nvolume3, pages1473052\n(year2018).\n\nkollar_hyperbolic_2019\nauthorKoll\u00e1r, A.\u00a0J., authorFitzpatrick, M. &\nauthorHouck, A.\u00a0A.\ntitleHyperbolic lattices in circuit quantum\nelectrodynamics.\njournalNature volume571,\npages45\u201350 (year2019).\n\nroushan_spectroscopic_2017\nauthorRoushan, P. et\u00a0al.\ntitleSpectroscopic signatures of localization with\ninteracting photons in superconducting qubits.\njournalScience volume358,\npages1175\u20131179 (year2017).\n\nma_dissipatively_2019\nauthorMa, R. et\u00a0al.\ntitleA dissipatively stabilized Mott insulator of\nphotons.\njournalNature volume566,\npages51\u201357 (year2019).\n\nsaxberg_disorder-assisted_2022\nauthorSaxberg, B. et\u00a0al.\ntitleDisorder-assisted assembly of strongly correlated\nfluids of light.\njournalNature volume612,\npages435\u2013441 (year2022).\n\nyan_strongly_2019\nauthorYan, Z. et\u00a0al.\ntitleStrongly correlated quantum walks with a 12-qubit\nsuperconducting processor.\njournalScience volume364,\npages753\u2013756 (year2019).\n\ngong_quantum_2021\nauthorGong, M. et\u00a0al.\ntitleQuantum walks on a programmable two-dimensional\n62-qubit superconducting processor.\njournalScience volume372,\npages948\u2013952 (year2021).\n\nkaramlou_quantum_2022\nauthorKaramlou, A.\u00a0H. et\u00a0al.\ntitleQuantum transport and localization in 1d and 2d\ntight-binding lattices.\njournalnpj Quantum Information\nvolume8, pages35 (year2022).\n\nvidal_aharonov-bohm_1998\nauthorVidal, J., authorMosseri, R. &\nauthorDou\u00e7ot, B.\ntitleAharonov-Bohm Cages in Two-Dimensional\nStructures.\njournalPhysical Review Letters\nvolume81, pages5888\u20135891\n(year1998).\n\nvidal_interaction_2000\nauthorVidal, J., authorDou\u00e7ot, B.,\nauthorMosseri, R. & authorButaud, P.\ntitleInteraction Induced Delocalization for Two\nParticles in a Periodic Potential.\njournalPhysical Review Letters\nvolume85, pages3906\u20133909\n(year2000).\n\nlieb_two_1989\nauthorLieb, E.\u00a0H.\ntitleTwo theorems on the Hubbard model.\njournalPhysical Review Letters\nvolume62, pages1201\u20131204\n(year1989).\n\ntasaki_nagaokas_1998\nauthorTasaki, H.\ntitleFrom Nagaoka's Ferromagnetism to Flat-Band\nFerromagnetism and Beyond: An Introduction to Ferromagnetism in the\nHubbard Model.\njournalProgress of Theoretical Physics\nvolume99, pages489\u2013548\n(year1998).\n\nvon_klitzing_quantum_2017\nauthorvon Klitzing, K.\ntitleQuantum Hall Effect: Discovery and\nApplication.\njournalAnnual Review of Condensed Matter Physics\nvolume8, pages13\u201330 (year2017).\n\nbergholtz_topological_2013\nauthorBergholtz, E.\u00a0J. & authorLiu, Z.\ntitleTopological flat band models and fractional Chern\ninsulators.\njournalInternational Journal of Modern Physics B\nvolume27, pages1330017\n(year2013).\n\nparameswaran_fractional_2013\nauthorParameswaran, S.\u00a0A., authorRoy, R. &\nauthorSondhi, S.\u00a0L.\ntitleFractional quantum Hall physics in topological flat\nbands.\njournalComptes Rendus Physique\nvolume14, pages816\u2013839\n(year2013).\n\nspanton_observation_2018\nauthorSpanton, E.\u00a0M. et\u00a0al.\ntitleObservation of fractional Chern insulators in a van\nder Waals heterostructure.\njournalScience volume360,\npages62\u201366 (year2018).\n\ncao_unconventional_2018\nauthorCao, Y. et\u00a0al.\ntitleUnconventional superconductivity in magic-angle\ngraphene superlattices.\njournalNature volume556,\npages43\u201350 (year2018).\n\nxie_fractional_2021\nauthorXie, Y. et\u00a0al.\ntitleFractional Chern insulators in magic-angle twisted\nbilayer graphene.\njournalNature volume600,\npages439\u2013443 (year2021).\n\npeotta_superfluidity_2015\nauthorPeotta, S. & authorT\u00f6rm\u00e4, P.\ntitleSuperfluidity in topologically nontrivial flat\nbands.\njournalNature Communications\nvolume6, pages8944 (year2015).\n\njulku_quantum_2021\nauthorJulku, A., authorBruun, G.\u00a0M. &\nauthorT\u00f6rm\u00e4, P.\ntitleQuantum Geometry and Flat Band\nBose-Einstein Condensation.\njournalPhysical Review Letters\nvolume127, pages170404\n(year2021).\n\ngoda_inverse_2006\nauthorGoda, M., authorNishino, S. &\nauthorMatsuda, H.\ntitleInverse Anderson Transition Caused by\nFlatbands.\njournalPhysical Review Letters\nvolume96, pages126401\n(year2006).\n\ndanieli_many-body_2020\nauthorDanieli, C., authorAndreanov, A. &\nauthorFlach, S.\ntitleMany-Body Flatband Localization.\njournalPhysical Review B\nvolume102, pages041116\n(year2020).\n\nkuno_multiple_2021\nauthorKuno, Y., authorMizoguchi, T. &\nauthorHatsugai, Y.\ntitleMultiple quantum scar states and emergent slow\nthermalization in a flat-band system.\njournalPhysical Review B\nvolume104, pages085130\n(year2021).\n\nregnault_catalogue_2022\nauthorRegnault, N. et\u00a0al.\ntitleCatalogue of flat-band stoichiometric materials.\njournalNature volume603,\npages824\u2013828 (year2022).\n\nsutherland_localization_1986\nauthorSutherland, B.\ntitleLocalization of electronic wave functions due to\nlocal topology.\njournalPhysical Review B\nvolume34, pages5208\u20135211\n(year1986).\n\naoki_hofstadter_1996\nauthorAoki, H., authorAndo, M. &\nauthorMatsumura, H.\ntitleHofstadter butterflies for flat bands.\njournalPhysical Review B\nvolume54, pagesR17296\u2013R17299\n(year1996).\n\nyanay_two-dimensional_2020\nauthorYanay, Y., authorBraum\u00fcller, J.,\nauthorGustavsson, S., authorOliver, W.\u00a0D. &\nauthorTahan, C.\ntitleTwo-dimensional hard-core Bose\u2013Hubbard model\nwith superconducting qubits.\njournalnpj Quantum Information\nvolume6, pages58 (year2020).\n\nabilio_magnetic_1999\nauthorAbilio, C.\u00a0C. et\u00a0al.\ntitleMagnetic Field Induced Localization in a\nTwo-Dimensional Superconducting Wire Network.\njournalPhysical Review Letters\nvolume83, pages5102\u20135105\n(year1999).\n\nnaud_aharonovbohm_2002\nauthorNaud, C. et\u00a0al.\ntitleAharonov\u2013Bohm cages in the GaAlAs/GaAs\nsystem.\njournalPhysica E: Low-dimensional Systems and\nNanostructures volume12, pages190\u2013196\n(year2002).\n\nmukherjee_experimental_2018\nauthorMukherjee, S., authorDi\u00a0Liberto, M.,\nauthor\u00d6hberg, P., authorThomson, R.\u00a0R. &\nauthorGoldman, N.\ntitleExperimental Observation of Aharonov-Bohm\nCages in Photonic Lattices.\njournalPhysical Review Letters\nvolume121, pages075502\n(year2018).\n\nhung_quantum_2021\nauthorHung, J.\u00a0S. et\u00a0al.\ntitleQuantum Simulation of the Bosonic Creutz\nLadder with a Parametric Cavity.\njournalPhysical Review Letters\nvolume127, pages100503\n(year2021).\n\nli_aharonov-bohm_2022\nauthorLi, H. et\u00a0al.\ntitleAharonov-Bohm Caging and Inverse Anderson\nTransition in Ultracold Atoms.\njournalPhysical Review Letters\nvolume129, pages220403\n(year2022).\n\nkarski_quantum_2009\nauthorKarski, M. et\u00a0al.\ntitleQuantum Walk in Position Space with Single\nOptically Trapped Atoms.\njournalScience volume325,\npages174\u2013177 (year2009).\n\npreiss_strongly_2015\nauthorPreiss, P.\u00a0M. et\u00a0al.\ntitleStrongly correlated quantum walks in optical\nlattices.\njournalScience volume347,\npages1229\u20131233 (year2015).\n\nsantos_methods_2020\nauthorSantos, F. D.\u00a0R. & authorDias, R.\u00a0G.\ntitleMethods for the construction of interacting many-body\nHamiltonians with compact localized states in geometrically frustrated\nclusters.\njournalScientific Reports\nvolume10, pages4532 (year2020).\n\nkolovsky_conductance_2023\nauthorKolovsky, A., authorMuraev, P. &\nauthorFlach, S.\ntitleConductance transition with interacting bosons in an\nAharonov-Bohm cage.\njournalarXiv pages2303.00509\n(year2023).\n\ndeng_superconducting_2016\nauthorDeng, X.-H., authorLai, C.-Y. &\nauthorChien, C.-C.\ntitleSuperconducting circuit simulator of Bose-Hubbard\nmodel with a flat band.\njournalPhysical Review B\nvolume93, pages054116\n(year2016).\n\ngneiting_lifetime_2018\nauthorGneiting, C., authorLi, Z. &\nauthorNori, F.\ntitleLifetime of flatband states.\njournalPhysical Review B\nvolume98, pages134203\n(year2018).\n\nchalker_anderson_2010\nauthorChalker, J.\u00a0T., authorPickles, T.\u00a0S. &\nauthorShukla, P.\ntitleAnderson localization in tight-binding models with\nflat bands.\njournalPhysical Review B\nvolume82, pages104209\n(year2010).\n\nlonghi_inverse_2021\nauthorLonghi, S.\ntitleInverse Anderson transition in photonic cages.\njournalOptics Letters\nvolume46, pages2872-2875 (year2021).\n\nbiondi_incompressible_2015\nauthorBiondi, M., authorvan Nieuwenburg, E.\u00a0P.,\nauthorBlatter, G., authorHuber, S.\u00a0D. &\nauthorSchmidt, S.\ntitleIncompressible Polaritons in a Flat Band.\njournalPhysical Review Letters\nvolume115, pages143601\n(year2015).\n\nkatsura_mott_2021\nauthorKatsura, H., authorKawashima, N.,\nauthorMorita, S., authorTanaka, A. &\nauthorTasaki, H.\ntitleMott Insulator-like Bose-Einstein\nCondensation in a Tight-Binding System of Interacting Bosons with\na Flat Band.\njournalPhysical Review Research\nvolume3, pages033190 (year2021).\n\nflannigan_enhanced_2020\nauthorFlannigan, S. & authorDaley, A.\u00a0J.\ntitleEnhanced repulsively bound atom pairs in topological\noptical lattice ladders.\njournalQuantum Science and Technology\nvolume5, pages045017 (year2020).\n\njunemann_exploring_2017\nauthorJ\u00fcnemann, J. et\u00a0al.\ntitleExploring Interacting Topological Insulators\nwith Ultracold Atoms: The Synthetic Creutz-Hubbard Model.\njournalPhysical Review X\nvolume7, pages031057 (year2017).\n\nkobayashi_superconductivity_2016\nauthorKobayashi, K., authorOkumura, M.,\nauthorYamada, S., authorMachida, M. &\nauthorAoki, H.\ntitleSuperconductivity in repulsively interacting fermions\non a diamond chain: Flat-band-induced pairing.\njournalPhysical Review B\nvolume94, pages214501\n(year2016).\n\nmcclarty_disorder-free_2020\nauthorMcClarty, P.\u00a0A., authorHaque, M.,\nauthorSen, A. & authorRichter, J.\ntitleDisorder-free localization and many-body quantum\nscars from magnetic frustration.\njournalPhysical Review B\nvolume102, pages224303\n(year2020).\n\nroy_interplay_2020\nauthorRoy, N., authorRamachandran, A. &\nauthorSharma, A.\ntitleInterplay of disorder and interactions in a flat-band\nsupporting diamond chain.\njournalPhysical Review Research\nvolume2, pages043395 (year2020).\n\nsalerno_interaction-induced_2020\nauthorSalerno, G., authorPalumbo, G.,\nauthorGoldman, N. & authorDi\u00a0Liberto, M.\ntitleInteraction-induced lattices for bound states:\nDesigning flat bands, quantized pumps, and higher-order topological\ninsulators for doublons.\njournalPhysical Review Research\nvolume2, pages013348 (year2020).\n\ntilleke_nearest_2020\nauthorTilleke, S., authorDaumann, M. &\nauthorDahm, T.\ntitleNearest Neighbour Particle-Particle\nInteraction in Fermionic Quasi One-Dimensional Flat Band\nLattices.\njournalZeitschrift f\u00fcr Naturforschung A\nvolume75, pages393\u2013402,(year2020).\n\nkhare_localized_2021\nauthorKhare, R. & authorChoudhury, S.\ntitleLocalized dynamics following a quantum quench in a\nnon-integrable system: an example on the sawtooth ladder.\njournalJournal of Physics B: Atomic, Molecular and\nOptical Physics volume54, pages015301\n(year2021).\n\npyykkonen_flat_2021\nauthorPyykk\u00f6nen, V. A.\u00a0J. et\u00a0al.\ntitleFlat band transport and Josephson effect through a\nfinite-size sawtooth lattice.\njournalPhysical Review B\nvolume103, pages144519\n(year2021).\n\nstefanazzi_qick_2022\nauthorStefanazzi, L. et\u00a0al.\ntitleThe QICK (Quantum Instrumentation Control\nKit): Readout and control for qubits and detectors.\njournalReview of Scientific Instruments\nvolume93, pages044709\n(year2022).\n\nbraumuller_probing_2022\nauthorBraum\u00fcller, J. et\u00a0al.\ntitleProbing quantum information propagation with\nout-of-time-ordered correlators.\njournalNature Physics\nvolume18, pages172\u2013178\n(year2022).\n\nmacklin_nearquantum-limited_2015\nauthorMacklin, C. et\u00a0al.\ntitleA near\u2013quantum-limited Josephson traveling-wave\nparametric amplifier.\njournalScience volume350,\npages307\u2013310 (year2015).\n\nguo_observation_2021\nauthorGuo, Q. et\u00a0al.\ntitleObservation of energy-resolved many-body\nlocalization.\njournalNature Physics\nvolume17, pages234\u2013239\n(year2021).\n\njohansson_qutip_2013\nauthorJohansson, J., authorNation, P. &\nauthorNori, F.\ntitleQuTiP 2: A Python framework for the dynamics of\nopen quantum systems.\njournalComputer Physics Communications\nvolume184, pages1234\u20131240\n(year2013).\n\nzhou_observation_2023\nauthorZhou, X., authorZhang, W., authorSun,\nH. & authorZhang, X.\ntitleObservation of flat-band localization and topological\nedge states induced by effective strong interactions in electrical circuit\nnetworks.\njournalPhysical Review B\nvolume107, pages035152\n(year2023).\n\n$^*$These authors contributed equally to this work.\n\nAcknowledgements\nWe thank Sara Sussman and Sho Uemura for assistance on QICK software development and Lawrence Cheuk, Anjali Premkumar, and Rhine Samajdar for discussions.\nWe acknowledge support from the NSF Quantum Leap Challenge Institute for Robust Quantum Simulation 2120757, the ARO MURI W911NF-15-1-0397, and the Princeton Center for Complex Materials NSF DMR-1420541.\nJ.G.C.M. acknowledges additional support from NSF GRFP DGE-2039656.\nThis research made use of the Micro and Nano Fabrication Center at\nPrinceton University.\n\nContributions\nC.S.C. conceived and designed the experiment with J.G.C.M.\nJ.G.C.M. designed the devices with assistance from B.M.S., and fabricated the devices.\nJ.G.C.M. performed the experiments with C.S.C. and together analyzed the data.\nAll authors contributed extensively to the interpretation of data, writing of the manuscript, and discussions.\n\nCorresponding author Correspondence and requests for materials should be addressed to A.A.H.\n\n(aahouck@princeton.edu).\n\nCompeting interests The authors declare no competing interests.\n\nMETHODS\n\n### Device fabrication\nBoth 10 mm $\\times$ 10 mm devices were patterned on a 200 nm-thick layer of tantalum deposited on a 530$\\,\\mu $m thick sapphire wafer.\nDirect-write optical lithography was used to define the base layer pattern and the features were etched with a Chlorine-based dry etch.\nJosephson junctions were patterned using electron-beam lithography and the Al-AlO$_x$-Al layers were deposited using double-angle evaporation in a Plassys MEB 550S.\nThe first arm was 20 nm thick, the AlO$_x$ was grown using a 85/15 Ar/O$_x$ mix at 200 mBar for 40 minutes, and the second aluminum layer was 70 nm thick.\nBoth devices were packaged in QDevil QCage aluminum sample holders.\nWirebonds were used to short the ground planes on opposite sides of coplanar waveguides, ground the metal in the middle of the four qubits, and bond signal traces to bondpads.\n\n## Wiring & setup\nDevices were measured sequentially in a Bluefors LD250 at a base temperature of 11 mK.\nAll time-domain control and measurements were performed using the QICK-controlled Xilinx RFSoC ZCU216 [Unknown Author, \"Unknown Title\", ], including resonator and qubit drives, qubit fast-flux pulses, and single- and simultaneous multiple-cavity readout.\nDC-flux offset for each qubit was controlled using Yokogawa low-noise voltage sources, combined with a fast-flux line in the mixing chamber, and sent to the qubit via on-chip flux lines.\n\nThe qubits were dispersively read out and driven through individual half-wave resonators capacitively coupled to a single transmission line.\nCavity readout tones and qubit drive pulses were combined in a splitter at room temperature.\nThe output signal was amplified using a high-electron-mobility transistor (HEMT) amplifier at 4K and two amplifiers at room temperature.\nThe full wiring setup can be found in Supplementary Information Fig. (Figure fig:fridge).\n\n### Experimental sequence\nFor all experiments, DC-flux voltages were set such that in the absence of fast-flux pulses, all four qubits were approximately on resonance with one another.\nState initialization, time evolution, and readout were then performed using fast-flux pulses that control the qubit frequencies within approximately one nanosecond.\nState initialization was done by detuning only the qubits with initial-state occupation by approximately $20t$ and applying individual $\\pi$ pulses.\nTime evolution proceeded by rapidly tuning the qubits onto resonance and waiting for a variable amount of time, after which qubits were detuned by $20t$ for single-shot readout.\n\nFor the one-photon and doublon walks, we detuned and measured a single qubit to reduce effects of frequency crowding and unwanted population transfer.\nFor the particle-particle walk, two qubits were simultaneously detuned and read out to measure correlations.\nTo capture the populations of all qubit and qubit pairs, we repeat each experimental run and vary which qubit(s) are measured.\n\nAll readout consists of single-shot measurements using 3000 shots.\nReadout parameters and thresholds were optimized to discriminate between the ground and first excited states for measurements of the first-excited-state population, and between the first and second excited states for measurements of the second-excited-state population.\nAveraging time for readout was 2.5 $\\mu$s.\n\n### DC-flux crosstalk calibration\nWe calibrated and compensated for DC-flux crosstalk as in  [Unknown Author, \"Unknown Title\", ].\nWe find a non-negligible crosstalk of around 2\nThe full crosstalk matrix for the $\\pi$-flux device is shown in Supplementary Information Fig. (Figure fig:xc); the crosstalk matrix for the zero-flux device is similar.\n\n### Fast-flux calibration\nThe fast-flux pulses used to tune qubit frequencies during the experimental sequence ideally have step-function responses.\nWe calibrated for long-time deviations from the ideal step pulse as in  [Unknown Author, \"Unknown Title\", ] and short-time deviations as in  [Unknown Author, \"Unknown Title\", ].\nOne and two-photon oscillations between two qubits before and after these compensations are plotted in Supplementary Information Fig. (Figure fig:FF).\n\n### Qubit tuning into resonance\nThe four qubits were first biased approximately into resonance using DC-flux currents.\nTo compensate for frequency disorder, we fine-tuned the qubit frequencies using fast-flux pulses through a heuristic algoritm.\nWe first set the bottom qubit to a frequency near its sweet spot and varied the step amplitude of a fast-flux pulse to bring the left qubit into resonance, probed via a single-particle two-qubit walk.\nNext we brought the top qubit into resonance, probed via the dynamics of a single particle initialized on the left qubit and optimized for balanced measurement probabilities on the top and bottom qubits.\nFinally, we brought the right qubit into resonance, verified through comparison with simulated plaquette dynamics.\n\n### Hamiltonian estimation & simulation\nAll of the parameters used in the Hamiltonian time-domain simulations were independently measured.\nTo determine tunneling amplitudes between neighboring qubit pairs, we performed a single-particle two-qubit walk with the nonparticipating qubits detuned by at least $250$ MHz.\nThis walk was also used to determine approximate $T_2$ dephasing times for the coupled plaquette systems, which have a reduced flux dispersion compared to that of an individual qubit [Unknown Author, \"Unknown Title\", ].\nThe $T_1$ coherence time was individually measured at the target frequency.\nSimulations use the QuTiP package [Unknown Author, \"Unknown Title\", ].\n\naddtoresetfiguresection\n\nEXTENDED DATA\n\n< g r a p h i c s >\n\nTwo-tone spectroscopy data for the (a) zero- and (b) $\\pi$-flux rhombus devices. In both, the DC voltage on one of the qubit flux lines is varied, keeping the other three qubit frequencies in resonance with one another. Then, the pump tone frequency is varied while the transmission at the top qubit readout resonator frequency $\\omega_{r,0}$ is monitored. Increased transmission corresponds to the pump tone being on resonance with one of the four-qubit-system eigenfrequencies because it shifts the qubit readout resonator frequency away from the probe tone frequency. The gray dashed lines indicate the flux values taken for the spectroscopy data shown in Fig. (Figure fig:setup)c, d of the main text.\n\n< g r a p h i c s >\n\nOne-photon walk out to longer times for the (a) zero- and (b) $\\pi$-flux rhombi. The datasets shown in main text Fig. (Figure fig:1particle) are displayed here out to longer times, with the gray rectangle indicating the time range of main text Fig. (Figure fig:1particle). Population time series are also represented as color plots for visibility and use the colorbar in the lower right of the figure.\nThe long-timescale dynamics seen here, namely photon population on the right qubit, results from inhomogenous nearest-neighbor tunneling amplitudes as can be seen in the simulation (lower half of plot).\nError bars indicate 95\n\n0.50\n\n< g r a p h i c s >\n\n0.49\nOne-photon walk with varying initial state for $\\pi$-flux plaquette. (a) Initializing photon on left qubit, as in main text Fig. (Figure fig:1particle) and Extended Data Fig. (Figure fig:longtimes). (b) Initializing photon on right qubit. The dynamics are qualitatively similar to (a), as expected, with left-qubit population suppression below 5\nIn (a-c), population time series are also represented as color plots for visibility and use the colorbar in the lower right of the figure.\nError bars indicate 95\n\n< g r a p h i c s >\n\nParticle-particle walk on the triple plaquette with $|\\mathrm{LR}\\rangle$-like initial state. Legend applies to all plots and groups multiple Fock-state populations under the same color for visibility, however each population is plotted as separate trace. The legend indicates the initial state population, all particle-particle Fock-state populations which exhibit zero population at all times in the $\\pi$-flux lattice, and the remaining Fock-state populations grouped by particles on sites which are distance $m$ sites from each other.  (a) Zero synthetic magnetic field. The interacting walk covers all particle-particle Fock states over time.\n(b) With the $\\pi$-flux field, the interacting walk never evolves to exhibit population on the analogous $|\\mathrm{TB}\\rangle$-like state (purple). Furthermore, this photon-photon state appears to remain bounded; the leftmost and rightmost sites of the system remain unpopulated at all points in time (purple). Simulations use the average tunnel couplings and interactions energies for each device, respectively, and omit disorder and dephasing. Insets zoom in around the zero population point at short and long times.\n\nSupplementary Materials for\n\nFlat-band localization and interaction-induced delocalization of photons\n\n## Device parameters\n1.5\n1\n\n4czero flux     4c$\\pi$ flux\n\nqubit     left     top     bottom     right     left     top     bottom     right\n\n$E_{J,\\mathrm{max}} /2\\pi$ (GHz)     26.80(1)     25.85(1)     27.69(1)     26.32(1)     27.58(1)     27.01(1)     27.72(1)     27.04(1)\n\n$d$     0.5954(3)     0.5962(4)     0.5922(4)     0.5897(2)     0.5897(2)     0.5941(3)     0.5770(3)     0.6029(2)\n\n$E_C /2\\pi$ (MHz)     158.10(6)     157.90(5)     157.80(5)     157.26(4)     157.30(2)     157.56(3)     158.91(5)     158.40(7)\n\n$\\omega_q /2\\pi$ (MHz)     4c|4450     4c4450\n\n$\\omega_{r,0} /2\\pi$ (MHz)     6962.62(1)     7033.80(1)     7104.82(1)     7230.25(1)     6952.62(1)     7055.99(1)     7117.79(1)     7250.22(1)\n\n$\\kappa /2\\pi$ (MHz)     0.84(1)     0.59(1)     0.81(1)     0.32(1)     0.86(1)     0.54(1)     0.80(1)     0.37(1)\n\n$g /2\\pi$ (MHz)     64.73(18)     64.10(4)     67.16(9)     64.63(3)     60.27(13)     67.86(10)     68.40(13)     67.20(9)\n\n$T_{1, 01}$ (us)    42.4(8)   42.2(1.0)   44.1(1.0)   48.5(1.0)    50.6(9)     43.6(7)     50.4(1.6)     44.0(1.0)\n\n$T_{2, 01}^*$ (us)    2.95(13)   2.11(9)   3.44(15)   3.08(13)    2.94(10)     1.82(7)     1.96(10)     3.47(18)\n\n$T_{1, 12}$ (us)    32.6(1.3)   22.9(1.2)   32.8(0.9)   19.2(5)    27.3(5)     28.1(6)     27.9(8)     27.8(6)\n\n$T_{2, 02}^*$ (us)    1.41(12)   0.89(8)   1.56(10)   1.30(14)    1.59(14)     0.90(4)     1.05(10)     1.84(10)\n\n1\nDevice parameters for the zero- and $\\pi$-flux devices presented in this work. $E_{J,\\mathrm{max}}$ is the maximum effective Josephson energy, $d$ is the junction asymmetry, and $E_C$ is the capacitor energy which roughly determines the interaction energy $U \\approx -E_C$. $\\omega_q / 2\\pi$ is the target frequency that all four qubits are set to during the evolution portion of the experiment. $\\omega_{r,0}/ 2\\pi$ is the frequency of the dispersively coupled resonator when the qubit is in the ground state, with its photon loss rate $\\kappa$ and coupling to qubit $g$. $T_{1, 01}$ and $T_{2, 01}^*$ are the qubit decay and Ramsey dephasing times between the ground and first excited state at the target qubit frequency 4.45 GHz, while $T_{1, 12}$ is the qubit decay between the first and second excited states and $T_{2, 02}^*$ is the dephasing time between the second excited state and the ground state. Uncertainties are in parentheses and reflect one standard deviation errors on the fits.\n\nTab. (Table tab:params) summarizes the device parameters for our zero- and $\\pi$-flux rhombus circuits; however we note that these exact values are not necessary to observe the results presented in the main text.\nOur independently measured tunnel couplings are in Tab. (Table tab:t).\nAll qubits are flux-tunable with loop sizes of approximately $45 \\mu\\mathrm{m} \\times 7 \\mu\\mathrm{m}$, with approximately 2.2 mA corresponding to one flux quantum through the loop.\n\n1.5\n\ntunneling     zero flux     $\\pi$ flux\n\n$t_{\\mathrm{LT}} / 2\\pi$ (MHz)     11.879(1)     11.781(1)\n\n$t_{\\mathrm{LB}} / 2\\pi$ (MHz)     11.792(1)     11.884(1)\n\n$t_{\\mathrm{RT}} / 2\\pi$ (MHz)     11.587(1)     11.736(1)\n\n$t_{\\mathrm{RB}} / 2\\pi$ (MHz)     11.734(1)     11.238(1)\n\n1\nTunneling amplitudes of the devices presented in this work, measured at the target qubit frequency. The labels L, T, B, R correspond to the left, top, bottom, and right qubits, respectively.\n\nThe qubit target frequency was chosen to reduce frequency sensitivity to flux bias and optimize qubit coherence.\nThe former consideration merits proximity to a qubit sweet spot, while the second requires avoiding frequency resonances with lossy two-level systems in the device material that are physically proximal to one of the four qubits.\nFor both devices, we select a qubit target frequency of 4.45 GHz.\n\n## Wiring & setup\n< g r a p h i c s >\n\nControl and measurement wiring setup.\n\nThe wiring and measurement setup is in Fig. (Figure fig:fridge), discussed in the Methods, and is generally similar to the setup used in similar works.\nWe highlight the use of the Xilinx RFSoC ZCU216, with software control through the QICK package [Unknown Author, \"Unknown Title\", ], for arbitrary waveform generation of the fast-flux pulses, qubit drives, and qubit readout probe.\nThis board is also used for signal digitization, greatly simplifying the microwave hardware requirements for the setup.\nWe elaborate also on the modified bias-tee to combine the DC and fast-flux lines in the mixing chamber; here, the capacitor was removed and replaced with a short.\n\n## Device flux calibrations\nWe characterize and compensate for both DC-flux crosstalk and distortions in the fast-flux pulse shape, as described in the Methods.\nThe measured DC-flux cross-coupling matrix for the $\\pi$-flux device is shown in Fig. (Figure fig:xc); we note that the zero-flux device exhibits a similar matrix.\n\n0.35\n\n< g r a p h i c s >\n\n0.6\nFlux line cross-coupling matrix for the four qubits on the $\\pi$-flux rhombus device. Note that the color for the diagonal elements is saturated on the colorbar. The matrix for the zero-flux rhombus is qualitatively similar.\n\nIn Fig. (Figure fig:FF) we plot the top qubit response to the fast-flux pulse before and after its calibration.\nWe additionally evaluate the performance of fast-flux pulses through single-particle and doublon walks over two qubits, where the initially excited qubit is brought into resonance with the second qubit via the fast-flux pulse.\nIn these evaluations, the fast-flux pulse amplitude is varied and subsequent excitation population over time measured.\nBecause oscillations are the slowest when the qubits are on resonance, the single-qubit walk reveals imperfections in the fast-flux pulse when the optimal fast-flux amplitude appears to vary over time.\nSimilarly, asymmetric oscillation contrast for fast-flux setpoints above and below resonance reflects imperfections in the fast-flux pulse.\nWe find that both of these effects are qualitatively eliminated post-calibration.\n\n< g r a p h i c s >\n\nFast-flux calibration for $\\pi$-flux rhombus device, top qubit. (a) Spectroscopically measured qubit response as a function of time for pre- and post-calibration fast-flux pulses. Dashed lines are included as a guide to the eye and connect the experimentally measured points. The horizontal gray line is also included as a guide to the eye. (b) (upper) Swapping of qubit excitation between the top and left qubits, where the top qubit is initialized in the first excited state. After initialization, a step function is applied to the fast-flux line of the top qubit with varying amplitude (\u201cFF step amplitude\u201d, $y$-axis). The time-dependent fast-flux amplitude corresponding to the slowest swap over time, plus the reduced contrast of off-resonance swapping, indicates that the fast-flux pulse requires calibration. (lower) Same, but for a swap of the second excited state. (c) Same as (a), but with the calibrated fast-flux pulse.\n\n## Readout Parameters\nWe determine qubit state occupancy using the state-dependent dispersive shift of the corresponding readout resonator.\nTo calibrate, we initialize the qubit into the $|0\\rangle$, $|1\\rangle$, or $|2\\rangle$ state using $\\pi$ pulses between adjacent levels and measure the resulting quadrature I/Q signal.\nReadout tone frequencies, powers, and averaging times are separately optimized for discrimination between the $|0\\rangle$ and $|1\\rangle$ states, versus the $|1\\rangle$ and $|2\\rangle$ states.\nIn the single-particle and interacting particle-particle dynamics, we optimize for separability between the $|0\\rangle$ and $|1\\rangle$ state I/Q signals as seen in Fig. (Figure fig:SS)a.\nFor the doublon dynamics, we optimize for separability between the $|1\\rangle$ and $|2\\rangle$ states as seen in Fig. (Figure fig:SS)b.\n\n< g r a p h i c s >\n\nState-dependent quadrature I/Q measurements when optimizing for separability of different states. (a) A readout tone frequency of 7.2305 GHz optimizes differentiation of the $|0\\rangle$ state from the $|1\\rangle$ and $|2\\rangle$ states. (b) A readout tone frequency of 7.2300 GHz isolates the $|2\\rangle$ state best and is used for measuring doublon dynamics. In both cases, the averaging time for each measurement was 2.5 $\\mu s$. Dashed line indicates the threshold used for assigning single-shot measurements to the qubit state populations.\n\nWe use separately measured readout fidelities for each qubit to correct for readout error on that qubit.\nAcross all four qubits and both devices, the average readout fidelity for distinguishing the $|0\\rangle$ from the $|1\\rangle$ state is 86(2)\nWe note the reduced readout fidelity for the second excited state predominantly results from the lower $T_1$ coherence time for higher qubit levels.\nHigher readout fidelities could be achieved using a near-quantum-limited amplifier [Unknown Author, \"Unknown Title\", ] and reduced measurement time.\n\nFor simultaneous readout of two qubits, we perform a similar calibration where we initialize in the product states $|00\\rangle$, $|01\\rangle$, $|10\\rangle$, and $|11\\rangle$ and concurrently measure the resulting quadrature I/Q signals for the two corresponding readout resonators.\nThe two qubits are detuned from each other to suppress coupling during readout; in particular, nearest neighbors are detuned by at least 200 MHz.\nThese readout frequencies differ from that of single-qubit readout; correspondingly, readout-tone frequencies and powers are reoptimized.\nThe measurement averaging time remains the same.\nFor all qubit pairs, each qubit's measurement fidelity is independent of the state of the other and consistent with its single-qubit measurement fidelity.\n\n## Effective Dephasing Rates\nWe estimate the effective $T_\\varphi$ of our coupled system as in [Unknown Author, \"Unknown Title\", ] because coupled systems have reduced flux dispersion compared to that of individual qubits.\nTo do this, we use single-photon oscillations between the zero-flux left (L) and bottom (B) qubits when both are tuned to the target qubit frequency.\nUnder the simplification that both qubits have the same effective dephasing rate $T_{\\varphi}$, the expected left-qubit first-excited-state population over time $\\tau$ can be written as:\n$$\n\nP_L(\\tau) = \\frac{1}{2}\\mathrm{cos}(2t\\tau)\\mathrm{exp}(-\\frac{\\tau}{2T_{1, L}} - \\frac{\\tau}{2T_{1, B}} - \\frac{\\tau}{T_{\\varphi}}) + \\frac{1}{2}\\mathrm{exp}(-\\frac{\\tau}{2T_{1, L}} - \\frac{\\tau}{2T_{1, B}})\n\n$$\nfor a coupling rate $t$ and depolarization times $T_{1,L}$ and $T_{1,B}$ for the left and bottom qubits, respectively.\nWith our independently measured $T_{1,L}$ and $T_{1,B}$ values, we vary the dephasing time and compare the exponentially decaying envelope of $P_L(\\tau)$ to measurement as seen in Fig. (Figure fig:T2eff).\nWe find that $T_\\varphi$ values between 40 $\\mu s$ and 80 $\\mu s$ are consistent with the data.\nGiven that single-qubit $T_2$ times are on the higher end of the $T_2$ values across all eight qubits in both devices, we use 40 $\\mu s$ as the effective dephasing rate of the coupled system for both devices.\nFor doublon dynamics, we use $T_\\varphi = 20 \\mu s$ because the flux dispersion is approximately twice that of the ground-to-first-excited-state transition.\n\n< g r a p h i c s >\n\nSingle-photon oscillations between left and bottom qubits, with envelopes from the analytical model corresponding to various $T_\\varphi$ dephasing times. Comparisons of the upper and lower bounds of the envelopes to data suggest 40 $\\mu s$ as a suitable lower bound for $T_\\varphi$ and 80 $\\mu s$ as a reasonable upper bound.\n\n## Interaction-induced coherent beating\nHere we elaborate on the observed beating of oscillations in the measured doublon populations of main text Fig. (Figure fig:2particle) and particle-particle populations of main text Fig. (Figure fig:interactingwalk).\n\nThese are perhaps best understood through the energy eigenbases of these systems.\nMore specifically, the qualitative models presented in the main text treat the doublon subspace as a decoupled subspace from the particle-particle subspace; however, this is only true in the limit of infinite interaction strength.\nFor finite interactions, the energy eigenstates are hybridized between states in the two subspaces, albeit weakly for strong interactions.\nFurthermore, this hybridization shifts the eigenstate energies.\nThen, because the initial Fock states are superpositions of numerous energy eigenstates, time evolution under the Hamiltonian results in differing phase accumulation between the eigenstates, resulting in the coherent beating of population oscillations.\nWe note that the visibility of coherent beating is also a consequence of finite-size effects as there are simply fewer energy eigenstates to cause full dephasing.\n\nWe find in the bound two-photon walk, a weak detuning the left or right qubit significantly suppresses the $2\\mu$s-timescale beating.\nFig. (Figure fig:detunedsite) shows the experimentally measured dynamics of a doublon with the right qubit detuned by $0.2$ MHz, along with simulations with and without this detuning for comparison.\nThe sensitivity to detuning suggests that it breaks a degeneracy of the system or further perturbs the eigensystem in a way that reduces the observed beating effect.\n\n0.55\nTwo-photon walk with single site detuned. (a) Experimental measurement of a two-photon walk on the $\\pi$ plaquette taken over the same timescale as main text Fig. (Figure fig:2particle). Notably, the amplitude of oscillations on sites L and R is larger at long times compared to the data presented in the main text. However, this behavior can be reproduced in simulation (b) by detuning the on-site energy of sites L or R by as little as $0.2$ MHz. (c) Simulation of two-photon walk with all four qubits on resonance, identical to Fig. (Figure fig:2particle)b lower, for easy reference.\n\n0.40\n\n< g r a p h i c s >\n\n## Photon-photon dynamics\nIn the main text, we qualitatively represent the interacting particle-particle walk through the Hamiltonian adjacency graph.\nEach state in the Fock-state subspace is treated as a site, with coupling strengths and signs inherited from the interacting two-particle Hamiltonian.\nTime evolution of an initial Fock state in the Hamiltonian, then, corresponds to single-particle evolution on the graph, initialized on the corresponding site.\nWe note that such approaches can also be used to experimentally simulate interacting particle systems [Unknown Author, \"Unknown Title\", ]; however they scale unfavorably with particle number.\n\nAn alternative approach to understanding the interacting particle-particle walk examines the eigenstates of the Fock-state subspace as depicted in Fig. (Figure fig:photphotdyn).\nThe zero-flux plaquette eigenspectrum exhibits three energies, each of which has an eigenstate (outlined in yellow) that has nonzero overlap with the $|\\mathrm{LR}\\rangle$ Fock state: that is, nonzero overlap with the initial state of a particle on the left site and a particle on the right site.\nTime evolution of the superposition of these states results in nonzero probability amplitudes of all Fock states in this subspace at some point in time.\nWith $\\pi$ flux, the eigenspectrum still exhibits three distinct energy values, only two of which have eigenstates that overlap with $|\\mathrm{LR}\\rangle$.\nFurthermore, they both have zero probability amplitude of the $|\\mathrm{TB}\\rangle$ state. As a result, we do not expect to simultaneously observe a particle on the top site and a particle on the bottom site at any point in time (in the limit of zero disorder and dephasing).\n\n0.5\n\n< g r a p h i c s >\n\n0.49\nPhysics of photon-photon dynamics in the rhombus systems. (a) Two-particle eigenstates for the zero-flux plaquette, in the subspace where particles occupy different sites. Three eigenstates, outlined, exhibit nonzero probability amplitude of the $|\\mathrm{LR}\\rangle$ Fock state. (b) Same as (a), but for the $\\pi$-flux plaquette. Here, only two eigenstates exhibit nonzero probability amplitude of the $|\\mathrm{LR}\\rangle$ Fock state.\n\n## Increasing particle number\nHere we consider particle number $n > 2$ on the $\\pi$-rhombus plaquette.\nFigure (Figure fig:largerN)a shows the eigenenergies for $n=1$ to $n=5$ particles on the plaquette for a ratio of interaction strength to tunneling of $U/t = 13.5$, which is the approximate ratio of our experimental devices.\nFor a given particle number, the eigenenergies are largely grouped around integer values of the interaction energy $U$.\nCorrespondingly, the grouped eigenstates approximately reflect different Fock-state partitions of the $n$ particles over the four sites, labeled in the subfigure.\nFor example, $n=3$ particles can be partitioned by placing all three particles on one site (\u201c3\u201d, with four Fock states); two particles on one site and one particle on a different site (\u201c2+1\u201d, with twelve Fock states), or all three particles on unique sites (\u201c1+1+1\u201d, with four Fock states).\nBecause interactions are the dominant energy of the system, the respective eigenenergies are then close to $3U$, $U$, and $0$ (due to three, two, and no interacting particles on one of the sites).\nAt the same time, we are not strictly in the hard-core limit of infinite interaction strength; as a result, these partition subspaces are not completely uncoupled and there is weak hybridization between them.\nIn other words, the eigenstates labelled with a given partition do contain nonzero overlap with Fock states of different partitions.\n\nWe numerically simulate the dynamics of initial Fock states within each of these partitions to examine whether real-space or Fock-space caging occurs.\nFor finite interactions $U=13.5t$, we first consider dynamics across the entire Hilbert space.\nWe find that within each Fock-space partition there exists at least one initial Fock state for which real-space or Fock-space caging occurs (see Fig. (Figure fig:largerN)b).\nThis caging can be understood through examining the corresponding Hamiltonian adjacency graphs for the entire Hilbert space; Fig. (Figure fig:largerN)c shows the graphs for $n=2$ and $n=3$.\nFurthermore, this ubiquitous caging property persists for all nonzero interaction strengths.\n\n< g r a p h i c s >\n\nAdding particles to the $\\pi$-rhombus plaquette.\n(a) Energy spectra for particle number $n=1$ to $n=5$. Points are offset horizontally slightly for visibility. Colors correspond to the presence or absence of caging within the corresponding approximate Fock-state partition subspace, in the hard-core limit (see text for details).\n(b) Tabulation of Fock states that are caged and the Fock states that they never reach, separated by blockaded arrows.\n\nStates that are outlined in blue exhibit real-space caging, while those outlined in green exhibit Fock-state caging. Caging from states that are neither highlighted nor outlined can be understood through the Hamitonian adjacency graph in (c). For simplicity, we do not include the caged states that can be mapped onto the ones shown under the symmetries of the plaquette.\n(c) Hamiltonian adjacency graphs for the entire Hilbert space for $n=2$ and $n=3$. Thicknesses of edges roughly indicate coupling strength, which differ due to bosonic enhancement;  yellow solid (blue dashed) color and linestyle indicate positive (negative) tunneling.\n\nNext we consider the hard-core limit: for a given initial Fock state, we determine whether it explores all other Fock states within the partition subspace.\nIf at least one Fock state within a partition experiences caging, the entire subspace is labelled as exhibiting the caging property.\nIn these characterizations, we label real-space caging as caging that is evident through average single-site measurements over all four sites.\nFock-space caging is then caging that is only evident through average two- or multi-site measurements over all four sites.\nFor example, the 1+1+1 subspace can be understood in the hard-core limit by considering the motion of the single hole, rather than the three particles.\nIn this case, the single hole experiences caging, and (as in main text Fig. 2) measurements of a single site at a time are sufficient to identify such caging.\nThe results are color-coded in Fig. (Figure fig:largerN)a and the states that are real-space (Fock-space) caged are outlined in blue (green) in Fig. (Figure fig:largerN)b.\nHere, we find a general pattern where odd values of $n$ exhibit some form of caging within each subspace, while even values of $n$ largely do not, a possible generalization from the single-particle caging and doublon escape discussed in the main text.\n\nThe real-space caged subspaces can be straightforwardly understood: to begin, the partitions of all particles on one site ($n$ odd) behave as a single composite particle that sees $\\pi$ flux through the plaquette and are therefore caged.\nThe other subspaces can be understood in relation to the Mott insulator case for $n=4$ where particles cannot tunnel because every site is occupied.\nWith this in mind, the real-space caging within the 2+1+1+1 subspace can be described by the motion on a single particle on the Mott insulator background; similarly, the real-spacing caging of the 1+1+1 subspace can be thought of as the caging of a hole placed in the Mott insulator.\n\nThe Fock-space caged subspaces also contain a rich structure.\nFor odd $n$, each caged state seems to be caged from exactly one other state in its subspace.\nFurthermore, the two states are related by a 180-degree rotation, which results from the symmetry and flux structure of the Hamiltonian adjacency graph.\nInterestingly, there are Fock-space caged subspaces for even $n$ as well, for example the 1+1 subspace for $n=2$.\nWe predict the corresponding subspaces are also Fock-space caged for even $n$ where $n \\equiv 2$ (mod $4$), as they are equivalent to two particles on a Mott insulator background (which exists for $n$ where $n\\equiv 0$ (mod $4$)).\n\n"}
{"prompt": "What are the key contributions of the paper 'Demonstrating a Continuous Set of Two-qubit Gates for Near-term Quantum Algorithms'?", "completion": "\n\nAPS/123-QED\n\n# Demonstrating a Continuous Set of Two-qubit Gates for Near-term Quantum Algorithms\n\n$^1$ Department of Physics, University of California, Santa Barbara, CA\n\n$^2$ Google Research, Santa Barbara, CA 93117\n\n$^3$ Department of Electrical and Computer Engineering, University of Massachusetts Amherst, Amherst, MA\n\n$^b$ martinis@physics.ucsb.edu\n\n$^*$ these authors contributed equally to this work.\n\nGoogle AI Quantum\n\nQuantum algorithms offer a dramatic speedup for computational problems in machine learning, material science, and chemistry. However, any near-term realizations of these algorithms will need to be optimized to fit within the finite resources offered by existing noisy hardware.  Here, taking advantage of the adjustable coupling of gmon qubits, we demonstrate a continuous two-qubit gate set that can provide a 3x reduction in circuit depth as compared to a standard decomposition. We implement two gate families: an iSWAP-like gate to attain an arbitrary swap angle, $\\theta$, and a CPHASE gate that generates an arbitrary conditional phase, $\\phi$. Using one of each of these gates, we can perform an arbitrary two-qubit gate within the excitation-preserving subspace allowing for a complete implementation of the so-called Fermionic Simulation, or fSim, gate set. We benchmark the fidelity of the iSWAP-like and CPHASE gate families as well as 525 other fSim gates spread evenly across the entire fSim($\\theta$, $\\phi$)  parameter space achieving purity-limited average two-qubit Pauli error of $3.8 \\times 10^{-3}$ per fSim gate.\n\nINTRODUCTION\n\nQuantum computing is a potentially transformative technology, but challenges remain in identifying a path towards solving practical problems with a quantum advantage [Feynman, Richard P., \"Simulating physics with computers\", 1982]. Continued progress towards this goal may be made on many fronts including qubit coherence or scalability [Koch, Jens, Yu, Terri M., Gambetta, Jay, Houck, A. A., Schuster, D. I., Majer, J., Blais, Alexandre, Devoret, M. H., Girvin, S. M., Schoelkopf, R. J., \"Charge-insensitive qubit design derived from the Cooper pair box\", 2007] [Rosenberg, D.\nand Kim, D.\nand Das, R.\nand Yost, D.\nand Gustavsson, S.\nand Hover, D.\nand Krantz, P.\nand Melville, A.\nand Racz, L.\nand Samach, G. O.\nand Weber, S. J.\nand Yan, F.\nand Yoder, J. L.\nand Kerman, A. J.\nand Oliver, W. D., \"3D integrated superconducting qubits\", 2017], measurement or gate fidelities [Schuster, D. I., Wallraff, A., Blais, A., Frunzio, L., Huang, R.-S., Majer, J., Girvin, S. M., Schoelkopf, R. J., \"ac Stark Shift and Dephasing of a Superconducting Qubit Strongly Coupled to a Cavity Field\", 2005] [Jeffrey, Evan, Sank, Daniel, Mutus, J. Y., White, T. C., Kelly, J., Barends, R., Chen, Y., Chen, Z., Chiaro, B., Dunsworth, A., Megrant, A., O'Malley, P. J. J., Neill, C., Roushan, P., Vainsencher, A., Wenner, J., Cleland, A. N., Martinis, John M., \"Fast Accurate State Measurement with Superconducting Qubits\", 2014], and algorithmic improvements that reduce the required circuit depth through compilation [Chong, Frederic T.\nand Franklin, Diana\nand Martonosi, Margaret, \"Programming languages and compiler design for realistic quantum hardware\", 2017]. In superconducting qubits, single-qubit gates are usually a factor of two or more lower error than two-qubit gates. Consequently, a typical strategy has been to demonstrate a minimally universal gate set consisting of arbitrary single-qubit rotations and a single two-qubit gate [Barenco, Adriano, Bennett, Charles H., Cleve, Richard, DiVincenzo, David P., Margolus, Norman, Shor, Peter, Sleator, Tycho, Smolin, John A., Weinfurter, Harald, \"Elementary gates for quantum computation\", 1995]. This is an efficient approach for some algorithms, e.g. surface code error correction, which compiles optimally with such a gate set [Fowler, Austin G., Mariantoni, Matteo, Martinis, John M., Cleland, Andrew N., \"Surface codes: Towards practical large-scale quantum computation\", 2012]. However, many noisy intermediate-scale quantum (NISQ, [Preskill, John, \"Quantum Computing in the NISQ era and beyond\", 2018]) algorithms require a more diverse set of two-qubit gates. An implementation of these gates could take the place of six to eight single-qubit gates and three $\\rm CZ_{\\phi}$ gates per arbitrary two-qubit gate required with an optimal decomposition into a minimally-universal gate set [Navin Khaneja, Steffen J. Glaser, \"Cartan decomposition of SU(2n) and control of spin systems\", 2001].\n\nIn the NISQ era, we need the largest two-qubit gate set that may be implemented with high-fidelity. A general two-qubit unitary gate allows independent control over the strength of $\\sigma_X \\sigma_X$, $\\sigma_Y \\sigma_Y$, and $\\sigma_Z \\sigma_Z$ coupling between qubits requiring both DC and microwave control of gmon qubits [Chen, Yu, Neill, C., Roushan, P., Leung, N., Fang, M., Barends, R., Kelly, J., Campbell, B., Chen, Z., Chiaro, B., Dunsworth, A., Jeffrey, E., Megrant, A., Mutus, J. Y., O'Malley, P. J. J., Quintana, C. M., Sank, D., Vainsencher, A., Wenner, J., White, T. C., Geller, Michael R., Cleland, A. N., Martinis, John M., \"Qubit Architecture with High Coherence and Fast Tunable Coupling\", 2014]. However, models of interacting particles typically conserve the number of excitations corresponding to a simpler model where the $\\sigma_X \\sigma_X$ and $\\sigma_Y \\sigma_Y$ couplings have equal coefficients.  This reduces the number of control parameters from three to two and eliminates the need for microwave control during an algorithm. This set of excitation-conserving gates has been appropriately termed the Fermionic Simulation, or fSim, gate set since it maps electron conservation in a chemistry problem to photon conservation in qubits [Kivlichan, Ian D., McClean, Jarrod, Wiebe, Nathan, Gidney, Craig, Aspuru-Guzik, Al\u00e1n, Chan, Garnet Kin-Lic, Babbush, Ryan, \"Quantum Simulation of Electronic Structure with Linear Depth and Connectivity\", 2018]. An fSim gate can be defined with two control angles, $\\theta$, the $\\ket{01} \\leftrightarrow \\ket{10}$ swap angle, and, $\\phi$, the phase of the $\\ket{11}$ state with a matrix representation in the $\\ket{00}, \\ket{01}, \\ket{10}, \\ket{11}$ basis given by:\n\n$$\n\n\\label{eq:fsim_main}\n\\rm fSim(\\theta, \\phi) = \\left(\\begin{array}{cccc}\n1 & 0 & 0 & 0  \\\\\n0 & \\cos\\,\\theta & -i\\sin\\,\\theta & 0 \\\\\n0 & -i\\sin\\,\\theta  & \\cos\\,\\theta & 0 \\\\\n0 & 0 & 0 & e^{-i\\phi}\n\\end{array}\\right)\n\n$$\n\nWe use this as both a convenient definition and a useful model for describing general two-qubit gates resulting from arbitrary flux control of gmon qubits. Notably, promising low-depth algorithms using this gate set have been proposed including the quantum approximate optimization algorithm [Edward Farhi, Aram W Harrow, \"Quantum Supremacy through the Quantum Approximate Optimization Algorithm\", 2016] and an algorithm for linear-depth circuits simulating the electronic structure of molecules [Kivlichan, Ian D., McClean, Jarrod, Wiebe, Nathan, Gidney, Craig, Aspuru-Guzik, Al\u00e1n, Chan, Garnet Kin-Lic, Babbush, Ryan, \"Quantum Simulation of Electronic Structure with Linear Depth and Connectivity\", 2018]. Additionally, algorithms performed with just z-rotations and fSim gates enable error mitigation techiques including post selection and zero noise extrapolation [Kandala, Abhinav\nand Temme, Kristan\nand C\u00f3rcoles, Antonio D.\nand Mezzacapo, Antonio\nand Chow, Jerry M.\nand Gambetta, Jay M., \"Error mitigation extends the computational reach of a noisy quantum processor\", 2019], further improving this gate set\u2019s prospects on NISQ processors.\n\nHere, we first demonstrate the strong flux tunable coupling between gmon qubits which we use to perform fast two-qubit gates. Then, to describe our calibration and control strategy, we use shallow circuits to illuminate the natural correspondence of the coupled transmon Hamiltonian and the fSim gate set. We use cross-entropy benchmarking (XEB, [Boixo, Sergio\nand Isakov, Sergei V.\nand Smelyanskiy, Vadim N.\nand Babbush, Ryan\nand Ding, Nan\nand Jiang, Zhang\nand Bremner, Michael J.\nand Martinis, John M.\nand Neven, Hartmut, \"Characterizing quantum supremacy in near-term devices\", 2018]) to characterize two linearly independent and continuous families of entangling gates: the iSWAP-like family corresponding to $\\rm fSim(\\theta, \\phi \\propto \\theta^{2})$, and the CPHASE family corresponding to $\\rm fSim(\\theta \\approx 0^{\\circ}, \\phi)$. We then combine these two continuous gate sets to calibrate and benchmark 525 fSim gates spread evenly across the entire ($\\theta$, $\\phi$) parameter space.\n\n< g r a p h i c s >\n\nDemonstration of the tunable coupling between gmon qubits. a, Pulse sequence used to measure swapping as a function of coupler bias.  We initialize one qubit, perform an fSim gate, defined by a set of three flux pulses that control the qubit frequencies and the coupling between the qubits, and measure the population of the other qubit. b, We vary the fSim gate as a function of the length and amplitude of the coupler pulse to measure the swap rate as a function of the bias amplitude. c, By taking the Fourier transform of the oscillations in b, we extract the coupling strength, $|g|$, as a function of coupler bias. The coupling changes sign at the two \u201cOFF\u201d biases ensuring we can turn the coupling off.\n\nSTRONG COUPLING WITH GMON QUBITS\n\nThe quantum processors used in this work each consist of four gmon transmon qubits in a chain, together with three couplers. Both the qubit frequencies and their coupling can be independently controlled, providing several advantages over fixed coupling designs [Chen, Yu, Neill, C., Roushan, P., Leung, N., Fang, M., Barends, R., Kelly, J., Campbell, B., Chen, Z., Chiaro, B., Dunsworth, A., Jeffrey, E., Megrant, A., Mutus, J. Y., O'Malley, P. J. J., Quintana, C. M., Sank, D., Vainsencher, A., Wenner, J., White, T. C., Geller, Michael R., Cleland, A. N., Martinis, John M., \"Qubit Architecture with High Coherence and Fast Tunable Coupling\", 2014] [Charles Neill, \"A path towards quantum supremacy with superconducting qubits\", 2017] [Yan, Fei, Krantz, Philip, Sung, Youngkyu, Kjaergaard, Morten, Campbell, Daniel L., Orlando, Terry P., Gustavsson, Simon, Oliver, William D., \"Tunable Coupling Scheme for Implementing High-Fidelity Two-Qubit Gates\", 2018]. Firstly, since we can turn off the coupling at any detuning, both qubits may idle and perform single-qubit gates while operating closer to their flux insensitive point. This improves dephasing and decreases our sensitivity to flux settling tails. Secondly, since entangling gates are performed by bringing the qubit states near resonance, idling the qubits closer together means that gates require much smaller dynamic detunings, further reducing the amplitude of flux settling tails [Rol, M. A., Battistel, F., Malinowski, F. K., Bultink, C. C., Tarasinski, B. M., Vollmer, R., Haider, N., Muthusubramanian, N., Bruno, A., Terhal, B. M., DiCarlo, L., \"Fast, High-Fidelity Conditional-Phase Gate Exploiting Leakage Interference in Weakly Anharmonic Superconducting Qubits\", 2019] [B Foxen, J Y Mutus, E Lucero, E Jeffrey, D Sank, R Barends, K Arya, B Burkett, Yu Chen, Zijun Chen, B Chiaro, A Dunsworth, A Fowler, C Gidney, M Giustina, R Graff, T Huang, J Kelly, P Klimov, A Megrant, O Naaman, M Neeley, C Neill, C Quintana, P Roushan, A Vainsencher, J Wenner, T C White, John M Martinis, \"High speed flux sampling for tunable superconducting qubits with an embedded cryogenic transducer\", 2018]. Thirdly, since the on/off coupling ratio is not dependent on the maximum qubit-qubit detuning, we are able to increase the overall coupling strength enabling faster gates with reduced decoherence error.\n\nIn Figure (Figure fig:coupling) we characterize the qubit-qubit coupling strength as a function of the coupler flux bias. Using the pulse sequence in Figure (Figure fig:coupling)a, we initialize one qubit, apply an fSim gate, and measure the population transferred to the other qubit. Each fSim gate is defined by the amplitude and duration of three, nominally rectangular, flux bias pulses. Two pulses control the qubit frequencies and set their relative detuning, $\\Delta$, while the third pulse controls the coupling strength between the qubits, $g$. In Figure (Figure fig:coupling)b we repeat this pulse sequence using the qubit flux biases to place them on resonance ($\\rm \\Delta = 0\\,$MHz) while varying the coupler bias amplitude and the shared duration of all three pulses. By taking  the Fourier transform of the oscillating population data in (Figure fig:coupling)b we extract the swap rate as a function of coupler bias which is equivalent to twice the qubit-qubit coupling, $g$, plotted in Figure (Figure fig:coupling)c. We measure $g/2\\pi=6\\,$MHz when the coupler is biased to zero $\\Phi_{0}$, and a coupling exceeding -50 MHz as the coupler bias approaches $\\rm \\Phi_{0}/2$. The net coupling changes sign between these two regions ensuring we can turn the coupling off. During general operation, we idle and perform single-qubit gates with the coupler at the \u201cOFF\u201d bias and make excursions to stronger couplings (\u201cON\u201d region) to perform fSim gates. In this work we use $g_{\\rm{max}}/2\\pi \\approx -45\\,$MHz which is three times stronger than is typical for fixed coupling devices.\n\nCOUPLED TRANSMON PHYSICS AND THE FSIM GATE SET\n\n< g r a p h i c s >\nExploring the parameter space of two-qubit gates. Each pixel represents one experiment. We use a set of 15 ns rectangular current bias waveforms to perform some fSim unitary by setting the qubit-qubit detuning, $\\Delta$, and the coupling strength, $g$. a, To identify the low-leakage gates described by the fSim model, we measure leakage by initializing the $\\ket{11}$ state and measuring the $\\ket{02}$ state. When the detuning is near the qubit nonlinearity, we observe the expected Rabi oscillations. b, We measure the conditional phase, $\\phi$, by performing a Ramsey experiment where we initialize one qubit with an X/2 gate and perform tomography to measure the difference in accumulated phase ($\\phi$) with and without initializing the other qubit to the $\\ket{1}$ state. By choosing combinations of $\\Delta$ and $g$ as indicated by the CPHASE dash-dotted line (chosen as the low-leakage coupling strength from a), we are able to achieve any $\\rm \\phi : [-180^{\\circ}, 180^{\\circ}]$. c, We measure the swap angle, $\\theta$, by initializing the $\\ket{01}$ state and measuring the $\\ket{10}$ state. By placing the qubits on resonance and varying the coupling strength along the iSWAP-like dashed line, we are able to achieve any $\\rm \\theta : [0^{\\circ}, 90^{\\circ}]$.\n\nIn the absence of a resonant microwave drive, coupled transmon qubits naturally evolve within the excitation-preserving subspace. The specific time evolution is determined by three parameters: the qubit nonlinearity, $\\eta$, the qubit-qubit frequency detuning,$\\Delta$, and the coupling between qubits, $g$. While $\\eta$ is fixed at 240 MHz by qubit capacitance, the gmon architecture allows for time-dependent control of both $\\Delta$ and $|g|$ using DC to $\\approx 200\\,$MHz bandwidth flux waveforms. The qubit center frequency, $(f_{q1} + f_{q2})/2$, is a free parameter that may be used to avoid coupled two level system (TLS) defects present in the frequency spectrum of either qubit [Macha,P. , van der Ploeg,S. H. W. , Oelsner,G. , Il\u2019ichev,E. , Meyer,H.-G. , W\u00fcnsch,S. , Siegel,M. , \"Losses in coplanar waveguide resonators at millikelvin temperatures\", 2010] [Shalibo, Yoni, Rofe, Ya'ara, Shwa, David, Zeides, Felix, Neeley, Matthew, Martinis, John M., Katz, Nadav, \"Lifetime and Coherence of Two-Level Defects in a Josephson Junction\", 2010] [Klimov, P. V., Kelly, J., Chen, Z., Neeley, M., Megrant, A., Burkett, B., Barends, R., Arya, K., Chiaro, B., Chen, Yu, Dunsworth, A., Fowler, A., Foxen, B., Gidney, C., Giustina, M., Graff, R., Huang, T., Jeffrey, E., Lucero, Erik, Mutus, J. Y., Naaman, O., Neill, C., Quintana, C., Roushan, P., Sank, Daniel, Vainsencher, A., Wenner, J., White, T. C., Boixo, S., Babbush, R., Smelyanskiy, V. N., Neven, H., Martinis, John M., \"Fluctuations of Energy-Relaxation Times in Superconducting Qubits\", 2018]. For simplicity, we limit our fSim control pulses to synchronous, nominally rectangular waveforms defined by four parameters: a shared length, typically 13 ns to 15 ns and three control amplitudes that set $g$ and $\\Delta$. While further pulse shaping may improve gate performance in the future, these basic waveforms were sufficient to approach the decoherence limit of our qubits which have a $\\rm T_1$ of $25.3 \\pm 7.3\\,\\mu$s (supplement <ref>).\n\nThe full fSim control model describes any low-leakage two-qubit unitary evolution with five parameters: $\\theta$ and $\\phi$, discussed previously, in addition to three parameters describing single-qubit phases as detailed in the supplement (<ref>). Here, we focus on the parameters that describe the two-qubit interaction and use the three experiments described in Figure (Figure fig:background_scans) to measure leakage to the $\\ket{02}$ state and map out the $\\phi$ and $\\theta$ control landscape (complete unitary tomography procedure outlined in supplemental section <ref>). Each experiment follows the same pattern: initialize a relevant state, apply fSim control pulses, and then perform either population or tomographic measurements to extract the desired qubit's population or phase. Within the fSim model, leakage is the dominant error. In Figure (Figure fig:background_scans)a, we map out leakage by initializing $\\ket{11}$ and measuring the $\\ket{0}$ population of the lower frequency qubit as a proxy for leakage in the higher frequency qubit. In Figure (Figure fig:background_scans)b we explore the $\\phi$ parameter space by performing a Ramsey experiment where we take the difference in the accumulated phase with and without the second qubit initialized to the $\\ket{1}$ state. Finally, in Figure (Figure fig:background_scans)c we explore the $\\theta$ parameter space by initializing one qubit to the $\\ket{1}$ state and measuring the $\\ket{1}$ population of the other qubit after the fSim gate. The Rabi oscillation physics explored with these measurements is reproduced with fairly rudimentary numerics in supplemental <ref>, but these experiments serve to demonstrate our fSim control strategy.\n\nBENCHMARKING ISWAP-LIKE AND CPHASE GATES\n\n< g r a p h i c s >\n\nCharacterizing the iSWAP-like and CPHASE gate families with cross-entropy benchmarking. We plot the optimized fSim control angles, $\\theta$ and $\\phi$, on the left y-axes and the Pauli gate error per two-qubit gate on the right y-axes, conservatively assuming $\\rm 7.5 \\times 10^{-4}$ single-qubit Pauli gate errors. a, Characterization of the CPHASE gate family corresponding to $\\rm fSim(\\theta \\approx 0^{\\circ}, \\phi)$. Each gate is 15 ns long, consisting of control pulses that vary the qubit detuning, $\\Delta$, around the qubit nonlinearity, $\\eta$, with a coupler bias amplitude chosen to complete one full swap: $\\ket{11} \\rightarrow \\ket{02} \\rightarrow \\ket{11}$. We measure an average two-qubit Pauli error of $\\rm 1.9 \\times 10^{-3}$ for the CPHASE family. b, Characterization of the iSWAP-like gate family corresponding to $\\rm fSim(\\theta, \\phi \\propto \\theta^{2})$.  Each gate is 13 ns long, consisting of control pulses that place the qubits on resonance and vary the coupling strength, $|g|$, to achieve an arbitrary swap angle $\\theta$ between the $\\ket{01}$ and $\\ket{10}$ states. We measure an average two-qubit Pauli error of $\\rm 1.2 \\times 10^{-3}$ for the iSWAP-like family.\n\nThe data presented in Figure (Figure fig:background_scans) provides a map for implementing an arbitrary fSim\u2014each pixel defines a set of three control amplitudes, and any control amplitudes yielding low-leakage should result in a high-fidelity gate described by the fSim control model (Eq. <ref>). While it may be possible to perform an arbitrary fSim gate with a single set of flux pulses using either very strong coupling or more complex control waveforms, we have chosen to implement an arbitrary fSim gate as a composition of two continuous gate families using simple rectangular control pulses to minimize the gate length. The first gate family completes a diabatic $\\ket{11} \\rightleftarrows \\ket{02}$ swap to perform a gate with an arbitrary conditional phase, $\\phi$, using control amplitudes denoted by the dot-dashed line labeled 'CPHASE' in Figures (Figure fig:background_scans)a and (Figure fig:background_scans)b. The dominant control angle in the CPHASE gate family is the conditional phase, but, we do accumulate a small swap angle $\\theta$ due to the strong coupling necessary to perform a fast CPHASE gate ($\\theta \\leq 5^{\\circ}$ for a 13 ns CPHASE gate\u2014this may be reduced by increasing the gate duration). The second gate family places the qubits on resonance ($\\Delta = 0\\,$MHz) and varies $g$ to reach the desired swap angle, $\\theta$, using control amplitudes along the dashed line labeled \u201ciSWAP-like\u201d in Figure (Figure fig:background_scans)c. We have deemed this gate family \u201ciSWAP-like\u201d since the swap angle varies from $\\theta:[0^{\\circ}, 90^{\\circ}]$ and because this gate accumulates a conditional phase $\\phi \\propto \\theta^2$ due to the dispersive interaction with the $\\ket{02}$ and $\\ket{20}$ states. Both of these gates are a subset of the fSim group individually, and, compiled together, they can reach the full fSim parameter space.\n\nIn Figure (Figure fig:line_cut_fidelity) we characterize both the iSWAP-like and CPHASE gate families using cross-entropy benchmarking (XEB) [Boixo, Sergio\nand Isakov, Sergei V.\nand Smelyanskiy, Vadim N.\nand Babbush, Ryan\nand Ding, Nan\nand Jiang, Zhang\nand Bremner, Michael J.\nand Martinis, John M.\nand Neven, Hartmut, \"Characterizing quantum supremacy in near-term devices\", 2018]. On the left axes we plot the optimized values of $\\theta$ and $\\phi$ for a range of CPHASE and iSWAP-like gates, and on the right y-axes we plot the Pauli error per two-qubit gate (see supplemental <ref>), achieving average errors of $1.9  \\times 10^{-3}$ and $1.2 \\times 10^{-3}$ for each gate family respectively.\n\nBENCHMARKING FSSIM GATES\n\n< g r a p h i c s >\n\nBenchmarking the fSim gate set. Using XEB, we measure the Pauli error per cycle and subtract off a conservative estimate for the single-qubit Pauli gate errors of $\\rm 7.5 \\times 10^{-4}$. a, We plot the two-qubit Pauli error for 525 fSim gates where $\\rm \\theta$ and $\\rm \\phi$ have been constrained to a grid. b, Histogram of both the error and purity for the gates presented in a. Here we confirm a purity (coherence) limited average error for our fSim gates of $\\rm 3.83 \\times 10^{-3}$.\n\nIn Figure (Figure fig:fidelity)a we present the Pauli error of 525 distinct fSim($\\theta, \\phi$) gates where the values of $\\theta$ and $\\phi$ have been constrained to be exactly the values indicated by the xy-coordinates at the center of each pixel (where ex situ optimization has been used only to optimize the single-qubit phases). Each 28 ns long fSim gate in Figure (Figure fig:fidelity) is a composition of a 15 ns CPHASE gate followed by a 13 ns iSWAP-like gate. While the fSim fidelity is largely independent of the values of $\\theta$ and $\\phi$ there are a few features of note. As discussed in supplement <ref>, we most-directly calibrated line cuts at $\\theta = 0^{\\circ}, 90^{\\circ}$ and $\\phi = 180^{\\circ}$.  The regions of higher error where $\\phi$ is near $0^{\\circ}$ ($360^{\\circ}$) involve the most extrapolation from the directly calibrated control amplitudes. Secondly, there is a faintly-visible indication of a band of higher error near $\\phi \\approx 240^{\\circ}$ which we believe is due to a weakly interacting TLS defect in the spectrum of one of the qubits\u2014in the future we hope to avoid such defects by shifting the frequencies of both qubits while maintaining their relative detuning. In Figure (Figure fig:fidelity)b we histogram these results in addition to the purity [Joel Wallman, Chris Granade, Robin Harper, Steven T Flammia, \"Estimating the coherence of noise\", 2015] per fSim and confirm a purity-limited average Pauli error of $\\rm 3.83 \\times 10^{-3}$ per fSim gate.\n\nCONCLUSIONS\n\nWe have implemented continuous iSWAP-like and CPHASE gate families with average Pauli error rates of $1.2 \\times 10^{-3}$ and $1.9 \\times 10^{-3}$ respectively. These fast (13-15 ns) gates take advantage of the strong, tunable, qubit-qubit coupling offered by our gmon transmon qubit architecture achieving error rates more than a factor of two lower than the best previously reported two-qubit gates for superconducting qubits [Barends, R., Quintana, C.\u00a0M., Petukhov, A.\u00a0G.,\nChen, Y., Kafri, D., Kechedzhi, K., Collins, R.,\nNaaman, O., Boixo, S., Arute, F., Arya, K.,\nBuell, D., Burkett, B., Chen, Z., Chiaro, B.,\nDunsworth, A., Foxen, B., Fowler, A., Gidney, C.,\nGiustina, M., Graff, R., Huang, T., Jeffrey, E.,\nKelly, J., Klimov, P.\u00a0V., Kostritsa, F., Landhuis, D.,\nLucero, E., McEwen, M., Megrant, A., Mi, X.,\nMutus, J., Neeley, M., Neill, C., Ostby, E.,\nRoushan, P., Sank, D., Satzinger, K.\u00a0J., Vainsencher, A.,\nWhite, T., Yao, J., Yeh, P., Zalcman, A.,\nNeven, H., Smelyanskiy, V.\u00a0N., Martinis, J.\u00a0M., \"Diabatic gates for frequency-tunable superconducting qubits\", 2019]. Additionally, we have combined these two gate sets to demonstrate a complete implementation of the two-qubit fSim gate set with an average Pauli error of $3.83 \\times 10^{-3}$ per gate. This direct implementation of the fSim gate offers roughly an additional factor of three in compilation efficiency for NISQ algorithms over a minimally-universal gate set.\n\nThis work was supported by Google LLC.  The UC Santa Barbara Nanofabrication Facility, part of the National Nanotechnology Infrastructure Network funded by NSF, fabricated the gmon qubits.\n\n$^*$ These authors contributed equally to this work\n\nunsrt\n\nFSIM CONTROL MODEL\n\nId\nCZ\nCR\niSWAP\nfSim\nT\nI\nX\nY\nZ\nH\u030b\nI\nP\nA\nIQC\n\u2119\n\u2112\n\nA generic representation of a Fermionic Simulation (fSim) gate corresponding to a two-qubit photon conserving unitary requires five parameters. We may separate out the single and two-qubit parameters as follows: a $\\ket{01} \\leftrightarrow \\ket{10}$ swap angle, $\\theta$, a $\\ket{11}$ state conditional phase, $\\phi$, and three single qubit phases, $\\Delta_+, \\Delta_-,$ and $\\Delta_{-,off}$ yielding a generic fSim parameterization,\n\n$$\n\n\\label{eq:fsim_full}\n{\\rm fSim}&(\\theta,\\phi, \\Delta_+, \\Delta_-, \\Delta_{-,off} ) = \\nonumber \\\\\n&\\begin{pmatrix}1 & 0 & 0 & 0 \\\\\n0 & e^{i (\\Delta_+ + \\Delta_-)} \\cos \\theta & -i e^{i (\\Delta_+ - \\Delta_{-,off})} \\sin \\theta & 0 \\\\\n0 & -i e^{i (\\Delta_+ + \\Delta_{-,off})} \\sin \\theta & e^{i (\\Delta_+ - \\Delta_-)} \\cos \\theta & 0 \\\\\n0 & 0 & 0 & e^{i (2\\Delta_+ + \\phi)} \\\\\n\\end{pmatrix}\n\n$$\n\nWe are interested in performing a two-qubit gate,\nwhich is independent of the single-qubit rotations. Therefore, we\ncan focus on the matrix where $\\Delta_+, \\Delta_-,$ and $\\Delta_{-,off}$are all zero, leading to the notation,\n$$\n\n\\label{eq:19}\n{\\rm fSim}(\\theta,\\phi) =  \\begin{pmatrix}\n1 & 0 & 0 & 0 \\\\\n0 & \\cos \\theta &  -i \\sin \\theta & 0 \\\\\n0 & -i \\sin \\theta & \\cos \\theta & 0 \\\\\n0 & 0 & 0 & e^{-i \\phi} \\\\\n\\end{pmatrix}\n\n$$\nused to designate an arbitrary gate within the excitation preserving subspace.\n\nFSIM GATE NUMERICS\n\n< g r a p h i c s >\n\nNumeric simulation of two interacting qutrits reproducing the data from our experiments in Figure (Figure fig:background_scans) of the main text. We simulate qubits with a fixed nonlinearity (240 MHz) with 15 ns long rectangular control pulses defining the qubit detuning, $\\Delta$, and their coupling, $g$.\n\nThe qubit dynamics presented in the main paper (Figure (Figure fig:background_scans)) are well described by numerics simulating two interacting qutrits (e.g. a pair of coupled three-level anharmonic oscillators) evolving with a time dependent detuning, $\\Delta(t)$, and coupling, $g(t)$. We truncate the full two-qutrit Hamiltonian limiting our simulation to states with 1 or 2 excitations. Operating with the basis $\\ket{01}, \\ket{10}, \\ket{11}, \\ket{20}, \\ket{02}$, the Hamiltonian describing the system is given by:\n\n$$\n\n\\rm H(g, \\Delta, \\eta) = \\left(\\begin{array}{ccccc}\n0 & g & 0 & 0 & 0 \\\\\ng & \\Delta & 0 & 0 & 0 \\\\\n0 & 0 & \\Delta & \\sqrt2 g & \\sqrt2 g \\\\\n0 & 0 & \\sqrt2 g & 2\\Delta + \\eta & 0\\\\\n0 & 0 & \\sqrt2 g & 0 & \\eta \\\\\n\\end{array}\\right)\n\n$$\n\nwhere $\\eta$ is the nonlinearity of each qubit, which we assume is the same for both qubits (240 MHz). Using this model, we may estimate the unitary operation enacted by arbitrary time-domain control of the coupling strength and the qubit detuning by discretizing these time domain control waveforms and performing a time ordered integral of $\\rm H(t)$.\n\nIn Figure (Figure fig:sim_background_scans) we qualitatively reproduce the experimental results in Figure (Figure fig:background_scans) by simulating 15 ns rectangular control pulses defining both $g$ and $\\rm \\Delta$. In Figure (Figure fig:sim_length) we illustrate the broadening effect that using shorter pulse lengths has on the Rabi interactions of both the $\\ket{01} \\leftrightarrow \\ket{10}$ and $\\ket{11} \\leftrightarrow \\ket{02}$ interactions by simulating rectangular pulses that are 10 ns, 15 ns, and 20 ns long. In Figures (Figure fig:sim_length) and (Figure fig:sim_smooth), we have omitted points where the leakage exceeds a 1\n\n< g r a p h i c s >\n\nNumeric simulation of a, 10 ns, b, 15 ns, and c, 20 ns rectangular control pulses showing the fSim parameter space where leakage is less than 1\n\n< g r a p h i c s >\n\nNumeric simulation of a, a 20 ns rectangular coupler pulse, b, a 3 ns rise time rectangular pulse, and c, cosine coupler pulse showing the fSim parameter space where leakage is less than 1\n\nGATE CHARACTERIZATION\n\nWe use a variety of techniques to characterize the performance of our single and two-qubit gates which we detail in this section. In lieu of full process tomography, we use depth one population based measurements to perform unitary tomography to quickly assess the unitary operation performed by a given set of control pulses. We then turn to benchmarking techniques that amplify gate errors and allow for the characterization of small error rates. We use Clifford based benchmarking to characterize our single-qubit microwave gates and cross-entropy benchmarking (XEB) to characterize our two-qubit entangling gates.\n\nComputing and reporting Pauli error rates\n\nBefore jumping in to gate characterization, a quick aside on Pauli error rates. We report Pauli error rates which are independent of the Hilbert space dimension and thus add linearly as the circuit's Hilbert space grows. In the past, many have reported average single and two-qubit error, $e_r$, as exponential decay constants of a sequence fidelity, $F = A e^{me_r} + B$ where $A$ and $B$ are fit parameters to compensate for state preparation and measurement (SPAM) errors, $m$ is the number of gate repetitions in the sequence, and $e_r$ is the error per cycle. The Pauli error, $e_p$, is related to $e_r$ by the dimension of the Hilbert space:\n\n$$\n\ne_p = e_r \\times \\Big( 1 + \\frac{1}{D} \\Big)\n\n$$\n\nwhere $\\rm D = 2^n$ is the dimension of the Hilbert space for an n-qubit gate. We note that this results in an increase in the reported error by a factor of 1.5 for single-qubit gates ($n=1$) and a by a factor of 1.25 for two-qubit gate errors ($n=2$).\n\nWhen performing two-qubit XEB, we measure the exponential decay constant per cycle, $e_{r,\\rm{cycle}}$ where each cycle consists of the application of one single-qubit gate per qubit and one fSim entangling gate involving both qubits. In order to extract the error per fSim gate, we can convert this to a Pauli error per cycle, $e_{p,\\rm{cycle}}$, and subtract off the two single-qubit Pauli gate errors, $e_{p,\\rm{q_1}}$ and $e_{p,\\rm{q_2}}$, which we estimate using single-qubit Clifford based randomized benchmarking.\n\n$$\n\ne_{p,\\rm{2q}} = e_{p,\\rm{cycle}} - (e_{p,\\rm{q_1}} + e_{p,\\rm{q_2}})\n\n$$\n\nFor simplicity, all two-qubit Pauli errors have been computed assuming single-qubit Pauli errors of $7.5 \\times 10^{-4}$ per gate per qubit consistent with our typical single-qubit error rates immediately following a successful run of our standard single-qubit gate calibration procedure (see supplement <ref>).\n\n$$\n\ne_{p,\\rm{two\\_qubit}} = e_{p,\\rm{cycle}} - (2 \\times 7.5 \\times 10^{-4}) = e_{p,\\rm{cycle}} - 1.5\\times10^{-3}\n\n$$\n\nSingle-qubit coherence and gates\n\n< g r a p h i c s >\n\nSwap spectroscopy for four qubits from 5 to 6 GHz characterizing the qubit $T_1$ as a function of qubit frequency. For all four qubits on this chip over the available frequencies in the range of 5-6 GHz we find an average $T_1 = 25.3 \\pm 7.3 \\mu$s.\n\nQubit coherence, in conjunction with gate duration, places a lower bound on both our single and two-qubit gate error rates.  In Figure (Figure fig:T1) we characterize $T_1$ for four qubits over a frequency range of 5 to 6 GHz. To perform this measurement we calibrate single-qubit gates, readout, and flux bias frequency control for a given qubit idle frequency. We then excite the qubit to the $\\ket{1}$ state and detune the qubit to another frequency for a variable amount of time before detuning back to the idle frequency for readout. For each detuned frequency, $T_1$ is extracted as an exponential decay of the population over time, $P\\ket{1} \\propto A e^{-t/T_1} + B$, where $A$ and $B$ are fit parameters to compensate for state preparation and measurement errors. We find $T_1 = 25.3 \\pm 7.3\\,\\mu$s averaging data from all four qubits over a frequency range of $\\rm 5-6\\,GHz$. Since $f_{\\rm{max}}$ for the second qubit was anomalously low, we averaged data for this qubit from $\\rm 5-5.61\\,GHz$.\n\n< g r a p h i c s >\n\nRepresentative single-qubit Clifford-based randomized benchmarking results used to characterize the average error of our single-qubit gates. With a typical calibration, the single-qubit Pauli errors for both qubits are usually in the range of $5 - 10 \\times 10^{-4}$. When computing the two-qubit gate error from the XEB per cycle error throughout this paper, we assume a moderately conservative error of $7.5 \\times 10^{-4}$ per single-qubit gate.\n\nWe use single-qubit purity [Joel Wallman, Chris Granade, Robin Harper, Steven T Flammia, \"Estimating the coherence of noise\", 2015] and Clifford-based randomized benchmarking [Magesan, Easwar, Gambetta, J. M., Emerson, Joseph, \"Scalable and Robust Randomized Benchmarking of Quantum Processes\", 2011] [C\u00f3rcoles, A. D., Gambetta, Jay M., Chow, Jerry M., Smolin, John A., Ware, Matthew, Strand, Joel, Plourde, B. L. T., Steffen, M., \"Process verification of two-qubit quantum gates by randomized benchmarking\", 2013] to characterize the average error of our single-qubit gates. In Figure (Figure fig:sq_rb) we present representative results for a pair of qubits demonstrating purity-limited (incoherent error-limited) performance. These gate errors drift over time, but immediately following a successful run of our standard calibration procedure we typically observe single-qubit error rates at or slightly higher than the $7.5 \\times 10^{-4}$ level [Chen, Zijun, Kelly, Julian, Quintana, Chris, Barends, R., Campbell, B., Chen, Yu, Chiaro, B., Dunsworth, A., Fowler, A. G., Lucero, E., Jeffrey, E., Megrant, A., Mutus, J., Neeley, M., Neill, C., O'Malley, P. J. J., Roushan, P., Sank, D., Vainsencher, A., Wenner, J., White, T. C., Korotkov, A. N., Martinis, John M., \"Measuring and Suppressing Quantum State Leakage in a Superconducting Qubit\", 2016].  As such, we use this estimate in computing two-qubit error rates throughout this paper. These error rates are consistent with the coherence limit, for $\\rm T_{\\rm{gate}} = 15$ ns and $\\rm T_1 = 30$ $\\rm \\mu$s, giving $e_{p,\\rm{inc}} \\approx 1.5 \\times \\rm{T_{gate}}/3 \\rm{T_1}) = 2.5 \\times 10^{-4}$, with the remainder of the error coming from leakage and $\\rm T_{2}$ [O'Malley, P. J. J., Kelly, J., Barends, R., Campbell, B., Chen, Y., Chen, Z., Chiaro, B., Dunsworth, A., Fowler, A. G., Hoi, I.-C., Jeffrey, E., Megrant, A., Mutus, J., Neill, C., Quintana, C., Roushan, P., Sank, D., Vainsencher, A., Wenner, J., White, T. C., Korotkov, A. N., Cleland, A. N., Martinis, John M., \"Qubit Metrology of Ultralow Phase Noise Using Randomized Benchmarking\", 2015].\n\nUnitary tomography\n\nSection II of the main text describes shallow circuits used to characterize leakage and the two-qubit control parameters, $\\theta$ and $\\phi$.  Here, we detail the procedure used to directly measure all the non-zero matrix elements composing an arbitrary photon conserving unitary operation and the algebra used to convert these matrix elements into the five fSim control parameters (in Eq. <ref>). We use the resulting fSim model to compute the XEB sequence fidelity which we may then use as a cost function to optimize some, or all, of the fSim model parameters.\n\nSummary of the two-qubit unitary tomography measurement sequences. Here, {$u_{11}, u_{12}, u_{22}, u_{21}$} are the complex matrix elements of the two-qubit unitary in [$\\ket{01}, \\ket{10}$] subspace. The two additional measurements ($u_{12,\\rm{excited}}$ and $u_{22,\\rm{excited}}$) are repeated measurements of $u_{12}$ and $u_{22}$ but with the other qubit placed into the excited state. This additional information is used to construct the conditional phase, $\\phi$.\n\nMatrix element     Initial state      Measure qubit\n$u_{11}$     (x, 0)     0\n$u_{12}$     (0, x)     0\n$u_{22}$     (0, x)     1\n$u_{21}$     (x, 0)     1\n$u_{21,\\rm{excited}}$     (1, x)     0\n$u_{22,\\rm{excited}}$     (1, x)     1\n\nIn order to efficiently characterize the unitary operation performed by a given set of control pulses, we initialize and measure a set of circuits as summarized in Table (Table table:unitary_tomography). If we consider a general photon conserving unitary the non-zero matrix elements will take the form:\n\n$$\n\n\\rm U = {\\begin{array}{cccc}\n\\ket{00} & \\ket{01} & \\ket{10} & \\ket{11}\n\\end{array} \\atop\n\\left(\\begin{array}{cccc}\n1 & 0 & 0 & 0  \\\\\n0 & u_{11} & u_{12} & 0 \\\\\n0 & u_{21}  & u_{22} & 0 \\\\\n0 & 0 & 0 & u_{33}\n\n\\end{array}\\right)}\n{\\begin{array}{c}\n\\\\\n\\end{array} \\atop\n\\begin{array}{c}\n\\ket{00} \\\\\n\\ket{01} \\\\\n\\ket{10} \\\\\n\\ket{11}\n\\end{array}}\n\n$$\n\nWhere $u_{nm}$ denotes a non-zero element. We measured $u_{nm}$ by initializing excited qubit in the basis ket of column $m$ with an $X/2$ gate, and measuring the expectation value of $\\sigma_x + i \\sigma_y$ of the excited qubit in the basis ket denoted by row $n$. e.g. for $u_{21}$ we initialize the left qubit, apply the fSim gate, and then measure $\\sigma_x + i \\sigma_y$ of the right qubit\u2014this is the complex value of $u_{21}$. This procedure works for the single excitation subspace (e.g. $n,m$ in $[1,2]$), but $u_{33}$ is computed from repeated measurements of $u_{12,\\rm{excited}}$ and $u_{22,\\rm{excited}}$ where the previously uninitialized qubit is instead placed into the $\\ket{1}$ state as summarized in Table (Table table:unitary_tomography). This procedure is similar to process tomography, but requires considerably fewer measurements to characterize the fSim matrix. We note that an optimal measurement sequence would require only 2$n$-1 circuits (for a $n \\times n$ matrix) [Saleh Rahimi-Keshari, Matthew A. Broome, Robert Fickler, Alessandro Fedrizzi, Timothy C. Ralph, Andrew G. White, \"Direct characterization of linear-optical networks\", 2013].  Even with several thousand repetitions of each circuit, characterizing the matrix with this method takes only a few seconds. Our series of six circuits is intentionally over-complete to avoid singular behavior when some matrix elements are small. In table (Table table:fsim_from_unitary) we list the conversion matrix elements to the five parameters of our fSim control model. These are useful measurements for building an fSim model, but we cannot characterize small gate errors ($\\approx 10^{-3}$) using this method due to the limitations of state preparation and measurement (SPAM) errors which are a few percent.\n\nComputing fSim model parameters from the results of our unitary tomography protocol. The \u201ccondition\u201d column is present because we compute $u_{33} = u_{22,\\rm{excited}}/u_{11}^*$ or $u_{33} = u_{12,\\rm{excited}}/u_{21}^*$ depending on if $u_{11}$ or $u_{21}$ is larger to ensure the result is non-singular. $\\psi_{10}$ is  the phase difference accumulated between the two qubits over the gate duration.\n\nfSim parameter     Value      condition\n$\\theta$     $\\arctan(|u_{12}|/|u_{11}|)$     none\n$\\phi$     $\\Delta_+ - \\angle(u_{12,\\rm{excited}} \\times u_{21})$     $|u_{21}|>|u_{11}|$\n$\\phi$     $\\angle(u_{22}) - \\angle(u_{22,\\rm{excited}})$     $|u_{21}|<|u_{11}|$\n$\\Delta_+$     $\\angle(-u_{11}\\times u_{21})$     $|u_{21}|>|u_{11}|$\n$\\Delta_+$     $\\angle(u_{11}\\times u_{22})$     $|u_{21}|<|u_{11}|$\n$\\Delta_-$     $2 \\times \\angle(u_{11})- \\Delta_+$     none\n$\\Delta_{-,\\rm{off}}$     $-2\\,(\\angle(-u_{12}/\\dot{\\imath}) + \\psi_{10})  + \\Delta_+$     $\\psi_{10} = (\\omega_{q_1} - \\omega_{q_0}) * t_{gate}$\n\nCross-entropy error benchmarking\n\nCross-entropy benchmarking (XEB) is a powerful technique for characterizing the error of an arbitrary gate [Boixo, Sergio\nand Isakov, Sergei V.\nand Smelyanskiy, Vadim N.\nand Babbush, Ryan\nand Ding, Nan\nand Jiang, Zhang\nand Bremner, Michael J.\nand Martinis, John M.\nand Neven, Hartmut, \"Characterizing quantum supremacy in near-term devices\", 2018]. It is particularly useful when implementing non-Clifford gates like the continuous fSim gate set we use here. XEB uses a repetitive gate sequence to amplify small errors where each cycle consists of a random single-qubit gate from the set {X/2, Y/2, $\\pm$X/2$\\pm$Y/2} applied to each qubit followed by the fSim gate we are benchmarking. We extract the error per cycle as an exponential decay in the XEB sequence fidelity, $\\mathcal{F}_{\\rm{XEB}}$.  The sequence fidelity is computed using the cross-entropy between two probability distributions $P$ and $Q$, $S(P, Q) = -\\sum_i p_i ln(q_i)$, by comparing the expected, measured, and incoherent probability distributions for a given gate sequence,\n\n$$\n\n\\mathcal{F}_{\\rm{XEB}}= \\frac{S(P_{\\rm incoherent}, P_{\\rm expected}) - S(P_{\\rm measured}, P_{\\rm expected})}{S(P_{\\rm incoherent}, P_{\\rm expected}) - S(P_{\\rm expected})  }\n\n$$\n\nThe numerator is the difference between the measured and expected cross-entropy and the denominator serves as a normalization so that $\\mathcal{F}_{\\rm{XEB}}$ takes a value from [0, 1]. We then use $1-\\mathcal{F}_{\\rm{XEB}}$ as a cost function to optimize the five parameters of our fSim control model. For a given random sequence, we compute the expected probability distribution using perfect single-qubit gate models and the fSim model obtained from our unitary tomography experiment (supplement <ref>). Since, the sequence fidelity is dependent on the single and two-qubit gate models used in the cross-entropy calculation, we can use $1- \\mathcal{F}_{\\rm{XEB}}$ as a cost function to optimize some or all of our fSim gate model parameters, a process termed ex situ optimization.\n\nRB vs XEB\n\n< g r a p h i c s >\n\nComparison of Clifford-based randomized benchmarking (RB) and cross-entropy benchmarking (XEB). a, Single-qubit Clifford based randomized benchmarking measuring average Pauli errors of 0.09\n\nAs a sanity check, one may ask that we compare the result of Clifford based randomized benchmarking (RB) and cross-entropy benchmarking (XEB). Clifford based RB requires an inversion gate, inverting a random gate sequence to map the total ideal gate sequence starting in the $\\ket{0}$ state back to $\\ket{0}$. For most of the fSim gates, the inversion gate is non-trivial, but, for the special case of a $\\rm CZ_{\\phi} = fSim(0^{\\circ}, 180^{\\circ})$, which is part of the Clifford gate set, this comparison is possible.\n\nIn Figure (Figure fig:rb_vs_XEB)a we perform single-qubit Clifford based randomized benchmarking (gate sequence inset), extracting average single-qubit Pauli errors $e_{p,q1} = 0.7 \\times 10^{-3}$ and $e_{p,q2} = 0.9 \\times 10^{-3}$. In Figure (Figure fig:rb_vs_XEB)b we perform two-qubit Clifford based randomized benchmarking with and without an interleaved $\\rm CZ_{\\phi}$ gate (sequences inset), extracting a Pauli error per $\\rm CZ_{\\phi}$ of $4.1 \\times 10^{-3}$. Then, in Figure (Figure fig:rb_vs_XEB)c we use XEB to measure the per cycle error of the $\\rm CZ_{\\phi}$ + two single-qubit gates obtaining $e_{p,\\rm{cycle}} = 5.7 \\times 10^{-3}$.  If we then sum the Clifford based errors for each SQ gate and the $\\rm CZ_{\\phi}$ $(0.7 + 0.9 + 4.1) \\times 10^{-3} = 5.7 \\times 10^{-3}$ we find good agreement with the XEB error per cycle $e_{p,\\rm{cycle}} = 5.9 \\times 10^{-3}$.\n\nError budgeting\n\nIn this section, we use various techniques to provide a more thorough budget of our XEB per cycle errors. As we have discussed, XEB measures the total error per cycle, $e_{p,\\rm{cycle}}$. This includes coherent and incoherent errors for one single-qubit gate per qubit and one fSim gate. We use single-qubit Clifford-based randomized benchmarking to characterize the average total error for single-qubit gates, we use purity benchmarking to characterize incoherent error of both the single-qubit and fSim gates, and we use $\\ket{2}$ state readout in conjunction with XEB to characterize per cycle leakage (which is included in the incoherent error). Here we focus on the two-qubit gate errors by assuming purity-limited single-qubit Pauli gate errors of $7.5 \\times 10^{-4}$ as described in supplement <ref>\u2014this effectively means we subtract $1.5 \\times 10^{-3}$ from $e_{p,\\rm{cycle}}$ to obtain $e_{p,\\rm{2q}}$ for both error and purity measurements..\n\n< g r a p h i c s >\n\nComparison of purity benchmarking and cross-entropy benchmarking with and without a constrained ex situ optimization of the fSim control angles. a, Purity benchmarking. b, XEB error per gate using the fSim gate model obtained from unitary tomography (supplement <ref>). c. XEB error after a constrained ex situ optimization of the fSim gate parameters where $\\theta$ and $\\phi$ were held fixed to the grid and the single-qubit phases were optimized.\n\nIn Figure (Figure fig:purity_exsitu)a we perform Purity benchmarking for each XEB gate sequence and obtain an average Purity of $3.76 \\times 10^{-3}$ per fSim gate. In Figure (Figure fig:purity_exsitu)b we plot $e_{p,\\rm{2q,unitary\\_tomography}}$, the Pauli error per fSim gate using the fSim gate model obtained from unitary tomography. The average $e_{p,\\rm{2q,unitary\\_tomography}}$ is $5.07 \\times 10^{-3}$ indicating a coherent error of $1.31 \\times 10^{-3}$ per fSim. In Figure (Figure fig:purity_exsitu)c we perform ex situ optimization of our fSim gate model to reduce the coherent error by changing the three single-qubit detuning model parameters. We hold the values of $\\theta$ and $\\phi$ fixed to the sampling grid, but allow the single-qubit phases in the fSim model to be optimized. With this improved gate model coherent error is nearly eliminated. The average error $e_{p,\\rm{2q,ex\\,situ}}$ is $3.83 \\times 10^{-3}$ reducing the average coherent error to $7 \\times 10^{-5}$ per gate.\n\n< g r a p h i c s >\n\nPlot of leakage and total XEB error per cycle for a 13 ns CPHASE gate as a function of the coupler bias. The increment on the x-axis is twice the minimum increment of our DAC ($2/2^{14}$, e.g. a 14-bit bipolar DAC $\\approx 0.0002$). In this case we find that leakage reaches a minimum of $5-6\\times 10^{-4}$ for a range of coupler amplitudes approximately $10x$ our minimum DAC adjustment.\n\nWe characterize leakage by directly measuring the $\\ket{2}$ state population as a function of the XEB sequence depth. In Figure (Figure fig:leakage) we perform this measurement for a line cut of fSim control pulses that sweep the coupler bias on either side of the low-leakage bias used to perform a CPHASE gate. We find leakage to be minimized to a value of $5-6 \\times 10^{-4}$ for a range of coupler biases spanning nearly 10 \u201cclicks\u201d of our 13-bit bipolar DAC ($2/2^{13} \\approx 0.0002$).\n\nIn total, these metrics indicate that we have achieved incoherent-error-limited gates with fairly low leakage (if necessary, leakage may be reduced further by optimizing the gate length). Additionally, we find that we are able to perform the desired $\\rm fSim(\\theta, \\phi)$ gate we want without incurring additional coherent error. A critical component in achieving these results was eliminating the non-gate-like behaviors induced by long settling tails on our flux bias pulses. As such, we will now detail the procedure used to calibrate our flux control pulses.\n\nUnitary overlap\n\nThe unitary overlap of two unitary matrices, e.g. some target fSim, $U_{\\rm{target}}$, and the actual fSim, $U_{\\rm{actual}}$, is defined as $Tr(U_{\\rm{target}}\\cdot U_{\\rm{actual}})/D$, where $D$ is the dimension of the Hilbert space. The unitary overlap is related to the Pauli error, $e_p = 1-(Tr(U_{\\rm{target}}\\cdot U_{\\rm{actual}})/D)^2$. The Pauli error in an fSim gate for small deviations in either $\\theta$ or $\\phi$ is proportional to the square of the deviation angle. In Figure (Figure fig:unitary_overlap) we plot the additional coherent error incurred if you assume some actual $\\rm fSim_{actual} = fSim(\\theta + \\delta \\theta, \\phi + \\delta \\phi)$ is instead some target $\\rm fSim_{target} = fSim(\\theta, \\phi)$. This plot indicated that a deviation of either $2.5^{\\circ}$ in $\\theta$ or $4^{\\circ}$ in $\\phi$ with result in an additional coherent error of $1 \\times 10^{-3}$. In our case (Figure (Figure fig:purity_exsitu)), after a constrained optimization where $\\theta$ and $\\phi$ were fixed to a grid, our average error was approximately $1 \\times 10^{-4}$ higher than the purity limit which corresponds to a deviation of about $1^{\\circ}$ in either $\\theta$ or $\\phi$.\n\n< g r a p h i c s >\n\nWe may choose to interpret some $\\rm fSim_{actual}  = fSim(\\theta + \\delta \\theta, \\phi + \\delta \\phi)$ as some $\\rm fSim_{target} = fSim(\\theta, \\phi)$, by accepting additional coherent error. For small deviations in either $\\theta$ or $\\phi$ the error is proportional to the square of the deviation.\n\nCONTROL PULSE CALIBRATION\n\nIn a world without flux settling tails, we would be able to implement an arbitrary fSim gate with a fidelity that is the sum of the requisite CPHASE and iSWAP-like gates by just merging the control pulses into a composite fSim gate. Unfortunately, due to flux settling tails, further calibration, described in <ref>, was required. The keystones of this calibration were two-fold: 1) When performing two flux control based gates back to back (e.g. 2 ns separation), adjust the amplitude of the second pulse based on the first. 2)When implementing a composite gate, perform a CPHASE gate followed by the iSWAP-like gate so that bleed through is well behaved; in the reverse order, bleed through of the iSWAP-like coupler pulse into the CPHASE gate pulses will result in leakage to the $\\ket{2}$ state which is an error in the fSim model. Using these two principles, we were able to implement a robust calibration of the complete fSim gate set.\n\nAs we have demonstrated numerically in supplement <ref>, our desired implementation of the fSim gate set is possible with less than 1\n\nWe can consider settling non-idealities at two time scales: 1) pulse distortion during the duration of a gate (roughly 15 ns), and 2) pulse settling that occurs after the intended gate duration. Distortion at short times may, for instance, make it difficult to place the qubits exactly on resonance during a gate\u2014this may make it difficult to achieve a swap angle, $\\theta$, of $90^{\\circ}$ swap amplitude (Rabi oscillation amplitude $= g^2/(g^2 + \\pi \\Delta^2/2) = 1$ if and only if the qubits are on resonance), but fortunately these distortions do not have a huge impact on the rest of the fSim parameter space. Due to the periodic nature of Rabi oscillations the resulting fSim is mostly dependent on the integral of the control pulses. Pulse settling that occurs outside the intended gate interval means that adjacent gates will bleed in to each other. If the tails are relatively short (a few ns), it is possible to mitigate this error just by placing a short idle time between gates. Pulse settling at longer times is particularly nefarious because it becomes no longer feasible to pad gates with idle times and setting times of 5-1000+ ns have been observed in superconducting qubit systems. If left uncompensated, the performance of the $m^{th}$ 15 ns long gate would be dependent on the preceding 1-60+ gates. This runs contrary to the entire notion of gate-based local operations and certainly would not fit within our static fSim control model used with XEB. As such, it is this long-time settling in particular that requires a careful calibration to enable the sensible control strategy employed throughout this letter.\n\nThe full fSim gate calibration happens in three stages.  In the first stage, we calibrate the electronics to eliminate the long-time settling flux settling. In the second stage, we describe the calibration procedure for the CPHASE and iSWAP-like gate sets. Then, for the fSim gate family, we perform further calibrations of the composite fSim gates to achieve the best possible gate performance by adjusting the control amplitude of the second pulse dependent on the first rather than adding longer buffer times between flux pulses.\n\nElectronics calibration\n\nOn this device there are a total of seven flux bias lines, four for the qubits and three for the couplers.  Each channel is driven by a dedicated 1 GS/s, 14-bit DAC controlled by an FPGA to form an arbitrary waveform generator.  Each line uses nominally identical cabling, attenuation, and filtering from room temperature down to the sample's chip mount. To compensate for non-idealities in each line, we first measure the qubit's response to a flux pulse, fit the response using three exponential decay time constants, and then use this model to pre-distort our control pulses as in previous work [Barends, R.\nand Kelly, J.\nand Megrant, A.\nand Veitia, A.\nand Sank, D.\nand Jeffrey, E.\nand White, T. C.\nand Mutus, J.\nand Fowler, A. G.\nand Campbell, B.\nand Chen, Y.\nand Chen, Z.\nand Chiaro, B.\nand Dunsworth, A.\nand Neill, C.\nand O'Malley, P.\nand Roushan, P.\nand Vainsencher, A.\nand Wenner, J.\nand Korotkov, A. N.\nand Cleland, A. N.\nand Martinis, John M., \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014] [B Foxen, J Y Mutus, E Lucero, E Jeffrey, D Sank, R Barends, K Arya, B Burkett, Yu Chen, Zijun Chen, B Chiaro, A Dunsworth, A Fowler, C Gidney, M Giustina, R Graff, T Huang, J Kelly, P Klimov, A Megrant, O Naaman, M Neeley, C Neill, C Quintana, P Roushan, A Vainsencher, J Wenner, T C White, John M Martinis, \"High speed flux sampling for tunable superconducting qubits with an embedded cryogenic transducer\", 2018]. This allows us to directly measure and compensate for the transfer function of each qubit's flux bias wiring. Implementing a similar in situ calibration of the coupler bias lines is the subject of on-going work. For now, we have found it sufficient to simply apply the average of the two adjacent qubit settling models to the coupler. The pulse calibration parameters for the pair of qubits and the coupler used to benchmark the fSim gate set are summarized in Table (Table table:settling_params).\n\nSummary of the settling parameters for two qubits.  The average of the settling compensation for these two qubits was applied to the coupler.\n\n$\\alpha_1$ (\n$q_2$     -0.46     858     -1.00     104     -4.94     10\n$q_3$     -0.61     996     -0.82     94     -5.97     9\ncoupler (avg $q_2$ & $q_3$)     -0.53     927     -0.91     99     -5.45     10\n\nAfter performing the electronics calibration we find the unitary gate interactions of our fSim gates to be well characterized by either unitary tomography, performed with a depth-1 circuit, or cross-entropy bench-marking using a depth N circuit where N varies from 5 to 700.  This fact is illustrated by Figure (Figure fig:purity_exsitu) panels b and c where the difference in the average error of all 525 fSim gates differs by only $\\rm 1.2 \\times 10^{-3}$ with and without optimizing the single-qubit unitary parameters\u2014this provides an upper bound on the effects of pulse bleed through on gate fidelity. If we consider the gate timing of the cross-entropy benchmarking sequence in Figure (Figure fig:purity_exsitu), which used 28 ns fSim gates interleaved with 15 ns single-qubit gates, this result indicates that our settling is well compensated for at times longer than 15 ns. This result also indicates that the qubit biases are settled enough to have a minimal impact on the single-qubit gate errors.  If this were not the case then we would require a circuit-depth-dependent gate model to reach the purity limit. However, the settling of the coupler bias flux signal at times less than 15 ns becomes non-negligible and merits special consideration when calibrating fSim gates composed of a CPHASE gate in close proximity to an iSWAP-like gate. So, we will first detail the calibration procedure for each of the component gate families in the next section and finish our calibration discussion with a description of composite fSim calibration procedure.\n\nCPHASE and iSWAP-like calibrations\n\n< g r a p h i c s >\n\nCPHASE gate calibration scan. We use the pre-calibrated bias-to-qubit frequency function to choose a desired qubit-qubit detuning and then sweep the amplitude of the coupler bias, $amp_c$ to identify the amplitude that completes a diabatic $\\ket{11} \\leftrightarrow \\ket{02}$ swap indicated by the dotted vertical line.\n\nWe calibrate the CPHASE interaction by repeating the leakage experiment described in Figure (Figure fig:background_scans)a to fine tune the coupler bias amplitudes and to identify combinations of qubit detunings, $\\Delta$, and corresponding coupler bias amplitudes that yield low-leakage gates. We use the qubit frequency bias transfer function to choose qubit biases that set the desired qubit detuning, $\\Delta$ in the vicinity of $\\eta$.  The frequency range around $\\eta$ is set by the width of the Rabi interaction which, for a fixed pulse length, is inversely proportional to gate length since shorter gates require stronger coupling, $g$ (see Figure (Figure fig:sim_length) in supplement <ref>). We use 15 ns pulses (13 ns rectangular pulses with a 1 ns padding on either side) which makes the Rabi interaction span about 75 MHz on either side of the qubit nonlinearity, $\\eta$. For each detuning in this range, we repeat the experiment in Figure (Figure fig:background_scans)a varying the coupling strength to minimize leakage. An example of the raw data from this experiment is provided in Figure (Figure fig:cphase_cal) where the dotted line indicates the low-leakage coupler bias amplitude that achieves one full swap from $\\ket{11}$ to $\\ket{02}$ and back. We initialize the $\\ket{11}$ state, apply the CPHASE control pulses, and measure the $\\ket{1}$ state population of the lower frequency qubit to identify when the population has completed a full swap. Then, for each combination of $\\Delta$ and the corresponding low-leakage coupler bias we repeat the experiment from Figure (Figure fig:background_scans)b to measure the conditional phase. This procedure works well for $\\rm \\phi:[-130^{\\circ},130^{\\circ}]$ until the Rabi swap amplitude becomes small and the peak is broad along the coupling strength line-cut. At that point, we extrapolate towards the zero coupling bias while measuring the conditional phase to fill out the rest of the conditional phase control space.\n\n< g r a p h i c s >\n\niSWAP-like gate calibration for $\\theta = 90^{\\circ}$ performed in three steps. In each experiment we initialize the $\\ket{01}$ state and measure the population of the first qubit to identify the control biases to complete a full swap to $\\ket{10}$ a, We use prior calibrations to bias the qubits on-resonance and scan the coupler bias amplitude, $amp\\_c$, to find the bias that completes one swap. b, Using the new $amp\\_c$, we scan the bias of one qubit, $amp\\_q$, to place them on resonance. c, Using the updated qubit biases, we again scan $amp\\_c$ to find tune the coupler bias.\n\nIn Figure (Figure fig:iswap_like_cal) we calibrate a 13 ns iSWAP-like gate (11 ns rectangular pulses, with 1 ns padding) by repeating the experiment from Figure (Figure fig:background_scans)c three times with the qubits on resonance ($\\rm \\Delta = 0\\,$MHz) to fine-tune the pulse amplitudes needed to reach $\\rm \\theta = 90^{\\circ}$. Then, for $0^{\\circ} < \\theta < 90^{\\circ}$ we simply interpolate the coupler bias between the \u201cOFF\u201d bias and the $\\rm \\theta = 90^{\\circ}$ bias. For each iSWAP-like tune up experiment we initialize one qubit to the $\\ket{1}$ state, apply the iSWAP-like pulses to the qubits and coupler, and then measure the $\\ket{1}$ state population of the other qubit. In Figure (Figure fig:iswap_like_cal)a, we first use our pre-calibrated qubit frequency bias DC transfer functions to choose qubit bias amplitudes, $amp\\_q0$ and $amp\\_q1$, that place both qubits at the same frequency, and we sweep the coupler bias from the \u201cOFF\u201d bias to the maximum coupling bias to identify the amplitude that achieves exactly one a swap from the first to the second qubit corresponding to $\\rm \\theta = 90^{\\circ}$ (dotted line). In Figure (Figure fig:iswap_like_cal)b, we repeat the experiment using the $\\rm \\theta = 90^{\\circ}$ coupler bias from (Figure fig:iswap_like_cal)a while sweeping the bias of one qubit to maximize the amplitude of the swapped population, thus placing the qubits on resonance. Finally, in (Figure fig:iswap_like_cal)c, we repeat the experiment using the new qubit biases to fine-tune the coupler bias.\n\nfSim calibration\n\n< g r a p h i c s >\n\nThree steps to calibrating the fSim gate to account for pulse distortion of the first (CPHASE) pulses bleeding into the second (iSWAP-like) pulses. a, Follow the usual CPHASE calibration procedure to bring-up a full CPHASE gate family corresponding to fSim($\\theta \\approx 0^{\\circ}, \\phi:[0^{\\circ}, 360^{\\circ}]$). b, Follow the iSWAP-like tune up procedure, but play the CPHASE control pulses before the iSWAP-like pulses. Use the sequence to identify the flux bias amplitudes that achieve fSim gates with $\\theta = 0^{\\circ}$ and $\\theta = 90^{\\circ}$ for each proceeding CPHASE gate. c, for a preceding CPHASE gate with $\\phi = 180^{\\circ}$, bring up gates corresponding to fSim($\\theta:[0^{\\circ}, 90^{\\circ}], \\phi = 180^{\\circ}$).\n\nOnce we have calibrated the iSWAP-like and CPHASE gates, we should nominally be able to use one of each to implement any fSim gate.  Unfortunately our pulse response is imperfect at short times, as described in supplement <ref>. This was less of an issue for the iSWAP-like and CPHASE gates in section <ref> because the XEB gate sequence alternated (10 ns) single and (13 ns or 15 ns) two-qubit gates; in those cases, the uncompensated flux bias settling tails resulted in a small detuning at the qubit idle frequencies. However, when we perform an fSim gate as a composition of a CPHASE followed immediately by an iSWAP-like gate, the tail of the first coupler pulse bleeds into the second coupler pulse. Even a small settling tail adding to the amplitude of the coupler pulse can drastically change the coupling during the second gate due to the large coupler flux sensitivity at strong couplings (remembering Figure (Figure fig:coupling)c). In the future, this problem may be mitigated by identifying and removing the physical origin of these settling tails, with a more thorough in situ calibration procedure for the couplers, or by placing longer idle times between gates.\n\nIn this work, we deal with pulse bleed through by calibrating composite fSim gates where the amplitudes of the second set of pulses in the composite fSim sequence is dependent on the first, thus eliminating the need for excessive idle times between gates. Conveniently, the tune up procedure for each gate in the composition is the same as in the isolated iSWAP-like or CPHASE case, just with the two sets of pulses played back-to-back\u2014this works because each experiment in our usual bring-up procedure operates within an isolated manifold (e.g. one excitation for $\\rm \\theta$ or two excitations for $\\rm \\phi$) when performing fSim gates. The ordering of the gates within the fSim gate is chosen to place the CPHASE gate before the iSWAP-like gate. Since both coupler pulses have the same sign, if the CPHASE coupler amplitude bleeds into the iSWAP-like coupler amplitude, this results in slightly more swapping which is easily measured and adjusted for by reducing the iSWAP-like coupler amplitude to compensate. If we ordered the gates in the reverse order, pulse bleed through would generate leakage during the CPHASE gate which is much more difficult to characterize and remove.\n\nFor the purpose of building a robust registry of gates, we erred on the side of over-calibration for this demonstration.  However, we find these control parameters to be well behaved and it should be possible to sample more sparsely in the future to simplify calibration of the full fSim gate set. Figure (Figure fig:fsim_cal_steps) outlines the three steps used to calibrate our composite fSim gates. In Figure (Figure fig:fsim_cal_steps)a, we first calibrate many CPHASE gates spaced every $\\rm 1^{\\circ}$ using control pulses for just the CPHASE gate as shown on the right following the procedure outlined in supplement <ref>. Then, in Figure (Figure fig:fsim_cal_steps)b, for each preceding CPHASE gate we follow the iSWAP-like calibration procedure (also supplement <ref>) to identify qubit and coupler bias amplitudes to achieve both a $\\rm \\theta = 0^{\\circ}$ and $\\rm 90^{\\circ}$ gate. Finally, in Figure (Figure fig:fsim_cal_steps)c, for a CPHASE conditional phase, $\\rm \\phi_{CPHASE} = 180^{\\circ}$ we tune up iSWAP-like gates for $\\rm \\theta$ from $0^{\\circ}$ to $90^{\\circ}$ in $1^{\\circ}$ increments by interpolating between the min and maximum amplitudes determined in (Figure fig:fsim_cal_steps)b. We use this calibration to produce a spline for $\\theta_{\\rm{iSWAP-like}} \\rightarrow{} \\%(bias_{90^{\\circ}}-bias_{0^{\\circ}}$) and another for $\\theta_{\\rm{iSWAP-like}} \\rightarrow{} \\phi_{\\rm{iSWAP-like}}$.\n\nWith the fSim gate registry in hand we set out to benchmark specific fSim gates. For a given target fSim, we first look up the iSWAP-like pulse amplitudes that achieve the correct swap angle $\\theta_{\\rm{iSWAP-like}}$, and subtract the conditional phase due to the iSWAP-like gate from the total target to choose pulse amplitudes for the desired CPHASE gate (e.g. $\\phi_{\\rm{CPHASE}} = \\phi_{\\rm{target}} - \\phi_{\\rm{iSWAP-like}}$). We then performed unitary tomography (supplement <ref>) using the pulse amplitudes we looked up in the registry to quickly assess the resulting fSim control angles of the composite gate. If either control angle is off by more than $1^{\\circ}$, we used the registry to adjust the corresponding iSWAP-like ($\\rm \\theta$) or CPHASE ($\\rm \\phi$) control amplitudes by $\\pm 1^{\\circ}$ accordingly. This process converged to an fSim gate within $1^{\\circ}$ of both $\\theta_{target}$ and $\\phi_{target}$ for the target fSim with fewer than 9 adjustments for each of the 525 fSim gates we benchmarked. Once the unitary tomography experiment indicated the composite fSim gate produced a unitary operation near the target fSim gate, we performed purity and cross-entropy benchmarking.\n\nSYSTEM STABILITY\n\nAs the size of quantum processors grows (number of qubits), so too does the time it takes to calibrate a device (at least until fully parallel calibrations are possible). As the system drifts from these calibrations over time, the performance of a processor will fall and calibrations must be revisited. If the required calibration time is long compared to the scale of drift, then the device becomes unusable in practice. While electronics drift with both time and temperature must be considered when designing a system, one particularly worrisome issue is the time dependence of two level system (TLS) defects entering and leaving the qubit spectrum [Klimov, P. V., Kelly, J., Chen, Z., Neeley, M., Megrant, A., Burkett, B., Barends, R., Arya, K., Chiaro, B., Chen, Yu, Dunsworth, A., Fowler, A., Foxen, B., Gidney, C., Giustina, M., Graff, R., Huang, T., Jeffrey, E., Lucero, Erik, Mutus, J. Y., Naaman, O., Neill, C., Quintana, C., Roushan, P., Sank, Daniel, Vainsencher, A., Wenner, J., White, T. C., Boixo, S., Babbush, R., Smelyanskiy, V. N., Neven, H., Martinis, John M., \"Fluctuations of Energy-Relaxation Times in Superconducting Qubits\", 2018].\n\nHere we present a promising snapshot of the stability of our system. In the process of calibrating the fSim gate set, we started by calibrating the single-qubit gates and readout. We then operated with the same single-qubit calibrations for several days while we were working on the fSim gate ultimately obtaining our primary fSim benchmarking dataset about a week after the initial single-qubit calibration.  Shortly after this, a TLS showed up near one of the qubit's idle frequencies significantly limiting its coherence. Then, after about another week, we returned to the original calibration parameters to benchmark a subset of the same $\\rm fSim(\\theta, \\phi)$ gates presented in the main text. We were pleasantly surprised to find that the original calibration was still good enough to produce high-fidelity gates.\n\n< g r a p h i c s >\n\nSnapshot of system stability. A few days after taking the data in Figure (Figure fig:fidelity), a TLS showed up at one of the qubit idle frequencies effectively breaking the calibration. After about another week, we returned to the original calibration and repeated the fidelity measurement on a subset of 91 fSim gates which we present here (top and middle rows). We find that the average gate fidelity had decreased somewhat, but is still above 99\n\nIn Figure (Figure fig:stability) we used the two-week-old iSWAP-like and CPHASE calibrations to benchmark a less dense grid of fSim gates.  While the average performance has degraded by a factor of two from the initial calibration, the average error is still less than 1\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'Dynamical decoupling and noise spectroscopy'?", "completion": "\n\n0.0cm\n0.2cm\n16cm\n21cm\n1.0cm\n\n# Dynamical decoupling and noise spectroscopy\nwith a superconducting flux qubit\n\nAbstract\n\nThe characterization and mitigation of decoherence in natural and artificial two-level systems (qubits) is fundamental to quantum information science and its applications.\n\nDecoherence of a quantum superposition state arises from the interaction between the constituent system and the uncontrolled degrees of freedom in its environment.\n\nWithin the standard Bloch-Redfield picture of two-level system dynamics, qubit decoherence is characterized by two rates:\na longitudinal relaxation rate $\\Gamma_1$ due to the exchange of energy with the environment, and a transverse relaxation rate $\\Gamma_2 = \\Gamma_1/2 + \\Gamma_\\varphi$ which contains the pure dephasing rate $\\Gamma_\\varphi$.\n\nIrreversible energy relaxation can only be mitigated by reducing the amount of environmental noise, reducing the qubit's internal sensitivity to that noise, or through multi-qubit encoding and error correction protocols (which already presume ultra-low error rates).\nIn contrast, dephasing is in principle reversible and can be refocused dynamically through the application of coherent control pulse methods[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn this work we demonstrate how dynamical-decoupling techniques can moderate the dephasing effects of low-frequency noise on a superconducting qubit[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with energy-relaxation time $T_1 = 1/\\Gamma_1 = 12\\,\\mu$s.\n\nUsing the CPMG sequence[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with up to 200 $\\pi$-pulses, we demonstrate a 50-fold improvement in the transverse relaxation time $T_2$ over its baseline value.\n\nWe observe relaxation-limited times $T_2 ^{\\mathrm{\\,CPMG}} = 23 \\,\\mu \\textrm{s} \\approx 2\\,T_1$ resulting from CPMG-mediated Gaussian pure-dephasing times in apparent excess of $100 \\,\\mu \\textrm{s}$.\n\nWe leverage the filtering property of this sequence in conjunction with Rabi and energy relaxation measurements\nto facilitate the spectroscopy and reconstruction of the environmental noise power spectral density (PSD)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nSeveral multi-pulse sequences developed within the field of nuclear magnetic resonance[Unknown Author, \"Unknown Title\", ] (NMR) have recently been applied to mitigate noise in qubits based on atomic ensembles[Unknown Author, \"Unknown Title\", ], semiconductor quantum dots[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and diamond nitrogen\u2013vacancy centres[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nWe extend these methods to the realm of superconducting quantum devices, and subject a remarkably long-lived qubit to varying levels of longitudinal and transverse noise by rotating the qubit's quantization axis, against which we characterize the baseline coherence rates $\\Gamma_1$, $\\Gamma_2$, and $\\Gamma_\\varphi$.\n\nWe evaluate three dynamical-decoupling pulse protocols: the Carr-Purcell[Unknown Author, \"Unknown Title\", ] (CP); Carr-Purcell-Meiboom-Gill[Unknown Author, \"Unknown Title\", ] (CPMG); and Uhrig dynamical-decoupling[Unknown Author, \"Unknown Title\", ] (UDD) sequences.\n\nThe narrow-band filtering property of the CPMG sequence enables us to sample environmental noise over a broad frequency range 0.2\u201320 MHz, and we observe a $1/f^{\\alpha}$-type spectrum which we independently confirm with a Rabi-spectroscopy approach.\n\nWe furthermore characterize the environmental noise from 5.4 to 21 GHz by monitoring the qubit's relaxation rate[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe device is a persistent-current qubit (Figs.\u00a0(Figure fig:time_domain)a and A1), an aluminium loop interrupted by four Al-AlO$_x$-Al Josephson junctions.\n\nWhen an external magnetic flux $\\Phi$ threading the loop is close to half a superconducting flux quantum $\\Phi_0/2$,\nthe diabatic states correspond to clockwise (counterclockwise) persistent currents $I_\\mathrm{p}=0.18\\,\\mu$A with energies $\\pm \\hbar \\varepsilon/2=\\pm I_\\mathrm{p} \\Phi_{\\mathrm{b}}$, tunable by the flux bias $\\Phi_{\\mathrm{b}}=\\Phi-\\Phi_0/2$.\n\nAt $\\Phi_{\\mathrm{b}}=0$, the degenerate persistent-current states hybridize with a strength $ \\hbar \\Delta = h\\times 5.3662$\u00a0GHz\n(Figs.\u00a0(Figure fig:time_domain)b and A2b), where $\\hbar = h/2 \\pi$ and $h$ is Planck's constant.\n\nThe corresponding two-level Hamiltonian is[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\n$$\n\n\\hat{\\mathcal{H}} = - \\frac{\\hbar}{2} \\left[ (\\varepsilon + \\delta \\varepsilon) \\hat{\\sigma}_{x} + (\\Delta + \\delta \\Delta) \\hat{\\sigma}_{z} \\right],\n\\label{eq:Hamiltonian}\n\n$$\nwhich includes noise fluctuation terms $\\delta \\varepsilon$ and $\\delta \\Delta$, and $\\hat{\\sigma}_{x,z}$ are Pauli operators (Fig.\u00a0A2).\n\nThe ground $\\left( |0\\rangle \\right)$ and excited $\\left( |1\\rangle \\right)$ states have frequency splitting $\\omega_{01} = \\sqrt{\\varepsilon^2+\\Delta^2}$ and are well isolated\nowing to the qubit's large anharmonicity, $\\omega_{12}/\\omega_{01}\\approx5$.\n\nThe environmental noise leading to fluctuations $\\delta \\varepsilon$ (e.g., flux noise) and $\\delta \\Delta$ (e.g., critical current and charge noise) physically couples to the qubit in the $\\varepsilon$ \u2013 $\\Delta$ frame (equation\u00a0<ref>).\n\nHowever, their manifestation as longitudinal noise (dephasing) or transverse noise (energy relaxation) is tunable[Unknown Author, \"Unknown Title\", ] by the flux bias $\\Phi_{\\mathrm{b}}$ and determined, respectively, by their projections $\\delta \\omega_{z'}$ onto the qubit's quantization axis $\\hat{\\sigma}_{z'}$ (which makes an angle $\\theta=\\arctan(\\varepsilon/\\Delta)$ with $\\hat{\\sigma}_{z}$) and $\\delta \\omega_{\\perp '}$ onto the plane perpendicular to $\\hat{\\sigma}_{z'}$.\n\nThe chip is mounted in a $^3\\textrm{He}/^4\\textrm{He}$ dilution refrigerator with 12-mK base temperature.\n\nFor each experimental trial, we initialize the qubit by waiting sufficient time ($\\sim\\!1$\u00a0ms) for it to relax to its ground state.\n\nWe drive the desired quantum-state rotations of angle $\\Theta$ by applying calibrated in-phase ($X_{\\Theta}$) and quadrature ($Y_{\\Theta}$) harmonic flux pulses to the qubit loop.\nThe pulses comprise Gaussian envelopes with a typical standard deviation $\\sigma=1.2$ ns and truncated at $\\pm3\\sigma$.\n\nThe qubit readout has 79\n\n(see Appendix).\n\nWe begin with a spectroscopic characterization of our device and its baseline coherence times.\n\nThe qubit level splitting $\\omega_{01}$ is measured via saturated frequency spectroscopy (Fig.\u00a0(Figure fig:time_domain)b), and at low-power it exhibits a Lorentzian full-width-at-half-maximum (FWHM) linewidth $\\Delta f_\\mathrm{(FWHM)} = 0.18$ MHz at $\\Phi_{\\mathrm{b}}=0$ (Fig.\u00a0(Figure fig:time_domain)c).\n\nThe energy relaxation is generally exponential and its time constant $T_1=12\\pm1\\,\\mu$s (Fig.\u00a0(Figure fig:time_domain)d) is remarkably long among superconducting qubits[Unknown Author, \"Unknown Title\", ],\na feature we leverage in this work in conjunction with quantization axis tunability.\n\nWe observe similarly long decay times at $\\Phi_{\\mathrm{b}}=0$ for the Hahn spin-echo, $T_{2,\\mathrm{E}}=23\\,\\mu$s (Fig.\u00a0(Figure fig:time_domain)d), Ramsey free induction, $T_2^{^*}=2.5\\,\\mu$s (Fig.\u00a0(Figure fig:time_domain)e), and Rabi oscillations, $T_\\mathrm{R}=13\\,\\mu$s (Fig.\u00a0(Figure fig:time_domain)f).\n\nAlthough the spin echo and Rabi exhibit an apparently exponential decay at $\\Phi_{\\mathrm{b}}=0$ (they are essentially $T_1$-limited at this flux bias), in general, their decay functions are non-exponential.\n\nFurthermore, the dephasing times decrease (rates increase) dramatically away from $\\Phi_{\\mathrm{b}}=0$ (Figs.\u00a0(Figure fig:cpmg)c and\u00a0(Figure fig:Rabi_with_Sim)b) due to the qubit's increased sensitivity to the dominant $\\delta \\varepsilon$-noise (flux noise) in this system[Unknown Author, \"Unknown Title\", ] (increased $|\\partial\\omega_{01}/\\partial\\varepsilon|$), which, as we will demonstrate, can be mitigated with multi-pulse dynamical-decoupling sequences to push coherence times up towards the $T_1$-limit.\n\n< g r a p h i c s >\n\nQubit device and characterization.\na, Device and biasing schematic: An aluminium superconducting loop interrupted by Josephson junctions (crosses) with a read-out dc SQUID.\n\nb, Frequency spectroscopy of the qubit's $|0\\rangle\\to|1\\rangle$ transition.\n\nc, Spectroscopy at $\\Phi_\\mathrm{b}=0$ (arrow in b).\n\nd, Echo decay (blue triangles) and relaxation from the excited state (black dots) at $\\Phi_\\mathrm{b}=0$.\n\nIn the insets, $\\tau$ is a time delay and $X_\\Theta$ symbolizes a rotation of the Bloch vector by the angle $\\Theta$ around the axis $\\hat{\\sigma}_x$.\nThe red squares indicate the time of read out.\n\ne, Free-induction decay (Ramsey fringe) at $\\Phi_\\mathrm{b}=0$.\n\nf, Rabi oscillations at $\\Phi_\\mathrm{b}=0$.\n\nDecoherence in superconducting qubits has been studied theoretically[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and experi\u00admen\u00adtally[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nEach noise source $\\lambda$ is characterized by its PSD,\nwhich quantifies the frequency distribution of the noise power, $S_\\lambda(\\omega) = (1/2\\pi) \\int_{-\\infty}^\\infty \\mathrm{d}t \\, \\langle \\lambda(0)\\lambda(t) \\rangle \\exp(-i\\omega t)$.\n\nIn contrast to a simple Bloch-Redfield picture, which presumes weakly coupled noise sources with short correlation times $\\tau_{\\mathrm{c}} \\ll T_1,T_2$ resulting in purely exponential decay functions,\nmore generally the decay functions are non-exponential for noise sources with long correlation times, singular near $\\omega \\approx 0$ (e.g., $1/f$-type noise at low frequencies, relevant to dephasing).\n\nA superposition state's accumulated phase $\\varphi(t) = \\langle\\omega_{01}\\rangle t + \\delta\\varphi(t)$\ndiffuses due to adiabatic fluctuations of the transition frequency, $\\delta\\varphi(t) = (\\partial\\omega_{01}/\\partial\\lambda) \\int_0^t \\mathrm{d}t'\\delta\\lambda(t')$.\n\nFor noise generated by a large number of fluctuators that are weakly coupled to the qubit, its statistics are Gaussian.\nEnsemble averaging over all realizations of the stochastic process $\\delta\\lambda(t)$, and taking the sources $\\lambda$ to be independent, the dephasing is\n$\\langle \\exp[i\\,\\delta\\varphi(t)] \\rangle \\equiv \\exp[-\\chi_N(t)]$, with the coherence integral\n\n$$\n\\label{eq:chi}\n\\chi_N(\\tau) = \\tau^2 \\sum_{\\lambda} \\left(\\frac{\\partial\\omega_{01}}{\\partial\\lambda}\\right)^2 \\int_0^\\infty \\mathrm{d}\\omega \\, S_\\lambda(\\omega) \\, g_N(\\omega,\\tau) ,\n\n$$\n\nwhere $\\tau$ is the free evolution time and $N$ will denote the number of $\\pi$ pulses in the pulse sequences[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nEquation\u00a0(<ref>) expresses that the PSD $S_\\lambda(\\omega)$ is filtered by a dimensionless weighting function $g_N$ determined by the pulse sequence,\nand the aggregated $\\lambda$-noise translates to\ndephasing through $\\partial\\omega_{01} / \\partial\\lambda$, the qubit's longitudinal sensitivity to $\\lambda$-noise.\n\nFor Gaussian noise with spectral distribution $S_{\\lambda}(\\omega) = A_{\\lambda}/\\omega$ at low frequencies, the coherence integral results in a Gaussian decay function, $\\chi_N(\\tau) = (\\Gamma_{\\varphi} \\tau)^2$.\n\nThe Ramsey free-induction and Hahn spin-echo dependence on flux bias (Fig.\u00a0(Figure fig:cpmg)c) are both apparently consistent with Gaussian distributed, $1/f$-type noise.\n\nRamsey free induction, the free evolution of a superposition state for a time $\\tau$ (Fig.\u00a0(Figure fig:cpmg)a with no $\\pi$ pulses), has a filter function $g_0$\n\nc, Decay rates (inverse of $1/e$ times) vs. flux detuning:\nFree induction (green squares) and CPMG (coloured dots) with $N=1,2,4,6,8,10,16,20,24,30,36,42,48$. Solid lines are calculations using equation\u00a0(<ref>) with parameters in Table 1.\n\nd\u2013g, Measurements at $\\Phi_\\mathrm{b}=-0.4\\,\\mathrm{m}\\Phi_0$  ($\\varepsilon/2\\pi=430$ MHz).\n\nd, $1/e$ decay time under $N$-pulse CPMG, CP, and UDD sequences. The simulation (red line) assumes perfect pulses.\n\ne, Population decay under an 84-pulse CPMG sequence.\nGaussian fit with fixed exponential decay contributions\n$T_1=12\\,\\mu$s, $T_\\mathrm{p}=1.75\\,\\mu$s.\n\nf, Phase decay of the signal in e after dividing out $T_1$ and $T_\\mathrm{p}$.\n\ng, Noise PSD calculated from the data in f.\n\nNumerical simulations (see Appendix), including the measured $T_1$ decay at each $\\Phi_{\\mathrm{b}}$, linearly coupled and uncorrelated quasi-static noises, and uncorrelated dynamic $1/f$ noise from $10^4$ to $10^{10}$  Hz, reproduce the entire $\\Phi_{\\mathrm{b}}$-dependence of $T_2^{^*}$ and $T_{2,\\mathrm{E}}$ using the parameters in Table\u00a01 and are also consistent with equation\u00a0(<ref>).\n\nIn order to mitigate higher-frequency noise than what the Hahn spin-echo can efficiently refocus, we further shape the filter function by applying additional $\\pi$-pulses (Figs.\u00a0(Figure fig:cpmg)a and A5).\n\nThe filter $g_N(\\omega,\\tau)$ depends on the number $N$ and distribution of $\\pi$-pulses[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\nduring the total sequence length $\\tau$,\n\n$$\n%\\label{eq:filter_def} %Note, same label in appendix\ng_N(\\omega,\\tau) =\n\\frac{1}{(\\omega\\tau)^2} \\, \\Big| 1+(-1)^{1+N}\\exp(i\\omega\\tau) + 2\\sum_{j=1}^{N} (-1)^j \\exp(i\\omega\\delta_j\\tau) \\cos(\\omega\\tau_\\pi/2) \\Big|^2 ,\n%   g=\\frac{|y_N(\\omega,\\tau)|^2}{(\\omega\\tau)^2},\n\n$$\n\nwhere $\\delta_j \\in [0,1]$ is the normalized position of the centre of the $j$th $\\pi$-pulse between the two $\\pi/2$-pulses, and $\\tau_\\pi$ is the length of each $\\pi$-pulse.\n\nAs the number of pulses increases for fixed $\\tau$, the filter function's peak shifts to higher frequencies (Fig.\u00a0(Figure fig:cpmg)b), leading to a reduction in the net integrated noise (equation\u00a0<ref>) for $1/f^{\\alpha}$-type noise spectra with $\\alpha > 0$.\n\nAlternatively, for a fixed time separation $\\tau' = \\tau/N$ (valid for $N \\ge 1$), the filter asymptotically peaks near $\\omega' = 2\\pi/4\\tau'$ as more pulses are added.\n\nIn principle, one can adapt the filter function to suit a particular noise spectrum via the choice of dynamical-decoupling protocol.\n\nWe have evaluated three different dynamical-decoupling protocols relevant for $1/f$-type power law noise spectra[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe CP and CPMG sequences[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] are multi-pulse extensions of the Hahn echo with equally spaced $\\pi$-pulses whose phases differ from the initial $\\pi/2$ pulse by $0^\\circ$ ($X_\\pi$) and $90^\\circ$ ($Y_\\pi$), respectively (Fig.\u00a0(Figure fig:cpmg)a).\n\nThe UDD sequence[Unknown Author, \"Unknown Title\", ]\nhas $Y_\\pi$-pulse positions defined by\n\n$\\delta_j = \\sin^2 \\left( \\frac{\\pi j}{2N+2} \\right)$.\n\nIn Fig.\u00a0(Figure fig:cpmg)c, we include the $1/T_e$ decay rates for CPMG dynamical-decoupling sequences with $N=2 \\ldots 48$ $\\pi$-pulses along with the Ramsey ($N=0$ ) and Hahn echo ($N=1$) already discussed.\n\nThe decay rates monotonically improve towards the $1/2T_1$-limit as the number of $\\pi$-pulses increases, extending the range around $\\Phi_{\\mathrm{b}}=0$ for which dephasing is negligible.\n\nOutside this range, as the qubit's sensitivity to $\\delta \\varepsilon$ (flux) noise grows with increasing $|\\Phi_\\mathrm{b}|$, increasing the number of $\\pi$-pulses mitigates the noise sufficiently well to achieve a desired decay rate.\n\nAt a specific flux bias $\\Phi_{\\mathrm{b}} = 0.4 \\; \\textrm{m}\\Phi_0$, where the qubit is highly sensitive to $\\delta \\varepsilon$ noise, the CPMG sequence gives a marked improvement in the decay time $T_e$ up to $N\\approx 200$ $\\pi$-pulses (Fig.\u00a0(Figure fig:cpmg)d), beyond which pulse errors begin to limit the CPMG efficiency.\n\nWe achieve a 50-fold enhancement of $T_2^\\mathrm{\\,CPMG}$ over the Ramsey $T_2^{^*}$ (Fig.\u00a0(Figure fig:cpmg)d), and well over 100-fold improvement in the Gaussian pure dephasing time $T_{\\varphi}$.\n\nThe CPMG sequence performs about 5\n\nand it dramatically outperforms CP, as $Y_\\pi$-pulse errors appear only to fourth order with CPMG, whereas with CP, $X_\\pi$ errors accumulate to second order[Unknown Author, \"Unknown Title\", ].\n\nWe use the filtering property of the CPMG sequence to characterize the $\\delta \\varepsilon$-noise spectrum.\n\nThe filter $g_N(\\omega,\\tau)$ is sufficiently narrow about $\\omega'$ that we can treat the noise as constant within its bandwidth $B$ and approximate equation\u00a0(<ref>) as\n\n$\\chi_N(\\tau) \\approx \\tau^2 \\, (\\partial\\omega_{01}/\\partial\\Phi)^2 \\, S_\\varepsilon(\\omega') \\, g_N(\\omega' ,\\tau') \\, B$ (Fig.\u00a0A6).\n\nWe compute $\\omega'$ and $B$ numerically for each $N$ and $\\tau$ used in the CPMG measurements of Fig.\u00a0(Figure fig:cpmg)d.\n\nThe measured decay function contains three decay rates:\n\ndephasing $\\Gamma_\\varphi^{(N)}$ and exponential relaxation $\\Gamma_1/2$ during the total free-evolution time $\\tau$,\nand pulse-induced decay $\\Gamma_\\mathrm{p}$ during $N\\tau_\\pi$ (we assume $\\Gamma_\\mathrm{p}$ to be independent of $N$).\n\nConceptually, Figs.\u00a0(Figure fig:cpmg)e\u2013g illustrate for $N=84$ how we divide out the $\\Gamma_1$ and $\\Gamma_\\mathrm{p}$ (assuming exponential pulse-induced decay) components from the raw data (e) to obtain the Gaussian phase decay (f), and then compute $S_\\varepsilon(\\omega)$ (g).\n\nMore rigorously, we only use that method to determine a starting point at a single frequency, and then use a recursive method to obtain the remainder of the spectrum without presuming a functional form for the pulse-induced decay, the dephasing, or the noise spectrum (see Appendix).\n\nBoth approaches yield nearly identical $1/f^{\\alpha}$-type spectra with a slight increase in the measured PSD above 2 MHz;\n\nwe plot the recursively extracted PSD $S_{\\varepsilon}(\\omega)$ over the region 0.2\u201320 MHz in Fig.\u00a0(Figure fig:psd).\n\nInterestingly, the PSD estimated in this manner is better approximated by a $1/f^{\\alpha}$ power law[Unknown Author, \"Unknown Title\", ] with $\\alpha = 0.9 < 1$ (solid, red line) with noise amplitude $A_\\Phi = (0.8\\,\\mu\\Phi_0)^2$, obtained by fitting the lower-frequency, linear portion of the PSD.\n\nProjecting this line to higher frequencies comes within a factor 2 of the transverse noise at frequency $\\Delta$ as extracted from the relaxation measurements described below.\n\nWe confirmed the spectrum over a similar frequency range by analyzing the decoherence during driven evolution,\nwhich provides an independent means to rotate the quantization axis with respect to the noise sources when viewed in the rotating frame[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nA transverse driving field at frequency $\\omega$ results in Rabi oscillations with angular frequency\n\n$\\Omega_\\mathrm{R} = \\sqrt{\\Omega^2 + (\\Delta\\omega)^2} \\approx \\Omega + (\\Delta\\omega)^2/2\\Omega$,\n\nwhere $\\Delta\\omega = \\omega - \\omega_{01}$.\n\nIntegrating the oscillations over a normal distribution with variance $\\sigma_\\varepsilon^2$, we obtain the quasi-static decay function $\\zeta(\\tau) = \\left(1 + (u \\tau)^2 \\right)^{-1/4}$,\nwhere\n$u = (\\varepsilon/\\omega_{01})^2 \\, \\sigma_\\varepsilon^2/\\Omega$.\n\nAlong with $\\Gamma_1$, the noise at the Rabi frequency $\\Gamma_\\Omega^{(\\lambda)} = \\pi S_{\\lambda}(\\Omega_\\mathrm{R})$ comprises the usual exponential Rabi-decay rate\n\n$$\n\\label{eq:Gamma_R_simplified}\n\\Gamma_\\mathrm{R} = \\left( \\frac{3}{4}\\Gamma_1 + \\frac{1}{2}\\Gamma_\\Omega^{(\\Delta)} \\right) \\cos^2\\theta + \\left(\\frac{\\varepsilon}{\\omega_{01}}\\right)^2 \\, \\frac{1}{2}\\Gamma_\\Omega^{(\\varepsilon)} ,\n\n$$\n\nwhere $\\cos^2\\theta\\!\\approx\\!1$ as the quantization angle is small.\n\nThe combined decay function is $\\zeta(\\tau) \\exp \\left( -\\Gamma_{\\mathrm{R}} \\tau\\right)$   (Fig.\u00a0(Figure fig:Rabi_with_Sim)a; see also Appendix).\n\n< g r a p h i c s >\n\nDecoherence during driven dynamics.\na, Rabi oscillations with $\\Omega_\\mathrm{R}/2\\pi=2$ MHz at $\\varepsilon/2\\pi=225$ MHz.\nThe red line envelope is a fitting using $\\zeta(t)$ and $\\Gamma_\\mathrm{R}$.\nThe black line shows the $\\Gamma_\\mathrm{R}$ decay only, and the green line the $\\zeta(t)$-envelope contribution.\n\nb, Rabi-decay rate $\\Gamma_\\mathrm{R}$ vs. flux detuning at $\\Omega_\\mathrm{R}/2\\pi=2$ MHz, with a parabolic fit to equation\u00a0(<ref>)\nused to obtain $S_\\varepsilon(\\Omega_\\mathrm{R})=\\frac{1}{\\pi}\\,\\Gamma_\\Omega^{(\\varepsilon)}$.\n\nTo determine $S_\\lambda(\\Omega_\\mathrm{R})$, we measured the Rabi oscillations vs. $\\Phi_{\\mathrm{b}}$ with fixed Rabi frequency $\\Omega_\\mathrm{R}$.\n\nFor each $\\Omega_\\mathrm{R}$, we find the $\\varepsilon$-independent part of the rate by fitting the envelope of the oscillations at $\\varepsilon=0$.\n\nThe rate $\\Gamma_\\Omega^{(\\Delta)}$ was too small to distinguish accurately from $\\Gamma_1$, consistent with its correspondingly small quasi-static noise $\\sigma_{\\Delta}^2$ (Table\u00a01).\n\nThen, for $\\varepsilon \\neq 0$, we divide out the known quasi-static contribution $\\zeta(\\tau)$ and fit to the parabolic term in equation\u00a0(<ref>), from which we obtain\n$\\Gamma_\\Omega^{(\\varepsilon)}$ (Fig.\u00a0(Figure fig:Rabi_with_Sim)b).\n\nUsing this approach, we find $S_\\varepsilon(\\Omega)$ to be consistent with the $1/f^{\\alpha}$ noise obtained from the CPMG measurements (Fig.\u00a0(Figure fig:psd)).\n\nQuasi-static noise parameters used in simulations, and coherence times.\n\nNoise parameters     $\\sigma_{\\lambda}/2\\pi$     $\\omega^\\lambda_{\\mathrm{ir}}/2\\pi$     $\\omega^\\lambda_{\\mathrm{uv}}/2\\pi$     $A_{\\lambda}$\n\n$\\lambda = \\varepsilon \\,\\,\\mathrm{(equiv.} \\,\\,\\Phi\\, \\mathrm{noise)}$          $10\\,\\mathrm{MHz}$      $1\\,\\mathrm{Hz}$     $1\\,\\mathrm{MHz}$       $(1.7 \\times 10^{-6})^2 \\; \\Phi_0^2$\n\n$\\lambda = \\Delta \\,\\,\\mathrm{(equiv.} \\,\\,I/I_\\mathrm{c}\\, \\mathrm{noise)}$     $0.06\\,\\mathrm{MHz}$      $1\\,\\mathrm{Hz}$     $< 0.1\\,\\mathrm{MHz}$     $(4.0 \\times 10^{-6})^2$\n\nCoherence times     $T_1$     $T_2^{^*}$     $T_2^{\\mathrm{\\,CPMG}}$     $T_2^{\\mathrm{\\,CPMG}}$ / $T_2^{^*}$\n\n$\\Phi_{\\mathrm{b}} = 0   \\; \\textrm{m} \\Phi_0$     $12 \\; \\mu \\textrm{s}$     $2.5 \\; \\mu \\textrm{s}$     $23 \\; \\mu \\textrm{s}$ ($N=1$)       $9$\n\n$\\Phi_{\\mathrm{b}} = 0.4 \\; \\textrm{m} \\Phi_0$     $12 \\; \\mu \\textrm{s}$     $0.27 \\; \\mu \\textrm{s}$     $13 \\; \\mu \\textrm{s}$ ($N=200$)      $48$\n\nIn Ramsey-fringe and Hahn-echo simulations, we describe the Gaussian noise distributions by their standard deviations, $\\sigma_\\lambda$, obtained by integrating the $1/f$ noises over the bandwidth given by the experimental protocol (cut-off frequencies $\\omega^{\\,\\lambda}_\\mathrm{ir}$ and $\\omega^{\\,\\varepsilon}_\\mathrm{uv}$, see text).\n\nAt $\\varepsilon=0$, the dephasing improvement under a Hahn echo is greater than the theory would suggest for $\\delta\\Delta$ $1/f$ noise that extends to high frequencies; the lower $\\omega^{\\,\\Delta}_\\mathrm{uv}$ gives consistency (see Appendix).\n\nThe equivalent flux and normalized critical-current noise amplitudes, $A_{\\lambda}$, are values derived from the Ramsey and echo data assuming a power law $1/f^{\\alpha}$ with $\\alpha=1$ and that all noise in $\\varepsilon$ and $\\Delta$ is flux and critical-current noise, respectively; they are consistent with previously reported values[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nUsing these parameters in simulations yielded agreement with $N$-pulse dynamical-decoupling data, consistent with equation\u00a0(<ref>).\n\nThe coherence times are given at two bias points dominated by $\\delta\\Delta$ and $\\delta\\varepsilon$ noise, respectively.\n\nWe now turn to transverse noise, i.e. $\\delta \\varepsilon$-noise at $\\varepsilon=0$, and $\\delta \\Delta$-noise at $\\varepsilon\\gg\\Delta$ (Fig.\u00a0(Figure fig:psd), inset), at the qubit frequency $\\omega_{01}$ responsible for energy relaxation $\\Gamma_1$.\n\nIn the low-temperature limit, $k_\\mathrm{B}T\\ll\\hbar\\omega_{01}$, where the environment cannot excite the qubit, the golden-rule expression for $\\Gamma_1$ in a weakly damped quantum two-level system is\n\n$$\n\\label{eq:Gamma1}\n\\Gamma_1 = \\frac{\\pi}{2} \\sum_{\\lambda \\in \\delta \\varepsilon,\\delta \\Delta}\n\\left( \\frac{\\partial\\omega_{\\perp'}}{\\partial\\lambda} \\right)^2 S_\\lambda(\\omega_{01}) = \\frac{\\pi}{2} S(\\omega_{01}),\n\n$$\n\nwith $\\partial\\omega_{\\perp'}/ \\partial\\lambda$ the qubit's sensitivity to transverse noise and $S(\\omega_{01})$ the total PSD (see Appendix).\n\nWe apply a long ($\\gg T_1$) microwave pulse to saturate the transition and monitor the energy decay to the ground state, using equation\u00a0(<ref>) to determine $S(\\omega_{01})$ over the frequency range $\\Delta \\leq \\omega_{01} \\leq 2\\pi\\times21$\u00a0GHz by tuning $\\Phi_{\\mathrm{b}}$.\n\nAt $\\Phi_\\mathrm{b}=0$ ($\\omega_{01} = \\Delta$) and using a measurement-repetition period $t_\\mathrm{rep}>1\\,$ms, we observe $T_1=12 \\pm 1\\,\\mu$s as shown in Fig\u00a0(Figure fig:time_domain)d.\n\nAs $t_\\mathrm{rep}$ becomes shorter than 1 ms, the decay becomes increasingly non-exponential, which we attribute to the residual presence of non-equilibrium quasiparticles generated by the switching SQUID during readout.\n\nWe observe structure in the $\\Gamma_1$ data due to environmental modes (e.g. cavity modes, impedance resonances) with uncontrolled couplings to the qubit (Fig.\u00a0(Figure fig:psd)).\n\nFor comparison, we plot the expected Johnson-Nyquist flux noise in Fig.\u00a0(Figure fig:psd) due to the $R = 1/G = 50\\,\\Omega$ environment mutually coupled with strength $M=0.02$\u00a0pH to the qubit via the microwave line,\n$$\n%\\label{eq:J-N_flux} Note, same label in appendix\nS^\\mathrm{JN}_\\varepsilon(\\omega) =  \\frac{1}{2\\pi} \\left(\\frac{\\partial\\varepsilon}{\\partial\\Phi}\\right)^2\n%\\left( 4k_\\mathrm{B}T +  2\\hbar\\omega \\right) / R_\\Phi.\nM^2  \\frac{2 \\hbar \\omega \\, G}{1 - e^{-\\hbar \\omega / k_{\\mathrm{B}} T}}.\n\n$$\nThis known noise source falls about $100$ times below the measured PSD at $f_{01}=\\Delta/2\\pi$ (red dot in Fig.\u00a0(Figure fig:psd)) where the relaxation is due solely to $\\delta \\varepsilon$ noise, indicating that the dominant source of energy relaxation lies elsewhere.\n\nThe crossover $f_\\mathrm{c}$ between the effective $1/f$- and $f$-type flux noises (Fig.\u00a0(Figure fig:psd)) occurs between $\\Delta/2\\pi$ and $k_\\mathrm{B}T/h$, where $T=50$ mK is the approximate electronic temperature of our device[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nNoise-power spectral density (PSD).\nMulti-coloured dots, $\\delta\\varepsilon$-noise PSD (0.2\u201320 MHz) derived from CPMG data at $\\Phi_\\mathrm{b}\\! =\\! -0.4\\,\\mathrm{m}\\Phi_0$ (see text).\nColours correspond to the various $N$ in Fig.\u00a0(Figure fig:cpmg)b\u2013c; grey dots for data up to $N\\!=\\!250$.\n\nYellow squares, $\\delta\\varepsilon$-noise PSD (2\u201320 MHz) derived from Rabi spectroscopy (Fig.\u00a0(Figure fig:Rabi_with_Sim); see text).\n\nDiagonal, dashed lines, Estimated $1/f$ flux (red) and $\\delta\\Delta$ (blue) noise inferred from the Ramsey and echo measurements (cf. $A_\\lambda$ and $\\omega^\\Delta_\\mathrm{uv}$ in Table\u00a01).\n\nSolid, red line, Power-law dependence, $S_\\varepsilon(f) = A'_\\varepsilon/(2\\pi f)^\\alpha$, extrapolated beyond the qubit's frequency, $\\Delta/2\\pi$.\nThe parameters $A'_\\varepsilon = (0.8\\,\\mu\\Phi_0)^2$ and $\\alpha=0.9$ were determined by fitting the low-frequency, linear portion of the CPMG PSD data before the slight upturn beyond 2 MHz (see Appendix).\nThe shaded area covers $\\alpha\\pm0.05$.\n\nGreen dots, High-frequency $\\varepsilon$ and $\\Delta$ PSD inferred from energy-relaxation measurements above $\\Delta/2\\pi\\!=\\!5.4$\u00a0GHz.\nPurple line, Guide to indicate linearly increasing Nyquist (quantum) noise, including the eigenbasis rotation (see inset);\ndots indicate transverse $\\delta\\varepsilon$ (red) and $\\delta\\Delta$ (blue) noises.\n\nInset,\nGraphic representation of the quantization axis (grey arrows of fixed length) with the qubit's ($Z'$) eigenstate tilted from the \u201claboratory\u201d frame ($Z$) by the angle $\\theta$.\nFields $\\varepsilon(\\Phi_\\mathrm{b})$ and $\\Delta$ point in the $X$ and $Z$ directions, respectively.\nRed and blue double-arrows indicate transverse noise.\n\nThe dynamical-decoupling protocols demonstrated in this work comprise the same types of simple pulses that are used for quantum gate operations and therefore require little additional overhead to implement.\n\nIntegrating refocusing pulses into qubit control sequences, e.g., by forming composite gates that incorporate both quantum operations and refocusing pulses, will lead to lower net error rates in systems limited by dephasing[Unknown Author, \"Unknown Title\", ].\n\nDespite observing levels of $1/f$ flux and critical-current noise similar to those observed ubiquitously in superconducting qubits and SQUIDs[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ],\nwe could mitigate this noise dynamically to increase the pure dephasing times beyond 0.1 ms, more than a factor $10^4$ longer than the intrinsic pulse length.\n\nHowever, despite having a remarkably long energy relaxation time $T_1 = 12 \\; \\mu$s, the transverse relaxation $T_2 \\approx 2T_1$ was ultimately limited by it.\n\nDynamical decoupling protocols go a long way to refocusing existing levels of $1/f$ noise and achieve long coherence times, and the main emphasis is now on identifying and mitigating the noise source(s) that cause energy relaxation.\n\nWe note for further study that the PSD power law obtained experimentally by the CPMG technique, when extended to higher frequencies, falls within a factor two of the measured transverse noise, suggesting the possibility that the microscopic mechanism responsible for low-frequency dephasing may also play a role in high-frequency relaxation.\n\nAPPENDIX\n\nMeasurement set-up.\n\nWe performed our experiments at MIT, in a dilution refrigerator with a base temperature of 12 mK.\nThe device was magnetically shielded with 4 Cryoperm-10 cylinders and a superconducting enclosure. All electrical leads were attenuated and/or filtered to minimize noise.\n\nWe used the Agilent E8267D microwave source, and employed the Tektronix AWG 5014 arbitrary waveform generator to create I/Q modulated pulses, and to shape the read-out pulse.\n\nDescription of the qubit.\n\nWe fabricated our device at NEC, using the standard Dolan angle-evaporation deposition process of Al\u2013AlO$_x$\u2013Al on a SiO$_2$/Si wafer (Fig.\u00a0(Figure fig:device_schematic)a).\n\nThe persistent-current, or flux qubit [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] consists of a superconducting loop with diameter $d\\sim2\\,\\mu$m, interrupted by four Josephson junctions (Fig.\u00a0(Figure fig:device_schematic)).\nThree of the junctions each have the Josephson energy $E_\\mathrm{J}=210$ GHz, and charging energy $E_C=4$ GHz; the forth is smaller by a factor $\\alpha=0.54$.\nThe ratio of energy scales puts the device in the flux limit, $E_\\mathrm{J}/E_C\\approx50$, thus making the phases across the Josephson junctions well defined.\n\nThe geometric and kinetic loop inductances are negligible compared to the Josephson inductance:\n$$\n\\qquad \\qquad  L_\\mathrm{g}\\sim\\mu_0 d \\sim 2\\,\\mathrm{pH}, \\quad L_\\mathrm{k} = \\mu_0\\lambda_\\mathrm{L}^2 \\, l/S \\sim 30\\,\\mathrm{pH}, \\quad L_\\mathrm{J} = \\Phi_0/2\\pi I_\\mathrm{c}\\sim10\\,\\mathrm{nH},\n$$\nwhere we used $\\lambda_\\mathrm{L} = 100$ nm,\n$l = 10\\,\\mu$m, and\n$S = 20 \\times 250\\,\\mathrm{nm}^2$.\n\n< g r a p h i c s >\n\na, Scanning electron micrograph (SEM) of a device (qubit and SQUID shown) with identical design parameters as the one measured during this work\u00a0[Unknown Author, \"Unknown Title\", ].\nb, Schematic. Qubit loop (shaded) and galvanically coupled read-out SQUID.\nThe crosses are Josephson junctions; $R$, bias resistors; $C$, shunt capacitances; $L$, inductances.\n\nWhen the external magnetic flux $\\Phi$ threading the qubit loop is close to half a magnetic-flux quantum, $\\Phi_0/2$, the qubit's potential energy exhibits a double-well profile with quantized energy levels $\\pm\\hbar\\varepsilon/2=\\pm I_\\mathrm{p}\\Phi_\\mathrm{b}$, where $\\Phi_\\mathrm{b}=\\Phi-\\Phi_0/2$ is the flux bias and $I_\\mathrm{p}=0.18\\,\\mu$A the persistent current.\nThe ground states in the left and right potential wells correspond to the diabatic states $|L\\rangle$ and $|R\\rangle$\nof opposite circulating persistent currents.\n\nA tunnel coupling $\\hbar\\Delta/2$ between the right- and left-well qubit states opens an energy gap, $\\hbar\\Delta$, between the ground and excited states, $|0\\rangle$ and $|1\\rangle$, at flux degeneracy, $\\Phi_\\mathrm{b}=0$.\n\nThe two-level Hamiltonian \u2013 analogous to a spin-1/2 particle in a magnetic field \u2013 is in the \u201claboratory\" frame\n\n$$\n\\label{eq:Hamiltonian_labframe}\n\\hat{\\mathcal{H}} = - \\frac{\\hbar}{2} \\left[ (\\varepsilon + \\delta \\varepsilon) \\hat{\\sigma}_{x} + (\\Delta + \\delta \\Delta) \\hat{\\sigma}_{z} \\right],\n\n$$\n\nwhere $\\hbar\\omega_{01} = \\hbar\\sqrt{\\varepsilon^2+\\Delta^2}$ is the energy-level splitting; $\\hat{\\sigma}_j$ are the Pauli matrices; and $\\delta \\varepsilon$ and $\\delta \\Delta$ are the noise fluctuations.\n\nThe quantization axis makes an angle $\\theta=\\arctan(\\varepsilon/\\Delta)$ with $\\hat{\\sigma}_{z}$ (and an angle $\\pi-\\theta$ with the persistent-current eigenstates), so that the qubit is first-order insensitive to flux noise when biased at the \u201csweet spot\" $\\varepsilon=0$.\n\n(We write the Hamiltonian in this way rather than with swapped $x$ and $z$ indices as in several previous papers, so that our pulses will be along $X$ and $Y$ in agreement with the habitual NMR language.)\n\nIt can, alternatively, be written in the qubit's eigenbasis,\n\n$$\n\\label{eq:Hamiltonian_eigenframe}\n\\hat{\\mathcal{H}} = -\\frac{1}{2} \\hbar \\left( \\omega_{01}\\hat{\\sigma}_{z'} + \\delta\\omega_{z'} \\hat{\\sigma}_{z'} + \\delta\\omega_{\\perp'} \\hat{\\sigma}_{\\perp'} \\right) ,\n\n$$\n\nsee Fig.\u00a0(Figure fig:lab_and_qubit_frames)a.\n\nHere $\\hat{\\sigma}_{\\perp'}$ denotes that the transverse spin component can include both $\\hat{\\sigma}_{x'}$ and $\\hat{\\sigma}_{y'}$.\nThe longitudinal and transverse noises,\n$\\delta\\omega_{z'}$ and $\\delta\\omega_{\\perp'}$, are further described below.\n\n< g r a p h i c s >\n\nTwo-level Hamiltonian in different eigenbases, and simulated energy spectrum.a, The Hamiltonian (<ref>) in the \u201claboratory\" frame $\\{X,Y,Z\\}$ has the $\\varepsilon$ field (flux-bias) along $X$, perpendicular to the plane of the qubit loop, and the fixed tunnel coupling $\\Delta$ along $Z$.\n\nThe Hamiltonian (<ref>) in the qubit's eigenframe $\\{X',Y',Z'\\}$ makes an angle $\\theta$ with $Z$.\n\nThe figure shows both frames under two bias conditions ($\\varepsilon=0$ [$\\theta=0^\\circ$] and $\\varepsilon=4\\Delta$), with the laboratory frame fixed in space.\n\nThe two frames coincide when $\\varepsilon=0$.\nb, Simulated energy spectrum.\n\nDescription of the read-out SQUID.\n\nOur hysteretic dc-SQUID [Unknown Author, \"Unknown Title\", ], see Fig.\u00a0(Figure fig:device_schematic), has critical current $I_\\mathrm{c}=4.5\\,\\mu$A; normal resistance $R_N = 0.25\\,\\mathrm{k}\\Omega$; mutual qubit\u2013SQUID inductance $M_{\\mathrm{Q-S}}=21$ pH; on-chip capacitors $C\\sim10$ pF, inductors $L\\sim0.1$ nH, and bias resistors $R_I=0.2\\,\\mathrm{k}\\Omega$ and $R_V=1\\,\\mathrm{k}\\Omega$;\nand further cold and room-temperature resistors and filters.\nA coil with mutual coupling $M_\\mathrm{dc}=0.6$ pH to the qubit provides the dc flux bias, and an on-chip antenna with an estimated $M_{\\mu\\mathrm{w}}\\approx0.1$ pH the microwave excitation.\nThe shunt capacitors bring the plasma frequency down to $\\omega_\\mathrm{p}/2\\pi=2.1$ GHz.\n\nThe qubit's magnetization, resulting from the persistent currents, modulates the SQUID's switching current.\n\nFor qubit read out, we apply a sample-and-hold current pulse to the SQUID (Fig.\u00a0(Figure fig:ReadOut_Scurves)a), and use a threshold detector, after room-temperature amplification, to register the presence or absence of a voltage, conditioned on the qubit being in state $|L\\rangle$.\nWe determine the switching probability, $P_\\mathrm{sw}$, statistically by repeating this measurement several thousand times.\n\n< g r a p h i c s >\n\na, Read-out pulse (voltage across a 1-k$\\Omega$ bias resistance). The optimized pulse shape is programmed to have a 4-ns sample pulse, including 1-ns rise, 1-ns sample, and 2-ns fall times, followed by a 3-$\\mu$s hold plateau at 17.5\nb, Read-out visibility  at $\\Phi_\\mathrm{b}=0$.\nScans of the SQUID's switching probability, $P_\\mathrm{sw}$, vs. the height of the sampling pulse.\nWe obtain 79\nRelaxation during read out leads to an imperfect determination of the excited state (17\n\nThe pulse is produced by a digital arbitrary-waveform generator (Tektronix AWG5014) with 250 MHz analog output bandwidth.\n\nDue to enhanced relaxation when a current is flowing through the SQUID, a rapid sample pulse is important for good read-out visibility.\nA hold current enables the room-temperature electronics to register the voltage pulse before retrapping occurs, but a low and short hold pulse limits the quasiparticle generation, which is also beneficial for the visibility.\n\nWe obtain an optimal read-out visibility of 79\n\nIn addition to biasing the SQUID, the read-out pulse couples flux into the qubit with the effect of shifting the states adiabatically, $|0\\rangle\\to|L\\rangle$ and $|1\\rangle\\to|R\\rangle$, before the measurement takes place, so that the states can be distinguished by the projective measurement in the persistent-current basis.\n\nThe optimal SQUID dc-bias current $I_\\mathrm{b}$ with respect to noise coupled into the qubit was very close to $I_\\mathrm{b}=0$, indi\u00adca\u00adting highly symmetric SQUID junctions.\nIn this set of experiments, we therefore did not apply any dc bias to the SQUID while manipulating the qubit, cf. Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nSensitivity to noise.\n\nFollowing the approach of Ithier et al. [Unknown Author, \"Unknown Title\", ], we will evaluate the noise terms in the qubit's Hamiltonian,\n$$\n\\hat{\\mathcal{H}} = -\\frac{1}{2} \\hbar \\left( \\omega_{01}\\hat{\\sigma}_{z'} + \\delta\\omega_{z'} \\hat{\\sigma}_{z'} + \\delta\\omega_{\\perp'} \\hat{\\sigma}_{\\perp'} \\right) \\qquad \\qquad \\qquad \\mathrm{[equation~(\\ref{eq:Hamiltonian_eigenframe})]}.\n$$\n\nWe consider both flux and critical-current noise (affecting $\\Delta$),\n\nand express the noises as sensitivity derivatives that translate the noise fluctuations to a change in the Hamiltonian, i.e. $\\delta\\lambda\\to\\delta\\omega$.\n\nAt $\\Phi_{\\mathrm{b}}=0$, the first-order noise $\\delta \\Delta$ is much larger than second-order $\\delta \\varepsilon$ (flux) noise, as confirmed through simulation.\nIt is therefore sufficient to expand to first order to explain our Ramsey and echo data,\n\n$$\n\\label{eq:long_noise_comp}\n\\delta\\omega_{z'} = \\frac{\\partial\\omega_{01}}{\\partial\\lambda} \\delta\\lambda + \\ldots\n\\qquad \\mathrm{and} \\qquad\n\\delta\\omega_{\\perp'} = \\frac{\\partial\\omega_{\\perp'}}{\\partial\\lambda} \\delta\\lambda + \\ldots \\, .\n\n$$\n\nEnergy relaxation is related to noise that is transverse to the qubit's quantization axis, $\\delta\\omega_{\\perp'}(\\lambda)$, at the frequency of the level splitting $\\omega_{01}$.\n\nPure dephasing, on the other hand, is related to low-frequency fluctuations of the qubit's energy-level splitting.\n\nTo evaluate the longitudinal first-order term in equation\u00a0(<ref>) we use the chain rule,\n$$\n% D_{\\lambda,z}=\n\\frac{\\partial\\omega_{01}}{\\partial\\lambda} \\, = \\, \\frac{\\partial\\omega_{01}}{\\partial\\varepsilon} \\frac{\\partial\\varepsilon}{\\partial\\lambda} \\, + \\, \\frac{\\partial\\omega_{01}}{\\partial\\Delta} \\frac{\\partial\\Delta}{\\partial\\lambda} .\n\n$$\n\nBy geometry,\n$$\n\n\\frac{\\partial\\omega_{01}}{\\partial\\varepsilon} = \\frac{\\varepsilon}{\\omega_{01}} \\qquad \\mathrm{and} \\qquad \\frac{\\partial\\omega_{01}}{\\partial\\Delta} = \\frac{\\Delta}{\\omega_{01}} .\n\n$$\n\nFrom spectroscopy measurements we infer the $\\varepsilon$ sensitivity to flux noise, $\\lambda=\\Phi$,\n$$\n\n\\xi = \\frac{\\partial\\varepsilon}{\\partial\\Phi} = 2\\pi\\times 1.1\\,\\mathrm{GHz/m}\\Phi_0 ,\n\n$$\n\nwhile $\\Delta$ is insensitive to $\\Phi$ noise.\n\nSince $\\hbar\\varepsilon=2 \\,I_\\mathrm{p} \\, \\Phi_\\mathrm{b}$ and\n$I_\\mathrm{p}=I_\\mathrm{c}\\sqrt{1-1/(2\\alpha)^2}$,  $\\varepsilon$ is sensitive also to critical-current noise, $\\lambda=I_\\mathrm{c}$,\n\n$$\n\n\\frac{\\partial\\varepsilon}{\\partial I_\\mathrm{c}} = \\frac{\\varepsilon}{I_\\mathrm{c}} .\n\n$$\n\nFor the $\\Delta$ sensitivity to fluctuations in $i_\\mathrm{c}=\\delta I_\\mathrm{c}/I_\\mathrm{c}$,\na numerical simulation gives $\\partial\\Delta/\\partial I_\\mathrm{c} = 2\\pi \\times 8\\cdot10^{15}$ Hz/A,\nand with $I_\\mathrm{c}=0.4\\,\\mu$A we obtain\n\n$$\n\n\\kappa_1 = \\frac{\\partial\\Delta}{\\partial i_\\mathrm{c}} = 2\\pi \\times 3.01\\,\\mathrm{GHz} .\n\n$$\n\nTaken together, the first-order fluctuations are therefore\n$$\n\n\\frac{\\partial\\omega_{01}}{\\partial\\lambda} \\, \\delta\\lambda \\, = \\, \\frac{\\varepsilon}{\\omega_{01}}\\xi \\, \\delta\\Phi_\\mathrm{b} \\, + \\, \\frac{\\varepsilon}{\\omega_{01}}\\frac{\\varepsilon}{I_\\mathrm{c}} \\, \\delta I_\\mathrm{c} \\, + \\, \\frac{\\Delta}{\\omega_{01}}\\kappa_1 .\n\n$$\n\nFlux noise dominates, except very near $\\epsilon=0$, where the $\\delta\\Delta$ noise is needed to account for the observed decay. (The second term is negligible.)\n\nDecoherence. Ramsey and echo phase decays \u2014 $1/f$-flux noise.\n\nIn the Bloch\u2013Redfield formalism, valid for weakly coupled, short-correlated noise, the dynamics of two-level systems is described by the longitudinal and transverse relaxation rates, $\\Gamma_1 = 1/T_1\\,$ and $\\Gamma_2 = 1/T_2\\,$, respectively\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nWe assume that the qubit is coupled to many fluctuators, which, in concert and independent of their individual statistics, will yield a Gaussian noise distribution due to the central limit theorem.\n\nIn systems where the noise is regular at the frequency of the qubit's energy-level splitting, $\\omega_{01}$, relaxation and dephasing factorize.\n\nThe longitudinal relaxation is exponential due to the many uncorrelated contributions of transversally coupled noise at $\\omega_{01}$.\n\nThe pure-dephasing rate, $\\Gamma_\\varphi$, associated with low-frequency, quasi-static, longitudinally coupled noise (inhomogeneous broadening), combines with $\\Gamma_1$ to give the rate $\\Gamma_2 = \\Gamma_1/2 + \\Gamma_\\varphi$.\n\nHowever, the exact form of the time dependence of the dephasing component is determined by the noise-PSD.\n(That is, when the dephasing is non-exponential, the inverse time constant can strictly no longer be interpreted as a rate.)\n\n< g r a p h i c s >\n\nDecay rates vs. flux detuning.  a,\nEnergy-relaxation rate, $\\Gamma_1$, and Gaussian phase-decay rates for the Hahn echo, $\\Gamma_{\\varphi,\\mathrm{E}}$, and Ramsey free induction, $\\Gamma_{\\varphi,\\mathrm{F}}$, after subtracting the exponential $\\Gamma_1$ decay.\nStraight, black lines are fits to $\\Gamma_{\\varphi, \\mathrm{E/F}}(\\Phi_\\mathrm{b})$ for flux noise only; see the text and equation\u00a0(<ref>).\n\nb, Blow up of the data in the dashed-box region in a, along with simulated Ramsey- and echo- decay rates including both $\\delta\\varepsilon$ and $\\delta\\Delta$ noises.\nFor the echo, the grey line is the rate obtained for a $1/f$ noise in $\\delta\\Delta$ with the 1-MHz ultra-violet cut off given by the experimental protocol.\nThe red line is the rate obtained with the lower ultra-violet cut off: $\\omega_\\mathrm{uv}^\\lambda/2\\pi < 0.1\\,$MHz. The exact rate depends on the detailed shape of the noise cut off, which is unknown.\n\nAt $\\Phi_\\mathrm{b}=0$, the echo decay is nearly $T_1$ limited in our device, and therefore practically indistinguishable from an exponential. Relaxation contributes by $\\Gamma_1=1/2\\,T_1=43\\times10^3$/s or 6.8 kHz to the low-power spectroscopic line width $\\Delta f_\\mathrm{(FWHM)}=0.18$ MHz.\n\nThis exceeds the expected\n$\\Delta f_\\mathrm{(FWHM)}=1/\\pi\\,T_2^{^*}$ by only 0.05 MHz, indi\u00adca\u00adting little power broadening, given the free-induction decay rate, $\\Gamma_\\mathrm{F}=1/T_2^{^*}$, with the measured $T_2^{^*}=2.5\\,\\mu$s.\n\nBiased away from $\\Phi_\\mathrm{b}$, we find a Gaussian spin-echo phase decay, $\\exp[-(\\Gamma_{\\varphi,\\mathrm{E}}\\,t)^2]$, consistent with a $1/f$ flux-noise model [Unknown Author, \"Unknown Title\", ] (singular PSD at $\\omega=0$).\nAs the Ramsey fringe decays considerably faster it is hard to distinguish between exponential and Gaussian decays.\n\nThe bias dependencies for echo and Ramsey decays are\n$$\n\\label{eq:phase_decays}\n\\Gamma_{\\varphi,\\mathrm{E/F}}(\\Phi_\\mathrm{b}) = (A_\\Phi\\,\\eta_\\mathrm{\\,E/F})^{1/2} \\, \\left| \\frac{\\partial\\omega_{01}}{\\partial\\Phi} \\right| ,\n\n$$\n\nwhere the numerical factors $\\eta$ differ due to the different echo and Ramsey filtering functions: $\\eta_{\\varphi,\\mathrm{F}} = \\ln(1/\\omega_\\mathrm{ir}t)$\nand $\\eta_{\\varphi,\\mathrm{E}} = \\ln 2$.\nTheir ratio,\n$\\Gamma_{\\varphi,\\mathrm{F}}(\\Phi_\\mathrm{b}) / \\Gamma_{\\varphi,\\mathrm{E}}(\\Phi_\\mathrm{b}) \\approx 4.5$,\nis in accordance with our data, and the magnitude,\n\n$$\n\\label{eq:A_phi}\nA_\\Phi=(1.7\\,\\mu\\Phi_0)^2 ,\n\n$$\n\nof the noise $S(\\omega)=A_\\Phi/|\\omega|$ agrees with previous results [Unknown Author, \"Unknown Title\", ], see Fig.\u00a0(Figure fig:Decays_vs_detuning).\n\nNumerical simulations of Ramsey and echo.\n\nThe $\\Phi_\\mathrm{b}$ dependencies of $T_2^{^*}$ and $T_{2,\\mathrm{E}}$ are reproduced in numerical simulations.\n\nWe simulated the Ramsey fringe by numerically solving the Bloch equations, including the measured $T_1$ decay and linearly coupled quasi-static noises,\n\naveraging over many realizations.\nEach run had stochastic, normally distributed $\\delta\\varepsilon$ and $\\delta\\Delta$ deviations from their average values:\n\nThe $1/f$ flux noise, $S(\\omega)=A_\\Phi/|\\omega|$, gives\n$\\sigma_\\varepsilon/2\\pi = 10$ MHz when integrated from 1\u00a0Hz to 1\u00a0MHz;\n\nnoise in $\\Delta$ dominates near $\\Phi_\\mathrm{b}=0$, and we get agreement for $\\sigma_\\Delta/2\\pi = 0.06$ MHz, uncorrelated with the flux noise and obtained from\n$S_\\Delta(\\omega) = A_\\Delta/|\\omega|$ with\n$A_\\Delta = \\left(4\\cdot10^{-6}\\right)^2$.\n\nIn the echo simulation we additionally took into account dynamic noises from $10^4$ to $10^{10}$ Hz.\nWe obtained the noisy time series for $\\varepsilon$ and $\\Delta$ by inverse-Fourier transforming the amplitudes of the $1/f$ noises with random phases for each Fourier component,\n\nand then evaluated the Schr\u00f6dinger evolution operator in discrete time.\n\nNear $\\Phi_\\mathrm{b}=0$, the experimental data shows a greater echo-improvement in $T_2$ than the simulation would suggest for these parameters (see Fig.\u00a0(Figure fig:Decays_vs_detuning)b).\n\nThis discrepancy would be explained by a lower ultra-violet $\\Delta$-noise cut off, with faster decay than $1/f$ above $\\omega_\\mathrm{uv}^{\\Delta}/2\\pi \\sim 0.1$ MHz.\n\nNumerical evaluations of the coherence integral, equation\u00a0(<ref>) below, agree with our simulations.\n\nPulse calibration.\n\nWe calibrate the rotations to $<1\\,\\%$ accuracy by applying a tune-up sequence of pulses, akin to methods used in NMR\u00a0[Unknown Author, \"Unknown Title\", ].\n\nA rigorous measurement of gate errors should be done with randomized benchmarking, for example.\n\nX_\u03c0/2 - ( \u03c4/2N - Y_\u03c0- \u03c4/2N )_N - X_\u03c0/2\n\n$$\n%\nand illustrated by the rotations in the Bloch sphere (Fig.~\\ref{fig:CPMG_rotations}), the transverse component of the Bloch vector is refocused along the axis of the refocusing pulses (here $Y$), whereas the perpendicular component ($X$) is randomized.\nCPMG is a development on the Carr-Purcell (CP) sequence \\cite{Carr-Purcell-PR-54}, which has identical pulse positions, but where all rotations are along the same axis.\n%\nThe third pulse sequence that we investigated, the Uhrig dynamical-decoupling (UDD) sequence \\cite{Uhrig-PRL-07,Uhrig-NJPhys-08}, has normalized pulse positions defined by\n%\n$$\n\n\u03b4_j = sin^2 ( \u03c0j/2N+2 ).\n\n$$\n\nThe dephasing under a certain sequence is described by the \\emph{coherence integral},\n%\n$$\n\n\u03c7_N(\u03c4)   =   (\u2202\u03c9_01/\u2202\u03bb)^2 \u03c4^2\n\u222b_0^\u221ed\u03c9  S(\u03c9)\ng_N(\u03c9,\u03c4) .\n\n$$\n%\nThe dimensionless\nfilter function $g_N(\\omega,\\tau)$ depends on the number and distribution of $\\pi$ pulses \\cite{Uhrig-PRL-07,Uhrig-NJPhys-08,Cywinski-PRB-08,Biercuk-Nature-09,Biercuk-PRA-09},\n%\n$$\n\ng_N(\u03c9,\u03c4) = |y_N(\u03c9,\u03c4)|^2/(\u03c9\u03c4)^2,\n\n$$\n$$\n\\label{eq:filter_def_2}\ny_N(\\omega,\\tau) = \\left| 1+(-1)^{1+N}\\exp(i\\omega\\tau) + 2\\sum_{j=1}^{N} (-1)^j \\exp(i\\omega\\delta_j\\tau) \\cos(\\omega\\tau_\\pi/2) \\right| ,\n\n$$\n\nwhere $\\delta_j \\in [0,1]$ is the normalized position of the centre of the $j$th $\\pi$ pulse between the two $\\pi/2$ pulses.\nThe $\\tau_\\pi$-dependent factor assumes square pulses, but is a reasonable approximation in our case.\n\nAlternatively to equation\u00a0(<ref>), one can define a function $F_N(\\omega,\\tau) = |y_N(\\omega,\\tau)|^2$ that filters the phase noise, $S(\\omega)/\\omega^2$, as in, e.g., Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe Ramsey free induction ($N=0$) and the Hahn spin echo ($N=1$) have weighting functions\n$g_0(\\omega,\\tau) = \\mathrm{sinc}^2(\\omega\\tau/2)$ and $g_1(\\omega,\\tau) = \\mathrm{sinc}^2(\\omega \\tau/4) \\sin^2(\\omega \\tau/4)$, respectively.\nNote that $g_1(0)=0$, indicating a suppression of the low-frequency part of the noise for the Hahn echo.\n\nThe CPMG sequence is inherently robust to field inhomogeneities when the following criteria are fulfilled [Unknown Author, \"Unknown Title\", ]:\n(i) The effective rotation axis is oriented in the transverse ($XY$) plane (true when the driving frequency is resonant with the level splitting);\n(ii) the magnetization (Bloch vector) is initially aligned with the rotation axis ($Y$);\nand (iii) the rotation angle is $\\pi$.\n\nErrors that occur due to deviations from (i\u2013iii) can be quantified by computing the propagator over one cycle of the sequence.\nFor an initial state $Y$, one finds that $Y_\\pi$ errors appear only to fourth order (CPMG), whereas $X_\\pi$ errors accumulate to second order (CP).\n\n< g r a p h i c s >\n\nDynamical-decoupling pulse sequences. Rotations of the Bloch vector during the CPMG sequence (pulses along $X$ and $Y$ in the laboratory frame.)\nTiming of the CPMG, CP, and UDD pulse sequences for $N=10$.\n\nDetermination of the PSD from the CPMG-decay data.\n\nThe qubit is subjected to different decay mechanisms during the CPMG pulse sequence.\n\nWe identify three decay rates, and fit the qubit's population to the function\n\n$$\n\\label{eq:P_FitFcn}\nP_\\mathrm{sw}(\\tau) = P_0 + a\n\\exp\\left( -\\Gamma_1 \\tau \\right) \\,\n\\exp\\left( -\\Gamma_\\mathrm{p} (\\tau_\\mathrm{p}) \\right) \\,\n\\exp\\left( -\\chi_N(\\tau) \\right) ,\n\n$$\n\nkeeping the constants $a$ and $P_0$ fixed for all $N$.\n\n* Relaxation.\nFor the duration of the sequence, there is energy relaxation with the constant rate $\\Gamma_1 = 1/2\\,T_1$, where $T_1=12\\,\\mu$s.\n\n* Decay during pulses.\nIn addition, there is pulse-induced decoherence during the total pulse time $\\tau_\\mathrm{p} = N\\tau_\\pi+2\\,\\tau_{3\\pi/2}$.\n(For experimental reasons, instead of $\\pi/2$ pulses we often use the equivalent $3\\pi/2$ pulses.)\nWe do not need to assume that this decay has any particular form, e.g. exponential, as it will be divided out of the calculation.\nHowever, a simple exponential decay with $\\Gamma_\\mathrm{p}=1/(1.75\\,\\mu$s) gives a good overall fit independent of $N$.\n\nAlthough much higher than the Rabi-decay rates described in the manuscript, this rate is reasonable given that we observe an increased Rabi-decay time at high driving amplitudes.\n\n* Dephasing.\nThe fit parameter $\\Gamma_\\varphi^{(N)}$ is the dephasing rate during the total free-evolution time $\\tau$ under an $N$-pulse CPMG sequence, which provides us with a means of figuring the noise PSD, $S(\\omega)$.\nOnly the PSD appears in the decay function, because the noise statistics were taken to be Gaussian, and all information is included in the second-order correlation function.\n\nDividing equation\u00a0(<ref>) with itself for two free-evolution times, $\\tau_1$ and $\\tau_2$, we get\n\n$$\n\\label{eq:P_FitFcn_Ratio}\nq(\\tau_1,\\tau_2) = \\frac{P_\\mathrm{sw}(\\tau_1) - P_0}{P_\\mathrm{sw}(\\tau_2) - P_0} =\n\\exp\\Big(-\\Gamma_1 [\\tau_1-\\tau_2] \\Big) \\,\n\\exp\\Big(-[\\chi_N(\\tau_1)-\\chi_N(\\tau_2)] \\Big) .\n\n$$\n\nFor a pulse separation $\\tau' = \\tau/N$ (and large $N$), the filter (<ref>) is peaked near\n\n$$\n\\label{eq:filter_center_fq}\n\\omega'(\\tau') = \\frac{2\\pi}{4\\tau'} .\n\n$$\n\nIt is narrow enough, that we can treat $g_N\\Big(\\omega'(\\tau'),\\tau'\\Big)$ as a delta function peaked at $\\omega'$, and regard the noise in the qubit's transition frequency as constant within its bandwidth, $\\Delta\\omega$, as illustrated in Fig.\u00a0(Figure fig:Filter_with_1_f)a. This provides us with a means of characterizing the noise at a frequency $\\omega$ by varying $\\tau$.\n\nWe can rewrite the integral in equation\u00a0(<ref>) as\n\n$\\int_0^\\infty \\!\\mathrm{d} \\, \\omega \\, g_N\\Big(\\omega'(\\tau') ,\\tau'\\Big) \\to \\Delta\\omega \\, \\int_0^\\infty \\!\\mathrm{d} \\,\\omega \\, \\delta(\\omega-\\omega')$,\n\nand do the approximation\n\n$$\n\\label{eq:chi_2}\n\\chi_N(\\tau) \\approx \\left(\\frac{\\partial\\omega_{01}}{\\partial\\lambda}\\right)^2 \\tau^2 S\\Big(\\omega'(\\tau')\\Big) \\, g_N\\Big(\\omega' (\\tau') ,\\tau'\\Big)  \\Delta\\omega .\n%\\frac{F_N(\\omega' \\tau)}{(\\omega')^2}\n\n$$\n\nWe know $\\Delta\\omega(\\tau)$, and $g_N\\Big(\\omega'(\\tau'),\\tau'\\Big)$ from a numerical calculation for each $N$.\n\nWe can use equation\u00a0(<ref>) to evaluate the second factor on the right-hand side of equation\u00a0(<ref>),\n\n$$\n\\label{eq:P_FitFcn_Ratio_chi}\n\\tilde{q}(\\tau_1, \\tau_2) \\, = \\, \\exp\n\\left(-\n\\left( \\frac{\\partial\\omega_{01}}{\\partial\\lambda} \\right)^2 \\left[\n\\tau_1^2 \\, S\\Big(\\omega'(\\tau_1)\\Big) \\, g_{N,1}\\Big(\\omega'(\\tau_2),\\tau_2\\Big) \\, \\Delta\\omega_1\n-\n\\tau_2^2 \\, S\\Big(\\omega'(\\tau_2)\\Big) \\, g_{N}\\Big(\\omega'(\\tau_2),\\tau_2\\Big) \\, \\Delta\\omega_2\n\\right]\n\\right) .\n\n$$\n\nThis gives us the difference between the noises at $\\omega'(\\tau_1)$ and $\\omega'(\\tau_2)$, so that we can find one if we know the other.\nTo get the absolute noise level, we have to assume $S(\\omega)$ for some value of $\\omega'=\\omega'(\\tau')$, e.g., a value consistent with the PSD found in the spin-echo measurements, equation\u00a0(<ref>), or indeed choose $\\chi_N=1$ for $\\tau=0$ and go from there.\nFollowing this procedure, we obtain a number of points representing the noise PSD over 0.2\u201320 MHz.\nThe points within the range 0.2\u20132\u00a0MHz lie tight together and are the least susceptible to error, which is why we fit this data to a straight line, rendering the reported $1/f^\\alpha$ dependence: $A'_\\varepsilon = (0.8\\,\\mu\\Phi_0)^2$ and $\\alpha=0.9$.\nIntegrating the noise PSD from these parameters yields $\\sigma_\\varepsilon=8$\u00a0MHz (compared to 10 MHz) for the quasi-static noise, slightly changing the slope of the calculated $\\Gamma_{\\varphi,\\mathrm{F}}$ in Fig.\u00a0(Figure fig:Decays_vs_detuning), which presumed $\\alpha=1$.\nHowever, the slope of the PSD is not necessarily constant over many orders of magnitude, which could explain the slight deviation for the Ramsey, being sensitive to low-frequency noise.\n\nAlternatively, we can fix the rates $\\Gamma_\\mathrm{p}$, $\\Gamma_1$, and then fit the remaining, Gaussian decay $\\chi_N(\\tau) = (\\Gamma_\\varphi\\tau)^2$.\nThen each measured point, $P_\\mathrm{sw}(\\tau)$, is mapped onto $S(\\omega'(\\tau))$ by using equation\u00a0(<ref>).\nHowever, the using a Gaussian decay function is equivalent to an a priori assumption of $\\alpha=1$.\n\nFigure\u00a0(Figure fig:Filter_with_1_f)b shows a numerical evaluation of the coherence integral (<ref>), assuming a noise spectral density\n\n$$\n\\label{eq:1_f}\nS(\\omega) = A/\\omega .\n\n$$\n\nThe calculation shows, that this method underestimates the decay by about 5\n\n< g r a p h i c s >\n\na, The filter function is narrow, and the noise PSD is smooth enough, that we can obtain the noise PSD at the filter's centre frequency by evaluating the coherence integral $\\chi_N(\\tau)$, equation\u00a0(<ref>).\n\nb,\nFitted phase decay, $\\exp[-\\chi_N(\\tau)]$, under an $N\\!=\\!84$ $\\pi$-pulse CPMG sequence with $\\tau_\\pi = 6.8$ ns, at the flux detuning  $\\varepsilon/2\\pi=-430$ MHz ($\\Phi_0=-0.4\\,\\mathrm{m}\\Phi_0$).\nBlue is the function $\\exp(-(\\Gamma_\\varphi^{(N)} \\tau)^2)$ with a fitted $\\Gamma_\\varphi^{(N)}=8.5\\,\\mu$s.\nRed is the integral (<ref>) with $S(\\omega)=A/\\omega$.\n\nNote the excellent agreement between the blue and red lines.\nDashed is the expression (<ref>) with the same parameters as for the red line.\n\nDecoherence during driven evolution.\n\nWe obtain information about the flux noise in the 2\u201320 MHz frequency range also by analyzing the decoherence during driven evolution.\n\nDriven by a near-resonant, transverse field\n$\\hat{\\mathcal{H}}_1 = -\\hbar\\,\\Omega(t)\\,\\cos(\\omega t)\\,\\hat{\\sigma}_x$,\n\nthe static part of the Hamiltonian in the rotating frame is\n\n$$\n\\label{eq:Hamiltonian_rot_frame}\n\\hat{\\tilde{\\mathcal{H}}} = -\\frac{1}{2} \\hbar \\left(\n\\Delta\\omega \\hat{\\sigma}_z + \\Omega \\hat{\\sigma}_x \\right) ,\n\n$$\n\nwhere $\\Delta\\omega = \\omega - \\omega_{01}$.\nAs a result, the qubit oscillates at the Rabi frequency\n\n$$\n\\label{eq:Rabi_fq}\n\\Omega_\\mathrm{R} = \\sqrt{\\Omega^2 + (\\Delta\\omega)^2} \\approx \\Omega + (\\Delta\\omega)^2/2\\Omega\n\n$$\n\naround the effective field, which makes an angle $\\eta=\\arctan(\\Delta\\omega/\\Omega)$\nwith the qubit's $\\hat{\\sigma}_z$ axis.\n\nThe decay of the Rabi oscillations has contributions from noise at the frequencies $\\omega_{01}$ and $\\Omega$ [Unknown Author, \"Unknown Title\", ], and from the low-frequency, quasi-static flux noise with variance $\\sigma_\\varepsilon^2$.\n\nStatic noise.\nWe first describe the decay due to quasi-static noise.\nFlux deviations from the bias point $\\varepsilon$ lead to a frequency detuning\n\n$\\Delta\\omega = (\\partial\\omega_{01}/\\partial\\varepsilon) \\Delta\\varepsilon = (\\varepsilon/\\omega_{01})\\Delta\\varepsilon$,\n\nnormally distributed with a standard deviation $\\sigma_\\varepsilon$,\n\n$$\n\\label{eq:Noise_distr_Gaussian}\nN(\\Delta\\varepsilon) = \\sigma_\\varepsilon^{-1/2} \\exp\\left(-(\\Delta\\varepsilon)^2/2\\,\\sigma_\\varepsilon^2 \\right) .\n\n$$\n\nIntegrating over $N(\\Delta\\varepsilon)$, the Rabi oscillations decay as\n\n$$\n\\label{eq:Rabi_decay_static}\n\\zeta(t) = \\int \\mathrm{d}(\\Delta\\varepsilon) \\,\\, N(\\Delta\\varepsilon) \\, \\cos \\left( \\Omega_\\mathrm{R} \\,t + \\phi \\right) .\n\n$$\n\nUnder the approximation $\\Delta\\omega\\ll\\Omega$,\nthe Fresnel-type integral (equation\u00a0<ref>) becomes\u00a0[Unknown Author, \"Unknown Title\", ]\n\n$$\n\\label{eq:Rabi_decay_static_2}\n\\zeta(t) = \\left(1 + (ut)^2 \\right)^{-1/4} \\,\\cos\\left( \\Omega \\, t + \\frac{1}{2}\\arctan(ut) \\right) ,\n\n$$\n\nwhere\n\n$$\n\\label{eq:Rabi_decay_static_envelope}\nu = \\left( \\frac{\\partial\\omega_{01}}{\\partial\\varepsilon} \\right)^2 \\frac{\\sigma_\\varepsilon^2}{\\Omega} = \\left(\\frac{\\varepsilon}{\\omega_{01}}\\right)^2 \\, \\frac{\\sigma_\\varepsilon^2}{\\Omega} .\n\n$$\n\nNoise at the Rabi frequency.\nWe now turn to the exponential decay of the oscillation envelope ($\\Gamma_2$ in the rotating frame),\n\n$$\n\\label{eq:Gamma_R}\n\\Gamma_\\mathrm{R} = \\frac{3}{4}\\Gamma_1 \\cos^2\\theta + \\frac{1}{2}\\Gamma_\\Omega ,\n\n$$\n\nwhere the component that depends on the noise at the Rabi frequency $\\Omega_\\mathrm{R}$ has two contributions which we denote $\\Gamma_\\Omega^{(z)}$ and $\\Gamma_\\Omega^{(\\perp)}$:\n\n$$\n\\label{eq:Gamma_Omega}\n\\Gamma_\\Omega \\, = \\, \\pi S_\\varepsilon(\\Omega_\\mathrm{R}) \\, \\sin^2\\theta \\, + \\, \\pi S_\\Delta(\\Omega_\\mathrm{R}) \\, \\cos^2\\theta \\, \\equiv \\, \\Gamma_\\Omega^{(z)} \\,\\sin^2\\theta \\, + \\, \\Gamma_\\Omega^{(\\perp)} \\, \\cos^2\\theta .\n\n$$\n\nWe can approximate $\\cos^2\\theta \\approx 1$, for $\\varepsilon\\ll\\Delta$, and write equation\u00a0(<ref>) as\n\n$$\n\\label{eq:Gamma_R_simplified_1}\n\\Gamma_\\mathrm{R} = \\frac{3}{4}\\Gamma_1 + \\frac{1}{2}\\Gamma_\\Omega^{(\\perp)} + \\left(\\frac{\\varepsilon}{\\omega_{01}}\\right)^2 \\, \\frac{1}{2}\\Gamma_\\Omega^{(z)} .\n\n$$\n\nFitting procedure.\nIn order to determine $S(\\Omega_\\mathrm{R})$, we measured the Rabi oscillations vs. $\\Phi_\\mathrm{b}$, with $\\Omega_\\mathrm{R}$ fixed for each set of data.\n\nThe combined decay envelope from Eqs\u00a0(<ref>, <ref>) becomes\n$\\left(1 + (ut)^2 \\right)^{-1/4}\\times$ $\\exp(-\\Gamma_\\mathrm{R} t)$.\n\nWe observe that, at $\\varepsilon=0$, the model predicts an exponential decay with the rate\n$\\frac{3}{4}\\Gamma_1 + \\frac{1}{2}\\Gamma_\\Omega^{(\\perp)}$.\nFor a given $\\Omega_\\mathrm{R}$, we find this rate by fitting, and then keep it fixed while fitting the Rabi envelopes vs. $\\varepsilon$.\n\nAt low amplitude ($\\Omega_\\mathrm{R}/2\\pi\\sim2$ MHz), $\\Gamma_\\mathrm{R}$ nearly reaches its limit $(3/4)\\Gamma_1$.\n\nDividing out the known quasi-static contribution, and then fitting the envelope to the parabolic equation\u00a0(<ref>), we obtain the flux-noise dependent $\\Gamma_\\Omega^{(z)}$, from which we can calculate $S_\\varepsilon(\\Omega)$.\n\nEnergy relaxation; high-frequency spectroscopy.\n\n< g r a p h i c s >\n\n$T_1$ relaxation.\nRepeated measurements of $T_1$ relaxation from the excited state, at flux degeneracy $\\Phi_\\mathrm{b}=0$, showing how $T_1$ varies by about 10\nThe size of the error bars from the exponential fits are on the order of the variation.\nEach trace took 1 min 40 s to measure; $T_1$ may vary on a shorter time scale than that.\n\nFigure\u00a0(Figure fig:T1_repeated) shows the variation over repeated measurements of $T_1$ relaxation.\n\nTo explain the high-frequency noise, leading to $T_1$ relaxation, we model the $\\varepsilon$ and $\\Delta$ channels of the environment as ohmic resistors.\n\nThe microwave antenna's designed mutual inductance to the qubit is\n\n$M=0.02$ pH with $R=50\\,\\Omega$ termination.\nThe Johnson\u2013Nyquist (thermal and quantum) noise of an environment at $T=50$ mK (a reasonable effective electronic temperature on the chip) is[Equation\u00a0(<ref>) is written with the following (\u201ctype 2\") definition of the Fourier transform, used throughout this paper:\n$S_\\lambda(\\omega) = (1/2\\pi) \\int_{-\\infty}^\\infty \\mathrm{d}t \\, \\langle \\lambda(0)\\lambda(t) \\rangle \\exp(-i\\omega t)$, where $\\langle\\cdot\\rangle$ is the un-symmetrized correlation function.]\n\n$$\n\nS^\\mathrm{JN}_\\varepsilon(\\omega) =  \\frac{1}{2\\pi} \\left(\\frac{\\partial\\varepsilon}{\\partial\\Phi}\\right)^2\n%\\left( 4k_\\mathrm{B}T +  2\\hbar\\omega \\right) / R.\nM^2  \\frac{2 \\hbar \\omega / R}{1 - e^{-\\hbar \\omega / k_{\\mathrm{B}} T}} ,\n\n$$\n\nwhich simplifies to\n\n$$\n\\label{eq:J-N_flux}\nS^\\mathrm{JN}_\\varepsilon(\\omega) \\approx \\frac{1}{2\\pi} \\left(\\frac{\\partial\\varepsilon}{\\partial\\Phi}\\right)^2 \\, M^2  \\, \\left( 2k_\\mathrm{B}T +  2\\hbar\\omega \\right) / R .\n\n$$\n\nThis expected noise falls about 100 times below the measured PSD at $f_{01}=\\Delta/2\\pi$,\nindicating that intrinsic, microscopic noise mechanisms dominate the flux noise.\nWith $R$ unchanged, we would infer an effectively $\\sim\\!10$ times larger $M$ to account for the observed noise.\n\nWithin this work, we did not identify which noise sources were responsible for the $\\Delta$ noise, which can arise from, e.g., critical-current noise or charge noise due to various microscopic mechanisms.\n\nTaking the tilted quantization axis into account, so that the transverse noise is constituted by $\\varepsilon$ noise at $\\varepsilon=0$, by $\\Delta$ noise at $\\varepsilon\\gg\\Delta$, and by combined projections of the two noises in-between, we arrive at the combined expression for the effective transverse Johnson\u2013Nyquist noise,\n\n$$\n\nS_\\lambda(\\omega_{01}) = \\frac{\\Delta^2}{\\omega_{01}^2} S^\\mathrm{JN}_\\varepsilon(\\omega_{01}) + \\frac{\\omega_{01}^2-\\Delta^2}{\\omega_{01}^2}    S^\\mathrm{JN}_\\Delta(\\omega_{01}) .\n% alternatively, write the second term as \\varepsilon^2/\\omega_{01}^2\n\n$$\n\nAs mentioned above, this effective noise is obviously greater than the expected extrinsic noise sources (Johnson\u2013Nyquist as well as $1/f$ noise).\n\nThe subgap conductance, typically several hundred to several thousand times the normal resistance, may limit the achievable $T_1$-relaxation times\u00a0[Unknown Author, \"Unknown Title\", ], a topic worth further studies.\n\nAcknowledgements\n\nWe gratefully acknowledge T.\u00a0Orlando for support in all aspects of this work.\nWe appreciate J.\u00a0Clarke, L.\u00a0Levitov and S.\u00a0Lloyd for helpful discussions, and M.\u00a0Biercuk, P.\u00a0Forn-Diaz and S.\u00a0Valenzuela for comments on the manuscript.\nWe thank P.\u00a0Murphy and the LTSE team at MIT Lincoln Laboratory for technical assistance.\nThis work was sponsored by the U.S. Government; the Laboratory for Physical Sciences; the National Science Foundation;\nand the Funding Program for World-Leading Innovative R&D\non Science and Technology (FIRST), CREST-JST, MEXT kakenhi \u201cQuantum Cybernetics\".\n\nOpinions, interpretations, conclusions and recommendations are those of the author(s) and are not necessarily endorsed by the U.S. Government.\n\n10\nurl<#>1urlprefixURL\n\nHahn-PR-50\nauthorHahn, E.\u00a0L.\ntitleSpin echoes.\njournalPhys. Rev. volume80,\npages580\u2013594 (year1950).\n\nSlichter-NatureStyleRef\nauthorSlichter, C.\u00a0P.\ntitlePrinciples of Nuclear Magnetic\nResonance (yearSpringer, New York, 3rd ed., 1990).\n\nViola-PRA-98\nauthorViola, L. & authorLloyd, S.\ntitleDynamical suppression of decoherence in two-state\nquantum systems.\njournalPhys. Rev. A volume58,\npages2733\u20132744 (year1998).\n\nMooij-Science-99\nauthorMooij, J.\u00a0E. et\u00a0al.\ntitleJosephson persistent-current qubit.\njournalScience volume285,\npages1036\u20131039 (year1999).\n\nOrlando-PRB-99\nauthorOrlando, T. et\u00a0al.\ntitleSuperconducting persistent-current qubit.\njournalPhys. Rev.\u00a0B volume60,\npages15398 (year1999).\n\nClarke-Nature-08\nauthorClarke, J. & authorWilhelm, F.\u00a0K.\ntitleSuperconducting quantum bits.\njournalNature volume453,\npages1031\u20131042 (year2008).\n\nCarr-Purcell-PR-54\nauthorCarr, H.\u00a0Y. & authorPurcell, E.\u00a0M.\ntitleEffects of diffusion on free precession in nuclear\nmagnetic resonance experiments.\njournalPhys. Rev. volume94,\npages630\u2013638 (year1954).\n\nMeiboom-Gill-RSI-58\nauthorMeiboom, S. & authorGill, D.\ntitleModified spin-echo method for measuring nuclear\nrelaxation times.\njournalRev. Sci. Instrum.\nvolume29, pages688\u2013691\n(year1958).\n\nClerk-RMP-10\nauthorClerk, A.\u00a0A., authorDevoret, M.\u00a0H.,\nauthorGirvin, S.\u00a0M., authorMarquardt, F. &\nauthorSchoelkopf, R.\u00a0J.\ntitleIntroduction to quantum noise, measurement, and\namplification.\njournalRev. Mod. Phys.\nvolume82, pages1155\u20131208\n(year2010).\n\nAstafiev-PRL-04\nauthorAstafiev, O., authorPashkin, Y.\u00a0A.,\nauthorNakamura, Y., authorYamamoto, T. &\nauthorTsai, J.\u00a0S.\ntitleQuantum noise in the Josephson charge qubit.\njournalPhys. Rev. Lett.\nvolume93, pages267007\n(year2004).\n\nBiercuk-Nature-09\nauthorBiercuk, M.\u00a0J. et\u00a0al.\ntitleOptimized dynamical decoupling in a model quantum  memory.\njournalNature volume458,\npages996\u20131000 (year2009).\n\nBluhm-arxiv-10\nauthorBluhm, H. et\u00a0al.\ntitleLong coherence of electron spins coupled to a\nnuclear spin bath.\njournalPreprint at\nhttp://arxiv.org/abs/1005.2995  (year2010).\n\nBarthel-PRL-10\nauthorBarthel, C., authorMedford, J.,\nauthorMarcus, C.\u00a0M., authorHanson, M.\u00a0P. &\nauthorGossard, A.\u00a0C.\ntitleInterlaced dynamical decoupling and coherent\noperation of a singlet-triplet qubit.\njournalPhys. Rev. Lett.\nvolume105, pages266808\n(year2010).\n\ndeLange-Science-10\nauthorde\u00a0Lange, G., authorWang, Z.\u00a0H.,\nauthorRiste, D., authorDobrovitski, V.\u00a0V. &\nauthorHanson, R.\ntitleUniversal dynamical decoupling of a single\nsolid-state spin from a spin bath.\njournalScience volume330,\npages60\u201363 (year2010).\n\nRyan-PRL-10\nauthorRyan, C.\u00a0A., authorHodges, J.\u00a0S. &\nauthorCory, D.\u00a0G.\ntitleRobust decoupling techniques to extend quantum\ncoherence in diamond.\njournalPhys. Rev. Lett.\nvolume105, pages200402\n(year2010).\n\nUhrig-PRL-07\nauthorUhrig, G.\u00a0S.\ntitleKeeping a quantum bit alive by optimized\n$\\pi{}$-pulse sequences.\njournalPhys. Rev. Lett.\nvolume98, pages100504\n(year2007).\n\nIthier-PRB-05\nauthorIthier, G. et\u00a0al.\ntitleDecoherence in a superconducting quantum bit\ncircuit.\njournalPhys. Rev. B volume72,\npages134519 (year2005).\n\nYoshihara-PRL-06\nauthorYoshihara, F., authorHarrabi, K.,\nauthorNiskanen, A.\u00a0O., authorNakamura, Y. &\nauthorTsai, J.\u00a0S.\ntitleDecoherence of flux qubits due to $1/f$ flux noise.\njournalPhys. Rev. Lett.\nvolume97, pages167001\n(year2006).\n\nAverin-ForPh-00\nauthorAverin, D.\u00a0V.\ntitleQuantum computing and quantum measurement with\nmesoscopic Josephson junctions.\njournalFortschr. Phys.\nvolume48, pages1055\u20131074\n(year2000).\n\nMakhlin-RMP-01\nauthorMakhlin, Y., authorSch\u00f6n, G. &\nauthorShnirman, A.\ntitleQuantum-state engineering with Josephson-junction\ndevices.\njournalRev. Mod. Phys.\nvolume73, pages357\u2013400\n(year2001).\n\nCywinski-PRB-08\nauthorCywi\u00a0\u0144\u0144ski, L.,\nauthorLutchyn, R.\u00a0M., authorNave, C.\u00a0P. &\nauthorDas\u00a0Sarma, S.\ntitleHow to enhance dephasing time in superconducting\nqubits.\njournalPhys. Rev. B volume77,\npages174509 (year2008).\n\nBiercuk-PRA-09\nauthorBiercuk, M.\u00a0J. et\u00a0al.\ntitleExperimental Uhrig dynamical decoupling using\ntrapped ions.\njournalPhys. Rev. A volume79,\npages062324 (year2009).\n\nFaoro-PRL-04\nauthorFaoro, L. & authorViola, L.\ntitleDynamical suppression of $1/f$ noise processes in\nqubit systems.\njournalPhys. Rev. Lett.\nvolume92, pages117905\n(year2004).\n\nFalci-PRA-04\nauthorFalci, G., authorD'Arrigo, A.,\nauthorMastellone, A. & authorPaladino, E.\ntitleDynamical suppression of telegraph and $1/f$ noise\ndue to quantum bistable fluctuators.\njournalPhys. Rev. A volume70,\npages040101 (year2004).\n\nPasini-PRA-10\nauthorPasini, S. & authorUhrig, G.\u00a0S.\ntitleOptimized dynamical decoupling for power-law noise\nspectra.\njournalPhys. Rev. A volume81,\npages012309 (year2010).\n\nBorneman-JMR-10\nauthorBorneman, T.\u00a0W., authorHurlimann, M.\u00a0D. &\nauthorCory, D.\u00a0G.\ntitleApplication of optimal control to CPMG refocusing\npulse design.\njournalJ. Magn. Reson.\nvolume207, pages220 \u2013 233\n(year2010).\n\nWellstood-APL-87\nauthorWellstood, F.\u00a0C., authorUrbina, C. &\nauthorClarke, J.\ntitleLow-frequency noise in dc superconducting quantum\ninterference devices below 1\u00a0K.\njournalAppl. Phys. Lett.\nvolume50, pages772\u2013774\n(year1987).\n\nGeva-Skinner-JChemPhys-95\nauthorGeva, E., authorKosloff, R. &\nauthorSkinner, J.\u00a0L.\ntitleOn the relaxation of a two-level system driven by a\nstrong electromagnetic field.\njournalJ. Chem. Phys.\nvolume102, pages8541 (year1995).\n\nvanHarlingen-PRB-04\nauthorVan\u00a0Harlingen, D.\u00a0J. et\u00a0al.\ntitleDecoherence in Josephson-junction qubits due to\ncritical-current fluctuations.\njournalPhys. Rev. B volume70,\npages064517 (year2004).\n\nShnirman-PRL-05\nauthorShnirman, A., authorSch\u00f6n, G.,\nauthorMartin, I. & authorMakhlin, Y.\ntitleLow- and high-frequency noise from coherent two-level\nsystems.\njournalPhys. Rev. Lett.\nvolume94, pages127002\n(year2005).\n\nKerman-PRL-08\nauthorKerman, A.\u00a0J. & authorOliver, W.\u00a0D.\ntitleHigh-fidelity quantum operations on superconducting\nqubits in the presence of noise.\njournalPhys. Rev. Lett.\nvolume101, pages070501\n(year2008).\n\nvdWal-Science-00\nauthorvan\u00a0der Wal, C.\u00a0H. et\u00a0al.\ntitleQuantum superposition of macroscopic\npersistent-current states.\njournalScience volume290,\npages773\u2013777 (year2000).\n\nChiorescu-Science-03\nauthorChiorescu, I., authorNakamura, Y.,\nauthorHarmans, C. J. P.\u00a0M. & authorMooij, J.\u00a0E.\ntitleCoherent quantum dynamics of a superconducting flux\nqubit.\njournalScience volume299,\npages1869\u20131871 (year2003).\n\nSQUID-handbook\neditorClarke, J. & editorBraginski, A.\u00a0I. (eds.)\ntitleThe SQUID Handbook: Fundamentals and Technology of\nSQUIDs and SQUID Systems Vol. I (publisherWiley, Weinheim,\nyear2004).\n\nVaughan-RSI-72\nauthorVaughan, R.\u00a0W., authorElleman, D.\u00a0D.,\nauthorStacey, L.\u00a0M., authorRhim, W.-K. &\nauthorLee, J.\u00a0W.\ntitleA simple, low power, multiple pulse NMR\nspectrometer.\njournalRev. Sci. Instrum.\nvolume43, pages1356 (year1972).\n\nCollin-PRL-04\nauthorCollin, E. et\u00a0al.\ntitleNMR-like control of a quantum bit superconducting\ncircuit.\njournalPhys. Rev. Lett.\nvolume93, pages157005\n(year2004).\n\nUhrig-NJPhys-08\nauthorUhrig, G.\u00a0S.\ntitleExact results on dynamical decoupling by $\\pi$ pulses\nin quantum information processes.\njournalNew J. Phys. volume10,\npages083024 (year2008).\n\nGreibe-10\nauthorGreibe, T. et\u00a0al.\ntitleSubgap conductance in superconducting tunnel\njunctions.\njournalPreprint at\nhttp://arxiv.org/abs/1009.1248  (year2010).\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'High-Fidelity, Frequency-Flexible Two-Qubit Fluxonium Gates with\u00a0a\u00a0Transmon\u00a0Coupler'?", "completion": "\n\nAPS/123-QED\n\n# High-Fidelity, Frequency-Flexible Two-Qubit Fluxonium Gates with\u00a0a\u00a0Transmon\u00a0Coupler\n\nResearch Laboratory of Electronics, Massachusetts Institute of Technology, Cambridge, MA 02139, USA\nMIT Lincoln Laboratory, Lexington, MA 02421, USA\nDepartment of Physics, Massachusetts Institute of Technology, Cambridge, MA 02139, USA\nDepartment of Electrical Engineering and Computer Science, Massachusetts Institute of Technology, Cambridge, MA 02139, USA\nIBM Thomas J. Watson Research Center, Yorktown Heights, NY 10598, USA\nAtlantic Quantum, Cambridge, MA 02139\nGoogle Research, Mountain View, CA, USA.\n\nleonding@mit.edu\n\n[Present address: ]\n\n[Present address: ]\n\n[Present address: ]\n\n[Additional address: ]\n\nwilliam.oliver@mit.edu\n\nWe propose and demonstrate an architecture for fluxonium-fluxonium two-qubit gates mediated by transmon couplers (FTF, for fluxonium-transmon-fluxonium).\nRelative to architectures that exclusively rely on a direct coupling between fluxonium qubits, FTF enables stronger couplings for gates using non-computational states while simultaneously suppressing the static controlled-phase entangling rate ($ZZ$) down to kHz levels, all without requiring strict parameter matching.\nHere we implement FTF with a flux-tunable transmon coupler and demonstrate a microwave-activated controlled-Z (CZ) gate whose operation frequency can be tuned over a 2GHz range, adding frequency allocation freedom for FTF's in larger systems.\nAcross this range, state-of-the-art CZ gate fidelities were observed over many bias points and reproduced across the two devices characterized in this work.\nAfter optimizing both the operation frequency and the gate duration, we achieved peak CZ fidelities in the 99.85-99.9\nFinally, we implemented model-free reinforcement learning of the pulse parameters to boost the mean gate fidelity up to $99.922\\pm0.009\\%$, averaged over roughly an hour between scheduled training runs.\nBeyond the microwave-activated CZ gate we present here, FTF can be applied to a variety of other fluxonium gate schemes to improve gate fidelities and passively reduce unwanted\u00a0$ZZ$ interactions.\n\n## Introduction\nTalk about advances over the past decade with transmons\nOver the past two decades, superconducting qubits have emerged as a leading platform for extensible quantum computation. The engineering flexibility of superconducting circuits has spawned a variety of different qubits\u00a0[Nakamura, Yu, Pashkin, Yu A, Tsai, Jaw Shen, \"Coherent control of macroscopic quantum states in a single-Cooper-pair box\", 1999] [Ioffe, Lev B, Geshkenbein, Vadim B, Feigel'Man, Mikhail V, Fauchere, Alban L, Blatter, Gianni, \"Environmentally decoupled sds-wave Josephson junctions for quantum computing\", 1999] [Mooij, JE, Orlando, TP, Levitov, L, Tian, Lin, Van der Wal, Caspar H, Lloyd, Seth, \"Josephson persistent-current qubit\", 1999] [Koch, Jens, Terri, M Yu, Gambetta, Jay, Houck, Andrew A, Schuster, DI, Majer, J, Blais, Alexandre, Devoret, Michel H, Girvin, Steven M, Schoelkopf, Robert J, \"Charge-insensitive qubit design derived from the Cooper pair box\", 2007] [Manucharyan, Vladimir E, Koch, Jens, Glazman, Leonid I, Devoret, Michel H, \"Fluxonium: Single cooper-pair circuit free of charge offsets\", 2009] [Yan, Fei, Gustavsson, Simon, Kamal, Archana, Birenbaum, Jeffrey, Sears, Adam P, Hover, David, Gudmundsen, Ted J, Rosenberg, Danna, Samach, Gabriel, Weber, Steven, others, \"The flux qubit revisited to enhance coherence and reproducibility\", 2016] [Gyenis, Andr\u00e1s, Mundada, Pranav S, Di Paolo, Agustin, Hazard, Thomas M, You, Xinyuan, Schuster, David I, Koch, Jens, Blais, Alexandre, Houck, Andrew A, \"Experimental realization of a protected superconducting circuit derived from the 0\u2013\u03c0 qubit\", 2021],\nwith an abundance of different two-qubit gate schemes\u00a0[Majer, Johannes, Chow, JM, Gambetta, JM, Koch, Jens, Johnson, BR, Schreier, JA, Frunzio, L, Schuster, DI, Houck, Andrew Addison, Wallraff, Andreas, others, \"Coupling superconducting qubits via a cavity bus\", 2007] [Rigetti, Chad, Devoret, Michel, \"Fully microwave-tunable universal gates in superconducting qubits with linear couplings and fixed transition frequencies\", 2010] [Poletto, Stefano, Gambetta, Jay M, Merkel, Seth T, Smolin, John A, Chow, Jerry M, C\u00f3rcoles, AD, Keefe, George A, Rothwell, Mary B, Rozen, JR, Abraham, DW, others, \"Entanglement of two superconducting qubits in a waveguide cavity via monochromatic two-photon excitation\", 2012] [Chow, Jerry M, Gambetta, Jay M, Cross, Andrew W, Merkel, Seth T, Rigetti, Chad, Steffen, M, \"Microwave-activated conditional-phase gate for superconducting qubits\", 2013] [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014] [Reagor, Matthew, Osborn, Christopher B, Tezak, Nikolas, Staley, Alexa, Prawiroatmodjo, Guenevere, Scheer, Michael, Alidoust, Nasser, Sete, Eyob A, Didier, Nicolas, da Silva, Marcus P, others, \"Demonstration of universal parametric entangling gates on a multi-qubit lattice\", 2018] [Campbell, Daniel L., Shim, Yun-Pil, Kannan, Bharath, Winik, Roni, Kim, David K., Melville, Alexander, Niedzielski, Bethany M., Yoder, Jonilyn L., Tahan, Charles, Gustavsson, Simon, Oliver, William D., \"Universal Nonadiabatic Control of Small-Gap Superconducting Qubits\", 2020] [Zhang, Helin, Chakram, Srivatsan, Roy, Tanay, Earnest, Nathan, Lu, Yao, Huang, Ziwen, Weiss, DK, Koch, Jens, Schuster, David I, \"Universal fast-flux control of a coherent, low-frequency qubit\", 2021] [Sung, Youngkyu, Ding, Leon, Braum\u00fcller, Jochen, Veps\u00e4l\u00e4inen, Antti, Kannan, Bharath, Kjaergaard, Morten, Greene, Ami, Samach, Gabriel O, McNally, Chris, Kim, David, others, \"Realization of high-fidelity CZ and ZZ-free iSwap gates with a tunable coupler\", 2021].\nMore recently, tunable coupling elements have aided efforts to scale to larger multi-qubit systems\u00a0[Yan, Fei, Krantz, Philip, Sung, Youngkyu, Kjaergaard, Morten, Campbell, Daniel L, Orlando, Terry P, Gustavsson, Simon, Oliver, William D, \"Tunable coupling scheme for implementing high-fidelity two-qubit gates\", 2018], including a demonstration of quantum advantage with 53 qubits\u00a0[Arute, Frank, Arya, Kunal, Babbush, Ryan, Bacon, Dave, Bardin, Joseph C, Barends, Rami, Biswas, Rupak, Boixo, Sergio, Brandao, Fernando GSL, Buell, David A, others, \"Quantum supremacy using a programmable superconducting processor\", 2019] and quantum error correction improving with code distance in the surface code\u00a0[Acharya, Rajeev, Aleiner, Igor, Allen, Richard, Andersen, Trond I, Ansmann, Markus, Arute, Frank, Arya, Kunal, Asfaw, Abraham, Atalaya, Juan, Babbush, Ryan, others, \"Suppressing quantum errors by scaling a surface code logical qubit\", 2023].\nWhile there exists a large selection of superconducting qubits, almost all advancements toward processors at scale have been carried forward with the transmon qubit\u00a0[Koch, Jens, Terri, M Yu, Gambetta, Jay, Houck, Andrew A, Schuster, DI, Majer, J, Blais, Alexandre, Devoret, Michel H, Girvin, Steven M, Schoelkopf, Robert J, \"Charge-insensitive qubit design derived from the Cooper pair box\", 2007], a simple circuit consisting of a Josephson junction in parallel with a shunt capacitance. However, that simplicity comes at a cost. A relatively large transition frequency\u00a0($\\sim$5GHz) makes the transmon more sensitive to dielectric loss\u00a0[Smith, WC, Kou, A, Xiao, X, Vool, U, Devoret, MH, \"Superconducting circuit protected by two-Cooper-pair tunneling\", 2020], and a weak anharmonicity\u00a0($\\sim$-200MHz) presents a challenge for both performing fast gates and designing multi-qubit processors.\n\nIntroduce fluxonium and talk about its advantages\nThe fluxonium qubit\u00a0[Manucharyan, Vladimir E, Koch, Jens, Glazman, Leonid I, Devoret, Michel H, \"Fluxonium: Single cooper-pair circuit free of charge offsets\", 2009] [Earnest, N., Chakram, S., Lu, Y., Irons, N., Naik, R. K., Leung, N., Ocola, L., Czaplewski, D. A., Baker, B., Lawrence, Jay, Koch, Jens, Schuster, D. I., \"Realization of a  System with Metastable States of a Capacitively Shunted Fluxonium\", 2018] [Nguyen, Long B, Lin, Yen-Hsiang, Somoroff, Aaron, Mencia, Raymond, Grabon, Nicholas, Manucharyan, Vladimir E, \"High-coherence fluxonium qubit\", 2019] is a promising alternative to the transmon for gate-based quantum information processing\u00a0[Nguyen, Long B., Koolstra, Gerwin, Kim, Yosep, Morvan, Alexis, Chistolini, Trevor, Singh, Shraddha, Nesterov, Konstantin N., J\u00fcnger, Christian, Chen, Larry, Pedramrazi, Zahra, Mitchell, Bradley K., Kreikebaum, John Mark, Puri, Shruti, Santiago, David I., Siddiqi, Irfan, \"Blueprint for a High-Performance Fluxonium Quantum Processor\", 2022], which alleviates both of these drawbacks.\nThe fluxonium circuit consists of a capacitor (typically smaller than that of a transmon), a Josephson junction, and an inductor all in parallel. The transition frequency between the ground and first excited state of the fluxonium is usually between 100MHz and 1GHz at an external flux bias of\u00a0$\\SI{0.5}{\\Phi_0}$. At these low operating frequencies, energy relaxation times\u00a0$T_1$ exceeding\u00a01ms\u00a0[Pop, Ioan M, Geerlings, Kurtis, Catelani, Gianluigi, Schoelkopf, Robert J, Glazman, Leonid I, Devoret, Michel H, \"Coherent suppression of electromagnetic dissipation due to superconducting quasiparticles.\", 2014] [Somoroff, Aaron, Ficheux, Quentin, Mencia, Raymond A, Xiong, Haonan, Kuzmin, Roman V, Manucharyan, Vladimir E, \"Millisecond coherence in a superconducting qubit\", 2021] have been observed, alongside anharmonicities of several\u00a0GHz.\nWith these advantages, fluxonium qubits have already achieved single-qubit gate fidelities above\u00a099.99\nTwo-qubit gates relying on capacitive coupling\u00a0[Bao, Feng, Deng, Hao, Ding, Dawei, Gao, Ran, Gao, Xun, Huang, Cupjin, Jiang, Xun, Ku, Hsiang-Sheng, Li, Zhisheng, Ma, Xizheng, others, \"Fluxonium: an alternative qubit platform for high-fidelity operations\", 2022] [Dogan, Ebru, Rosenstock, Dario, Guevel, Lo\u0131\u0308ck Le, Xiong, Haonan, Mencia, Raymond A, Somoroff, Aaron, Nesterov, Konstantin N, Vavilov, Maxim G, Manucharyan, Vladimir E, Wang, Chen, \"Demonstration of the Two-Fluxonium Cross-Resonance Gate\", 2022] [Moskalenko, Ilya N, Simakov, Ilya A, Abramov, Nikolay N, Moskalev, Dmitry O, Pishchimova, Anastasiya A, Smirnov, Nikita S, Zikiy, Evgeniy V, Rodionov, Ilya A, Besedin, Ilya S, \"High fidelity two-qubit gates on fluxoniums using a tunable coupler\", 2022] [Ficheux, Quentin, Nguyen, Long B, Somoroff, Aaron, Xiong, Haonan, Nesterov, Konstantin N, Vavilov, Maxim G, Manucharyan, Vladimir E, \"Fast logic with slow qubits: microwave-activated controlled-Z gate on low-frequency fluxoniums\", 2021] [Xiong, Haonan, Ficheux, Quentin, Somoroff, Aaron, Nguyen, Long B., Dogan, Ebru, Rosenstock, Dario, Wang, Chen, Nesterov, Konstantin N., Vavilov, Maxim G., Manucharyan, Vladimir E., \"Arbitrary controlled-phase gate on fluxonium qubits using differential ac Stark shifts\", 2022], however, are more challenging because the same small transition matrix elements which improve\u00a0$T_1$ concomitantly reduce the interaction strength between qubits.\nMoreover, direct capacitive coupling results in an undesired, always-on entangling rate\u00a0($ZZ$).\nIn previous works, a variety of strategies were employed to reduce the\u00a0$ZZ$, such as keeping coupling strengths small or using ac-Stark drives, all of which have their own individual drawbacks.\nFinally, two-qubit gates must also reliably contend with frequency collisions with spectator qubits if they are to be scaled to larger arrays of qubits without sacrificing fidelity.\n\nIn this work, what do we do\nIn this work, we introduce the fluxonium-transmon-fluxonium circuit (FTF) as a novel architecture for coupling fluxonium qubits via a transmon coupler\u00a0[fig:devicea].\nFTF suppresses the static\u00a0$ZZ$ down to kHz levels in a manner nearly insensitive to design parameter variations while simultaneously providing strong couplings for two-qubit gates via non-computational states.\nUsing FTF, we propose and demonstrate a microwave-activated CZ gate between two fluxonium qubits in a 2D-planar geometry.\nThis gate takes advantage of strong capacitive couplings which create a manifold of highly hybridized states that mix the first higher transition ($\\ket{1} \\leftrightarrow \\ket{2}$) of both fluxonium qubits with the transmon's lowest transition ($\\ket{0} \\leftrightarrow \\ket{1}$).\nDespite these strong couplings, the computational states remain relatively unhybridized due to the large qubit-coupler detuning, allowing for high-quality single-qubit gates in addition to the two-qubit gate.\nWe applied microwave pulses to drive a full oscillation to and from this manifold contingent on both fluxonium qubits starting in their excited states and benchmarked an average CZ gate fidelity of up to 99.922\u00a0$\\pm$ 0.009\n\nThe flux tunability of the transmon coupler also allows for the operation of the CZ gate at a wide range of microwave drive frequencies, providing a convenient way to avoid frequency collisions in situ in larger-scale devices.\nSuch in situ tunability is critical for microwave-activated gates, as dependence on a particular frequency layout places an exponentially difficult demand on fabrication precision\u00a0[Sheldon, Sarah, Magesan, Easwar, Chow, Jerry M., Gambetta, Jay M., \"Procedure for systematically tuning up cross-talk in the cross-resonance gate\", 2016] [Hertzberg, Jared B, Zhang, Eric J, Rosenblatt, Sami, Magesan, Easwar, Smolin, John A, Yau, Jeng-Bang, Adiga, Vivekananda P, Sandberg, Martin, Brink, Markus, Chow, Jerry M, others, \"Laser-annealing Josephson junctions for yielding scaled-up superconducting quantum processors\", 2021] as the number of qubits increases. Our devices also exhibit up to millisecond\u00a0$T_1$ in a multi-qubit planar geometry, placing them among the highest coherence superconducting qubits to date and priming them for use in larger systems.\n\n## FTF Architecture\nHamiltonian.\nOur device configuration consists of two differential fluxonium qubits capacitively coupled to a grounded transmon coupler, with a much weaker direct capacitive coupling between the two fluxonium qubits\u00a0[fig:deviceb]. The two lowest-lying states of each fluxonium form the computational basis\u00a0$\\{\\ket{00}, \\ket{01}, \\ket{10}, \\ket{11}\\}$, and the first excited state of the coupler, in addition to the second excited states of the fluxonium qubits, serve as useful non-computational states. Modeling only the qubits and their pairwise capacitive couplings, our system Hamiltonian is\n\n$$\n\\label{eq:hamiltonian}\n\\hat{H}/h &=& \\sum_{i=1,2} 4 E_{C,i} \\hat{n}^2_i + \\frac{1}{2}E_{L,i}\\hat\\phi_i^2 - E_{J,i}\\cos(\\hat\\phi_i - \\phi_{\\text{ext},i})\\nonumber\\\\\n&+& 4 E_{C,c} \\hat{n}_c^2 - E_{J1,c}\\cos(\\hat\\phi_c) - E_{J2,c} \\cos(\\hat\\phi_c - \\phi_{\\text{ext},c}) \\nonumber\\\\\n&+& J_{1c}\\hat{n}_1 \\hat{n}_c + J_{2c}\\hat{n}_2\\hat{n}_c + J_{12}\\hat{n}_1\\hat{n}_2,\n\n$$\n\nwhere\u00a0$E_C$, $E_J$, and $E_L$ represent the charging, Josephson, and inductive energies, respectively.\nSubscripts\u00a0${i=1, 2}$ index the two fluxonium nodes, and subscript\u00a0$c$ labels the coupler node.\nHere we also introduced the external phase\u00a0$\\phi_\\text{ext}$, which is related to the external flux\u00a0$\\Phi_\\text{ext}$ through the expression\u00a0$\\Phi_\\text{ext}/\\Phi_0 = \\phi_\\text{ext} / 2\\pi$ for each qubit.\nFor both our main device\u00a0(Device A) and a secondary device (Device B), the experimentally obtained Hamiltonian parameters are listed in tab:hamiltonian, along with the measured coherence times.\n\n< g r a p h i c s >\n\nDevice overview and gate principle. a Simplified circuit schematic of two fluxonium qubits (red) capacitively coupled to a tunable-transmon coupler (blue). b  False-colored optical micrograph of the two fluxonium qubits  and the transmon along with their readout resonators, charge lines, and local flux lines. Arrays of 102 Josephson junctions in series form the fluxonium inductances. c Energy level diagram illustrating the principle of the CZ gate. In practice, levels\u00a0$\\ket{201}$,\u00a0$\\ket{102}$, and\u00a0$\\ket{111}$ are highly hybridized, and selectively driving any of these transitions results in a CZ gate.\n\nCharacterization of FTF devices. Hamiltonian parameters for both Device A and Device B were obtained by fitting two-tone spectroscopy data and the static\u00a0$ZZ$ rate vs. coupler flux.\nCoherence times were measured by biasing each fluxonium at\u00a0$\\Phi_\\text{ext} = \\SI{0.5}{\\Phi_0}$ using only the global flux bias.\nUnless otherwise stated, all data in this manuscript corresponds to Device A.\n\n$E_C$ (GHz)\n$E_L$ (GHz)\n$E_J$ (GHz)\n$N_{JJ}$\n$\\omega_{01}/2\\pi$ (GHz)\n$\\omega_r/2\\pi$ (GHz)\n$T_1$ (s)\n$T_2^R$ (s)\n$T_2^E$ (s)\n\nA    Fluxonium 1     1.41     0.80     6.27     102     0.333     7.19     560     160     200\n\nA    Fluxonium 2     1.30     0.59     5.71     102     0.242     7.08     1090     70     190\n\nA    Transmon c     0.32          3.4, 13     \u2013     \u2013     7.30     \u2013     \u2013     \u2013\n\nB    Fluxonium 1     1.41     0.88     5.7     102     0.426     7.20     450     230     240\n\nB    Fluxonium 2     1.33     0.60     5.4     102     0.281     7.09     1200     135     310\n\nB    Transmon c     0.30          3.0, 13     \u2013     \u2013     7.31     \u2013     \u2013     \u2013\n\n3c$J_{1c}$ (MHz)     3c$J_{2c}$ (MHz)      3c$J_{12}$ (MHz)\n\nA    Coupling strengths     3c570     3c560      3c125\n\nB    Coupling strengths     3c550     3c550      3c120\n\n### Gate principles\nExplain the coupling and higher levels for gate. Relevant detunings to sideband transitions\nThe operating principles of FTF are fundamentally different than those of all-transmon circuits\u00a0[Yan, Fei, Krantz, Philip, Sung, Youngkyu, Kjaergaard, Morten, Campbell, Daniel L, Orlando, Terry P, Gustavsson, Simon, Oliver, William D, \"Tunable coupling scheme for implementing high-fidelity two-qubit gates\", 2018].\nDue to its relatively high frequency, the coupler interacts negligibly with the computational states of the qubits.\nInstead, the coupler predominantly interacts with the higher levels of the qubits, acting as a resource for two-qubit gates without adversely affecting single-qubit gates.\n\nWe describe the quantum state of the system using the notation\u00a0$\\ket{jkl}$, where\u00a0$j$, $k$, and\u00a0$l$ denote the energy eigenstates in the uncoupled basis of fluxonium\u00a01, the coupler, and fluxonium\u00a02, respectively.\nWhile coupler-based gates are often activated by baseband flux pulses, here we generate the required entangling interaction via a microwave pulse from\u00a0$\\ket{101}$ to a non-computational state of the joint system.\nAs illustrated in fig:devicec, a single-period Rabi oscillation from\u00a0$\\ket{101}$ to either\u00a0$\\ket{201}$, $\\ket{111}$, or\u00a0$\\ket{102}$ gives the\u00a0$180^\\circ$ conditional phase shift necessary for a CZ gate, provided no other transitions are being driven.\nWe note that, throughout this work, we label the eigenstates according to their maximum overlap with the uncoupled qubit/coupler states at\u00a0$\\Phi_\\text{ext,c} = 0$ (equivalently ${\\Phi_\\text{ext,c} = \\SI{1}{\\Phi_0}}$).\nWe perform this labeling at\u00a0${\\Phi_\\text{ext,c} = 0}$ because tuning the coupler flux results in avoided crossings among the higher levels of the system.\n\nAdvantages of FTF\nIn general, stronger coupling strengths result in larger detunings from parasitic transitions in two-qubit gate schemes, yet doing so often results in unintended consequences. Two common drawbacks of larger coupling strengths are remedied using the FTF architecture: (1)\u00a0crosstalk due to non-nearest-neighbor couplings, and (2)\u00a0unwanted static\u00a0$ZZ$ interactions. In all transmon-based architectures, the same level repulsion that enables the two-qubit gate also creates level repulsions within the computational subspace. This is because all transition frequencies and charge matrix elements of adjacent levels in a transmon have similar values. As this hybridization among the computational states increases, charge drives will produce non-local microwave crosstalk to unwanted qubit transitions. In FTF, the large ratio of transition matrix elements\u00a0$|\\bra{2}\\hat{n}\\ket{1}| / |\\bra{1} \\hat{n} \\ket{0}|$ for fluxonium qubits, the large fluxonium anharmonicity, and the large detunings between the transmon and each fluxonium all serve to mitigate these negative side-effects.\n\nZZ reduction\n\nZZ Introduction\nFormally, the\u00a0$ZZ$ interaction rate is defined as\u00a0${\\zeta = (E_{11} - E_{10} - E_{01} + E_{00})/h}$ (for two qubits) or\u00a0${\\zeta = (E_{101} - E_{100} - E_{001} + E_{000})/h}$ (for two qubits and a coupler). It describes an unwanted, constant, controlled-phase-type entangling rate caused by the collective level repulsions from the many non-computational states of superconducting qubits acting on the computational states.\n\nPerturbative analysis of ZZ\nA key feature of the FTF architecture is its ability to suppress $\\zeta$, despite the strong coupling strengths that would typically amplify it. This low\u00a0$\\zeta$ can be understood by considering the couplings\u00a0$J_{ij}$ perturbatively up to fourth order.\nAt each order\u00a0$m$, the perturbative correction can be considered an\u00a0$m$th-order virtual transition between the states of the uncoupled qubits; the strength of a particular transition is proportional to the product of the corresponding couplings\u00a0$J_{ij}$.\nIn fig:zza, we illustrate the dominant virtual transitions up to fourth order: the first-order correction is zero; at second order, only direct transitions between the two fluxonium qubits contribute to\u00a0$\\zeta$; at third order, the only allowed transitions form three-cycles between the three qubits; and at fourth order, we find that transmon-mediated transitions between the two fluxonium qubits dominantly contribute to\u00a0$\\zeta$. As such, we can write\u00a0$\\zeta$ to fourth order as\n\n$$\n\\label{eq:zz_pert}\n\\zeta \\approx J_{12}^2\\zeta^{(2)} + J_{12}J_c^2\\zeta^{(3)} + J_c^4\\zeta^{(4)},\n\n$$\n\nwhere\u00a0$\\zeta^{(i)}$ depend only on the uncoupled states, and we assume\u00a0$J_{1c} = J_{2c} = J_c$. Specifically, we find our device to be well-described by\u00a0$\\zeta^{(2)} = \\SI{-2.1e-3}{GHz^{-1}}$, $\\zeta^{(3)} =  \\SI{1.4e-3}{GHz^{-2}}$, and\u00a0$\\zeta^{(4)} = \\SI{-2.6e-4}{GHz^{-3}}$ at\u00a0$\\Phi_\\text{ext,c} = \\SI{0.5}{\\Phi_0}$. Critically, both the second- and fourth-order terms are negative, while the third-order term is positive. This is a direct consequence of the perturbation theory: for virtual transitions to excited states above the computational subspace, even-order terms describe level repulsions, while odd-order terms describe level attractions. The relatively low\u00a0$ZZ$ in the FTF system stems from this cancellation between even and odd terms (see appendix:ZZ for further details on the $ZZ$ cancellation).\n\nMinimum ZZ trajectory and value\nTo understand this quantitatively, we numerically calculate\u00a0$\\zeta$ by diagonalizing eq:hamiltonian as a function of\u00a0$J_c$ and\u00a0$J_{12}$ [fig:zzb].\nWe find that\u00a0$\\zeta$ can be almost perfectly canceled by appropriate choices of the couplings, as traced by the darker dashed line. Within perturbation theory, this curve of minimum\u00a0$\\zeta$ is a parabola:\u00a0$d\\zeta /d J_{12} = 0 \\rightarrow J_{12} = -J_{c}^2 \\zeta^{(3)}/2\\zeta^{(2)}$. By inserting this expression into eq:zz_pert, we obtain the dependence of\u00a0$\\zeta$ along the parabola\u00a0$\\zeta_\\mathrm{min} = J_c^4(- \\zeta^{(3)}\\zeta^{(3)}/4\\zeta^{(2)} + \\zeta^{(4)})$. For our device parameters, the two terms in parentheses almost cancel, summing to\u00a0$-2 \\times 10^{-6}~\\mathrm{GHz}^{-3}$.\n\n< g r a p h i c s >\n\nZZ-reduction in the FTF architecture. a\u00a0A perturbative treatment of the couplings\u00a0$J_{ij}$ shows energy shifts in FTF to be dominated by virtual transitions (dashed arrows) of second (dark purple), third (light purple), and fourth (pink) order between the fluxonium qubits (maroon circles) and the coupler (blue circle). b\u00a0Numerical simulation of\u00a0$\\zeta$ as a function of\u00a0$J_c = J_{1c} = J_{2c}$ and\u00a0$J_{12}$ with the experimentally extracted qubit parameters. With the coupler, a ratio of coupling strengths always exists that minimizes\u00a0$\\zeta$ (dark gray). c\u00a0Measured and simulated\u00a0$\\zeta$ as a function of the coupler flux for the experimental device parameters. The\u00a0$ZZ$ rate remains nearly constant between\u00a0$-1.5$ and -2.7kHz.\n\nZZ vs coupling strengths\nImportantly, $|\\zeta|$ remains below 10kHz for\u00a0$J_c$ values of up to\u00a01GHz, while maintaining the optimal coupling ratio.\nTo take full advantage of this phenomenon, we designed the coupling strengths to be as large as reasonable for our geometry.\nFurthermore, by choosing the transmon to have a grounded geometry, a near-optimal ratio of\u00a0$J_{c}^2 / J_{12}$ is maintained while freely varying the fluxonium-transmon capacitance (see appendix:grounded_vs_floating for full details).\nIn addition to this insensitivity to the underlying coupling capacitance, $\\zeta$ is only weakly dependent on\u00a0$J_c$, and\u00a0$J_{12}$: independent errors in\u00a0$J_c$ and\u00a0$J_{12}$ by up to 20\nSuch robustness will be critical in larger-scale devices, as capacitive coupling strengths cannot be changed after device fabrication and are subject to fabrication variations.\n\nZZ vs coupler frequency\nThe value of\u00a0$\\zeta$ is also insensitive to the coupler frequency, allowing us to safely bias the system at any\u00a0$\\Phi_\\text{ext,c}$. This is unsurprising, as the coupler energy levels are far from any resonances with the computational states. In other words, any change in the coupler frequency must compete with the large detuning between the coupler and fluxonium\u00a0$\\ket{0}\\leftrightarrow \\ket{1}$ transitions. To validate our models, we experimentally determined\u00a0$\\zeta$ by measuring the frequency of fluxonium\u00a01 using a Ramsey experiment while preparing fluxonium\u00a02 in the ground or excited state. Taking the difference in fitted frequencies associated with the two initial state preparations yields the experimental value of\u00a0$\\zeta$, which we find to closely follow our numerical simulations as a function of the coupler flux [see fig:zzc].\nAn alternative approach to\u00a0$ZZ$ reduction with fluxonium qubits is to apply always-on ac-Stark drives\u00a0[Xiong, Haonan, Ficheux, Quentin, Somoroff, Aaron, Nguyen, Long B., Dogan, Ebru, Rosenstock, Dario, Wang, Chen, Nesterov, Konstantin N., Vavilov, Maxim G., Manucharyan, Vladimir E., \"Arbitrary controlled-phase gate on fluxonium qubits using differential ac Stark shifts\", 2022] [Dogan, Ebru, Rosenstock, Dario, Guevel, Lo\u0131\u0308ck Le, Xiong, Haonan, Mencia, Raymond A, Somoroff, Aaron, Nesterov, Konstantin N, Vavilov, Maxim G, Manucharyan, Vladimir E, Wang, Chen, \"Demonstration of the Two-Fluxonium Cross-Resonance Gate\", 2022]. While this is an effective means to reduce\u00a0$ZZ$ in few-qubit devices, the requirement of an additional calibrated drive per qubit becomes increasingly prohibitive as system sizes grow.\n\n## Gate Calibration\nReadout\nBefore discussing our single- and two-qubit gates, we first describe the qubit readout and flux biasing.\nIn thermal equilibrium, our fluxonium qubits have nearly equal populations in the ground and excited states\u00a0${(k_\\mathrm{B}T > \\hbar \\omega_{01})}$. To address this, we initialized each qubit in either the ground or excited state at the beginning of each experiment via projective readout and heralded the desired initial state\u00a0[Johnson, JE, Macklin, Christopher, Slichter, DH, Vijay, R, Weingarten, EB, Clarke, John, Siddiqi, Irfan, \"Heralded state preparation in a superconducting qubit\", 2012] (see appendix:readout for further details). To realize independent qubit initialization in our system, each qubit was capacitively coupled to a separate readout resonator, allowing us to perform high-fidelity, single-shot readout within the full computational basis. All three resonators were further coupled to a common Purcell filter\u00a0[Sete, Eyob A, Martinis, John M, Korotkov, Alexander N, \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015].\n\nSpecific wiring and layout\nWe used a global biasing coil to tune the flux across the entire device and used additional local flux lines biased through coaxial cables for independent control of each qubit. This allowed us to freely change the coupler flux while holding each fluxonium at\u00a0$\\Phi_\\text{ext} = 0.5 \\Phi_0$. Although only DC flux was required in our experiment, our device is fully compatible with fast-flux pulses. As such, FTF presents an opportunity  to investigate iSWAP, Landau-Zener, or other flux-modulated gates in a system with low static\u00a0$ZZ$ rates\u00a0[Bao, Feng, Deng, Hao, Ding, Dawei, Gao, Ran, Gao, Xun, Huang, Cupjin, Jiang, Xun, Ku, Hsiang-Sheng, Li, Zhisheng, Ma, Xizheng, others, \"Fluxonium: an alternative qubit platform for high-fidelity operations\", 2022] [Campbell, Daniel L., Shim, Yun-Pil, Kannan, Bharath, Winik, Roni, Kim, David K., Melville, Alexander, Niedzielski, Bethany M., Yoder, Jonilyn L., Tahan, Charles, Gustavsson, Simon, Oliver, William D., \"Universal Nonadiabatic Control of Small-Gap Superconducting Qubits\", 2020] [Zhang, Helin, Chakram, Srivatsan, Roy, Tanay, Earnest, Nathan, Lu, Yao, Huang, Ziwen, Weiss, DK, Koch, Jens, Schuster, David I, \"Universal fast-flux control of a coherent, low-frequency qubit\", 2021] [Setiawan, F., Groszkowski, Peter, Ribeiro, Hugo, Clerk, Aashish A., \"Analytic Design of Accelerated Adiabatic Gates in Realistic Qubits: General Theory and Applications to Superconducting Circuits\", 2021] [Setiawan, F., Groszkowski, Peter, Clerk, Aashish A., \"Fast and Robust Geometric Two-Qubit Gates for Superconducting Qubits and beyond\", 2023] [Mundada, Pranav S., Gyenis, Andr\u00e1s, Huang, Ziwen, Koch, Jens, Houck, Andrew A., \"Floquet-Engineered Enhancement of Coherence Times in a Driven Fluxonium Qubit\", 2020].\n\nTalk about flux lines\nUnfortunately, we found that our qubit coherence times were sensitive to bias-induced heating from the coaxial flux lines. We have found that both qubit\u00a0$T_1$ and\u00a0$T_2$ (both Ramsey and spin-echo) drop with increasing current. To minimize this effect when performing two-qubit experiments, the global coil was used to simultaneously bias the two fluxonium qubits as close as possible to their operation points\u00a0${\\Phi_\\text{ext,1} = \\Phi_\\text{ext,2} = \\SI{0.5}{\\Phi_0}}$. The local flux lines were then used to more precisely tune\u00a0$\\Phi_\\text{ext,1}$ and\u00a0$\\Phi_\\text{ext,2}$ and bias the coupler flux. We emphasize that this nonideality is not fundamental nor unique to the FTF architecture and can be improved in future experiments by optimized construction and filtering of our flux-bias lines.\n\n### Single-qubit gates\nGeneral setup\nTo deconvolve the aforementioned heating effects from the measurement results, we biased the qubits solely with the global coil when characterizing individual qubit coherences (see tab:hamiltonian). Notably, fluxonium\u00a02 in our device achieves a lifetime of over a millisecond, with similar performance reproduced in Device B (see appendix:other_device). In accordance with the higher qubit frequency, fluxonium\u00a01 has a shorter lifetime, and the\u00a0$T_2^E$ of all characterized qubits peaks between 200-300s, likely limited by photon-shot noise from occupation of the resonator or filtering of the flux lines.\n\nSingle-qubit gate results\nWe realized single-qubit gates by calibrating Rabi oscillations generated by a resonant charge drive using a cosine pulse envelope.\nTo quantify the fidelities of these gates, we performed individual as well as simultaneous Clifford randomized benchmarking (RB) using a microwave-only gate set,\n${\\{I,\\, \\pm X,\\, \\pm Y,\\, \\pm X_{\\pi/2},\\, \\pm Y_{\\pi/2}\\}}$, to generate the Clifford group, resulting in an average of 1.875 gates per Clifford\u00a0[Magesan, Easwar, Gambetta, Jay M, Emerson, Joseph, \"Scalable and robust randomized benchmarking of quantum processes\", 2011] [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014].\nIn our decomposition, all gates had an equal time duration and were derived from a single calibrated\u00a0$X_\\pi$ pulse by halving the amplitude and/or shifting its phase (see appendix:single_qubit for the full calibration sequence).\nHere, both qubits were biased at $\\Phi_\\text{ext} = \\SI{0.5}{\\Phi_0}$, with minimal current through the coupler flux line.\nIn fig:1qba, we varied the pulse width from 10ns to 42ns and found average single-qubit gate fidelities consistently near or above 99.99\n\n< g r a p h i c s >\n\nSingle-qubit benchmarking on our multi-qubit device. a Average single-qubit gate fidelities obtained by individual and simultaneous Clifford randomized benchmarking as a function of the pulse width. Error bars for the majority of data points are within the size of the marker and correspond to standard errors about the mean. b-c Individual (I) and simultaneous (S) RB traces of an 18ns gate (purple box in (a)) for qubit 1 and qubit 2, respectively. Individual and simultaneous average gate fidelities have a standard error of about $3\\times 10^{-6}$ for qubit 1 and $4\\times 10^{-6}$ for qubit 2. The larger uncertainties in the qubit 2 data arise from coherent errors, which begin to dominate for gates shorter than 18ns (red points in a).\n\n### Two-qubit CZ gate\nSpectroscopy and transition selection\nWe began our investigation of the two-qubit CZ gate by performing spectroscopy of the relevant non-computational state transitions.\nWith the system initialized in\u00a0$\\ket{101}$, we swept the coupler flux\u00a0$\\Phi_\\text{ext,c}$ to map out the transition frequencies to the three dressed states\u00a0$\\ket{201}$, $\\ket{111}$, and\u00a0$\\ket{102}$ [see fig:map_speca].\nImportantly, we found that\u00a0$\\ket{111}$ crosses both\u00a0$\\ket{201}$ and\u00a0$\\ket{102}$ (at\u00a0$\\Phi_\\text{ext,c} \\approx \\SI{0.65}{\\Phi_0}$), with an avoided crossing strength of nearly 1GHz.\nWith such strong hybridization, a high-performance gate could be realized by driving any of the three energy levels over a wide coupler flux range. Nevertheless, the transitions yielded varying performance depending on their coherence times and the proximity of undesired transitions, whose frequencies we extracted in the same measurement by heralding different initial states (see appendix:transitions).\n\n< g r a p h i c s >\n\nCZ gate as a function of flux. a Spectroscopy of relevant non-computational states. The qubits were initialized in the\u00a0$\\ket{101}$ state via single-shot readout. b Time-domain Rabi oscillations of the\u00a0$\\ket{101} \\leftrightarrow \\ket{102}$ transition as a function of the drive frequency. The faint chevron pattern at 4.52GHz arises from the\u00a0$\\ket{001}\\leftrightarrow \\ket{002}$ transition and was visible due to imperfect state initialization. In all plots, populations have been normalized to between 0 and 1. Inset shows that gates were driven with simultaneous phase-locked pulses applied to each fluxonium charge line. c CZ gate fidelities using a fixed\u00a0100ns cosine pulse envelope, driving each transition in a across the entire\u00a0${0.5-\\SI{1}{\\Phi_0}}$ range, linearly sampled over 21 points. A secondary device (Device B) with slightly different Hamiltonian parameters supports the reliability of our architecture. Points with fidelity below 98.9\n\nGate driving\nWe activated the gate interaction associated with each transition by simultaneously applying a charge drive to each fluxonium [fig:map_specb inset].\nThese drives were chosen to have equal amplitude, with a relative phase between them to maximize constructive interference at the intended transition.\nWe found that using two constructive drives was a convenient method for reducing the total applied power for a given Rabi rate, resulting in a reduced ac-Stark shift from off-resonant transitions.\nIn severe cases, a large ac-Stark shift could prevent the realization of a 180$^\\circ$ conditional phase and increase leakage into non-computational states.\nAn alternative approach exists to tune the relative phase and amplitude of the two drives to result in complete destructive interference of the nearest leakage transition (see appendix:microwave_crosstalk).\nWhile theoretically we expect the relative phase and amplitude to be important for reducing leakage, we found that as long as a\u00a0$180^\\circ$ conditional phase was attainable, the CZ gate fidelity was relatively insensitive to these two parameters.\nfig:map_specb shows the familiar Rabi chevrons when the transition was driven as a function of frequency; in experimental practice, our two-qubit gate is quite similar to driving single-qubit Rabi oscillations.\n\nGate calibration and characterization\nFor a given transition and pulse duration, there are four critical parameters associated with the CZ gate to calibrate: (1) the overall drive amplitude of the two phase-locked drives to ensure a single-period oscillation, (2) the drive frequency to ensure a\u00a0$180^\\circ$ conditional phase accumulation, and (3-4) the single-qubit phases accumulated on each fluxonium during the gate.\nThese single-qubit phase corrections can be conveniently implemented through virtual-Z gates by adjusting the phases of subsequent single-qubit gates\u00a0[McKay, David C, Wood, Christopher J, Sheldon, Sarah, Chow, Jerry M, Gambetta, Jay M, \"Efficient Z gates for quantum computing\", 2017].\nAfter calibration, we extract the gate fidelity by performing Clifford interleaved randomized benchmarking, averaging over 20 different randomizations\u00a0[C\u00f3rcoles, Antonio D, Gambetta, Jay M, Chow, Jerry M, Smolin, John A, Ware, Matthew, Strand, Joel, Plourde, Britton LT, Steffen, Matthias, \"Process verification of two-qubit quantum gates by randomized benchmarking\", 2013] [Magesan, Easwar, Gambetta, Jay M, Johnson, Blake R, Ryan, Colm A, Chow, Jerry M, Merkel, Seth T, Da Silva, Marcus P, Keefe, George A, Rothwell, Mary B, Ohki, Thomas A, others, \"Efficient measurement of quantum gate error by interleaved randomized benchmarking\", 2012] [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014].\nSimilar to our single-qubit Clifford decomposition, we generated the two-qubit Clifford group with the gate set\n${\\{I,\\, \\pm X,\\, \\pm Y,\\, \\pm X_{\\pi/2},\\, \\pm Y_{\\pi/2},\\, \\text{CZ}\\}}$, yielding an average of 8.25 single-qubit gates and 1.5 CZ gates per Clifford.\nA more detailed gate calibration and characterization description can be found in appendix:two_qubit.\n\nGate vs. Flux\nThe FTF approach offers a potential solution to frequency-crowding by allowing for an adjustable gate operation frequency.\nTo demonstrate this frequency-flexibility in our device, we linearly sampled the coupler flux\u00a0$\\Phi_\\text{ext,c}$ at 21 values between\u00a0$\\SI{0.5}{\\Phi_0}$ and\u00a0$\\SI{1}{\\Phi_0}$ and calibrated a CZ gate across all three transitions in fig:map_speca while maintaining a constant 100ns pulse length [fig:map_specc].\nEach data point in fig:map_specc represents a fully automated re-calibration of all single- and two-qubit gate parameters without manual fine-tuning.\nMissing points indicate either failed calibrations or fidelities lower than\u00a0$98.9\\%$, which may be caused by TLS or nearly resonant unwanted transitions (see appendix:rb_vs_flux for further details).\nWhile these fidelities remain unoptimized over the pulse width, they indicate the ease and robustness of the tuneup, as well as the accessibility of state-of-the-art gate fidelities at a variety of drive frequencies.\nWe further emphasize this by including fidelities from Device B, a second fully characterized device with similar performance. While designed to be nominally identical, the non-computational states in Device B differ by up to 300MHz from Device A, with no significant detriment to the gate fidelities (see appendix:other_device for additional characterization of Device B).\n\n< g r a p h i c s >\n\nOptimizing the CZ gate fidelity via reinforcement learning. a Gate fidelities as a function of the width of the cosine pulse envelope, averaged over 20 randomizations. The\u00a0$\\ket{101}\\leftrightarrow \\ket{102}$ transition at\u00a0$\\Phi_\\text{ext,c} \\approx \\SI{0.575}{\\Phi_0}$ was used for these gates. b Fidelity of an interleaved randomized benchmarking sequence with 28 Cliffords using trial CZ gates sampled from the policy of a model-free reinforcement learning agent. After each epoch, the measurement results were used to update the agent's policy according to the PPO algorithm.\nc In a full training run, the agent was first seeded with a 50ns cosine pulse, with an amplitude determined by a physics-calibrated 60ns gate (black diamond) but scaled by 60/50.  Then, the agent was trained to optimize the sequence fidelity of the 50ns pulse (b). The learned gate was then repeatedly evaluated using interleaved randomized benchmarking averaged over 10 randomizations. The next round of training was seeded with the optimized pulse from the previous round. Horizontal bars indicate the averaged fidelity after each round of training.\nd Optimized pulse shape as learned by the agent. The agent was given control over six evenly-spaced $I(t)$ and $Q(t)$ voltage points (colored circles), with the pulse in between points determined by a cubic interpolation. Inset shows the Fourier transform of $I(t) + iQ(t)$.\ne Reference and interleaved randomized benchmarking curves averaged over all 70 randomizations after the second round of training (orange points in c). The purple circle at 28 Cliffords indicates the sequence length used for learning. All uncertainties in this figure correspond to the standard error of the mean.\n\nRB vs pulse width\nTo investigate the trade-off between coherent and incoherent error, we characterized the gate fidelity as a function of the pulse width.\nIn general, all fidelities in fig:map_specc may be improved by optimizing over this pulse width, with our highest fidelity gates using the\u00a0${\\ket{101}\\leftrightarrow \\ket{102}}$ transition at\u00a0$\\Phi_\\text{ext,c} = 0.575 \\Phi_0$ [fig:fidelitiesa].\nAt the observed optimal gate time of 85ns for this transition, we benchmarked a CZ fidelity of\u00a0${99.89\\%\\pm0.02\\%}$.\nFor longer gate durations, the gate error is dominated by the lifetime of the driven non-computational state, measured to be around 10s at this transition and, in general, varied from\u00a0$5-\\SI{20}{\\micro s}$ across all transitions in fig:map_speca.\nThe coherence times of the computational states also reduce the fidelity, but for our devices this error is negligible compared to the\u00a0$T_1$ of the non-computational state (see appendix:error for an analytic error model of this gate process).\nAt shorter gate lengths, coherent leakage into non-computational levels dominates the error, but due to the extreme degree of hybridization of the non-computational states and their subpar readout, we were not able to experimentally measure the location of the leaked population.\n\nReinforcement Learning\nTo further improve the gate fidelity, we deployed a model-free reinforcement learning agent\u00a0[John Schulman and\nFilip Wolski and\nPrafulla Dhariwal and\nAlec Radford and\nOleg Klimov, \"Proximal Policy Optimization Algorithms\", 2017] [An, Zheng, Zhou, DL, \"Deep reinforcement learning for quantum gate control\", 2019] [Niu, Murphy Yuezhen, Boixo, Sergio, Smelyanskiy, Vadim N, Neven, Hartmut, \"Universal quantum control through deep reinforcement learning\", 2019] [Wang, Zhikang T., Ashida, Yuto, Ueda, Masahito, \"Deep Reinforcement Learning Control of Quantum Cartpoles\", 2020], closely following the protocol described by Sivak et al.\u00a0[Sivak, V. V., Eickbusch, A., Liu, H., Royer, B., Tsioutsios, I., Devoret, M. H., \"Model-Free Quantum Control with Reinforcement Learning\", 2022].\nWhile reinforcement learning could not mitigate the incoherent errors dominating the gate at longer pulse widths, at shorter gate times ($<$70ns) we found that it did offer an improvement via fine adjustments of the pulse parameters.\nTo train the agent, we first seeded it with a physics-based pulse calibration with a pulse width of 60ns; our physics-based calibration failed at gate times less than this.\nThen, with a fixed CZ pulse width of 50ns, the agent was trained to maximize the sequence fidelity of interleaved randomized benchmarking at 28 Cliffords with a fixed random seed by optimizing the pulse shape and virtual-Z gates\u00a0[fig:fidelitiesb].\nAfter each round of training, the optimized pulse was repeatedly evaluated by\nperforming interleaved randomized benchmarking over 70 total Clifford sequences\u00a0[fig:fidelitiesc].\nTraining was then repeated using the optimized pulse shape from the previous training round as the seed for the next.\nFor the training run shown in\u00a0fig:fidelitiesc, the fidelity peaked after the second round of training (orange points), with a time-averaged value of $99.922\\pm0.009\\%$.\nA Wilcoxon signed-rank test gives 97\nAs the run progressed, the average fidelity was observed to degrade.\nWe hypothesize that this was due to system drifts beyond what the agent was able to mitigate.\n\nIn the data shown in fig:fidelitiesb-e, the agent was given full control of the $I$ and $Q$ quadratures of the pulse envelope as well as the single-qubit virtual-Z rotation angles.\n$I(t)$ and $Q(t)$ were discretized into six points equally spaced in time [fig:fidelitiesd] with a cubic interpolation determining the remaining points.\nPerhaps the most distinctive feature of the learned pulse is the shape of $Q(t)$: while the agent was seeded with $Q(t) = 0$, the learned pulse shape displays a distinct oscillation in $Q(t)$.\nAlthough we do not fully understand the origin of this oscillation, some intuition may be gained by examining the Fourier transform of the pulse shape [fig:fidelitiesd inset].\nIn the frequency domain, the oscillation in $Q(t)$ results in a distinct asymmetry of the pulse shape: at positive detunings from the carrier frequency, the spectral weight is suppressed, and vice versa for negative detunings.\nWe hypothesize that this learned pulse asymmetry mitigates the effects of the nearest undesired transition, which is detuned by $\\sim$+65MHz at this bias point.\nHowever, we also note that attempts to mitigate the effects of this undesired transition using more established pulse shaping techniques did not improve the gate fidelity\u00a0[Motzoi, F., Gambetta, J. M., Rebentrost, P., Wilhelm, F. K., \"Simple Pulses for Elimination of Leakage in Weakly Nonlinear Qubits\", 2009].\n\n## Outlook\nSummary of good thing on FTF\nOur work demonstrates an architecture in which high-fidelity, robustness against parameter variations, and extensibility are simultaneously realized.\nWe observed millisecond fluxonium lifetimes despite couplings to neighboring qubits, resonators, flux lines, and charge lines, all within a 2D-planar architecture.\nBoth the single- and two-qubit gates performed here are also simple \u2013 operating on the basis of a Rabi oscillation.\nThe relative simplicity of this two-qubit gate was afforded by the FTF Hamiltonian and yielded a high fidelity operation across a large frequency-tunable range, reproduced across multiple devices.\n\nZZ, and benefits for over gate schemes\nOne of the most notable features of the FTF scheme is the capacity for large coupling strengths while simultaneously reducing the\u00a0$ZZ$ interaction strength to kHz levels.\nThis is all done without strict parameter matching or additional drives. In fact, even computational state gates such as iSWAP or cross-resonance can benefit from FTF by utilizing this\u00a0$ZZ$ reduction without worrying about additional complications for single- and two-qubit gates. A fixed-frequency transmon (or simply a resonator) would suffice for this use case (see appendix:ZZ).\n\nFuture improvements\nDespite already high gate fidelities, many avenues exist for improvement. First and foremost, the device heating when DC biasing qubits to their simultaneous sweet spot and tuning the coupler flux reduces the coherence times of our qubits.\nBy optimizing the mutual inductance between the flux lines and the qubits and improving the thermalization and filtering of the flux lines, we anticipate improvements in future experiments.\nEven in the absence of local heating, we estimate a photon-shot-noise limit of\u00a0${T_2\\sim \\SI{400}{\\micro s}}$, assuming an effective resonator temperature of\u00a0$T_\\text{eff} = \\SI{55}{mK}$\u00a0[Yan, Fei, Campbell, Dan, Krantz, Philip, Kjaergaard, Morten, Kim, David, Yoder, Jonilyn L, Hover, David, Sears, Adam, Kerman, Andrew J, Orlando, Terry P, others, \"Distinguishing coherent and thermal photon noise in a circuit quantum electrodynamical system\", 2018].\nSimply decreasing\u00a0$\\chi$ and\u00a0$\\kappa$ should increase this\u00a0$T_2$ limit at the expense of readout speed, which could be a worthwhile exchange in the high\u00a0$T_1$, low\u00a0$T_2$ limit.\n\nAs is typical of fluxonium gates involving the non-computational states, the largest contribution to gate infidelity was the coherence of the\u00a0$\\ket{201}$, $\\ket{111}$,\u00a0$\\ket{102}$ manifold. Yet, the lifetimes of these states were much lower than expected, given coherence times measured on transmons with similar frequencies. By optimizing regions of high electric field density that exist in our current design (notably the small fluxonium-transmon capacitor gap), we expect to improve these coherence times as well.\n\nOutlook for fluxonium quantum computing\nWhile fluxonium has long exhibited impressive individual qubit performance, our work demonstrates a viable path forward for fluxonium-based large-scale processors capable of pushing the boundaries of noisy intermediate-scale quantum computing.\n\nL.D. is grateful to Devin Underwood for his continued support throughout this project, especially during the lockdown years. M.H. acknowledges useful discussions with Vlad Sivak. This research was funded in part by the U.S. Army Research Office Grant W911NF-18-1-0411, and by the Under Secretary of Defense for Research and Engineering under Air Force Contract No. FA8702-15-D-0001. L.D. gratefully acknowledges support from the IBM PhD Fellowship, Y.S., and J.A. gratefully acknowledge support from the Korea Foundation for Advances Studies, and B.K. gratefully acknowledges support from the National Defense Science and Engineering Graduate Fellowship program. M.H. was supported by an appointment to the Intelligence Community Postdoctoral Research Fellowship Program at the Massachusetts Institute of Technology administered by Oak Ridge Institute for Science and Education (ORISE) through an interagency agreement between the U.S. Department of Energy and the Office of the Director of National Intelligence (ODNI). Any opinions, findings, conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the Under Secretary of Defense for Research and Engineering or the US Government.\n\nL.D., M.H., and Y.S. performed the experiments and analyzed the data.\nL.D., M.H., and J.A. developed the theory and numerical simulations.\nL.D., Y.S., A.D.P., and K.S. designed the device.\nK.A., D.K.K., B.M.N., A.M., M.E.S., and J.L.Y. fabricated and packaged the devices.\nL.D., M.H., Y.S., B.K., J.A., A.H.K., and S.G. contributed to the experimental setup.\nT.H., T.P.O., S.G., J.A.G., K.S., and W.D.O supervised the project.\nL.D. and M.H. wrote the manuscript with feedback from all authors.\nAll authors contributed to the discussion of the results and the manuscript.\n\n## Wiring\n< g r a p h i c s >\n\nA detailed wiring schematic of the experimental setup.\n\nThis experiment was conducted in a Bluefors XLD600 dilution refrigerator operated at around 20mK, with the full wiring setup shown in fig:sup_wiring. At the mixing chamber (MXC), the device was magnetically shielded with a superconducting can, surrounded by a Cryoperm-10 can. To reduce thermal noise from higher temperature stages, we typically used in total 23dB attenuation for the coupler flux lines, 30dB attenuation for the fluxonium flux lines, 40dB total attenuation on charge lines, and 70dB total attenuation on the readout input \u2013 the exact value of the attenuation at Still varied between 3dB and 10dB across the flux lines of both devices, though this difference was not critical for any experiment. The readout output was first amplified by a Josephson traveling-wave parametric amplified (JTWPA), pumped by a Holzworth RF synthesizer, then amplified further with a high-electron-mobility transistor (HEMT) amplifier at the 4K stage, another HEMT at room temperature, and a final Stanford Research SR445A amplifier, before being digitized by a Keysight M3102A digitizer.\n\nAll AC signals \u2013 readout, single- and two-qubit gate pulses \u2013 were generated by single sideband mixing of Keysight M3202A 1GSa/s arbitrary waveform generators with Rohde and Schwarz SGS100A SGMA RF sources. For each qubit, the single- and two-qubit gate pulses were combined at room temperature via a diplexer from Marki Microwave (DPXN-2 for Qubit 1 and DPXN-0R5 for Qubit 2). For these diplexers, the single-qubit gate frequencies occur at low enough frequencies to fall in the pass band of the DC port. All control electronics were synchronized through a common SRS 10MHz rubidium clock.\n\nThe DC voltage bias for each qubit flux line as well as the global bobbin was supplied by a QDevil QDAC. The flux lines by design support RF flux, but in this experiment were filtered by 80MHz and 1.9MHz low-pass filters at the MXC.  The current for the global coil was carried through a twisted pair, with a homemade 16kHz cutoff RC filter at the 4K stage.\n\nSummary of control equipment. The manufacturers and model numbers of the control equipment used for this experiment.\n\nComponent     Manufacturer     Model\n\nDilution Fridge     Bluefors     XLD600\n\nRF Source     Rohde and Schwarz     SGS100A\n\nDC Source     QDevil     QDAC I\n\nControl Chassis     Keysight     M9019A\n\nAWG     Keysight     M3202A\n\nADC     Keysight     M3102A\n\n## Grounded or differential qubits?\nIn our circuit design, we made a conscious decision on whether each qubit (or coupler) should be made a grounded qubit or a differential qubit. By using a differential fluxonium, we reduce the amount of capacitance that coupling appendages contribute to the total effective qubit capacitance. A differential qubit also allows for a larger total area of capacitor pads for the same qubit charging energy\u00a0$E_C$. This is important to allow for enough physical room to couple other circuit elements such as resonators, charge lines, flux lines, and other qubits to each fluxonium.\n\n### Grounded transmon\nThe choice to use a grounded transmon, on the other hand, stems from the relationship between\u00a0$J_c=J_{1c}=J_{2c}$ and\u00a0$J_{12}$. As mentioned in the main text, to minimize the\u00a0$ZZ$ interaction\u00a0$\\zeta$, we need\u00a0$J_c^2 / J_{12} = - 2 \\zeta^{(2)} / \\zeta^{(3)} \\approx \\SI{2.97}{GHz}$ for our device parameters. We claim that by using a grounded transmon, we can target this value of\u00a0$J_c/J_{12}$ with first-order insensitivity to the coupling capacitance (between the transmon and the adjacent fluxonium pad)\u00a0$C_c$. Consequently, $C_c$ becomes a free parameter in the device design, and uncertainty in its value will, to first order, have no effect on\u00a0$\\zeta$. To understand this theoretically, we assume the simplified circuit schematic represented in fig:sup_cap_matrixa. All capacitances not explicitly labeled are small and qualitatively unimportant in this analysis.\n\n< g r a p h i c s >\n\nSimplified circuit model of FTF circuits. (a) FTF circuit with a grounded transmon. The capacitance network is simplified for the purpose of a theoretical analysis, with no direct fluxonium-fluxonium capacitance. (b) Same circuit except with a differential transmon coupler.\n\nWe can write down the capacitance matrix of this circuit as\n$$\n\n\\mathbf{C} = \\begin{pmatrix}\nC_{F} & - C_{f2} & 0 & 0 & 0\\\\\n- C_{f2} & C_{F} + C_c  & -C_c & 0 & 0\\\\\n0 & -C_c & C_t + 2 C_c & 0 & -C_c\\\\\n0 & 0 & 0 & C_{F} & -C_{f2}\\\\\n0 & 0 & -C_c & -C_{f2}  & C_{F} + C_c\n\\end{pmatrix},\n$$\nwhere we defined\u00a0$C_F = C_{f1} + C_{f2}$ for convenience. In order to isolate the relevant mode of each differential qubit, we perform a standard variable transformation into sum and difference coordinates which modifies the capacitance matrix as\u00a0$\\tilde{\\mathbf{C}} = (\\mathbf{M}^T)^{-1} \\mathbf{C} \\mathbf{M}^{-1}$ with\n$$\n\n\\mathbf{M} = \\begin{pmatrix}\n1 & 1 & 0 & 0 & 0\\\\\n1 & -1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 1 & -1\n\\end{pmatrix}.\n\n$$\nThe qubit modes for each differential qubit are then solely determined by the difference coordinates, with the resultant three qubit nodes on indices 1, 2, and 4 (counting from 0). We can straightforwardly discard the modes corresponding to summed coordinates in the Hamiltonian and compute coupling strengths between nodes as\u00a0$J_{ij} = 4e^2 \\tilde{\\mathbf{C}}^{-1}[i, j]$. Thus,\n$$\n\nJ_c^2/J_{12} &= 4e^2 \\frac{\\tilde{\\mathbf{C}}^{-1}[1, 2]^2}{\\tilde{\\mathbf{C}}^{-1}[1, 4]} \\label{eq:ratio_grounded_exact}\\\\\n&\\approx 4e^2 \\frac{1}{C_t} + \\mathcal{O}(C_t^{-2}), \\label{eq:ratio_grounded}\n\n$$\nwhere we performed a Taylor expansion assuming\u00a0$C_c, C_{f1}$, and\u00a0$C_{f2}$ are small compared to\u00a0$C_t$ in the final step. We see that to leading order, the value of\u00a0$J_c^2/J_{12}$ is solely determined by\u00a0$C_t^{-1}$, with any dependence on\u00a0$C_c$ scaling with\u00a0$\\mathcal{O}(C_t^{-2})$. By inserting the designed values of\u00a0$C_t = \\SI{45}{fF}$ \u00a0$C_{f1} = \\SI{11}{fF}$, and\u00a0$C_{f2} = \\SI{2.8}{fF}$, eq:ratio_grounded_exact gives 2.8GHz and eq:ratio_grounded gives 3.4GHz. We emphasize that eq:ratio_grounded illustrates a concept in our architecture and that exact design simulations of our coupling strengths were performed using full 5$\\times$5 capacitance matrices with no mathematical approximations.\n\n### Differential transmon\nTo investigate how these relationships would compare when substituting for a differential transmon, we model the hypothetical circuit with the capacitance network in fig:sup_cap_matrixb. The capacitance matrix, in this case, is\n$$\n\n&\\mathbf{C} = \\notag \\\\\n&\\begin{pmatrix}\nC_{F} & - C_{f2} & 0 & 0 & 0 & 0\\\\\n- C_{f2} & C_{F} + C_c  & -C_c & 0 & 0 & 0\\\\\n0 & -C_c & C_{T} + C_c & -C_{t2} & 0 & 0\\\\\n0 & 0 & -C_{t2} & C_{T} + C_c & 0 & -C_c\\\\\n0 & 0 & 0 & 0 & C_{F} & -C_{f2}\\\\\n0 & 0 & 0 & -C_c & -C_{f2}  & C_{F} + C_c\n\\end{pmatrix}\n\n$$\nwhere we have likewise defined\u00a0$C_T = C_{t1} + C_{t2}$. The transformation matrix in this case is\n$$\n\n\\mathbf{M} = \\begin{pmatrix}\n1 & 1 & 0 & 0 & 0 & 0\\\\\n1 & -1 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 1 & 0 & 0\\\\\n0 & 0 & 1 & -1 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 1 & 1\\\\\n0 & 0 & 0 & 0 & 1 & -1\n\\end{pmatrix}\n\n$$\nand our coupling ratio is\n$$\n\nJ_c^2/J_{12} &= 4e^2 \\frac{\\tilde{\\mathbf{C}}^{-1}[1, 3]^2}{\\tilde{\\mathbf{C}}^{-1}[1, 5]} \\label{eq:ratio_floating_exact}\\\\\n&\\approx 4e^2 \\frac{1}{C_{t2}} + \\mathcal{O}(C_{t1}^{-1}). \\label{eq:ratio_floating}\n\n$$\nWhile still independent of\u00a0$C_c$ to leading order, the value of\u00a0$4e^2/C_{t2}$ is far too large compared to optimal values. Furthermore, FTF benefits from as high of coupling strengths as possible, and a differential transmon reduces the values of\u00a0$J_c$ and\u00a0$J_{12}$ for a fixed value of\u00a0$C_c$.\n\nZZ CANCELLATION IN FTF\n\nIn this section, we elaborate on the theory which gives rise to the reduced $ZZ$ rate in the FTF architecture. We specifically consider the level repulsion on the $\\ket{101}$ state, as we find it most impacted by the coupling between qubits, and as a result, indicative of how level repulsions affect the $ZZ$ rate as a whole. We will consider the energy shift of the $\\ket{101}$ to up to 4th order in perturbation theory, where $n$ represents the $\\ket{101}$ state, $k_i$ represent any intermediate state that is not $n$, $V_{jk}$ represents the Hamiltonian matrix element $\\bra{j}H\\ket{k}$ between the two bare states $\\ket{j}$, $\\ket{k}$, and $E^{(m)}_n$ represents the contribution to the energy of the state $\\ket{n}$ at perturbative order $m$. Energy detunings between two states $\\ket{j}$ and $\\ket{k}$ are similarly denoted $E^{(m)}_{jk} = E^{(m)}_j - E^{(m)}_k$. In this notation, the 2nd order correction to the energy of $\\ket{n}$ is\n$$\n\\label{eq:pt2}\nE_n^{(2)} = \\sum_{k_1} \\frac{|V_{n k_1}|^2}{E_{n k_1}^{(0)}}.\n\n$$\nDue to the relatively high energy of the fluxonium $\\ket{2}$ states and the transmon $\\ket{1}$ state, all intermediate states in this summation have higher energy than $\\ket{101}$. The only exception is the $\\ket{000}$ state; however, any energy shift involving only states in the computational basis will not contribute to the total $ZZ$ rate because the equal and opposite level repulsions will cancel out when computing $\\zeta$. As a result, $E_n^{(2)}$ is negative and independent of the coupler element, provided the computational states are formed by capacitively coupled fluxonium qubits.\n\nTo fourth order in perturbation theory, the energy shift is\n$$\n\\label{eq:pt4}\nE_n^{(4)} = \\sum_{k_1 k_2 k_3} \\frac{V_{n k_1} V_{k_1 k_2} V_{k_2 k_3} V_{k_3 n}}{E_{n k_1}^{(0)} E_{n k_2}^{(0)} E_{n k_3}^{(0)}} - E_n^{(2)} \\sum_{k_1} \\left|\\frac{V_{n k_1}}{E_{n k_1}^{(0)}}\\right|^2.\n\n$$\nWhile the expression here is more complicated, the qualitative result is the same. Since each energy detuning in the denominators is negative when all intermediate states have higher energy than $\\ket{n}$, the resultant quantity $E_n^{(4)}$ is also negative.\n\nUnlike the second and fourth order terms, third order contributions can only exist when both fluxonium qubits are coupled to a third qubit\n$$\n\\label{eq:pt3}\nE_n^{(3)} = \\sum_{k_1 k_2} \\frac{V_{n k_1} V_{k_1 k_2} V_{k_2 n}}{E_{n k_1}^{(0)} E_{n k_2}^{(0)}}.\n\n$$\nContrary to the even-order terms, all third-order contributions are positive, providing the critical mechanism to reduce the $ZZ$ rate. While this analysis has been done just for the energy of the $\\ket{101}$ state, numerical computations of eq:pt2, eq:pt4, and eq:pt3 confirm that second and fourth order terms contribute negatively to the overall $ZZ$, and the third order terms contribute positively to the overall $ZZ$. In fig:sup_zza, we compute $\\zeta$ as a function of $J_{12}$ (assuming the optimal corresponding value of $J_c$) with an exact numerical diagonalization (black) and the aforementioned perturbation theory (red), illustrating that perturbation theory up to 4th order is a sufficient description of the total $ZZ$ rate in the FTF system.\n\nAnother interesting feature of FTF unexplored in the main text is that if the transmon frequency is tuned toward infinity, $\\zeta$ does not return to its value with only the two fluxonium qubits and can in fact decrease even further. In fig:sup_zzb, we numerically simulate  $\\zeta$ as a function of the coupler frequency using the Device A parameters and find that $\\zeta$ asymptotes to less than 10Hz as the transmon frequency increases. When the transmon frequency is tuned, not only do the energy level detunings increase, but the charge matrix element also increases through the effective $E_J$. This increase in the charge matrix elements prevents the level repulsions involving the coupler from vanishing even when the coupler frequency becomes infinitely large. This feature makes FTF useful even in fluxonium gate schemes that do not involve the non-computational states. By coupling a fixed frequency transmon (or resonator) with a high frequency (arising from a high $E_J$) to each fluxonium with the appropriate coupling strengths, $\\zeta$ can be reduced to near 0 in a robust manner without needing any measurement or calibration of the extra transmon element.\n\n< g r a p h i c s >\n\nNumerical simulations of $\\zeta$ in the FTF system. a Plot of $\\zeta$ along the `Minimum $ZZ$' parabola in fig:zza, as a function of $J_{12}$. The black curve shows a numerical diagonalization of the Hamiltonian, which is accurately described by 4th order perturbation theory (red).  Without the coupler (gray), $|\\zeta|$ is roughly an order of magnitude larger for this range of coupling strengths. b Numerical simulation of $\\zeta$ as a function of the coupler frequency. The Device A parameters from tab:hamiltonian are used, except the effective transmon $E_J$ is changed to vary the transmon frequency. As this frequency increases, $|\\zeta|$ decreases asymptotically to below 10Hz for this set of device parameters.\n\n## Readout\nIn our standard readout pulse-sequence [fig:sup_readouta], the qubit and readout pulses were periodically played corresponding to a software trigger, with a fixed wait time\u00a0$\\tau_1$ between the start of the trigger and the start of the readout pulses. The trigger period and\u00a0$\\tau_1$ were chosen such the qubit sufficiently decays to its thermal equilibrium state between measurements.\n\n< g r a p h i c s >\n\nPulse diagram for different readout configurations. a Standard measurement and readout sequence. Pulses are played on a repeated trigger so that the time between the trigger start and the readout start is kept constant. b Single-readout post-selection sequence, also known as heralding. Each readout pulse simultaneously sets the initial state for the subsequent qubit pulses and records the measurement outcome of the previous qubit pulses. To herald the fluxonium ground (excited) state\u00a0$\\ket{0}$ ($\\ket{1}$), we only accept measurement results for which the previous readout result was\u00a0$\\ket{0}$ ($\\ket{1}$). c Two-pulse post-selection (heralding) technique. The first readout is used to initialize the qubit state, and the second is used to measure the result of the qubit pulses. This extra readout pulse allows for an additional buffer time\u00a0$\\tau_3$ without impacting the fidelity of the state preparation.\n\nTo initialize the fluxonium qubits in either $\\ket{0}$ or $\\ket{1}$, we relied on a mostly QND single-shot readout. Then, we post-selected the data for any choice of initial state:\u00a0$\\{\\ket{0}, \\ket{1}\\} \\otimes \\ket{0} \\otimes \\{\\ket{0}, \\ket{1}\\}$ in order to herald that state\u00a0[Johnson, JE, Macklin, Christopher, Slichter, DH, Vijay, R, Weingarten, EB, Clarke, John, Siddiqi, Irfan, \"Heralded state preparation in a superconducting qubit\", 2012].\nIn our simplest form of post-selection [fig:sup_readoutb], the qubit and readout pulses were played back-to-back with only a short buffer time\u00a0$\\tau_2$ to allow for photons to depopulate the readout resonator prior to the qubit pulses. In our experiment,\u00a0$\\tau_2 = \\SI{2}{\\micro s}$ was much less than the\u00a0$T_1$ of any qubit, so the qubits do not return to their thermal equilibrium state by the start of the next pulse sequence. Despite losing a fraction of our data due to this post-selection process, we gain an enormous overhead by not having to wait for the qubits to decay between measurements. Using this method, we obtained typical initialization fidelities between 95\n\nIdeally, the above method of post-selection would work with the higher-excited states of the fluxonium, but we found in practice that we could not distinguish the\u00a0$\\ket{1}$ and\u00a0$\\ket{2}$ states of the fluxonium in single-shot. To work around this issue, we used a separate two-pulse post-selection technique [fig:sup_readoutc]. The first readout initializes the qubit in either\u00a0$\\ket{0}$ or\u00a0$\\ket{1}$, and the second readout records the measurement result. We used the same buffer time\u00a0$\\tau_2$ to avoid measurement-induced dephasing of our qubit and introduced an additional wait time\u00a0$\\tau_3 \\sim \\SI{50}{\\micro s}$ to let any population in the non-computational states of the fluxonium to decay to the computational states.\nMany of our measurements specifically involved driving from\u00a0$\\ket{1}$ to\u00a0$\\ket{2}$ on a particular fluxonium (we include transitions such as\u00a0$\\ket{101} \\leftrightarrow \\ket{111}$, $\\ket{101} \\leftrightarrow \\ket{102}$, and\u00a0$\\ket{101} \\leftrightarrow \\ket{201}$ in this discussion). In these cases, we could greatly enhance the readout contrast by performing a\u00a0$\\pi$-pulse on each fluxonium prior to readout. After this\u00a0$\\pi$-pulse, any population measured in\u00a0$\\ket{0}$ was assumed to be originally\u00a0$\\ket{1}$, and any population measured in\u00a0$\\ket{1}$ was assumed to be originally\u00a0$\\ket{2}$.\n\n## Single-qubit gate calibration\nOur single-qubit gates were performed using standard Rabi oscillations using a cosine envelope without a flat top. For the measurements in fig:1qb, we included a 4ns zero-padding between adjacent pulses. We individually calibrated the\u00a0$X_\\pi$ pulse and derived all other pulses from it. $Y$ pulses were created by adjusting the phase of the\u00a0$X$ pulses, pulses differing from\u00a0$\\pi$ rotation were derived by linearly scaling the pulse amplitude, and\u00a0$Z$ gates were all implemented as virtual-Z gates. While the set of single-qubit gates could be more carefully calibrated by individually calibrating all other gates, we found our single-qubit gates derived from this process were more than sufficient for accurately calibrating our CZ gate.\n\nWe detail the entire calibration sequence used for the\u00a0$X_\\pi$ gate in fig:sup_1qb_cal, with a flowchart provided in fig:sup_1qb_calm. Following an initial rough calibration of the qubit readout, bias voltage, frequency, and\u00a0$\\pi$-pulse amplitude, the following procedure was used to precisely calibrate the qubit.\n\n< g r a p h i c s >\n\nSingle-qubit\u00a0$X_\\pi$ calibration procedure. a-c, g-i Measurement pulse sequences for panels d-f, j-l respectively. d Ramsey vs. bias voltage measurement in order to precisely determine the voltage corresponding to\u00a0$\\Phi_\\text{ext} = \\SI{0.5}{\\Phi_0}$ (termed the `sweet spot'). e Calibrating the readout I and Q coordinates for the fluxonium\u00a0$\\ket{0}$ and\u00a0$\\ket{1}$ states. Thermal population of the qubit results in a mixed state prior to readout. f Low power spectroscopy of the qubit to precisely determine the qubit frequency. j DRAG calibration of the qubit. We played a varying even number of\u00a0$X_\\pi$ pulses with alternating amplitude while also varying the DRAG parameter. When correctly calibrated, each\u00a0$X_\\pi$ pulse cancels out with the subsequent\u00a0$X_{-\\pi}$ pulse. k A separate DRAG calibration but using a larger number of pulses to calibrate the DRAG parameter more accurately. l A pulse train consisting of an odd number of\u00a0$X_\\pi$ pulses was used to precisely calibrate the amplitude of the pulse. m Calibration flowchart for single-qubit gates. Panels are shown for all calibrations starting from the `Precise sweet spot' calibration.\n\n* Precise sweet-spot calibration [fig:sup_1qb_cala,\u00a0d]. With fixed drive frequency (slightly negatively detuned from the qubit frequency) and fixed drive amplitude, Ramsey oscillations were obtained as a function of flux around the sweet spot. The oscillation frequencies were fit to a parabola, and the center of the parabola fit was used as the bias voltage corresponding to\u00a0$\\Phi_\\text{ext} = \\SI{0.5}{\\Phi_0}$, termed the `sweet spot'.\n\n* Single-shot readout calibration [fig:sup_1qb_calb,\u00a0e]. Although optimizing the readout does not impact the gate fidelity, we re-measured the locations of the single-shot blobs corresponding to\u00a0$\\ket{0}$ and\u00a0$\\ket{1}$ here to correct for flux-related changes in the readout signal.\n\n* Precise qubit frequency calibration [fig:sup_1qb_calc,\u00a0f]. To accurately obtain the qubit frequency, we performed qubit spectroscopy with a low enough power such that little power broadening was observed. This typically gave kHz-level precision, a sufficient starting point for DRAG.\n\n* Derivative Removal by Adiabatic Gate (DRAG) calibration [fig:sup_1qb_calg-h,\u00a0j-k]. While scanning the DRAG parameter, we performed a train of\u00a0$\\pi$-pulses with alternating positive and negative amplitudes. The DRAG parameter which minimized the observed oscillation between the\u00a0$\\ket{0}$ and\u00a0$\\ket{1}$ state was chosen. This measurement may be repeated with a larger number of pulses to increase the resolution of the DRAG parameter. Contrary to other fluxonium experiments\u00a0[Bao, Feng, Deng, Hao, Ding, Dawei, Gao, Ran, Gao, Xun, Huang, Cupjin, Jiang, Xun, Ku, Hsiang-Sheng, Li, Zhisheng, Ma, Xizheng, others, \"Fluxonium: an alternative qubit platform for high-fidelity operations\", 2022] [Somoroff, Aaron, Ficheux, Quentin, Mencia, Raymond A, Xiong, Haonan, Kuzmin, Roman V, Manucharyan, Vladimir E, \"Millisecond coherence in a superconducting qubit\", 2021], we found DRAG calibration necessary to avoid coherent additional errors. We measured the optimal DRAG parameter to vary depending on the room temperature filtering scheme and not with the anharmonicity of the qubit, which leads us to suspect the calibration was correcting for small distortions in the drive line\u00a0[Gustavsson, Simon, Zwier, Olger, Bylander, Jonas, Yan, Fei, Yoshihara, Fumiki, Nakamura, Yasunobu, Orlando, Terry P, Oliver, William D, \"Improving quantum gate fidelities by using a qubit to measure microwave pulse distortions\", 2013].\n\n* Precise drive amplitude calibration [fig:sup_1qb_cali,\u00a0l]. To improve the precision of a single Rabi oscillation, we utilized a pulse train with an odd number of pulses while varying the pulse amplitude. This serves to multiply the oscillation frequency by the number of pulses used, allowing for increased precision on the calibrated\u00a0$\\pi$-pulse amplitude.\n\nAfter calibration, we benchmarked our single-qubit gates using standard single-qubit randomized benchmarking\u00a0[Magesan, Easwar, Gambetta, Jay M, Emerson, Joseph, \"Scalable and robust randomized benchmarking of quantum processes\", 2011] [Barends, Rami, Kelly, Julian, Megrant, Anthony, Veitia, Andrzej, Sank, Daniel, Jeffrey, Evan, White, Ted C, Mutus, Josh, Fowler, Austin G, Campbell, Brooks, others, \"Superconducting quantum circuits at the surface code threshold for fault tolerance\", 2014]. In our randomized benchmarking, we applied a sequence of random Clifford gates (decomposed into microwave gates\u00a0${\\{I,\\, \\pm X,\\, \\pm Y,\\, \\pm X_{\\pi/2},\\, \\pm Y_{\\pi/2}\\}}$) followed by a recovery gate which inverts the previous sequence and then measure the probability the qubit remains in its initial state (we arbitrarily choose\u00a0$\\ket{0}$). As a function of Clifford sequence length, this probability was fit to the exponential decay:\u00a0${p_0(m) = A p^m + B}$. In this model, $A$ and\u00a0$B$ absorb the effects of state preparation and measurement (SPAM) errors, and\u00a0$p$ is the depolarizing parameter. The average fidelity of each Clifford operation is given by\u00a0$F_\\text{Clifford} = 1 - (1 - 1/d)(1 - p)$, where\u00a0$d=2^\\text{number of qubits}$ is the size of the Hilbert space. Our specific decomposition of Clifford gates into microwave single-qubit gates uses, on average, 1.875 gates per Clifford. From this, we compute the average single-qubit gate fidelity as\n$$\n\nF_\\text{single-qubit} = 1 - (1 - 1/d)(1 - p) / 1.875.\n\n$$\nThe uncertainty on the fidelity is expressed as a standard error of the mean, which was obtained by setting  to be  in  and using standard error propagation techniques. Error bars on individual RB points are likewise standard errors, obtained by dividing the standard deviation by the square root of the number of randomizations.\n\n## Leakage transitions\nDriving a single transition in a system of uncoupled qubits is generally equivalent to a single-qubit rotation of some kind. For our CZ gate, such a transition is only entangling provided no other transitions from other initial states are also being driven. This is only possible when coupling terms adjust the energy levels involved in these transitions. To map out the landscape of the relevant higher-level transitions, we performed two-tone spectroscopy as a function of the coupler flux, heralding different initial states:\u00a0$\\ket{000}$, $\\ket{100}$, $\\ket{001}$, and\u00a0$\\ket{101}$ [fig:sup_sidebands]. As demonstrated in the main text, any transition in fig:sup_sidebandsd could be used to perform the CZ gate, provided it is sufficiently detuned from any transitions involving the other initial states. Equivalently, though not explored in this work, a CZ gate could be performed by driving selective transitions from a different initial state and then performing appropriate\u00a0$Z$ rotations to transfer the\u00a0$180^\\circ$ conditional phase shift onto the\u00a0$\\ket{11}$ state.\n\n< g r a p h i c s >\n\nTwo-tone spectroscopy of the higher energy levels of the FTF system. Panels a-d consist of the same spectroscopy run post-selecting for\u00a0$\\ket{000}$, $\\ket{100}$, $\\ket{001}$, or\u00a0$\\ket{101}$ respectively.\n\nWhile including a coupler increases the number of parasitic transitions that must be avoided, the larger level repulsions made possible by the coupler increase many relevant detunings. In our devices, many operational points exist where the nearest unwanted transition is more than 100MHz detuned.\n\n## Relative drive amplitude and phase calibration\nIn this section, we describe a leakage cancellation protocol utilizing destructive interference of the two drives; however, we note that a difference in gate fidelity could not be observed using this method. As a result, for the data in fig:map_specc, a simpler procedure was implemented to save calibration time: the relative drive phase was tuned to constructively interfere at the desired transition, and the relative amplitudes were kept equal. Despite this fact, we include the information here for transparency on what was attempted to improve gate fidelities.\n\nIn driving our desired transition, off-resonant parasitic transitions always contribute to leakage. With two separate charge drive lines in our device, we can tune each drive line's relative phase and amplitudes for complete destructive interference on a parasitic transition of our choosing, while retaining a nonzero drive on our gate transition. Without loss of generality, we take\u00a0$\\ket{101} \\leftrightarrow \\ket{111}$ to be our CZ gate transition and\u00a0$\\ket{100} \\leftrightarrow \\ket{200}$ to be the closest parasitic transition that we'd like to eliminate. We model the pulse seen by the qubits\u00a0$i \\in \\{1, 2\\}$ as\n\n$$\n\n\\text{Pulse}_i(t) = A_i \\cos(\\omega t + k x_i + \\phi_i),\n\n$$\nwhere\u00a0$A_i > 0$ is the pulse amplitude,\u00a0$\\omega$ is the angular frequency,\u00a0$k$ is the wavenumber of the pulse,\u00a0$x_i$ is the effective distance from each pulse's origin to its destination, and\u00a0$\\phi_i$ is an additional constant phase offset of each pulse, specified in software.\n\nThe Rabi frequency of the undesired transition can then be written as\n$$\n\n\\bra{200}\\hat{H}\\ket{100} \\propto \\sum_i A_i \\cos(\\omega t + k x_i + \\phi_i) \\bra{200}\\hat{n}_i\\ket{100}\n\n$$\nFor this matrix element to be zero for all times, we require the two pulses to be\u00a0$180^\\circ$ out of phase with each other with equal effective amplitudes. Mathematically, these two conditions are satisfied by specifying the relative phase and amplitude of the two drives:\n$$\n\n\\phi_2 - \\phi_1 &= \\pi - k(x_2 - x_1)\\label{eq:phase} \\\\\n\\frac{A_2}{A_1} &= \\frac{\\bra{200}{\\hat n_1}\\ket{100}}{\\bra{200}{\\hat n_2}\\ket{100}}, \\label{eq:amplitude}\n\n$$\nWe note that since\u00a0$\\bra{200}\\hat n_1\\ket{100}/\\bra{200}\\hat n_2\\ket{100}$ is generally not equal to\u00a0$\\bra{111}\\hat n_1\\ket{101}/\\bra{111}\\hat n_2\\ket{101}$, these conditions are not expected to provide complete destructive interference on our main transition of interest.\n\nExperimentally, our procedures for calibrating\u00a0$A_2/A_1$ and\u00a0$\\phi_2 - \\phi_1$ are illustrated in fig:sup_microwave_crosstalk. In all measurements for this calibration, we\u00a0$\\pi$-pulsed both fluxonium qubits before readout as discussed in appendix:readout to increase signal contrast.\nWe initially started with two arbitrarily amplitudes\u00a0$A_1, A_2$, and then scanned the phase difference\u00a0$\\phi_2 - \\phi_1$ (varying\u00a0$\\phi_2$ with\u00a0$\\phi_1$ fixed) while measuring the\u00a0$\\ket{100} \\leftrightarrow \\ket{200}$ Rabi oscillation (on resonance) [fig:sup_microwave_crosstalka, c]. With the value of\u00a0$\\phi_2 - \\phi_1$ set to minimize the oscillation rate (dashed line),\u00a0$A_2 / A_1$ was scanned (varying\u00a0$A_2$ with\u00a0$A_1$ fixed) while measuring the same Rabi oscillation [fig:sup_microwave_crosstalkb, d]. The slowest Rabi oscillation (dashed line) was then used to choose the optimal value of\u00a0$A_2 / A_1$. Furthermore, as motivated by eq:amplitude, this ratio is independent of frequency and thus didn't require further calibration. On the other hand, we were interested in the phase which caused destructive interference when driving at our two-qubit gate frequency, not at the\u00a0$\\ket{100} \\leftrightarrow \\ket{200}$ resonance. This required calibrating for the phase dispersion caused by cable length differences. By repeating the relative phase calibration in a frequency bandwidth in which the\u00a0$\\ket{100} \\leftrightarrow \\ket{200}$ Rabi oscillation was still visible, we uncovered an expected linear dispersion [fig:sup_microwave_crosstalke], which we extrapolated as a function of drive frequency.\n\n< g r a p h i c s >\n\nRelative drive amplitude and phase calibration. a, b Pulse sequences for (d-f) respectively.\u00a0$\\pi$-pulses before measurement are purely for increasing signal contrast. c Rabi oscillation of the unwanted transition with a phase-locked drive on each charge line. The phase difference was scanned to show destructive (white dashed line) and constructive interference. d With\u00a0$\\phi_2 - \\phi_1$ specified to give destructive interference, the relative amplitudes of the two drives were scanned for complete destructive interference (white dashed line). e The value of\u00a0$\\phi_2 - \\phi_1$ that gave destructive interference was extracted as a function of drive frequency. The linear fit is motivated by a cable length difference. f Calibration flowchart for the illustrated procedure.\n\n## Two-qubit gate calibration\nPrior to a fine calibration of our CZ gate, we would first calibrate single-qubit gates (appendix:single_qubit) and the relative drive parameters (appendix:microwave_crosstalk). Specifically, when calibrating the CZ gate, we increased the pulse width of the single-qubit gates to 50ns, trading off single-qubit gate fidelities so that coherent errors would not skew our tomography pulses. We also increased the padding between pulses to 10ns because computational state lifetimes have only a secondary effect on our CZ gate fidelities.\n\nFor a given pulse width and gate transition, the remaining four parameters to be calibrated are the drive frequency, overall drive amplitude, and the single-qubit phase accumulations during our gate interaction. After performing spectroscopy of the transition in interest, we iteratively fine-tuned the drive amplitude and frequency. The drive amplitude was calibrated by performing a simple Rabi oscillation and minimizing the leakage [fig:sup_2qb_cala, d]. According to our error budget outlined in appendix:error, a single CZ pulse yields a sufficiently precise calibration. The drive frequency was calibrated by performing a Ramsey-like measurement on qubit 1 to measure its phase accrual after a pulse-train of CZ gates, depending on whether or not qubit 2 started in\u00a0$\\ket{0}$ or\u00a0$\\ket{1}$ [fig:sup_2qb_calb, e]. The difference in this phase accrual was tuned to be\u00a0$180^\\circ$, though we note that controlled-phase gates of variable angles could also be achieved. Since adjusting the drive frequency slightly changes the amplitude corresponding to a single period and vice-versa, we alternately performed these two calibrations three times in total. In practice, we found this was sufficiently accurate and much faster than performing a two-dimensional calibration for both parameters simultaneously. Finally, once the CZ interaction was properly tuned, we measured the single-qubit phase accumulation during the CZ interaction using the same Ramsey-like measurement [fig:sup_2qb_calc, f]. These\u00a0$Z$-rotations were corrected for in software through virtual-$Z$ gates. We illustrate the complete flowchart of this calibration in fig:sup_2qb_calg.\n\n< g r a p h i c s >\n\nCZ Gate calibration procedure. a-c Pulse sequences for d-f respectively. The double arrow in (c) indicates that the same pulse sequence was performed twice, with qubits 1 and 2 exchanged. d Calibrating the global amplitude of the CZ drive by minimizing the leakage. e Calibrating the frequency of the CZ drive by measuring a conditional phase accumulation via Ramsey-like measurements. Each gate should contribute a\u00a0$180^\\circ$ conditional phase shift. f Measuring the single-qubit phase accumulations per CZ gate using the same Ramsey-like measurements. g Graphical illustration of the full two-qubit calibration routine. When recalibrating the system for small flux drifts or periodic check-ins, we found it unnecessary to recalibrate the relative drive amplitude or phase.\n\nTo benchmark our CZ gate, we performed two-qubit interleaved randomized benchmarking, in which Clifford gates were sampled from the two-qubit Clifford group, generated by\u00a0${\\{I,\\, \\pm X,\\, \\pm Y,\\, \\pm X_{\\pi/2},\\, \\pm Y_{\\pi/2},\\, \\text{CZ}\\}}$. Our specific decomposition results in 8.25 single-qubit gates and 1.5 CZ gates per Clifford.\n\nInterleaved randomized benchmarking consists of two steps: (1) performing standard randomized benchmarking, in which we extract the depolarizing parameter by measuring sequence fidelity with initial state\u00a0$\\ket{00}$ and fitting to the decay\u00a0${p_{00} = A p^m + B}$. (2) Performing the same standard randomization benchmarking sequence, except an additional CZ gate is inserted between each pair of Cliffords, and the final recovery gate is modified accordingly. Fitting this decay gives\u00a0$p_\\text{int}$, the interleaved depolarizing parameter. By comparing the relative decays between the two steps, the average CZ gate fidelity is extracted as\n$$\n\nF_\\text{CZ} = 1 - (d - 1)(1 - p_\\text{int}/p)/d,\n\n$$\nand its uncertainty is once again represented as a standard error, following the procedure of appendix:single_qubit.\n\n## Reinforcement learning\nAs described in the main text, we used a model-free reinforcement learning agent to boost the gate fidelity beyond the physics-based calibration described in the previous section.\nSpecifically, we used an algorithm known as proximal policy optimization (PPO).\n\nApplication of reinforcement learning to quantum control has been discussed in detail in the literature.\nHere, we closely followed the procedure discussed in\u00a0[Sivak, V. V., Eickbusch, A., Liu, H., Royer, B., Tsioutsios, I., Devoret, M. H., \"Model-Free Quantum Control with Reinforcement Learning\", 2022] and implemented in\u00a0[Sivak, V. V.\nand Eickbusch, A.\nand Royer, B.\nand Singh, S.\nand Tsioutsios, I.\nand Ganjam, S.\nand Miano, A.\nand Brock, B. L.\nand Ding, A. Z.\nand Frunzio, L.\nand Girvin, S. M.\nand Schoelkopf, R. J.\nand Devoret, M. H., \"Real-time quantum error correction beyond break-even\", 2023], with code adapted from\u00a0[Sivak, V., \"quantum-control-rl\", 2022] and built on TF-Agents. As seen in fig:fidelitiesb-c, each round of training used 300 epochs and lasted roughly 75 minutes. We found the $\\sim$15 second training time per epoch to be almost completely dominated by AWG waveform upload time, which took over 12 seconds for the data shown in fig:fidelities. As updating the agent's policy according to PPO took comparably less time (less than 1 second), we elected to simply run PPO on the measurement computer instead of, for example, a separate computer equipped with a GPU.\nSince averaging was also relatively inexpensive compared to pulse upload time, we also elected to average the measurement results for each trial pulse 1000 times.\n\nReinforcement learning parameters. Hyper-parameters of the PPO algorithm used to optimize the CZ gate.\n\nLearning rate     0.01\n\nNumber of policy updates     20\n\nImportance ratio clipping     0.1\n\nBatch size     30\n\nNumber of averages     1000\n\nValue prediction loss coefficient       0.005\n\nGradient clipping     1.0\n\nLog probability clipping     0.0\n\n## CZ Gate vs. flux\nfig:sup_rb_vs_flux shows an alternate plotting of the data in fig:map_specc, illustrating more explicitly what frequencies each calibrated gate corresponds to.\nAs mentioned in the main text, each plot was created from a fully-automated measurement across 21 linearly spaced values of the coupler flux.\nWhile many calibrated points have low fidelity, the most important aspect of this architecture is that there exist multiple transitions for which high fidelity is achievable, allowing flexibility in the operation frequency.\nNevertheless, we discuss the most common failure mechanisms and reasons for low fidelity to shed additional insights on the limits of our automated calibration versus the inherent limit of the transition being driven.\n\n< g r a p h i c s >\n\nAlternate plotting of the data in fig:map_specc. Gate fidelities with a fixed 100ns pulse width as a function of the coupler flux for Device A a and Device B b. The drive frequency is plotted in gray, represented on the right axis. All points missing from the full set of 21 correspond to more severe calibration failures.\n\nThe most common reason for low-performance operation points was nearby unwanted transitions, leading to a high amount of leakage. This is most evident in Device A, in which the\u00a0$\\ket{101}\\leftrightarrow\\ket{111}$ transition at\u00a0$\\Phi_\\text{ext,c} = \\SI{1.0}{\\Phi_0}$, and the\u00a0$\\ket{101}\\leftrightarrow\\ket{102}$ transition at\u00a0$\\Phi_\\text{ext,c} = \\SI{0.5}{\\Phi_0}$ are furthest detuned from their nearest unwanted transition, resulting in higher fidelities in these regions. Where these unwanted transitions have a much smaller detuning, we expect to obtain higher fidelities by increasing the drive pulse beyond 100ns. In other regions, we expect higher fidelities by decreasing the gate time.\n\nA second common mechanism for failed calibration was the inability to find a drive frequency corresponding to a\u00a0$180^\\circ$ conditional phase shift. Due to the large hybridization, we occasionally measured ac-Stark shifts large enough to counter-balance the natural change in the conditional-phase angle as a function of drive detuning. The calibration could be recovered by either using a slower gate or by adjusting the relative drive amplitudes to tweak the total ac-stark shift.\n\nOther less common mechanisms for a failed calibration include TLSs or accidental resonances with undesired transitions, including higher-photon transitions.\n\nfig:sup_coherence_vs_flux_D1 shows the individual qubit coherence times as a function of the local coupler flux in Device A. Each coherence time was simultaneously measured on each qubit, with both qubits precisely re-tuned to\u00a0$\\Phi_\\text{ext} = \\SI{0.5}{\\Phi_0}$ for each value of the coupler flux. Notably, these coherence times are slightly shorter than those listed in tab:hamiltonian, due to bias-induced heating of the local flux lines. However, these coherence times are a more accurate representation of the quality of the qubits when performing two-qubit gates and simultaneous single-qubit gates.\nWhen performing simultaneous single-qubit gates, we biased the coupler at roughly\u00a0$\\Phi_\\text{ext,c} = \\SI{0.77}{\\Phi_0}$, corresponding to no current being sent through the coupler flux line. We suspect the low Ramsey time of qubit 2 to be caused by Aharonov-Casher dephasing from coherent quantum phase slips\u00a0[Di Paolo, Agustin, Baker, Thomas E, Foley, Alexandre, S\u00e9n\u00e9chal, David, Blais, Alexandre, \"Efficient modeling of superconducting quantum circuits with tensor networks\", 2021] [Mizel, Ari, Yanay, Yariv, \"Right-sizing fluxonium against charge noise\", 2020], based on its Hamiltonian parameters.\n\n< g r a p h i c s >\n\nQubit coherences in Device A with both qubits biased at 0.5\u03a6_0. Panels a, b, c show the\u00a0$T_1$, Ramsey, and echo decay times respectively as a function of the coupler flux. All decays were fit to an exponential and measurements were performed over a 12hour period.\n\n## Error modeling\nIn this section, we build up an analytic error budget to estimate the impact of various types of coherent and incoherent errors on gate fidelities. We model our gates as a completely positive trace-preserving (in some subspace) map\u00a0$\\mathcal{G}$ acting on an input state\u00a0$\\rho$. The Kraus representation theorem then allows us to express all such processes as\u00a0$\\mathcal{G}(\\rho) = \\sum_k G_k \\rho G_k^\\dagger$ for some set of Kraus operators\u00a0$G_k$ obeying the normalization condition\u00a0$\\sum_k G_k^\\dagger G_k = I$. The average state fidelity of such a process\u00a0$\\mathcal{G}$ is then given by\n\n$$\n\\label{eq:average_state_fidelity}\nF = \\frac{1}{n(n+1)} \\left[\\text{Tr}\\left(\\sum_k M_k^\\dagger M_k\\right) + \\sum_k |\\text{Tr}(M_k)|^2 \\right],\n\n$$\nwhere\u00a0$M_k = P U_0^\\dagger G_k P$, and\u00a0$n$ is the dimension of the computational subspace\u00a0[Pedersen, Line Hjortsh\u00f8j, M\u00f8ller, Niels Martin, M\u00f8lmer, Klaus, \"Fidelity of quantum operations\", 2007]. Also,\u00a0$P$ is the projection operator onto the computational subspace, and\u00a0$U_0$ is the ideal unitary operation of the process. We reproduce here the error corresponding to relaxation ($T_1$) and pure (Markovian) dephasing ($T_\\phi$) corresponding to a gate of length\u00a0$t_g$.\n$$\n\nF_\\text{1 qubit} = 1 - \\frac{t_g}{3}\\left(\\frac{1}{T_1} + \\frac{1}{T_\\phi}\\right)\n\n$$\n\n$$\n\nF_\\text{2 qubits} = 1 - \\frac{4 t_g}{5}\\left(\\frac{1}{T_1} + \\frac{1}{T_\\phi}\\right)\n\n$$\nOne critical assumption in these well-known formulas is that the gate operation stays within the computational subspace, an invalid assumption for our two-qubit gate.\n\n### Relaxation of higher energy levels\nIn our two-qubit gate, there are five relevant states: the computational states\u00a0$\\{\\ket{00}, \\ket{01}, \\ket{10}, \\ket{11}\\}$ and the non-computational state we drive to\u00a0$\\ket{\\alpha}$. For mathematical simplicity, we imagine modeling an identity gate composed of two CZ gates. The error per unit time will not change, and this allows us to use\u00a0$U_0 = I$ as well as simplifies the phases in our Kraus operators. We model the incoherent decay under driven evolution as if\u00a0$\\ket{11}$ and\u00a0$\\ket{\\alpha}$ decay into each other at equivalent rates (a valid assumption when the gate time\u00a0$t_g$ is small compared to the relaxation rate\u00a0$T_{1,\\alpha}$). Assuming no other decay channels, the full set of Kraus operators for this process is\n\n$$\n\nG_0 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & 0 & e^{-t/2T_1}\n\\end{pmatrix}\n\n$$\n\n$$\n\n\\hspace{1em} G_1 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix}\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & \\sqrt{1 - e^{-t/T_1}}\\\\\n0 & 0 & 0 & 0 & 0\n\\end{pmatrix}\n\n$$\n\n$$\n\nG_2 = \\frac{1}{\\sqrt{2}} \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & e^{-t/2T_1} & 0\\\\\n0 & 0 & 0 & 0 & 1\n\\end{pmatrix}\n\n$$\n\n$$\n\nG_3 = \\frac{1}{\\sqrt{2}}\n\\begin{pmatrix}\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & 0 & 0\\\\\n0 & 0 & 0 & \\sqrt{1 - e^{-t/T_1}} & 0\n\\end{pmatrix}\n\n$$\nOne can verify the behavior of these operators by computing that\u00a0${\\bra{11}\\mathcal{G}(\\rho)\\ket{11} = \\frac{\\rho_{11} + \\rho_{\\alpha}}{2} + \\frac{\\rho_{11} - \\rho_\\alpha}{2} e^{-t/T_{1,\\alpha}}}$. Finally, we take the projection operator to be\u00a0$P = \\ketbra{00} + \\ketbra{01} + \\ketbra{10} + \\ketbra{11}$. Inserting these operators into eq:average_state_fidelity and Taylor expanding in\u00a0$t_g / T_{1, \\alpha} < 1$, we obtain\n$$\n\nF \\approx 1 - \\frac{1}{8} \\frac{t_g}{T_{1,\\alpha}}.\n\n$$\n\n### CZ phase error\nWe consider an error in phase calibration, in which we successfully return all population back to the computational subspace, but with a\u00a0$\\ket{11}$ state phase of\u00a0$\\pi + d\\phi$. In the unitary special case of eq:average_state_fidelity ($\\mathcal{G}(\\rho) = U \\rho U^\\dagger$), we need only compute\n$$\n\nM &= U_0^\\dagger U\\\\\n&=\n\\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & -1\n\\end{bmatrix}\n\\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & e^{-i \\pi - i d\\phi}\n\\end{bmatrix}\\\\\n&=\n\\begin{bmatrix}\n1 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0\\\\\n0 & 0 & 1 & 0\\\\\n0 & 0 & 0 & e^{- i d\\phi}\n\\end{bmatrix}.\n\n$$\nInserting this into eq:average_state_fidelity, we obtain\n$$\n\nF = \\frac{7 + 3\\cos(d\\phi)}{10} \\approx 1 - \\frac{3}{20}d\\phi^2.\n\n$$\nValues of note are that for a fidelity of 99.9\nWe can similarly convert this into an error on drive frequency, assuming the drive frequency is the sole degree of freedom in tuning the aforementioned phase. The geometric phase accumulation associated with some frequency change\u00a0$\\delta$ of a full-period driven oscillation is\u00a0$\\delta t_g/2$. The angle errors above then translate into 0.5MHz error for 99.9\n\n### Amplitude error\nIn calibrating the Rabi oscillation driving our CZ gate, we chose a fixed gate time and calibrated the amplitude of the pulse to obtain a single-period oscillation. The unitary corresponding to this Rabi rotation in our five-state Hilbert space\u00a0$\\{\\ket{00}, \\ket{01}, \\ket{10}, \\ket{11} \\ket{\\alpha}\\}$ is\n\n$$\n\nU = \\begin{pmatrix}\n1 & 0 & 0 & 0 & 0\\\\\n0 & 1 & 0 & 0 & 0\\\\\n0 & 0 & 1 & 0 & 0\\\\\n0 & 0 & 0 & \\cos(\\Omega t / 2) & -i \\sin(\\Omega t / 2)\\\\\n0 & 0 & 0 & -i \\sin(\\Omega t / 2) & \\cos(\\Omega t / 2)\\\\\n\\end{pmatrix}\n\n$$\n\nwhere\u00a0$\\Omega$ is the Rabi oscillation of the CZ pulse. Projecting onto the computational subspace ($P$) and assuming an ideal CZ unitary\n$$\n\nU_0 = \\ketbra{00} + \\ketbra{01} + \\ketbra{10} - \\ketbra{11},\n\n$$\nwe insert\u00a0$M = P U_0^\\dagger U P$ into\u00a0eq:average_state_fidelity to obtain\n$$\n\nF = \\frac{1}{10}(6 - 3\\cos(\\Omega t / 2) + \\cos^2(\\Omega t / 2)) \\approx 1 - \\frac{1}{16} d\\theta^2.\n\n$$\nConverting this amplitude error into a phase error\n${d\\theta = \\Omega t - 2\\pi}$, 99.9\n\nWe conclude this section by emphasizing that at the error levels discussed, calibration precision is quite lenient and that errors will be dominated by decoherence and other unmodeled behavior such as leakage through neighboring transitions. Furthermore, all calculations performed are meant to model the fidelity of a single-gate, which may not necessarily be equal to the fidelity extracted from interleaved randomized benchmarking due to the nature of coherent errors.\n\n## Device B\nIn this section, we show data corresponding to Device B, a secondary device. Device B is an identically designed device, with extracted Hamiltonian parameters varying by up to 10\n\nWe measured a nearly identical value (within 1kHz) of the\u00a0$ZZ$ interaction rate in this device [fig:sup_other_devicec], supporting our claim that the\u00a0$ZZ$ reduction does not rely on any precise parameter matching and is a reliable method to achieve (absolute) values below 10kHz. Most importantly, despite changes of up to 300MHz in the\u00a0$\\ket{1} \\leftrightarrow \\ket{2}$ transition frequencies of the fluxonium qubits, we could still demonstrate high-fidelity CZ gates across a large frequency range [see fig:map_specc in the main text], with peak fidelities above 99.8\n\n< g r a p h i c s >\n\nSelected data from Device B. a  Repeated\u00a0$T_1$ measurements of fluxonium\u00a02 over a roughly nine-hour time span. The dashed blue line indicates the median\u00a0$T_1$ of 1.26ms, and the blue shaded region encompasses\u00a0$\\pm 1$ standard deviations.  b Individual (I) and simultaneous (S) randomized benchmarking for both qubits, varying the width of a cosine pulse envelope. c Measured\u00a0$ZZ$-interaction strength as a function of the coupler flux. d Spectroscopy of the non-computational states which activate the two-qubit gate. e CZ fidelities with varying pulse width, driving the\u00a0$\\ket{101}\\leftrightarrow\\ket{111}$ transition at\u00a0$\\Phi_\\text{ext,c} = 0.063$. f Reference and interleaved randomized benchmarking traces averaged over 20 randomizations for a pulse width of 60ns.\n\n"}
{"prompt": "What are the key contributions of the paper 'Preserving coherent spin and squeezed spin states of a spin-1 Bose-Einstein condensate with rotary echoes'?", "completion": "\n\napsrev\n\n# Preserving coherent spin and squeezed spin states of a spin-1 Bose-Einstein condensate with rotary echoes\n\nSchool of Physics and Technology, Wuhan University, Wuhan, Hubei 430072, China\nBeijing Computational Science Research Center, Beijing 100084, China\n\nSchool of Physics and Technology, Wuhan University, Wuhan, Hubei 430072, China\n\nSchool of Physics and Technology, Wuhan University, Wuhan, Hubei 430072, China\n\n[Corresponding email: ]wxzhang@whu.edu.cn\nSchool of Physics and Technology, Wuhan University, Wuhan, Hubei 430072, China\n\nA challenge in precision measurement with squeezed spin state arises from the spin dephasing due to stray magnetic fields. To suppress such environmental noises, we employ a continuous driving protocol, rotary echo, to enhance the spin coherence of a spin-1 Bose-Einstein condensate in stray magnetic fields. Our analytical and numerical results show that the coherent and the squeezed spin states are preserved for a significantly long time, compared to the free induction decay time, if the condition $h\\tau = m\\pi$ is met with $h$ the pulse amplitude and $\\tau$ pulse width. In particular, both the spin average and the spin squeezing, including the direction and the amplitude, are simultaneously fixed for a squeezed spin state. Our results point out a practical way to implement quantum measurements based on a spin-1 condensate beyond the standard quantum limit.\n\n03.75.Mn, 03.67.Pp, 76.60.Lz\n\n## Introduction\nPrecision measurement with quantum entanglement and squeezed quantum state has the merit of measurement beyond the standard quantum limit\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. A spinor Bose-Einstein condensate (BEC) provides such a potential opportunity for quantum metrology with its wonderful controllability and fine-tuning in practical experiments\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, dephasing due to the stray magnetic fields in laboratories prevents the spinor BEC from wider applications and higher precisions, such as the quantum many-body ground state of an antiferromagnetic spin-1 BEC\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Suppressing the environmental noises such as the stray magnetic field becomes a long-standing challenge for quantum metrology and many-body quantum phase transition experiments utilizing spinor BECs\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nMany theoretical and experimental investigations have contributed to the suppressing of the stray magnetic fields. Some of these ideas are borrowed from the fields of nuclear magnetic resonance and quantum information and computation, such as the quantum error correction and dynamical decoupling with hard pulses\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. For a spinor BEC system, there are also a few unique methods, such as the magnetic shield room, active compensation, and the spin Hahn echo pulse sequences\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. These methods suppressed the stray magnetic fields to a much lower value, e.g., $1$ nT in a recent work by Eto et al.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, such a method is rather costly and the second order Zeeman effect of the strong driving field in the spin Hahn echo would prevent the method from perfect elimination of the noises\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn this paper, we propose to use the dynamical decoupling protocols, rotary echo (RE), with continuous driving pulses in stead of the hard ones in $\\delta$ shape (see Fig.\u00a0(Figure fig:echo) for a comparison), to avoid the error accumulation with time\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nSpecially, for a spinor BEC, the main noise source includes the local phase noise from stray magnetic fields and the radio frequency intensity noise\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The contribution of the magnetic-field gradient is usually negligible due to the advanced experimental controllability and the smallness of the condensate ($\\sim$10$\\mu$m). We apply the RE protocol in a spin-1 BEC, which is dephased by stray magnetic fields, and evaluate the performance of the RE protocol for two interesting condensate spin states, the coherent spin state and the squeezed spin state. We find that the RE protocol extends significantly the coherent time of the system if the continuous-pulse duration is close to its magic values, $\\tau = m\\pi/h$ ($m=1,2,3,\\cdots$) with $h$ the driving field strength. Our results point to a different direction to suppress the stray magnetic field effect in spinor BECs and to utilize the squeezed spin state in quantum metrology beyond the standard quantum limit\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe paper is organized as follows. In Sec.\u00a0<ref>, we describe the spin-1 BEC system and the RE protocol, including the effect of the stray magnetic fields along $z$ axis and the driving field along $x$ axis. In Sec.\u00a0<ref>, we evaluate the performance of the RE protocol in preserving the spin average and the squeezing parameter for two interesting condensate spin states, the coherent spin state and the squeezed spin state. We give conclusions and discussions in Sec.\u00a0<ref>.\n\n## System description and rotary echo protocol\n< g r a p h i c s >\n\n(Color online.) Typical spin trajectories in (a) rotary echo and (b) Hahn echo. The initial spin state is marked by a yellow cross. (a) In a rotary echo, the spin rotates about the total field $h\\hat x + \\omega \\hat z$ during the first and the fourth quarter-cycle $\\tau$, in purple and blue solid lines, respectively; the spin rotates about the total field $-h\\hat x + \\omega \\hat z$ during the second and the third quarter-cycle, in red dashed lines. (b) In a Hahn echo, the spin evolves in a noise magnetic field $\\omega \\hat z$ for a cycle $4\\tau$. At the moments $\\tau$ and $3\\tau$, the spin is rotated for a $\\pi$ angle about $+x$ axis, denoted by red solid lines.\n\n< g r a p h i c s >\n\n(Color online.) Pulse sequence of a RE. The RE is a symmetric sequence consisting of $N$ cycles. Within each cycle, the driving field direction is reversed between $+x$ and $-x$, denoted by $+h$ and $-h$, respectively. The two outer segments are along $+x$ for a duration time $\\tau$ and the inner segment along $-x$ for a duration time $2\\tau$. The period of a single cycle is $T=4\\tau$. After $N$ cycles, the total time is $t=4N\\tau$.\n\nWe consider a spin-1 condensate in a uniform magnetic field ${\\bf B}$ with the Hamiltonian described by [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]\n$$\n\\label{eq:ha}\n% \\nonumber % Remove numbering (before each equation)\n\\hat H &=& \\int\\mathrm{d}{\\bf r}\\left\\{\\hat\\psi_{i}^{\\dag}\\left[-\\frac{\\hbar^{2}}{2M}\\nabla^{2}+V_{ext}({\\bf r})+E_Z\\right]\\hat\\psi_{i} \\right.\\nonumber \\\\\n&& \\left.+ \\frac{c_{0}}{2}\\hat\\psi_{i}^{\\dag}\\hat\\psi_{j}^{\\dag}\\hat\\psi_{j}\\hat\\psi_{i}\n+\\frac{c_{2}}{2}\\hat\\psi_{k}^{\\dag}\\hat\\psi_{i}^{\\dag}(F_{\\gamma})_{ij}(F_{\\gamma})_{kl}\\hat\\psi_{j}\\hat\\psi_{l}\\right\\},\n\n$$\nwhere $i,j,k,l \\in \\{\\pm,0\\}$ with $\\pm,0$ denoting the magnetic quantum numbers $\\pm 1,0$, respectively. Repeated indices are summed. $\\hat \\psi_{i}(\\hat \\psi_{i}^{\\dag})$ is the field operator which annihilates (creates) an atom in the $i$th hyperfine state $|i\\rangle \\equiv |F=1,m_F=i\\rangle$. $M$ is the mass of the atom. Interaction terms with coefficients $c_{0}$ and  $c_{2}$ describe elastic collisions of spin-1 atoms, namely, $c_{0}=4\\pi \\hbar^{2}(a_{0}+2a_{2})/3M$ and $c_{2}=4\\pi \\hbar^{2}(a_{2}-a_{0})/3M$ with $a_{0}$ and $a_{2}$ being the $s$-wave scattering lengths in singlet and quintuplet channels. The spin exchange interaction is ferromagnetic (anti-ferromagnetic) if $c_{2}<0 $ ($>0$). $F_{\\gamma=x,y,z}$ are spin-1 matrices. $E_Z$ denotes the linear Zeeman shift of an alkali-metal atom,\n$E_Z = -g_F \\mu_B {\\bf B}\\cdot {\\bf F}$,\nwhere $g_{F}$ is the Land\u00e9 $g$-factor for an atom with the total angular momentum $F=1$, such as $^{87}$Rb and $^{23}$Na atoms, and $\\mu_{B}$ is the Bohr magneton.\n\nWe rewrite the Hamiltonian $\\hat H$ as the sum of symmetric part $\\hat H_s$ and the nonsymmetric part $\\hat H_a$, i.e., $\\hat H=\\hat H_s+\\hat H_a $, where\n$$\n\n\\hat H_s&=&\\int\\mathrm{d}{\\bf r}\\hat\\psi_{i}^{\\dag}\\left[-\\frac{\\hbar^{2}}{2M}\\nabla^{2}+V({\\bf r})\\right]\\hat\\psi_{i}+ \\frac{c_{0}}{2}\\hat\\psi_{i}^{\\dag}\\hat\\psi_{j}^{\\dag}\\hat\\psi_{j}\\hat\\psi_{i} \\nonumber \\\\\n\\hat H_a&=&\\int\\mathrm{d}{\\bf r}\\left[\\frac{c_{2}}{2}\\hat\\psi_{k}^{\\dag}\\hat\\psi_{i}^{\\dag}(F_{\\gamma})_{ij}(F_{\\gamma})_{kl}\\hat\\psi_{j}\\hat\\psi_{l} +\\hat\\psi_{i}^{\\dag}E_Z\\hat\\psi_{i}\\right]. \\nonumber\n\n$$\nFor $^{87}$Rb or $^{23}$Na condensates, the density-dependent interaction $c_0$ is much larger than the spin-dependent interaction $c_2$; thus $\\hat H_s$ is the dominate part. The condensate wave function $\\phi_i({\\bf r})$ are approximately described by the same wave function $\\phi({\\bf r})$, i.e., single-mode approximation (SMA). Such a wave function is defined by the Gross-Pitaevskii equation through $\\hat H_s$,\n$$\n\n\\left(-\\frac {\\hbar^2}{2M}\\nabla^2+V+c_0n \\right)\\phi({\\bf r})=\\mu\\phi({\\bf r}). \\nonumber\n\n$$\nUnder the condition of SMA, the field operator approximately becomes, at the zero temperature, $\\hat\\psi_i=\\hat a_i\\phi({\\bf r})$, $i=0, \\pm$. Note that $\\hat a_i$ is the the annihilation operator associated with the condensate mode. So the leading part of $\\hat H_s$ and $\\hat H_a$ become\u00a0[Unknown Author, \"Unknown Title\", ]\n\n$$\n\n\\hat H_s&\\approx&\\mu \\hat{N}-c_0'\\hat{N}(\\hat{N}-1)\\equiv H_s \\nonumber \\\\\n\\hat H_a&\\approx& A(\\hat{a}_1^{\\dag}\\hat{a}_1^{\\dag}\\hat{a}_1\\hat{a}_1+\\hat{a}_{-1}^{\\dag}\\hat{a}_{-1}^{\\dag}\\hat{a}_{-1}\\hat{a}_{-1}-\n2\\hat{a}_1^{\\dag}\\hat{a}_{-1}^{\\dag}\\hat{a}_1\\hat{a}_{-1}+2\\hat{a}_1^{\\dag}\\hat{a}_0^{\\dag}\\hat{a}_1\\hat{a}_0+\n2\\hat{a}_{-1}^{\\dag}\\hat{a}_0^{\\dag}\\hat{a}_{-1}\\hat{a}_0+2\\hat{a}_0^{\\dag}\\hat{a}_0^{\\dag}\\hat{a}_1\\hat{a}_{-1}+\n2\\hat{a}_1^{\\dag}\\hat{a}_{-1}^{\\dag}\\hat{a}_0\\hat{a}_0)\\\\\n&& + \\frac{\\sqrt{2}}{2}b_x(\\hat{a}_{0}^{\\dag}\\hat{a}_{1}+\\hat{a}_{1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{-1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{0}^{\\dag}\\hat{a}_{-1})\n+\\frac{\\sqrt{2}}{2i}b_y(\\hat{a}_{1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{0}^{\\dag}\\hat{a}_{-1}-\\hat{a}_{0}^{\\dag}\\hat{a}_{1}-\\hat{a}_{-1}^{\\dag}\\hat{a}_{0})\n+ b_z(\\hat{a}_{-1}^{\\dag}\\hat{a}_{-1}-\\hat{a}_{1}^{\\dag}\\hat{a}_{1})\n\\equiv H_a.\\nonumber\n\n$$\n\nHere $c_0'=(c_0/2)\\int|\\phi({\\bf r})|^4\\mathrm{d}{\\bf r}$, $A=(c_2/2)\\int|\\phi({\\bf r})|^4\\mathrm{d}{\\bf r}$, $\\hat N=\\hat{a}_1^{\\dag}\\hat{a}_1+\\hat{a}_0^{\\dag}\\hat{a}_0+\\hat{a}_{-1}^{\\dag}\\hat{a}_{-1}$\nis the total number of the atoms, and $b_{x,y,z} = -g_F\\mu_B B_{x,y,z}$.\n\nBy defining the angular momentum, i.e.,\n$J_x=\\sqrt{2}/2(\\hat{a}_{0}^{\\dag}\\hat{a}_{1}+\\hat{a}_{1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{-1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{0}^{\\dag}\\hat{a}_{-1})$,\n$J_y=\\sqrt{2}/({2i})(\\hat{a}_{1}^{\\dag}\\hat{a}_{0}+\\hat{a}_{0}^{\\dag}\\hat{a}_{-1}-\\hat{a}_{0}^{\\dag}\\hat{a}_{1}-\\hat{a}_{-1}^{\\dag}\\hat{a}_{0})$,\n\nand $J_z=(\\hat{a}_{-1}^{\\dag}\\hat{a}_{-1}-\\hat{a}_{1}^{\\dag}\\hat{a}_{1})$, the Hamiltonian $H_a$ is rewritten in a simple form,\n$$\n~\\label{eq:ha}\nH_a=A({J^2}-2{N})+{\\bf b}\\cdot {\\bf J} \\nonumber\n\n$$\nwith ${\\bf b} = -g_F\\mu_B {\\bf B}$. The constant term $-2AN$ is omitted since the total atom number $N$ is conserved in experiments. Therefore, the Hamiltonian of the system becomes\n$$\n~\\label{eq:eff}\nH=AJ^2+{\\bf b}\\cdot {\\bf J}.\n\n$$\nFor a ferromagnetic spin-1 condensate, the SMA is valid in a wide range of magnetic fields\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. For such a ferromagnetic state, the total angular momentum $J$ equals to the total number of atoms $N$ at zero magnetic field. When the system is in a noisy environment, for example, in stray magnetic fields, the total magnetic field includes two sources: the applied external magnetic field and the stray magnetic field. In general, the external magnetic field is applied purposely and controlled accurately, but the stray magnetic field is noisy and needs to be suppressed since it usually causes the system to decohere in a short time.\n\nIn order to suppress the stray magnetic field and enhance the coherence of system, we employ the RE sequence as shown in Fig.\u00a0(Figure fig:echo)(a). Compared to the Hahn spin echo[Fig.\u00a0(Figure fig:echo)(b)], the RE shows significant advantages: besides the prevention of the error cumulation after many pulses, the applied magnetic field is much smaller than that in a Hahn echo and the quadratic Zeeman effect can be safely neglected.\n\nFor a typical RE protocol, the direction of the applied magnetic field (or the phase of driving) is periodically reversed between $+x$ and $-x$. As shown in Fig\u00a0(Figure fig:rep), during each cycle, the driving field is along $+x$ for a duration of $\\tau$, then turned to $-x$ for a  duration of $2\\tau$, and turned back to $+x$ subsequently. The cycle period is $T=4\\tau$. The complete Hamiltonian during a RE cycle is described by\n$$\n\\label{eq:ham}\nH_{\\pm}=\\pm hJ_{x}+AJ^{2}+ w J_{z},\n\n$$\nwhere $h$ is the amplitude of the driving field, $\\pm$ indicate the direction of driving field. Here we have assumed the spin interaction is ferromagnetic $c_2<0$ and the minus sign before $H_{\\pm}$ has been omitted without loss of generality. Hence, we consider $h=\\mu_B g_F B_x, A$ and $w=\\mu_B g_F B_z$ positive hereafter, where $B_x$ ($B_z$) is the strength of the driving (stray) magnetic field.\n\n## Suppressing the stray magnetic field effect with rotary echo\nFor a single cycle RE, the time evolution operator is\n$$\n\\label{eq:evl}\nU=e^{-i\\tau H_{+}}e^{-2i\\tau H_{-}}e^{-i\\tau H_{+}}.\n\n$$\nFor a given $w$, the evolution of the system is essentially an $SO(3)$ rotation in spin space; thus the evolution operator can be written as $\\exp{(-i\\theta J_n)}$, where $J_n=\\bf J\\cdot\\bf n$ with $\\bf n$ being the rotation axis and $\\theta$ the rotation angle. From the Hamiltonian Eq. (<ref>), we find  $\\theta=\\tau\\sqrt{h^2+w^2}$ and $J_{n,\\pm}=\\pm n_xJ_x+n_zJ_z$, where $n_x= h/\\sqrt{h^2+w^2}$ and $n_z=w/\\sqrt{h^2+w^2}$. Since it contributes nothing to the rotation, the term $AJ^2$ in the Hamiltonian Eq. (<ref>) is neglected here and reconsidered as needed. It is easy to find the rotation matrix of the outer and the inner segment of the RE cycle (shown in Fig.\u00a0(Figure fig:rep)), respectively,\n$$\n\nR_+&=&\\left(\n\\begin{array}{ccc}\np_1 n_x^2+\\cos \\theta & -n_z \\sin\\theta & n_xn_z p_1  \\\\\nn_z\\sin \\theta & \\cos \\theta & -n_x \\sin \\theta\\\\\nn_xn_z p_1  & n_x \\sin \\theta & p_1 n_z^2+\\cos \\theta \\\\\n\\end{array}\n\\right),\\nonumber\\\\\nR_{-}&=&\\left(\n\\begin{array}{ccc}\np_2 n_x^2+\\cos 2\\theta & -n_z \\sin 2\\theta & -n_xn_z p_2 \\\\\nn_z\\sin 2\\theta & \\cos 2\\theta & n_x \\sin 2\\theta \\\\\n-n_xn_z p_2   & -n_x \\sin 2\\theta & p_2 n_z^2+\\cos 2\\theta \\\\\n\\end{array}\n\\right),\\nonumber\n\n$$\nwhere $p_1 = 1-\\cos\\theta$ and $p_2 = 1-\\cos 2\\theta$. As a RE cycle we consider has a time-reversal symmetry, which cancels all the odd terms proportional to $J_y$ in the average Hamiltonian\u00a0[Unknown Author, \"Unknown Title\", ], only the even terms with $J_x$ and $J_z$ are left. Therefore, the total rotation within the RE cycle is $\\tilde{U}=\\exp(-i\\alpha \\tilde J_n)$ with $\\tilde J_n=\\tilde n_xJ_x+\\tilde n_zJ_z$, and the rotation matrix becomes,\n$$\n\n\\tilde R =\\left(\n\\begin{array}{ccc}\nq_1 \\tilde n_x^2+\\cos \\alpha & -\\tilde n_z \\sin\\alpha & \\tilde n_x\\tilde n_z q_1 \\\\\n\\tilde n_z\\sin \\alpha & \\cos \\alpha & -\\tilde n_x \\sin \\alpha \\\\\n\\tilde n_x\\tilde n_z q_1 & \\tilde n_x \\sin \\alpha & q_1 \\tilde n_z^2+\\cos \\alpha \\\\\n\\end{array}\n\\right)\n\n$$\nwith $q_1 = 1-\\cos \\alpha$. With the relationship $\\tilde R=R_+R_-R_+$, the rotation angle $\\alpha$ and the direction $\\tilde n_x$ and $\\tilde n_z$ are determined\n$$\n\n\\cos \\alpha &=& 1-n_z^4 (1-\\cos 4 \\theta)-4n_x^2n_z^2 (1-\\cos 2 \\theta)~\\label{eq:alpha}\\nonumber \\\\\n\\tilde n_x {\\sin\\alpha} &=& 8 n_xn_z^2 \\sin ^2\\left(\\frac{\\theta}{2}\\right) \\sin \\theta \\left(n_z^2 \\cos 2\\theta +n_x^2\\right)\\nonumber \\\\\n\\tilde n_z^2 &=& 1-\\tilde n_x^2,\n\n$$\nwhere we have defined $\\cos\\beta=n_x$ and $\\sin\\beta=n_z$.\n\nThe single cycle evolution operator Eq.(\u00a0<ref>) eventually becomes a single exponential\n$$\n~\\label{eq:uni}\nU=\\exp[-i\\alpha(\\tilde n_xJ_x+\\tilde n_zJ_z)] \\exp(-i4\\tau AJ^2).\n\n$$\nIt is then straightforward to obtain the full $N$-cycle evolution operator\n$$\n~\\label{eq:uni2}\nU(t=4N\\tau)=\\exp[-i(\\lambda J_x+\\gamma J_z+4N\\tau A J^2)],\n\n$$\nwith $\\lambda=N\\alpha \\tilde n_x$ and $\\gamma=N\\alpha \\tilde n_z$.\n\nIn the analytical result Eq.\u00a0(<ref>), if $\\theta = m\\pi$ ($m=1,2,3,\\cdots$), $\\cos\\alpha=1$, thus $\\alpha=0$ and the evolution operator $U$ becomes unity, which indicates that the given magnetic field effect is exactly canceled by the RE sequence.\n\nHere we emphasize that the spin interaction term $AJ^2$ in Eq.\u00a0(<ref>) can not be excluded from the Hamiltonian of the BEC system, though it has no contribution to the results of our calculation. First, $AJ^2$ is a natural ingredient of the spinor BEC, which is often used to generate a special squeezed spin state, a twin-Fock state\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Second, we consider a ferromagnetic interaction $c_2<0$ so that a ferromagnetic coherent state (the ground state of the system) is stable and useful for a practical magnetometer. In addition, the RE driving field and the stray magnetic fields are small enough to omit their quadratic Zeeman effect; thus there is no necessity to consider the spin mixing dynamics of the driven spinor BEC\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn the following, we will numerically examine the performance of the RE sequence for two most interesting states: the coherent spin state (CSS) and the squeezed spin state (SSS). We will monitor the spin average for both states and the squeezing parameter for the SSS.\n\n### Coherent spin states\n< g r a p h i c s >\n\n(Color online.) Spin average evolution under REs for $\\tau=0.05$ (red diamonds), 0.1 (blue crosses), 0.12 (black squares), 0.14 (cyan hexagons), and 0.17 (green asterisks) with $h=20$. The blue circles are for $\\tau = \\pi/h$ with $h=20$. The FID is denoted with purple triangles. The solid lines, coinciding with the marks, are the corresponding analytical predictions by Eq.\u00a0(<ref>). The black dots(coinciding with the blue circles) are spin average under Hahn echoes as shown in Fig.\u00a0(Figure fig:echo)(b), where the cycle period is $4\\tau = 0.2\\pi$, the pulse amplitude is $10h=200$, and the pulse width is $0.005\\pi$. Other parameters are $A=0.02$ and $J=100$. The average is performed over $N_r = 10^3$ random $w$'s distributed uniformly between $[0,1]$.\nWhen $\\tau=\\pi/h$, the spin average barely decay under REs and Hahn echoes, indicating strong suppression of stray magnetic fields.\n\n< g r a p h i c s >\n\n(Color online) Dependence of the spin average on $t=4N\\tau$ and $h\\tau$. The parameters are $J=1$, $h=20$, and $A=0.02$. The spin average is conserved if $h\\tau=m\\pi \\; (m=1, 2, 3, \\cdots)$ as shown by horizontal dashed lines.\n\nWe consider an initial coherent spin state which is fully polarized along $y$ axis and evolves under the total Hamiltonian Eq.\u00a0(<ref>). We assume the stray magnetic-field effect as white noise, i.e., a series of random numbers ranging from 0 to $w_c$. We set the energy unit as $w_c=1$ and the corresponding time unit is $w_c^{-1}=1$. Other terms with $A$ and $h$ are all scaled with $w_c$. For a typical spin-1 BEC experiment, such as $^{87}$Rb, the stray magnetic fields are in the order of $1$ mG, i.e., roughly 3 kHz in energy. For a magnetic shield room with permalloy plates, the stray field can be further reduced down to $0.1$ mG\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe free evolution of the system, i.e., the free induction decay (FID), is often manifested by the decay of the transverse magnetization or the spin average\n$$\n~\\label{eq:sa}\n\\langle J_y\\rangle (t) &=& \\langle \\psi(t) | J_y |\\psi(t) \\rangle\n\n$$\nwhere $\\psi(t)$ is the wave function of the condensate spin at time $t$. In the stray magnetic fields, the condensate spin only precesses around $z$ axis and is dephased with a characteristic time $T^*_2$. It is easy to find the FID signal\n$$\n~\\label{eq:sa}\n\\langle J_y\\rangle (t) &=& J\\;\\frac {\\sin(w_c t)} {w_c t} \\nonumber\n\n$$\nand the dephasing time is in the order of $T_2^* \\sim w_c^{-1}$, as also shown in Fig.\u00a0(Figure fig:expv).\n\nBy including the driving field $h$, the dephasing due to the stray magnetic field is suppressed by the REs, i.e., the spin average is larger than the FID signal. It is straightforward to calculate the spin average for a given $w$ at $t=4N\\tau$\n$$\n\n\\langle J_y\\rangle(t)=J\\cos{(\\sqrt{\\lambda^2+\\gamma^2}\\,)}, \\nonumber\n\n$$\nwhere we have adopted the $N$-cycle evolution operator in Eq.\u00a0(<ref>). For a distribution of many $w$'s, we find\n$$\n~\\label{eq:fin}\n\\langle J_y\\rangle(t)=\\frac J {N_r} \\sum_{i=1}^{N_r} \\cos{(\\sqrt{\\lambda_i^2+\\gamma_i^2}\\,)}\n\n$$\nwith $N_r$ being the number of random samples. Since each stray magnetic field frequency $w_i$ is untrackable, we consider the strong driving regime, $h\\gg w_c$, which is often the case in a practical precision measurement experiment. Hence, when $h\\tau=m\\pi$, $\\langle J_y(t)\\rangle$ barely decay.\n\nTo check the validity regime for $h\\gg w_c$, we carry out numerical calculations and present both analytical and numerical results in Fig.\u00a0(Figure fig:expv). For the parameters we choose ($g \\lesssim 0.05$, where $g=w_c/h$), the analytical and numerical results agree well. As shown in Fig.\u00a0(Figure fig:expv), the RE sequence always suppresses the stray magnetic-field effect and improves the spin average, no matter what value of $\\tau$ is. As $\\tau$ increases from a small value, the performance of the RE protocol becomes better, i.e., the spin average at a fixed time becomes larger. In particular, the spin average is almost a constant if the magic condition $\\tau = \\pi /h $ is satisfied [see also Fig.\u00a0(Figure fig:echo)(a)]. We remark that such a magic $\\tau$ exists simultaneously for all $w_i$, instead of a single one. Once $\\tau > \\pi/h$, the spin average drops with $\\tau$ increasing. In addition, our numerical results for $J=10$ and $J=100$ agree exactly, indicating that the performance of the RE protocol is independent of the spin size $J$. Finally, we compare the evolution of spin average under the magic REs and Hahn echoes with the same cycle period $4\\tau = 0.2\\pi$. The pulse amplitude and width of the Hahn echoes are, respectively, $10h=200$ and $0.1\\tau=0.005\\pi$. The performance of the magic RE protocol is essentially the same as that of the Hahn echo.\n\nTo investigate the effect of various $\\tau$, we further calculate the spin average under RE sequences for different $\\tau$s and present the results in Fig.\u00a0(Figure fig:ttau). We see clear periodicity of $\\tau = m\\pi/h$ where the spin average is almost conserved, from Fig.\u00a0(Figure fig:ttau). In addition, the good performance region, where the spin average is close to $J$ (red region in Fig.\u00a0(Figure fig:ttau)), becomes larger as $m$ increases.\n\n### Squeezed spin states\n< g r a p h i c s >\n\n(Color online.) Time evolution of (a) the spin average and (b) the $z$-axis spin squeezing parameter for $J=10^3$. The initial direction of the spin is along $y$ axis and the initial optimal squeezing direction is along $z$ axis. The parameters are $h=2, \\tau=0.1$ (blue crosses), $h=2, \\tau=0.5$ (black asterisks), $h=2, \\tau=\\pi/h$ (cyan diamonds), $h=20, \\tau=0.1$ (red squares),  and $h=20, \\tau=\\pi/h$ (blue circles). The FID is denoted with purple triangles. The black dots in (a) and (b) are the evolutions under the Hahn echoes with the cycle period of $4\\tau = 0.2\\pi$, the pulse amplitude of $10h = 200$, and the pulse width of $0.005\\pi$. Other parameter is $A=0.02$. In (b), the black solid line (coinciding with the purple triangles) denotes the optimal squeezing parameter $\\xi_s^2$ sought with numerical method. The spin average and the squeezing parameter are simultaneously fixed by the RE with $h\\gg 1$ and $\\tau = m\\pi/h$. However, the Hahn echoes fail to fix the squeezing parameter.\n\nWe next consider the most interesting spin state, the SSS, which is widely used in precision measurement and quantum metrology. For such a spin state, besides its spin average $\\langle J_y\\rangle(t)$, we are also interested in the spin-squeezing parameter $\\xi_{s}^2$, which represents the optimal or most squeezed transverse spin fluctuation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ],\n$$\n\\label{eq:xis}\n\\xi^2_s=\\frac{2\\min(\\Delta J^2_{n_{\\perp}})}{J},\n\n$$\nwhere $n_\\perp$ denotes a transversal direction perpendicular to the spin average direction and the minimization (numerically) runs over all the transversal  directions. The squeezing parameter $\\xi_s^2 = 1$ for a CSS and $\\xi_s^2 < 1$ for a SSS.\n\nA SSS can be generated by a one-axis or two-axis twisting Hamiltonian from an initial CSS with polarization along $y$ axis\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In this paper, we adopt the two-axis twisting method in which the optimal squeezing direction is invariant during the evolution\u00a0[Unknown Author, \"Unknown Title\", ]. The nonlinear two-axis twisting Hamiltonian is $H_{TAT}=\\chi (J_xJ_z+J_zJ_x)$. The SSS is generated with spin average along $y$ axis, optimal squeezing direction along $z$ axis, and $\\xi_s = 0.0009$ at $t = 0.002/\\chi$ for $J = 10^3$.\n\nAfter the preparation of the SSS, the $H_{TAT}$ is turned off. The spin state should be preserved without the stray magnetic fields. However, the SSS evolves by taking into account the stray magnetic fields. As shown in Fig.\u00a0(Figure fig:sss), the spin average drops rapidly in the time scale of $w_c^{-1}$, but the spin squeezing parameter $\\xi_s^2$ is not changed, nor is the optimal squeezing axis which is the same as the initial one.\n\nBy applying the driving field $h$ along $\\pm x$ axis, both the spin average and the optimal squeezing axis are in general varying with time, but the optimal squeezing parameter $\\xi_s^2$ is always unchanged, as shown in Fig.\u00a0(Figure fig:sss). To better evaluate the performance of the RE protocol, we introduce the $z$-axis spin squeezing parameter\n$$\n\\label{eq:xis}\n\\xi^2=\\frac{2\\Delta J^2_z}{J}.\n\n$$\nFor a perfect RE protocol, the initial SSS is preserved; thus both the spin average $\\langle J_y\\rangle$ and the $z$-axis spin squeezing parameter $\\xi^2$ should be fixed.\n\nWe numerically simulate the time evolution of the condensate spin with the total Hamiltonian Eq. (<ref>), starting from an initial SSS. The spin average, the $z$-axis spin squeezing parameter $\\xi^2$, and the optimal spin squeezing parameter $\\xi_s^2$ are presented in Fig.\u00a0(Figure fig:sss). The weak driving $h=2$ ($g\\lesssim 0.5$) case and the strong driving $h=20$ ($g\\lesssim 0.05$) case are both included.\n\nIn the cases of weak driving, the spin average increases with $\\tau$ increasing at a fixed time, indicating that the RE protocol works for preserving the spin average. However, the spin average still drops significantly in an intermediate time even at the magic condition $\\tau = \\pi/h$.\nFurthermore, the squeezing parameter $\\xi^2$ increases to pretty large values for all the weak driving cases. The larger the $\\tau$ is, the bigger the squeezing parameter $\\xi^2$ is. Therefore, the weak driving RE protocol is not good at preserving the SSS and suppressing the stray magnetic-field effect.\n\nIn the cases of strong driving, the spin average at a fixed time becomes larger with a bigger $\\tau$. Particularly, the spin average is almost a constant at the magic condition $\\tau = \\pi/h$. More remarkably, the squeezing parameter $\\xi^2$ increases only slightly at times much longer than the dephasing time $T_2^* \\sim w_c^{-1}$. Our numerical results confirm that the RE protocol with strong driving preserves not only the spin average but also the spin squeezing, including the amplitude and the direction. However, as a comparison, the Hahn echo protocol only preserves the spin average rather than the spin squeezing parameter. Therefore, the stray magnetic-field effect can be significantly suppressed by the RE protocol at magic condition $\\tau = m\\pi /h$ with $h\\gg w_c$.\n\n## Conclusion\nWe investigate with analytical and numerical methods the performance of the rotary echo protocol in suppressing the effects of the stray magnetic fields. Our results show that the RE protocol with strong driving field $h$ at magic condition $\\tau = m\\pi /h$ well preserves the spin average for a coherent spin state of a spin-1 Bose condensate. Moreover, for a squeezed spin state, the same magic RE protocol simultaneously preserves not only the spin average but also the spin squeezing, including the amplitude and direction. Such a consequence of the RE protocol on spin squeezing has not been well appreciated in previous investigations in nuclear magnetic resonance community. The effects of the stray magnetic fields are significantly suppressed by the magic RE protocol. To implement the RE protocol in spin-1 BEC experiments, the applied driving field can be as small as $\\sim 1$ mG for a magnetic shield room and $\\sim 10$ mG for an ordinary laboratory, much smaller than the field applied in standard Hahn spin echo experiments ($\\sim 100$ mG)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Our results provide a practical method to control the\nstray magnetic-field effect in spinor BEC experiments and may find wide applications in precision measurement and quantum metrology, quantum phase transition, and ground-state properties in spinor Bose condensates\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nW.Z. thanks V. V. Dobrovitski and M. S. Chapman for inspiring discussions. W.Z. is grateful to Beijing CSRC for hospitality. This work is supported by the National Natural Science Foundation of China under Grants No. 11574239, No.11275139, and No.11547310, the National Basic Research Program of China (Grant No. 2013CB922003), and the Fundamental Research Funds for the Central Universities.\n\n## RE protocol with colored noises\nTo check the performance of the RE protocol under different types of noise, we evaluate the spin average and spin squeezing for a SSS in the presence of $1/f$ noise and Gaussian noise, besides the previous white noise. The $1/f$ noise is numerically distributed in the range $[4\\times10^{-5}, 1]w_c$, while the Gaussian noise is in $[0,w_c]$ with an average of $0.5w_c$ and a full width at half maximum $0.1w_c$. The distributions of the noises are normalized and contain $1000$ samples in our calculation. Other parameters are the same as Fig.\u00a0(Figure fig:sss).\n\n< g r a p h i c s >\n\n(Color online.) Time evolution of (a) the spin average\nand (b) the z-axis spin squeezing parameter in the presence of $1/f$ noise (purple crosses), Gaussian noise (black diamonds), and white noise (blue circles). Other parameters are the same as in Fig.\u00a0(Figure fig:sss). The suppression of the $1/f$ and the Gaussian noise is more efficient than that of the white noise.\n\nThe comparisons are shown in Fig.\u00a0(Figure fig:cn). Clearly, the RE protocol also suppresses the colored noises and the performances of the RE protocol in the colored noises are actually better than in the white noise, i.e., the spin averages are higher and the spin squeezing parameters are lower.\n\n49\nnatexlab#1#1bibnamefont#1#1bibfnamefont#1#1citenamefont#1#1url<#>1urlprefixURL\n\n[Giovannetti et\u00a0al.(2011)Giovannetti,\nLloyd, and Maccone]Giovannetti2011Advances\nauthorV.\u00a0Giovannetti,\nauthorS.\u00a0Lloyd, and\nauthorL.\u00a0Maccone,\njournalNature Photon. volume5,\npages222 (year2011).\n\n[Muessel et\u00a0al.(2014)Muessel, Strobel,\nLinnemann, Hume, and Oberthaler]Muessel14PRL\nauthorW.\u00a0Muessel,\nauthorH.\u00a0Strobel,\nauthorD.\u00a0Linnemann,\nauthorD.\u00a0B. Hume, and\nauthorM.\u00a0K. Oberthaler,\njournalPhys. Rev. Lett. volume113,\npages103004 (year2014).\n\n[Stamper-Kurn and Ueda(2013)]Ueda13RMP\nauthorD.\u00a0M. Stamper-Kurn\nand authorM.\u00a0Ueda,\njournalRev. Mod. Phys. volume85,\npages1191 (year2013).\n\n[Huang et\u00a0al.(2012)Huang, Zhang, L\u00fc,\nWang, and Yi]yixiaohuang12PRA\nauthorY.\u00a0Huang,\nauthorY.\u00a0Zhang,\nauthorR.\u00a0L\u00fc,\nauthorX.\u00a0Wang, and\nauthorS.\u00a0Yi, journalPhys.\nRev. A volume86, pages043625\n(year2012).\n\n[Vengalattore et\u00a0al.(2007)Vengalattore,\nHigbie, Leslie, Guzman, Sadler, and Stamper-Kurn]magnetometryBEC07\nauthorM.\u00a0Vengalattore,\nauthorJ.\u00a0M. Higbie,\nauthorS.\u00a0R. Leslie,\nauthorJ.\u00a0Guzman,\nauthorL.\u00a0E. Sadler,\nand authorD.\u00a0M.\nStamper-Kurn, journalPhys. Rev. Lett.\nvolume98, pages200801\n(year2007).\n\n[Abdullaev et\u00a0al.(2003)Abdullaev, Caputo,\nKraenkel, and Malomed]controlBEC03\nauthorF.\u00a0K. Abdullaev,\nauthorJ.\u00a0G. Caputo,\nauthorR.\u00a0A. Kraenkel,\nand authorB.\u00a0A.\nMalomed, journalPhys. Rev. A\nvolume67, pages013605\n(year2003).\n\n[Nolan et\u00a0al.(2016)Nolan, Sabbatini,\nBromley, Davis, and Haine]PhysRevA.93.023616\nauthorS.\u00a0P. Nolan,\nauthorJ.\u00a0Sabbatini,\nauthorM.\u00a0W.\u00a0J. Bromley,\nauthorM.\u00a0J. Davis, and\nauthorS.\u00a0A. Haine,\njournalPhys. Rev. A volume93,\npages023616 (year2016).\n\n[Chang et\u00a0al.(2005)Chang, Qin, Zhang,\nYou, and Chapman]Chang2005Coherent\nauthorM.\u00a0S. Chang,\nauthorQ.\u00a0Qin,\nauthorW.\u00a0Zhang,\nauthorL.\u00a0You, and\nauthorM.\u00a0S. Chapman,\njournalNature Phys. volume1,\npages111 (year2005).\n\n[Dunningham et\u00a0al.(2012)Dunningham,\nCooper, and Hallwood]Dunningham2012\nauthorJ.\u00a0A. Dunningham,\nauthorJ.\u00a0J. Cooper,\nand authorD.\u00a0W.\nHallwood, journalAIP Conference Proceedings\nvolume1469 (year2012).\n\n[Chang et\u00a0al.(2004)Chang, Hamley,\nBarrett, Sauer, Fortier, Zhang, You, and Chapman]Chang04\nauthorM.-S. Chang,\nauthorC.\u00a0D. Hamley,\nauthorM.\u00a0D. Barrett,\nauthorJ.\u00a0A. Sauer,\nauthorK.\u00a0M. Fortier,\nauthorW.\u00a0Zhang,\nauthorL.\u00a0You, and\nauthorM.\u00a0S. Chapman,\njournalPhys. Rev. Lett. volume92,\npages140403 (year2004).\n\n[Eto et\u00a0al.(2013a)Eto,\nIkeda, Suzuki, Hasegawa, Tomiyama, Sekine, Sadgrove, and Hirano]Eto13\nauthorY.\u00a0Eto,\nauthorH.\u00a0Ikeda,\nauthorH.\u00a0Suzuki,\nauthorS.\u00a0Hasegawa,\nauthorY.\u00a0Tomiyama,\nauthorS.\u00a0Sekine,\nauthorM.\u00a0Sadgrove, and\nauthorT.\u00a0Hirano,\njournalPhys. Rev. A volume88,\npages031602 (year2013a).\n\n[Eto et\u00a0al.(2014)Eto, Sadgrove, Hasegawa,\nSaito, and Hirano]eto2014control\nauthorY.\u00a0Eto,\nauthorM.\u00a0Sadgrove,\nauthorS.\u00a0Hasegawa,\nauthorH.\u00a0Saito, and\nauthorT.\u00a0Hirano,\njournalPhys. Rev. A volume90,\npages013626 (year2014).\n\n[Huang and Hu(2015)]Huang2015Spin\nauthorY.\u00a0Huang and\nauthorZ.\u00a0D. Hu,\njournalSci. Rep. volume5,\npages8006 (year2015).\n\n[Cha()]Chapman15\nnoteT. M.,Hoang and M.,Anquez and B. A., Robbins and X. Y., Yang and\nB. J., Land and C. D., Hamley and M. S., Chapman, arXiv:1512.05645.\n\n[Marti et\u00a0al.(2014)Marti, MacRae, Olf,\nLourette, Fang, and Stamper-Kurn]Marti2014\nauthorG.\u00a0E. Marti,\nauthorA.\u00a0MacRae,\nauthorR.\u00a0Olf,\nauthorS.\u00a0Lourette,\nauthorF.\u00a0Fang, and\nauthorD.\u00a0M. Stamper-Kurn,\njournalPhys. Rev. Lett. volume113,\npages155302 (year2014).\n\n[Knill et\u00a0al.(2000)Knill, Laflamme, and\nViola]QEC2000\nauthorE.\u00a0Knill,\nauthorR.\u00a0Laflamme, and\nauthorL.\u00a0Viola,\njournalPhys. Rev. Lett. volume84,\npages2525 (year2000).\n\n[Viola et\u00a0al.(1999)Viola, Knill, and\nLloyd]DDPRL1999\nauthorL.\u00a0Viola,\nauthorE.\u00a0Knill, and\nauthorS.\u00a0Lloyd,\njournalPhys. Rev. Lett. volume82,\npages2417 (year1999).\n\n[Viola and Lloyd(1998)]BBdymsupp\nauthorL.\u00a0Viola and\nauthorS.\u00a0Lloyd,\njournalPhys. Rev. A volume58,\npages2733 (year1998).\n\n[Zhang et\u00a0al.(2010)Zhang, Sun, Chapman,\nand You]Zhang10a\nauthorW.\u00a0Zhang,\nauthorB.\u00a0Sun,\nauthorM.\u00a0S. Chapman,\nand authorL.\u00a0You,\njournalPhys. Rev. A volume81,\npages033602 (year2010).\n\n[Hamley et\u00a0al.(2012)Hamley, Gerving,\nHoang, Bookjans, and Chapman]Hamley12\nauthorC.\u00a0D. Hamley,\nauthorC.\u00a0S. Gerving,\nauthorT.\u00a0M. Hoang,\nauthorE.\u00a0M. Bookjans,\nand authorM.\u00a0S.\nChapman, journalNature Phys.\nvolume8, pages305 (year2012).\n\n[Hoang et\u00a0al.(2013)Hoang, Gerving, Land,\nAnquez, Hamley, and Chapman]Hoang13\nauthorT.\u00a0M. Hoang,\nauthorC.\u00a0S. Gerving,\nauthorB.\u00a0J. Land,\nauthorM.\u00a0Anquez,\nauthorC.\u00a0D. Hamley,\nand authorM.\u00a0S.\nChapman, journalPhys. Rev. Lett.\nvolume111, pages090403\n(year2013).\n\n[Li et\u00a0al.(2015)Li, Pu, Chapman, and\nZhang]huanbinLi\nauthorH.\u00a0Li,\nauthorZ.\u00a0Pu,\nauthorM.\u00a0S. Chapman,\nand authorW.\u00a0Zhang,\njournalPhys. Rev. A volume92,\npages013630 (year2015).\n\n[Zhang et\u00a0al.(2015)Zhang, Yi, Chapman,\nand You]zhang15\nauthorW.\u00a0Zhang,\nauthorS.\u00a0Yi,\nauthorM.\u00a0S. Chapman,\nand authorJ.\u00a0Q. You,\njournalPhys. Rev. A volume92,\npages023615 (year2015).\n\n[Eto et\u00a0al.(2013b)Eto,\nSekine, Hasegawa, Sadgrove, Saito, and Hirano]Eto13control\nauthorY.\u00a0Eto,\nauthorS.\u00a0Sekine,\nauthorS.\u00a0Hasegawa,\nauthorM.\u00a0Sadgrove,\nauthorH.\u00a0Saito, and\nauthorT.\u00a0Hirano,\njournalAppl. Phys. Express volume6,\npages052801 (year2013b).\n\n[Ning et\u00a0al.(2011)Ning, Zhuang, You, and\nZhang]BYNing11\nauthorB.-Y. Ning,\nauthorJ.\u00a0Zhuang,\nauthorJ.\u00a0Q. You, and\nauthorW.\u00a0Zhang,\njournalPhys. Rev. A volume84,\npages013606 (year2011).\n\n[Solomon(1959)]solomon1959rotary\nauthorI.\u00a0Solomon,\njournalPhys. Rev. Lett. volume2,\npages301 (year1959).\n\n[Mkhitaryan et\u00a0al.(2015)Mkhitaryan,\nJelezko, and Dobrovitski]2015Dobrovitski\nauthorV.\u00a0Mkhitaryan,\nauthorF.\u00a0Jelezko, and\nauthorV.\u00a0Dobrovitski,\njournalSci. Rep. volume5,\npages15402 (year2015).\n\n[Hirose et\u00a0al.(2012)Hirose, Aiello, and\nCappellaro]continuousPRA\nauthorM.\u00a0Hirose,\nauthorC.\u00a0D. Aiello,\nand\nauthorP.\u00a0Cappellaro,\njournalPhys. Rev. A volume86,\npages062320 (year2012).\n\n[Mkhitaryan and Dobrovitski(2014)]DobrovitskiPRB\nauthorV.\u00a0V. Mkhitaryan\nand authorV.\u00a0V.\nDobrovitski, journalPhys. Rev. B\nvolume89, pages224402\n(year2014).\n\n[Farfurnik et\u00a0al.(2015)Farfurnik,\nJarmola, Pham, Wang, Dobrovitski, Walsworth, Budker, and\nBar-Gill]PhysRevB.92.060301\nauthorD.\u00a0Farfurnik,\nauthorA.\u00a0Jarmola,\nauthorL.\u00a0M. Pham,\nauthorZ.\u00a0H. Wang,\nauthorV.\u00a0V. Dobrovitski,\nauthorR.\u00a0L. Walsworth,\nauthorD.\u00a0Budker, and\nauthorN.\u00a0Bar-Gill,\njournalPhys. Rev. B volume92,\npages060301 (year2015).\n\n[Laraoui and Meriles(2011)]PhysRevB.84.161403\nauthorA.\u00a0Laraoui and\nauthorC.\u00a0A. Meriles,\njournalPhys. Rev. B volume84,\npages161403 (year2011).\n\n[Gustavsson et\u00a0al.(2012)Gustavsson,\nBylander, Yan, Forn-D\u00edaz, Bolkhovsky, Braje, Fitch, Harrabi, Lennon,\nMiloshi et\u00a0al.]RE12\nauthorS.\u00a0Gustavsson,\nauthorJ.\u00a0Bylander,\nauthorF.\u00a0Yan,\nauthorP.\u00a0Forn-D\u00edaz,\nauthorV.\u00a0Bolkhovsky,\nauthorD.\u00a0Braje,\nauthorG.\u00a0Fitch,\nauthorK.\u00a0Harrabi,\nauthorD.\u00a0Lennon,\nauthorJ.\u00a0Miloshi,\net\u00a0al., journalPhys. Rev. Lett.\nvolume108, pages170503\n(year2012).\n\n[Fanchini et\u00a0al.(2015)Fanchini,\nNapolitano, Cakmak, and Caldeira]CDD2015PRA\nauthorF.\u00a0F. Fanchini,\nauthorR.\u00a0d.\u00a0J. Napolitano,\nauthorB.\u00a0Cakmak, and\nauthorA.\u00a0O. Caldeira,\njournalPhys. Rev. A volume91,\npages042325 (year2015).\n\n[Aiello et\u00a0al.(2013)Aiello, Hirose, and\nCappellaro]Aiello2013Composite\nauthorC.\u00a0D. Aiello,\nauthorM.\u00a0Hirose, and\nauthorP.\u00a0Cappellaro,\njournalNat. Commun. volume4,\npages273 (year2013).\n\n[L\u00fccke et\u00a0al.(2011)L\u00fccke,\nScherer, Kruse, Pezz\u00e9, Deuretzbacher, Hyllus, Topic, Peise, Ertmer, Arlt\net\u00a0al.]klempt2011\nauthorB.\u00a0L\u00fccke,\nauthorM.\u00a0Scherer,\nauthorJ.\u00a0Kruse,\nauthorL.\u00a0Pezz\u00e9,\nauthorF.\u00a0Deuretzbacher,\nauthorP.\u00a0Hyllus,\nauthorO.\u00a0Topic,\nauthorJ.\u00a0Peise,\nauthorW.\u00a0Ertmer,\nauthorJ.\u00a0Arlt, et\u00a0al.,\njournalScience volume334,\npages773 (year2011).\n\n[Peise et\u00a0al.(2015)Peise, Kruse, Lange,\nLcke, Pezz, Arlt, Ertmer, Hammerer, Santos, and Smerzi]klempt2015\nauthorJ.\u00a0Peise,\nauthorI.\u00a0Kruse,\nauthorK.\u00a0Lange,\nauthorB.\u00a0Lcke,\nauthorL.\u00a0Pezz,\nauthorJ.\u00a0Arlt,\nauthorW.\u00a0Ertmer,\nauthorK.\u00a0Hammerer,\nauthorL.\u00a0Santos, and\nauthorA.\u00a0Smerzi,\njournalNat. Commun. volume6,\npages8984 (year2015).\n\n[mag()]magmeter\nnoteIn Ref. [34], C. D. Aiello et al. experimentally\ninvestigate a magnetometry scheme based on rotary echos (RE) applied in a\nnitrogen-vacancy centre in diamond. After transforming the Hamiltonian to the\ntoggling-frame, they obtain the evolution of the population (the signal) for\nan initial state under 55 RE cycles. Then they calculate the sensitivity and\nperiodogram (the squared magnitude of the Fourier transform of the signal)\nwhich identifies the frequency content of the signal. By adjusting the\nrotation angle of the half-echo of RE, the coherence time and sensitivity of\nthe sensor are improved in their scheme in the presence of noisy environment.\nIn addition, Eto et al. demonstrate an ac magnetometry based on\nspin-echos of a spinor BEC\u00a0[11].\n\n[Ho(1998)]ho1998spinor\nauthorT.-L. Ho,\njournalPhys. Rev. Lett. volume81,\npages742 (year1998).\n\n[Ohmi and Machida(1998)]ohmi1998bose\nauthorT.\u00a0Ohmi and\nauthorK.\u00a0Machida,\njournalJ. Phys. Soc. Jpn. volume67,\npages1822 (year1998).\n\n[Law et\u00a0al.(1998)Law, Pu, and\nBigelow]Law98\nauthorC.\u00a0K. Law,\nauthorH.\u00a0Pu, and\nauthorN.\u00a0P. Bigelow,\njournalPhys. Rev. Lett. volume81,\npages5257 (year1998).\n\n[Zhang et\u00a0al.(2003)Zhang, Yi, and\nYou]Zhang03\nauthorW.\u00a0Zhang,\nauthorS.\u00a0Yi, and\nauthorL.\u00a0You, journalNew\nJ. Phys. volume5, pages77\n(year2003).\n\n[Yi et\u00a0al.(2002)Yi, M\u00fcstecapl\u0131o\u00a0\u011f\u011flu, Sun, and\nYou]Yi02\nauthorS.\u00a0Yi,\nauthorO.\u00a0E. M\u00fcstecapl\u0131o\u00a0\u011f\u011flu,\nauthorC.\u00a0P. Sun, and\nauthorL.\u00a0You,\njournalPhys. Rev. A volume66,\npages011601 (year2002).\n\n[Ulrich(1976)]Haeberlen76\nauthorH.\u00a0Ulrich,\ntitleHigh Resolution NMR in Solids Selective Averaging\n(publisherElsevier Science, year1976).\n\n[Zhang et\u00a0al.(2005)Zhang, Zhou, Chang,\nChapman, and You]Zhang05a\nauthorW.\u00a0Zhang,\nauthorD.\u00a0L. Zhou,\nauthorM.-S. Chang,\nauthorM.\u00a0S. Chapman,\nand authorL.\u00a0You,\njournalPhys. Rev. A volume72,\neid013602 (year2005).\n\n[Ma et\u00a0al.(2011)Ma, Wang, Sun, and\nNori]ma2011quantum\nauthorJ.\u00a0Ma,\nauthorX.\u00a0Wang,\nauthorC.\u00a0Sun, and\nauthorF.\u00a0Nori,\njournalPhys. Rep. volume509,\npages89 (year2011).\n\n[Kitagawa and Ueda(1993)]kitagawa1993squeezed\nauthorM.\u00a0Kitagawa and\nauthorM.\u00a0Ueda,\njournalPhys. Rev. A volume47,\npages5138 (year1993).\n\n[Zhang et\u00a0al.(1990)Zhang, Feng, and\nGilmore]RevModPhys.62.867\nauthorW.\u00a0M. Zhang,\nauthorD.\u00a0H. Feng, and\nauthorR.\u00a0Gilmore,\njournalRev. Mod. Phys. volume62,\npages867 (year1990).\n\n[Liu et\u00a0al.(2011)Liu, Xu, Jin, and\nYou]liu2011spin\nauthorY.\u00a0Liu,\nauthorZ.\u00a0Xu,\nauthorG.\u00a0Jin, and\nauthorL.\u00a0You,\njournalPhys. Rev. Lett. volume107,\npages013601 (year2011).\n\n[Pu et\u00a0al.(2016)Pu, Zhang, Yi, Wang, and\nZhang]Pu16\nauthorZ.\u00a0Pu,\nauthorJ.\u00a0Zhang,\nauthorS.\u00a0Yi,\nauthorD.\u00a0Wang, and\nauthorW.\u00a0Zhang,\njournalPhys. Rev. A volume93,\npages053628 (year2016).\n\n"}
{"prompt": "Please summarize the paper titled 'Paper 1311.6759'.", "completion": "\n\n@bibitem\n\nplain\n\n6pt\n3pt\n\n=10000 0pt plus 10pt\n\nphvm1517\nphvm1315\n\nphv\nphv\n\n*[1]#1\n\n*[1]#1\n\nthumbcount\n\nlframe\nrframe\nfancy\n\nlofchapter[2]\n-highpenalty\n1.0em plus@\nempdima1.5em\n@ pnumwidth\ntempdima\n-#1highpenalty\n\n2\n2\n\nprotrusion=false\nprotrusion=true\n\nutphysMDR\n\ntocpartAppendices\n\n"}
{"prompt": "Please summarize the paper titled 'Measurement and control of a superconducting quantum processor with a fully-integrated radio-frequency system on a chip'.", "completion": "\n\n-\n\nemail#1#2\n@produce\n@RRAPformat\n@RRAPformat@RRAP*#1mailto:#2#2@RRAPformat\n\n# Measurement and control of a superconducting quantum processor with a fully-integrated radio-frequency system on a chip\n\ncontributed equally to this work\nNanostructure Physics, KTH Royal Institute of Technology, 106 91 Stockholm, Sweden\nIntermodulation Products AB, 823 93 Segersta, Sweden\n\ncontributed equally to this work\nNanostructure Physics, KTH Royal Institute of Technology, 106 91 Stockholm, Sweden\nIntermodulation Products AB, 823 93 Segersta, Sweden\n\nNanostructure Physics, KTH Royal Institute of Technology, 106 91 Stockholm, Sweden\n\nDepartment of Microtechnology and Nanoscience, Chalmers University of Technology, 412 96 Gothenburg, Sweden\n\nNanostructure Physics, KTH Royal Institute of Technology, 106 91 Stockholm, Sweden\n[The author to whom correspondence may be addressed: ]haviland@kth.se\n\nWe describe a digital microwave platform called Presto, designed for measurement and control of multiple quantum bits (qubits) and based on the third-generation radio-frequency system on a chip.\nPresto uses direct digital synthesis to create signals up to 9\u00a0GHz on 16 synchronous output ports, while synchronously analyzing response on 16 input ports.\nPresto has 16 DC-bias outputs, 4 inputs and 4 outputs for digital triggers or markers, and two continuous-wave outputs for synthesizing frequencies up to 15\u00a0GHz.\nScaling to a large number of qubits is enabled through deterministic synchronization of multiple Presto units.\nA Python application programming interface configures a firmware for synthesis and analysis of pulses, coordinated by an event sequencer.\nThe analysis integrates template matching (matched filtering) and low-latency (184 \u2013 254\u00a0ns) feedback to enable a wide range of multi-qubit experiments.\nWe demonstrate Presto's capabilities with experiments on a sample consisting of two superconducting qubits connected via a flux-tunable coupler.\nWe show single-shot readout and active reset of a single qubit; randomized benchmarking of single-qubit gates showing 99.972\n\n## Introduction\nQuantum technology is presently enjoying rapid expansion, driven in part by the promise of speed-up in the processing of information [Harrow, Aram W., Montanaro, Ashley, \"Quantum computational supremacy\", 2017].\nSeveral large-scale projects are underway to develop a fully-programmable quantum-information processing machine, based on a variety of different quantum hardware [Ladd, T. D., Jelezko, F., Laflamme, R., Nakamura, Y., Monroe, C., O\u2019Brien, J. L., \"Quantum computers\", 2010].\nCommon to all these developments is the need for a classical electronic control system that is flexible, and possible to scale up in a cost-efficient manner.\nIn fact, one of the main impediments to scaling up a quantum computer is the cost and complexity of the classical control system [Rist\u00e8, Diego, Fallek, Spencer, Donovan, Brian, Ohki, Thomas A., \"Microwave Techniques for Quantum Computers: State-of-the-Art Control Systems for Quantum Processors\", 2020] [Asaad, Serwan, Dickel, Christian, Langford, Nathan K., Poletto, Stefano, Bruno, Alessandro, Rol, Michiel Adriaan, Deurloo, Duije, DiCarlo, Leonardo, \"Independent, extensible control of same-frequency superconducting qubits by selective broadcasting\", 2016] [McDermott, R., Vavilov, M. G., Plourde, B. L. T., Wilhelm, F. K., Liebermann, P. J., Mukhanov, O. A., Ohki, T. A., \"Quantum\u2013classical interface based on single flux quantum digital logic\", 2018].\nHere we address this issue through the development of a fully-programmable digital microwave control platform for a superconducting quantum processor.\nOur direct-digital approach to synthesize and readout signals to and from the quantum chip differs from traditional qubit-control systems that use analog mixers to up- and down-convert microwave signals [Krantz, P, Kjaergaard, M, Yan, F, Orlando, T. P, Gustavsson, S, Oliver, W. D, \"A quantum engineer's guide to superconducting qubits\", 2019].\n\nContemporaneous with the expansion of quantum technology, high-speed digital circuits have undergone significant advancement, driven by the deployment of the fifth-generation technology standard for broadband cellular networks (5G) and the transition to software-defined radio (SDR).\n5G and SDR have stringent hardware and signal-processing requirements for receiving and transmitting signals with phased arrays of antennas, requiring many phase-coherent radio-frequency (RF) channels, each with high bandwidth, low distortion and low noise.\nA tight integration of RF data converters and digital signal processing (DSP) is desired to cope with high data rates while keeping the infrastructure cheap, scalable and power efficient.\nSuch requirements should sound familiar to quantum technologists.\nIndeed, much is to be gained by taking advantage of 5G and SDR development, adapting this new digital hardware to quantum-technology applications.\n\nA notable advancement in this context is the Zynq UltraScale+ RFSoC, a radio-frequency system on a chip integrating RF data converters, many cores of central-processing units (CPU) and a large field-programmable gate array (FPGA), all on a single silicon chip [Xilinx, \"Zynq UltraScale+ RFSoC - Devices\", 2022].\nEvaluation modules of the first generation of RFSoC chips have been used to demonstrate their applicability to quantum computation [Gebauer, Richard, Karcher, Nick, Gusenkova, Daria, Spiecker, Martin, Gr\u00fcnhaupt, Lukas, Takmakov, Ivan, Winkel, Patrick, Planat, Luca, Roch, Nicolas, Wernsdorfer, Wolfgang, Ustinov, Alexey V., Weber, Marc, Weides, Martin, Pop, Ioan M., Sander, Oliver, \"State preparation of a fluxonium qubit with feedback from a custom FPGA-based platform\", 2020] [Gebauer, Richard, Karcher, Nick, Hurst, Jonas, Weber, Marc, Sander, Oliver, \"Accelerating complex control schemes on a heterogeneous MPSoC platform for quantum computing\", 2020] [Stefanazzi, Leandro, Treptow, Kenneth, Wilcer, Neal, Stoughton, Chris, Bradford, Collin, Uemura, Sho, Zorzetti, Silvia, Montella, Salvatore, Cancelo, Gustavo, Sussman, Sara, Houck, Andrew, Saxena, Shefali, Arnaldi, Horacio, Agrawal, Ankur, Zhang, Helin, Ding, Chunyang, Schuster, David I., \"The QICK (Quantum Instrumentation Control Kit): Readout and control for qubits and detectors\", 2022] [Kun Hee Park, Yung Szen Yap, Yuanzheng Paul Tan, Christoph Hufnagel, Long Hoang Nguyen, Karn Hwa Lau, Stavros Efthymiou, Stefano Carrazza, Rangga P. Budoyo, Rainer Dumke, \"ICARUS-Q: A scalable RFSoC-based control system for superconducting quantum computers\", 2021] [Singhal, Ujjawal, Kalipatnapu, Shantharam, Majumder, Sourav, Pabbisetty, Vaibhav Venkata Lakshmi, Jandhyala, Srivatsava, Singh, Vibhor, Thakur, Chetan Singh, \"Generation of control signals using second-Nyquist zone technique for superconducting qubit devices\", 2022].\nFPGA devices have been used quite extensively in scientific experiments [Carminati, M., Scandurra, G., \"Impact and trends in embedding field programmable gate arrays and microcontrollers in scientific instrumentation\", 2021] and there are many examples of their use for readout and control of superconducting qubits [Walter, T., Kurpiers, P., Gasparinetti, S., Magnard, P., Poto\u0131fmmode \u1e29eckc\u010d, A., Salath\u00e9, Y., Pechal, M., Mondal, M., Oppliger, M., Eichler, C., Wallraff, A., \"Rapid High-Fidelity Single-Shot Dispersive Readout of Superconducting Qubits\", 2017] [Heinsoo, Johannes, Andersen, Christian Kraglund, Remm, Ants, Krinner, Sebastian, Walter, Theodore, Salath\u00e9, Yves, Gasparinetti, Simone, Besse, Jean-Claude, Poto\u010dnik, Anton, Wallraff, Andreas, Eichler, Christopher, \"Rapid High-fidelity Multiplexed Readout of Superconducting Qubits\", 2018] [Salath\u00e9, Yves, Kurpiers, Philipp, Karg, Thomas, Lang, Christian, Andersen, Christian Kraglund, Akin, Abdulkadir, Krinner, Sebastian, Eichler, Christopher, Wallraff, Andreas, \"Low-Latency Digital Signal Processing for Feedback and Feedforward in Quantum Computing and Communication\", 2018] [Xu, Yilun, Huang, Gang, Balewski, Jan, Naik, Ravi, Morvan, Alexis, Mitchell, Bradley, Nowrouzi, Kasra, Santiago, David I., Siddiqi, Irfan, \"QubiC: An Open-Source FPGA-Based Control and Measurement System for Superconducting Quantum Information Processors\", 2021].\nThe RFSoC platform differs significantly from this previous use of FPGAs because the on-chip integration of high-speed data converters enables direct digital synthesis (DDS) of RF waveforms.\n\nEspecially the third-generation RFSoC allows for the generation of output signals and real-time analysis of input signals up to 9\u00a0GHz.\nWith proper care [van Dijk, Jeroen P. G., Patra, Bishnu, Pellerano, Stefano, Charbon, Edoardo, Sebastiano, Fabio, Babaie, Masoud, \"Designing a DDS-Based SoC for High-Fidelity Multi-Qubit Control\", 2020] [Ball, Harrison, Oliver, William D, Biercuk, Michael J, \"The role of master clock stability in quantum information processing\", 2016], DDS can reliably generate the microwave signals to control a quantum processor, and synchronously analyze signals from the readout of qubits, with high fidelity and in a compact and scalable format.\nThe RFSoC eliminates external local oscillators and analog IQ mixers, expensive components in traditional control systems, with imperfections that necessitate calibration and compensation [Jolin,S. W. , Borgani,R. , Thol\u00e9n,M. O. , Forchheimer,D. , Haviland,D. B. , \"Calibration of mixer amplitude and phase imbalance in superconducting circuits\", 2020].\n\nIn this paper we describe Presto, a digital microwave platform for signal generation, acquisition and processing based on the third generation of RFSoC.\nPresto is a multi-purpose platform with a wide variety of features that are programmable from a Python application programming interface (API).\nWe use Presto to characterize a quantum processor, implementing high-fidelity single-qubit gates and achieving high-fidelity single-shot readout.\nWe implement a conditional reset operation [Rist\u00e8, D., Bultink, C. C., Lehnert, K. W., DiCarlo, L., \"Feedback Control of a Solid-State Qubit Using High-Fidelity Projective Measurement\", 2012] on a single qubit, essentially cooling it with Presto's low-latency feedback engine.\nWe perform randomized benchmarking on single qubit gates using Presto's internal averaging capabilities.\nWe also use multiple synchronized channels of Presto to tune up and implement a two-qubit gate, with the readout of both qubits multiplexed on the same channel.\nIn all experiments both measurement and control is performed by Presto alone.\nNo additional electronic instruments were required.\n\nThis paper is organized as follows:\nIn Sec.\u00a0<ref> we describe the Presto platform based on the RFSoC.\nSections\u00a0<ref> and\u00a0<ref> describe in detail the architecture of Presto's digital and analog components, respectively, motivating the design choices for the readout and control of superconducting qubits.\nIn Sec.\u00a0<ref> we discuss how multiple Presto units are synchronized to scale up toward controlling hundreds of qubits.\nIn Sec.\u00a0<ref> we demonstrate the use of Presto in a series of experiments on a two-qubit quantum processor.\nAppendixes\u00a0<ref> and\u00a0<ref> provide additional details on continuous-wave capabilities of Presto and on the use of template matching for implementing optimal readout, respectively.\nAppendix\u00a0<ref> discusses the implementation of a feedback scheme for active qutrit reset and Appendix\u00a0<ref> gives the details our qubit-measurement setup.\nFinally, Appendix\u00a0<ref> lists the abbreviations used in this manuscript together with their explanation.\n\n## Architecture\n### RFSoC platform\n< g r a p h i c s >\n\nOverview of Presto's circuit boards and subsystems.\nThe ZCU208 or ZCU216 development board from Xilinx (green) houses the RFSoC chip and other components such as memory, clock synthesizers and network controllers.\nThree custom boards (pink) provide additional functionality:\ntwo boards convert signals from the RFSoC to a more useful format,\nand a third board provides 16 DC-biasing channels.\n\nThe core of the Presto platform is the third generation of Zynq UltraScale+ RFSoC by Xilinx [Xilinx, \"Zynq UltraScale+ RFSoC - Devices\", 2022].\nThese highly-integrated chips feature a full ARM processing subsystem, a large FPGA and numerous RF data converters.\nThe current versions of Presto do not use the bare chips directly, but rather build on the development boards [Xilinx, \"Zynq UltraScale+ RFSoC - Evaluation Boards\", 2022] ZCU208 or ZCU216, depending on the number of RF channels needed:\nthe former board features 8 input and 8 output channels,\nwhile the latter features 16 of each.\nThe symmetric input/output design is optimal for SDR applications where phased arrays of antennas used for beamforming are typically symmetrical on the transmitting and receiving end.\nThe symmetric configuration is however not optimal for quantum-computing applications where several output channels are required for each input channel.\nThe current architecture of superconducting quantum processors favours frequency-multiplexed qubit readout, but individual microwave lines are required to control the qubits.\n\nIn principle, these development boards contain everything needed to operate the RFSoC.\nIn practice, the analog and digital signals are not exposed in a suitable manner for interfacing to quantum circuits.\nTo address this problem, we developed daughter boards (Fig.\u00a0(Figure fig:ArchitectureBoards)) to convert the RF signals and digital triggers and markers to a more useful form.\nAn additional board adds the capability of supplying DC bias to flux-tunable qubit couplers or parametric amplifiers.\nWe also exposed two high-frequency drive ports (up to 15\u00a0GHz) for pumping parametric amplifiers.\nThe daughter boards are described in detail in Sec.\u00a0<ref>.\n\nThe RF channels are provided by 14-bit analog-to-digital (ADC) and digital-to-analog (DAC) RF converters that are tightly integrated on-chip with the programmable logic.\nThe ADCs and DACs are designed to directly measure and synthesize microwave signals in higher Nyquist zones.\nThe bandwidth at maximum output power is specified [Xilinx, \"Zynq UltraScale+ RFSoC Data Sheet: Overview\", 2022] [Xilinx, \"Zynq UltraScale+ RFSoC Data Sheet: DC and AC Switching Characteristics\", 2022] to 6\u00a0GHz.\nHowever, our measurements show that the RFSoC generates significant signal power well above 8\u00a0GHz with our front-end board.\nAs shown in detail in Sec.\u00a0<ref> and Fig.\u00a0(Figure fig:outrng), Presto comfortably accesses the 4-to-8\u00a0GHz band typically used in cryogenic microwave setups.\n\n### Digital design\nDirect access to all converters from the FPGA allows for real-time digital synthesis and analysis of intricate waveforms that are fully programmable, enabling a wide variety of measurements.\nProgramming the FPGA gives the most flexibility, but such low-level programming is a tedious and difficult task that requires competence and expertise not typically available in a quantum-physics laboratory.\nFor this reason we focused on designing different modes of operation, each with a generous set of measurement-configuration parameters that are controlled from a Python API [Intermodulation Products AB, \"Presto Python API\", 2022].\nThese modes of operation are implemented as different firmware that configures Presto at run time.\nPresently two general-purpose modes of operation are available: one for continuous-wave and one for pulsed experiments.\n\nThe continuous-wave mode of operation has been used to investigate multipartite entanglement of microwave modes in surface-acoustic wave resonators [Andersson, Gustav, Jolin, Shan W., Scigliuzzo, Marco, Borgani, Riccardo, Thol\u00e9n, Mats O., Rivera Hern, J.C., Shumeiko, Vitaly, Haviland, David B., Delsing, Per, \"Squeezing and Multimode Entanglement of Surface Acoustic Wave Phonons\", 2022] and Josephson parametric amplifiers [Shan W. Jolin, Gustav Andersson, J. C. Rivera Hern\u00e1ndez, Ingrid Strandberg, Fernando Quijandr\u00eda, Joe Aumentado, Riccardo Borgani, Mats O. Thol\u00e9n, David B. Haviland, \"Multipartite entanglement in a microwave frequency comb\", 2021].\nAnother potential application of this firmware is frequency-multiplexed sensor arrays [Echternach, P. M., Pepper, B. J., Reck, T., Bradford, C. M., \"Single photon detection of 1.5 THz radiation with the quantum capacitance detector\", 2018] [Mazin, Benjamin A., Bumble, Bruce, Day, Peter K., Eckart, Megan E., Golwala, Sunil, Zmuidzinas, Jonas, Harrison, Fiona A., \"Position sensitive x-ray spectrophotometer using microwave kinetic inductance detectors\", 2006], where a large number of superconducting microwave resonators on one transmission line are pumped at different frequencies while continuously monitoring changes in their response amplitude and phase.\nWe provide some detail on continuous-wave operation in Appendix\u00a0<ref>.\n\nIn this manuscript we focus mainly on the pulsed mode of operation.\nAn early version of this firmware has been used to create non-classical states of the microwave field in a superconducting 3D cavity [Kudra, Marina, Kervinen, Mikael, Strandberg, Ingrid, Ahmed, Shahnawaz, Scigliuzzo, Marco, Osman, Amr, Lozano, Daniel P\u00e9rez, Thol\u00e9n, Mats O., Borgani, Riccardo, Haviland, David B., Ferrini, Giulia, Bylander, Jonas, Kockum, Anton Frisk, Quijandr\u00eda, Fernando, Delsing, Per, Gasparinetti, Simone, \"Robust Preparation of Wigner-Negative States with Optimized SNAP-Displacement Sequences\", 2022].\n\n#### Digital up- and down-conversion\nDigital up- and down-conversion are well-defined numerical operations and the accuracy of these DSP techniques is limited only by the number of bits [van Dijk, Jeroen P. G., Patra, Bishnu, Pellerano, Stefano, Charbon, Edoardo, Sebastiano, Fabio, Babaie, Masoud, \"Designing a DDS-Based SoC for High-Fidelity Multi-Qubit Control\", 2020].\nDigital frequency conversion does not suffer from the issues that affect its analog counterpart, such as local-oscillator leakage, amplitude and phase imbalance, drift or frequency-dependent nonlinearity.\n\nPresto outputs pulses and analyzes response using DSP on the FPGA.\nEach sample in the data stream is a complex number, encoding a pair of in-phase (I) and quadrature (Q) components.\nThe FPGA is clocked at 500\u00a0MHz and operates on two samples in parallel, resulting in a complex data stream with a sampling rate of 1\u00a0GS/s, on each of the 16 DAC and ADC channels.\n\nOn the pulse generation side, 16-bit signals generated by the FPGA are interpolated to a user-selected sampling rate (up to 10\u00a0GS/s) and up-converted with a fully-digital IQ mixer and a numerically-controlled oscillator (NCO).\nThe NCOs run at the full sampling rate of the DAC and have 48-bit frequency resolution and 18-bit phase resolution.\nThe data is then truncated to 14 bits before being output by the DAC.\nWith this scheme the DAC can output signals in a $\\pm$500\u00a0MHz band centered around the NCO frequency, programmable between 0 and 10\u00a0GHz with less than $40~\\mu$Hz resolution.\n\nOn the measurement side, signals are sampled by the ADC at the user-selected sampling rate (up to 5\u00a0GS/s) with 14-bit resolution and then extended to 16 bits to accommodate increased accuracy in subsequent filtering stages.\nData is then down-converted to baseband with a fully-digital IQ mixer and NCO.\nAt baseband the signals are decimated to 1\u00a0GS/s and analyzed as two complex samples in parallel by the FPGA.\n\nPresto has one independently programmable digital IQ mixer and NCO for every input and output channel.\nIf not all physical ports are needed, the digital mixers and NCOs from neighbouring channels can be combined and used on a single physical port, further extending the generation and acquisition of complex signals.\n\nDigital up- and down-conversion can be disabled, in which case the DSP operates with a data stream of real numbers at a rate of 2\u00a0GS/s.\nIn this direct-output mode of operation Presto performs a more traditional form of DSP, where signals are generated and acquired directly at baseband, for example to drive parametric coupling of two qubits or for up- and down-conversion with external analog IQ mixers.\n\n#### Event sequencer\n< g r a p h i c s >\n\nHigh-level functional schematics of the pulsed mode of operation.\nAt run time the event sequencer controls the signal generators for the outputs\nand the sampling and template-matching units for the inputs.\nA feedback unit connects the outcome of input-signal analysis to the pulse generation.\n\nThe architecture of the pulsed mode of operation is shown in Fig.\u00a0(Figure fig:pulsedtop).\nThe primary design goal was gate-based quantum computing where accurate timing of events, such as the application of control pulses and the analysis of readout pulses, is of primary importance.\nPresto controls these events with a sequence generator, or sequencer, implemented partially in the FPGA and partially as a `bare-metal' application (i.e. running without an operating system) on a real-time processing unit (RPU).\nThe RPU application is written in the Rust programming language, allowing for the generation of very complex measurement sequences that would be hard to implement in a generic and efficient way on the FPGA.\nTo maintain performance and real-time control of the sequence, we implemented time-controlled first-in-first-out (FIFO) buffers.\n\nAn experiment sequence is first specified at the level of the Python API [Intermodulation Products AB, \"Presto Python API\", 2022], and then translated into a sequence of events scheduled on a time line with a 2\u00a0ns grid (the inverse of the FPGA clock frequency).\nWhile the sequencer time grid is 2\u00a0ns, finer resolution can be achieved by adjusting waveform templates (see below).\nUltimately the timing accuracy in the execution of events is limited by the jitter of the master clock, which we measure to be much less than 1\u00a0ps.\n\nBefore the experiment is started, all user-defined data and parameters are uploaded into Presto, together with a list of timed events that describe the experimental sequence.\nMany different kinds of events can be scheduled, each event tied to a feature of signal generation, acquisition, processing and feedback.\nWe describe each feature in detail in the next sections.\n\nOnce the sequence is started and the experiment begins, the sequencer controls all signal generation, data acquisition and feedback with precise timing.\nThe instrument performs the whole measurement without interaction or communication with the controlling computer.\nWhen the measurement is finished the acquired data that is stored in Presto is downloaded to the controlling computer for further analysis.\nA single measurement sequence can last up to $\\approx$6.5 days, or $2^{48}$ clock cycles.\nA sequence can be repeated many times to internally perform averaging and/or parameter sweeps, for a virtually unlimited total run time ($\\approx$1.2 thousand years, or $2^{64}$ clock cycles).\n\n#### Signal generation\n< g r a p h i c s >\n\nThe signal generator for the outputs is built on templates (arbitrary waveforms) and carrier generators.\nTemplates are uploaded before the experiment.\nDuring the experiment, the event sequencer controls template-output timing,\nfrequency and phase of the carrier generators and scale factors.\nThe resources shown in this figure are replicated on each of the output channels.\n\nFigure\u00a0(Figure fig:DigitalOutput) shows a functional diagram of signal generation.\nEach output channel has 16 templates available for arbitrary waveforms, each storing up to 1022\u00a0ns of data, i.e. 1022 IQ pairs at 1\u00a0GS/s, with 16-bit resolution.\nTemplates are designed by the user and uploaded to Presto via the API, prior to execution.\nThe output from each template is controlled individually by the sequencer that can concatenate, superimpose and play templates in a loop, constructing complex waveforms in real time.\n\nThe 16 templates are divided into two groups of 8 within each channel, with each group having a dedicated carrier generator and a variable gain (scalar multiplier).\nSplitting the available templates into two groups with independent carrier generators and independent scaling allows Presto to efficiently synthesize displacements in the IQ plane, a useful feature for quantum state tomography of bosonic modes [Kudra, Marina, Kervinen, Mikael, Strandberg, Ingrid, Ahmed, Shahnawaz, Scigliuzzo, Marco, Osman, Amr, Lozano, Daniel P\u00e9rez, Thol\u00e9n, Mats O., Borgani, Riccardo, Haviland, David B., Ferrini, Giulia, Bylander, Jonas, Kockum, Anton Frisk, Quijandr\u00eda, Fernando, Delsing, Per, Gasparinetti, Simone, \"Robust Preparation of Wigner-Negative States with Optimized SNAP-Displacement Sequences\", 2022].\n\nThe carrier generators have 40-bit frequency resolution (0.5\u00a0mHz) and independent phase offsets for both I and Q in the data stream, with 40-bit resolution (6\u00a0prad).\nThe generators are also controlled by the sequencer which can retrieve parameters from look-up tables with 512 entries at 2\u00a0ns intervals, to change the frequency and phase of the carrier, in real time.\n\nAs shown in Fig.\u00a0(Figure fig:DigitalOutput), templates are either output as raw data, bypassing the carrier generator, or multiplied by the carrier to create envelopes that modulate the carrier tone.\nBecause the carrier generator and templates use the same sampling rate, the exact same output waveform could be achieved either as a raw template or by multiplying a carrier with an envelope template.\nThe main purpose of the carrier generator is therefore not up-conversion, but rather efficient implementation of e.g. frequency sweeps, without having to upload many templates that differ only in their carrier frequency.\nFrequency up-conversion is performed with the dedicated digital IQ mixer and NCO described in Sec.\u00a0<ref> and Fig.\u00a0(Figure fig:pulsedtop).\n\nData from templates in each group (either raw or as envelopes) are summed together and fed to a signed scalar multiplier with 17-bit resolution.\nThis scaling is controlled by the sequencer, with gain values taken from a user-programmable look-up table with 512 entries.\nThe two scaled outputs are finally summed together and sent to the digital up-conversion chain described in Sec.\u00a0<ref>.\n\n#### Signal acquisition\n< g r a p h i c s >\n\nThe signal inputs have two parallel paths that operate independently:\n(a) for sampling and storage, and (b) for template matching.\nSampling windows are controlled by the sequencer.\nSamples are initially stored in a high-bandwidth buffer and then averaged and stored in a larger but slower memory.\nTemplate matching multiplies the incoming samples with a reference template in real time, returning the sum at the end of the matching window.\n\nThere are two methods of analyzing signals sampled by the ADC after the digital down-conversion chain described in Sec.\u00a0<ref>: either with a store operation or with a template-matching operation.\nThe two operations can be performed in parallel on the same data stream.\n\nThe store operation [Fig.\u00a0(Figure fig:sampling)(a)] is similar to boxcar averaging, but with the capability to interleave averaging while stepping parameters.\nA high-bandwidth buffer is shared among all the input channels and it is capable of simultaneously receiving up to 16 data streams of complex values, each at 1\u00a0GS/s.\nThe entire buffer memory, up to 524\u00a0$\\mu$s of data or $2^{19}$ IQ pairs, is available for storage regardless of how many channels are streaming.\n\nData in this buffer is then transferred at a rate of 1\u00a0GS/s to a larger synchronous dynamic random-access memory (SDRAM) capable of storing up to $2^{29}$ samples with 32-bit precision (2\u00a0GB), equivalent to $268$\u00a0ms of sampled data.\nEach transfer can target a particular address in memory, where new data is summed to existing data in the SDRAM.\nTogether with the stepping of parameters by the sequencer, this architecture enables interleaved averaging of measurement results, to efficiently reject slow drift arising from temperature or gain variations in the measurement system.\n\nThe second method of analyzing signals is template matching [Fig.\u00a0(Figure fig:sampling)(b)], where the incoming signal $s$ (a complex-valued data stream) is multiplied with a reference template $\\tau$ (complex-valued arbitrary waveform) and accumulated over the template length.\nThe result is the overlap sum of the measured signal with the template,\n$$\n\n\\left< s, \\tau \\right> \\stackrel{\\text{def}}{=} \\Re \\left\\{ \\sum \\tau^* s \\right\\}\n\n$$\ngiving a single number that quantifies how well the signal matches the template.\nTemplate matching can be used to perform standard IQ demodulation:\nLoading one template with $\\cos(\\omega t)$ and another with $-\\sin(\\omega t)$ produces the I and Q components of the signal at the frequency $\\omega$.\nAnother use of template matching is to efficiently reduce data.\nTemplate matching is done in real time and does not rely on data stored in the buffer memory.\n\nTemplate matching with a known reference trace implements a so-called matched filter, an optimal linear filter maximizing signal-to-noise ratio.\nOne application of matched filtering is quantum state discrimination for the readout of superconducting qubits.\nHere two reference templates are calibrated from the measured response of the readout resonator, one when the qubit is in the ground and the other when the qubit is in the excited state.\nPerforming template matching then results in two numbers, describing how well the input matches each of the two references.\nThe extension to readout of a three-level qutrit, and beyond, is realized by matching to more templates as discussed in Appendix\u00a0<ref>.\nThere are a total of 128 template-matching units for simultaneous discrimination of multiple states, on multiple channels.\n\n#### Feedback\n< g r a p h i c s >\n\nThe feedback system does pairwise addition on template-matching outputs, comparing the result to a threshold.\nThe Boolean results of the comparisons are subjected to a logical operator to create a mask that gates output templates.\n\nFigure\u00a0(Figure fig:feedback) shows a schematic of the feedback.\nThe outcome of the 128 template-matching units, $\\left< s, \\tau_i \\right>$ with $i\\in [0,127]$, are used to enable and disable output pulses with low latency.\nThe outcomes are first added pairwise, $\\left< s, \\tau_i \\right> + \\left< s, \\tau_{i+1} \\right>$, and then compared to a user-programmable threshold $\\theta_{i,i+1}$.\nIf the outcome is greater than the threshold, Boolean value True is generated, otherwise False.\nThese 64 Boolean values are fed to a configurable operator to generate an 8-bit mask.\nThe output templates can be gated with the bits of this mask.\n\nAs an example, we describe the use of this feedback feature for active reset of a qubit.\nWe begin by calibrating reference templates $\\tau_\\mathrm{g}$ and $\\tau_\\mathrm{e}$ for the readout of the qubit in its ground and excited state, respectively (see Appendix\u00a0<ref>).\nWe upload $\\tau_\\mathrm{e}$ and $-\\tau_\\mathrm{g}$ into two of the 128 available slots in the template-matching engine.\nWe program a threshold $\\theta_{eg} = (\\lVert \\tau_\\mathrm{e} \\rVert^2 - \\lVert \\tau_\\mathrm{g} \\rVert^2)/2$,\nwhere $\\lVert \\tau \\rVert^2 = \\left< \\tau, \\tau \\right>$.\nWe also program an output pulse $\\pi_\\mathrm{eg}$ to flip the qubit from the excited to the ground state, i.e. a $\\pi$ pulse.\nFinally, we gate the output pulse $\\pi_\\mathrm{eg}$ using the first bit of the feedback mask.\nWe realize this with a trivial Boolean operator that simply sets this bit to 1, if the sum of the first template-matching pair is greater than the threshold.\n\nThe user schedules the template matches on both $\\tau_\\mathrm{e}$ and $-\\tau_\\mathrm{g}$ in the sequencer, with the output of the conditional $\\pi_\\mathrm{eg}$ right after the end of the matching window.\n$\\pi_\\mathrm{eg}$ will be output only if the acquired signal trace matches $\\tau_\\mathrm{e}$ better than $\\tau_\\mathrm{g}$, i.e. only if the qubit is most likely in its excited state.\nWe show the results of experiments with this active-reset technique in Sec.\u00a0<ref>.\nWe discuss the implementation of a more advanced feedback algorithm, the reset of a quantum three-level system, or qutrit, in Appendix\u00a0<ref>.\n\nThe total latency of the feedback engine has many contributions: propagation delay through the experimental setup, latency in the RF data converters, and processing latency in the programmable logic.\nThe latter introduces 5 clock cycles of latency, equivalent to 10\u00a0ns.\nPropagation delay is dependent only on the experimental setup external to Presto, and is typically about 5\u00a0ns per meter of coaxial cable.\nThe total latency is dominated by the contribution from the high-speed ADCs and DACs.\nThis contribution is intrinsic to the RFSoC platform, and varies depending on the features enabled in the converters and on the chosen sampling rate.\nOver the different converter configurations that are most useful, we measure a combined total round-trip latency between 184\u00a0ns and 254\u00a0ns.\n\nThe round-trip latency can play an important role in the design of experiments and algorithms that involve feedback, such as the active reset of a qubit described above.\nIn such experiments the latency $\\lambda$ imposes a minimum reaction time between the measurement of the qubit in its excited state and the application of a $\\pi$ pulse to reset it to its ground state.\nDuring this \u201cdead time\u201d, the qubit could spontaneously decay to the ground state with probability $1 - \\mathrm{e}^{- \\lambda / T_1}$, and thus the $\\pi$ pulse would erroneously excite the qubit again.\nBecause $\\lambda$ is dominated by the intrinsic latency in the RFSoC platform, lowering the error rate amounts to improving the quality of the qubit by increasing its relaxation time $T_1$.\n\n### Analog design\n< g r a p h i c s >\n\nFull-scale output range of the RF channels with the front-end card as function of frequency.\nThe curves show the performance for the high-frequency (green), mid-frequency (orange) and low-frequency (blue) configurations.\n\nThe signals leaving and entering the RFSoC development boards are not well suited for interfacing with common experimental setups and auxiliary instruments.\nThe RF signals are differential with 100$\\Omega$ impedance, centered around a rather large common-mode voltage.\nDigital signals are 1.8\u00a0V low-voltage transistor-transistor logic (LVTTL), which is rather low for interfacing to a wide variety of instruments.\nMoreover, both RF and digital signals are connected directly to the FPGA pins, increasing the risk that an accidental static discharge could permanently damage the most delicate and expensive component of the platform.\n\nTo address these issues we designed three printed circuit boards (PCB) to transform signals to and from the development board.\nThe first PCB is a front-end board which connects directly to the development board through two high-density, high-bandwidth, board-to-board connectors.\nThe front-end board contains the analog circuits for all RF signals and it fans out power and digital signals to the two other PCBs: one for digital triggers/markers, and one for DC biasing.\n\nThe front-end board is designed for versatility, with superconducting qubit experiments in mind.\nThe design makes all 16 output and 16 input channels of the ZCU216 available to the user.\nThe 16 outputs come in three variants: 8 high frequency, 4 mid frequency and 4 low frequency.\nThe high and mid frequency variants use AC-coupling capacitors to reject the common-mode voltage and a balun transformer to convert from 100$\\Omega$ differential to 50$\\Omega$ single-ended signals.\nThe only difference between high and mid frequency range is the choice of balun transformer:\nthe high frequency outputs use a 3000-8000\u00a0MHz transformer (Mini-Circuits NCS2-83+),\nand the mid frequency outputs use a 10-3000\u00a0MHz transformer (Mini-Circuits TCM2-33WX+).\nThe low frequency outputs use a differential to single-ended amplifier (Texas Instruments THS3217), allowing these channels to be DC coupled and providing more output power, at the cost of a much lower bandwidth of 500\u00a0MHz.\n\nFigure\u00a0(Figure fig:outrng) shows the frequency response of the three different variants.\nWith this front-end configuration, one Presto unit can e.g. drive one readout line and 7 qubit control lines using the 8 high-frequency channels, with the 8 mid and low frequency channels driving the couplers.\nOn the input side all 16 inputs are AC coupled, half of them use the high frequency and half of them use the mid frequency configuration.\n\nThe RFSoC development boards also feature two high-frequency clock outputs, user programmable up to 15\u00a0GHz.\nThese signals are also differential with $100~\\Omega$ impedance, so we transform them with AC-coupling capacitors and a 12-18\u00a0GHz balun transformer (Mini-Circuits NCR2-183+) before exposing them to the front panel.\nThese two outputs can be configured independently in frequency and output power, and they are locked in frequency and phase to all of Presto's inputs and outputs.\nThey are, however, limited to continuous-wave operation at a single frequency.\nFor superconducting quantum circuits, these outputs are useful for pumping parametric amplifiers such as Josephson parametric amplifiers (JPA) [Aumentado, Jose, \"Superconducting Parametric Amplifiers: The State of the Art in Josephson Parametric Amplifiers\", 2020] and travelling-wave parametric amplifiers (TWPA) [Planat, Luca, Ranadive, Arpit, Dassonneville, R\u00e9my, Puertas Mart\u00ednez, Javier, L, S\u00e1\u0301stien, Naud, C\u00e9\u013ae, Buisson, Olivier, Hasch-Guichard, Wiebke, Basko, Denis M., Roch, Nicolas, \"Photonic-Crystal Josephson Traveling-Wave Parametric Amplifier\", 2020].\n\nThe second PCB processes digital signals to be used as triggers and markers.\nIt exposes 4 inputs and 4 outputs, each with a bus transceiver that makes the signals 3.3\u00a0V compatible and a resistive network to maintain a well defined voltage on open inputs and to provide some protection against static discharge.\nOutputs have 50$\\Omega$ source impedance and each uses two transceivers in parallel to provide enough current to drive a 50$\\Omega$ load.\nThe inputs have an impedance of 10\u00a0k$\\Omega$ so that they can be driven by low-power CMOS sources.\nThe outputs can trigger or mask other instruments and they are controlled by the event sequencer, time-aligned with all other events in the experimental sequence.\nFor example, a digital marker can gate an external pump to a parametric amplifier, so that it is active only while reading out a resonator, thus reducing noise propagating from the amplifier to the qubits.\nThe digital inputs are also available to the programmable logic and the event sequencer.\n\nThe third PCB provides DC-biasing capabilities.\nIt has 16 independent voltage outputs with 16-bit resolution, $1~k\\Omega$ source impedance, and five user-selected ranges: 3.3\u00a0V, 6.6\u00a0V, $\\pm$3.3\u00a0V, $\\pm$6.6\u00a0V and $\\pm$10\u00a0V.\nThese DC voltages are regulated by an on-board reference with $<$125\u00a0ppm accuracy and their noise density at 1\u00a0kHz is 60\u00a0$\\mathrm{nV}/\\sqrt{\\mathrm{Hz}}$, or 1.7\u00a0$\\mathrm{\\mu V}$\u00a0rms integrated over the band 0.1\u00a0-\u00a010\u00a0Hz.\nThe outputs are controlled in real time during an experiment by the event sequencer.\n\n### Synchronization and scaling\nMulti-channel synchronization and timing are critical features for quantum experiments.\nAll clocks for the programmable logic, the RF converters and the high-frequency continuous outputs, are generated from a single master clock in the RFSoC.\nExtra care is put into ensuring that Presto's entire clock-generation chain has a single, deterministic latency.\nWe achieved this synchronization with an appropriate configuration of the on-board phase-locked loops (PLLs), and through the use of an RFSoC feature called multi-tile synchronization (MTS).\nMTS ensures that the sampling of all input and output channels, which might run at different rates, are frequency and phase aligned.\nWe further augmented MTS with a calibration to ensure that the alignment is reproducible across reconfiguration of the programmable logic.\n\nWith this level of synchronization across all 16 channels, we measure the phase noise of Presto to be -115.26\u00a0dBc/Hz at 10\u00a0kHz offset from a 3\u00a0GHz carrier, and the rms phase jitter to be 105\u00a0fs integrated between 12\u00a0kHz and 20\u00a0MHz.\nThis phase noise is equivalent to -124.80\u00a0dBc/Hz on a 1\u00a0GHz carrier, or -109.24\u00a0dBc/Hz on a 6\u00a0GHz carrier.\nThe jitter between any two output channels is less than 1\u00a0ps, limited by the measuring oscilloscope.\n\nThe maximum number of outputs on a single Presto unit is 16, however, much higher channel count is required for the current architecture of quantum processors as they scale up the number of qubits and couplers [Krinner, Sebastian, Storz, Simon, Kurpiers, Philipp, Magnard, Paul, Heinsoo, Johannes, Keller, Raphael, Luetolf, Janis, Eichler, Christopher, Wallraff, Andreas, \"Engineering cryogenic setups for 100-qubit scale superconducting circuit systems\", 2019] [Lecocq, F., Quinlan, F., Cicak, K., Aumentado, J., Diddams, S. A., Teufel, J. D., \"Control and readout of a superconducting qubit using a photonic link\", 2021].\nTo meet this challenge we support the synchronization of multiple Presto units with a dedicated device which we call Metronomo.\nMetronomo is a clock source that exposes 7 pairs of device and SYSREF clocks.\nThe device clocks synchronize different Presto units with a programmable reference frequency.\nTypically 10\u00a0MHz or 100\u00a0MHz clock reference is used, but they can be as high as 3\u00a0GHz.\nThe SYSREF signals are single synchronization pulses, precisely aligned to the device clock outputs.\nThese serve as timing references to provide low skew and jitter between different Presto units.\nWith Metronomo we observe that the jitter between two different Presto units is indistinguishable from the jitter between outputs on the same unit.\n\nOne can synchronize up to 7 Presto units with one Metronomo at the center of a star configuration, for a total 112 synchronized output channels.\nIf more outputs are need, multiple Metronomos are designed to be connected in a cascade: one Metronomo can synchronize 7 other Metronomos, which in turn synchronize 7 Presto units each for a total of 784 output channels.\nWhile Metronomo is designed to support such a configuration, the performance of the cascaded setup has not yet been tested.\n\n## Experiments\n### Qubit sample and measurement configuration\nParameter     Qubit 1     Qubit 2\n\n$\\omega_\\mathrm{R} / 2\\pi$     6.17 GHz     6.03 GHz\n\n$\\kappa / 2\\pi$     615 kHz     455 kHz\n\n$\\omega_{01} / 2\\pi$     3.56 GHz     4.09 GHz\n\n$\\alpha / 2\\pi$     -240 MHz     -231 MHz\n\n$\\chi / 2\\pi$     -155 kHz     -302 kHz\n\n$g / 2\\pi$     69.3 MHz     74.3 MHz\n\n$\\chi / \\kappa$     -0.25     -0.66\n\n$\\Gamma^{-1}_{Purcell}$     370 $\\mu$s     240 $\\mu$s\n\n$T_1$     46 $\\pm$ 7 $\\mu$s     34 $\\pm$ 9 $\\mu$s\n\n$T_2^\\mathrm{echo}$     55 $\\pm$ 13 $\\mu$s     34 $\\pm$ 6 $\\mu$s\n\nMeasured qubit and resonator parameters.\n$\\omega_\\mathrm{R}$ and $\\kappa$ are the bare resonator frequency and coupling rate to the transmission line.\n$\\omega_{01}$ and $\\alpha$ are the qubit transition frequency and anharmonicity.\n$g$ is the coupling rate between the resonator and the qubit.\n$\\chi$ is the dispersive shift such that $\\omega_\\mathrm{R} \\pm \\chi$ are the dressed frequencies of the readout resonator.\n$\\Gamma_{Purcell}$ is the Purcell rate [Sete, Eyob A., Martinis, John M., Korotkov, Alexander N., \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015].\n$T_1$ and $T_2^\\mathrm{echo}$ are the energy-relaxation time and decoherence time of the qubit: nominal values and uncertainties are the median and interquartile range, respectively, of $\\approx 2.5$ thousand measurements spanning $2.5$ days.\n\n< g r a p h i c s >\n\nCharacterization of qubit 2 with Presto.\nGray dots show measurement data, solid lines show fits to theory.\n(a) Rabi oscillations with a sequence of ten DRAG-compensated control pulses, each with a sine-squared shape and duration 20\u00a0ns.\nThe fitted amplitude for a $\\pi$ gate is 51.86\n(b) Measurements of energy-relaxation time $T_1$ and decoherence time $T_2$ from a Ramsey-echo experiment.\n(c) Chevron pattern from a series of Ramsey measurements.\n(d, e) Pulsed resonator spectroscopy showing the steady-state resonator response $R_{\\mathrm{g/e}}(f)$ when the qubit is prepared in the ground (blue) and excited (orange) states: (d) amplitude $A$; (e) phase $\\phi$.\n(f) Separation in phase space between the two steady-state responses: $S(f) = |R_\\mathrm{e}(f) - R_\\mathrm{g}(f)|$.\nThe frequency of maximum separation is the optimal readout frequency.\n\nWe showcase Presto's capabilities on a sample consisting of two fixed-frequency superconducting qubits coupled by a frequency-tunable coupler [McKay, David C., Filipp, Stefan, Mezzacapo, Antonio, Magesan, Easwar, Chow, Jerry M., Gambetta, Jay M., \"Universal Gate for Fixed-Frequency Qubits via a Tunable Bus\", 2016].\nA description of the measurement setup is given in Appendix\u00a0<ref>, including details of the bandpass filters which are necessary with DDS at microwave frequencies.\nThe qubit circuit is described in detail in Ref.\u00a0.\nEach qubit is controlled by a dedicated microwave line, and each is dispersively coupled to its own readout resonator.\nBoth resonators are coupled in a notch configuration to a single microwave line for frequency-multiplexed readout.\nTable\u00a0(Table tab:parameters) shows a summary of the measured qubit and resonator parameters.\nThese parameters are obtained with standard single-qubit characterization techniques, as shown in Fig.\u00a0(Figure fig:combo_meas).\n\nTo control the qubits we use DRAG-compensated [Krantz, P, Kjaergaard, M, Yan, F, Orlando, T. P, Gustavsson, S, Oliver, W. D, \"A quantum engineer's guide to superconducting qubits\", 2019] microwave pulses with a $\\sin^2(x)$ envelope, where $x=\\pi t / \\tau$ and $\\tau = 20~\\mathrm{ns}$ is the duration of one pulse.\nTo readout the qubit, we apply a $1.4~\\mathrm{\\mu s}$-long pulse composed of four segments with constant complex amplitude.\nThis readout pulse is an adaptation of the CLEAR pulse [McClure, D. T., Paik, Hanhee, Bishop, L. S., Steffen, M., Chow, Jerry M., Gambetta, Jay M., \"Rapid Driven Reset of a Qubit Readout Resonator\", 2016]: the first two segments rapidly populate the readout resonator with photons, and the last two segments reset the resonator to its ground state, regardless of the measured state of the qubit.\nThe maximum instantaneous power in the readout pulse is approximately $-115$\u00a0dBm at the sample input.\n\nThe code used to perform the measurements reported here is released as open source under the MIT license, and is available online in a repository hosted on GitHub [Intermodulation Products AB, \"presto-measure GitHub repository\", 2022].\n\n### Active qubit reset\n< g r a p h i c s >\n\nHistograms of single-shot readouts of the qubit in thermal equilibrium (a), and after a conditional pulse to reset the qubit in its ground (b) or excited (c) state.\nThe histograms (gray) are calculated over $10^5$ measurements with 316 bins.\nThe resulting distribution is fitted to a bimodal Gaussian distribution, and the individual fitted components are plotted in blue for the ground state and orange for the excited state.\n\nWe use the template-matching and feedback features of Presto to perform single-shot readout of the state of qubit 2, actively resetting the qubit to the ground state if we measure it in the excited state (Fig.\u00a0(Figure fig:reset)).\nThe histogram in Fig.\u00a0(Figure fig:reset)(a) is built from $10^5$ independent measurements of the qubit state starting from thermal equilibrium, achieved by waiting a time $500~\\mathrm{\\mu s} \\gg T_1$ between each measurement.\nWe perform template matching over a 1\u00a0$\\mu$s-long window, projecting in real time each measured single-shot trace $s$ onto two calibrated templates $\\tau_\\mathrm{g}$ and $\\tau_\\mathrm{e}$ (uploaded to Presto before the measurement) representing the average ground- and excited-state responses, respectively.\nAs described in Sec.\u00a0<ref>, Presto's feedback engine compares the template-matching outcome to a threshold, such that $\\left< s, \\tau_\\mathrm{e} \\right> - \\left< s, \\tau_{g} \\right> \\ge \\theta_{eg}$ corresponds to the excited state being the most probable outcome of the measurement.\nBased on this comparison we enable or disable the output of a $\\pi$ pulse to flip the state of the qubit.\nA second readout and template-matching operation is then performed immediately after this conditional reset to assess its effectiveness.\n\nFrom the first of the two readout pulses we can determine the excited-state population $P_\\mathrm{therm}$ when the qubit is in equilibrium with its environment.\nFitting a bimodal Gaussian distribution to the measurements we obtain an excited-state population of $P_\\mathrm{therm}=5.8\\%$, roughly equivalent to an effective temperature of $T_\\mathrm{eff} = \\hbar \\omega_{01} / [k_\\mathrm{B} \\log (1/P_\\mathrm{therm} - 1)] = 71~\\mathrm{mK}$, significantly higher than the temperature measured by the cryostat thermometer at $10~\\mathrm{mK}$.\n\nNevertheless, the fact that the quantum circuit is in a mixed state when quiescent, provides an opportunity to test Presto's feedback engine.\nUsing the same fitting procedure on the data from the second readout (after the conditional reset pulse),\nwe find an excited-state population of 0.7\nPresto's feedback engine is cooling the qubit.\n\nPreparing the qubit in $\\left| \\mathrm{e} \\right>$ with one round of feedback results in an excited-state population of 94.2\nThe lower state-preparation fidelity compared with $\\left| \\mathrm{g} \\right>$ is consistent with qubit decay during the feedback iteration.\n\nFrom the fit to the histogram of Fig.\u00a0(Figure fig:reset)(a), we also obtain an indication of the measurement infidelity due to overlap errors.\nWe analyze the bimodal distribution of template matching results, obtaining the mean $\\mu_\\mathrm{g}<0$ and standard deviation $\\sigma_\\mathrm{g}$ for the ground state, and $\\mu_\\mathrm{e}>0$ and $\\sigma_\\mathrm{e}$ for the excited state.\nThe overlap error is then $\\epsilon_\\mathrm{overlap}=1-(\\epsilon_\\mathrm{g} + \\epsilon_\\mathrm{e})/2$, where $\\epsilon_i$ is the probability of assigning the wrong state given a qubit in state $i$: $\\epsilon_i = [1-\\mathrm{erf}(x_i)]/2$, where $\\mathrm{erf}$ is the error function and $x_i=|\\mu_i| / (\\sqrt{2} \\sigma_i)$.\nIn our measurement $\\epsilon_\\mathrm{overlap} = 9.7 \\times 10^{-4}$, which imposes an upper limit on measurement fidelity of $\\mathcal{F}_\\mathrm{meas}<1-\\epsilon_\\mathrm{overlap}=99.903\\%$.\n\n### Randomized benchmarking\n< g r a p h i c s >\n\nSingle-qubit randomized benchmarking, showing the probability of measuring the qubit in the ground state as function of the number of Clifford gates in the sequence.\nFor each sequence length $m$, 50 different realizations of the random sequence are applied.\nFor each realization, the measurement is repeated and averaged 1000 times.\nBlue dots and gray bars show the median and interquartile range, respectively, over the single realizations.\nAn exponential decay of the form $A \\alpha ^ m + B$ is fit (orange dashed line) to the average response over all realizations (blue dots).\nThe obtained error per Clifford is $(1-\\alpha)/2 = (2.8 \\pm 1.2) \\times 10^{-4}$, corresponding to an average fidelity of $\\mathcal{F} = 99.972 \\pm 0.012 \\%$.\n\nWe characterize the quality of the control signals from Presto with randomized benchmarking on qubit 2.\nWe use Qiskit [Unknown Author, \"Qiskit: An Open-source Framework for Quantum Computing\", 2021] to generate random sequences of Clifford gates.\nEach sequence is trans-compiled into a series of $\\sqrt{X}$ gates ($\\pi/2$ pulses) and virtual $Z$ gates (phase rotations of all subsequent $\\pi/2$ pulses) [McKay, David C., Wood, Christopher J., Sheldon, Sarah, Chow, Jerry M., Gambetta, Jay M., \"Efficient Z gates for quantum computing\", 2017].\nWe execute 50 different random sequences of gates starting from thermal equilibrium, averaging over 1000 measurements for each sequence.\nThe results are shown in Fig.\u00a0(Figure fig:rb) for 13 different sequence lengths.\nWe obtain an average single-qubit fidelity of $99.972 \\pm 0.012\\%$, as described in the caption to Fig.\u00a0(Figure fig:rb).\nThis fidelity is consistent with the theoretical limit set by the qubits' $T_1$ and $T_2$ times [Abad, Tahereh, Fern\u00e1ndez-Pend\u00e1s, Jorge, Kockum, Anton Frisk, Johansson, G\u00f6ran, \"Universal fidelity reduction of quantum operations from weak dissipation\", 2021] $\\mathcal{F}_{\\sigma_x} = 1 - \\frac{\\Gamma_1 + \\Gamma_\\phi}{3}\\tau = 99.971 \\pm 0.004 \\%$, where $\\Gamma_\\phi = \\Gamma_2 - \\Gamma_1 / 2$ is the pure dephasing rate, $\\Gamma_i = 1/T_i$ and $\\tau=20~\\mathrm{ns}$ is the duration of a control pulse.\nThus, at this level of fidelity, we conclude that Presto is an insignificant source of error.\n\n### iSWAP\n< g r a p h i c s >\n\nTune-up of an iSWAP gate.\nThe top panels show the probability $P_\\mathrm{e}$ of measuring qubit 1 (a) and qubit 2 (b) in the excited state, measured with a frequency-multiplexed readout.\n$P_\\mathrm{e}$ is shown as function of the duration and frequency of a pulse on the tunable coupler.\nThe lower panel (c) shows a line cut of $P_\\mathrm{e}$ along the blue and orange lines: gray dots are measured data, solid lines are numerical fits to a cosine function.\n\nFigure\u00a0(Figure fig:iswap) shows the calibration and characterization of an exchange-type two-qubit gate [Ganzhorn, M., Salis, G., Egger, D. J., Fuhrer, A., Mergenthaler, M., M\u00fcller, C., M\u0142\u0308ler, P., Paredes, S., Pechal, M., Werninghaus, M., Filipp, S., \"Benchmarking the noise sensitivity of different parametric two-qubit gates in a single superconducting quantum computing platform\", 2020] (iSWAP).\nA DC flux of $0.26~\\Phi_0$ is applied to the coupler to select its operating point for the entire measurement sequence.\nWe start the sequence by applying a $\\pi$ pulse to qubit 2, to initialize the state $\\left|01\\right>$, i.e. qubit 1 in the ground state and qubit 2 in the excited state.\nWe then apply a flux drive with $0.21~\\Phi_0$ amplitude to the tunable coupler, varying the drive frequency and duration to enable the exchange of quantum information between the two qubits.\nAt the end of this coupler pulse we simultaneously measure the state of both qubits with a frequency-multiplexed readout pulse.\nFigure\u00a0(Figure fig:iswap) shows both qubit measurement probabilities as a function of the frequency and duration of the iSWAP pulse.\nA cut of this data set at 534.5\u00a0MHz shows that we can perform the iSWAP operation in 300\u00a0ns.\nFurther experiments are needed to optimize this two-qubit gate.\nA future publication will discuss more thoroughly the advantages that Presto's phase synchronization and DDS offer for two-qubit gates, as well as the achievable gate fidelities.\n\n## Conclusions\nWe described Presto, a general-purpose microwave platform for qubit readout and control based on the third-generation RFSoC.\nPresto uses digital methods that enable microwave-signal synthesis and real-time analysis, without external local oscillators and analog IQ mixers for up- and down-conversion.\nWith 16 input and 16 output channels in a 2U 19-inch rack format, Presto offers high channel density with all channels synchronized by one master clock.\nMultiple Presto units can be synchronized with deterministic latency, providing the large number of synchronous channels needed for the control of future quantum processors.\n\nA Python API provides flexible and high-level access to the FPGA and other digital hardware, required in a general-purpose instrument for experimentation with superconducting quantum circuits.\nThe digital nature of this microwave platform, with tight integration between data converters, FPGA and processing system, makes it possible to easily implement a variety of features through programming.\nCombined with its general-purpose analog front-end, Presto is easily adapted with additional features to meet the demands of future experiments.\n\nWe showed how Presto is used to characterize superconducting qubits.\nWe used its template-matching feature for single-shot state discrimination and its low-latency feedback to implement conditional reset of a single qubit.\nWe showed randomized benchmarking of single-qubit gates, demonstrating a fidelity of 99.972\nWe also implemented an iSWAP two-qubit gate.\nIn all of these experiments, Presto was the only instrument used for control and readout.\n\nThese initial results are encouraging and they demonstrate that Presto and the DDS techniques upon which it is built, are not an additional source of error at this level of fidelity.\nA next step in testing Presto is randomized benchmarking of two qubit gates.\nBeyond that we look forward to using Presto for the control of more coherent qubits, and toward demonstrating Presto's synchronous multi-channel capability on the control of multi-qubit chips.\n\nThe authors thank Joe Aumentado and the Advanced Microwave Photonics Group at NIST Boulder, CO for providing the Josephson parametric amplifier used in this study.\nThe authors acknowledge funding from the Knut and Alice Wallenberg Foundation (KAW) through the Wallenberg Centre for Quantum Technology (WACQT) and the Wallenberg Launch Pad (WALP).\nMOT, RB and DBH are part owners of Intermodulation Products AB, which manufactures and sells the microwave platform described in this manuscript.\n\n## Continuous-wave measurements\n< g r a p h i c s >\n\nTow-tone spectroscopy in continuous-wave mode.\nThe image shows the response of the resonator to a probe tone with constant amplitude at 6.03\u00a0GHz,\nwhile a pump tone is swept in frequency and power.\nThe white text marks the visible transition frequencies.\nTransitions $\\left|\\mathrm{g}\\right> \\rightarrow \\left|\\mathrm{f}\\right>$ and $\\left|\\mathrm{g}\\right> \\rightarrow \\left|\\mathrm{h}\\right>$ are two-photon and three-photon transitions, respectively.\n\nThe continuous-wave mode of operation turns Presto into a multifrequency lock-in amplifier [Intermodulation Products AB, \"Multifrequency Lockin Basics\", 2022].\nPresto generates and outputs a microwave frequency comb with up to 192 tones, with frequency, amplitude and phase at each tone independently defined by the user.\nAs in the pulsed mode described in the main text, the comb is initially generated at sampling rate 1\u00a0GS/s and then interpolated up to the sampling rate of the DAC.\nA digital IQ mixer and NCO up-convert the comb to the desired passband, in a 1\u00a0GHz band centered around a 0-9\u00a0GHz carrier.\nOn the input side, 192 demodulators are available to measure the lock-in components of an incoming signal, all relative to one common reference phase.\nThe frequency and phase of the demodulators are independent from that of the generators for the output comb.\nThe demodulation rate is selected by the user between 1\u00a0Hz and 1\u00a0MHz.\n\nFigure\u00a0(Figure fig:twotone_cw) shows a two-tone spectroscopy measurement using the continuous-wave mode.\nThe spectral line on the right is the $\\left|\\mathrm{g}\\right> \\rightarrow \\left|\\mathrm{e}\\right>$ transition,\nthe faint line on the bottom left is the $\\left|\\mathrm{e}\\right> \\rightarrow \\left|\\mathrm{f}\\right>$ transition,\nthe line at the center is the two-photon $\\left|\\mathrm{g}\\right> \\rightarrow \\left|\\mathrm{f}\\right>$ transition,\nand the line on the upper left is the three-photon $\\left|\\mathrm{g}\\right> \\rightarrow \\left|\\mathrm{h}\\right>$ transition.\n\n## Calibration of reference templates for readout\n< g r a p h i c s >\n\nCalibration of template matching for qubit readout.\n(a) Normalized I quadrature of the readout pulse with four segments of constant amplitude and phase.\n(b) Normalized I quadrature of the measured resonator response when the qubit is in its ground (blue) and excited (orange) state.\n(c) Normalized distance in the complex plane between the traces in panel (b).\nThe gray area shows the template-matching window that maximizes the measurement fidelity.\n\nWe design the readout pulse to maximize the measurement fidelity and minimize the number of photons left in the resonator after the pulse.\nWe use a pulse composed of four constant-amplitude segments [McClure, D. T., Paik, Hanhee, Bishop, L. S., Steffen, M., Chow, Jerry M., Gambetta, Jay M., \"Rapid Driven Reset of a Qubit Readout Resonator\", 2016], each of duration $350~\\mathrm{ns} \\approx 1/\\kappa$ [Fig.\u00a0(Figure fig:AppendixB)(a)].\nTwo ring-up segments rapidly increase the number of photons in the cavity, thus increasing the state separation and enhancing the readout fidelity [Sete, Eyob A., Martinis, John M., Korotkov, Alexander N., \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015].\nTwo ring-down segments rapidly force the resonator back to its ground state at the end of the pulse.\nWe optimize the amplitude and phase of the four segments by solving the linear differential equation that models the resonator for the parameters given in Table\u00a0(Table tab:parameters).\n\nWith this readout pulse we measure the response of the resonator when the qubit is in the ground and excited state.\nWe first acquire two preliminary reference templates $\\tilde{\\tau}_\\mathrm{g}$ and $\\tilde{\\tau}_\\mathrm{e}$ by preparing the qubit in its ground state and excited state (applying a $\\pi$\u00a0pulse), respectively.\nEach template is formed by averaging the resonator response to $10^6$ readout pulses.\nDue to the rather large thermal population [Fig.\u00a0(Figure fig:reset)(a)], $\\tilde{\\tau}_\\mathrm{g}$ is contaminated by a small fraction of resonator response with the qubit in its excited state, and vice versa for $\\tilde{\\tau}_\\mathrm{e}$ .\n\nTo further refine the reference templates, we perform a second measurement with two readout pulses separated by a small delay.\nWe perform template matching (Sec.\u00a0<ref>) on the first readout pulse with $\\tilde{\\tau}_\\mathrm{g}$ and $\\tilde{\\tau}_\\mathrm{e}$, while storing the response of the resonator to the second readout.\nWe then post-select the measured traces from the second readout, conditioned on the outcome of template matching on the first readout.\nThus we average only the traces with the qubit truly in its ground (excited) state to obtain refined reference templates $\\tau_\\mathrm{g}$ ($\\tau_\\mathrm{e}$).\nThese refined reference templates are shown in Fig.\u00a0(Figure fig:AppendixB)(b).\n\nFinally, we select the optimal time window for template matching, which is limited to 1022\u00a0ns in the current firmware.\nWe select the 1022-ns window that maximizes the observed state separation $d = \\int \\left| \\tau_\\mathrm{e} - \\tau_\\mathrm{g} \\right| \\mathrm{d}t$.\nNote that the reference templates $\\tau_\\mathrm{g}$ and $\\tau_\\mathrm{e}$ are complex valued and $d$ is the integral of their separation in the complex plane.\nThe time window that maximizes $d$ is the optimal template-matching window for performing state discrimination, since measurement fidelity increases with state separation [Sete, Eyob A., Martinis, John M., Korotkov, Alexander N., \"Quantum theory of a bandpass Purcell filter for qubit readout\", 2015].\nFigure\u00a0(Figure fig:AppendixB)(c) shows the measured state separation $d$ and the time window for optimal matching.\n\n## Active qutrit reset\nPresto's feedback mechanism can be used to actively reset a quantum 3-level system, or qutrit [Magnard, P., Kurpiers, P., Royer, B., Walter, T., Besse, J.-C., Gasparinetti, S., Pechal, M., Heinsoo, J., Storz, S., Blais, A., Wallraff, A., \"Fast and Unconditional All-Microwave Reset of a Superconducting Qubit\", 2018].\nThe procedure is analog to the active qubit reset described in Sec.\u00a0<ref> and Sec.\u00a0<ref>.\nSay we have calibrated reference templates for the qutrit in its ground $\\tau_\\mathrm{g}$, first excited $\\tau_\\mathrm{e}$ and second excited $\\tau_\\mathrm{f}$ states.\nWe compute the thresholds $\\theta_{ij} = (\\lVert \\tau_i \\rVert^2 - \\lVert \\tau_j \\rVert^2)/2$,\nwhere $\\lVert \\tau \\rVert^2 = \\left< \\tau, \\tau \\right>$ and $i,j \\in \\left\\{\\mathrm{e},\\mathrm{g},\\mathrm{f}\\right\\}$.\nFor convenience, we define the comparison result $R_{ij} \\stackrel{\\text{def}}{=} \\left[ \\left< s, \\tau_\\mathrm{i} \\right> - \\left< s, \\tau_{j} \\right> \\ge \\theta_{ij} \\right]$, which can be true or false (1 or 0).\n\nWe program the first template-matching pair with $\\tau_\\mathrm{e}$ and $-\\tau_\\mathrm{g}$ and a threshold of $\\theta_\\mathrm{eg}$.\nThis comparison will yield $R_\\mathrm{eg}=1$ if the measured trace matches $\\tau_\\mathrm{e}$ better than $\\tau_\\mathrm{g}$, and 0 otherwise.\nA second template-matching pair is programmed with $\\tau_\\mathrm{f}$ and $-\\tau_\\mathrm{e}$ and a threshold of $\\theta_\\mathrm{fe}$.\nThe third pair is programmed with $\\tau_\\mathrm{g}$, $-\\tau_\\mathrm{f}$ and $\\theta_\\mathrm{gf}$.\n\nWe program two possible output pulses, $\\pi_\\mathrm{eg}$ and $\\pi_\\mathrm{fg}$, that reset the qutrit to its ground state, conditioned on it being in the first or second excited state, respectively.\nThe reset from f to g could be implemented as the sequence of two pulses, intermediately putting the qutrit in its first excited state.\nThe output of $\\pi_\\mathrm{eg}$ should be enabled if $R_\\mathrm{eg}=1$ and $R_\\mathrm{fe}=0$, and disabled otherwise.\nNotice the value yielded by the third comparison $R_\\mathrm{gf}$ is irrelevant in this case.\nSimilarly, $\\pi_\\mathrm{fg}$ should be output if $R_\\mathrm{fe}=1$ and $R_\\mathrm{gf}=0$.\nFor a qutrit in its ground state, $R_\\mathrm{eg}=0$ and $R_\\mathrm{gf}=1$, and no reset pulse should be output.\nThe values yielded by the comparisons for the three possible input states and the desired output pulse are summarized in Table\u00a0(Table tab:qutrit).\n\nMeasured state     $R_\\mathrm{eg}$     $R_\\mathrm{fe}$     $R_\\mathrm{gf}$     Output pulse\n\n$\\left|\\mathrm{g}\\right>$     0     \u2014     1     \u2014\n\n$\\left|\\mathrm{e}\\right>$     1     0     \u2014     $\\pi_\\mathrm{eg}$\n\n$\\left|\\mathrm{f}\\right>$     \u2014     1     0     $\\pi_\\mathrm{fg}$\n\nTruth table for comparison operators in a qutrit readout.\n\nThe Boolean operator in the feedback engine encodes this truth table with three bits of input (the result of the three comparisons) and two bits of output (the enable signals for the reset pulses).\nIn the event sequencer the user schedules a template matching operation on the three template-matching pairs, followed by the release of both pulses $\\pi_\\mathrm{eg}$ and $\\pi_\\mathrm{fg}$, immediately after the readout.\nThe two output bits from the Boolean operator control which pulse is sent to the qutrit.\n\n## Measurement setup\n< g r a p h i c s >\n\nSchematic drawing of the room-temperature and cryogenic setup.\nAn 8-channel Presto is used to generate all the readout and control signals to the two-qubit quantum processor,\nincluding DC biases and the pump to the JPA.\n\nFigure\u00a0(Figure fig:cryo_setup) shows a schematic drawing of the room-temperature and cryogenic setup.\nWe use microwave filters from Mini-Circuits, both at room temperature and inside the dilution refrigerator, to suppress unwanted image signals generated by the high-speed DACs and to limit the noise bandwidth.\nThere are band-pass filters on the readout line (VBFZ-6260-S+) and on the two qubit-control lines (VBFZ-4000-S+), and low-pass filters on the coupler line (VLFX-650+).\nA bias tee (Mini-Circuits ZFBT-4R2GW+) at room temperature combines the AC drive to the coupler with a DC bias.\nThis configuration for the coupler line is not optimal and is likely the main contribution to the high thermal population observed in the experiments.\n\nThe readout line contains a cascade of amplifiers.\nAn InP HEMT amplifer is mounted at 3\u00a0K (Low Noise Factory LNF-LNC4_8C) followed by two room temperature amplifiers (Low Noise Factory LNF-LNR4_8ART and Mini-Circuits ZX60-83LN-S+) giving a total gain of about 105\u00a0dB at 6\u00a0GHz.\nFor single-shot readout we also use a JPA provided by NIST Boulder, CO [Lecocq, F., Ranzani, L., Peterson, G. A., Cicak, K., Simmonds, R. W., Teufel, J. D., Aumentado, J., \"Nonreciprocal Microwave Signal Processing with a Field-Programmable Josephson Amplifier\", 2017].\nThe JPA is pumped by Presto: one of the two high-frequency clock outputs creates the pump at twice the readout frequency ($\\approx 12~\\mathrm{GHz}$), and one of the DC-bias outputs controls the operating point of the JPA.\nThe RF signal is low-pass filtered (Mini-Circuits ZLSS-14G-S+) to remove unwanted harmonics and the DC line has a 1\u00a0k$\\Omega$ bias resistor at 3\u00a0K followed by two low-pass filters (Mini-Circuits SLP-1.9+).\nThe RF and DC signals are combined at the mixing chamber with a diplexer (Mini-Circuits ZDSS-3G4G-S+).\n\n## Abbreviations\nHere follows a list of abbreviations used in this manuscript and their description.\n\n5G fifth-generation technology standard for broadband cellular networks\n\nAC alternating-current\n\nADC analog-to-digital converter\n\nAPI application-programming interface\n\nAWG arbitrary-waveform generator\n\nCPU central-processing unit\n\nCMOS complementary metal-oxide-semiconductor\n\nCLEAR cavity-level excitation-and-reset\n\nDAC digital-to-analog converter\n\nDC direct-current\n\nDDS direct digital synthesis\n\nDRAG derivative reduction by adiabatic gate\n\nDSP digital signal processing\n\nFIFO first-in first-out (buffer)\n\nFPGA field-programmable gate array\n\nHEMT high-electron-mobility transistor\n\nInP indium phosphide\n\nJPA Josephson parametric amplifier\n\nLVTTL low-voltage transistor-transistor logic\n\nMIT Massachusetts Institute of Technology\n\nMTS multi-tile synchronization\n\nNCO numerically-controlled oscillator\n\nNIST National Institute of Standards and Technology\n\nPCB printed circuit board\n\nPLL phase-locked loop\n\nRF radio-frequency\n\nRFSoC radio-frequency system on a chip\n\nRPU real-time processing unit\n\nSDR software-defined radio\n\nSDRAM synchronous dynamic random-access memory\n\nTWPA travelling-wave parametric amplifier\n\n*\n\n"}
{"prompt": "What mathematical concepts are used in the paper 'A practical guide for building superconducting quantum devices'?", "completion": "\n\nALPGEN\nEVTGEN\nPYTHIA\n\n=1\n==10000\n=10000\n\n[2016-12-29]\n#1[3ex]\u222b#1\n-12mu\n\n2009\n\n[1]()\n=16 #1\n=16\n\n# A practical guide for building superconducting quantum devices\n\n[Corresponding author: ]yvonne.gao@nus.edu.sg\nCentre for Quantum Technologies, National University of Singapore\n\nOrange Quantum Systems, Vermeerstraat 19, 2612 XJ Delft, The Netherlands\n\nCentre for Quantum Technologies, National University of Singapore\n\nDepartment of Physics, University of Massachusetts-Amherst, Amherst, MA, 01003, USA\n\nQuantum computing offers a powerful new paradigm of information processing that has the potential to transform a wide range of industries. In the pursuit of the tantalizing promises of a universal quantum computer, a multitude of new knowledge and expertise has been developed, enabling the construction of novel quantum algorithms as well as increasingly robust quantum hardware. In particular, we have witnessed rapid progress in the circuit quantum electrodynamics (cQED) technology, which has emerged as one of the most promising physical systems that is capable of addressing the key challenges in realizing full-stack quantum computing on a large scale. In this article, we present some of the most crucial building blocks developed by the cQED community in recent years and a pr\u00e9cis of the latest achievements towards robust universal quantum computation. More importantly, we aim to provide a synoptic outline of the core techniques that underlie most cQED experiments and offer a practical guide for a novice experimentalist to design, construct, and characterize their first quantum device.\n\n## Introduction\nOver the past decade, quantum computing and quantum information science have gathered tremendous momentum from both academic and industrial research endeavors. With this comes the relentless progress in both the theoretical and experimental front, transforming quantum computing from a mere mathematical curiosity to a rapidly advancing domain of innovation. Remarkable improvements in the creation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], control\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and measurement\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] of quantum systems and their entanglement properties have been demonstrated in various different physics systems. Amongst them, the circuit quantum electrodynamics (cQED) technology\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] has emerged as one of the most promising platforms for realizing a robust and scalable universal quantum computer. It has enabled many of the landmark achievements in quantum computing, such as first realizations of quantum error correction\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and demonstrating the potential advantage of a quantum processor over its classical counterparts\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn a nutshell, cQED describes the interaction of light, typically at microwave frequencies, and matter, composed of superconducting circuit elements. The characteristics of all components in cQED devices are highly configurable. They can be engineered on demand to provide both large, controllable non-linearities for fast quantum operations as well as isolation from the environment for robust quantum coherence in a single hardware. The construction of cQED quantum processors requires both careful considerations in the design and fabrication processes of the device, as well as continual optimization of the measurement and control setup. The key building blocks for realizing a robust full-stack cQED system are summarized in Fig.\u00a0(Figure fig:overview)(a). In order to successfully construct a large-scale universal quantum computer, every element in this stack must be constructed with finesse and constantly enhanced through research and innovation.\n\nAs the cQED technology matures, the implementation of each of these elements is becoming increasingly sophisticated and multi-disciplinary. There are many superb review articles that capture the latest advances in key aspects of this technology\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] geared towards the experts in the field. They offer holistic overviews of the main concepts and key results in this rapidly developing field of research. In contrast, this article aims to provide an introductory tutorial for experimentalists at the early stages of their venture in developing superconducting quantum systems. Compared with the pedagogical review of the cQED knowledge base in Ref.\u00a0[Unknown Author, \"Unknown Title\", ], here we focus on the crucial experimental techniques and practices involved in successfully constructing quantum devices using superconducting circuits. This tutorial aims to provide a useful vantage point for a novice experimentalist to gain practical insights into the various elements required to implement a cQED experiment.\n\n### Overview of article\nThis article is structured to mimic the full workflow of building a new cQED experimental setup in the laboratory. Each step plays a crucial role in ensuring the eventual realization of a robust quantum device and requires a multitude of careful considerations, which are often skipped over in research articles. In this tutorial, we will aim to provide a step-by-step guide on these practical details, with a specific focus on devices that employ transmon qubits\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIt is important to highlight that this article is not intended as a comprehensive review of the entire field of cQED or as an exhaustive summary of the wide range of techniques that have been developed by the community. Rather, it aims to discuss a selected set of basic tools and useful intuitions that, in the opinion of the authors, are important for understanding the practical aspects of implementing cQED experiments. In particular, we aim to offer a tutorial style walk-through on the design and characterization of cQED devices while providing more general overviews and useful references on the other aspects of the workflow.\n\n< g r a p h i c s >\n\nOverview of the crucial hardware building blocks and experimental processes in realizing a quantum system in cQED. (a) The full-stack of cQED quantum computer. Each layer represents an important element that must be carefully constructed and optimized, in order to construct full-stack quantum processors in cQED. (b) The engineering cycle of a cQED device. The desired target application influences the chip\u2019s Hamiltonian design (<ref>) in which an equivalent circuit and its target parameters are determined. This design serves as the input for a second design step in which the geometry and layout of the device is determined, taking into account the constraints of the fabrication process (<ref>). After fabricating the device, the system is carefully characterized (<ref>) and the resulting information is used to inform the next design iteration to bring the system closer towards the desired Hamiltonian.\n\nWe start by providing a concise summary of the physics of cQED in Sec.\u00a0<ref>. In addition, we will also present the process of constructing specific Hamiltonians with the fundamental ingredients afforded by the cQED platform. The purpose of this segment is to provide a general basis for the subsequent discussions and provide useful resources for more advanced readers to further investigate the more technically-involved concepts.\n\nIn Sec.\u00a0<ref>, we introduce the necessary ingredients and tools for translating the target Hamiltonians into a physical circuit. This requires an iteration cycle consisting of configuring the device layout and circuit components, simulating the electromagnetic mode structures, and extracting of the relevant Hamiltonian parameters. We will further highlight some of the main limiting factors of the coherence of quantum circuits and summarize the known design strategies to mitigate them. This is followed by a short discussion of device fabrication as well as considerations towards achieving better yield and reliability.\n\nIn Sec.\u00a0<ref>, we move on to provide an overview of the configuration of cryogenic and room temperature environments required to ensure both the coherence and controllability of cQED devices. Here, we will highlight some of the crucial factors involved in the filtering and shielding of the quantum devices in the dilution refrigerator (DR). Furthermore, we will also provide an overview of the typical room temperature microwave signal processing elements and control electronics used in providing sophisticated pulse sequences for quantum operations.\n\nIn Sec.\u00a0<ref>, we will present the typical workflow of characterizing and calibrating a cQED device. Here, we cover a series of basic tune-up procedures, from cavity and qubit spectroscopy, coherence measurements, to qubit rotation diagnosis and readout optimization. The information we learn through these measurements offer a comprehensive view of the performance of individual quantum elements, and provide valuable feedback for future iterations of device designs. We then discuss a few more advanced topics including implementing two-qubit gates, characterization of quantum operations, and control of quantum memory cavities, which are crucial in building towards  high-fidelity experiments in multi-qubit systems.\n\nThe building blocks introduced thus far form an iterative cycle (Fig.\u00a0(Figure fig:overview)(b)) that enables us to develop cQED devices increasingly robust performance for the desired applications. Collectively, they culminate in the ultimate goal of realizing a robust universal quantum computer capable of tackling real-world challenges. In this tutorial, we do not attempt give a prescription of how to realize and operate a large-scale quantum computer since that remains an open pursuit of the entire community. Instead, in Sec.\u00a0<ref>, we will switch gears to provide a brief review of two concurrent research thrusts that aim to develop more robust and powerful quantum devices. First, we discuss the recent developments and main challenges in scaling up planar cQED devices from NISQ era processors to a robust, universal quantum machine. Subsequently, we will illustrate how superconducting cavities can be utilized to realize robust quantum modules with first order quantum error correction. Finally, we will provide some prospective on the challenges and future directions towards using them as building blocks for a fault-tolerant and general-purpose quantum computer.\n\n## Physics of cQED\nThe cQED framework describes the dynamics of photon-matter interaction, where devices consisting of engineered quantum circuit elements interact with microwave photons. The first step towards setting up a successful cQED experiment\nis to establish a solid grasp of the fundamental concepts of the main building blocks of the superconducting quantum circuit. There are many excellent materials detailing the general principles of cQED systems\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In this section, we focus specifically on two key circuit elements,\nsuperconducting resonators and transmon qubits, which are the main workhorses for current cQED experiments. We aim to summarize the physical principles governing their quantum dynamics and bring some intuition on how to effectively engineer quantum devices with them.\n\n### Superconducting resonators\nThe simple harmonic oscillator is often used as the basis for formulating the quantum mechanical models of more complex systems. In the cQED framework, the physical manifestation of a simple harmonic oscillator is an LC circuit, which consists of one inductive and one capacitive element. This simple resonant circuit with frequency $\\omega$ can be coerced to exhibit fully quantum mechanical behavior if constructed with superconducting materials (with critical temperature $T_c$) and kept at sufficiently low temperature ($T\\ll T_c$). This allows such superconducting LC oscillators to achieve lossless conduction, as well as effective suppression of thermal noise ($k T \\ll \\hbar \\omega$, where $k$ is the Boltzman constant). This simple quantum element plays many crucial roles in cQED devices, from readout and mediating quantum interactions to the coherent storage of quantum information.\n\n#### Isolated superconducting resonators\nWe often model an isolated LC oscillator as a lumped-element system consisting of an inductor $L$ and a capacitor $C$, as shown in Fig.\u00a0(Figure fig:oscillator)(a). However, these notions can be extended beyond lumped element circuits. More generally, the inductive energy stems from charges moving in a conductor and creating a magnetic field which tends to oppose any changes in current. The capacitive energy, on the other hand, arises from the electrostatic energy between two regions of a superconductor that contain different number of charges. A superconducting resonator is simply a collection of such quantum LC oscillators, with each mode of the resonator corresponding to a single oscillator with a well-defined resonance frequency.\n\nWe can capture the dynamics of superconducting resonators with two dimensionless quantities. The first one, $\\bphi$, is a result of the quantization of the magnetic flux threaded through the inductor. The total magnetic flux observable is then $\\boldsymbol{\\phi} = \\phi_0\\,\\bphi$, where $\\phi_0 = \\hbar/2e$ is the reduced magnetic flux quantum. The second one, $\\bn$, is the difference in the number of charges on the two plates of the capacitor in units $2e$, which correspond to the charge of a Cooper pair. It is related to the total charge observable, which is given by $\\bn_Q = 2e\\bn$. Whlie valuable insight is gained from this lumped-element model, microwave resonators are generally implemented using distributed elements in practice. For such systems, $\\bn$ relates to the quantization of the electric energy, caused by an unbalanced charge distribution across different parts of the structure (see Fig.\u00a03(d)). The oscillations of this charge distribution induces a magnetic field flux quantized with $\\bphi$, as predicted by Faraday's law.\n\nThe two dimensionless quantities, $\\bn$ and $\\bphi$, obey the canonical commutation relation\u00a0[Unknown Author, \"Unknown Title\", ]\n$$\n\\label{eq:phi_n}\n[\\bphi, \\bn] = i.\n\n$$\nWith this, the Hamiltonian of a superconducting LC oscillator is given by\n$$\n\n\\label{eq:H_LC}\n\\bH = \\frac{E_L}{2}\\bphi^2 + 4E_C\\bn^2,\n\n$$\nwhere $E_L = \\frac{\\phi_0^2}{L} = \\frac{\\hbar^2}{4e^2 L}$ and $E_C = \\frac{e^2}{2C}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nAlternatively, we can also express this Hamiltonian using two standard circuit parameters: the angular frequency $\\omega$ and the impedance $Z$, defined as\n$$\n\n\\omega = \\frac{\\sqrt{8 E_L E_C}}{\\hbar} = \\frac{1}{\\sqrt{L C}}, \\hspace{1cm} Z_0 = \\sqrt{\\frac{L}{C}},\n\n$$\nsuch that\n$$\n\n\\bH = \\hbar\\omega\\left[\\left(\\frac{R_Q}{2Z_0}\\right)\\bphi^2 + \\left(\\frac{Z_0}{2R_Q}\\right)\\bn^2\\right].\n\n$$\nHere, we have introduced the reduced resistance quantum for superconductors $R_Q~=~\\frac{\\hbar}{(2e)^2} = $1.027\u00a0k$\\Omega$, and we can write $R_Q/Z_0 = \\sqrt{E_L/8E_C}$\n\nNext, we diagonalize this Hamiltonian by finding ladder operators $\\ba$ and $\\ba^\\dag$ that are linear combinations of $\\bphi$ and $\\bn$ with $[\\ba, \\ba^\\dag]=1$ . We find\n$$\n\n\\label{eq:annihilation}\n\\ba = \\sqrt{\\frac{R_Q}{2Z_0}}\\bphi + i\\sqrt{\\frac{Z_0}{2R_Q}}\\bn\n\n$$\nFrom this, we obtain the flux $\\bphi$ and charge $\\bn$ observables explicitly, in their respective units and get a physical sense of the zero point fluctuations of the magnetic flux and of the charge by writing $\\bphi = \\varphi^{\\text{ZPF}}(\\ba + \\ba^\\dag)$ and $\\bn = n^{\\text{ZPF}}(\\ba-\\ba^\\dag)/i$, where\n$$\n\n\\label{eq:phi_ZPF}\n\\varphi^{\\rm ZPF} &= \\sqrt{\\frac{Z_0}{2R_Q}}\\, \\\\\n\\label{eq:n_ZPF}\nn^{\\rm ZPF} &= \\sqrt{\\frac{R_Q}{2Z_0}}.\n\n$$\nWe deduce that when the impedance of the resonator is high ($Z_0 \\gg R_Q$), the zero point fluctuations of the magnetic flux are large compared to $\\phi_0$ and that of charge are small compared to $2e$. The situation is reversed when the impedance is low relative to the flux quantum.\n\n#### Resonators in contact with the environment\nFor any practical applications, the resonator will be in contact with an external environment. This environment consists of both carefully engineered coupling introduced by the observer and undesired interactions with a potentially dissipative bath, as illustrated in Fig.\u00a0(Figure fig:oscillator)(b). In this case, we can no longer describe the observables associated with the coupled resonator-environment in the simple Heisenberg picture. Rather, it must be treated as an open system, where the field $\\ba(t)$ associated with the resonator receives an incoming field $\\ba_{in}(t)$ and emits an outgoing field $\\ba_{out}(t)$. Let us consider the example where a resonator is coupled to a microwave transmission line, which provides the drive and measurement tones to the system. Here, $\\ba_{in}(t)$ and $\\ba_{out}(t)$ represent respectively the incoming and outgoing field of the transmission line where it interacts with our circuit. The fields at different times are not related, such that $\\left[\\ba_{out}(t), \\ba^\\dag_{out}(t')\\right] = \\left[\\ba_{in}(t), \\ba^\\dag_{in}(t')\\right] = \\delta(t - t')$. This implies $\\ba_{in}$ and $\\ba_{out}$ have dimension $t^{-1/2}$).\n\n< g r a p h i c s >\n\nCircuit model of a superconducting resonator. (a) Lumped element representation of an isolated LC circuit. (b) Circuit of a LC oscillator coupled to a transmission line, which carries the desired microwave probe signals, and a bath, which signifies the presence of other undesired environment couplings that can potentially be noisy.\n\nA detailed balance of the field results in the following input-output relation:\n$$\n\\label{eq:in_out}\n\\ba_{out} = \\ba_{in} + \\sqrt{\\kappa_c}\\ba,\n\n$$\nwhere $\\kappa_c$ is defined as the frequency-independent coupling rate at which the oscillator exchanges energy with the transmission line, and can be experimentally characterized for each set-up. Here, we have chosen the sign convention following the approach in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. With the incoming and outgoing fields taken into account, we arrive at the following differential equation for $\\ba(t)$ in the Heisenberg picture:\n$$\n\n\\label{eq:quantum_langevin}\n\\partial_t \\ba = - \\frac{i}{\\hbar}\\left[\\ba, \\bH\\right] - \\frac{\\kappa}{2}\\ba - \\sqrt{\\kappa_c}\\ba_{in}.\n\n$$\nThis expression is called the quantum Langevin equation\u00a0[Unknown Author, \"Unknown Title\", ]. It includes two new terms: the first one corresponds to a damping of the field at rate $\\kappa/2$, with $\\kappa=\\kappa_c+\\kappa_i$, where $\\kappa_i$ is the coupling rate between the system and the uncontrolled environment usually called the internal loss rate; the second term, $\\sqrt{\\kappa_c}\\ba_{in}$, referred to as \u201cdrive\" or \u201cpump\", is vital for $\\ba$ to obey the same usual commutation relation $\\left[\\ba, \\ba^\\dag\\right] = 1$ at all times despite the damping term. As an alternative to the quantum Langevin equation, the Lindblad master equation can also be used to describe such dissipative systems\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, the quantum Langevin equation is more suited to describe the traveling fields that we consider here.\n\nWhile $\\ba_{in}$ is necessary in order for us to control the state of the resonator, it also introduces undesired fluctuations in its field. To mitigate this, we typically operate in the \u201cstiff-pump\" regime, where $\\kappa_c$ is negligible compared to the frequency of the resonators, but the expectation value of $\\sqrt{\\kappa_c}\\ba_{in}$ can be large compared to $\\kappa_c$. This way, we have $\\ba_{in} = \\bar{a}_{in} + \\ba_{in}^{0}$, where $\\ba_{in}^{0}$ represents the negligible fluctuations of the field and $\\bar{a}_{in}$ its average value. In the stiff-pump approximation, a drive is modeled with the Hamiltonian\n$$\n\n\\label{eq:drive}\n\\frac{\\bH_d}{\\hbar} = \\epsilon(t) \\ba^\\dag + \\epsilon(t)^*\\ba,\n\n$$\nwith $\\epsilon(t) = \\sqrt{\\kappa_c}\\bar{a}_{in}$.\n\n### Josephson Junction\nSuperconducting resonators alone do not provide a useful medium for encoding quantum information. This is because the energy levels of a resonator are separated by an equal spacing of $\\hbar\\omega$, forbidding us from addressing the transitions individually. Thus, we must introduce a non-linear element in order to achieve universal quantum control of the circuit.\n\nIn cQED, the most ubiquitous source of non-linearity is a Josephson junction (JJ), favored for its simplicity and non-dissipative nature. This element is made of two superconducting electrodes separated by an insulating tunnel barrier, represented in Fig.\u00a0(Figure fig:dispersive_coupling)(a). In practice, JJs are typically fabricated by overlapping two layers of superconducting films with an oxide barrier in between. The area of the overlap and the properties of the oxide barrier determine the properties of the JJ.\nAn SEM image of a typical JJ is depicted in Fig.\u00a0(Figure fig:dispersive_coupling)(b).\n\n< g r a p h i c s >\n\nDispersive coupling between a transmon and a superconducting resonator. (a) Lumped element representation of a Josephson junction and a cartoon of its structure, which consists of two layers of aluminium (grey) that are separated by an aluminium oxide tunnel barrier (white). (b) An SEM image of a bridge-free junction. Image credit: Kyle Serniak (Yale University) (c) Lumped element representation of a LC circuit capacitively coupled to a single-junction transmon and the associated the potential of each mode and the dressing of the energy levels due to the dispersive interaction. (d), (e) Two examples of physical realizations of a transmon device dispersively coupled to a superconducting cavity in either the planar (d) and 3D configuration (e).\n\nThe detailed theoretical description of the JJ and its underlying physics can be found in Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Here, we aim to provide a brief intuitive picture that follows the line of Josephson's original work [Unknown Author, \"Unknown Title\", ]. Let us consider each side of the JJ as a superconducting island containing a certain number of Cooper pairs. The joint state of the junction is described by the difference in number of Cooper pairs $\\bn$, which is the same observable used in our treatment of the simple LC circuit. As Cooper pairs tunnel across the junction, $\\bn$ varies accordingly. Therefore, the Hamiltonian of a Josephson junction can intuitively be written in the charge basis as\n$$\n\n\\bH_J/\\hbar = -\\frac{E_J}{2}\\sum^{+\\infty}_{n=-\\infty}\\left(\\ket{n}\\bra{n+1} + \\ket{n+1}\\bra{n}\\right),\n\n$$\nwhere $E_J$ is the Josephson energy, which is traditionally expressed in units of frequency by dividing it by $\\hbar$. We identify that the two parts of $\\bH_J$, i.e. $\\sum^{+\\infty}_{n=-\\infty}\\ket{n+1}\\bra{n}$ and its Hermitian conjugate, are unitary operators that translate the charge by one unit up and down respectively. This translation can also be written in the conjugate basis as $e^{\\pm i\\bphi}$, similar to how a position translation is written in terms of the momentum operator. Therefore, the Josephson Hamiltonian in the flux basis can be expressed as\n$$\n\n\\bH_J/\\hbar = -E_J \\cos{\\bphi}.\n\n$$\nDeveloping the cosine potential to second order gives rise to a quadratic term that resembles an inductive energy as described in Eq.\u00a0<ref>. This is commonly referred to as the Josephson inductance $L_J = \\hbar^2/(4e^2 E_J)$. As we will show in the case of the transmon, this non-linear inductance affords us the ability to selectively address individual transitions in the system.\n\n### Transmon\nBuilding upon the non-linearity afforded by the JJ, we can now construct a variety of circuit elements capable of effectively encoding quantum bits of information. These non-linear components are generally referred to as superconducting qubits. In particular, transmon qubits, which are weakly anharmonic oscillators, are the most widely used in current cQED devices. The transition frequencies between ground ($\\ket{0}$) and first excited state ($\\ket{1}$) of transmons are typically designed to be around 5 GHz. The choice of this frequency range is two-fold: (1) it is far below the plasma oscillation frequencies of individual electrons in the superconductor, hence, we only need to consider their collective excitations; (2) at the operational temperature of cQED experiments (20 mK), the probability of supplying sufficient thermal energy to excite this transition is effectively suppressed, such that the qubit can be in or close to its ground state.\n\nIn transmon qubits, the transition between the first two energy levels is detuned from that of its first to second excited state by the anharmonicity, which is typically designed to be 200 - 300 MHz. With this configuration, transitions between the two lowest levels of the transmon can be addressed with microwave pulses as short as a few nanoseconds\u00a0[Unknown Author, \"Unknown Title\", ].\n\nPhysically, transmon qubits are constructed with two large superconducting capacitor structures connected by one or more JJs. The capacitor pads provide the capacitive energy $E_C$ and the Josephson junction provides the inductive energy $E_J$. Combining these two, we arrive at the Hamiltonian\n$$\n\\label{eq:transmon_H}\n\\frac{\\bH}{\\hbar} &= 4E_C\\bn^2 - E_J\\cos(\\bphi) \\\\\n&= 4E_C\\bn^2 + \\frac{E_J}{2}\\bphi^2 + \\bH_{4^+}\\left(\\bphi\\right),\n\n$$\nwhere $\\bH_{4^+}\\left(\\bphi\\right)/\\hbar = -E_J\\left(\\cos(\\bphi) + \\bphi^2/2\\right)$. Note here that we have added the quadratic term $\\frac{E_J}{2}\\bphi^2$ and then subtracted it again to eliminate the second order terms after the cosine expansion. The constant term from the expansion is dropped as it simplify contributes to a constant energy offset that does not cause any non-trivial dynamics. With the form of Eq.\u00a0<ref>, it becomes apparent that the transmon is effectively a variant of the standard LC circuit with the JJ as a non-linear inductor.\n\nTransmons operate in the regime of $E_J \\gg E_C$. In this limit, according to Eq.\u00a0<ref> and Eq.\u00a0<ref>, the eigenstates of the transmon have suppressed zero-point fluctuations in phase while those in the the charge degree of freedom remain large. More specificially, the sensitivity of the transmon frequency to offset charge drops exponentially in $E_J/E_C$, and is heavily suppressed in the typical parameter regime of $E_J / E_C \\approx 50$, while still maintaining a large enough anharmonicity for fast operations\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nAs $\\bH_{4^+}$ depends solely on the phase zero-point fluctuations, we  treat it as a perturbation to the linear part of the Hamiltonian. Using this perturbative treatment of $\\bH_{4^+}$ and limiting the excitations to only the low-lying states of the transmon, we diagonalize the linear Hamiltonian with the annihilation and creation operators $\\bq$ and $\\bq^\\dag$, as defined in eq.\u00a0<ref>, with $E_L$ replaced by $E_J$. Therefore, we get\n\n$$\n\n\\label{eq:transmon}\n\\frac{\\bH_T}{\\hbar} &= \\sqrt{8 E_J E_C} \\bq^\\dag \\bq +\\bH_{4^+}\\left(\\varphi_T^{\\text{ZPF}}(\\bq + \\bq^\\dag)\\right) \\\\\n&\\approx \\sqrt{8 E_J E_C}\\bq^\\dag\\bq - {E_J \\over 24}\\left(\\phi^{\\text{ZPF}}_T\\right)^4\\left(\\bq+\\bq^\\dag\\right)^4 \\\\\n&\\approx \\omega_T \\bq^\\dag \\bq - \\frac{\\alpha}{2}\\bq^{\\dag 2}\\bq^2,\n\n$$\nwith\n$$\n\n\\omega_T = \\sqrt{8 E_J E_C} - E_C, \\quad \\alpha = \\frac{E_J}{2}(\\varphi_T^{\\text{ZPF}})^4 = E_C.\n\n$$\nIn our last approximation we have kept only the resonant terms that have as many \u201cdaggers\" as \u201cnon-daggers\". This approximation is justified by the fact that, in a frame rotating at $\\omega_T$, all the terms that are non-resonant oscillate at an angular frequency at least $\\omega_T$, which is much larger than $\\alpha/2$. The dynamic produced by such oscillating terms at a given time is cancelled by the dynamic produced by the same terms half an oscillation later, such that their action quickly averages to the identity. This approximation is called the rotating-wave approximation (RWA).\n\nHere, we have chosen to use the ladder operators to describe the transmon qubit. This approach offers a convenient strategy to capture the behaviors of the higher-level transitions in the transmon as well as non-linear frequency mixing in the JJ, which is utilized frequently in parametric conversion processes. An alternative method is to consider the transmon as a discrete two-level system, and use the Pauli operators to describe its properties. We can arrive at an equivalent picture for the dynamics of a transmon and its interactions with other circuit elements using either of these techniques.\n\nSo far we have only focused on single-junction transmons whose parameters $E_C$ and $E_J$ are fixed by the design and fabrication of the device. Frequency tunability can also be introduced while maintaining the relative simplicity and robustness offered by the transmon by replacing the single junction with two parallel junctions. With this, it is possible to adjust the device's $E_J$ in-situ\u00a0[Unknown Author, \"Unknown Title\", ]. This configuration of using multiple junctions in a single non-linear element is called a superconducting quantum interference device (SQUID)\u00a0[Unknown Author, \"Unknown Title\", ].\n\nTo understand this type of SQUID qubits, we consider the simplest case of a system with two junctions of identical Josephson energy $E_J/2$.The system Hamiltonian is given by\n$$\n\n\\frac{\\bH}{\\hbar} = 4E_C \\bn^2 - \\frac{E_J}{2}\\left[\\cos(\\bphi_1) + \\cos(\\bphi_2)\\right],\n\n$$\nwhere $\\bphi_1$ and $\\bphi_2$ are the flux operators of each junction. Naively, one would think that having two tunnel-junctions in parallel is equivalent to having a single large junction. However, when an external magnetic field threads a magnetic flux $\\phi_{\\mathrm{ex}} = \\varphi_{\\mathrm{ex}}\\phi_0$, where $\\varphi_{\\mathrm{ex}}$ is the number of flux quanta, the behavior of this system qualitatively differs from that of the single-junction devices. In fact, it is favorable for Cooper pairs to tunnel in opposite directions across the two junctions. Thus, the external field results in a flux difference of $\\bphi_2 - \\bphi_1 = \\varphi_{\\mathrm{ex}}$. Trigonometric identities allow us to regroup terms such that the Hamiltonian can be written as\u00a0[Unknown Author, \"Unknown Title\", ]\n$$\n\n\\frac{\\bH}{\\hbar} = 4E_C \\bn^2 - E_J\\cos\\left(\\frac{\\varphi_{\\mathrm{ex}}}{2}\\right)\\cos(\\bphi),\n\n$$\nwhere $\\bphi = (\\bphi_1 + \\bphi_2)/2$ is the average flux between the two junctions. Effectively, a SQUID transmon provides a simple device with in-situ tunability of $E_J$. This on-demand tunability offers new avenues for implementing quantum operations between transmons\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], probing coherence properties\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and engineering new Hamiltonians\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, any additional noise on the control knob $\\varphi_{ex}$ will translate into phase noise for the transmon, which can limit their coherence.\n\n### Other qubits\nWhile transmons are currently the most widely used superconducting qubits due to their simplicity and versatility, it is important to note that our rich and diverse cQED toolbox extends much beyond these simple circuit elements. There are a whole host of other superconducting qubits that work in different regimes and employ different junction arrangements\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Among them, the flux-qubit\u00a0[Unknown Author, \"Unknown Title\", ] and the fluxonium \u00a0[Unknown Author, \"Unknown Title\", ] have been systematically investigated and their performance consistently improved\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] in recent years.\n\nIn parallel, there are also several promising strategies to construct superconducting circuits that are intrinsically protected against various environmental noise. Such protection schemes are heavily inspired by the continuous-variable quantum-error-correction code designed by D. Gottesman, A. Kitaev and J. Preskill (GKP)\u00a0[Unknown Author, \"Unknown Title\", ]. Recently, the proof-of-principle demonstrations of two of such protected qubits have been reported, namely, the \u201ccos$2\\varphi$\u201d element\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and the \u201c0-$\\pi$\u201d qubit\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. These new circuit elements and their intrinsic resilience to noise are valuable building blocks for realizing quantum devices that can potentially achieve the necessary scale and complexity without significant performance degradation.\n\n### The dispersive coupling\nHaving introduced the two key components of cQED systems, superconducting resonators and transmons, we now look into how they can be integrated to form a useful quantum device.\n\nPhysically, when a transmon is placed in proximity to a resonator, the charges of one element can influence those of the other through a coupling capacitor (Fig.\u00a0(Figure fig:dispersive_coupling)(c)). We summarize this coupling by a parameter of the Hamiltonian, $g_0$, which can be computed exactly for a given model of the circuit. This leads to an interaction Hamiltonian\n$$\n\n\\bH_{\\text{int}} &= g_0\\bn_R \\bn_T \\\\\n&= -g \\left(\\ba^\\dag - \\ba\\right)\\left(\\bq^\\dag - \\bq\\right)\n\n$$\nwith the subscripts $T$ and $R$ describing the transmon and the resonator respectively. Note that we have regrouped the charge zero-point fluctuations in $g$.\n\nThe exact diagonalization of the Hamiltonian with this interaction is done in many reviews\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Here, we present an approximate diagonalization in the most commonly-used parameter regime in cQED, where:\n\n1) $g\\ll|\\Delta|=|\\omega_T - \\omega_R|$, with large qubit-cavity detuning giving rise to a dispersive interaction between the two elements instead of resonant energy exchange;\n\n2) $E_C \\ll |\\Delta|$ (weak anharmonicity);\n\n3) $|\\Delta| \\ll \\omega_T + \\omega_R$, implying that the counter-rotating terms are negligible.\n\nIn this regime, we apply the Rotating Wave Approximation (RWA) to reduce the interaction Hamiltonian to $\\bH_{\\text{int}}/\\hbar = g\\left(\\ba\\bq^\\dag + \\ba^\\dag\\bq\\right)$.\n\nFollowing this, we write a set of Langevin equations for $\\ba$ and $\\bq$ in the Heisenberg picture\n$$\n\n\\partial_t\\ba &= - i \\left(\\omega_R - i\\frac{\\kappa}{2}\\right) \\ba - i g\\bq\\\\\n\\label{eq:q_langevin}\n\\partial_t\\bq &= -i \\omega_T \\bq - i g \\ba - \\frac{i}{\\hbar}\\left[\\bq, \\bH_{4^+}\\left(\\varphi^{ZPF}_T(\\bq + \\bq^\\dag)\\right)\\right],\n\n$$\nwhere we have included the dissipation of the resonator but neglected the dissipation of the transmon, such that we can analyze the impact of a readout cavity, typically with low or moderate Q, on the relaxation of the transmon (see Sec.<ref>3). We treat the non-linear part of Eq.\u00a0<ref> as a perturbation and diagonalize the linear part given by the matrix\n$$\n\\label{eq:dispersive_mat}\nM = \\left(\\,\n\\begin{matrix*}[c]\n~(\\omega_R - i\\kappa/2) & g~ \\\\\n~g & \\omega_T~\n\\end{matrix*}\\,\\right),\n\n$$\nwhose eigenvalues are given to the first order by\n$$\n\n\\tilde \\omega_R &= \\omega_R + \\frac{g^2}{\\Delta} - i\\frac{\\kappa}{2} + i\\left(\\frac{g}{\\Delta}\\right)^2\\kappa \\\\\n\\tilde \\omega_T &= \\omega_T - \\frac{g^2}{\\Delta} - i\\left(\\frac{g}{\\Delta}\\right)^2\\kappa.\n\n$$\nThe frequencies $\\tilde \\omega_R$ and $\\tilde \\omega_T$ of the resonator and the transmon in the dispersively coupled system are shifted with respect to the uncoupled system by the Lamb-shift\n$$\n\n\\label{eq:lamb_shift}\n\\Lambda_\\chi = g^2/\\Delta.\n\n$$\nThe transmon also inherits some dissipation from the cavity given by the Purcell rate\n$$\n\n\\label{eq:purcell_limit}\n\\Gamma_P = 2\\left(\\frac{g}{\\Delta}\\right)^2\\kappa.\n\n$$\nThe Purcell rate could lead to a trade-off between a large transmon-resonator coupling for fast operations and the lifetime of the qubit. However, in practice, the Purcell effect can be significantly suppressed with carefully designed Purcell filters\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe can now define a new set of annihilation and creation operators that correspond to the eigenvectors of the matrix given by Eq.\u00a0<ref>. To do so, we first define a mixing angle of $\\theta = \\frac{1}{2}\\arctan\\left(\\frac{2g}{\\Delta}\\right)$. With this, the new eigenstates, also called dressed modes, are given by\n$$\n\n\\tilde \\ba &= \\cos(\\theta) \\ba + \\sin(\\theta) \\bq \\approx \\ba + \\frac{g}{\\Delta}\\bq \\\\\n\\tilde \\bq &= -\\sin(\\theta)\\ba + \\cos(\\theta)\\bq \\approx -\\frac{g}{\\Delta}\\ba + \\bq.\n\n$$\nA detailed derivation can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. With these relations, the linear part of the Hamiltonian is now proportional to $\\tilde \\omega_R \\tilde\\ba^\\dag\\tilde\\ba + \\tilde \\omega_T \\tilde \\bq^\\dag \\tilde \\bq$.\n\nTo treat the non-linear part of the Hamiltonian $\\bH_{4^+}$, we invert the definition of $\\tilde \\ba$ and $\\tilde \\bq$ to obtain\n$$\n\n\\varphi_T^{\\text{ZPF}}\\left(\\bq + \\bq^\\dag\\right) &=\\varphi_T^{\\text{ZPF}}\\left(\\cos(\\theta)(\\tilde\\bq + \\tilde\\bq^\\dag) + \\sin(\\theta)(\\tilde \\ba + \\tilde \\ba^\\dag)\\right) \\nonumber\\\\\n&\\approx \\varphi_T^{\\text{ZPF}}\\left(\\tilde\\bq + \\tilde\\bq^\\dag\\right) + \\varphi_T^{\\text{ZPF}}\\frac{g}{\\Delta}\\left(\\tilde \\ba + \\tilde \\ba^\\dag\\right)\n\n$$\nIt is useful to note that we often combine the ZPF terms with the associated mixing angles into a single coefficient, i.e. $\\varphi_T = \\varphi_T^{\\text{ZPF}}\\cos(\\theta)$; $\\varphi_R = \\varphi_T^{\\text{ZPF}}\\sin(\\theta)$, to describe the $(\\tilde\\bq + \\tilde\\bq^\\dag)$ and $(\\tilde\\ba + \\tilde\\ba^\\dag)$ terms. This notation is commonly adopted in the treatment of dynamics of transmon-cavity systems in cQED.\n\nWith $\\varphi_T^{ZPF} \\ll 1$, the largest elements in this non-linear Hamiltonian are of the 4th order. We can then perform the same RWA as in Eq.\u00a0<ref> to eliminate the non-resonant terms. Now working exclusively in the new frame, we drop the tilde and simplify the notation to get the transmon-cavity Hamiltonian in the dispersive regime in the following form\n$$\n\n\\label{eq:dispersive_hamiltonian}\n\\frac{\\bH}{\\hbar} =& \\omega_T \\bq^\\dag \\bq + \\omega_R \\ba^\\dag\\ba \\\\ \\nonumber&-\\frac{\\alpha}{2}\\bq^{\\dag 2}\\bq^2 - \\frac{K}{2}\\ba^{\\dag 2}\\ba^2 - \\chi\\left(\\bq^\\dag\\bq\\right)\\left(\\ba^\\dag\\ba\\right),\n\n$$\nwith\n$$\n\nK &= \\frac{E_J}{2} \\left(\\varphi^{\\text{ZPF}}_T\\right)^4\\left(\\frac{g}{\\Delta}\\right)^4 = E_C\\left(\\frac{g}{\\Delta}\\right)^4, \\\\\n\\chi &= E_J\\left(\\varphi^{\\text{ZPF}}_T\\right)^4\\left(\\frac{g}{\\Delta}\\right)^2 = 2 E_C\\left(\\frac{g}{\\Delta}\\right)^2. \\label{eq:chi}\n\n$$\nTypically, $K$ and $\\chi$ are referred to as the self-Kerr and the cross-Kerr non-linearity between the resonator and the transmon, respectively. Physically, we can interpret the effect of a dispersive coupling as a state-dependent frequency shift between the two modes. The coupling is considered to be in the strong dispersive regime if this state-dependent shift is larger than the linewidth of the resonator.\n\nIn practice, this type of dispersively coupled transmon-resonator system can be realized by placing them in physical proximity such that their respective fields overlap, as illustrated in Fig.\u00a0(Figure fig:dispersive_coupling)d and (e). More details regarding the exact configuration of such devices will be discussed in Sec.\u00a0<ref>.\n\nDespite its relative simplicity, the dispersive Hamiltonian is the origin of many interesting phenomena and crucial tools in cQED. Generally, the resonator-transmon system offers us a platform with three main capabilities. First, by coupling the resonator strongly to a transmission line, we can implement fast and efficient readout of the transmon state. Alternatively, two transmons can interact via a mediating resonator mode (quantum bus) to realize quantum operations. Finally, the transmon can act as a non-linear ancilla to perform universal control on the resonator state.\n\nGoing beyond the natural interactions, the addition of microwave drives at well-chosen frequencies also offers the possibilities of engineering new dynamics in the cQED system. This capability is afforded by the non-linear frequency-mixing in the Josephson junction, akin to frequency conversion processes in non-linear optical mediums\u00a0[Unknown Author, \"Unknown Title\", ]. To the first order, a single JJ can be used to enact four-wave mixing in cQED devices.\n\nSuch driven interactions are highly useful tools for engineering new dynamics or operations in cQED devices. One of the key applications of such driven operations is to engineer quantum-limited amplifiers, which will be discussed in Sec.\u00a0<ref>. Additionally, a wide range of different Hamiltonians have been demonstrated using such drives, enabling a large repertoire of new experimental achievements. This includes stabilization and protection of Schrodinger cat state\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], remote entanglement of superconducting qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], cooling of nanomechanical devices\u00a0[Unknown Author, \"Unknown Title\", ], engineered quantum gates between microwave cavities\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], detection of single microwave photons\u00a0[Unknown Author, \"Unknown Title\", ], longitudinal coupling of a cavity and a transmon\u00a0[Unknown Author, \"Unknown Title\", ], and so on.\n\n## Designing quantum circuits\nAfter we establish an ideal target Hamiltonian for an intended application, the first step in the workflow of a cQED experiment is to translate the targeted set of abstract system parameters (number of qubits, transition frequencies, connectivity and coupling strengths, etc.) into a physical device with appropriately designed circuit elements.\n\nThis translation is often an iterative process that consists of several key steps including architectural layout, configuring building blocks, electromagnetic simulation, and circuit quantization, as illustrated in Fig.\u00a0(Figure fig:design_cycle). In this section, we will guide the reader through such a process to highlight some of the common strategies and the main considerations involved in building up the desired cQED device.\n\n< g r a p h i c s >\n\nDesign cycle of a circuit QED device. To translate a target Hamiltonian into a physical device, we first lay out the main building blocks for the circuit in a suitable architecture. Then, we compute the electromagnetic mode structures of the device reliably, often using numerical simulations. Subsequently, we extract the relevant Hamiltonian parameters from this simulation using circuit quantization techniques. We then compare the result with the target Hamiltonian, and can adjust the design until we converge to a configuration that faithfully reflects our target system.\n\n### Planar and 3D architectures\nCurrently, there are two main types of device architectures in circuit QED: colloquially referred to as \u201cplanar\", where all quantum modes (e.\u00a0g.\u00a0qubits and linear resonators) are lithographically defined on chip; and \u201c3D\", where some modes are native to three dimensional structures. In both cases, however, a 3D package (a \u201csample box\") is engineered to enclose the electromagnetic modes of the circuit and prevent decoherence from microwave radiation loss.\n\n< g r a p h i c s >\n\nMain elements in 3D cQED devices (a) A sample device consisting of two 3D cavities (blue and orange), 3 transmon ancillae (purple, green, and red) together with their respective planar readount resonators (grey). All components are housed in a high-purity aluminium package. (b) The equivalent circuit representation of the device. (c) A more detailed illustration of the transmon and cavity interface. The coupling strength between the two is determined by the overlap between the transmon capacitor and the field (blue arrows) of the cavity. (d) A cross-sectional view of the coupling mechanism to the transmon and the readout reasonator via field-replaceable pins. (e) A schematic of the clamping structure for chips containing the transmon and its readout resonator.\n\nIn the 3D architectures (Fig.\u00a0(Figure fig:device_3d)), the large volume of vacuum inside the package (i.e.\u00a0the 3D cavity), typically a few cm$^3$ in size, is used as the linear modes in the cQED Hamiltonian. They couple weakly to transmission lines via coaxial center pins that are extended into apertures through the cavity wall (Fig.\u00a0(Figure fig:device_3d)(d)). These cavities also couple to qubits or other resonator modes, which are typically constructed using lithographically-patterned planar structures (Fig.\u00a0(Figure fig:device_3d)(c)) with large capacitor structures to provide effective coupling to the 3D cavity mode. They can be fabricated on one or more chips, which are mechanically clamped in place by nuts and bolts (Fig.\u00a0(Figure fig:device_3d)(e)). This architecture has several advantages, especially for a beginner experimentalist working with a small-scale quantum circuit:\n\n* It is simple to assemble: No peripheral structures and materials, such as printed circuit boards and wire-bonds, are needed to bridge the quantum modes and the external cables.\n\n* It provides a clean electromagnetic environment: The absence of peripheral structures saves the engineering effort to suppress spurious modes in the device package.\n\n* It exhibits good coherence times for the same material quality due to the small surface-to-volume ratio of the quantum modes. In particular, the long-lived 3D cavity modes prove to be a valuable quantum resource.\n\nThese appealing features make such 3D cQED devices powerful experimental testbeds for developments in quantum error correction\u00a0[Unknown Author, \"Unknown Title\", ] and bosonic quantum simulations\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nHowever, there are also several important limitations associated with the current generation of devices based on machined cavities. The large spatial extent of the 3D cavity electromagnetic field makes it difficult to achieve good mode isolation within the same cavity. Furthermore, the lack of DC connection to the chip limits tunability and integration with circuit elements that require flux biasing. Active research is underway to develop techniques that could potentially resolve these challenges\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nA typical example of a planar cQED system. (a) A superconducting chip embedded in a printed circuit board (PCB) via wire bonds. The PCB provides the structures for grounding, microwave interconnects, and mounting elements to the sample box. (b) A more detailed view of a typical multi-qubit chip together with resonator buses and readout modes (dark grey). Each qubit can be controlled via on-chip flux (green) or microwave (blue) drive lines. (c) A typical flux-tunable transmon qubit capacitively coupled to several resonator modes.\n\nThe planar architecture (Fig.\u00a0(Figure fig:device_2d)) is centered around a lithographically-patterned cQED chip. The chip defines all the quantum modes desirable for the application, although the packaging around it may affect the fine details of the Hamiltonian parameters. Other than all the quantum circuit elements, the chip typically also includes feedlines, which are co-planar waveguides (CPW) impedance-matched to the input/output coaxial cables.  They are weakly coupled to the quantum circuit elements to supply and extract microwave signals. The chip is then embedded on a printed circuit board (PCB), with their corresponding CPW ports connected and their respective ground planes tied together, often using a large amount of wire-bonds. Bulk superconducting covers are attached to the ground plane of the PCB to enclose the chip into an area as small as possible (limited to less than $\\sim$1 cm$^2$ without on-chip 3D interconnects) to suppress the box modes. The PCB routes the input/output signal lines to a set of planar-to-coax transitions for external cable connections. More details on the design of microwave packaging for planar qubits can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The electromagnetic modes and the coupling schemes in such systems are relatively local, therefore, well-engineered planar cQED devices afford many favorable features such as\n\n* Fast magnetic flux control of qubits, resonators or coupling elements,\n\n* Independent design of large numbers of quantum elements on the same chip with low cross-dependence of parameters,\n\n* Flexible access to individual elements locally.\n\nthat are not readily available in the 3D architecture yet.\n\nDue to these advantages, recent experiments with more than 10 qubits and resonators have generally adopted the planar approach. However, further scaling of planar devices beyond 50 qubits will likely require 3D integration of on-chip elements, employing techniques such as flip-chip indium bonding and through-silicon vias. Therefore, the two disparate device architectures, signified by the difference in their treatments of the box modes and ground planes, may eventually converge into a similar technological platform.\n\n### Configuring the building blocks\nThe very first step in the cQED design flow is to ask the following questions: How many non-linear elements (e.g.\u00a0qubits) and linear elements (e.g.\u00a0resonators) are required to realize the desired device functionality? What are the roles, mode frequencies, tunability, and required coherence properties of each of them? What is the required connectivity of the device and how are the different elements coupled to one another?\nThese basic considerations often dictate whether the device is better (or easier) built with the planar or the 3D approach under the current technology.\n\nIn either planar or 3D cQED devices, linear modes are realized with superconducting resonators whose frequencies are dictated by the dimensions of the electromagnetic structures. While lumped-element LC resonators (with interdigitated capacitors and meandering wires) are valuable for their small footprint, the most widely-used superconducting resonators in the field are the CPW resonators for the planar approach, and variations of coaxial resonators for the 3D approach\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Physically, they are equivalent to an infinite series of LC oscillators, but usually only the fundamental mode is employed in cQED experiments. Ideally, the higher-frequency modes are sufficiently detuned from resonance frequency of interest in the system to not interfere with the intended use of the device. However, we must be aware of the existence of these modes and their potential impact on qubit coherence (e.g.\u00a0thermal shot noise dephasing\u00a0[Unknown Author, \"Unknown Title\", ], see Sec.\u00a0<ref>), and exercise special care to prevent spurious multi-photon transitions.\n\nCPW resonators are typically realized with a section of CPW transmission line terminated with open or short boundary conditions on the two ends. The CPW has a geometric capacitance and inductance per unit length $C_g$ and $L_g$ which can be calculated from the cross-sectional dimensions of the CPW (e.\u00a0g.\u00a0widths of the center conductor and the dielectric gap). Furthermore, the kinetic inductance of the superconducting thin film per unit length $L_k$ also influences the wavelength ($\\lambda=2\\pi/\\omega\\sqrt{C_g(L_g+L_k)}$) of the propagating wave. The value of $L_k$ depends on the cross-sectional dimensions and the material properties, but it can be estimated from the room temperature resistivity of the film. The contribution from $L_k$ is typically small but not negligible in standard planar devices.\n\nHaving taken these factors into consideration, the length of the CPW section can then be designed based on the targeted resonator frequency and the type of termination. Recall that a CPW terminated by two open ends forms a $\\lambda/2$ resonator, and a CPW terminated by an open and a short end forms a $\\lambda/4$ resonator. A typical operating frequency of $\\sim$5 GHz translates to CPW lengths on the orders of 1 cm, but the total footprint can be reduced by using meandering patterns, as depicted in Fig.\u00a0(Figure fig:device_2d)(b).\n\nSimilarly, the coaxial resonator can be understood as a section of coaxial transmission line terminated with open or short boundary conditions on the two ends. A $\\lambda/4$ version of the coaxial resonator can be constructed by conventional machining from a single piece of bulk superconductor (Fig.\u00a0(Figure fig:device_3d)(c)), eliminating the ohmic dissipation from the imperfect seams in bulk metal assembly\u00a0[Unknown Author, \"Unknown Title\", ]. This advantage leads to reliably high coherence times, which has made this type of \u201creentrant post cavity\" a go-to design for high-Q quantum memory in cQED\u00a0[Unknown Author, \"Unknown Title\", ]. A $\\lambda/2$ version of the coaxial resonator uses a machined tube as the ground shield and an on-chip superconducting strip as the center conductor (Fig.\u00a0(Figure fig:device_3d)(d)), affording the flexibility of having multiple resonators, qubits and Purcel filters on the same chip with mostly lithographically defined couplings\u00a0[Unknown Author, \"Unknown Title\", ]. Again, the required length of the resonators can be estimated from the wavelengths of coaxial travelling modes at the target frequency.\n\nThe design of non-linear modes such as qubits, couplers, and parametric mixers typically begins with lumped-element approximations. The inductive circuit component is provided by the Josephson junctions, whose non-linear inductance can be easily varied via the tunnelling area of the junctions. The capacitance of the mode is tuned by adjusting the dimensions of the superconducting leads and pads ( purple-colored structures in Fig.\u00a0(Figure fig:device_2d)(b) and Fig.\u00a0(Figure fig:device_3d)(c)).\nFor transmon qubits, the desired frequency is typically in the range of $4-8$ GHz. This frequency range is sufficiently to suppress thermal excitations at 20 mK, low enough to mitigate couplings to higher-frequency spurious package modes, and is supported by existing  high-performance and relatively cost-effective microwave electronics. Inductance and capacitance of the transmons are usually designed in the range of $6-16$ nH and $50-125$ fF (with $2-5$ fF from the tunnel barrier of the junction itself), corresponding to $E_J\\sim10-25\\,$GHz and $E_C\\sim160-400$ MHz, respectively. This range of $E_C$ is chosen to effectively suppress charge noise (which grows exponentially with $E_C$\u00a0[Unknown Author, \"Unknown Title\", ]) while still preserving a sizeable anharmonicity $\\alpha\\approx E_C/\\hbar$ (which is crucial for fast qubit operations).\n\nNext, let us consider the necessary coupling between different elements in the device. The dispersive coupling between a transmon and a resonator, for instance, can be achieved by ensuring a sufficient overlap between their electromagnetic fields. In other words, a strong coupling, or a large $g$, can be realized if there is a high mutual capacitance between the two modes. The coupling capacitance in planar designs (such as the fork-shaped structures in Fig.\u00a0(Figure fig:device_3d)(c)) can be calculated either using conformal mapping techniques\u00a0[Unknown Author, \"Unknown Title\", ] or analytical expressions for certain specific use cases\u00a0[Unknown Author, \"Unknown Title\", ]. Alternatively, an inductive coupling can be achieved by introducing a mutual inductance between the two modes. Moreover, the magnitude of the dispersive interaction $\\chi$, depends not only on $g$ but also on the frequency detuning $\\Delta$ between the two elements (Eq.\u00a0<ref>), which can be modified by adjusting the dimensions of individual elements and hence, their individual frequencies. If the target Hamiltonian requires multiple qubits and gates between them, it is important that we arrange the geometric configurations such that their resonance frequencies are well-separated and their mutual capacitance or inductance is kept small to avoid unwanted couplings.\nFinally, we consider the roles that each element in the device must play, which is crucial for setting up their input/output coupling. For resonators, there are generally three main functions: readout, memory, or bus. A readout resonator should be relatively strongly coupled to a transmission line to allow efficient extraction of information, with an output coupling Q typically on the order of $10^3$ to $10^4$. In planar designs, the coupling Q between a CPW resonator and a CPW feedline can be controlled by a conveniently parameterized coupling capacitance at the end of the resonator. In 3D designs, the coupling Q of the resonator is often controlled by the length of the coupling pin\u00a0[Unknown Author, \"Unknown Title\", ] (extension of the coaxial center conductor) inserted into the cavity wall (Fig.\u00a0(Figure fig:device_3d)(d)). On the other hand, a long-lived quantum memory resonator should be designed with an input drive line with coupling Q sufficiently high to not compromise its total quality factor.\n\nSimilarly, we also need to evaluate what functionalities each qubit should be endowed with.\nA fixed-frequency transmon simply requires a single junction connected to two superconducting pads, whicle a flux-tunable qubit requires more JJs to form flux loops. This can be implemented in configurations such as the symmetric/asymmetric SQUID transmons, SNAIL\u00a0[Unknown Author, \"Unknown Title\", ], flux qubits\u00a0[Unknown Author, \"Unknown Title\", ] and fluxonium\u00a0[Unknown Author, \"Unknown Title\", ]. In addition, the use of flux-tunable elements also entails that we must include flux-bias lines. This can use a short-ended CPW in close vicinity to the flux loop in planar circuits. In 3D architecture, a centimeter-scale external coil can be used to provide a global DC flux to flux-tunable devices inside a copper package\u00a0[Unknown Author, \"Unknown Title\", ], but fast and local flux-biasing remains under development\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nControlling these quantum elements requires carefully designed microwave feed-lines. For fixed-frequency transmons, this translates into the addition of capacitively coupled drive line for X/Y control of the qubit. On the other hand, flux-tunable elements require inductively coupled flux-bias lines. Adding these features necessarily introduces a coupling to the (dissipative) environment and could result in elevated dissipation rates in the device.\n\nThe reduction in the coherence (relaxation) time due these additional elements can be calculated\nwith a circuit model using the dissipative environmental impedance $\\mathrm{Re}[Z(\\omega)]$\u00a0[Unknown Author, \"Unknown Title\", ]:\n$$\n\n\\Gamma = \\frac{1}{\\mathrm{Re}[Z(\\omega)] C_\\Sigma },\n\n$$\nwhere $C_\\Sigma$ is the effective capacitance of the transmon.\n\nFor a transmon coupled to a resonator, this reproduces the Purcell limit (\u00a0<ref>). For a transmon qubit capacitively coupled to a microwave drive line, this results in an effective decay rate of\n$$\n\n\\Gamma_{\\mathrm{D}}  \\simeq \\omega_q^2 Z_0 C_c^2 / C_\\Sigma,\n\n$$\nwhere $\\omega_q$ is the resonance frequency of the qubit, $Z_0$ is the characteristic impedance (typically $50~\\Omega$), $C_c$ is the coupling capacitance. Assuming the typical system parameters of $\\omega = 2\\pi\\cdot 5\\,\\mathrm{GHz}$, $C_\\Sigma=65\\,\\mathrm{fF}$, and $C_c=0.1\\,\\mathrm{fF}$, we get an effective energy relaxation time of $T_1 = 1/\\Gamma_{\\mathrm{D}}\\approx 132\\,\\mu \\mathrm{s}$.\n\nSimilar analysis for a flux-bias line, modelled as a capacitance $C_c$ in series with the transmon and a shunt inductance $L_c$, gives an effective decay rate\u00a0[Unknown Author, \"Unknown Title\", ]:\n$$\n\n\\Gamma_{\\mathrm{FBL}} \\simeq \\frac{1}{Z_0  C_\\Sigma} \\left(\\frac{\\omega_q}{\\omega_c}\\right)^4 ,\n\n$$\nwhere $\\omega_c= \\frac{1}{\\sqrt{L_c C_c}}$\u00a0[Unknown Author, \"Unknown Title\", ]. Filling in typical values of $\\omega_q = 2\\pi\\cdot 5\\,\\mathrm{GHz}$, $C_\\Sigma=65\\,\\mathrm{fF}$,  $C_c=10\\,\\mathrm{fF}$, and $C_c=20\\,\\mathrm{pH}$ results in an effective $T_1$ $1/\\Gamma_{\\mathrm{FBL}}\\approx 83\\,\\mu \\mathrm{s}$.\n\nPractically, superconducting quantum devices often more complex than such a simple model could capture. Hence, these equations can only serve as a rule-of-thumb in the design process. Many advanced software tools, such as QuCAT\u00a0[Unknown Author, \"Unknown Title\", ] and scqubits\u00a0[Unknown Author, \"Unknown Title\", ], can help in calculating the device parameters and dissipation rates more accurately.\n\n### Extracting system parameters\nAfter laying out the basic structures of the device, we can now perform numerical simulations to extract the relevant parameters. There are several commercial software capable of simulating electromagnetic structures at GHz frequencies, such as the Ansys HFSS, COMSOL, and Sonnet. These solvers provide a useful tool to visualise the distribution of the various electromagnetic resonance modes in the device and analyze their respective coupling strengths to other modes, as well as to the environment.\n\nIn these simulations, the junction is treated as a simple lumped-element structure consisting of an inductor and a relatively small capacitor (whose values are determined from the specifications of the junction outside the simulation). The kinetic inductance of the tunnel junction accounts for nearly all of the inductance of the transmon\u00a0[Unknown Author, \"Unknown Title\", ]. The rest of the transmon features and planar cavity modes are treated as perfectly conducting metal sheets, as their kinetic inductances are small compared to that of the junction\u00a0[Unknown Author, \"Unknown Title\", ]. 3D cavities are defined by vacuum boxes whose dimensions define the resonance mode of the package.\n\nIn order for the simulation to reliably and accurately capture the various resonance modes in the system, the mesh seeding and convergence criteria must be set with careful considerations. A finely meshed surface allows more accurate evaluation of the electromagnetic field distributions but imposes a significant penalty on computational time. This can typically be optimised by applying a non-uniform mesh, which places a finer mesh in smaller features and along the edges where the electric fields tend to focus, but creates coarser mesh surfaces on large, regular features with a low concentration of electric fields. The choice of convergence criteria is made based on the goal of the simulation. Typically, we apply a frequency convergence limit of at least 0.5\n\nBased on the results of these simulations, we can apply numerical algorithms to extract the relevant Hamiltonian parameters of the system. There are two main strategies: the Blackbox Quantization (BBQ)\u00a0[Unknown Author, \"Unknown Title\", ] and Energy Participation Ratio (EPR)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] approach.\n\nThe BBQ model treats the Josephson junction as a small non-linear perturbation to a network of linear inductors and capacitors. The locations of each of the zeroes and poles of the impedance reveal the various Hamiltonian parameters. This has later been improved to more effectively account for multi-mode systems involving several non-linear modes\u00a0[Unknown Author, \"Unknown Title\", ]. While BBQ offers a comprehensive tool for analyzing the key Hamiltonian parameters for cQED systems, it requires additional simulation steps to acquire the numerical impedance associated with the circuit.\n\nThe EPR approach, on the other hand, offers a simpler alternative which computes the Hamiltonian parameters based on the distributions of the electromagnetic field that can be obtained directly from the finite-element simulation. More specifically, the EPR of a junction element $j$ in the mode $m$, denoted by $p_{mj}$, is defined as the fraction of the total inductive energy of $m$ that is stored in $j$. In this framework, $p_{mj}$ is a bounded real number from 0 to 1, where 0 indicates that junction $j$ does not share any energy with mode $m$ while $p_{mj} = 1$ means that $j$ is the only element excited by $m$. Furthermore, we can directly extract the various Hamiltonian parameters, such as the mode frequencies, $\\omega_{i}$ and non-linear coupling terms, $\\chi_{ik}$, to $p_{ik}$, where $i,k \\subseteq\\{m, j\\}$. Overall, the EPR method reduces the number of simulations needed and readily generalises to arbitrary circuit configurations consisting of one or more non-linear elements. The algorithm gained significant traction over the past few years and has been made open-source by its developers\u00a0[Unknown Author, \"Unknown Title\", ].\n\nDesign considerations for optimal coherence\n\nWhile the Hamiltonian parameters and input/output coupling parameters are largely determined by the circuit design to a good accuracy, decoherence effects in quantum circuits are dictated by small residual interactions with a large number of environmental degrees of freedom that are not under direct control of the circuit designer. Some of these interaction channels produce noise \u201ctransverse\" to the quantization axis of the qubit, leading to energy relaxation, or $T_1$ processes, and some produces \u201clongitudinal noise\" that leads to dephasing, or $T_{\\phi}$ processes. (See Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for a more detailed review of these concepts.) An illustration of some of the potential sources of decoherence in a typical planar cQED device is shown in Fig.\u00a0(Figure fig:losses). A quantitative and microscopic understanding of many of these decoherence channels remains an active research frontier of fundamental importance. Nevertheless, based on phenomenological models, there are some overarching design principles for optimizing the coherence properties.\n\nFor each type of physical decoherence mechanism, there are three factors that are multiplied to dictate the magnitude of the decoherence rate:\n\n* The matrix element that governs the susceptibility of the qubit Hamiltonian to the qubit-environment coupling operator. The simplest example is the transmon, whose susceptibility to charge noise is diminished by adopting a carefully chosen ratio of $E_J /E_C$. In more advanced circuits, the suppression of this matrix element requires fundamental changes to Hamiltonian itself, such as the case of a \u201cprotected $0$-$\\pi$ qubit\"\u00a0[Unknown Author, \"Unknown Title\", ].\n\n* The intensity of microscopic noise sources in the solid-state environment: examples include the density of two-level systems (TLS) or quasiparticles. Improvements on this factor hinge on the property of the materials, which depends on the techniques of device fabrication and cryogenic measurement setups.\n\n* The geometric coupling efficiency between the noise sources in a given material and the quantum mode of interest: This factor is best captured by the concept of participation ratios, which provides a convenient framework for analyzing and optimizing the device layout for decoherence considerations, and is the focus of this subsection.\n\nHere, we focus on mitigation of energy relaxation due to dielectric loss, which is one of the most prominent decoherence mechanisms in cQED devices, and use it as an illustration for the design considerations of transmon qubits. Dielectric loss is widely attributed to microscopic two-level-system (TLS) defects in material interfaces and (to a lesser degree) the bulk materials. They couple to the charge degree of freedom, $\\bn$, of the resonator or qubit mode via an electric dipole moment. Macroscopically, the intensity of dielectric loss in a given material can be described by adding an imaginary part to the material's dielectric constant: $\\epsilon\\rightarrow\\epsilon(1+i\\tan{\\delta})$, where $\\tan{\\delta}\\ll1$ is the loss tangent. The decay rate induced by dielectric (i.e.\u00a0capacitive) loss, $\\Gamma_{cap}$, can be decomposed into contributions from various materials or components:\n$$\n\n\\Gamma_{cap} = \\eta_{n} \\omega\\sum_i p_i \\tan\\delta_i,\n\\label{eq:p_ratio}\n\n$$\nwhere $p_i$ is the capacitive participation ratio of the $i^{th}$ material, defined as the proportion of electric field energy of the quantum mode stored in this material. $\\delta_i$ is the loss tangent, $\\omega$ is the angular frequency of the mode, and $\\eta_n$ is an adjustment factor based on the charge-coupled transition matrix element: $\\eta_n=1$ for a harmonic oscillator and is approximately 1 for a transmon.\n\n< g r a p h i c s >\n\nPotential losses in a planar cQED device. An illustration of various noise channels that are present in a device. Here, a lithographically patterned chip is positioned within a circuit board holder (light yellow), which in turn sits within a metal enclosure (blue). This environment can be lossy (modeled by resistors) due to effects such as unwanted couplings (teal), spurious modes (red), material dissipation (maroon), and radiation (dark brown), etc. Inset: A cross section of an edge of the lithographic structure to highlight the surfaces losses due to different interfaces. The three interfaces of interest with thickness $t$ are shown are MS (orange), MA (green), and SA (blue). The divided regions of the superconductor (thickness $h$) refer to the interior regions (grey) and perimeter regions (purple). Their individual contributions have been simulated and compared across different designs in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nTypically, circuit elements with planar geometries have the majority ($\\approx90\\%$) of their electric energy stored in the bulk substrate. Therefore, having a substrate with low loss tangent, such as crystalline sapphire or silicon (tan $\\delta_i\\lesssim10^{-7}$), is a prerequisite to achieve high coherence. Most deposited dielectric materials tend to have a much higher loss tangent, and their presence, if absolutely necessary, must be strictly limited and their participation ratios kept relatively low. Even without deposited dielectric materials, amorphous layers often form at the metal-substrate (MS), substrate-air (SA), and metal-air (MA) interfaces, as shown in the inset of Fig.\u00a0(Figure fig:losses). These few-nanometer-thick interface layers store a small fraction $p_i$ of the field energy but are often the limiting factor of qubit coherence due to their high tan $\\delta_i$ (on the order of $10^{-3}-10^{-2}$). It is therefore helpful to minimize the surface participation ratios for these layers when choosing qubit geometries whenever possible.\n\nThe rule of thumb for estimating surface dielectric participation ratios is that it scales inversely with the feature size of the capacitive elements. This can be conceptually understood by conformal mapping of complex geometries into parallel-plate capacitors\u00a0[Unknown Author, \"Unknown Title\", ]. While the absolute magnitude of the surface participation ratios depend on rather subjective assumptions of the thickness $t_{i}$ and dielectric constant $\\epsilon_i$ of the surface layers, it allows relative comparison of surface-loss sensitivity across different devices. For example, one may crudely estimate that $p_{MS}\\approx \\frac{\\epsilon_b}{\\epsilon_{MS}}\\frac{2t_{MS}}{d}$ for a pair of capacitive electrodes separated by a (loosely-defined) distance $d$ on a substrate with dielectric constant $\\epsilon_b$. For a transmon with a CPW-style capacitor which has a gap width of 20 $\\mu$m, if we assume $d=20$ $\\mu$m, $t_{MS}=3$ nm, $\\epsilon_{MS}=\\epsilon_b=10$, we find $p_{MS}\\approx3\\times10^{-4}$.\n\nFor more detailed calculation of surface participation ratios, finite-element numerical simulations are often used. To address the huge span of length scales (from millimeter for the size of a typical transmon to the sub-nanometer spatial resolution needed to compute the electric field inside the surface layers correctly), a common strategy is to focus on a 2D cross-sectional or a 3D regional (small-volume) electrostatic simulation, where the surface layers can afford to be explicitly represented in the geometry. One can then use symmetry-based arguments\u00a0[Unknown Author, \"Unknown Title\", ] to extend these results to the full qubit, or use scaling properties to embed these results into a full-scale high-frequency simulation with lower resolution\u00a0[Unknown Author, \"Unknown Title\", ]. One observation from numerical calculation is that the concentrated field energy near the edges and corners of the device structures contribute to surface participation ratios quite substantially. This has prompted the practices of using rounded corners or circular shapes in the device layout, and etching trenches into the substrate for a depth on the scale of $\\mu$m's\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nMinimizing surface loss generally calls for larger feature sizes for the shunting capacitors of qubits, but there are a few trade-offs and limitations. One trade-off is radiation loss: the larger footprint for coplanar electrodes results in a larger electric dipole that radiates more effectively into the 3D space inside the device package. If this radiation is coupled to low-Q package modes or a continuum of modes, the qubit mode will incur additional relaxation. A related problem in multi-qubit devices is unintended cross-talk between distant qubits. Therefore, the use of geometrically larger qubits poses more stringent requirements on the microwave hygiene of the device package. Furthermore, even with full control of the package modes such as in a 3D cQED architecture, geometric minimization of surface participation ratio is ultimately limited by the presence of the (nano-scale) Josephson junctions and the narrow superconducting leads near the junctions. The \u201c3D transmon\" design\u00a0[Unknown Author, \"Unknown Title\", ] is approaching such a limit, where the contributions from the leads (e.g.\u00a0$p_{MS,leads}\\sim2\\times10^{-5}$ under the same assumptions of $\\epsilon_{MS}=10$ and $t_{MS}=3$ nm) are no longer negligible\u00a0[Unknown Author, \"Unknown Title\", ].\n\nFor inductive dissipation mechanisms, a similar analysis can be applied. Part of the total inductive energy is associated with the geometric inductance of the circuit and is present in the form of magnetic field energy in free space and in the dielectric materials. It is usually assumed that non-magnetic materials do not contain a meaningful imaginary permeability component to dissipate magnetic field energy. The other part of the inductive energy is associated with the kinetic inductance of the Cooper pairs, and its ratio to the total inductive energy is known as the kinetic inductance fraction $\\alpha$. For a superconducting resonator, the kinetic inductance energy is stored in the surface current of the superconductor and can be computed from the surface integral of magnetic field energy and the penetration depth of the superconductor (20-50 nm for Al\u00a0[Unknown Author, \"Unknown Title\", ] and Nb\u00a0[Unknown Author, \"Unknown Title\", ]). In this case, $\\alpha$ can be interpreted as an inductive surface participation ratio, which is inversely proportional to the feature size of the resonator. Interestingly, $\\alpha$ can be measured experimentally using the temperature dependence of the resonator frequency based on the Mattis-Bardeen's formula for AC conductivity of a BCS superconductor\u00a0[Unknown Author, \"Unknown Title\", ], which provides a useful tool to quantitatively investigate this effect in addition to finite element simulations.\n\nIf we decompose the kinetic inductance fraction $\\alpha$ into contributions $\\alpha_i$ from different superconducting materials or different spatial regions $i$, the quality factor of the resonator due to inductive loss can be written as:\n$$\n\n\\Gamma_{ind}=\\eta_{\\phi} \\sum_i \\omega \\frac{\\alpha_i} {Q_{s,i}},\n\\label{eq:ind_p_ratio}\n\n$$\nwhere each region of the material has its \u201csurface Q\", $Q_{s,i}$. The finite surface Q indicates the presence of Ohmic loss in the surface current, which can originate from the presence of quasiparticles\u00a0[Unknown Author, \"Unknown Title\", ], vortices\u00a0[Unknown Author, \"Unknown Title\", ], or normal regions that might be caused by imperfect superconductor-to-superconductor interfaces\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Furthermore, there is also an intrinsic limit on the surface Q due to dissipation from excitation of phonons in the presence of an AC fields\u00a0[Unknown Author, \"Unknown Title\", ].\n\nResonators made from Al or Nb films on the order of 100 nm thick can be made with low kinetic inductance ($\\alpha <0.01$) and hence relatively insensitive to inductive loss. However, superconducting qubit modes often have $\\alpha$ approaching 1, because the inductive energy of the Josephson junction dominates the magnetic field energy. Therefore, as in the case of a transmon, the inductive loss is usually dominated by quasiparticle tunneling across the junction\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. As a result, reduction of inductive loss in transmons cannot be achieved by reducing surface participation ratios through variations of electrode geometry. Instead, quasiparticle traps realized with vortices or normal metals can be employed to reduce non-equilibrium quasiparticle density and consequently, the total inductive loss\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Although such measures degrade the average $Q_s$ of the superconducting film, it is often a winning trade because the kinetic inductance fraction of the tunnel junction far exceeds the surface contribution from the film.\n\n### Device fabrication\nOne of the most crucial aspects in constructing cQED devices is the ability to fabricate JJs with precise and reproducible parameters. Generally, JJs are fabricated on either silicon or sapphire substrates using standard electron-beam lithography techniques, followed by double-angle evaporation using either the Dolan-bridge\u00a0[Unknown Author, \"Unknown Title\", ] or the bridge-free method\u00a0[Unknown Author, \"Unknown Title\", ]. Additional techniques that potentially allow more flexible junction geometries and potentially better yield are also being explored\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nAlthough the fabrication techniques are well-established, there are a few key considerations specific to producing reliable and reproducible quantum devices. In particular, the presence of spurious TLSs in the device can lead to lossy interfaces between the substrate and the superconducting film, as discussed in the preceding subsection. Furthermore, parasitic  coupling  from  the circuit elements to these spurious TLSs in the substrate or the superconducting film also results in fluctuations in system parameters and deterioration of their performance\u00a0[Unknown Author, \"Unknown Title\", ]. One commonly employed technique to reduce TLSs level in typical cQED devices is to ensure that the substrate-metal interface is pristine. This is achieved by performing in-situ isotropic oxygen-plasma cleaning in the evaporator before metal is deposited. The intensity of this process must be optimized carefully because excessive cleaning could damage the substrate surface while insufficient cleaning will leave undesired residuals, both would result in a deterioration in the coherence properties of the device. In addition, the appropriate cleaning procedure has also been shown to reduce the aging of JJs and enhance the stability of the devices\u00a0[Unknown Author, \"Unknown Title\", ]. For silicon substrates, cleaning in hydrofluoric acid (HF) and terminating the surface with hydrogen prior to film deposition has been shown to reduce losses due to native oxides, residues, and surface defects\u00a0[Unknown Author, \"Unknown Title\", ]. Apart from surface treatment, less reactive superconducting materials have also been adopted to avoid amorphous surface oxides, and fabricating electrode and junction barriers from crystalline materials. A detailed discussion on the various sources of TLS and their respective mitigation techniques is provided in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nAfter JJs are fabricated, we typically want to have a quick and simple way to probe their key characteristics before cooling down the device to 20 mK. At room temperature, the tunnel junctions behave like a normal resistor. We can perform a quick verification of the Josephson energy, $E_{J}$, by measuring the normal state resistance of the junction, $R_{n}$, which is related to $E_{J}$ by the Ambegaokar-Baratoff relation\u00a0[Unknown Author, \"Unknown Title\", ],\n$$\n\\label{eq:AB}\nI_{C}R_{n} = \\Phi_0\\Delta(T)\\tanh{\\frac{\\Delta(T)}{2k_{B}T}}.\n\n$$\nHere, $\\Delta(T)$ is the superconducting energy gap at a certain temperature, $T$. This relation indicates that the product of the critical current, $I_{C}$, and normal state resistance, is an invariant quantity depending only on the material property and the temperature.\n\nAt $T=0$, Eq.\u00a0<ref> reduces to\n$$\n\\label{eq:AB_EJ}\nE_{J} = \\frac{\\Phi_{0}\\pi\\Delta}{2eR^{'}_{n}},\n\n$$\nwhere $R'_{n}$ is the normal-state resistance at $T=0$ and $\\Phi_0\\equiv h/2e$ is the flux quantum.\n\nIt is important to note that $R'_{n}$ typically increase by $10$-$20\\%$ compared $R_{n}$ due to the change in effective barrier height\u00a0[Unknown Author, \"Unknown Title\", ]. In a typical device fabricated with thin-film aluminum, standard critical temperature measurements of the deposited film indicate that $\\Delta\\approx150$-$200\\,\\mu$eV. Combining these parameters, we find that a junction with a room-temperature resistance of 6 k$\\Omega$ corresponds approximately to an inductance of $L_J = 8\\,$nH when it is cooled to 20 mK.\n\nAnother useful component in cQED devices is the 3D superconducting cavity, which is often employed to realize high-Q quantum memories or bosonic logical elements. They are usually made with high-purity (4N) aluminium through conventional machining techniques. To enhance their intrinsic quality factor, chemical etching is performed to remove residues and machining defects on the metal surface\u00a0[Unknown Author, \"Unknown Title\", ]. In addition, techniques such as annealing are also used to further improve the consistency and reproducibility\u00a0[Unknown Author, \"Unknown Title\", ] of these 3D cavities. By combining the coherence of 3D systems with the small form-factors of planar devices, micromachining\u00a0[Unknown Author, \"Unknown Title\", ] provides another promising strategy for realizing robust and compact superconducting cavities. Although a relatively recent development, remarkable progress has been made in improving the performance of these micromachined cavities\u00a0[Unknown Author, \"Unknown Title\", ] and the effective integration of transmon devices\u00a0[Unknown Author, \"Unknown Title\", ].\n\n## Creating an effective quantum environment\nThe performance of a quantum device relies heavily on the operating environment it is embedded in. In general, an effective quantum environment must provide thorough isolation from the various sources of noise both from the free space and the transmission lines while allowing coherent transmission of control signals to implement fast quantum operations. For cQED systems, creating such an environment entails careful considerations in the design of the cryogenic set-up as well as the room temperature microwave signal processing chain. Here, we aim to provide some practical guidelines on the techniques and practices used in achieving a robust quantum environment. A more advanced discussion can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nA typical microwave signal processing chain for a flux-tunable transmon coupled to a readout resonator. The input lines (green and purple) to the sample are usually wired with 20 dB cryogenic attenuators at both the 4K and 20 mK stage. This level of attenuation, together with the intrinsic insertion loss incurred along the coaxial cables, ensures that the thermal photons reaching the device are kept below $10^{-3}$. Commercial low-pass filters (LPF) and custom-made Eccosorb filters\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]are also introduced to suppress high-frequency noise. The output signal passes through a single Eccosorb filter, located inside the Cryoperm, and a low-loss filter. This typically incurs a $<2\\,$dB insertion loss on the signal, which then travels through two cryogenic circulators that provide -20 dB isolation with an additional 0.3 dB loss. The signal is routed by the two circulators to a quantum-limited amplifier which is usually tuned to operate at 20 dB gain. Here, we have omitted the pump line to the quantum amplifier. The amplified microwave signals then pass through one or two isolators to the 4K stage where they are further amplified by a wideband high-electron-mobility transistor (HEMT) amplifier before exiting the fridge to the room temperature signal processing elements. At room temperature, the drive signals to the tranmon and resonator are generated by mixing a LO tone from a microwave signal source with DAC outputs from a quantum controller. These signals are then amplified and filtered before travelling to the qubit drive line (green) and the resonator drive line (purple), respectively. The returning signal from the resonator (red) is demodulated by mixing with the same input carrier tone and then sent to the ADC channels on the controller. The flux control is performed via a flux drive line (brown) with a current source.\n\n### Cryogenic configurations\nSuperconducting circuits are operated at 20 mK where the quantum system can be initialized in its ground states and avoid spurious thermal excitations. While such temperatures can be attained reliably using commercially-available Dilution Refrigerators (DR), careful shielding and filtering considerations must also be put in place to minimize the exposure to the residual thermal noise and stray electromagnetic radiations. In this segment, we will focus our discussion on three aspects in particular, namely, arrangement of the input microwave lines for low-noise control, configuration of the output lines to allow optimal extraction of the signal, and finally, shielding of the device itself at 20 mK.\n\nTo configure the microwave lines for our room-temperature control signal to reach the device at 20 mK, we must consider thermal noise arises from both passive and active heat loads propagating down the DR. The former is caused by the flow of energy from upper to lower temperature stages in the DR, whereas the latter is due to the dissipation of applied control signals en-route to the device.\n\nOverall, residual thermal photons result in an elevated effective temperature of device. In particular, the readout resonators, which are typically strongly coupled to the transmission lines and the environment, can be prone to a non-negligible thermal photon population, $\\bar{n}_\\mathrm{th}$. This, in turn, lead to dephasing, and a reduced $T_2$, of the qubit that couples to the resonator, at a rate given by\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]:\n$$\n\n\\Gamma^{\\mathrm{th}}_{\\phi} = \\frac{\\bar{n}_\\mathrm{th}\\kappa\\chi^2}{\\kappa^2 + \\chi^2},\n\n$$\nwhere $\\kappa$ is the linewidth of the resonator and $\\chi$ is its dispersive coupling strength to the qubit. Therefore, it is crucial to to reduce the amount of residual thermal photons in our quantum system in order to achieve better coherent times.\n\nIn order to suppress thermal noise, attenuators must be introduced along the microwave lines in the DR. To illustrate the importance of choosing the appropriate attenuation, let us consider the effect of the heat load at each temperature stage. The thermal energy at a given temperature, $T_i$, translates into an influx of photons propagating down to the device, with an average number, $\\langle n_i\\rangle$, given by\n$$\n\\label{eq:nbar}\n\\langle n_i\\rangle = \\frac{1}{e^{\\hbar\\omega/k_B T_i} - 1}.\n\n$$\nIt must be suppressed to or below the temperature of the subsequent cooling stage in order to minimize the propagation of thermal noise. This is achieved by introducing appropriate cryogenic attenuators at each temperature stage. An attenuator can be modeled as a beamsplitter which transmits a small fraction of the incident power while at the same time, adds a certain amount of thermal photons due to the black-body radiation at the temperature stage where it is located. To illustrate this, let us consider a system with an attenuator $A_1$ placed at a higher temperature stage and $A_2$ on a lower stage. The resulting average photon number at is given by\n$$\n\\label{eq:propagation_nbar}\n\\langle n_{f}\\rangle = \\frac{\\langle n_i\\rangle}{A_1A_2} + \\left(1-\\frac{1}{A_1}\\right)\\frac{\\langle n_1\\rangle}{A_2} + \\left(1-\\frac{1}{A_2}\\right)\\langle n_2\\rangle,\n\n$$\nwhere $n_i$ is the average number of photons going into the system and $n_{1, 2}$ the photons at each of the temperate stages as given by Eq.\u00a0<ref>. Note that the attenuations, $A_{1,2}$, are in linear units which are related to the typical units of attenuators by $A=10^{A'/10}$ where $A'$ is the level of attenuation given in dBs.\n\nFrom Eq.\u00a0<ref>, we infer that attenuators are more effective in suppressing thermal noise when they are placed on the lower temperature stage. However, most attenuators employ dissipative elements which could cause additional heating if the dissipation exceeds the cooling power of the DR at the specific temperature. In order to balance both of these effects, reflective elements such as custom reflective attenuators\u00a0[Unknown Author, \"Unknown Title\", ] have been developed to achieve sufficient attenuation without significant dissipation at the 20 mK. Additionally, directional couplers can also be used to route the excess microwave power back to the higher temperature stage (typically 4 K) where there is significant higher cooling power such that the dissipation does not have any measurable impact on the temperature. A typical configuration of the transmission lines connecting the device in a DR to room temperature is shown in Fig.\u00a0(Figure fig:example_device).\n\nIn addition to measures to reduce the thermal noise due to active heat loads, precautions should also be taken to filter out spurious frequency components that could cause unwanted transitions or couplings. This is achieved by adding cryogenic filters at the 20 mK plate of the DR. Low pass filters that can provide more than 40dB suppression of frequencies above 10GHz or 12GHz are now commercially available. Another widely adopted element is the Eccosorb filter, which employs a castable silicone rubber material capable of effectively absorbing microwave signals (20 GHz and above) to protect the device from high-frequency radiation.\n\nThe output lines are responsible for carrying the resulting signals from the device from base temperature back to room temperature for analysis. These signals, typically only on the single photon level, can be easily degraded by noise or dissipation. Hence, they must be handled carefully to ensure clean, stable, and effective collection of quantum information from the device.\n\nFirst, it is crucial to adequately suppress the thermal noise propagating from the higher temperature stages while allowing the signal to propagate without significant attenuation. To balance these two requirements, directional components such as circulators and isolators are employed on the output lines, instead of attenuators. These non-reciprocal elements provide a low-loss path for the precious quantum signal extracted from the device to travel to room temperature while effectively reducing thermal noise flowing in the opposite direction.\n\nFurthermore, we also need to enhance the weak outgoing signal through a well-designed chain of amplifiers such that it can be distinguished from noise as it propagates back to room temperature. In other words, the role of each amplifier along the outgoing signal path is to make the signal stand out against the noise added by the subsequent amplifier as well the thermal photons from the higher temperature stages.\n\nWhen designing amplification configurations, it is important to note that amplification always comes at the cost of elevated noise temperature. This causes a degradation of the signal-to-noise ratio (SNR) despite the overall increase of the signal power. The noise temperature, $T_N$, provides a measure of the noise added by the amplifier. For an amplifier with a power gain of $G$, we can relate the amplified signal, $P^{S}_{out}$, and noise, $P^{N}_{out}$ to the input powers $P^{S, N}_{in}$, by\n$$\n\\label{eq:amp_powers}\nP^{S}_{out} &= GP^{S}_{in} ,\\\\\nP^{N}_{out} &= G(T_{in} + T_{N})k_{B}B,\n\n$$\nwhere $B$ is the bandwidth of the noise received by the amplifier, $T_{in}$ and $T_N$ the effective temperatures associated with the input signal and the noise of the amplifier, respectively. Here, the effects of quantum fluctuations are negligible as $k_B T \\gg \\hbar\\omega$. With this, we can now write the SNR at the output of the amplifier as $\\mathrm{SNR}_{out} = P^{S}_{in}/P^{N}_{out} = P^{S}_{in}/(T_{in} + T_N)k_{B}B$. Comparing this with the input SNR, given by $\\mathrm{SNR}_{in} = P^{S}_{in}/T_{in}k_{B}B$, we arrive at the relation\n$$\n\\label{eq:snr}\n\\frac{\\mathrm{SNR}_{in}}{\\mathrm{SNR}_{out}} = 1 + \\frac{T_N}{T_{in}} > 1,\n\n$$\nindicating that the SNR after the amplifier is always going to be worse than that at the input. Therefore, in general, amplification should be applied with caution and avoided if possible. On the incoming control lines, this means maximizing IQ modulated drives within the operational range of the mixer. More importantly, on the output line carrying information from the devices, it is crucial to minimize the noise associated with the first gain stage. Practically, this is achieved using a quantum limited amplifier connected to the output of the readout resonator with minimal attenuation in between.\n\nIn standard cQED measurement set-ups, the amplification chain usually begins with a quantum-limited amplifier. As the name suggests, these amplifiers only add the minimum amount of noise allowed by the laws of quantum mechanics\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. They are designed to be either phase-preserving or phase-sensitive. While the former has the advantage of preserving the phase of the incoming signal, it must necessarily double the vacuum fluctuations (i.e. add \u201chalf a photon\u201d of noise). On the other hand, the latter amplifies one quadrature of the signal without adding any noise, at the cost of de-amplifying the other quadrature by the same amount. Experimentally, phase-preserving amplifiers are featured heavily in most applications for their simplicity. In addition, some designs also offer the advantage of an extremely large bandwidth (several GHz) and compatibility with larger input signals without being saturated\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Hence, such phase-preserving amplifiers provide the capability to measure several qubits simultaneously through multiplexing\u00a0[Unknown Author, \"Unknown Title\", ]. A more detailed discussion about the operating principles and capabilities of quantum-limited amplifiers can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. Following the quantum-limited amplifier, a commercial wide-band cryogenic High Electron Mobility Transistor (HEMT) amplifier is also employed at the 4K stage to further boost the signal before it is acquired at room temperature.\n\nWe can experimentally verify that a given amplification chain satisfies its purpose with a spectrum analyzer at room temperature. As the chain amplifies the vacuum fluctuations as well as the signal, the amplified fluctuations should become larger than the thermal noise. Therefore, over the bandwidth of the quantum-limited amplifiers, the noise-floor measured by the spectrum analyzer should be raised when the amplifier is turned on. The amount by which the noise-floor is raised is sometimes referred to as the Noise Visibility Ratio (NVM)\u00a0[Unknown Author, \"Unknown Title\", ].\n\nFinally, the device must also be shielded from stray magnetic fields. In several studies\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], it has been shown that when a device is cooled to 20 mK in the presence of a magnetic field of more than 0.1 Gauss, vortices can be trapped in the thin film superconductor and cause an appreciable reduction in coherence properties. To mitigate this, we house the sample in Cryoperm shields, which are made out of high permeability nickel alloys and treated specifically to ensure robust magnetic screening properties. However, the best magnetic shielding is achieved with bulk conventional superconductors, which only work at cryogenic temperatures. These two types of shields are often used together to reject any stray magnetic field.\n\nIt is also crucial that we minimize the residual magnetic field inside the shield by using only components (screws, RF connectors, and cables, etc.) made from non-magnetic materials. The only exception to this is the presence of the Eccosorb filters. Although they are mildly magnetic, it is still common practice to place them within the shield, directly before the coupling port to the device. Some recent works have shown that this effectively reduces the residual thermal population of the devices without any measurable degradation of their coherence properties\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Microwave signal processing\nTo execute the desired experiment on cQED devices, we must be able to both generate the appropriate control pulses to perform quantum operations and digitize the signal returning from the device to obtain information about the quantum system. Traditionally, these tasks are performed using a combination of arbitrary waveform generators (AWG) and digitizers/Analog-Digital Converters (ADC). In recent years, FPGA-based systems have become increasingly popular due to their ability to integrate the functionalities of the AWGs and ADCs in a single compact hardware solution. The current state-of-the-art commercial systems are able to provide multiple well-synchronized output channels, with a sampling rate of at least 0.5-1 GSample/second and a typical vertical resolution of 16 bits in output voltages, well in excess of what is required for high-fidelity control pulses\u00a0[Unknown Author, \"Unknown Title\", ].\n\nTo perform high-fidelity gates, we typically want to be able to perform operations as fast as possible.\nIn the case of single-qubit gates on transmons, the duration of a $\\pi$-pulse, i.e.\u00a0a $\\pi$ rotation along the X or Y axis that flips the qubit state between $\\ket{0}$ and $\\ket{1}$, is limited by the presence of the nearby transition to the second excited state. As such, short ($\\tau_g \\sim 20~\\mathrm{ns}$\u00a0[Unknown Author, \"Unknown Title\", ]) Gaussian pulses with simple DRAG corrections\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] are usually chosen to enact these $\\pi$-pulses to minimize unwanted transitions outside the computational space. Following Ref.\u00a0[Unknown Author, \"Unknown Title\", ], we can use the Rabi-driving equation to determine the required pulse amplitude $V_0$:\n$$\n\n\\Theta(t) = -\\Omega V_0 \\int_0^t s(t')dt'\n\n$$\nwhere $\\Theta(t)$ is the rotation angle at time $t$, $s(t)$ the pulse amplitude, and $\\Omega$ is the Rabi-frequency, given by\n$$\n\n\\Omega = \\frac{C_c}{C_\\Sigma}Q_{\\mathrm{zpf}}.\n\n$$\nHere, $C_c$ is the capacitive coupling to the drive line, $C_\\Sigma$ the effective capacitance, and $Q_{\\mathrm{zpf}}=\\sqrt{\\hbar/2Z}$ the zero point fluctuation, and $Z=\\sqrt{L/C}$ the impedance of the circuit to ground. Filling in typical values, this results in a required power of $-66~\\mathrm{dBm}$\u00a0[Unknown Author, \"Unknown Title\", ] applied to the qubit, which translates into a peak power of $\\sim - 6~\\mathrm{dBm}$ or an amplitude of $V_P\\approx 160~\\mathrm{mV} $ at the input of the dilution refrigerator (assuming typical attenuation of $\\sim60~\\mathrm{dB}$ in the microwave lines) .\n\nNext, in order to generate these control pulses, we often combine the microwave signals emitted by a local oscillator (LO) and an intermediate frequency (IF) tone generated by the DAC channels of the quantum controller in a double-balanced IQ mixer\u00a0[Unknown Author, \"Unknown Title\", ]. Ideally, the mixer combines the LO and IF input to provide the desired radio frequency (RF) tone at a single-sideband (SSB) with frequency $\\omega_{RF} = \\omega_{LO}+\\omega_{IF}$, where the intermediate frequency can be either positive or negative. The applied voltages on the I (in-phase) and Q (out-of-phase) modulation ports afford full control over the amplitude and phase of the resulting RF tone. In practice, there are often several sources of imperfection that must be addressed to achieve a clean SSB signal\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe first consideration is mixer non-linearity, which leads to distortions of the resulting signal. To prevent this undesirable effect, it is crucial to ensure that IF input powers are kept below the 1dB compression point of the specific mixer employed.\n\nThe next imperfection to address is the presence of LO leakage, which is a result of some residual direct coupling between the LO and RF ports of the mixer. If left uncorrected, this could lead to a continuous drive at the resonance frequency of the quantum element and thus, causing unwanted Stark shifts or even elevated effective temperature of the device. This leakage is suppressed by applying well-chosen voltage offsets to the IF inputs. Experimentally, we can systematically adjust the offsets while monitoring the power at the LO frequency with a spectrum analyzer to find the optimal configurations that most effectively eliminate this leakage tone.\n\nAfter tuning the LO leakage, let us know consider the choice of SSB and the technique for eliminating the opposite component. Both SSBs are present in real IQ mixers because the I and Q inputs are not perfectly out of phase with each other (skewness). Furthermore, the same input powers on the I and Q ports do not translate into equal powers at the RF output (amplitude imbalance). Therefore, in order to suppress one of the spurious sideband tone, we must address both the skewness and amplitude imbalance of the mixer systematically. The former relates to a relative phase between the I and Q inputs while the latter is tuned by introducing a scaling factor between the input powers. These parameters are again, algorithmically adjusted to achieve the minimal leakage of the undesired sideband.\n\nIn typical cQED experiments, the lower sideband (LSB) at $\\omega_{LO}-\\omega_{IF}$ ($\\omega_{IF}\\sim -$50-100 MHz) is often employed to drive the qubits. This choice ensures that any residual LO or upper sideband (USB) leakage is far away from the second transition which is lower in frequency than that between the ground and first excited state.\n\nFinally, the resulting SSB-modulated drive signal is sometimes amplified before transmitted to the DR. As discussed in Sec.\u00a0<ref>.2, this boots the overall signal level at the expense of the SNR. Hence, it is crucial that the amplified microwave drive is subsequently attenuated and filtered in order to suppress the propagation of the added noise to the quantum device. Furthermore, a fast microwave switch with $<10$ ns response time is often added after the amplifier to prevent the added noise from propagating to the quantum device during idle times. An example of a standard room temperature RF signal processing chain is shown in Fig.\u00a0(Figure fig:example_device).\n\n## Device characterization and calibration\nBefore a cQED device can be used as a quantum processor, a series of experiments must be performed to fully characterize the system and calibrate the necessary operations. Although the exact details of this process vary with the design of the quantum device and the choice of control electronics, most cQED characterization processes share a similar set of core ingredients and a general workflow.\n\nIn this section, we offer a brief summary of the key modus operandi for probing the essential characteristics of a cQED device. We will start by discussing the procedure for tuning up a single qubit coupled to a readout resonantor and use it as an example to introduce the main techniques and practices that have been developed by the community.\n\nTo make this illustration more concrete, we focus on a flux-tunable transmon coupled to a readout resonator as shown in Fig.\u00a0(Figure fig:example_device). An overview of the different calibration experiments is given in Fig.\u00a0(Figure fig:calibration_graph) in the form of a dependency graph, similar to the presentation in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nTuneup of a single flux-tunable qubit. The typical process can be visualized as a dependency graph\u00a0[Unknown Author, \"Unknown Title\", ]. Nodes correspond to different calibration experiments, while edges denote dependencies between different experiments.\n\n### Spectroscopy experiments\nSpectroscopy generally refers to the measurement of intensity as a function of frequency and is commonly used in cQED experiments to determine resonance frequencies of resonators and qubits.\n\nIdentifying the frequency of the readout resonator is usually the first step in characterizing a device. This is typically done using single-tone spectroscopy, in either the transmission, reflection, or `hanger' configuration in which one or multiple resonators are coupled to a common feedline (see\u00a0<ref>). These techniques have their respective appeals and limitations. A thorough analysis of these different resonator measurement schemes can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nGenerally, transmission measurements are simple to set up and allow us to extract the amplitude and phase information of the signal as it passes through the resonator. Reflection measurements offer similar capabilities but with the added advantage of allowing a direct extraction of the internal quality factor. However, it requires a circulator in order to appropriately direct the input and output signals. This can potentially introduce additional losses in the measurement. The hanger configuration employs an unbalanced tee\u00a0[Unknown Author, \"Unknown Title\", ] in contrast to the circulator used in the reflection circuit. In this case, part of the input signal interacts with the resonator and upon its return, interferes with the other half that is directly transmitted through the tee. One important advantage of the hanger circuit is that it allows for many elements to be multiplexed using the same feedline. It has become a widely adopted technique in the multiplexed measurement of planar resonators.\n\nAs an example, let us consider the case of several $\\lambda/4$ CPW resonators capacitively coupled to a common microwave feedline. The measured S21 of each resonator in response to a drive at $\\omega=2\\pi f$ is described by a Lorentzian line shape, which can be written as\u00a0[Unknown Author, \"Unknown Title\", ]:\n$$\n\n\\label{eq:resonator_S21}\nS_{21} = A \\left[1+\\alpha\\frac{\\omega-\\omega_r}{\\omega_r}\\right]\\left[1 - \\frac{\\frac{|\\kappa_c|}{\\kappa}}{1+2i \\frac{\\omega-\\omega_r}{\\kappa}}\\right] e^{i(\\tau_v \\omega + \\phi_0)},\n\n$$\nwhere $A$ is the transmission amplitude away from resonance and $\\omega_r$ is the qubit-state dependent resonance frequency of the readout mode.\nThe parameter $\\alpha$ allows for a linear variation in the overall transmission chain in the frequency range around the resonator and $\\tau_v$ and $\\phi_0$ relate to propagation delays to and from the sample.\n\nThe frequency independent coupling rate $\\kappa_c$ denotes the strength with which the field of the resonator couples to the transmission line and is set by the system design, as discussed in Sec.\u00a0<ref>. On the other hand, $\\kappa_i$ is indicates the internal coherence properties of the resonator, and it is determined by the material quality and device layout, as discussed in Sec.\u00a0<ref>. Finally, $\\kappa$ contains contributions from both $\\kappa_i$ and $\\kappa_c$, i.e.\u00a0$\\kappa = \\kappa_c + \\kappa_i$. Fitting the measured S21 data to Eq.\u00a0<ref> returns the key parameters $\\omega_r, \\kappa$, and $\\kappa_c$, as described in Ref.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. We can also relate these coupling rates to the associated quality factors of the mode by $Q_{c, i} = \\omega_r/\\kappa_{c,i}$.\n\nRegardless of the exact measurement circuit, it is important to note that this spectroscopy experiment takes place before the optimization of the various pulses and amplification configurations. Thus, it can be challenging to obtain a clean signal at this stage. A useful technique to circumvent this issue is to perform a spectroscopy experiment in the high-power limit, where the resonator can be driven to a `bright' state regardless of the state of the qubit\u00a0[Unknown Author, \"Unknown Title\", ]. In this regime, the signal-to-noise ratio is boosted significantly as the high microwave power used in the probing tone dwarfs the noise in the system. This provides a convenient tool to quickly locate the bare resonance frequency of the readout mode $\\omega_R$ without tuning up the rest of the system.\n\nSubsequently, we can determine the `dressed' frequency of the resonator $\\tilde\\omega_R$ by repeating the spectroscopy experiment at different powers. This power sweep also provides a convenient test of whether the resonator is coupled to a qubit mode. If a qubit is dispersively coupled to the resonator, the resonance frequency will be different in the low-power (one or few photons) and high-power (hundreds of photons or more) regimes. In the transmission circuit, a typical power-vs-frequency sweep reveals a sharp resonance at the bare cavity frequency, which then undergoes a clear shift as the power is progressively reduced to the few photon limit, as shown in Fig.\u00a0(Figure fig:cavspec)(a).\nThis power-dependent dispersive shift is the the Lamb-shift $\\Lambda_\\chi=g^2/\\Delta$ [<ref>].\nThe profile of the resonance at this power becomes a well-defined Lorentzian with a sufficiently narrow line-width compared to the magnitude of the dispersive coupling (Fig.\u00a0(Figure fig:cavspec)(b)). Furthermore, based on this power sweep, we can now choose an appropriate readout power for the subsequent characterization experiments. It should produce a sufficiently high signal without causing non-linear distortions or broadening of the resonator response. In the example shown in Fig.\u00a0(Figure fig:cavspec)(a), we could choose $-20\\,$dBm and $-25\\,$dBm for a high-contrast readout. It is also worth pointing out that in this particular device, the transmon qubit has some residual thermal population, which gives rise to an additional feature (labeled point C in Fig.\u00a0(Figure fig:cavspec)(a)) besides the main low-power transmission peak. This corresponds to resonator's frequency when the transmon is in its first excited state, with the magnitude of the shift given by the dispersive coupling strength, $\\chi=2E_C (\\tfrac{g}{\\Delta})^2$ as shown in Eq.\u00a0<ref>.\n\n< g r a p h i c s >\n\nResonator power scan. (a) Outcome cavity spectroscopy experiments repeated at different input powers. The three features of interest are indicated by the arrows, corresponding to the high-power tranmissoin peak (A), lower power transmission peaks with transmon in ground state (B) and residual excited state (C), respectively.  (b) A line cut at three different powers, highlighting the clear shift in resonance frequency of the resonator as it transitions from the high- to low-power regimes.\n\nNext, we can use this un-optimized readout to identify the frequency of the qubit in a separate spectroscopy experiment. For flux-tunable qubits, a useful technique prior to qubit spectroscopy is to first move the qubit to the flux-insensitive sweet spot. This can be done by performing a resonator spectroscopy in the low-power regime while changing the current applied to the flux-bias line $I_{\\mathrm{FBL}}$. If the qubit couples to this flux line, $\\omega_r$ will depend on the flux bias through the dispersive shift $\\chi$. The period of $\\omega_r$ as a function of $I_{\\mathrm{FBL}}$ corresponds directly to the current per flux quantum $I_{\\mathrm{FBL}}/\\Phi_0$ picked up by the SQUID loop. In the regime of $\\omega_q<\\omega_r$, the qubit is at the sweet-spot when $\\omega_r$ is at a maximum. This also provides an estimate of the dispersive shift and the rough frequency regime of the qubit. While these are rather crude estimates, it is nonetheless helpful to narrow down the possible range of the qubit frequency as it can sometimes be challenging to identify the qubit resonance, which is typically much narrower (higher-Q) compared to the readout mode.\n\nThe technique for measuring the resonance frequency of the qubit is often referred to as a \u201ctwo-tone\" continuous-wave spectroscopy. In this protocol, a constant microwave tone is applied at $\\omega_r$ while a second drive ($\\omega_s$), with variable frequency, is employed to probe the state of the qubit. When this second tone comes close to the resonance of the qubit, i.e. $\\omega_s\\approx \\omega_q$, the frequency of the resonator changes due to the dispersive coupling. This shift leads to a change in the resonator's response to the constant drive tone at $\\omega_r$ and hence, provides an indication of the qubit state.\n\nWhile this is conceptually straightforward, it can sometimes be challenging to implement in practice. One of the difficulties relates to the power that is applied to the qubit via the spectroscopy tone. If the power is too low, the qubit will not get excited even if the drive frequency is close to its resonance and thus, no shift will be observed. On the other hand, if too much power is applied, the line width of the resonance will increase due to power broadening\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], eventually resulting in the peak becoming so wide that it can no longer be distinguished from the background. It can be hard to estimate what the \u201cright\u201d amount of power is for spectroscopy because this depends on how strongly the qubit couples to the drive line, something that is unknown before characterizing the device. An operational approach to this problem is to simply repeat the spectroscopy experiment for different powers until the resonance is found.\n\nFollowing this, we can confirm that it is indeed the qubit mode of interest by verifying the flux-dependence of its resonance frequency. Furthermore, in order to obtain a slightly more precise reading of the qubit frequency, we often employ another form of two-tone spectroscopy where both drives are pulsed, rather than continuous. Typically, a (square) pulse is first applied at $\\omega_s$, in the vicinity of the previously found qubit frequency, followed by a second pulse at $\\omega_r$. The pulsed-spectroscopy experiment removes the AC Stark shift the qubit experiences due to the always-on readout tone\u00a0[Unknown Author, \"Unknown Title\", ]. Furthermore, the absence of these continuous drives also prevent spurious heating of the device due to dissipation of microwave power at 20 mK, where the cooling power of the dilution refrigerator is limited to several $\\mu$W.\n\nAfter identifying the qubit, the anharmonicity can be determined by a simple variant of a regular two-tone spectroscopy experiment with the introduction of a third drive. This three-tone spectroscopy allows us to have an additional probe that could induce the $\\ket{1}\\leftrightarrow{\\ket{2}}$ transition of the transmon at frequency $f_{12}$ while also performing operations on the readout resonator and the $\\ket{0}\\leftrightarrow{\\ket{1}}$ transition of the qubit.\n\nIn such an experiment, the first spectroscopy tone ($s1$) is varied in frequency $f_{s1}$ around the $\\ket{0}\\leftrightarrow{\\ket{1}}$ resonance of the transmon at frequency $f_{01}$. The frequency, $f_{s2}$, of the second spectroscopy tone ($s2$) is swept around the expected $\\ket{1}\\leftrightarrow{\\ket{2}}$ transition, which is typically $\\sim 200-300\\,$MHz below the $\\ket{0}\\leftrightarrow{\\ket{1}}$ resonance. The the $\\ket{0}\\leftrightarrow{\\ket{1}}$ transition manifests as a line at $f_{s1}=f_{01}$ while the $\\ket{2}$ state appears as a diagonal line corresponding to the condition $f_{s1}+f_{s2} = f_{01}+f_{12}$. The location of this second transition indicates the anharmonicity of the transmon, which can be an important consideration for the design and calibration of subsequent single-qubit operations.\n\n### Single-qubit experiments\nHaving established a working (but not yet optimized) configuration for the readout and a good approximation of the qubit frequency through spectroscopy experiments, we can move on to more precise characterizations via a series of single-qubit experiments. This task typically involves simple measurements of the qubit state as a function of a certain parameter, such as duration, phase, amplitude, etc, of the preceding control pulses. Here, we will focus on a set of core experiments of this form that are essential for our characterization process.\n\n#### Rabi and DRAG\nUsually, we start this characterization process with the Rabi experiments\u00a0[Unknown Author, \"Unknown Title\", ], in which the qubit state oscillates between the $\\ket{0}$ and $\\ket{1}$ state as a function of the external \u201cimpulse\", i.e.\u00a0the time-integral of the applied pulse amplitude. Traditionally, this is done by applying a pulse at the qubit frequency with a fixed amplitude and varying its duration\u00a0[Unknown Author, \"Unknown Title\", ]. Alternatively, it is also a common practice to choose a fixed pulse duration and vary its amplitude. From the resulting oscillations, we can determine the amplitude or duration required to perform a rotation of the Bloch vector of the qubit along the X or Y axis by any arbitrary angle.\n\nThe typical starting point for tuning up single qubit control is to calibrate the $\\pi$ pulse. As the rotation angle is only a function of the impulse, there is, in principle, freedom of choice between higher drive amplitude and longer duration, as well as the overall waveform, to achieve the same $\\pi$ pulse.\n\nIn practice, an optimal $\\pi$ pulse is often determined based on two main considerations. First, we generally want to have fast controls on the qubit state, and therefore, would prefer to minimize the pulse duration. On the other hand, we must also be mindful that transmon qubits are not perfect two-level systems, as described by the simple Rabi model. Instead, they are anharmonic oscillators with more than two discrete energy levels. These higher levels, although detuned from the first transition frequency, must be taken into account in order to achieve a good $\\pi$ pulse without causing leakage out of the two lowest energy levels. Hence, the choice of pulse duration for qubit drives is bounded by the anharmoncity. More concretely, we must choose a pulse length such that its spectral components do not overlap with the frequency of the next transition. For a typical anharmonicity of $\\alpha/2\\pi \\approx 200\\,$MHz, a gate can be enacted by a Guassian drive with its full width half maximum, $\\sigma$, set to 4-6 ns and its total duration of $\\sim 4\\sigma\\approx 20~\\mathrm{ns}$.\n\nIn addition to choosing the appropriate pulse duration, a DRAG (Derivative Removal by Adiabatic Gate) correction is often introduced to further suppress spurious transitions to the higher levels\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Intuitively, the effect of this derivative component can (as a crude approximation) be understood as a combination of reducing the spectral overlap between the pulse and the spurious transition, while also correcting for an AC stark shift introduced by the pulse\u00a0[Unknown Author, \"Unknown Title\", ].\n\nMathematically, DRAG pulses consist of a standard Gaussian waveform as the in-phase component and scaled derivative of the Gaussian waveform as the quadrature component:\n$$\n\nI(t) = G_{amp} e^{- \\frac{(t-\\mu)^2}{2\\sigma^2}},\\\\\nQ(t) = -D_{amp} \\frac{(t-\\mu)}{\\sigma} I(t),\n\n$$\nwhere $\\mu$ is the center of the Gaussian pulse, $\\sigma$ the standard deviation, and $G_{amp}$ and $D_{amp}$ are system dependent scaling factors for the in-phase and quadrature components that can be determined through calibrations. In practice, $D_{amp}$ is usually be set to zero (making the pulse effectively Gaussian) when performing the initial Rabi experiments to determine $G_{amp}$, and can be added as a correction term in subsequent calibrations.\n\n#### Coherence measurements\nAfter tuning up a $\\pi$ pulse using a Rabi oscillation, the next step is to determine the coherence properties of the qubit, namely, the relaxation time $T_1$, the Ramsey time $T_2^\\star$, and the Echo dephasing time $T_2^E$.\n\nTo measure the relaxation time, the qubit, initialized in $|{0}\\rangle$, is excited to $|{1}\\rangle$ with a $\\pi$ pulse. This is then followed by a variable wait time $t$, and finally a measurement of qubit state. This results in an exponentially decaying signal, given by :\n$$\n\nS(t) = A\\cdot e^{-t/T_1}+B,\n\n$$\nwhere $S(t)$ is the signal as a function of wait time $t$, $A$ and $B$ are scaling and offset factors.\n\nThe Ramsey dephasing time can be obtained by initializing the qubit in $\\ket{0}$, applying a $\\pi/2$ pulse, waiting for a time $t$, applying a final $\\pi/2$ pulse and then measuring the qubit.\nThe Ramsey experiment will produce an (often exponentially) decaying oscillation described by:\n$$\n\\label{eq:t2star}\nS(t) = A e^{-(t/T_2^\\star) ^ n} \\cdot (\\cos(2 \\pi f t + \\phi) + C) +B,\n\n$$\nwhere $A$,$B$ and $C$ are scaling and offset factors, $n$ describes the profile of the exponential decay, and $f$ the frequency of the oscillation. This oscillation frequency, $f$, corresponds to the frequency detuning between the control pulses and the actual qubit frequency. Because it is difficult to distinguish an oscillation due to a low frequency (small detuning) from an exponential decay, the pulses are often slightly detuned intentionally to make this distinction more obvious. This can be either done by physically detuning the microwave source, or by changing the phase of the second $\\pi/2$ pulse (artificial detuning).\n\nIn general, $T_1$ measurement probes the overall energy relaxation times due to all the loss channels in the system, and provides an indication of the internal quality factors of the device. The Ramsey time contains information on both energy relaxation and pure dephasing ($T_{\\phi}$) in the qubit, i.e. $1/T_2^\\star = 1/(2T_1) + 1/T_{\\phi}$. It provides a useful metric for quantifying the effective decoherence time scales of the qubit and a rough bound on the performance of the subsequent single-qubit gates.\n\nThe profile of the decay $n$ in Eq.\u00a0<ref> provides some indication of whether $T_2^\\star$ is limited by $T_1$ or another source of incoherent noise $n\\approx1$. If there is a coherent noise process, such as a slow drift in the qubit frequency, $n$ will be larger than 1. In this case, it is possible to recover part of the information by adding an echo pulse. The echo dephasing time $T_2^E$ can be measured by adding a single $\\pi$ pulse in the middle of a Ramsey experiment. The final experiment consists of preparing the qubit, applying a $\\pi/2$ pulse, waiting for a time $t/2$, applying a $\\pi$ pulse, waiting for a time $t/2$, and applying a final $\\pi/2$ pulse before measuring the qubit state. The resulting dynamics now follows an exponential decay, given by\n$$\n\nS(t) = A\\cdot e^{-(t/T_2^E)^n}+B.\n\n$$\nApart from this simple sequence, there are many other different types of echo configurations developed in the field of nuclear-magnetic resonance (NMR) in the early days of quantum computing. By employing the appropriate sequences, it is possible to significantly increase the quality of certain single-qubit operations. A more detailed discussion on these useful techniques can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nAdditionally, all of these coherence measurements can be applied to characterize the properties of the higher-order transitions in the transmon as well. In particular, the second excited state ($|f\\rangle\\rangle)$ in the trasmon qubit typically has coherence properties comparable to that of the two lowest levels and can even be employed as a distinct mode for certain specialized tasks\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn general, the careful characterization of a qubit's coherence provides crucial information about both the design and fabrication of the device as well as the quality of the measurement and control set-up. We refer to the recent review by Krantz et al.\u00a0[Unknown Author, \"Unknown Title\", ] for a detailed explanation of these decoherence channels as well the associated experimental protocols. In addition to the basic relaxation and dephasing experiments, valuable information on the mechanisms that are limiting the coherence properties of the device can be gleaned by measuring coherence as a function of flux bias\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n#### Single qubit manipulations\nTuning up a full set of high-quality operations on a single qubit is a crucial step in the calibration of a cQED device. These operations correspond to rotations of the qubit state on the Bloch sphere. In the previous section, we discussed that a generic $\\pi$ rotation can be calibrated using simple Rabi experiments. Naively, one might think that by adding a phase and amplitude scaling factor to this pulse, we can obtain all other single-qubit rotations. However, imperfections, such as detuning or small distortions in the control signal, can cause appreciable differences in the pulses required to implement rotations along different axes or by different angles. Thus, it is important to calibrate each single qubit gate in a systematic and comprehensive manner.\n\nA commonly used technique to gauge the quality of single qubit rotations in transmon qubits is the ALLXY experiment\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In this protocol, we perform pairs of single qubit gates chosen from different combinations of $\\pi$ and $\\pi/2$ rotations along the $x$ and $y$ axis on the qubit. The resulting states of the qubit should ideally form a `staircase pattern' where only $|g\\rangle$, $|e\\rangle$, or an exactly equal superpositon of the two are present. In practice, different types of imperfections will result in various deviations from this ideal configuration and exhibit qualitatively different syndromes. An example of the measurement outcomes for three types of errors are shown in Fig.\u00a0(Figure fig:allxy). A trained experimentalist can use these patterns to quickly diagnose distinct errors in the control pulse, including pulse amplitude, DRAG correction coefficients, detuning, and basic pulse distortions. A detailed discussion on the physics behind the ALLXY protocol can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nOnce the errors in each single qubit rotation are identified, we can implement a systematic procedure to correct and improve the fidelities of each operation. This generally consists of three-steps, starting with a fine calibration of the drive frequency, then making adjustments to the amplitude of the derivative component of the DRAG pulse, also known as the Motzoi parameter, and finally the fine-tuning the pulse amplitudes.\n\n< g r a p h i c s >\n\nExample of an ALLYX measurement. The outcome of a typical ALLXY experiment with 21 combinations of one or two single-qubit rotations around the $x$- and $y$-axes by an angle of $\\pi/2$ or $\\pi$ applied on a qubit before the measurement of its state, i.e. $\\{P_iP_j\\} \\subseteq \\{I, X(90), Y(90), X(180), Y(180)\\}$. The sequence is designed to highlight the different error syndromes of a single-qubit rotation, such as (a) detuning from resonance, (b) variations in drive amplitudes, and (c) variations in the coefficient of the DRAG correction.\n\nTo precisely calibrate the frequency of the qubit, we use the repeated Ramsey protocol. In typical Ramsey experiments, the frequency of the observed oscillation corresponds directly to the detuning of the qubit from the drive frequency. To prevent under sampling of the oscillation due to the Nyquist limit, the first Ramsey experiment should cover a short time span to get a coarse frequency estimate with a large bandwidth, while subsequent iterations can increase the time span to achieve more accurate frequency estimates at a lower bandwidth (for the same number of data points). Furthermore, we can also introduce an artificial detuning in the Ramsey experiment such that any small detuning is effectively extracted by comparing the fitted oscillation frequency with the artificial one. This method allows a more robust calibration of the qubit frequency than spectroscopy experiments, with its accuracy limited by the physical coherence property, $T_2$, of the qubit.\n\nNext, we calibrate the DRAG coefficient using the method detailed in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. This involves minimizing the difference in excited-state population produced by the $Y_\\pi X_{\\pi/2}$ and $X_\\pi Y_{\\pi/2}$ combinations. As shown in Fig.\u00a0(Figure fig:allxy)(a) and (c), errors in detuning and the DRAG coefficient have a similar signatures in the AllXY experiment. Thus, by first calibrating the frequency using Ramsey experiments, which are insensitive to the DRAG coefficient, these two error sources can be decoupled.\n\nFinally, we tune the drive amplitudes by applying an initial $\\pi/2$ pulse followed by $2N$ repeated $\\pi$ pulses. If the amplitude is calibrated correctly, the excited-state population should be independent of the number of $\\pi$ pulses. Effects of any deviation from the correct amplitude will be exaggerated by this sequence, which is sometimes referred to as a `pulse-train' experiment. Overall, this method provides a simple tool for us to extract and correct any fine amplitude deviations in the $\\pi$ pulse.\n\n### Readout optimization\nHaving tuned up the single qubit manipulations, we now are in the position to further optimize the readout configuration of the device. Conceptually, reading out the state of a qubit consists in entangling each one of its two states with certain states of the resonator that can be detected and distinguished at the macroscopic scale.\n\nIn cQED, the general procedure for reading out a qubit is to first entangle it with a coherent state of a readout resonator, from which the signal can quickly \u201cleak\u201d out into a coaxial cable. This signal is subsequently amplified and detected at room temperature using a heterodyne measurement technique. Such a process is typically referred to as a dispersive readout as the entanglement occurs as a result of the natural dispersive Hamiltonian.\n\nBefore going into the optimization techniques, we shall first address the question: what constitutes a good readout? In general, we care about two main properties: the measurement must be faithful and must not alter the state of the qubit. The former is quantified by the fidelity $\\mathcal{F}$, which gives the probability that we can correctly assign the qubit state based on the measurement outcome. The latter is called the quantum non-demolition-ness (QND-ness), denoted by $\\mathcal{Q}$, which gives the probability that a qubit state persists throughout the measurement process. This figure of merit is especially important when qubits are interrogated repeatedly, such as in most quantum error correction schemes.\n\nIn order to obtain both a high fidelity and QND-ness, we must carefully optimize the readout configurations. In this subsection, we will first summarize the physical process of the dispersive readout and then present the protocols to extract the key figures of merit. Finally, we will discuss some commonly used strategies for achieving an optimal readout performance.\n\n#### The mechanism of a dispersive readout\nRecall that in cQED the dispersive interaction Hamiltonian, $\\bH_{int} = -\\frac{\\chi}{2} \\ba^\\dag\\ba\\bsigma_z$, stems from a simple capacitive coupling between an anharmonic mode, i.e. the qubit, and the readout resonator. To obtain the information of the qubit state, we detect the response from the readout resonator one of the measurement circuits discussed in Sec.\u00a0<ref>.1. When the qubit state undergoes a transition, it shifts the resonance frequency of the resonator as a result of the dispersive coupling. This, in turn, leads to a measurable change in the response of the readout mode to the probe signal, regardless of the exact measurement circuit. When this frequency shift is larger than the linewidth of the resonator, the state of the qubit can be detected. Here, we will use the reflection set-up, as shown in Fig.\u00a0(Figure fig:dispersive_readout)(a), as an example to illustrate how the signal evolves during the readout process.\n\nLet us consider the response of a resonator driven by a constant readout pulse, whose field is denoted by $\\ba_{in}$. We model the evolution of field of the readout mode with the Langevin equation $\\partial_t{\\ba} = \\left(\\pm i\\frac{\\chi}{2} - \\frac{\\kappa}{2} \\right)\\ba - \\sqrt{\\kappa}\\bar{a}_{in}$. Again, we have performed the stiff-pump approximation on the incoming field as discussed in Sec.\u00a0<ref>.1. If the readout resonator is initially in the vacuum state, the solutions to the Langevin equation are coherent states with amplitudes given by:\n$$\n\n\\label{eq:dispersive_response}\n\\alpha_{g, e}(t) = \\frac{2\\sqrt{\\kappa}\\bar{a}_{in}}{\\pm i \\chi - \\kappa}\\left[\n1 - \\exp\\left(\\left(-\\frac{\\kappa}{2} \\pm \\frac{\\chi}{2}\\right)t\\right)\\right].\n\n$$\nIn Fig.\u00a0(Figure fig:dispersive_readout)(b), we represent the average time-dependent trajectory of the field in phase space according to Eq.\u00a0<ref>. This reveals two important aspects about the readout.\n\nFirst, Eq.\u00a0<ref> indicates that the response of the readout mode changes according to the state of the transmon, which allows the state-differentiation. As shown in Fig.\u00a0(Figure fig:dispersive_readout)(b), the imaginary parts of the two trajectories of the readout field are the same, but their real parts are opposite. The maximum separation depends directly on the amplitude of the incoming field. Thus, if the readout drive is sufficiently large, we can effectively infer the state of the qubit by simply measuring the real part of the outgoing field. Based on this, one might deduce that it would be optimal to maximize the power of a readout drive. However, in practice, a powerful drive triggers a significant level of qubit relaxation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. This phenomena is commonly referred to as the $T_1$ vs $\\bar{n}$ problem and its exact physical mechanism is still an ongoing topic of research.\n\nFurthermore, Eq.\u00a0<ref> also highlights that the resonator's response depends closely two coupling parameters, $\\chi$ and $\\kappa$. To illustrate how this qubit-dependent trajectory affects the response signal, we plot the real part of the averaged outgoing field $\\alpha_{out}$ as a function of time in Fig.\u00a0(Figure fig:dispersive_readout)(c). When the input field is turned on, it is first completely reflected off the resonator and the output field sharply rises to the value of the input field. Then, the field inside the cavity increases with a timescale $\\kappa/2$ and interferes constructively (resp.\u00a0destructively) with the input signal when the qubit is in $\\ket{e}$ (resp.\u00a0$\\ket{g}$). Finally, when the input drive is switched off, the output field is composed solely of the field leaking out of the readout cavity with a timescale $\\kappa/2$. Overall, the behavior of this field can be described by Fig.\u00a0(Figure fig:dispersive_readout)(d), where the separation of the two trajectories corresponding to the qubit in $\\ket{e}$ and $\\ket{g}$ increase at the rate of $\\kappa/2$ at the beginning of the readout process and then diminishes after the readout pulse as photons leak out of the resonator into the tranmission line. It has been shown the optimal choice of the these two parameters occurs at $\\chi=\\kappa$\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nReadout resonator trajectories for the dispersive readout (a) The phase response of the resonator in standard dispersive readout in the reflection configuration. (b) Average internal state of the readout cavity represented in phase-space. The arrows indicate how the state evolves in time. (c) Average reflected signal as a function of time. The light-gray area represents the time during which the input field is on. The trajectory corresponding to the qubit being in $\\ket{g}$ is a blue dashed line and the one corresponding to the qubit being in $\\ket{e}$ is a blue solid line. (d) Average distance between the reflected signal corresponding to the qubit being in $\\ket{g}$ and $\\ket{e}$. Similarly, the light-gray area represents when the input field is on.\n\nDuring the readout process, outgoing field from the resonator is entangled with the qubit. As a result, the qubit itself is not in a pure state: it is dephased as the field is measured. Essentially, as the outgoing field provides information about the state of the qubit, any superposition state is destroyed. The dephasing mechanism corresponds to the \u201cleakage\u201d of the readout field to the transmission line. This process can be modeled using the Lindblad superoperator\u00a0[Unknown Author, \"Unknown Title\", ] acting on the density matrix $\\rho$ as $\\frac{\\kappa}{2}\\mathcal{D}[\\ba]\\rho = \\frac{\\kappa}{2}\\left(2\\ba\\rho\\ba^\\dag - \\ba^\\dag\\ba\\rho - \\rho \\ba^\\dag\\ba\\right)$.\n\nIn our framework, the state of the system is always a superposition of the joint states $\\ket{\\alpha_g(t), g}$ and $\\ket{\\alpha_e(t), e}$. Thus, we can perform a unitary transformation to better describe the evolution of such states in a frame where the field of the readout cavity is given by\n$$\n\n\\ba \\xrightarrow{} \\ba + \\frac{\\alpha_g(t) + \\alpha_e(t)}{2} + \\frac{\\alpha_g(t) - \\alpha_e(t)}{2}\\bsigma_z.\n\n$$\nIn this frame, the system is first displaced to the center of mass of the two coherent states, followed by a state-dependent displacement $\\pm \\frac{\\alpha_g(t) - \\alpha_e(t)}{2}$. With this unitary transformation, the Lindblad superoperator becomes\n$$\n\\label{eq:ro_dephase}\n\\frac{\\kappa}{2}\\mathcal{D}[\\ba]\\rho \\xrightarrow{} \\frac{\\kappa}{2}\\left(\\mathcal{D}[\\ba]\\rho + \\frac{1}{4}\\abs{\\alpha_g(t) - \\alpha_e(t)}^2\\mathcal{D}[\\bsigma_z]\\rho + ... \\right),\n\n$$\nwhere the remaining terms are either unitary or neglected under the RWA.\n\nWe identify that second term in Eq.\u00a0<ref> causes dephasing of the qubit state due to photons leaving the resonator. The rate at which this takes place is given by $\\frac{\\Gamma_\\varphi}{4}\\mathcal{D}[\\bsigma_z]\\rho$, where $\\Gamma_\\varphi$ is referred to as the measurement-induced dephasing rate and its time-dependence is given by\n$$\n\\label{eq:dephase_rate}\n\\Gamma_\\varphi(t) = \\frac{\\kappa}{2}\\abs{\\alpha_g(t) - \\alpha_e(t)}^2.\n\n$$\nThis depends on both the decay rate ($\\kappa$) of the resonator and the specific shape of the readout pulse. In a perfect world, due to conservation of quantum information, $\\Gamma_\\varphi(t)$ should be equal to the rate at which the experimentalist acquires information from the readout.\n\n#### Extracting figures of merit\nIn order to characterize the performance of a readout configuration, let us first consider how the state-dependent continuous outgoing signal is treated to obtain a binary result that reveals the qubit state. As mentioned previously, a heterodyne detection scheme is used to sample the outgoing signal. While the average of this signal resembles Fig.\u00a0(Figure fig:dispersive_readout)(c), for a single readout instance (or \u201cshot\u201d), each sample has a finite amount of noise due to both the quantum fluctuations of coherent states and the added noise of the electronic components between the readout resonator and the acquisition card. This noisy signal is then integrated over time to give an outcome with a single value. The accumulation of such single-shot measurements will form a Gaussian distribution whose average depends on the initial state of the qubit\u00a0[Unknown Author, \"Unknown Title\", ]. If the readout is good enough, the separation between the averages of these two distributions (\u201csignal\u201d) is larger than their width (\u201cnoise\u201d). A good readout must have a signal-to-noise ratio (SNR) much larger than 1. Finally, the outcome of each measurement is digitized by setting a threshold between the two distributions.\n\nTo quantify the fidelity ($\\mathcal{F}$) and QND-ness ($\\mathcal{Q}$) of a readout, let us consider the effect of the measurement on two initial states $\\ket{0}_i$ and $\\ket{1}_i$. The preparation of these initial states must be as accurate as possible so that it does not limit the characterization procedure. This can be achieved by using a first measurement with a stringent threshold combined with post-selection and/or a feedback pulse, as depicted in Fig.\u00a0(Figure fig:buttrefly_exp)(a).\n\nAn ideal measurement would yield an outcome $m=0$ (resp. $m=1$) when the initial state is $\\ket{0}_i$ (resp. $\\ket{1}_i$) and would leave the qubit in a state $\\ket{0}_o$ (resp. $\\ket{1}_o$). The fidelity and the QND-ness of a realistic measurement are defined as\n$$\n\n\\mathcal{F} &= 1 - \\left(\\condProb{m=0|\\ket{1}_i} + \\condProb{m=1|\\ket{0}_i}\\right)/2 \\\\\n\\mathcal{Q} &= 1 - \\left(\\condProb{\\ket{0}_o|\\ket{1}_i} + \\condProb{\\ket{1}_o|\\ket{0}_i}\\right)/2,\\label{eq:qnd}\n\n$$\nwhere $\\text{P}$ is the Bayesian conditional probability.\n\n< g r a p h i c s >\n\nThe butterfly measurement scheme for readout charaterization.\n(a) Circuit diagram for the butterfly experiment to characterize measurement $M_1$ on qubit $q_i$. Post-selection based on an initial measurement $M_0$ is used to initialize $\\ket{0}$. (b) Correlations between $m_1$ and $\\ket{\\psi}_{\\mathrm{i}}$ are described by $\\Lambda_M$\n\nThese figures of merit can both be deduced from the measurement butterfly experiment represented on Fig.\u00a0(Figure fig:buttrefly_exp)(b). After preparing an initial state $\\ket{0}_i$ or $\\ket{1}_i$, two consecutive measurements $M_1$ and $M_2$ are performed. The mapping between a given initial state $\\ket{\\psi}_i$ to an outcome $m$ is characterized by the matrix $\\Lambda_M$, with\n$$\n\n\\Lambda_M =\n\\begin{bmatrix}\n\\condProb{m=0 | \\ket{0}_i}\n& \\condProb{m=0 | \\ket{1}_i} \\\\ \\\\\n\\condProb{m=1 | \\ket{0}_i}\n& \\condProb{m=1 | \\ket{1}_i}\n\\end{bmatrix}\n.\n\n$$\nWe can then write the outcome probabilities of the first measurement as a column vector: $\\text{P}(m_1) = \\Lambda_M \\text{P}(\\ket{\\psi}_i)$. Each element of $\\Lambda_M$ can be measured and the fidelity $\\mathcal{F}$ is simply calculated from the off-diagonal elements.\n\nBased on this, let us now evaluate the conditional probabilities required to determine the QND-ness of the readout. Using the same $\\Lambda_M$ to describe both $M_1$ and $M_2$, we can write\n$$\n\n\\text{P}(\\ket{\\phi}_{\\mathrm{o}}) = \\Lambda_M^{-1}\\text{ P}(m_2),\n\n$$\nwhich leads to\n$$\n\n\\begin{bmatrix}\n\\condProb{\\ket{0}_{\\mathrm{o}}, m_1 | \\ket{\\psi}_i}\\\\ \\\\\n\\condProb{\\ket{1}_{\\mathrm{o}}, m_1 | \\ket{\\psi}_i}\n\\end{bmatrix} =\n\\Lambda_M^{-1} \\begin{bmatrix}\n\\condProb{m_2=0, m_1 | \\ket{\\psi}_i}\\\\ \\\\\n\\condProb{m_2=1, m_1 | \\ket{\\psi}_i}\n\\end{bmatrix},\n\n$$\nand\n$$\n\n&\\condProb{\\ket{0}_o| \\ket{1}_i} \\nonumber\\\\\n&= \\condProb{\\ket{0}_o,m_1=0 | \\ket{1}_i}+\\condProb{\\ket{0}_o,m_1=1 | \\ket{1}_i},\\\\\n&\\condProb{\\ket{1}_o| \\ket{0}_i} \\nonumber\\\\\n&= \\condProb{\\ket{1}_o, m_1=0| \\ket{0}_i}+\\condProb{\\ket{1}_o,m_1=1| \\ket{0}_i}.\n\n$$\nWith this, we can now deduce the $\\mathcal{Q}$ of the readout (Eq.\u00a0<ref>) from these conditional probabilities.\n\nOverall, this protocol offers a simple tool for us to obtain two crucial figures of merit for the readout. With this information, we can then further optimize the readout configurations to perform high-fidelity measurements of the transmon state.\n\n#### Optimization considerations\nIn general, achieving an optimal readout requires us to carefully balance two contradicting effects. On the one hand, measuring for a longer duration and having the largest probe signal available should lead to a better SNR and thus, to a higher fidelity. On the other hand, this would also result in having more state transitions because of the natural relaxation time of the qubit, as well as induced state transitions due to a strong drive\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. These transitions during the readout process result in a reduction of both the fidelity and the QND-ness.\n\nTo put the optimization considerations more concretely, let us consider the simple example of a square readout pulse. Naively, we just need to progressively adjust the duration and amplitude of the pulse such that the measurement is faster than the effective (both natural and induced) relaxation time scales of the qubit. This should lead to the optimal readout fidelity and QND-ness. However, more advanced pulse shaping techniques is often necessary to tune up a high-quality readout beyond this compromise.\n\nLet us recall that at the beginning and at the end of the measurement, the separation between the trajectories corresponding to the two qubit states is small, while the noise is constant\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] due to the internal dynamics of the readout resonator. Hence, it is favorable to reduce the timescale of the initial rise and final fall of the field beyond $1/\\kappa$ by modifying the the readout pulse shape. For example, the initial rise can be accelerated if we use a short but large pulse\u00a0[Unknown Author, \"Unknown Title\", ]. Similarly, the final decay of the field can be sped up by using a fast-emptying sequence inspired by dynamical decoupling schemes\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nFurthermore, we can also acquire information more effectively by discarding certain parts of the signal. For instance, the duration over which the average trajectories corresponding to the two qubit states are similar offers very little useful information. Therefore, we can apply an envelope to take into account which parts of the signal are the most valuable, i.e. contains the most information about the qubit state. It has been shown that the optimal envelope is given by the difference between the average signals corresponding to the two qubit states\u00a0[Unknown Author, \"Unknown Title\", ], as shown on Fig.\u00a0(Figure fig:dispersive_readout)(d).\n\nWith this optimized integration weight applied to the signal, the theoretical SNR is given by\n$$\n\n\\text{SNR}(\\tau) = \\sqrt{2\\scaleint{5ex}_{\\bs 0}^\\tau\n|\\alpha_{out, g}(t) - \\alpha_{out,e}(t)|^2~dt},\n\n$$\nwhere $\\alpha_{out, i}$ is the average outgoing field that has been acquired when the qubit is prepared in state $\\ket{i}$. If the field leaking from the readout resonator is not corrupted on its way to the acquisition apparatus, then $\\alpha_{out, i}$ can be obtained with the input-output relation of Eq.\u00a0<ref>. In this case, we get $\\text{SNR}_{\\text{ideal}}^2(\\tau) = 4 \\gamma_\\varphi(\\tau)$, where we define the total dephasing as $\\gamma_\\varphi = \\scaleint{5ex}_0^{\\tau}\\Gamma_{\\varphi}(t)~dt$. This quantity can be directly measured using a Ramsey sequence where two $\\pi/2$ pulses are separated by a measurement pulse. This relation indicates that the maximum information acquired, given by the SNR, is equal to the amount of qubit information destroyed, given by the total dephasing $\\gamma_\\varphi$ (up to a numerical factor).\n\nFor a realistic measurement setup, however, we must take into account of degradation of the signal, either due to loss or added noise as it travels to the acquisition system at room temperature. The resulting SNR will therefore be lower compared to its theoretical maximum. This non-ideality is quantified by the efficiency $\\eta$ given by\n$$\n\n\\eta = \\frac{\\text{SNR}^2(\\tau)}{4\\gamma_\\varphi(\\tau)}.\n\n$$\nThe value of $\\eta$ goes between 0, when no information reaches the observer and the qubit is entirely dephased, and 1, when as much information reaches the observer as it is destroyed during measurement. Typically, achieving a high efficiency requires us to minimize the signal loss between the readout resonator and the quantum-limited amplifier. In the case of a phase-preserving quantum-limited amplifier, the maximum efficiency, as defined in our framework, would be 0.5. However, in many published literature, this has often been re-scaled to allow more direct comparison across different experimental set-ups. Furthermore, the gain of this amplifier should also be adjusted such that noise added by the cryogenic HEMT amplifier does not significantly corrupt the signal (see Fig.\u00a0(Figure fig:example_device)).\n\nSeveral protocols exist to experimentall characterize $\\eta$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. They provide a useful way to probe the overall quality of the measurement set-up and ensure that it does not limit the performance of the readout. Currently, new readout techniques and high-performing quantum-limited parametric amplifiers have enabled us to reliably achieve efficiencies between 0.1 and 0.6\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n### Engineering two-qubit gates\nApart from characterizating and performing operations on physical qubits individually, another key ingredient for a useful quantum system is the ability to implement robust two-qubit operations. Broadly speaking, there are three classes of two-qubit gates for superconducting qubits, namely, fast flux pulsing, microwave driven, and flux modulated. While all of them have demonstrated gate fidelities of $\\geq 99\\,\\%$, their requirements for coupling mechanisms between individual elements in the quantum hardware often differ significantly. Here, we will provide an overview of the main techniques for realizing two-qubit operations in current superconducting quantum devices and highlight some of the key technical pros and cons in each of them.\n\nIn essence, two-qubit gates enacted via fast flux pulsing[Here, two-qubit gates employing flux-controlled tunable couplers are considered as a special case of flux pulsing based two-qubit gates.] are performed by tuning certain transitions close to resonance\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Their typical gate times are $<50$ ns, limited by the effective coupling strength between the transmons. However, the fast gate time afforded by rapidly applying a flux pulse to shift a qubit's frequency into the required resonance conditions often results in detuning from the flux sweetspot. Consequently, this lowers the actual gate fidelity as compared to the naive estimate based only on the gate time over coherence time considerations. Furthermore, this type of operations also require precise pulse shaping in order to to achieve their optimal performance, making them potentially sensitive to the small distortions induced by the various electrical components used for microwave signal processing.\n\nAlternatively, we can also use fixed frequency qubits to implement universal control with only microwave drives\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The most well-known example of all-microwave two-qubit operations is the cross-resonance gate\u00a0[Unknown Author, \"Unknown Title\", ], which is performed by driving one qubit at the frequency of another. While they can be significantly slower ($\\sim\\,150-500\\,$ns) than flux-based gates, they eliminate the need for fast flux control in the hardware. As a result, the microwave-only operations typically lower the complexity in the fabrication and control aspects of the device. Furthermore, the absence of fast-flux on the device also removes some known noise channels, offering the potential for better intrinsic coherence properties.\n\nHowever, by removing the ability to tune the resonance frequencies of each qubit on demand, microwave-based gates encounter the challenge of frequency-crowding and undesired transitions. In particular, frequency crowding\u00a0[Unknown Author, \"Unknown Title\", ] becomes increasingly problematic when fixed-frequency transmons are coupled to multiple neighbors\u00a0[Unknown Author, \"Unknown Title\", ] as is often necessary for devices that aim to employ the surface code for error correction.\n\nA third approach is to use parametric flux modulation to perform two-qubit gates. In this method, we can directly modulate either the frequency of the individual qubits or that of a coupling element in order to induce a specific interaction between two qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. This type of two-qubit gates can be seen as a hybrid between the flux pulsing and all-microwave gates. Some of the frequency crowding issues of the all-microwave gates are alleviated as the coupling terms are only activated when the drive is present. Furthermore, the parametrically driven gates are less susceptible to distortions than flux pulsing ones because the drives operate at a much lower frequency. Consequently, they are significantly slower compared to flux pulsing while still require additional flux-biasing elements, which negates the main advantages of an all-microwave architecture.\n\nAll of these techniques have demonstrated promising performance in the context of isolated pair-wise interactions. However, as we incorporate more physical qubits on the quantum device, frequency crowding or collisions can become a major source of imperfection for these two-qubit gates. To illustrate this, let us consider a standard control-Z (CZ) operation implemented using the fast flux pulsing technique. This is typically realized by employing the the avoided crossing between the $\\ket{11}$ and the $\\ket{02}$ state of a pair of coupled transmon qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Now, when we introduce one additional neighbouring qubit to the pair, in a configuration depicted in Fig.\u00a0(Figure fig:freq_collisions)(a), it is no longer feasible to naively perform two pair-wise CZ gates. In fact, qubit $D$ cannot be tuned to independently interact with either $Z$ or $X$ without causing spurious interactions with the other. Therefore, although $X$ is simply a spectator qubit during a CZ operation between $D$ and $Z$, a flux drive must be applied to $X$ concurrently to introduce a sufficiently large detuning so as to minimize undesired interaction (Fig.\u00a0(Figure fig:freq_collisions)(b)). Keeping track of and avoiding such frequency collisions can quickly become an intractable task as more qubits are coupled together and more frequencies are involved in large quantum devices.\n\n< g r a p h i c s >\n\nTwo-qubit gates in a multi-qubit device. (a) A high frequency qubit, $D$, is coupled to two low-frequency qubits, $Z$ and $X$. A CZ operation is to be implemented first between $D$ and $Z$ (step 1), followed by $D$ and $X$ (step 2). (b) To perform a CZ gate between $D$ and $Z$, $D$ detunes from $f_D$ to the interaction frequency $f^{\\mathrm{int}}$ while $X$ must be moved to a parking frequency $f_X^{\\mathrm{park}}$ to avoid an unwanted interaction. Similarly, in step 2, a CZ gate between $D$ and $X$ is performed with $Z$ detuned from its original frequency over the operation.\n\nThus, careful considerations must be put in place when designing the frequency components of all the physical elements on a multi-qubit device. For instance, Ref.\u00a0[Unknown Author, \"Unknown Title\", ] proposed a scheme to alleviate this challenge by constructing bigger devices with 8-qubit unit cells, each containing only three sets of qubit frequencies. A unique detuning pattern for each qubit in the unit cell, known as the flux dance, allows for a pipelined execution of all parity checks while avoiding all undesired interactions. These 8-qubit unit cells can be incorporated in the design of more complex quantum processors for executing surface code. Alternatively, other strategies such as employing tunable couplers\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] can also be adopted to address the challenge of undesired cross-talk on multi-qubit chips.\n\n### Characterization of qubit operations\nAnother key class of experiments we must perform to fully understand our quantum processor is the characterization of various single and two-qubit gates. In general, the quality of gates depends on the coherence of the qubits, as well as the accuracy and precision of the pulses used to realize these gates. Here, we will introduce several useful frameworks and experimental techniques for gate characterization.\n\nMathematically, the effect of a gate can be expressed as a Completely-Positive\nTrace-Preserving (CPTP) map ($\\Lambda$) that acts on a density matrix ($\\rho$)\u00a0[Unknown Author, \"Unknown Title\", ]. The Pauli transfer matrix (PTM) provides a convenient representation of $\\Lambda$ that relates the input and output states of a quantum operation\u00a0[Unknown Author, \"Unknown Title\", ]. The PTM can be written as\n$$\n\n\\label{eq:PTM}\n\\left(R_\\Lambda\\right)_{ij}= \\frac{1}{d}\\mathrm{Tr}\\left\\{ P_i \\Lambda (P_j)\\right\\},\n\n$$\nwhere $\\{P_i, P_j\\}\\in \\mathcal P^{\\otimes n}$ are elements of the $n$-qubit Pauli set with $\\mathcal P = \\{ I, X, Y, Z\\}$ and $d$ is the dimension of the Hilbert space. Using the superoperator formalism\u00a0[Unknown Author, \"Unknown Title\", ], a density matrix $\\rho$ can be expressed as a vector in the Pauli basis $\\ket{\\rho}\\rangle$ with components $\\frac{1}{\\sqrt{d}}\\mathrm{Tr}\\{ P_k \\rho \\}$\u00a0[Unknown Author, \"Unknown Title\", ]. Applying the map amounts to a simple multiplication\n$$\n\n\\ket{\\Lambda (\\rho)} \\rangle = R_\\Lambda \\ket{\\rho}\\rangle,\\\\\nR_{\\Lambda_2 \\cdot \\Lambda_1} =R_{\\Lambda_2} R_{\\Lambda_1} .\n\n$$\n\nThe main goal of characterizing quantum operations is to capture the imperfections in them. These imperfections can arise from both coherent and incoherent errors. Coherent errors, such as an over-rotation or leakage out of computational basis, are typically related to control non-idealities. They can potentially be addressed by improving the microwave pulses through more thorough calibrations as well as numerical optimal control protocols\u00a0[Unknown Author, \"Unknown Title\", ]. Incoherent errors, on the other hand, are caused by decoherence effects in the quantum system. For transmon-based systems, the dominant decoherence effects are energy relaxation and dephasing.\nFor a single transmon qubit, the PTM for energy relaxation is given by\n$$\n\nR_{T_1} =\n\\begin{pmatrix}\n1 & 0& 0&0 \\\\\n0 & \\sqrt{1-p} & 0&0 \\\\\n0 & 0& \\sqrt{1-p} &0 \\\\\np & 0& 0 & 1-p \\\\\n\\end{pmatrix}\n\n$$\nwith $p=1-e^{-t/T_1}$ being the probability of relaxation. Similarly, the single qubit PTM of pure dephasing is given by\n$$\n\nR_{T_\\phi} =\n\\begin{pmatrix}\n1 & 0& 0&0 \\\\\n0 & 1-p & 0&0 \\\\\n0 & 0& 1-p &0 \\\\\n0 & 0& 0&1 \\\\\n\\end{pmatrix}\n\n$$\nwhere $p=1-e^{-t/T_\\phi}$ is the probability of dephasing.\n\nUsing the PTM formalism, we can extract several metrics that are often used to quantify gate performance. For instance, the average process fidelity, which expresses the distance of a gate to the target operation, can be obtained by\n$$\n\nF_{\\mathrm{avg}}({\\Lambda_{\\mathrm{targ}}}, {\\Lambda}) = \\frac{\\mathrm{Tr}\\left( R_{\\Lambda_{\\mathrm{targ}}}^{-1} R_{\\Lambda}\\right) +d}{d(d+1)}.\n\n$$\nIn other words, the average error $\\err$ associated with an operation can be expressed as $\\err = 1-F_{\\mathrm{avg}}$. Other metrics, such as the diamond norm\u00a0[Unknown Author, \"Unknown Title\", ] and unitarity\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], can also be used to quantify the performance of the quantum operations, especially in the presence of coherent errors.\n\nIn practice, PTMs are usually extracted experimentally by performing process tomography\u00a0[Unknown Author, \"Unknown Title\", ]. However, this technique does not provide any means to distinguish the non-idealities due to state preparation and measurement (SPAM) from errors in the operation that we aim to characterize.\n\nTo address this problem, the gate-set tomography (GST) framework\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] was developed. In principle, GST provides an accurate and robust characterization of all operations in a gate set, including state preparation and measurement. However, it can be rather demanding to implement and requires a more significant number of experiments.\n\nAlternatively, randomized benchmarking (RB)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] can be used to condense all the imperfections into a single error metric, $\\err$. In Clifford-based randomized benchmarking, a series of random gates is sampled from the Clifford group. A final gate is then added that inverts the action of all preceding gates. By changing the number of Cliffords and averaging over many randomizations, we obtain an exponentially decaying curve, whose decay constant is related to $\\err$ while the offset and amplitude are related to SPAM errors. If the error rates of different Cliffords are known to differ significantly, such as when characterizing two-qubit gates, one can use interleaved randomized benchmarking\u00a0[Unknown Author, \"Unknown Title\", ]. However, this must be performed with ample precautions as certain coherent errors can accumulate and result in a bogus fidelity\u00a0[Unknown Author, \"Unknown Title\", ]. Other variants of RB have also been developed to probe different types of gates and errors\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn general, when characterizing quantum operations, we are often faced with a difficult trade-off between information gain verses time/resource consumption. For instance, full process tomography or GST offers the complete information about our system but can be extremely time-consuming to implement. This increases the susceptibility to parameter drifts and environmental instabilities, which in turn, degrades the quality of our characterization. On the other hand, RB can be highly time-effective, but it only provides limited information on the gate performance without providing details on the underlying mechanisms.\n\nAside from the practical limitations of current characterization techniques, a more fundamental problem for the above-mentioned protocols is that they are based on the assumptions that all processes are Markovian\u00a0[Unknown Author, \"Unknown Title\", ] and that the qubits are two-level systems. Unfortunately, these assumptions are violated in most realistic cQED devices. In transmon qubits, in particular, leakage out of the computational subspace and non-Markovian errors such as gate-bleedthrough, have significant impacts on the quality and repeatability of quantum operations. A few examples of errors that are not accounted for in most of the current gate characterization schemes are illustrated in Fig.\u00a0(Figure fig:other_errors).\n\n< g r a p h i c s >\n\nExamples of errors in cQED devices that violate the typical assumptions in characterization protocols. (a) Microwave control pulses can drive transitions to the second excited state. (b) Performing a measurement can induce transitions to a non-computational state. (c) Low-frequency noise on control parameters or coherence can cause fluctuations in error rates. (d) Operations can be history dependent due to e.g., pulse-distortions acting on timescales longer than the pulse duration.\n\nTo address these limitations, modifications have been made to existing protocols to extend their capabilities. For example, enhancements of the RB scheme such as interleaved randomized benchmarking (IRB)\u00a0[Unknown Author, \"Unknown Title\", ], character benchmarking\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and speckle purity benchmarking\u00a0[Unknown Author, \"Unknown Title\", ] have been developed to measure gate-specific error rates. Furthermore, simultaneous randomized benchmarking (SRB)\u00a0[Unknown Author, \"Unknown Title\", ] has been proposed to measure cross-talk, and more specialized tactics that address the leakage problem\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] have also been investigated. Similar modifications exist for GST that allow characterization of drift\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or idle crosstalk\u00a0[Unknown Author, \"Unknown Title\", ]. A good open-source library containing a wide range of characterization protocols is pyGSTi\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], which is maintained by Sandia National Laboratories. A commercial alternative is provided by Quantum Benchmark, a Canadian startup company. However, understanding the subtle differences between the various assumptions made in these protocols and implementing them in the appropriate system requires in-depth knowledge of the hardware.\n\nWe should also keep in mind that although these protocols have a firm theoretical basis, there are often hidden assumptions that can limit their practical applicability in realistic cQED devices. As an example, consider the leakage protocol of Wood and Gambetta\u00a0[Unknown Author, \"Unknown Title\", ], which works without the need to directly measure leakage. The population out of the computational subspace can be estimated using the fact that probabilities must sum to 1. However, in most cQED experiments, this property is already invoked implicitly in the readout process where a state is assigned $\\ket{0}$ if the measured signal is below some threshold with probability $p$, and otherwise assigned to be $\\ket{1}$, with probability $1-p$. This makes it incompatible with the convenient leakage treatment technique given in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. While it can be relatively straightforward to introduce a modification to enhance this protocol\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], it is often system-specific and not readily generalizable to other devices.\n\nIn order to give a meaningful interpretation to characterization results, it is often desirable to express them in terms of a parameter that has physical significance and units such as $T_1~(\\mathrm{s})$ or an effective coupling strength $J~(\\mathrm{Hz})$. Although these parameters can in principle be extracted from GST results, the experiments tend to be very costly in terms of acquisition time and analysis to get sufficiently accurate results.\n\nA useful technique to tackle this characterization challenge is to adopt a more operational approach. We can often make system-specific assumptions and simplifications based on physical reasoning to devise more efficient experiments tailored to characterize certain effects. To do so, we start by constructing a model that describes how the system, including the effect of interest, behaves. These models usually contain certain physically-motivated assumptions which are supported by the literature or verified in other independent control experiments. Next, we design a set of simple experiments which are particularly sensitive to the effect of interest. Finally, the experiment is compared to the model and based on the level of consistency between them, we either reject, accept, or iteratively improve the original model based on the measurement outcomes.\n\nOver the years, many such models have been constructed and tested. In particular, a lot of techniques have been devised to independently measure specific sources of cross-talk between qubits and implement the necessary corrections. As an example, let us consider the cross-talk caused by the residual coupling between two flux-tunable transmon qubits connected by a bus resonator.\n\nThe coupling between two nearest-neighbor qubits $q_i$ and $q_j$ is often employed to implement a controlled-phase gate. During idle times, the qubits are ideally far detuned such that there are no spurious interactions between them. However, in practice, a residual always-on Hamiltonian of the form $H=\\zeta_{ij} \\ket{11} \\bra{11}$ is typically present, causing unwanted evolution of the qubit states even during the idle times.\n\nSince the interaction is constant, the single-qubit terms can be taken as a renormalization of the qubit frequency (Fig.\u00a0(Figure fig:residual_ZZ)(a,b)). The resulting state-dependent frequency shift $\\zeta_{ij}=\\hbar\\omega_{11} - \\hbar\\omega_{01}-\\hbar\\omega_{10}$ is approximated as\n$$\n\n\\label{eq:residual_ZZ_approx}\n\\zeta_{ij} = - J_2^2 \\left(\\frac{1}{\\hbar\\omega_{20}-\\hbar\\omega_{11}}+\\frac{1}{\\hbar\\omega_{02}-\\hbar\\omega_{11}}\\right),\n\n$$\nwhere the subscripts in $\\omega_{kl}$ are used to label the states based on the number of excitations in qubits $i$ and $j$ and $J_2 \\approx \\sqrt{2} J_1$ is the effective coupling between them.\n\nThe residual idle Hamiltonian is then modelled as an additional ZZ-coupling in the system, given by\n$$\n\nH=\\zeta_{ij} \\ket{11} \\bra{11}=-\\frac{\\zeta_{ij}}{2}\\left(1-Z_i-Z_j+Z_iZ_j\\right).\n\n$$\nFollowing this definition\n$$\n\n\\zeta_{ij} = E_{11} - E_{01} - E_{10}\n\n$$\nwhere $E_{kl}$ corresponds to the energy of the state with $k$ $(l)$ excitations on qubit $i$ ($j$). This results in coherent correlated $ZZ$ errors with angle\n$$\n\n\\theta=\\frac{\\zeta_{ij}\\tau_I}{4},\n\n$$\nwhere $\\tau_I$ is the total interaction time.\n\nIn other words, such an always-on ZZ coupling induces a frequency shift on $q_i$ that is correlated with the state of its neighbor, $q_j$. The strength of this coupling corresponds to the difference in frequency $\\Delta \\omega_i^{(j)}$ of Ramsey oscillations of $q_i$ with $q_j$ in states $\\ket{1}$ and $\\ket{0}$.\n$$\n\n\\Delta \\omega_i^{(j)} &= \\left(E_{11} - E_{01}\\right) - \\left(E_{10} - E_{00}\\right),\\\\\n\\Delta \\omega_i^{(j)} &= \\left(\\zeta_{ij} + E_{10}+ E_{01}- E_{01}\\right) - \\left(E_{10}\\right),\\\\\n\\Delta \\omega_i^{(j)} &= \\zeta_{ij}.\n\n$$\nWe can accurately measure this frequency difference through the residual-ZZ-echo experiment as described in Fig.\u00a0(Figure fig:residual_ZZ)(c). In this protocol, an echo experiment over a time $\\tau$ is performed on $q_i$ while an excitation is added and subsequently removed from $q_j$. In the first arm of the echo experiment, $q_i$ will acquire a phase $\\varphi_A =(\\omega_i + \\zeta_{ij})\\cdot \\tau/2$ which is partially canceled by the phase acquired in the second arm $\\varphi_B=(-\\omega_i)\\cdot \\tau/2$. This results in oscillations with frequency $\\zeta_{ij}/2$ in the measured signal of $q_i$:\n$$\n\n\\label{eq:res_zz_echo_phases}\n\\varphi =& \\varphi_A + \\varphi_B,\\\\\n\\varphi =& (\\omega_i + \\zeta_{ij})\\cdot \\tau/2 + (-\\omega_i)\\cdot \\tau/2,\\\\\n\\varphi =& (\\omega_i + \\zeta_{ij} - \\omega_i) \\cdot \\tau/2,\\\\\n\\varphi =& (\\zeta_{ij}/2) \\cdot \\tau.\n\n$$\n\n< g r a p h i c s >\n\nResidual ZZ interactions in multi-qubit devices. (a) Two neighboring qubits $q_i$ and $q_j$ are coupled through a coupling resonator. (b) At their idle frequencies, both qubit frequencies are slightly dependent on the state of the other qubit with strength $\\zeta$. (c) The protocol developed to probe the strength of the always-on ZZ-coupling between two qubits.\n\nCompared to using two consecutive Ramsey measurements, this particular technique ensures that the experiment is robust against slow fluctuations in qubit frequency. Furthermore, from a practical perspective, all data is acquired in a single experiment and the desired information can be extracted directly from the outcomes, with only a small number of fit parameters.\n\nIt is beyond the scope of this work to give an exhaustive overview of all of these techniques, many of which date back to the days of NMR\u00a0[Unknown Author, \"Unknown Title\", ]. A more extensive overview of error sources affecting transmon systems as well as the proposed methods to characterize them can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Cavity Characterization\n< g r a p h i c s >\n\nStandard procedures for characterizing a high-Q cavity mode. (a)A typical cavity characterization process presented as a dependency graph. (b) The gate sequence and outcome of a number-splitting experiment where the transmon\u2019s frequency is shifted when a coherent state is initialized in the cavity. Separation between the peaks corresponds to $\\chi$. (c) Energy relaxation time scale of the cavity obtained by initializing it in a large coherent state, followed by a flip of the transmon state conditioned on the cavity in vacuum after a variable delay. (d) The typical cQED hardware for operating a bosonic qubit is composed of a high-Q superconducting cavity (e.g.\u00a0a 3D coaxial $\\lambda/4$ resonator, orange) for storing the logical qubit, a transmon ancilla (green) for universal control, and a low-Q resonator (e.g.\u00a0a $\\lambda/2$ stripline resonator, blue) for readout (RO). Universal control of the cavity state can be performed via a transmon ancilla (green) and read out via a planar resonator (purple). (e) A QEC protocol realized by mapping the parity of the logical qubit onto the state of the transmon, followed by the appropriate correction unitary. The logical state is initialized using numerical optimal control pulses\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn addition to qubits and readout resonators, high-Q superconducting cavities are also frequently featured in cQED devices. Endowed with both low intrinsic decoherence rates and large Hilbert space for compact information storage, these cavities can play the role of a coherent quantum memory in cQED systems. In recent years, they have also been frequently employed for encoding logical qubits. More detailed discussions about the developments on this front are presented in Sec.\u00a0<ref>.2.\n\nHere, let us focus on the techniques for characterizing both the Hamiltonian and coherence properties of such high-Q superconducting cavities, as well as the tomography of the quantum states stored in them. The typical workflow for the characterization of the cavity is described in Fig.\u00a0(Figure fig:cav_tuneup)a.\n\nA typical 3D cQED unit consisting of a storage cavity, a readout cavity, and a transmon qubit dispersively coupled to the storage\u00a0[Unknown Author, \"Unknown Title\", ] is depicted in Fig.\u00a0(Figure fig:cav_tuneup)(d). The transmon affords universal control of the storage cavity, allowing effective characterization the cavity by mapping the property of interest onto a particular transmon state. The transmon state is subsequently extracted via the readout resonator as described in the standard dispersive readout configuration\u00a0<ref>.3.\n\nIn order to map the property of the cavity on the transmon state, conditional operations between the two elements are required. In particular, there are two crucial conditional operations in cQED deivces, both arise from the natural dispersive interaction between the transmon and cavity.\n\nThe first operation is a rotation on the transmon conditioned on a specific photon number in the cavity, $R_{\\theta}^{n}$, also commonly referred to as a photon number selective rotation. Here, $R$ is a rotation along either the $x$ or $y$ axis of the transmon Bloch sphere, $\\theta$ is the angle of the rotation, and $n$ refers to the photon number in the cavity. Under the dispersive interaction, the transmon frequency is naturally dependent on $n$. Hence, this conditional rotation is simply realized by using long, spectrally-selective drives with duration $\\tau>1/\\chi$ such that the transmon state is only affected when the cavity contains the correct photon number state.\n\nThe second conditional operation is a cavity-transmon conditional phase gate:\n$$\n\n\\mathbf{C}_\\Phi = \\mathcal{I} \\otimes \\ket{g}\\bra{g} + e^{i\\Phi\\mathbf{a}^\\dagger\\mathbf{a}}\\otimes\\ket{e}\\bra{e}\n\n$$\nThis C-Phase gate arises naturally during an idle time $t$, with $\\Phi=\\chi t$.\n\nEquipped with these two useful conditional operations between the cavity and the transmon ancilla, we now proceed to characterize the storage cavity. Similar to that for a transmon qubit, we start the characterization process of a high-Q cavity with a spectroscopy experiment that allows the extraction of its resonance frequency. In this case, a strong drive with variable frequencies is first applied on the cavity, followed by the $X_{\\pi}^{0}$ gate on the transmon ancilla. When the drive frequency on the cavity matches that of its resonance, the cavity is displaced far from the vacuum state. As a result, the transmon state will be unaffected by the selective $\\pi$ pulse. Hence, by measuring the resulting state of the transmon, we can extract the resonance frequency of the cavity.\n\nNext, we proceed to characterise the exact dispersive coupling strength, $\\chi$, via the number-splitting experiment\u00a0[Unknown Author, \"Unknown Title\", ]. The typical measurement procedure and outcome is shown in Fig.\u00a0(Figure fig:cav_tuneup)b, where the transmon spectrum is probed after a large displacement on the cavity. The resulting frequency separations, which correspond to different photon number states in the cavity, indicate the value of $\\chi$.\n\nAnother useful technique to extract the value of $\\chi$ is a Ramsey-type measurement, commonly referred to as Ramsey revival. This experiment uses the coherent transmon precession, which depends on the cavity state, to probe the interaction strength between the two elements. It starts with an initial state $\\ket{\\psi(0)} = \\ket{\\beta}\\ket{g}$, followed by two transmon rotations, $Y_{\\pi/2}$, separated by a variable delay time.\n\nThe resulting evolution can be captured by measuring the state of the transmon ancilla, which is given by\u00a0[Unknown Author, \"Unknown Title\", ]\n$$\n\n%  P_e = \\frac{1}{2}\\{1 + e^{|\\beta|^2(\\cos{\\chi t}-1)}\\cos{(|\\beta|^2\\sin{\\chi t}})\\}.\nP_e = \\frac{1}{2}\\{1 + e^{-2|\\beta|^2\\sin^2(\\chi t/2)}\\cos{(|\\beta|^2\\sin{\\chi t}})\\}.\n\n$$\nFor a large coherent state $|\\beta|\\gg 1$, $P_e\\approx \\frac{1}{2}$ during most of the evolution time due to the entanglement of the cavity-transmon system, which results in an apparent mixed state when only the qubit is measured. However, at times $t = 2n\\pi/\\chi$ ($n\\in\\mathbb{Z}^+$), the transmon and cavity are no longer entangled, resulting in a \u201crevival\" of the transmon excited state. Hence, the times at which such revival occurs provides a precise measure of $\\chi$.\n\nNext, let us consider the experimental process to extract the coherence times of the cavity. Analogous to the transmon qubits, the performance of a high-Q cavity can be captured by its $T_1$ and $T_2$ Ramsey times. These measurements often require the preparation of Fock states in the cavity. This can be implemented via numerically optimized drives, such as the selective number-dependent arbitrary phase (SNAP)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or optimal control theory gate (OCT)\u00a0[Unknown Author, \"Unknown Title\", ] gates.\n\nPhysically, the $T_1$ of a cavity indicates the photon-loss rate. This is measured using a simple protocol described in Fig.\u00a0(Figure fig:cav_tuneup)(c), where we probe the probability of the cavity returning to its vacuum state from a large coherent state after a variable delay. Alternatively, cavity $T_1$ can also be extracted by measuring the time-scale over which it returns to vacuum from Fock state $|1\\rangle$.\n\nThe $T_2$ Ramsey time of an harmonic oscillator mode is defined as duration over which the phase between its lowest two energy levels can be coherently preserved. To probe this, we prepare a state along the equator of the pseudo-Bloch sphere of the resonator\u2019s subspace spanned by $\\{|0\\rangle, |1\\rangle\\}$ such as\n$$\n\n|\\psi_0\\rangle \\approx \\frac{1}{\\sqrt{2}}(|0\\rangle + |1\\rangle).\n\n$$\nThe time evolution of this state is similar to that of a two-level system initialized on the equator of its Bloch sphere. After a variable wait time, we perform another displacement operation on the cavity such that the interference effect results in the cavity returning to $|0\\rangle$ if the initial phase of the prepared superposition state is unchanged. A comprehensive discussion of these protocols can be found in Chapter 6 of Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nFinally, for any arbitrary state $\\ket\\psi$ in the storage cavity, we can also implement QND measurement of photon number parity with the protocol shown in Fig.\u00a0(Figure fig:cav_tuneup)(e). In this process, the transmon is first rotated to the equator state $(\\ket{g}-\\ket{e})/\\sqrt{2}$ with a $Y_{\\pi/2}$ pulse. After an idle time of $t=\\pi/\\chi$, under the effect of the $\\mathbf{C}_\\Phi$ gate, the even-parity and odd-parity photon states accumulate phases of 0 and $\\pi$ (modulo 2 $\\pi$) respectively. After another transmon $Y_{\\pi/2}$ pulse, these unitary operations complete entanglement of the transmon with the parity operator of the cavity:\n$$\n\n\\ket{\\psi}\\otimes \\ket{g} \\longrightarrow \\mathbf{\\Pi_e}\\ket{\\psi}\\otimes\\ket{e} + \\mathbf{\\Pi_o}\\ket{\\psi}\\otimes\\ket{g}\n\n$$\nwhere $\\mathbf{\\Pi_e}$ and $\\mathbf{\\Pi_o}$ are projectors to the even and odd parity subspace. Each single-shot QND measurement of the transmon state reveals the parity of the cavity state, which informs the binary status of \u201cerror\" or \u201cno-error\" on the logical qubit. Repetitive monitoring of the error syndrome using this technique was first demonstrated in Ref.\u00a0[Unknown Author, \"Unknown Title\", ], and was subsequently used in a growing number of bosonic QEC experiments\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nFurthermore, this Ramsey-style parity measurement protocol also allows to perform a direct measurement of the Wigner function of the cavity\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The value of the Wigner function at any point of the phase space is equal to the expectation value of the photon number parity after a displacement by $\\alpha$: $W(\\alpha) = \\frac{2}{\\pi}\\mathrm{Tr}[\\bD_\\alpha^\\dagger\\rho\\bD_\\alpha\\mathbf{P}]$. The same technique has been further extended to perform joint photon parity measurements and joint Wigner tomography of two cavities\u00a0[Unknown Author, \"Unknown Title\", ].\n\n## Towards robust large-scale QC\nIn the preceding section, we have introduced the main techniques for the calibration and characterization of a small quantum device consisting of one or qubits and their readout resonators. Building upon this, we can now think about how to incorporate a large number of these physical elements to construct a more complex quantum device that is potentially capable of performing fault-tolerant computation.\n\nCurrent efforts towards this goal can be loosely sorted into two main categories. One focuses on scaling up the existing physical elements we have mastered to construct devices on the 100 qubit level and explore the immediate applications such devices could afford. In parallel, another approach is to first tackle the realization of quantum error correction on individual logical elements and then, scale them up in a modular fashion. Both strategies have yielded remarkable progress in recent years. This section serves to review the crucial milestones that have been achieved in the cQED communities and highlight some of the key challenges that still lie ahead as we transition from the current state-of-the-art systems to realizing robust and universal quantum computers.\n\n### NISQ devices\nAs our capabilities to design, fabricate, and manipulate individual physical elements continue to improve, a natural step forward is to construct larger quantum systems with more complexity and computational power. In recent years, we have witnessed a rapid increase in the number of physical qubits, together with their associated readout elements, that are integrated into a single quantum processor in the noisy intermediate-scale quantum (NISQ) regime\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nWe can quantify the development of NISQ devices by considering the number of physical qubits, $n$, present on the quantum processor chip. While this provides an indication of the total Hilbert space available ($2^n$), it does not fully reflect the performance and capabilities of a device. However, quantum bits cannot simply be densely packed on a chip to achieve superior computational power. Doing so typically degrades their individual performance, and more importantly, introduces additional failure modes due to spurious interactions between the physical elements.\n\nHence, to adequately describe the power of a quantum computer, we must take into account both the number of qubits $n$, and the number of operations that can be performed, which is typically expressed using the circuit depth $d$. The latter corresponds to the number of circuit layers that can be executed before (on average) a single error occurs. Quantitatively, $d\\approx 1/ \\err_{1\\mathrm{step}} = 1/ n\\err_{\\mathrm{eff}}$, where the effective error rate $\\err_{\\mathrm{eff}}$ is the average error rate per two-qubit operation. A useful metric that combines these two quantities is the quantum volume $V_{\\mathrm{Q}}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Assuming all-to-all connectivity, where the width of the circuit is equivalent to the number of physical qubits, the quantum volume is defined as $\\mathrm{log}_2 (V_{\\mathrm{Q}}) = \\argmax_n \\min (n, d(n))$\u00a0[Unknown Author, \"Unknown Title\", ].\n\nHowever, it is important to note that the quantum volume assumes that the circuits are of equal width and depth. In practice, it is potentially beneficial in the NISQ regime to focus on the short-depth circuits, which could still bring enhancements beyond the reach of classical computing despite the current error rates\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nTo illustrate this, let us consider the results described in Ref.\u00a0[Unknown Author, \"Unknown Title\", ], in which a $n=53$ qubit device with $\\err \\sim 10^{-3}$ was used to perform a computation faster than any existing classical machines. This can be understood by looking closely at the quantum volume of a processor, which is designed as a binary metric: can a device run an algorithm? For many algorithms, a single error indicates a catastrophic failure. However, other applications, such as sampling a distribution (as is done in Ref.\u00a0[Unknown Author, \"Unknown Title\", ]), can tolerate a limited amount of errors simply by averaging the outcomes of the computation. Thus, developing useful applications that could be advantageous to run on a NISQ quantum computer instead of a classical machine has become an active and rapid advancing research frontier.\n\nMoreover, the current NISQ devices also provide a valuable platform to investigate the unique challenges associated with having a large number of quantum elements and test out the various technological solutions that are being rapidly developed the cQED community.\n\nOne of the most pertinent challenges to be address is how to effectively characterize large quantum system. This is crucial as we can only build devices as well as we can measure them. In other words, an effective process to accurately capture the system behavior and gain comprehensive knowledge about its key parameters is indispensable for improving the performance of quantum hardware. This step provides the critical information needed to complete the development cycle of quantum processors, as described in Fig.\u00a0(Figure fig:overview).\n\nA naive generalization of the various measurement and calibration techniques introduced in Sec.\u00a0<ref> does not suffice to adequately characterize large quantum processors. The reason is two fold. First, if calibration experiments are done sequentially, the number of experiments and the time required become comparable to the time scale over which system parameters drift. While parallelizing these experiments can reduce the total run time, it imposes the additional penalty of cross-talk and unwanted entanglement between individual qubits. If we were to capture these potential correlations between the qubits, we must consider the collective state of the device. This implies the number of parameters increases exponentially with the number of qubits and quickly become intractable.\n\nAddressing this challenge calls for automated calibration capabilities that integrate control, measurement, and analysis of the measurement outcome in a continuous and efficient workflow. Moreover, new protocols that take into account the complex noise models of a multi-qubit device must also be developed. This is an active field of research, and many novel frameworks have been proposed in recent years\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. These developments highlight the importance of developing NISQ processors, without which we would not be able to verify and improve these calibration protocols. This will, in turn, limit our ability to construct more optimized and robust hardware.\n\nAnother active area of research focuses on improving our ability to reliably design and fabricate devices with larger numbers of physical qubits while ensuring their performance. In a simplified model, each physical qubit should meet three basic conditions: 1.\u00a0all control lines are working and have the correct coupling strength to the device; 2.\u00a0qubit coherence is above a certain target (e.g.\u00a0$50\\si{\\us}$); and 3.\u00a0the relevant system parameters (e.g.\u00a0$\\omega$, $\\chi$, etc.) are within a specified tolerance.\n\nBased on this, we consider the `yield' of a larger quantum device as the probability that all constituent qubits satisfy the above three requirements. In this simple picture, even if each individual qubit has a high (e.g.\u00a0$99\\%$) chance of meeting these conditions, the overall yield of a large quantum processor would still deteriorate exponentially to a rather limited level as the number of physical element increases.\n\nA promising strategy to ameliorate this issue is via a more modular approach, where smaller devices within the same fridge are linked together to form a larger processor\u00a0[Unknown Author, \"Unknown Title\", ]. Compared to producing a single monolithic chip, the odds of achieving the same scale by combining multiple smaller patches are much more favorable. Existing flip-chip architectures\u00a0[Unknown Author, \"Unknown Title\", ], in which the readout resonators, Purcell filters, and coupling buses are on a different chip than the qubits, can be seen as a prototype of this technique as they effectively link together different devices.\n\nAs the processing power of the current cQED systems increases, we are also pushing the limits of the associated cryogenic and microwave technologies. For a system up to $\\sim 100$ qubits, the heat load imposed by the device, together with the accompanying auxiliary components, can still be managed by using standard techniques as described in Sec.\u00a0<ref> and Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. However, novel cabling technologies with reduced thermal conductivity and form factor\u00a0[Unknown Author, \"Unknown Title\", ], as well as more powerful cryogenic systems will be critical for eventual realization of full scale quantum computers.\n\n### Cavity-based logical qubits\nIn parallel to the push to construct larger-scale NISQ devices, development of error-corrected logical qubits using continuous variable systems also presents an exciting and highly promising avenue for realizing robust universal quantum computing.\n\nIn particular, recent experimental progress has shown that encoding qubits in multi-photon states of high-coherence superconducting cavities offers a hardware-efficient path towards implementing quantum error correction. There is a growing family of QEC codes, known as the bosonic codes, that employs the cavity's large Hilbert space to store logical information. The construction and implementation of bosonic codes in cQED have become a rapidly-developing area of research in recent years\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThis approach has led to the landmark demonstration of the first logical quantum memory with a longer lifetime than any of its physical constituents\u00a0[Unknown Author, \"Unknown Title\", ], followed by logical gates between two cavity-based qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and also error-corrected logical operations\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nFor an overview of the progress in this area, readers can refer to some recent review papers\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nFurthermore, these cavity-based logical qubits are also motivated by the modular architecture of quantum computing\u00a0[Unknown Author, \"Unknown Title\", ], where each module is realized with a small number of logical elements equipped with robust first-order-corrected quantum gates (Fig.\u00a0(Figure fig:modular)). These modules can potentially be optimized independently and connected with relatively little cross-talk. Communication between modules can be engineered with large on-off ratio and leverage on entanglement distillation protocols to overcome errors\u00a0[Unknown Author, \"Unknown Title\", ]. This modular architecture is also a natural candidate for implementing distributed computation paradigms in the long run\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nTo realize these high-quality quantum modules endowed with efficient error-correction feature experimentally, robust hardware structures with both good intrinsic coherence and controllability are required. This again highlights one of the key advantages of employing 3D cavity modes as logical elements - they have shown coherence times orders of magnitude longer than the best superconducting qubits to date. While the coherence times of transmons are typically in the 20-100 $\\mu$s range\u00a0[Unknown Author, \"Unknown Title\", ] (with a recent demonstration of $>300\\,\\mu$s\u00a0[Unknown Author, \"Unknown Title\", ] on a new material platform), standalone 3D superconducting cavities routinely show coherence times on the order of 1 ms\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], with new preliminary demonstrations up to 2 s\u00a0[Unknown Author, \"Unknown Title\", ].\n\nFurthermore, it has been shown that the favorable coherence properties of superconducting cavities can be maintained independent of the exact geometry or fabrication processed employed. For example, recent demonstration of lithographically-etched and indium-bonded superconducting cavities achieved a single-photon lifetime approaching 5 ms\u00a0[Unknown Author, \"Unknown Title\", ]. In industrial-scale efforts moving forward, both the planar and the 3D approach to cQED are converging on sophisticated multi-wafer fabrication processes completed with indium bonding, and the vision for such a hardware platform has been nicknamed multilayer microwave integrated quantum circuits (MMIQC)\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nA conceptual illustration of a modular quantum computer. Each module consists of a small number of error-corrected logical elements (pink) equipped with robust quantum operations between them. In addition, each module is also designed to have its communication elements (blue) where quantum information can be coherently transferred on the fly across different modules.\n\nIn addition to long coherence times, superconducting cavities also provide an unbounded Hilbert space to allow redundant storage of information, a prerequisite for QEC. Furthermore, expanding the useful Hilbert space by accessing higher excited states does not incur new types of errors (unlike using extra physical qubits), which is crucial for reducing the complexity overhead and enabling near-term benefits of QEC. Broadly speaking, there are three types of first-order errors in a cavity oscillator: single photon loss ($\\ba$), single photon gain ($\\ba^\\dagger$), and dephasing ($\\ba^\\dagger\\ba$). In practice, superconducting cavities can have negligible intrinsic dephasing rates and their effective temperature can be maintained sufficiently low so that the photon gain rate is also negligible. Therefore, if a logical qubit is encoded in the state of a superconducting cavity as a memory unit, there is only one prominent error channel: single photon loss. Performing QEC on this dominant error alone has the prospect of substantially extending the lifetime of quantum information\u00a0[Unknown Author, \"Unknown Title\", ]. Moreover, it has been demonstrated that this error can be corrected in a passive manner using continuous dissipation\u00a0[Unknown Author, \"Unknown Title\", ].\n\nQuantum error correction against the dominant intrinsic cavity error, single photon loss, represents only the first step towards a fully-functional logical qubit that may outperform physical qubits as quantum building blocks. Another indispensable ingredient is high-quality logical operations between them. Hence, the outstanding challenge at hand is to deliver an error-corrected logic gate with better gate fidelity than native gates on physical qubits, or achieving break-even in terms of gate fidelity. Recent techniques that employ parametric conversion using strong off-resonant pump tones have enabled the demonstration of a coherent swap interaction between two otherwise isolated cavity modes. This interaction forms the basis of bosonic interference and logical entangling gates between two bosonic qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In addition, using the idea of path-independence in quantum gates, major developments are underway to improve fault-tolerance of bosonic qubit gates, including recent demonstrations of gates that can tolerate transmon $T_1/T_\\phi$ errors\u00a0[Unknown Author, \"Unknown Title\", ] and cavity photon loss\u00a0[Unknown Author, \"Unknown Title\", ].\n\nSo far, most experiments on bosonic qubits employ a simple cavity-transmon-readout device architecture (Fig.\u00a0(Figure fig:cav_tuneup)(d)), which continues to offer exciting opportunities to advance the state of the art. However, the use of transmons as ancillae imposes several important limitations. Firstly, all quantum resources available to the bosonic qubit center around the cavity-transmon dispersive interaction, which inevitably ties the $T_1$ channels of the transmon to cavity dephasing. Secondly, since the transmon is a weakly nonlinear element, parametric processes based on the transmon are relatively slow and may require a lot of microwave power that causes heating or undesirable non-perturbative dynamics\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Looking forward,it is pertinent that future endeavors explore alternative cQED architectures that are more compatible with tunable ancilla-cavity couplings and look beyond simple transmon devices to develop new ancilla circuits with better performance.\n\nOne promising candidate for such new ancilla circuit elements employs three-wave mixing, which has been realized in the Superconducting Nonlinear Asymmetric Inductive eLement (SNAIL)\u00a0[Unknown Author, \"Unknown Title\", ]. Such elements do not produce dispersive shifts to cavity modes and are more effective in modulating bi-modal parametric interactions. It has also been demonstrated that one can control the oscillator quantum states with three-wave mixing processes\u00a0[Unknown Author, \"Unknown Title\", ]. Furthermore, a related ancilla circuit, the asymmetrically threaded SQUID (ATS), has recently demonstrated pristine 2-photon dissipation without introducing any dispersive frequency shifts to the logical qubit\u00a0[Unknown Author, \"Unknown Title\", ]. Finally, it has been proposed that a driven bosonic qubit can be used as an ancilla for error correction and operation of other bosonic qubits\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn order to take advantage of these novel ancilla circuits, which are multi-junction devices, we must be able to provide the necessary magnetic flux to operate them in the appropriate regimes. Therefore, a pressing need in this direction is to integrate flux control lines with high-coherence superconducting cavities\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nAnother crucial building block for universal quantum computer based on these individually corrected modules is the quantum communication links between them. It has been shown that bosonic qubits can be conveniently released into travelling waves\u00a0[Unknown Author, \"Unknown Title\", ] and recaptured in a separate module\u00a0[Unknown Author, \"Unknown Title\", ] using parametric beam-splitter (two-mode swapping) interactions. The catch and release makes use of the temporal mode-matching technique\u00a0[Unknown Author, \"Unknown Title\", ], similar to remote state transfer or entanglement experiments with transmons\u00a0[Unknown Author, \"Unknown Title\", ]. The added benefit here is that any photon loss in the transmission channel can be first-order corrected\u00a0[Unknown Author, \"Unknown Title\", ].\n\n## Conclusion and outlook\nIn the past decade, we have witnessed the remarkable transformation of quantum computing from the realm of scientific curiosity to tangible technological innovations. Rapid progress on the construction of robust quantum hardware has been made in a variety of different physical systems, such as trapped ions\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], photons\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], neutral atoms\u00a0[Unknown Author, \"Unknown Title\", ], and spins\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The cQED platform, in particular, has achieved many major milestones such as demonstration of small-scale QEC\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] as well as efficient implementations of quantum algorithms on NISQ era devices\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nTogether with these achievements, a rich repertoire of knowledge and techniques has been developed in the cQED community, from both the industry and academic teams worldwide. At this pivotal stage of transition from small prototypical devices to robust large-scale quantum computing, a concerted and continual effort in talent-development is indispensable. Here, we have attempted to provide a pr\u00e9cis of some of the useful practices and insights that have been learnt through repeated trial and error in the early days of cQED. Together with the other excellent review articles about the different facets of the cQED technology, we hope that this guide will help accelerate the learning process of a novice experimentalist and allow them to better navigate the process of setting up a successful cQED experiment.\n\nWith the relentless progress and innovation in this field, it suffices to say that the prescriptions we presented here will undoubtedly become obsolete or redundant as the cQED technology continues to mature into more streamlined and robust implementations. Nonetheless, it is our belief that many of these ideas will remain useful and educational for future generations of scientists and engineers going into this exciting and versatile quantum playground.\n\nACKNOWLEDGEMENT\n\nWe thank Luigi Frunzio, Shyam Shankar, and Leo DiCarlo for their insightful feedback on the manuscript. We thank E.\u00a0Dogan and S.\u00a0Shirol for their assistance with example data figures. Y.Y.G.\u00a0acknowledges the support of the National Research Foundation Fellowship (Class 2020) and the Ministry of Education, Singapore. C.W.\u00a0acknowledges support from the US National Science Foundation (1809114) and Army Research Office (W911NF-17-1-0469).\n\nunsrt\n\n"}
{"prompt": "What are the key contributions of the paper 'Paper 1803.09813'?", "completion": "\n\n=1\n\n[pages=1-last]press_maintext_20180326.pdf\n[pages=1-last]supplement_20180326.pdf\n\n"}
{"prompt": "What are the key contributions of the paper 'Paper 2002.07119'?", "completion": "\n\ncalc, positioning\n\n"}
{"prompt": "What are the key contributions of the paper 'Tunable coupler for realizing a controlled-phase gate with dynamically decoupled regime in a superconducting circuit'?", "completion": "\n\nifundefinedtextcolor\n\n# Tunable coupler for realizing a controlled-phase gate with dynamically decoupled regime in a superconducting circuit\n\nThese two authors contributed equally to this work.\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nThese two authors contributed equally to this work.\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nypsong@mail.tsinghua.edu.cn\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nlmduan@tsinghua.edu.cn\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nluyansun@tsinghua.edu.cn\nCenter for Quantum Information, Institute for Interdisciplinary Information Sciences, Tsinghua University, Beijing 100084, China\n\nControllable interaction between superconducting qubits is desirable for large-scale quantum computation and simulation. Here, based on a theoretical proposal by Yan $et~al$. [Phys. Rev. Appl. 10, 054061 (2018)] we experimentally demonstrate a simply-designed and flux-controlled tunable coupler with a continuous tunability by adjusting the coupler frequency, which can completely turn off adjacent superconducting qubit coupling. Utilizing the tunable interaction between two qubits via the coupler, we implement a different type of controlled-phase (CZ) gate with `dynamically decoupled regime', which allows the qubit-qubit coupling to be only `on' at the usual operating point while dynamically `off' during the tuning process of one qubit frequency into and out of the operating point. This scheme not only efficiently suppresses the leakage out of the computational subspace, but also allows for the acquired two-qubit phase being geometric at the operating point. We achieve an average CZ gate fidelity of 98.3$\\pm0.6$\n\n## Introduction\nAs enormous progress has been made towards more complex networks of qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], superconducting quantum circuits have become a promising implementation for quantum simulation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and fault-tolerant quantum computation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Building large circuits requires long coherent times of the qubit, strong interqubit interaction for fast and high-fidelity two-qubit gates, and small to zero coupling between qubits when no interaction is needed. For typical planar circuits with transmon or transmon-type qubits connected through fixed capacitors or quantum buses, strong interaction and variable coupling can be achieved by dynamically adjusting the frequencies of the tunable qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] or by applying external microwave drives\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Parametric modulation of the frequency of the qubit or the bus has also been used to achieve tunable coupling between qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. However, these approaches could not fully turn off the interaction, and thus parasitic ZZ crosstalk coupling is always present, resulting in a frequency shift of one qubit depending on the state of another. This unwanted qubit interaction could be a limited source to degrade the single-qubit gate performance and to accumulate the entanglement phase error. In addition, because of the requirement of the qubit frequency tunability or the relatively small qubit-qubit detunings, these approaches also suffer from the frequency-crowding problem.\n\nInserting an extra circuit element, a tunable coupler, can offer another degree of freedom, and thus is efficient for helping mitigate the above problems of unwanted interactions and frequency crowding, while achieving a controllable qubit interaction without introducing other nonidealities that limit the gate performance. A variety of tunable couplers based on a rf superconducting quantum interference device, a tunable bus, or a tunable inductor have previously been designed and demonstrated experimentally\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Tunable couplers are thus desirable for scalable architectures for quantum computation and simulation applications.\n\nIn this work, following the theoretical proposal in Ref.\u00a0Yan2018, we experimentally demonstrate a simply designed tunable coupler capacitively coupled to two computational Xmon qubits in a superconducting circuit\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. This tunable coupler is based on only one extra Xmon qubit and is therefore easy to scale up. By adjusting the coupler frequency, the qubit-qubit coupling strength can be tuned through a combination of different coupling paths such that a continuous tunability from positive to negative values can be realized. Consequently, unwanted qubit interactions, such as parasitic ZZ crosstalk, can be completely turned off as wished. Utilizing the tunable interaction between the two qubits via the coupler, we realize the entangling gates of iswap and $\\sqrt{\\mathrm{iswap}}$ with a fidelity of 96.8\n\nBesides, the demonstrated tunable coupler provides a straightforward way to suppress adjacent qubit coupling without degrading the qubit coherence. Theoretically, this tunable coupler scheme can offer a wide coupling tunability from several MHz in the positive regime to several tens MHz in the negative regime, thus allowing for fast two-qubit gates. The simple design of adding only one extra Xmon qubit as the coupler is also particularly compatible and desirable for large-scale superconducting architectures.\n\n< g r a p h i c s >\n\n(a) Optical micrograph of three Xmon qubits with the middle one $C$ serving as a tunable coupler for the two computational qubits ($Q_1$ and $Q_2$). Each computational qubit has independent XY and Z control, and is coupled to a separate $\\lambda/4$ resonator for simultaneous and individual readout. The coupler also has an individual flux-bias line for a frequency tunability. The combination of direct capacitive coupling and indirect tunable coupling via the coupler constitutes the total coupling between the two computational qubits. (b) Schematic electrical circuit of the device.\n\n< g r a p h i c s >\n\n(a) Pulse sequence to characterize the tunability of the coupler. The two qubits are initialized in the ground state at their sweet spots with a detuning of 35\u00a0MHz. The coupler is originally set at $\\omega_{c}/2\\pi=5.905$\u00a0GHz where the coupling between the two qubits is nearly off. A $\\pi$ pulse is first to excite $Q_2$, followed by two simultaneous fast flux pulses: $f_1$ brings $Q_1$ into resonance with $Q_2$; $f_c$ on the coupler to turn on the coupling. After the two qubits interact and evolve for time $t$, $Q_1$ and the coupler are pulsed back to the original points for measurements of qubit populations. (b) Population of $Q_2$ as a function of the amplitude of $f_c$ and $t$ clearly reveals the tunability of the coupling strength. The two dark dashed lines indicate the situation where the coupling is off. (c) Population of $Q_1$ as a function of time with the coupling on (orange dots) or off (black dots). (d) The effective qubit-qubit coupling strength $\\tilde{g}/2\\pi$ (black circles) extracted by fitting the oscillation of the qubit excitation in (b) as a function of the flux-bias amplitude on the coupler. The red line is a fit to the extracted $\\tilde{g}$ according to Eq.\u00a0(<ref>). The coupler frequency (blue dots) can be measured independently by probing the dispersive shift of the qubit frequency when pulsing the coupler into the excited state. Inset: the ZZ crosstalk coupling $\\xi_{ZZ}/2\\pi$ measured in a Ramsey-type experiment when the two qubits are detuned and at their sweet spots. The red arrow indicates where the coupling is off. (e) Individual and simultaneous RB for $Q_1$ and $Q_2$ with $\\xi_{ZZ}/2\\pi\\approx0$ and $-0.45$\u00a0MHz, respectively.\n\n## Results\n### Experimental System and Theory\nOur experimental device consists of three flux-tunable Xmon qubits ($Q_1, C, Q_2$)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] with the middle one $C$ serving as the tunable coupler (henceforth referred to as the `coupler'), as shown in Fig.\u00a0(Figure fig:Fig1)(a). Figure\u00a0(Figure fig:Fig1)(b) is the schematic of the device. The maximum frequencies of the two qubits and the coupler are $\\omega^{\\mathrm{max}}_{1}/2\\pi=4.961$\u00a0GHz, $\\omega^{\\mathrm{max}}_{2}/2\\pi=4.926$\u00a0GHz, and $\\omega^{\\mathrm{max}}_{c}/2\\pi=5.977$\u00a0GHz. Details of the experimental apparatus and device parameters are presented in  Appendix C. We first briefly discuss the operating principle of the tunable coupler following Ref.\u00a0Yan2018. The system can be described by the Hamiltonian:\n$$\n\\label{Eq1}\n%\\begin{flalign}\n\\begin{split}\nH/\\hbar&=\\sum_{i=1,2}\\frac{1}{2}{\\omega_i}\\sigma^z_i+\\frac{1}{2}{\\omega_c}\\sigma^z_c+\\sum_{i=1,2}g_i(\\sigma^+_i\\sigma^-_c+\\sigma^+_c\\sigma^-_i)\\\\\n&+g_{12}(\\sigma^+_1\\sigma^-_2+\\sigma^+_2\\sigma^-_1),\n\\end{split}\n%\\end{flalign}\n\n$$\nwhere $\\omega_\\alpha (\\alpha=1,2,c)$ are the frequencies of $Q_1$, $Q_2$, and the coupler respectively, $\\sigma_\\alpha^{z,\\pm}$ are the corresponding Pauli Z, raising and lowering operators, $g_i$ (i = 1, 2) is the coupling strength between each qubit and the coupler, $g_{12}$ is the direct capacitive coupling strength between the two qubits.\n\nIn the strong dispersive regime ($g_i\\ll|\\Delta_i|$, where $\\Delta_i=\\omega_i-\\omega_c)$ and assuming that the coupler mode remains in its ground state, an effective two-qubit Hamiltonian with the variable coupler decoupled can be derived by making the unitary transformation $U=\\mathrm{exp}\\{\\sum_{i=1,2} g_i/\\Delta_i (\\sigma^{+}_i \\sigma^{-}_c-\\sigma^{-}_i\\sigma^{+}_c)$}\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and keeping to second order in $g_i/\\Delta_i$:\n$$\n\\label{Eq2}\nUHU^{\\dagger}/\\hbar=\\sum_{i=1,2}\\frac{1}{2}{\\tilde{\\omega}_i}\\sigma^z_i+\\tilde{g}(\\sigma^+_1\\sigma^-_2+\\sigma^-_1\\sigma^+_2),\n\n$$\nwhere ${\\tilde{\\omega}_i}= {\\omega}_i+g_i^2/\\Delta_i$ is the dressed frequency and\n$$\n\\label{Eq3}\n\\tilde{g} =g_{12}+(g_1 g_2)/\\Delta\n\n$$\nis the effective coupling strength with $1/\\Delta=(1/\\Delta_1 +1/\\Delta_2)/2$. The interaction between the two qubits thus consists of the direct capacitive coupling and the indirect virtual exchange coupling via the coupler. If $\\Delta_i<0$ (the coupler's frequency is above both qubits' frequencies), the virtual exchange interaction term $(g_1 g_2)/\\Delta<0$. Therefore, the effective coupling $\\tilde{g}$ can be tuned from negative to positive monotonically with increasing the coupler frequency. Since this coupling tunability is continuous, a critical value $\\omega_c^{\\mathrm{off}}$ can always be reached to turn off the qubit-qubit coupling $\\tilde{g}(\\omega_c^{\\mathrm{off}})=0$. When the two qubits are detuned, the ZZ crosstalk coupling $\\xi_{ZZ}$ can also be turned off (see below and  Appendix A).\n\n### Suppressing Parasitic ZZ Crosstalk\nWe now demonstrate the tunability of the qubit-qubit coupling strength $\\tilde{g}$ controlled by the coupler's frequency. The experimental pulse sequence is illustrated in Fig.\u00a0(Figure fig:Fig2)(a). Coherent excitation oscillation between $Q_1$ and $Q_2$ as a function of the flux amplitude of $f_c$ on the coupler and time $t$ is shown in Fig.\u00a0(Figure fig:Fig2)(b), and clearly reveals the change of the coupling strength depending on the coupler frequency. Remarkably, two flux biases of the coupler, at which the qubit-qubit interaction is completely turned off, are observed and marked by two dark dashed lines.\n\nThe extracted $\\tilde{g}$ indeed varies continuously from positive to negative values and is in good agreement with theoretical calculations (red curve), as shown in Fig.\u00a0(Figure fig:Fig2)(d). The small discrepancy at large negative coupling regime owes to the deviation of the qubit-coupler coupling from the strong dispersive condition. Given the extracted coupling strength and the frequency detuning of each qubit from the coupler, we can estimate the direct capacitive coupling strength $g_{12} \\approx 6.74$\u00a0MHz using Eq.\u00a0(<ref>). We note that a large negative interaction can be reached with the decrease of the coupler frequency approaching the qubit frequency. However, when the coupler frequency is further reduced to be close to the qubit frequency, the virtual excitation approximation of the coupler becomes invalid.\n\n< g r a p h i c s >\n\n(a) (b) Bar charts of the measured $\\chi_{\\mathrm{exp}}$ from a QPT for iswap and $\\rm \\sqrt{iswap}$ with a gate fidelity of 96.8\n\nWe extract $\\xi_{ZZ}$ when the two qubits are detuned at their sweet spots using a Ramsey-type experiment, which involves probing the frequency of $Q_2$ with $Q_1$ in either its ground or excited state\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The measured $\\xi_{ZZ}$ also depends on the coupler frequency and is shown in the inset of Fig.\u00a0(Figure fig:Fig2)(d). At the critical coupler frequency $\\omega_c^{\\mathrm{off}}\\approx 5.905$\u00a0GHz, indicated by the red arrow, the measured $\\xi_{ZZ}/2\\pi\\approx 1$\u00a0kHz and is limited by the current detection scheme. We utilize simultaneous randomized benchmarking (RB) to verify the isolation of two qubits at this configuration. The simultaneous RB gate fidelities of 99.45\n\n### Implementing CZ Gate with Dynamically Decoupled Regime\nWith the tunability of the coupling, we now move to the implementation of two-qubit entangling gates. The iswap and $\\rm \\sqrt{iswap}$ gates are quite natural based on the Hamiltonian of Eq.\u00a0(<ref>)\u00a0[Unknown Author, \"Unknown Title\", ]. Their measured $\\chi_{\\mathrm{exp}}$ from quantum-process tomography (QPT), which can give full information about the gate process\u00a0[Unknown Author, \"Unknown Title\", ], are presented in Fig.\u00a0(Figure fig:Fig3) with a gate fidelity of 96.8\n\nThe fully controllable interaction of the coupler allows for turning the coupler `on' or `off' as wished. The ideal scheme of implementing a CZ gate with a coupler is to have both qubits initialized in the operating point where $\\ket{11}$ and $\\ket{20}$ have the same energy with the coupling `off', and then slowly turn on the coupler for proper time to implement the gate. This method can avoid adjusting the qubit frequency, and thus reduce the leakage error. However, the unwanted crosstalk of the XY control lines in our device could degrade single-qubit gate performance because of the zero detuning between $\\omega_{12}$ of $Q_1$ and $\\omega_{01}$ of $Q_2$. Therefore, the qubits are initially detuned and at their sweet spots with the coupling `off'.\n\n< g r a p h i c s >\n\n(a) Schematic to realize the CZ gate using the usual $\\ket{11}$ and $\\ket{20}$ resonance. (b) Flux sequence to realize the CZ gate with DDR. The $Q_1$ frequency is unchanged during the process. A gradual flux pulse (for a cosine-type frequency adjustment) on $Q_2$ is to tune its frequency to the operating point, while a flux pulse on the coupler with an appropriate pulse shape to dynamically keep the coupling `off' (the shaded regions). The coupling is then turned on by applying another gradual flux pulse on the coupler (for a cosine-type coupler frequency adjustment) for proper two-qubit interaction time to acquire the required $\\pi$-phase shift on $\\ket{11}$. (c), (d) Confirmation of the `off' state of the coupling in the DDR and the corresponding measurement sequences. Top: the population of $\\ket{11}$ state shows purely exponential decay without any oscillation. Middle: phase accumulation of $\\ket{01}$ with respect to $\\ket{00}$. Bottom: phase accumulation of $\\ket{11}$ with respect to $\\ket{10}$. The difference between the lower two panels shows zero phase accumulation of $\\ket{11}$, confirming zero coupling. (e) Population of $\\ket{11}$ in three different schemes to realize the CZ gate. Upper: rectangular pulses to have a positive coupling strength. $t_R=222$\u00a0ns is required for realizing the standard two-qubit CZ gate. Middle: rectangular pulses to have a negative coupling regime. Obvious high-frequency oscillations occur and indicate the leakage out of $\\ket{11}$. Lower: DDR pulses to have a large negative coupling but with a smooth oscillation. A CZ gate can be accomplished with a gate time $t_D$=119\u00a0ns. (f) Bar chart of the measured real part of $\\chi_{\\mathrm{exp}}$ from a QPT shows a gate fidelity of 98.3$\\pm0.6$\n\nThe simplest case is to use rectangular fluxes to simultaneously pulse the qubits to the avoided-crossing point and turn on the coupling. Both our measurement and simulation reveal that the leakage out of $\\ket{11}$ can be effectively suppressed in the positive coupling regime rather than the negative one. This is evidenced by the observation of high-frequency oscillations [the middle panel in Fig.\u00a0(Figure fig:Fig4)(e)], which cause unwanted leakage error. However, due to the weak positive coupling strength, a relatively long gate time ($t_R=222$\u00a0ns) is required to accomplish the CZ gate. The average CZ gate fidelity is 95.5\n\nTo improve the gate fidelity, we use a `dynamically decoupled regime' (DDR) scheme to implement the CZ gate. Note that DDR defined here differs in explication from the term `dynamical decoupling' used in coherent control pulse methods to suppress the dephasing error\u00a0[Unknown Author, \"Unknown Title\", ]. This scheme can not only efficiently suppress the leakage out of the computational subspace but also allow us to perform the gate in the negative coupling regime with larger interaction strength for a shorter gate time. The DDR scheme can be understood by mapping the interaction between the states $\\ket{11}$ and $\\ket{20}$ onto a Hamiltonian of a qubit $H=H_x\\sigma_x'+H_z\\sigma_z'$\u00a0[Unknown Author, \"Unknown Title\", ], where $H_x$ is the coupling energy between the states $\\ket{11}$ and $\\ket{20}$, $H_z$ is the frequency detuning of $\\ket{11}$ from the resonance point of the avoided crossing, and $\\sigma_x'$ and $\\sigma_z'$ are the corresponding Pauli operators which are distinguished from those on the computational qubit. For the typical direct coupling scheme without a coupler where the coupling energy $\\sigma_x'$ term is fixed, CZ gate is realized by adjusting only the $\\sigma_z'$ term, such as the one implemented with a rectangular pulse, fast adiabatic pulse or nonadiabatic pulse\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. While for the DDR scheme with a coupler, both $\\sigma_x'$ term and $\\sigma_z'$ term can be varied as wished.\n\nThe experimental flux sequence is shown in Fig.\u00a0(Figure fig:Fig4)(b). We use a gradual flux pulse on $Q_2$ to tune its frequency to the operating point, while dynamically keeping the coupling `off'. This DDR is achieved by applying a flux pulse on the coupler with an appropriate pulse shape calculated by Eq.\u00a0(<ref>) and is further optimized to assure the zero coupling during the whole qubit frequency-changing process [the shaded regions where $Hx=0, Hz=Hz(t)$]. After that, we slowly turn on the coupling by applying another gradual flux pulse on the coupler and wait for proper time for the two-qubit interaction to acquire the $\\pi$-phase shift on $\\ket{11}$ [$Hx=Hx(t), Hz=0$]. The `off' state of the coupling in the DDR is confirmed by measuring the population change and phase accumulation of $\\ket{11}$ state with the same flux pulses as in Fig.\u00a0(Figure fig:Fig4)(b) (the DDR and the dashed line in the middle). The experimental results and sequences are shown in Figs.\u00a0(Figure fig:Fig4)(c) and (Figure fig:Fig4)(d), respectively.\n\nWe choose an appropriate negative coupling strength to perform the CZ gate, balancing the gate time and qubit-coupler leakage induced by the non-negligible excitation of the coupler. The larger interaction strength reduces the CZ gate time to $t_D=119$\u00a0ns [bottom panel in Fig.\u00a0(Figure fig:Fig4)(e)] and the gate fidelity is improved with an average QPT fidelity of 98.3$\\pm0.6$\n\n## Discussion\nBecause the tunable coupler provides an extra degree of freedom and can fully suppress the qubit coupling, the CZ gate with the DDR scheme should be insensitive to qubit parameters. Based on a numerical simulation (see Appendix E), in the absence of qubit decoherence, the QPT fidelity of the CZ gate with the DDR scheme can be above $99.99\\%$ (with `mesolve' in QuTip\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]). For comparison, we also numerically simulate the CZ gate implemented for the direct coupling case with a fast adiabatic pulse\u00a0[Unknown Author, \"Unknown Title\", ]. We choose the same qubit idle frequencies and qubit-qubit coupling strength to ensure the same gate time ($\\sim 120$ ns) as the DDR scheme, and include the first three coefficients of Fourier basis functions in the pulse optimization with the `fmin' function in PYTHON. The resulted maximum CZ gate fidelity $F \\approx 99.60\\%$, with an error significantly larger than that from the DDR scheme, because the fast adiabatic pulse is more sensitive to qubit parameters and pulse optimization. We note that more Fourier coefficients in the fast adiabatic pulse can be included to improve the CZ gate fidelity, but at the expense of more optimization parameters and harder optimization. A high-fidelity, fast adiabatic CZ gate would be even more challenging because of the unwanted crosstalk when the qubit system becomes larger. By contrast, the CZ gate with the DDR scheme should maintain its robustness and convenience, and therefore would be particularly suitable for large-scale superconducting circuits.\n\nIn current experiment, the measured CZ gate fidelity is dominantly limited by the qubit decoherence, while the coupler decoherence has little effect on the gate fidelity since the coupler remains in the ground state. Optimization of coupler design for better parameters would be helpful to achieve a higher coupling strength while decreasing the leakage error and consequently get a shorter CZ gate time with a improved gate performance. Besides, other pulse shapes to turn on the coupling may further suppress the leakage and need future exploration. In addition, improving fabrication technology to minimize crosstalk between XY lines can offer possibility of realizing a more ideal CZ gate\u00a0[Unknown Author, \"Unknown Title\", ]. Finally, by adopting the Nelder-Mead optimization protocol\u00a0[Unknown Author, \"Unknown Title\", ], we could further improve the CZ gate fidelity to a higher level.\n\nIn summary, we experimentally realize a simple prototype of a flux-controlled tunable coupler. The competition between the positive direct and negative indirect coupling allows for a continuous tunability and for switching off the coupling completely. With this coupler, we implement two-qubit entangling iswap, $\\rm \\sqrt{iswap}$, and CZ gates. In particular, the CZ gate is realized with fully dynamical control over the qubit-qubit coupling: the coupling is only on at the operating point to acquire a geometric two-qubit phase, while being off during the tuning process of the qubit frequency. We achieve an average CZ gate fidelity of 98.3$\\pm0.6$\n\nACKNOWLEDGMENTS\n\nWe thank Chengyao Li for the technical support, and Changling Zou and Zhengyuan Xue for valuable discussions. This work is supported by National Key Research and Development Program of China under Grant No. 2016YFA0301902 and 2017YFA0304303, and National Natural Science Foundation of China under Grant No.11874235 and No.11925404.\n\nCALCULATION OF THE EFFECTIVE QUBIT COUPLING $\\widetilde{g}$ AND ZZ CROSSTALK COUPLING $\\xi_{ZZ}$\n\nTo study the tunable coupling strength between $Q_1$ and $Q_2$, we consider the system Hamiltonian,\n\n< g r a p h i c s >\n\nZZ crosstalk coupling $\\xi_{ZZ}$ versus coupler frequency when the two qubits are detuned and at their sweet spots as in the inset of Fig.\u00a0(Figure fig:Fig2) of the main text. Inset: the experimental sequence for measuring ZZ crosstalk coupling $\\xi_{ZZ}$ at a specific coupler flux bias.\n\n$$\n\\label{Eq_System_Hamiltonian}\n\\begin{split}\n\\widehat{H}=\\widehat{H}_0&+\\widehat{V}\\\\\n\\widehat{H}_0/\\hbar=&\\sum_{i=1,2,c} \\omega_ia_i^+a_i+\\frac{\\eta_i}{2}a_i^+a_i^+a_ia_i\\\\\n\\widehat{V}/\\hbar=&\\sum_{j=1,2} g_{jc}(a_j^+a_c+a_ja_c^+)+g_{12}(a_1^+a_2+a_1a_2^+)\n\\end{split}\n\n$$\nwhere $\\omega_i$ and $\\eta_i$ ($i=1,2,c$) are the frequencies and anharmonicities of $Q_1$, $Q_2$, and the coupler respectively, $a_i^+$ and $a_i$ are the corresponding raising and lowering operators, $g_{jc}$ ($j$ = 1, 2) is the coupling strength between each qubit and the coupler, and $g_{12}$ is the direct capacitive coupling strength between the two qubits.\n\nWhen we only consider the ground and the first excited states of the Xmon qubits, based on the Schrieffer-Wolff transformation\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], the effective coupling $\\widetilde{g}$ between $Q_1$ and $Q_2$ would be\u00a0[Unknown Author, \"Unknown Title\", ],\n$$\n\\label{Eq_XXcoupling}\n\\begin{split}\n\\widetilde{g}=\\frac{g_{2c}g_{1c}}{2\\Delta_{2c}}+\\frac{g_{2c}g_{1c}}{2\\Delta_{1c}}+g_{12},\n\\end{split}\n\n$$\nwhere $\\Delta_{ic} \\equiv \\omega_i-\\omega_c$ is the frequency detuning between the qubit and the coupler.\n\nTo calculate the parasitic ZZ crosstalk coupling $\\xi_{ZZ}$ between $Q_1$ and $Q_2$ when they are detuned, however, it is not enough to only keep up to the second order in the Schrieffer-Wolff transformation. Here we use the perturbation approach\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to derive the parasitic ZZ crosstalk coupling to second, third, and fourth order of the Hamiltonian (<ref>). We define $\\xi_{ZZ}=\\omega_{11}-\\omega_{01}-\\omega_{10}$ between $Q_1$ and $Q_2$. The corresponding perturbation terms are:\n$$\n\\label{Eq9}\n\\xi_{ZZ}^{(2)}=\\frac{2(g_{12})^2(\\eta_1+\\eta_2)}{(\\Delta_{12}+\\eta_1)(\\Delta_{12}-\\eta_2)},\n\n$$\n$$\n\\label{Eq10}\n\\begin{split}\n\\xi_{ZZ}^{(3)}=2g_{12}&g_{1c}g_{2c}[\\frac{1}{\\Delta_{2c}}(\\frac{2}{\\Delta_{21}-\\eta_1}-\\frac{1}{\\Delta_{21}})\\\\\n+&\\frac{1}{\\Delta_{1c}}(\\frac{2}{\\Delta_{12}-\\eta_2}-\\frac{1}{\\Delta_{12}})],\n\\end{split}\n\n$$\n$$\n\\label{Eq11}\n\\begin{split}\n\\xi_{ZZ}^{(4)}=&\\frac{2(g_{1c})^2(g_{2c})^2}{\\Delta_{1c}+\\Delta_{2c}-\\eta_c}(\\frac{1}{\\Delta_{1c}}+\\frac{1}{\\Delta_{2c}})^2\\\\\n&+\\frac{(g_{1c})^2(g_{2c})^2}{(\\Delta_{1c})^2}(\\frac{2}{\\Delta_{12}-\\eta_2}-\\frac{1}{\\Delta_{12}}-\\frac{1}{\\Delta_{2c}})\\\\\n&+\\frac{(g_{1c})^2(g_{2c})^2}{(\\Delta_{2c})^2}(\\frac{2}{\\Delta_{21}-\\eta_1}-\\frac{1}{\\Delta_{21}}-\\frac{1}{\\Delta_{1c}}),\n\\end{split}\n\n$$\nwhere $\\Delta_{ij} \\equiv \\omega_i-\\omega_j$ ($i,j=1,2,c; i\\neq j$). Because $g_{12}\\ll g_{ic}$, we omit the $g_{12}$ term in the derivation of the fourth-order perturbation. Finally, $\\xi_{ZZ}=\\xi_{ZZ}^{(2)}+\\xi_{ZZ}^{(3)}+\\xi_{ZZ}^{(4)}$ and the perturbation calculation is compared with the experiment and the numerical simulation based on QuTip\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], as shown in Fig.\u00a0(Figure fig:ZZcouplingStrength). The experiment agrees fairly well with the numerical simulation. The deviation between the experiment and the perturbation calculation may be due to the higher-order terms. When the detuning between the coupler and the qubits decreases, we can see a larger deviation, indicating the higher-order perturbation terms become more important. The experiment, simulation, and perturbation calculation all reveal that $\\xi_{ZZ}$ can be tuned from negative to positive continuously, and thus we can always find a critical point to fully turn off $\\xi_{ZZ}$ between $Q_1$ and $Q_2$.\n\n## Quantum Process Tomography\nThe two-qubit quantum gates are characterized with quantum-process tomography (QPT). Generally, the qubits are initialized to the following 16 states {$\\ket{g}$, $\\ket{e}$, $(\\ket{g}+\\ket{e})/\\sqrt{2}$, $(\\ket{g}-i\\ket{e})/\\sqrt{2}$}$^{\\otimes 2}$ with the proper single-qubit rotations. After the gate that needs to be characterized, the corresponding final two-qubit state is reconstructed from state tomography measurements with 16 prerotations {$I, X/2, Y/2, X$}$^{\\otimes 2}$, where $I$ is the identity operator, $X, Y, X/2$, and  $Y/2$ are single-qubit $\\pi$ and $\\pi$/2 rotations around X and Y axes respectively. With the 16 initial states $\\rho_i$, the experimental process matrix $\\chi_{\\mathrm{exp}}$ can be extracted from the 16 corresponding final states $\\rho_f$ through $\\rho_f=\\sum_{m,n}{\\chi_{mn} E_m\\rho_i E_n^{\\dagger}}$\u00a0[Unknown Author, \"Unknown Title\", ], where the basis operators $E_m$ and $E_n$ are chosen from the set {$I$, $\\sigma_x$, $-i\\sigma_y$, $\\sigma_z$}$^{\\otimes 2}$.\n\nHowever, the real experiment is not perfect. For example, the generated $\\rho_i$ are not ideal due to the initial state preparation errors; the final state tomography could also be nonideal due to the readout errors. To solve this problem, we first use state tomography to characterize the preparation of the initial states. The measured initial states $\\rho_i^{\\mathrm{meas}}$ are then used to extract $\\chi_{\\mathrm{exp}}$ through $\\rho_f=\\sum_{m,n}{\\chi_{mn} E_m\\rho_i^{\\mathrm{meas}} E_n^{\\dagger}}$. The gate-process fidelity is finally calculated through $F = Tr (\\chi_{\\mathrm{exp}}\\chi_{\\mathrm{ideal}})$, where $\\chi_{\\mathrm{ideal}}$ is the ideal process matrix for the corresponding gate.\n\n## Device Fabrication, Experimental Setup, and Device Parameters\nOur experimental device consists of three flux-tunable Xmon qubits ($Q_1, C, Q_2$) with the middle one $C$ serving as the tunable coupler. Fabrication of this sample includes three main steps: (1) aluminum deposition onto a $c$-plane sapphire substrate followed by photolithography and inductively coupled-plasma etching to define all the base wiring and resonators; (2) two photolithography processes, aluminum deposition, and wet etching to construct airbridges\u00a0[Unknown Author, \"Unknown Title\", ]; (3) e-beam lithography with two layer e-beam resists and double-angle aluminum deposition to make Josephson junctions. Airbridges are mainly used to connect segments of ground planes in order to reduce parasitic slotline modes. We also apply flux trapping holes (square holes of side length of 2\u00a0$\\mu$m) to reduce magnetic vortices loss\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nSchematic electrical circuit of the device.\n\n< g r a p h i c s >\n\nMeasurement setup. Our measurement circuit contains three AWGs (two Tek5014C and one Tek70002A), three signal generators, and other microwave components. The XY control pulses are generated from a signal generator modulated by the AWG. Flux pulses are generated directly from Tek5014C (for $Q_1$) and Tek70002A (for $Q_2$ and the coupler). Readout signal is amplified by a JPA at the base, a high-electron-mobility-transistor (HEMT) amplifier at 4K and two room-temperature amplifiers, and finally down-converted and digitized by an analog-to-digital converter (ADC).\n\nThe full parameters of the qubits and the coupler are shown in Table\u00a0<ref> with the coupling capacitances defined in Fig.\u00a0(Figure fig:DeviceSchematic). Our sample is measured in a dilution refrigerator with a base temperature about 20\u00a0mK, and the details of our measurement circuit are shown in Fig.\u00a0(Figure fig:experimentsetup). We use two XY control lines to manipulate the qubit states, three flux lines to modify the qubit and the coupler frequencies, and one input-output line to readout both qubits simultaneously. The XY control pulses are generated from a signal generator modulated by a four-channel arbitrary waveform generator (AWG), while flux pulses are directly generated from AWGs. Finally, a broadband Josephson parametric amplifier (JPA)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] is used for high-fidelity simultaneous single-shot readout.\n\nDerivative removal adiabatic gate (DRAG)\u00a0[Unknown Author, \"Unknown Title\", ] pulse is used for single qubit rotation to reduce the leakage to higher qubit levels. Due to thermal population of the qubits and the coupler, and nonperfect separation of the ground and excited states for each qubit, the qubit readout results are reconstructed by using Bayes' rule with a calibration matrix:\n\n${\\rm M}_{{\\rm B}j}$=\n$\\left(\\begin{tabular}{cc}\n$F_gj$ & $1-F_ej$\\\\\n$1-F_gj$ & $F_ej$\\\\\n\\end{tabular}\\right)$\n,\n\nwhere ${\\rm F}_{{\\rm g}j}$ and ${\\rm F}_{{\\rm e}j}$ are the readout fidelity for the $j$-th ($j=1,2$) qubit in the initial steady state without and with a following $\\pi$ rotation respectively. The calibration process is similar to that in Ref.\u00a0Li2018.\n\nBesides, we measure the flux-line-crosstalk matrix $M_z$ among the flux control lines (both qubits and the coupler) in the device. Although there is no readout cavity for the coupler, the coupler frequency can still be measured through the qubit-coupler dispersive shift (discussed below). The inverse of $M_z$ gives the orthogonalization matrix $\\widetilde{M}_z$ which allows for independent control of the only desired qubit or the coupler:\n\n$\\widetilde{M}_z$=$M_z^{-1}$=\n$\\left(\\begin{tabular}{cccc}\n0.9963 & 0.0096 & 0.0264  \\\\\n$-0.0798$ & 0.9997  & 0.0094   \\\\\n$-0.0116$ & 0.0384  & 0.9974  \\\\\n\\end{tabular}\\right)$\n\nThe small flux-line-crosstalk is due to the good ground-plane connection by using airbridges even though the coupler is geometrically close to the two qubits.\n\nDevice parameters.\n\nQubit parameter    $Q_1$     $Q_2$ Readout resonator frequency (GHz)    $6.825$    $6.864$\n\nQubit maximum frequency (GHz)    $4.961$    $4.926$\n\n$T_1$ (sweet point) ($\\mu$s)    $14$    $13.7$\n\n$T_2$ (sweet point) ($\\mu$s)    $8.4$    $4$\n\n$T_{2E}$ (sweet point) ($\\mu$s)    $8.7$    $4.4$\n\n$\\eta/2\\pi$ (MHz)    $-206$    $-202$ $\\chi_{qr}/2\\pi$ (MHz)    $-0.4$    $-0.4$ $g_{qr}/2\\pi$ (MHz)    $86.6$    $90.6$       Coupler parameter    Simulation     Experiment\n\n$\\eta_c/2\\pi$ (MHz)    $-254$\n\n$C_{ic} (i=1,2)$ (fF)    $2.4$\n\n$C_{12}$ (fF)   $0.13$\n\nCoupler frequency (GHz)    $6.3$    $5.977$\n\n$g_{ic}/2\\pi$ (i=1,2) (MHz)    $81.3$    76.9 $g_{12}/2\\pi$ (MHz)    $3.8$    6.74\n\n## More Measurement Results\n### Coupler spectrum and qubit-coupler coupling strength\nIn our experiments, due to the lack of the readout resonator for the coupler, we cannot directly detect the coupler's thermal population and spectrum. Here, we just simply assume a similar thermal population for both the coupler and the computational qubits. We can, however, indirectly probe the coupler spectrum via the qubit-coupler dispersive shift, by driving the coupler with the XY control line of $Q_1$ followed by a population measurement of $Q_2$. The coupling between each qubit and the coupler causes a dispersive frequency shift when they are far detuned as:\n$$\n\\label{Eq13}\n\\begin{split}\n\\chi_{ic}=\\frac{(g_{ic})^2(\\eta_i+\\eta_c)}{2(\\Delta_{ic}-\\eta_c)(\\Delta_{ic}+\\eta_i)}.\n\\end{split}\n\n$$\nThe experimental results of coupler spectrum are shown in Fig.\u00a0(Figure fig:CouplerSpectrum).\n\nThe qubit-coupler dispersive shift may also decrease the single-qubit gate fidelity when the coupler has a large thermal population. However, in our experiments, the single-qubit gate is implemented when the frequency detuning is large between the qubits and the coupler. Thus, the coupler's thermal population would have little effect on the single-qubit gate fidelity and overall system preparation. In addition, we believe, through carefully designing our sample and fridge environment, the coupler thermal population can be suppressed to a very low level.\n\n< g r a p h i c s >\n\nMeasured coupler spectrum. We drive the coupler through the XY control line of $Q_1$ by applying a microwave pulse at variable frequency with a rectangular envelope of a duration of 500\u00a0ns, followed by a population measurement of $Q_2$ with a wide selective Gaussian pulse. Inset: schematic of the measurement. The two computational qubits ($Q_1$ and $Q_2$) are shown in blue and green respectively, and the coupler is shown in purple.\n\n< g r a p h i c s >\n\nQubit-coupler anti-crossing. At the resonance point, anti-crossing of the energy level is observed and the separation characterizes the coupling strength.\n\n< g r a p h i c s >\n\nLower threshold for the coupler frequency. (a) The pulse sequences to measure the operation range with negative coupling strength. (b) A zoomed-in part of Fig.\u00a0(Figure fig:Fig2)(b) in the main text. The swap interaction is completely turned off at the marked dark dashed line, while the red dashed line indicates the approximate threshold for non-negligible excitation of the coupler. (c) Direct leakage experiment for finding the approximate threshold of the coupler frequency. The two qubits are initialized in $\\ket{11}$, then are tuned into resonance while varying the coupler frequency, and finally the population of $\\ket{11}$ state is measured. The red dashed line shows the threshold of having leakage out of the computational space.\n\nThe coupling strength between each qubit and the coupler can be measured in a swap operation between them. We perform the qubit spectroscopy measurement while varying the coupler frequency and biasing the other qubit far away. The anti-crossing in the spectrum can be seen as shown in Fig.\u00a0(Figure fig:QubitCouplerAntiCrossing) and  the qubit-coupler coupling strength $g_{1c}$ can be extracted.\n\n### Operation range with negative coupling strength\nTo perform the iSWAP and $\\rm \\sqrt{iSWAP}$ gates, we need to choose an appropriate coupling strength by varying the coupler frequency when the two qubits are tuned into resonance. To tune the qubit and the coupler, we use fast rectangular flux pulses for the measurements shown in Fig.\u00a0(Figure fig:Fig3) in the main text.\n\nIn order to achieve fast two-qubit gate operations, the coupling strength needs to be large. The positive coupling strength is defined and limited by the geometry of the device, while the negative value can be varied by tuning the coupler frequency. However, the coupler frequency cannot be tuned too closed to the qubit frequency for a large negative coupling strength without causing direct energy exchange between the qubit and the coupler, i.e. the leakage out of the computational space. Figure\u00a0(Figure fig:CouplerThreshold)(b) is a zoom-in and finer sweep of  Fig.\u00a0(Figure fig:Fig2)(b) of the main text. The red dashed line shows an approximate threshold, a lower threshold for the coupler frequency, below which small ripples in the population oscillation of $Q_2$ start to show up, indicating non-negligible excitation of the coupler. The leakage out of the computational space can also be directly measured by monitoring the population of $\\ket{11}$ state when both qubits are excited. The experimental results are shown in Fig.\u00a0(Figure fig:CouplerThreshold)(c). Again, below the threshold of the coupler frequency, the population of $\\ket{11}$ state starts to deviate from the desired exponential decay. The experimental sequences for the measurements performed in Figs.\u00a0(Figure fig:CouplerThreshold)(b) and (Figure fig:CouplerThreshold)(c) are shown in Fig.\u00a0(Figure fig:CouplerThreshold)(a).\n\n< g r a p h i c s >\n\nQubit coherence times vs coupler frequency. When the coupler frequency is above the threshold for non-negligible excitation of the coupler, the qubit coherence times remain nearly unaffected. Three specific coupling strengths are marked by the black arrows.\n\n### Qubit coherence\nOne of the advantages of this prototype of coupler is the flexibility and compatibility to a large-scale architecture. The positive coupling strength is defined by the direct coupling between the two Xmon qubits, while the negative coupling is provided by the coupler. The competition between the positive direct and negative indirect coupling allows for a continuous tunability and for switching off the coupling completely. The change of sign of the coupling strength could also provide a valuable degree of freedom for future quantum simulation applications.\n\nBesides, this coupler scheme can also have little impact on the qubit coherence through careful design, although the coupler is capacitively coupled to both qubits and may offer an additional decay channel to the qubits. In addition, the coupler flux bias line may inductively couple to the qubits and affect their coherence. We measure the qubit coherence times at different coupler frequencies, as shown in Fig.\u00a0(Figure fig:QubitCoherence). In the operation range above the threshold, the qubit coherence times remain unaffected regardless of the coupling strength.\n\n< g r a p h i c s >\n\nThe CZ gate calibration. (a) The experimental sequences to measure $\\phi_{10}$, phase accumulation of $\\ket{01}$ with respect to $\\ket{00}$, and $\\phi_{11}$, phase accumulation of $\\ket{11}$ with respect to $\\ket{10}$. (b) The probabilities of measuring $\\ket{01}$ and $\\ket{11}$ vs the phase of the second $\\pi/2$ pulse. The sinusoidal oscillations reveal the phases acquired in the Ramsey measurements for the two-qubit states $\\ket{01}\\rightarrow e^{i\\phi_{01}}\\ket{01}$ and $\\ket{11}\\rightarrow e^{i\\phi_{11}}\\ket{11}$, respectively. The solid lines are fits to sinusoidal oscillations. With a standard CZ gate time of $t_R$=222\u00a0ns, a $\\pi$ phase shift between the orange and green curves is observed.\n\n### Calibration of the CZ gate\nWe first show the calibration of the standard CZ gate implemented by using rectangular flux pulses. We conduct the Ramsey measurements to extract the single qubit phase $\\phi_{01}$ and the two-qubit conditional phase $\\phi_{11}$, as shown in Fig.\u00a0(Figure fig:CZcalibration)(b). The solid lines are fits to sinusoidal oscillations. A $\\pi$ phase shift between $\\phi_{01}$ and $\\phi_{11}$ curves is observed when both qubits are excited.  We correct the single-qubit phases in software to acquire the desired CZ gate with the unitary matrix as diag$\\{1, 1, 1,-1\\}$. The CZ gate fidelity is estimated to be 95.5\n\n## Simulation of the CZ gate\n< g r a p h i c s >\n\nSimulation of the population evolution of each state during the CZ gate with an initial joint qubit-coupler state $\\ket{Q_1CQ_2}=\\ket{+0+}$. (a) CZ gate with rectangular flux pulses. (b) CZ gate with DDR.\n\nWe simulate the CZ gates with QuTip in Python\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. First, we confirm the coupler decoherence has little effect on the CZ gates. The coupler frequency can be tuned in a large range. If the coupler frequency is far detuned from its sweet spot, the dephasing of the coupler will increase significantly. We compare the CZ gate fidelities for two cases in which the coupler dephasing time $T_2= 5~\\mu$s and $T_2=0.5~\\mu$s, and find there is nearly no difference between them. This is because the coupler remains almost on the ground state for the whole process.\n\nWe then simulate the standard CZ gate implemented by the rectangular flux pulse (with `mesolve' in QuTip). The population evolution of each state with an initial state $\\ket{Q_1CQ_2}=\\ket{+0+}$ is shown in Fig.\u00a0(Figure fig:CZsimulation)(a), where $\\ket{+}=(\\ket{g}+\\ket{e})/\\sqrt{2}$. In this case, the coupler frequency is tuned to 5.337\u00a0GHz and the total qubit-qubit coupling is negative. We observe significant high-frequency oscillation between $\\ket{101}$ and $\\ket{200}$. This non-ideality comes from the population exchange between the coupler and the qubit, evidenced by the oscillation between $\\ket{010}$ and $\\ket{100}$. The swap oscillation between $\\ket{001}$ and $\\ket{100}$ is owing to the anharmonicity of the qubits. After a synchronization optimization strategy\u00a0[Unknown Author, \"Unknown Title\", ], we can achieve the fidelity of this type of CZ gate $F=98.75\\%$ in 90\u00a0ns with no system coherence.\n\nAs a comparison, the population evolution of each state for the CZ gate with the DDR scheme with the same initial state $\\ket{Q_1CQ_2}=\\ket{+0+}$ and with the same solving methods is shown in Fig.\u00a0(Figure fig:CZsimulation)(b). In this simulation, the gate time is 120\u00a0ns including DDR. The oscillation amplitude between the coupler and $Q_1$ decreases significantly when the coupler is turned on. If we use a slower cosine rising edge, the oscillation amplitude gets even smaller, but at the cost of a longer operation time. Most importantly, when we slowly turn off the coupler by tuning up the coupler frequency, the swap oscillation between the coupler and $Q_1$ gets much weaker, so the population of the coupler would slowly oscillate back into the computational space.\n\nBased on simulation, this CZ gate fidelity could be as high as $F=99.998\\%$ after careful synchronization optimization strategy\u00a0[Unknown Author, \"Unknown Title\", ], provided there is no system decoherence. Given the experimental coherence times, a simulated CZ gate fidelity $F=98.1\\%$ is acquired, in good agreement with the measured $F=98.3\\pm0.6\\%$ in the main text. In fact, such variations of the experimental gate fidelity are mainly due to two reasons. First, in our experiment, the measured histogram threshold between the ground state and the excited state of each qubit could fluctuate with time due to low frequency drift in the measurement setup. Following the Bayes rule calibration method (details can be found in Appendix C), we would acquire a measurement fluctuation distribution, and thus a variation of the gate fidelity. Second, the coherence of each qubit also varies with time. On one hand, this can affect the gate performance and thus lead to a fluctuating CZ gate fidelity; on the other hand, the simulated gate fidelity sensitively depends on the coherence times we use. Our simulation shows that the CZ gate fidelity can be improved from F = 98.1\n\nIn addition, we also follow the method developed in Ref.\u00a0korotkov2013 to extract error sources in our experimental CZ gate. We find that the decoherence error is the main error source with a contribution of about 1.14\n\nBecause of the unwanted transitions, we could not acquire a complete geometric $\\pi$ phase for the CZ gate with DDR. The simulation shows the geometric contribution to the $\\pi$ phase is about 98.3\n\nWith the extra degree of freedom provided by the tunable coupler, a more efficient pulse shape could be optimized to achieve a CZ gate with a higher fidelity and lower unwanted leakage in future experiments. This deserves future exploration.\n\n75\nfxundefined [1]\nifx#1\n\nfnum [1]\n#1firstoftwo\nsecondoftwo\n\nfx [1]\n#1firstoftwo\nsecondoftwo\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12\\catcode\n`\\&12\\catcode `\\#12\\catcode `\\^12\\catcode `\\_12\\catcode `\\%12\\relax}%\n\\providecommand \\@@startlink[1]{}%\n\\providecommand \\@@endlink[0]{}%\n\\providecommand \\url  [0]{\\begingroup\\@sanitize@url \\@url }%\n\\providecommand \\@url [1]{\\endgroup\\@href {#1}{\\urlprefix }}%\n\\providecommand \\urlprefix  [0]{URL }%\n\\providecommand \\Eprint [0]{\\href }%\n\\providecommand \\doibase [0]{http://dx.doi.org/}%\n\\providecommand \\selectlanguage [0]{\\@gobble}%\n\\providecommand \\bibinfo  [0]{\\@secondoftwo}%\n\\providecommand \\bibfield  [0]{\\@secondoftwo}%\n\\providecommand \\translation [1]{[#1]}%\n\\providecommand \\BibitemOpen [0]{}%\n\\providecommand \\bibitemStop [0]{}%\n\\providecommand \\bibitemNoStop [0]{.\\EOS\\space}%\n\\providecommand \\EOS [0]{\\spacefactor3000\\relax}%\n\\providecommand \\BibitemShut  [1]{\\csname bibitem#1\\endcsname}%\n\\let\\auto@bib@innerbib\\@empty\n%</preamble>\n\\bibitem [{\\citenamefont {Otterbach}\\ \\emph {et~al.}(2017)\\citenamefont\n{Otterbach}, \\citenamefont {Manenti}, \\citenamefont {Alidoust}, \\citenamefont\n{Bestwick}, \\citenamefont {Block}, \\citenamefont {Bloom}, \\citenamefont\n{Caldwell}, \\citenamefont {Didier}, \\citenamefont {Fried}, \\citenamefont\n{Hong} \\emph {et~al.}}]{Otterbach2017}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~S.}\\ \\bibnamefont\n{Otterbach}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Manenti}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Alidoust}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Bestwick}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Block}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Bloom}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Caldwell}}, \\bibinfo {author} {\\bibfnamefont\n{N.}~\\bibnamefont {Didier}}, \\bibinfo {author} {\\bibfnamefont {E.~S.}\\\n\\bibnamefont {Fried}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n{Hong}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Unsupervised machine learning on a hybrid quantum computer},}\\ }\\href\n{https://arxiv.org/abs/1712.05771} {\\bibfield  {journal} {\\bibinfo  {journal}\n{arXiv:1712.05771}\\ } (\\bibinfo {year} {2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kandala}\\ \\emph {et~al.}(2017)\\citenamefont\n{Kandala}, \\citenamefont {Mezzacapo}, \\citenamefont {Temme}, \\citenamefont\n{Takita}, \\citenamefont {Brink}, \\citenamefont {Chow},\\ and\\ \\citenamefont\n{Gambetta}}]{Kandala2017}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Kandala}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Mezzacapo}},\n\\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Temme}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Takita}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Brink}}, \\bibinfo {author} {\\bibfnamefont\n{J.~M.}\\ \\bibnamefont {Chow}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n{J.~M.}\\ \\bibnamefont {Gambetta}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo\n{title} {Hardware-efficient variational quantum eigensolver for small\nmolecules and quantum magnets},}\\ }\\href\n{https://www.nature.com/articles/nature238792} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {549}},\\ \\bibinfo\n{pages} {242} (\\bibinfo {year} {2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Arute}\\ \\emph {et~al.}(2019)\\citenamefont {Arute},\n\\citenamefont {Arys}, \\citenamefont {Babbush}, \\citenamefont {Bacon},\n\\citenamefont {Bardin}, \\citenamefont {Barends}, \\citenamefont {Biswas},\n\\citenamefont {Boixo}, \\citenamefont {Brandao}, \\citenamefont {Buell} \\emph\n{et~al.}}]{Google2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Arute}}, \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Arys}},\n\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Babbush}}, \\bibinfo\n{author} {\\bibfnamefont {D.}~\\bibnamefont {Bacon}}, \\bibinfo {author}\n{\\bibfnamefont {J.~C.}\\ \\bibnamefont {Bardin}}, \\bibinfo {author}\n{\\bibfnamefont {R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Biswas}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Boixo}}, \\bibinfo {author} {\\bibfnamefont {F.~G. S.~L.}\\\n\\bibnamefont {Brandao}}, \\bibinfo {author} {\\bibfnamefont {D.~A.}\\\n\\bibnamefont {Buell}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Quantum supremacy using a programmable superconducting\nprocessor},}\\ }\\href {https://www.nature.com/articles/s41586-019-1666-5}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo\n{volume} {574}},\\ \\bibinfo {pages} {505} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Song}\\ \\emph {et~al.}(2019)\\citenamefont {Song},\n\\citenamefont {Xu}, \\citenamefont {Li}, \\citenamefont {Zhang}, \\citenamefont\n{Zhang}, \\citenamefont {Liu}, \\citenamefont {Guo}, \\citenamefont {Wang},\n\\citenamefont {Ren}, \\citenamefont {Hao} \\emph {et~al.}}]{Song2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Song}}, \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Xu}}, \\bibinfo\n{author} {\\bibfnamefont {H.}~\\bibnamefont {Li}}, \\bibinfo {author}\n{\\bibfnamefont {Y.-R.}\\ \\bibnamefont {Zhang}}, \\bibinfo {author}\n{\\bibfnamefont {X.}~\\bibnamefont {Zhang}}, \\bibinfo {author} {\\bibfnamefont\n{W.}~\\bibnamefont {Liu}}, \\bibinfo {author} {\\bibfnamefont {Q.}~\\bibnamefont\n{Guo}}, \\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont {Wang}}, \\bibinfo\n{author} {\\bibfnamefont {W.}~\\bibnamefont {Ren}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Hao}},  \\emph {et~al.},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Generation of multicomponent atomic\nschr{\\\"o}dinger cat states of up to 20 qubits},}\\ }\\href {\\doibase\n10.1126/science.aay0600} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Science}\\ }\\textbf {\\bibinfo {volume} {365}},\\ \\bibinfo {pages} {574}\n(\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Yan}\\ \\emph {et~al.}(2019)\\citenamefont {Yan},\n\\citenamefont {Zhang}, \\citenamefont {Gong}, \\citenamefont {Wu},\n\\citenamefont {Zheng}, \\citenamefont {Li}, \\citenamefont {Wang},\n\\citenamefont {Liang}, \\citenamefont {Lin}, \\citenamefont {Xu} \\emph\n{et~al.}}]{Yan2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont\n{Yan}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Zhang}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Gong}}, \\bibinfo {author}\n{\\bibfnamefont {Y.}~\\bibnamefont {Wu}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Zheng}}, \\bibinfo {author} {\\bibfnamefont\n{S.}~\\bibnamefont {Li}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Wang}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Liang}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Lin}}, \\bibinfo {author}\n{\\bibfnamefont {Y.}~\\bibnamefont {Xu}},  \\emph {et~al.},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Strongly correlated quantum walks with a\n12-qubit superconducting processor},}\\ }\\href\n{https://science.sciencemag.org/content/364/6442/753} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Science}\\ }\\textbf {\\bibinfo {volume} {364}},\\ \\bibinfo\n{pages} {753} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Ma}\\ \\emph {et~al.}(2019)\\citenamefont {Ma},\n\\citenamefont {Saxberg}, \\citenamefont {Owens}, \\citenamefont {Leung},\n\\citenamefont {Lu}, \\citenamefont {Simon},\\ and\\ \\citenamefont\n{Schuster}}]{Ma2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Ma}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Saxberg}},\n\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Owens}}, \\bibinfo\n{author} {\\bibfnamefont {N.}~\\bibnamefont {Leung}}, \\bibinfo {author}\n{\\bibfnamefont {Y.}~\\bibnamefont {Lu}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Simon}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {D.~I.}\\\n\\bibnamefont {Schuster}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {A\ndissipatively stabilized mott insulator of photons},}\\ }\\href\n{https://www.nature.com/articles/s41586-019-0897-9} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {566}},\\ \\bibinfo\n{pages} {51} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Koll{\\'a}r}\\ \\emph {et~al.}(2019)\\citenamefont\n{Koll{\\'a}r}, \\citenamefont {Fitzpatrick},\\ and\\ \\citenamefont\n{Houck}}]{Kollar2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~J.}\\ \\bibnamefont\n{Koll{\\'a}r}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Fitzpatrick}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont\n{Houck}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {Hyperbolic\nlattices in circuit quantum electrodynamics},}\\ }\\href\n{https://www.nature.com/articles/s41586-019-1348-3} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {571}},\\ \\bibinfo\n{pages} {45} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Andersen}\\ \\emph {et~al.}(2019)\\citenamefont\n{Andersen}, \\citenamefont {Remm}, \\citenamefont {Lazar}, \\citenamefont\n{Krinner}, \\citenamefont {Lacroix}, \\citenamefont {Norris}, \\citenamefont\n{Gabureac}, \\citenamefont {Eichler},\\ and\\ \\citenamefont\n{Wallraff}}]{andersen2019repeated}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~K.}\\ \\bibnamefont\n{Andersen}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Remm}},\n\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Lazar}}, \\bibinfo\n{author} {\\bibfnamefont {S.}~\\bibnamefont {Krinner}}, \\bibinfo {author}\n{\\bibfnamefont {N.}~\\bibnamefont {Lacroix}}, \\bibinfo {author} {\\bibfnamefont\n{G.~J.}\\ \\bibnamefont {Norris}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Gabureac}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Eichler}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Wallraff}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo\n{title} {Repeated quantum error detection in a surface code},}\\ }\\href\n{https://arxiv.org/abs/1912.09410} {\\bibfield  {journal} {\\bibinfo  {journal}\n{arXiv:1912.09410}\\ } (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Buluta}\\ and\\ \\citenamefont\n{Nori}(2009)}]{Buluta2009}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {I.}~\\bibnamefont\n{Buluta}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\\n}\\bibfield  {title} {\\enquote {\\bibinfo {title} {Quantum simulators},}\\\n}\\href {\\doibase 10.1126/science.1177838} {\\bibfield  {journal} {\\bibinfo\n{journal} {Science}\\ }\\textbf {\\bibinfo {volume} {326}},\\ \\bibinfo {pages}\n{108} (\\bibinfo {year} {2009})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Houck}\\ \\emph {et~al.}(2012)\\citenamefont {Houck},\n\\citenamefont {T{\\\"u}reci},\\ and\\ \\citenamefont {Koch}}]{Houck2012}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont\n{Houck}}, \\bibinfo {author} {\\bibfnamefont {H.~E.}\\ \\bibnamefont\n{T{\\\"u}reci}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Koch}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {On-chip quantum\nsimulation with superconducting circuits},}\\ }\\href {\\doibase\n10.1038/nphys2251} {\\bibfield  {journal} {\\bibinfo  {journal} {Nat. Phys.}\\\n}\\textbf {\\bibinfo {volume} {8}},\\ \\bibinfo {pages} {292} (\\bibinfo {year}\n{2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Georgescu}\\ \\emph {et~al.}(2014)\\citenamefont\n{Georgescu}, \\citenamefont {Ashhab},\\ and\\ \\citenamefont\n{Nori}}]{Georgescu2014}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {I.~M.}\\ \\bibnamefont\n{Georgescu}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Ashhab}}, \\\nand\\ \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Quantum simulation},}\\ }\\href {\\doibase\n10.1103/RevModPhys.86.153} {\\bibfield  {journal} {\\bibinfo  {journal} {Rev.\nMod. Phys.}\\ }\\textbf {\\bibinfo {volume} {86}},\\ \\bibinfo {pages} {153}\n(\\bibinfo {year} {2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Devoret}\\ and\\ \\citenamefont\n{Schoelkopf}(2013)}]{Devoret2013}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~H.}\\ \\bibnamefont\n{Devoret}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\ \\bibnamefont\n{Schoelkopf}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{{Superconducting circuits for quantum information: an outlook.}}}\\ }\\href\n{\\doibase 10.1126/science.1231930} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Science}\\ }\\textbf {\\bibinfo {volume} {339}},\\ \\bibinfo {pages} {1169}\n(\\bibinfo {year} {2013})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Campbell}\\ \\emph {et~al.}(2017)\\citenamefont\n{Campbell}, \\citenamefont {Terhal},\\ and\\ \\citenamefont\n{Vuillot}}]{Campbell2017}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {E.~T.}\\ \\bibnamefont\n{Campbell}}, \\bibinfo {author} {\\bibfnamefont {B.~M.}\\ \\bibnamefont\n{Terhal}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Vuillot}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {{Roads towards\nfault-tolerant universal quantum computation}},}\\ }\\href {\\doibase\n10.1038/nature23460} {\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\\n}\\textbf {\\bibinfo {volume} {549}},\\ \\bibinfo {pages} {172} (\\bibinfo {year}\n{2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Majer}\\ \\emph {et~al.}(2007)\\citenamefont {Majer},\n\\citenamefont {Chow}, \\citenamefont {Gambetta}, \\citenamefont {Koch},\n\\citenamefont {Johnson}, \\citenamefont {Schreier}, \\citenamefont {Frunzio},\n\\citenamefont {Schuster}, \\citenamefont {Houck}, \\citenamefont {Wallraff}\n\\emph {et~al.}}]{Majer2007}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Majer}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo\n{author} {\\bibfnamefont {J.}~\\bibnamefont {Koch}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {J.~A.}\\ \\bibnamefont {Schreier}}, \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont\n{D.~I.}\\ \\bibnamefont {Schuster}}, \\bibinfo {author} {\\bibfnamefont {A.~A.}\\\n\\bibnamefont {Houck}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Wallraff}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo\n{title} {Coupling superconducting qubits via a cavity bus},}\\ }\\href\n{https://www.nature.com/articles/nature06184} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {449}},\\ \\bibinfo {pages}\n{443} (\\bibinfo {year} {2007})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {DiCarlo}\\ \\emph {et~al.}(2009)\\citenamefont\n{DiCarlo}, \\citenamefont {Chow}, \\citenamefont {Gambetta}, \\citenamefont\n{Bishop}, \\citenamefont {Johnson}, \\citenamefont {Schuster}, \\citenamefont\n{Majer}, \\citenamefont {Blais}, \\citenamefont {Frunzio}, \\citenamefont\n{Girvin} \\emph {et~al.}}]{DiCarlo2009}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{DiCarlo}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo\n{author} {\\bibfnamefont {L.~S.}\\ \\bibnamefont {Bishop}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {D.~I.}\\ \\bibnamefont {Schuster}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Majer}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Blais}}, \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\\n\\bibnamefont {Girvin}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Demonstration of two-qubit algorithms with a\nsuperconducting quantum processor},}\\ }\\href\n{https://www.nature.com/articles/nature08121} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {460}},\\ \\bibinfo {pages}\n{240} (\\bibinfo {year} {2009})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kelly}\\ \\emph {et~al.}(2015)\\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Fowler}, \\citenamefont {Megrant},\n\\citenamefont {Jeffrey}, \\citenamefont {White}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {Campbell}, \\citenamefont {Chen} \\emph\n{et~al.}}]{Kelly2015}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Kelly}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Barends}},\n\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont {Fowler}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{T.~C.}\\ \\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {J.~Y.}\\\n\\bibnamefont {Mutus}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Campbell}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}},\n\\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {{State\npreservation by repetitive error detection in a superconducting quantum\ncircuit}},}\\ }\\href {\\doibase 10.1038/nature14270} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {519}},\\ \\bibinfo\n{pages} {66} (\\bibinfo {year} {2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chow}\\ \\emph {et~al.}(2011)\\citenamefont {Chow},\n\\citenamefont {C\\'orcoles}, \\citenamefont {Gambetta}, \\citenamefont\n{Rigetti}, \\citenamefont {Johnson}, \\citenamefont {Smolin}, \\citenamefont\n{Rozen}, \\citenamefont {Keefe}, \\citenamefont {Rothwell}, \\citenamefont\n{Ketchen} \\emph {et~al.}}]{Chow2011}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Chow}}, \\bibinfo {author} {\\bibfnamefont {A.~D.}\\ \\bibnamefont\n{C\\'orcoles}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Gambetta}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Rigetti}},\n\\bibinfo {author} {\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo\n{author} {\\bibfnamefont {J.~A.}\\ \\bibnamefont {Smolin}}, \\bibinfo {author}\n{\\bibfnamefont {J.~R.}\\ \\bibnamefont {Rozen}}, \\bibinfo {author}\n{\\bibfnamefont {G.~A.}\\ \\bibnamefont {Keefe}}, \\bibinfo {author}\n{\\bibfnamefont {M.~B.}\\ \\bibnamefont {Rothwell}}, \\bibinfo {author}\n{\\bibfnamefont {M.~B.}\\ \\bibnamefont {Ketchen}},  \\emph {et~al.},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Simple all-microwave entangling gate\nfor fixed-frequency superconducting qubits},}\\ }\\href {\\doibase\n10.1103/PhysRevLett.107.080502} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {107}},\\ \\bibinfo {pages}\n{080502} (\\bibinfo {year} {2011})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Sheldon}\\ \\emph {et~al.}(2016)\\citenamefont\n{Sheldon}, \\citenamefont {Magesan}, \\citenamefont {Chow},\\ and\\ \\citenamefont\n{Gambetta}}]{Sheldon2016}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont\n{Sheldon}}, \\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Magesan}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}},\\\n}\\bibfield  {title} {\\enquote {\\bibinfo {title} {Procedure for systematically\ntuning up cross-talk in the cross-resonance gate},}\\ }\\href {\\doibase\n10.1103/PhysRevA.93.060302} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. A}\\ }\\textbf {\\bibinfo {volume} {93}},\\ \\bibinfo {pages} {060302}\n(\\bibinfo {year} {2016})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Zhou}\\ \\emph {et~al.}(2009)\\citenamefont {Zhou},\n\\citenamefont {Yang}, \\citenamefont {Liu}, \\citenamefont {Sun},\\ and\\\n\\citenamefont {Nori}}]{Zhou2009}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Zhou}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Yang}}, \\bibinfo\n{author} {\\bibfnamefont {Y.-x.}\\ \\bibnamefont {Liu}}, \\bibinfo {author}\n{\\bibfnamefont {C.~P.}\\ \\bibnamefont {Sun}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Quantum zeno switch for single-photon coherent\ntransport},}\\ }\\href {\\doibase 10.1103/PhysRevA.80.062109} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume}\n{80}},\\ \\bibinfo {pages} {062109} (\\bibinfo {year} {2009})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Strand}\\ \\emph {et~al.}(2013)\\citenamefont {Strand},\n\\citenamefont {Ware}, \\citenamefont {Beaudoin}, \\citenamefont {Ohki},\n\\citenamefont {Johnson}, \\citenamefont {Blais},\\ and\\ \\citenamefont\n{Plourde}}]{Strand2013}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~D.}\\ \\bibnamefont\n{Strand}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Ware}},\n\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Beaudoin}}, \\bibinfo\n{author} {\\bibfnamefont {T.~A.}\\ \\bibnamefont {Ohki}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Blais}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {B.~L.~T.}\\ \\bibnamefont {Plourde}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {First-order sideband transitions with\nflux-driven asymmetric transmon qubits},}\\ }\\href {\\doibase\n10.1103/PhysRevB.87.220505} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. B}\\ }\\textbf {\\bibinfo {volume} {87}},\\ \\bibinfo {pages} {220505}\n(\\bibinfo {year} {2013})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Liu}\\ \\emph {et~al.}(2014)\\citenamefont {Liu},\n\\citenamefont {Wang}, \\citenamefont {Sun},\\ and\\ \\citenamefont\n{Wang}}]{Liu2014}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.~X.}\\ \\bibnamefont\n{Liu}}, \\bibinfo {author} {\\bibfnamefont {C.~X.}\\ \\bibnamefont {Wang}},\n\\bibinfo {author} {\\bibfnamefont {H.~C.}\\ \\bibnamefont {Sun}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {X.~B.}\\ \\bibnamefont {Wang}},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Coexistence of single- and multi-photon\nprocesses due to longitudinal couplings between superconducting flux qubits\nand external fields},}\\ }\\href\n{https://iopscience.iop.org/article/10.1088/1367-2630/16/1/015031} {\\bibfield\n{journal} {\\bibinfo  {journal} {New J. Phys.}\\ }\\textbf {\\bibinfo {volume}\n{16}},\\ \\bibinfo {pages} {015031} (\\bibinfo {year} {2014})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Xue}\\ \\emph {et~al.}(2015)\\citenamefont {Xue},\n\\citenamefont {Zhou},\\ and\\ \\citenamefont {Wang}}]{Xue2015}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Z.-Y.}\\ \\bibnamefont\n{Xue}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Zhou}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {Z.~D.}\\ \\bibnamefont {Wang}},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Universal holonomic quantum gates in\ndecoherence-free subspace on superconducting circuits},}\\ }\\href {\\doibase\n10.1103/PhysRevA.92.022320} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. A}\\ }\\textbf {\\bibinfo {volume} {92}},\\ \\bibinfo {pages} {022320}\n(\\bibinfo {year} {2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Wu}\\ \\emph {et~al.}(2018)\\citenamefont {Wu},\n\\citenamefont {Yang}, \\citenamefont {Zheng}, \\citenamefont {Deng},\n\\citenamefont {Yan}, \\citenamefont {Zhao}, \\citenamefont {Huang},\n\\citenamefont {Munro}, \\citenamefont {Nemoto}, \\citenamefont {Zheng} \\emph\n{et~al.}}]{Wu2016}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Wu}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Yang}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Zheng}}, \\bibinfo {author}\n{\\bibfnamefont {H.}~\\bibnamefont {Deng}}, \\bibinfo {author} {\\bibfnamefont\n{Z.}~\\bibnamefont {Yan}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Zhao}}, \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Huang}},\n\\bibinfo {author} {\\bibfnamefont {W.~J.}\\ \\bibnamefont {Munro}}, \\bibinfo\n{author} {\\bibfnamefont {K.}~\\bibnamefont {Nemoto}}, \\bibinfo {author}\n{\\bibfnamefont {D.}~\\bibnamefont {Zheng}},  \\emph {et~al.},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {An efficient and compact quantum switch\nfor quantum circuits},}\\ }\\href\n{https://www.nature.com/articles/s41534-018-0099-6} {\\bibfield  {journal}\n{\\bibinfo  {journal} {npj Quantum Information}\\ }\\textbf {\\bibinfo {volume}\n{4}},\\ \\bibinfo {pages} {50} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Caldwell}\\ \\emph {et~al.}(2018)\\citenamefont\n{Caldwell}, \\citenamefont {Didier}, \\citenamefont {Ryan}, \\citenamefont\n{Sete}, \\citenamefont {Hudson}, \\citenamefont {Karalekas}, \\citenamefont\n{Manenti}, \\citenamefont {da~Silva}, \\citenamefont {Sinclair}, \\citenamefont\n{Acala} \\emph {et~al.}}]{Caldwell2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.~A.}\\ \\bibnamefont\n{Caldwell}}, \\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Didier}},\n\\bibinfo {author} {\\bibfnamefont {C.~A.}\\ \\bibnamefont {Ryan}}, \\bibinfo\n{author} {\\bibfnamefont {E.~A.}\\ \\bibnamefont {Sete}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Hudson}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Karalekas}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Manenti}}, \\bibinfo {author} {\\bibfnamefont {M.~P.}\\\n\\bibnamefont {da~Silva}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Sinclair}}, \\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Acala}},\n\\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Parametrically activated entangling gates using transmon qubits},}\\ }\\href\n{\\doibase 10.1103/PhysRevApplied.10.034050} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Applied}\\ }\\textbf {\\bibinfo {volume} {10}},\\ \\bibinfo\n{pages} {034050} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Reagor}\\ \\emph {et~al.}(2018)\\citenamefont {Reagor},\n\\citenamefont {Osborn}, \\citenamefont {Tezak}, \\citenamefont {Staley},\n\\citenamefont {Prawiroatmodjo}, \\citenamefont {Scheer}, \\citenamefont\n{Alidoust}, \\citenamefont {Sete}, \\citenamefont {Didier}, \\citenamefont\n{da~Silva} \\emph {et~al.}}]{Reagor2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Reagor}}, \\bibinfo {author} {\\bibfnamefont {C.~B.}\\ \\bibnamefont {Osborn}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Tezak}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Staley}}, \\bibinfo {author}\n{\\bibfnamefont {G.}~\\bibnamefont {Prawiroatmodjo}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Scheer}}, \\bibinfo {author} {\\bibfnamefont\n{N.}~\\bibnamefont {Alidoust}}, \\bibinfo {author} {\\bibfnamefont {E.~A.}\\\n\\bibnamefont {Sete}}, \\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n{Didier}}, \\bibinfo {author} {\\bibfnamefont {M.~P.}\\ \\bibnamefont\n{da~Silva}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo\n{title} {Demonstration of universal parametric entangling gates on a\nmulti-qubit lattice},}\\ }\\href {\\doibase 10.1126/sciadv.aao3603} {\\bibfield\n{journal} {\\bibinfo  {journal} {Sci. Adv.}\\ }\\textbf {\\bibinfo {volume}\n{4}},\\ \\bibinfo {pages} {eaao3603} (\\bibinfo {year} {2018})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Li}\\ \\emph {et~al.}(2018)\\citenamefont {Li},\n\\citenamefont {Ma}, \\citenamefont {Han}, \\citenamefont {Chen}, \\citenamefont\n{Xu}, \\citenamefont {Cai}, \\citenamefont {Wang}, \\citenamefont {Song},\n\\citenamefont {Xue}, \\citenamefont {Yin} \\emph {et~al.}}]{Li2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont\n{Li}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Ma}}, \\bibinfo\n{author} {\\bibfnamefont {J.}~\\bibnamefont {Han}}, \\bibinfo {author}\n{\\bibfnamefont {T.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Xu}}, \\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont\n{Cai}}, \\bibinfo {author} {\\bibfnamefont {H.}~\\bibnamefont {Wang}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Song}}, \\bibinfo {author}\n{\\bibfnamefont {Z.-Y.}\\ \\bibnamefont {Xue}}, \\bibinfo {author} {\\bibfnamefont\n{Z.-q.}\\ \\bibnamefont {Yin}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Perfect quantum state transfer in a superconducting qubit\nchain with parametrically tunable couplings},}\\ }\\href {\\doibase\n10.1103/PhysRevApplied.10.054009} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Applied}\\ }\\textbf {\\bibinfo {volume} {10}},\\ \\bibinfo {pages}\n{054009} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chen}\\ and\\ \\citenamefont\n{Xue}(2018)}]{Chen2018Nonadiabatic}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont\n{Chen}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {Z.-Y.}\\ \\bibnamefont {Xue}},\\\n}\\bibfield  {title} {\\enquote {\\bibinfo {title} {Nonadiabatic geometric\nquantum computation with parametrically tunable coupling},}\\ }\\href {\\doibase\n10.1103/PhysRevApplied.10.054051} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Applied}\\ }\\textbf {\\bibinfo {volume} {10}},\\ \\bibinfo {pages}\n{054051} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Cai}\\ \\emph {et~al.}(2019)\\citenamefont {Cai},\n\\citenamefont {Han}, \\citenamefont {Mei}, \\citenamefont {Xu}, \\citenamefont\n{Ma}, \\citenamefont {Li}, \\citenamefont {Wang}, \\citenamefont {Song},\n\\citenamefont {Xue}, \\citenamefont {Yin} \\emph {et~al.}}]{Cai2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont\n{Cai}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Han}}, \\bibinfo\n{author} {\\bibfnamefont {F.}~\\bibnamefont {Mei}}, \\bibinfo {author}\n{\\bibfnamefont {Y.}~\\bibnamefont {Xu}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Ma}}, \\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont\n{Li}}, \\bibinfo {author} {\\bibfnamefont {H.}~\\bibnamefont {Wang}}, \\bibinfo\n{author} {\\bibfnamefont {Y.~P.}\\ \\bibnamefont {Song}}, \\bibinfo {author}\n{\\bibfnamefont {Z.-Y.}\\ \\bibnamefont {Xue}}, \\bibinfo {author} {\\bibfnamefont\n{Z.-q.}\\ \\bibnamefont {Yin}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Observation of topological magnon insulator states in a\nsuperconducting circuit},}\\ }\\href {\\doibase 10.1103/PhysRevLett.123.080501}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf\n{\\bibinfo {volume} {123}},\\ \\bibinfo {pages} {080501} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Xu}\\ \\emph {et~al.}(2020)\\citenamefont {Xu},\n\\citenamefont {Hua}, \\citenamefont {Chen}, \\citenamefont {Pan}, \\citenamefont\n{Li}, \\citenamefont {Han}, \\citenamefont {Cai}, \\citenamefont {Ma},\n\\citenamefont {Wang}, \\citenamefont {Song} \\emph {et~al.}}]{Xu2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Xu}}, \\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont {Hua}}, \\bibinfo\n{author} {\\bibfnamefont {T.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {X.}~\\bibnamefont {Pan}}, \\bibinfo {author} {\\bibfnamefont\n{X.}~\\bibnamefont {Li}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Han}}, \\bibinfo {author} {\\bibfnamefont {W.}~\\bibnamefont {Cai}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Ma}}, \\bibinfo {author}\n{\\bibfnamefont {H.}~\\bibnamefont {Wang}}, \\bibinfo {author} {\\bibfnamefont\n{Y.~P.}\\ \\bibnamefont {Song}},  \\emph {et~al.},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Experimental implementation of universal\nnonadiabatic geometric quantum gates in a superconducting circuit},}\\ }\\href\n{\\doibase 10.1103/PhysRevLett.124.230503} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {124}},\\ \\bibinfo\n{pages} {230503} (\\bibinfo {year} {2020})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Liu}\\ \\emph {et~al.}(2006)\\citenamefont {Liu},\n\\citenamefont {Wei}, \\citenamefont {Tsai},\\ and\\ \\citenamefont\n{Nori}}]{Liu2006}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.-X.}\\ \\bibnamefont\n{Liu}}, \\bibinfo {author} {\\bibfnamefont {L.~F.}\\ \\bibnamefont {Wei}},\n\\bibinfo {author} {\\bibfnamefont {J.~S.}\\ \\bibnamefont {Tsai}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\ }\\bibfield\n{title} {\\enquote {\\bibinfo {title} {Controllable coupling between flux\nqubits},}\\ }\\href {\\doibase 10.1103/PhysRevLett.96.067003} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo\n{volume} {96}},\\ \\bibinfo {pages} {067003} (\\bibinfo {year}\n{2006})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Niskanen}\\ \\emph {et~al.}(2007)\\citenamefont\n{Niskanen}, \\citenamefont {Harrabi}, \\citenamefont {Yoshihara}, \\citenamefont\n{Nakamura}, \\citenamefont {Lloyd},\\ and\\ \\citenamefont\n{Tsai}}]{Niskanen2007}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Niskanen}}, \\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Harrabi}},\n\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Yoshihara}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {Nakamura}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Lloyd}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Tsai}},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Quantum coherent tunable coupling of superconducting\nqubits},}\\ }\\href {https://science.sciencemag.org/content/316/5825/723}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Science}\\ }\\textbf {\\bibinfo\n{volume} {316}},\\ \\bibinfo {pages} {723} (\\bibinfo {year}\n{2007})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {van~der Ploeg}\\ \\emph {et~al.}(2007)\\citenamefont\n{van~der Ploeg}, \\citenamefont {Izmalkov}, \\citenamefont {van~den Brink},\n\\citenamefont {H\\\"ubner}, \\citenamefont {Grajcar}, \\citenamefont {Il'ichev},\n\\citenamefont {Meyer},\\ and\\ \\citenamefont {Zagoskin}}]{Ploeg2007}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {S.~H.~W.}\\\n\\bibnamefont {van~der Ploeg}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Izmalkov}}, \\bibinfo {author} {\\bibfnamefont {A.~M.}\\\n\\bibnamefont {van~den Brink}}, \\bibinfo {author} {\\bibfnamefont\n{U.}~\\bibnamefont {H\\\"ubner}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Grajcar}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Il'ichev}}, \\bibinfo {author} {\\bibfnamefont {H.-G.}\\\n\\bibnamefont {Meyer}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {A.~M.}\\\n\\bibnamefont {Zagoskin}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Controllable coupling of superconducting flux qubits},}\\ }\\href {\\doibase\n10.1103/PhysRevLett.98.057004} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {98}},\\ \\bibinfo {pages}\n{057004} (\\bibinfo {year} {2007})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Harris}\\ \\emph {et~al.}(2007)\\citenamefont {Harris},\n\\citenamefont {Berkley}, \\citenamefont {Johnson}, \\citenamefont {Bunyk},\n\\citenamefont {Govorkov}, \\citenamefont {Thom}, \\citenamefont {Uchaikin},\n\\citenamefont {Wilson}, \\citenamefont {Chung}, \\citenamefont {Holtham} \\emph\n{et~al.}}]{Harris2007}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Harris}}, \\bibinfo {author} {\\bibfnamefont {A.~J.}\\ \\bibnamefont {Berkley}},\n\\bibinfo {author} {\\bibfnamefont {M.~W.}\\ \\bibnamefont {Johnson}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Bunyk}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Govorkov}}, \\bibinfo {author}\n{\\bibfnamefont {M.~C.}\\ \\bibnamefont {Thom}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Uchaikin}}, \\bibinfo {author}\n{\\bibfnamefont {A.~B.}\\ \\bibnamefont {Wilson}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Chung}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Holtham}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Sign- and magnitude-tunable coupler for superconducting\nflux qubits},}\\ }\\href {\\doibase 10.1103/PhysRevLett.98.177001} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo\n{volume} {98}},\\ \\bibinfo {pages} {177001} (\\bibinfo {year}\n{2007})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Allman}\\ \\emph {et~al.}(2010)\\citenamefont {Allman},\n\\citenamefont {Altomare}, \\citenamefont {Whittaker}, \\citenamefont {Cicak},\n\\citenamefont {Li}, \\citenamefont {Sirois}, \\citenamefont {Strong},\n\\citenamefont {Teufel},\\ and\\ \\citenamefont {Simmonds}}]{Allman2010}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~S.}\\ \\bibnamefont\n{Allman}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Altomare}},\n\\bibinfo {author} {\\bibfnamefont {J.~D.}\\ \\bibnamefont {Whittaker}}, \\bibinfo\n{author} {\\bibfnamefont {K.}~\\bibnamefont {Cicak}}, \\bibinfo {author}\n{\\bibfnamefont {D.}~\\bibnamefont {Li}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Sirois}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Strong}}, \\bibinfo {author} {\\bibfnamefont {J.~D.}\\\n\\bibnamefont {Teufel}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~W.}\\\n\\bibnamefont {Simmonds}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{rf-squid-mediated coherent tunable coupling between a superconducting phase\nqubit and a lumped-element resonator},}\\ }\\href {\\doibase\n10.1103/PhysRevLett.104.177004} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {104}},\\ \\bibinfo {pages}\n{177004} (\\bibinfo {year} {2010})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Bialczak}\\ \\emph {et~al.}(2011)\\citenamefont\n{Bialczak}, \\citenamefont {Ansmann}, \\citenamefont {Hofheinz}, \\citenamefont\n{Lenander}, \\citenamefont {Lucero}, \\citenamefont {Neeley}, \\citenamefont\n{O~Connell}, \\citenamefont {Sank}, \\citenamefont {Wang}, \\citenamefont\n{Weides} \\emph {et~al.}}]{Bialczak2011}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont\n{Bialczak}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Ansmann}},\n\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Hofheinz}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Lenander}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Lucero}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Neeley}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {O~Connell}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {H.}~\\bibnamefont\n{Wang}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Weides}},  \\emph\n{et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {Fast tunable\ncoupler for superconducting qubits},}\\ }\\href {\\doibase\n10.1103/PhysRevLett.106.060501} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {106}},\\ \\bibinfo {pages}\n{060501} (\\bibinfo {year} {2011})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chen}\\ \\emph\n{et~al.}(2014{\\natexlab{a}})\\citenamefont {Chen}, \\citenamefont {Neill},\n\\citenamefont {Roushan}, \\citenamefont {Leung}, \\citenamefont {Fang},\n\\citenamefont {Barends}, \\citenamefont {Kelly}, \\citenamefont {Campbell},\n\\citenamefont {Chen}, \\citenamefont {Chiaro} \\emph {et~al.}}]{Chen2014}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Chen}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Neill}},\n\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}}, \\bibinfo\n{author} {\\bibfnamefont {N.}~\\bibnamefont {Leung}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Fang}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Campbell}}, \\bibinfo {author} {\\bibfnamefont\n{Z.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Chiaro}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Qubit architecture with high coherence and fast tunable coupling},}\\ }\\href\n{\\doibase 10.1103/PhysRevLett.113.220502} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {113}},\\ \\bibinfo\n{pages} {220502} (\\bibinfo {year} {2014}{\\natexlab{a}})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {McKay}\\ \\emph {et~al.}(2016)\\citenamefont {McKay},\n\\citenamefont {Filipp}, \\citenamefont {Mezzacapo}, \\citenamefont {Magesan},\n\\citenamefont {Chow},\\ and\\ \\citenamefont {Gambetta}}]{Mckay2016}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.~C.}\\ \\bibnamefont\n{McKay}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Filipp}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Mezzacapo}}, \\bibinfo\n{author} {\\bibfnamefont {E.}~\\bibnamefont {Magesan}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Universal gate for fixed-frequency qubits via a\ntunable bus},}\\ }\\href {\\doibase 10.1103/PhysRevApplied.6.064007} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Applied}\\ }\\textbf {\\bibinfo\n{volume} {6}},\\ \\bibinfo {pages} {064007} (\\bibinfo {year}\n{2016})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Lu}\\ \\emph {et~al.}(2017)\\citenamefont {Lu},\n\\citenamefont {Chakram}, \\citenamefont {Leung}, \\citenamefont {Earnest},\n\\citenamefont {Naik}, \\citenamefont {Huang}, \\citenamefont {Groszkowski},\n\\citenamefont {Kapit}, \\citenamefont {Koch},\\ and\\ \\citenamefont\n{Schuster}}]{Lu2017}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Lu}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Chakram}},\n\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Leung}}, \\bibinfo\n{author} {\\bibfnamefont {N.}~\\bibnamefont {Earnest}}, \\bibinfo {author}\n{\\bibfnamefont {R.~K.}\\ \\bibnamefont {Naik}}, \\bibinfo {author}\n{\\bibfnamefont {Z.}~\\bibnamefont {Huang}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Groszkowski}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Kapit}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Koch}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {D.~I.}\\\n\\bibnamefont {Schuster}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Universal stabilization of a parametrically coupled qubit},}\\ }\\href\n{\\doibase 10.1103/PhysRevLett.119.150502} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {119}},\\ \\bibinfo\n{pages} {150502} (\\bibinfo {year} {2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kounalakis}\\ \\emph {et~al.}(2018)\\citenamefont\n{Kounalakis}, \\citenamefont {Dickel}, \\citenamefont {M.}, \\citenamefont\n{Dickel}, \\citenamefont {Dickel}, \\citenamefont {Langford},\\ and\\\n\\citenamefont {Steele}}]{Kounalakis2018tuneable}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Kounalakis}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Dickel}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {M.}}, \\bibinfo {author}\n{\\bibfnamefont {C.}~\\bibnamefont {Dickel}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Dickel}}, \\bibinfo {author} {\\bibfnamefont {N.~K.}\\\n\\bibnamefont {Langford}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {G.~A.}\\\n\\bibnamefont {Steele}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title}\n{Tuneable hopping and nonlinear cross-kerr interactions in a high-coherence\nsuperconducting circuit},}\\ }\\href\n{https://dx.doi.org/10.1038/s41534-018-0088-9} {\\bibfield  {journal}\n{\\bibinfo  {journal} {npj Quantum Information}\\ }\\textbf {\\bibinfo {volume}\n{38}},\\ \\bibinfo {pages} {1} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chen}\\ \\emph {et~al.}(2018)\\citenamefont {Chen},\n\\citenamefont {Liu}, \\citenamefont {Sun},\\ and\\ \\citenamefont\n{Wu}}]{Chen2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Q.-M.}\\ \\bibnamefont\n{Chen}}, \\bibinfo {author} {\\bibfnamefont {Y.-x.}\\ \\bibnamefont {Liu}},\n\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Sun}}, \\ and\\ \\bibinfo\n{author} {\\bibfnamefont {R.-B.}\\ \\bibnamefont {Wu}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Tuning the coupling between superconducting\nresonators with collective qubits},}\\ }\\href {\\doibase\n10.1103/PhysRevA.98.042328} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. A}\\ }\\textbf {\\bibinfo {volume} {98}},\\ \\bibinfo {pages} {042328}\n(\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Neill}\\ \\emph {et~al.}(2018)\\citenamefont {Neill},\n\\citenamefont {Roushan}, \\citenamefont {Kechedzhi}, \\citenamefont {Boixo},\n\\citenamefont {Isakov}, \\citenamefont {Smelyanskiy}, \\citenamefont {Megrant},\n\\citenamefont {Chiaro}, \\citenamefont {Dunsworth}, \\citenamefont {Arya} \\emph\n{et~al.}}]{Neill2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Neill}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}},\n\\bibinfo {author} {\\bibfnamefont {K.}~\\bibnamefont {Kechedzhi}}, \\bibinfo\n{author} {\\bibfnamefont {S.}~\\bibnamefont {Boixo}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Isakov}}, \\bibinfo {author} {\\bibfnamefont\n{V.}~\\bibnamefont {Smelyanskiy}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Megrant}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont\n{K.}~\\bibnamefont {Arya}},  \\emph {et~al.},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {A blueprint for demonstrating quantum supremacy with\nsuperconducting qubits},}\\ }\\href\n{https://science.sciencemag.org/content/360/6385/195} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Science}\\ }\\textbf {\\bibinfo {volume} {360}},\\ \\bibinfo\n{pages} {195} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Mundada}\\ \\emph {et~al.}(2019)\\citenamefont\n{Mundada}, \\citenamefont {Zhang}, \\citenamefont {Hazard},\\ and\\ \\citenamefont\n{Houck}}]{Mundada2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n{Mundada}}, \\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont {Zhang}},\n\\bibinfo {author} {\\bibfnamefont {T.}~\\bibnamefont {Hazard}}, \\ and\\ \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Houck}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Suppression of qubit crosstalk in a tunable\ncoupling superconducting circuit},}\\ }\\href {\\doibase\n10.1103/PhysRevApplied.12.054023} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Applied}\\ }\\textbf {\\bibinfo {volume} {12}},\\ \\bibinfo {pages}\n{054023} (\\bibinfo {year} {2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Yan}\\ \\emph {et~al.}(2018)\\citenamefont {Yan},\n\\citenamefont {Krantz}, \\citenamefont {Sung}, \\citenamefont {Kjaergaard},\n\\citenamefont {Campbell}, \\citenamefont {Orlando}, \\citenamefont\n{Gustavsson},\\ and\\ \\citenamefont {Oliver}}]{Yan2018}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont\n{Yan}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Krantz}},\n\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Sung}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Kjaergaard}}, \\bibinfo {author}\n{\\bibfnamefont {D.~L.}\\ \\bibnamefont {Campbell}}, \\bibinfo {author}\n{\\bibfnamefont {T.~P.}\\ \\bibnamefont {Orlando}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Gustavsson}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {W.~D.}\\ \\bibnamefont {Oliver}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {Tunable coupling scheme for implementing\nhigh-fidelity two-qubit gates},}\\ }\\href {\\doibase\n10.1103/PhysRevApplied.10.054062} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Applied}\\ }\\textbf {\\bibinfo {volume} {10}},\\ \\bibinfo {pages}\n{054062} (\\bibinfo {year} {2018})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {You}\\ and\\ \\citenamefont {Nori}(2011)}]{You2011}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~Q.}\\ \\bibnamefont\n{You}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\\n}\\bibfield  {title} {\\enquote {\\bibinfo {title} {Atomic physics and quantum\noptics using superconducting circuits},}\\ }\\href\n{https://www.nature.com/articles/nature10122} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {474}},\\ \\bibinfo {pages}\n{589} (\\bibinfo {year} {2011})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Gu}\\ \\emph {et~al.}(2017)\\citenamefont {Gu},\n\\citenamefont {Kockum}, \\citenamefont {Miranowicz}, \\citenamefont {xi~Liu},\\\nand\\ \\citenamefont {Nori}}]{Gu2017}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {X.}~\\bibnamefont\n{Gu}}, \\bibinfo {author} {\\bibfnamefont {A.~F.}\\ \\bibnamefont {Kockum}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Miranowicz}}, \\bibinfo\n{author} {\\bibfnamefont {Y.}~\\bibnamefont {xi~Liu}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {F.}~\\bibnamefont {Nori}},\\ }\\bibfield  {title} {\\enquote\n{\\bibinfo {title} {Microwave photonics with superconducting quantum\ncircuits},}\\ }\\href {\\doibase https://doi.org/10.1016/j.physrep.2017.10.002}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Physics Reports}\\ }\\textbf\n{\\bibinfo {volume} {718-719}},\\ \\bibinfo {pages} {1 } (\\bibinfo {year}\n{2017})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Krantz}\\ \\emph {et~al.}(2019)\\citenamefont {Krantz},\n\\citenamefont {Kjaergaard}, \\citenamefont {Yan}, \\citenamefont {Orlando},\n\\citenamefont {Gustavsson},\\ and\\ \\citenamefont {Oliver}}]{Krantz2019}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont\n{Krantz}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Kjaergaard}},\n\\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Yan}}, \\bibinfo {author}\n{\\bibfnamefont {T.~P.}\\ \\bibnamefont {Orlando}}, \\bibinfo {author}\n{\\bibfnamefont {S.}~\\bibnamefont {Gustavsson}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {W.~D.}\\ \\bibnamefont {Oliver}},\\ }\\bibfield  {title}\n{\\enquote {\\bibinfo {title} {A quantum engineer's guide to superconducting\nqubits},}\\ }\\href {https://aip.scitation.org/doi/citedby/10.1063/1.5089550}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Appl. Phys. Rev.}\\ }\\textbf\n{\\bibinfo {volume} {6}},\\ \\bibinfo {pages} {021318} (\\bibinfo {year}\n{2019})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Martinis}\\ and\\ \\citenamefont\n{Geller}(2014)}]{martinis2014fast}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Martinis}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {M.~R.}\\ \\bibnamefont\n{Geller}},\\ }\\bibfield  {title} {\\enquote {\\bibinfo {title} {Fast adiabatic\nqubit gates using only $\u03c3_zcontrol,\n10.1103/PhysRevA.90.022307journaljournalPhys.\nRev. A volume90, pages022307\n(year2014)NoStop [Zhu and Zanardi(2005)]Zhu2005authorauthorS.-L. Zhu and authorP.\u00a0Zanardi,titletitleGeometric quantum gates that\nare robust against stochastic control errors,\n10.1103/PhysRevA.72.020301journaljournalPhys.\nRev. A volume72, pages020301\n(year2005)NoStop [Barends et\u00a0al.(2013)Barends, Kelly, Megrant, Sank, Jeffrey, Chen, Yin,\nChiaro, Mutus, Neillet\u00a0al.]Barends2013authorauthorR.\u00a0Barends, authorJ.\u00a0Kelly,\nauthorA.\u00a0Megrant, authorD.\u00a0Sank, authorE.\u00a0Jeffrey, authorY.\u00a0Chen, authorY.\u00a0Yin, authorB.\u00a0Chiaro,\nauthorJ.\u00a0Mutus, authorC.\u00a0Neill,  et\u00a0al.,titletitleCoherent Josephson qubit\nsuitable for scalable quantum integrated circuits,\n10.1103/PhysRevLett.111.080502journaljournalPhys. Rev. Lett. volume111, pages080502 (year2013)NoStop [Barends et\u00a0al.(2014)Barends, Kelly, Megrant, Veitia, Sank, Jeffrey, White, Mutus, Fowler, Campbellet\u00a0al.]Barends2014authorauthorR.\u00a0Barends, authorJ.\u00a0Kelly,\nauthorA.\u00a0Megrant, authorA.\u00a0Veitia, authorD.\u00a0Sank, authorE.\u00a0Jeffrey, authorT.\u00a0C.White, authorJ.\u00a0Mutus, authorA.\u00a0G. Fowler,\nauthorB.\u00a0Campbell,  et\u00a0al., titletitleSuperconducting\nquantum circuits at the surface code threshold for fault tolerance,  10.1038/s41534-018-0088-9journaljournalNature volume508, pages500 (year2014)NoStop [Blais et\u00a0al.(2007)Blais,\nGambetta, Wallraff, Schuster,\nGirvin, Devoret, and Schoelkopf]Blais2007authorauthorA.\u00a0Blais, authorJ.\u00a0Gambetta,\nauthorA.\u00a0Wallraff, authorD.\u00a0I. Schuster, authorS.\u00a0M. Girvin, authorM.\u00a0H. Devoret,  and authorR.\u00a0J. Schoelkopf, titletitleQuantum-information processing with circuit\nquantum electrodynamics,  10.1103/PhysRevA.75.032329journaljournalPhys. Rev. A volume75, pages032329 (year2007)NoStop [Bravyi et\u00a0al.(2011)Bravyi,\nDiVincenzo, and Loss]Bravyi2011authorauthorS.\u00a0Bravyi, authorD.\u00a0P. DiVincenzo,  and authorD.\u00a0Loss, titletitleSchrieffer\u2013Wolff transformation for quantum many-body systems,  10.1016/j.aop.2011.06.004journaljournalAnnals of physics volume326, pages2793 (year2011)NoStop [Reed(2013)]reed2013entanglementauthorauthorM.\u00a0Reed, @noop titleEntanglement and quantum\nerror correction with superconducting qubits (publisherYale\nUniversity, year2013)NoStop [Chow(2010)]chow2010quantumauthorauthorJ.\u00a0M. Chow, @noop titleQuantum information\nprocessing with superconducting qubits (publisherYale\nUniversity, year2010)NoStop [Korotkov(2013)]korotkov2013authorauthorA.\u00a0N. Korotkov, titletitleError matrices\nin quantum process tomography, https://arxiv.org/abs/1309.6405journaljournalarXiv:1309.6405  (year2013)NoStop [Strauch et\u00a0al.(2003)Strauch, Johnson, Dragt, Lobb, Anderson, and Wellstood]Strauch2003authorauthorF.\u00a0W. Strauch, authorP.\u00a0R. Johnson, authorA.\u00a0J. Dragt,\nauthorC.\u00a0J. Lobb, authorJ.\u00a0R. Anderson,  and authorF.\u00a0C. Wellstood, titletitleQuantum logic gates for coupled\nsuperconducting phase qubits,\n10.1103/PhysRevLett.91.167005journaljournalPhys. Rev. Lett. volume91, pages167005 (year2003)NoStop [Reed et\u00a0al.(2012)Reed,\nDiCarlo, Nigg, Sun,\nFrunzio, Girvin, and Schoelkopf]Reed2012authorauthorM.\u00a0D. Reed, authorL.\u00a0DiCarlo,\nauthorS.\u00a0E. Nigg, authorL.\u00a0Sun, authorL.\u00a0Frunzio, authorS.\u00a0M. Girvin,  and authorR.\u00a0J. Schoelkopf, titletitleRealization of three-qubit quantum error correction with\nsuperconducting circuits,  10.1038/nature10786journaljournalNature volume482, pages382 (year2012)NoStop [Li et\u00a0al.(2013)Li,\nCastellano, Wang, Wu,\nGong, Yan, Rong,\nDeng, Zha, Guoet\u00a0al.]Li2019nonadiabaticCZauthorauthorS.\u00a0Li, authorA.\u00a0D. Castellano,\nauthorS.\u00a0Wang, authorY.\u00a0Wu, authorM.\u00a0Gong, authorZ.\u00a0Yan, authorH.\u00a0Rong, authorH.\u00a0Deng, authorC.\u00a0Zha, authorC.\u00a0Guo,  et\u00a0al., titletitleRealisation of high-fidelity nonadiabatic CZ gates with\nsuperconducting qubits, https://www.nature.com/articles/s41534-019-0202-7journaljournalnpj Quantum Information volume5, pages84 (year2013)NoStop [Viola and Lloyd(1998)]Viola1998authorauthorL.\u00a0Viola and authorS.\u00a0Lloyd,titletitleDynamical suppression of\ndecoherence in two-state quantum systems,\n10.1103/PhysRevA.58.2733journaljournalPhys.\nRev. A volume58, pages2733\n(year1998)NoStop [Barends et\u00a0al.(2019)Barends, Quintana, Petukhov, Chen, Kafri, Kechedzhi, Collins, Naaman, Boixo, Aruteet\u00a0al.]Barends2019authorauthorR.\u00a0Barends, authorC.\u00a0Quintana,\nauthorA.\u00a0Petukhov, authorY.\u00a0Chen, authorD.\u00a0Kafri, authorK.\u00a0Kechedzhi, authorR.\u00a0Collins, authorO.\u00a0Naaman, authorS.\u00a0Boixo, authorF.\u00a0Arute,  et\u00a0al., titletitleDiabatic gates for frequency-tunable superconducting\nqubits,  10.1103/PhysRevLett.123.210501journaljournalPhys. Rev. Lett. volume123, pages210501 (year2019)NoStop [Johansson et\u00a0al.(2012)Johansson, Nation, and Nori]johansson2012authorauthorJ.\u00a0R. Johansson, authorP.\u00a0D. Nation,  and authorF.\u00a0Nori, titletitleQutip: An\nopen-source python framework for the dynamics of open quantum systems, 10.1016/j.cpc.2012.02.021journaljournalComp. Phys. Comm. volume183, pages1760 (year2012)NoStop [Johansson et\u00a0al.(2013)Johansson, Nation, and Nori]johansson2013authorauthorJ.\u00a0R. Johansson, authorP.\u00a0D. Nation,  and authorF.\u00a0Nori, titletitleQutip 2: A python\nframework for the dynamics of open quantum systems,\n10.1016/j.cpc.2012.11.019journaljournalComp.\nPhys. Comm. volume184, pages1234\n(year2013)NoStop [Dunsworth et\u00a0al.(2018)Dunsworth, Barends, Chen, Chen, Chiaro, Fowler, Foxen, Jeffrey, Kelly, Klimovet\u00a0al.]dunsworth2018methodauthorauthorA.\u00a0Dunsworth, authorR.\u00a0Barends,\nauthorY.\u00a0Chen, authorZ.\u00a0Chen, authorB.\u00a0Chiaro, authorA.\u00a0Fowler, authorB.\u00a0Foxen, authorE.\u00a0Jeffrey, authorJ.\u00a0Kelly, authorP.\u00a0Klimov,  et\u00a0al., titletitleA method for building low loss multi-layer wiring for\nsuperconducting microwave devices,  10.1063/1.5014033journaljournalAppl. Phys. Lett. volume112, pages063502 (year2018)NoStop [Kelly et\u00a0al.(2014)Kelly,\nBarends, Campbell, Chen,\nChen, Chiaro, Dunsworth,\nFowler, Hoi, Jeffreyet\u00a0al.]Kelly2014authorauthorJ.\u00a0Kelly, authorR.\u00a0Barends,\nauthorB.\u00a0Campbell, authorY.\u00a0Chen, authorZ.\u00a0Chen, authorB.\u00a0Chiaro, authorA.\u00a0Dunsworth, authorA.\u00a0G.Fowler, authorI.-C.Hoi, authorE.\u00a0Jeffrey,  et\u00a0al., titletitleOptimal quantum control using randomized benchmarking,\n10.1103/PhysRevLett.112.240504journaljournalPhys. Rev. Lett. volume112, pages240504 (year2014)NoStop [Kyriienko and S\u00f8rensen(2018)]Kyriienko2018authorauthorO.\u00a0Kyriienko and authorA.\u00a0S. S\u00f8rensen, titletitleFloquet\nquantum simulation with superconducting qubits,\n10.1103/PhysRevApplied.9.064029journaljournalPhys. Rev. Applied volume9, pages064029 (year2018)NoStop [Zhu et\u00a0al.(2013)Zhu,\nFerguson, Manucharyan, and Koch]zhu2013circuitauthorauthorG.\u00a0Zhu, authorD.\u00a0G. Ferguson,\nauthorV.\u00a0E. Manucharyan,  andauthorJ.\u00a0Koch, titletitleCircuit qed with fluxonium qubits:\nTheory of the dispersive regime,\n10.1103/PhysRevB.87.024510journaljournalPhys.\nRev. B volume87, pages024510\n(year2013)NoStop [Krishnan and Pople(1978)]krishnan1978approximateauthorauthorR.\u00a0Krishnan and authorJ.\u00a0A. Pople, titletitleApproximate\nfourth-order perturbation theory of the electron correlation energy,http://dx.doi.org/10.1002/qua.560140109journaljournalInternational Journal of Quantum Chemistry volume14, pages91 (year1978)NoStop [Nielsen and Chuang(2002)]nielsen2002quantumauthorauthorM.\u00a0A. Nielsen and authorI.\u00a0Chuang, @noop titleQuantum computation\nand quantum information,  (year2002)NoStop [Chen et\u00a0al.(2014b)Chen, Megrant,\nKelly, Barends, Bochmann,\nChen, Chiaro, Dunsworth,\nJeffrey, Mutuset\u00a0al.]chen2014fabricationauthorauthorZ.\u00a0Chen, authorA.\u00a0Megrant,\nauthorJ.\u00a0Kelly, authorR.\u00a0Barends, authorJ.\u00a0Bochmann, authorY.\u00a0Chen, authorB.\u00a0Chiaro, authorA.\u00a0Dunsworth, authorE.\u00a0Jeffrey, authorJ.\u00a0Mutus,  et\u00a0al., titletitleFabrication and characterization of aluminum airbridges\nfor superconducting microwave circuits,\n10.1063/1.4863745journaljournalAppl. Phys.\nLett. volume104, pages052602\n(year2014b)NoStop [Chiaro et\u00a0al.(2016)Chiaro,\nMegrant, Dunsworth, Chen,\nBarends, Campbell, Chen,\nFowler, Hoi, Jeffreyet\u00a0al.]Chiaro_2016authorauthorB.\u00a0Chiaro, authorA.\u00a0Megrant,\nauthorA.\u00a0Dunsworth, authorZ.\u00a0Chen, authorR.\u00a0Barends, authorB.\u00a0Campbell, authorY.\u00a0Chen, authorA.\u00a0Fowler, authorI.\u00a0C. Hoi,\nauthorE.\u00a0Jeffrey,  et\u00a0al., titletitleDielectric\nsurface loss in superconducting resonators with flux-trapping holes, 10.1088/0953-2048/29/10/104006journaljournalSuperconductor Science and Technology volume29, pages104006 (year2016)NoStop [Hatridge et\u00a0al.(2011)Hatridge, Vijay, Slichter, Clarke, and Siddiqi]HatridgeauthorauthorM.\u00a0Hatridge, authorR.\u00a0Vijay,\nauthorD.\u00a0H. Slichter, authorJ.\u00a0Clarke,  and authorI.\u00a0Siddiqi, titletitleDispersive magnetometry with a quantum limited SQUID\nparametric amplifier,  10.1103/PhysRevB.83.134501journaljournalPhys. Rev. B volume83, pages134501 (year2011)NoStop [Roy et\u00a0al.(2012)Roy,\nShukla, and Mahesh]Roy2012authorauthorS.\u00a0S. Roy, authorA.\u00a0Shukla,  andauthorT.\u00a0S. Mahesh, titletitleNMR implementation of a quantum\ndelayed-choice experiment,  10.1103/PhysRevA.85.022109journaljournalPhys. Rev. A volume85, pages022109 (year2012)NoStop [Kamal et\u00a0al.(2009)Kamal,\nMarblestone, and Devoret]KamalauthorauthorA.\u00a0Kamal, authorA.\u00a0Marblestone,\nand authorM.\u00a0H. Devoret,titletitleSignal-to-pump back action\nand self-oscillation in double-pump Josephson parametric amplifier, 10.1103/PhysRevB.79.184301journaljournalPhys. Rev. B volume79, pages184301 (year2009)NoStop [Murch et\u00a0al.(2013)Murch,\nWeber, Macklin, and Siddiqi]MurchauthorauthorK.\u00a0W. Murch, authorS.\u00a0J. Weber,\nauthorC.\u00a0Macklin,  andauthorI.\u00a0Siddiqi, titletitleObserving single quantum trajectories of\na superconducting quantum bit,  10.1038/nature12539journaljournalNature volume502, pages211 (year2013)NoStop [Motzoi et\u00a0al.(2009)Motzoi,\nGambetta, Rebentrost, and Wilhelm]motzoi2009simpleauthorauthorF.\u00a0Motzoi, authorJ.\u00a0M. Gambetta, authorP.\u00a0Rebentrost,  and authorF.\u00a0K. Wilhelm, titletitleSimple pulses\nfor elimination of leakage in weakly nonlinear qubits,\n10.1103/PhysRevLett.103.110501journaljournalPhys. Rev. Lett. volume103, pages110501 (year2009)NoStop"}
{"prompt": "What are the key contributions of the paper 'Active resonator reset in the nonlinear dispersive regime of circuit QED'?", "completion": "\n\n# Active resonator reset in the nonlinear dispersive regime of circuit QED\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nInstituut-Lorentz for Theoretical Physics, Leiden University, Leiden, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nCollege of Computer, National University of Defense Technology, Changsha, China 410073\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nTopic Embedded Systems B.V., P.O. Box 440, 5680 AK Best, The Netherlands\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nQuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\nKavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands\n\nWe present two pulse schemes for actively depleting measurement photons from a readout resonator in the nonlinear dispersive regime of circuit QED.\nOne method uses digital feedback conditioned on the measurement outcome while the other is unconditional.\nIn the absence of analytic forms and symmetries to exploit in this nonlinear regime, the depletion pulses are numerically optimized using the Powell method.\nWe shorten the photon depletion time by more than six inverse resonator linewidths compared to passive depletion by waiting.\nWe quantify the benefit by emulating an ancilla qubit performing repeated quantum parity checks in a repetition code. Fast depletion increases the mean number of cycles to a spurious error detection event from order 1 to 75 at a $1~\\us$ cycle time.\n\n< g r a p h i c s >\n\n(Color online)\nDispersive qubit readout in the nonlinear regime and qubit errors produced by leftover measurement photons.\n(a) CW feedline transmission spectroscopy as a function of incident power and frequency near the low- and high-power fundamentals of the readout resonator.\nThe qubit is simultaneously driven with a weakly saturating CW tone.\nThe right (left) vertical line indicates the fundamental $\\frzero$ ($\\frone$) for qubit in $\\ket{0}$ ($\\ket{1}$) in the linear regime.\nThe dot [also in (b)] indicates the settings $(\\Prf,\\frf)=(-93~\\dBm, 6.8488~\\GHz)$ used throughout the experiment.\n(b) Map of average assignment fidelity $\\Fa$ as a function of $\\Prf$ and $\\frf$ with the JPA off ($\\taumeas=1200~\\ns$, $\\tauint=1500~\\ns$), obtained from histograms with 4000 shots per qubit state. Inset: Turning on the JPA achieves $\\Fa=98.8\\%$ with $\\taumeas=300~\\ns$ and an optimized weight function integrating $\\tauint=400~\\ns$.\n(c) Illustration of qubits errors induced by leftover photons.\nAt $\\taud$, after an initial measurement pulse ends, AllXY qubit pulse pairs are applied and a final measurement is performed $1000~\\ns$ later to measure $\\Fidone$.\nThe transient of the decaying homodyne signal, $P_\\mathrm{H}$, fits a single-photon relaxation time $1/\\kappa=250~\\ns$.\nInsets and (d): $\\Fidone$ versus pulse pair for several $\\taud$. The ideal two-step signature is observed only at $\\taud \\gtrsim 2500~\\ns$.\n\nMany protocols in quantum information processing require interleaving qubit gates and measurements in rapid succession.\nFor example, current experimental implementations of quantum error correction (QEC) schemes\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] rely on repeated measurements of ancilla qubits to discretize and track errors in the data-carrying part of the system.\nMinimizing the QEC cycle time is essential to avoid build-up of errors beyond the threshold for fault-tolerance.\n\nAn attractive architecture for QEC codes is circuit quantum electrodynamics (cQED)\u00a0[Unknown Author, \"Unknown Title\", ].\nInitially implemented with superconducting qubits, this scheme has since grown to include both semiconducting\u00a0[Unknown Author, \"Unknown Title\", ] and hybrid qubit platforms\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nReadout in cQED involves dispersively coupling the qubit to a microwave-frequency resonator causing a qubit-state dependent shift of the fundamental resonance.\nThis shift can be measured by injecting the resonator with a microwave photon pulse.\nInversely however, there is a dual sensitivity of the qubit transition frequency to resonator photons (AC Stark shift\u00a0[Unknown Author, \"Unknown Title\", ]), leading to qubit dephasing and detuning, as well as gate errors.\nTo ensure photons leave the resonator before gates recommence, cQED implementations of QEC include a waiting step after measurement.\nDuring this dead time, which lasts a significant fraction of the QEC cycle, qubits are susceptible to decoherence.\nWhilst many prerequisites of measurement in cQED devices for QEC have already been demonstrated (including frequency-multiplexed readout via a common feedline\u00a0[Unknown Author, \"Unknown Title\", ], the use of parametric amplifiers to improve speed and readout fidelity\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and null back-action on untargeted qubits\u00a0[Unknown Author, \"Unknown Title\", ]),\ncomparatively little attention has been given to the fast depletion of resonator photons post measurement.\n\nTwo compatible approaches to accelerate photon depletion have been explored.\nThe first increases the resonator linewidth $\\kappa$ while adding a Purcell filter\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] to avoid enhanced qubit relaxation via the Purcell effect\u00a0[Unknown Author, \"Unknown Title\", ].\nHowever, increasing $\\kappa$ enhances the rate of qubit dephasing due to stray photons\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], introducing a compromise.\nThe second approach is to actively deplete photons using a counter pulse, as recently demonstrated by McClure et al.\u00a0[Unknown Author, \"Unknown Title\", ].\nThis demonstration exploited useful symmetries available when the resonator response is linear. However, reaching the single-shot readout fidelity required for QEC often involves driving the resonator deep into the nonlinear regime, where no such symmetries are available.\n\nIn this Letter, we propose and demonstrate two methods of active photon depletion in the nonlinear dispersive regime of cQED.\nThe first uses a homebuilt feedback controller to send one of two depletion pulses conditioned on the declared measurement outcome. The second applies a universal pulse independent of measurement outcome.\nWe maximize readout fidelity at a measurement power two orders of magnitude larger than that inducing the critical photon number in the resonator\u00a0[Unknown Author, \"Unknown Title\", ].\nWithout analytic expressions and convenient symmetries for this nonlinear regime, we rely exclusively on numerical optimization by Powell's method\u00a0[Unknown Author, \"Unknown Title\", ] to tune up pulses with physically-motivated shapes, defined by two or four parameters.\nBoth methods shorten the photon depletion by at least $5/\\kappa$ compared to depletion by waiting.\nWe illustrate the benefits of active photon depletion using an emulation of multi-round quantum error correction.\nSpecifically, we emulate an ancilla qubit performing parity checks\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] by subjecting our qubit to repeated rounds of coherent operations and measurement.\nWe quantify performance by extracting the mean number of rounds to a measurement outcome that deviates from the ideal result (i.e., an error detection event).\nWith active depletion, we observe an increase in this mean rounds to event, $\\RTEmean$, from $15$ to $39$ due to the reduction of total cycle time to $1~\\us \\sim 4/\\kappa$.\nBy further fixing the ancilla to remain in the ground state, $\\RTEmean$ increases to $75$. Numerical simulations\u00a0[Unknown Author, \"Unknown Title\", ] indicate that, when including the same intrinsic coherence for surrounding data qubits, a 5-qubit repetition code (studied in\u00a0[Unknown Author, \"Unknown Title\", ]) would have a logical error rate below its pseudo-threshold\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe employ a 2D cQED chip containing ten transmon qubits with dedicated readout resonators, all capacitively coupled to a common feedline through which all microwave control and measurement pulses are applied.\nWe focus on one qubit-resonator pair for all data presented. This qubit is operated at its flux sweetspot, with transition from ground ($\\ket{0}$) to first-excited ($\\ket{1}$) state at $\\fqubit=6.477~\\GHz$, and average relaxation and Hahn echo times $\\Tone=25~\\us$ and $\\Techo=39~\\us$.\nThe dispersively coupled resonator has a low-power fundamental at $\\frzero=6.8506~\\GHz$ ($\\frone=6.8480~\\GHz$) for qubit in $\\ket{0}$ ($\\ket{1}$), making the dispersive shift $\\chi/\\pi=-2.6~\\MHz$.\nNote that this shift also corresponds to the qubit detuning induced per resonator photon.\nThe fundamentals converge to the bare resonator frequency, $\\fbare=6.8478~\\GHz$, at incident power $\\Prf \\gtrsim -88~\\dBm$. We calibrate a single-photon power $\\Prf=-130~\\dBm$ using photon-number splitting experiments\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and a critical photon number\u00a0[Unknown Author, \"Unknown Title\", ] $\\ncrit=(\\Delta^2/4g^2)\\approx 33$ ($\\Prf \\approx -115~\\dBm$) using $\\frzero-\\fbare=g^2/2\\pi\\Delta$ and $\\Delta=2\\pi(\\fqubit-\\fbare)$.\n\nOur first objective is to maximize the average assignment fidelity of single-shot readout,\n\n=1-1/2(\u03f5_01 + \u03f5_10),\n\nwhere $\\epsilon_{ij}$ is the probability of incorrectly assigning measurement result $j$ for input state $\\ket{i}$, $i,j\\in\\{0,1\\}$.\nWe map $\\Fa$ as a function of the power $\\Prf$ and frequency $\\frf$ of a measurement pulse of duration $\\taumeas=1200~\\ns$ [Fig.\u00a0(Figure fig:fig1)(b)].\n$\\Fa$ is maximized at an intermediate $\\Prf=-93~\\dBm$, $22~\\dB$ stronger than the $\\ncrit$ power.\nThe nonlinearity is evidenced by the bending of resonator lineshapes in the accompanying continuous-wave (CW) transmission spectroscopy [Fig.\u00a0(Figure fig:fig1)(a)].\nWe make two additions to further improve $\\Fa$. First, we turn on a Josephson parametric amplifier (JPA) as the front-end of our amplification chain, operating in non-degenerate mode with $14~\\dB$ of gain.\nThe improved signal-to-noise ratio allows shortening $\\taumeas$ to $300~\\ns$.\nSecond, we use an optimized weight function (duration $\\tauint=400~\\ns$) to integrate the demodulated homodyne signal before thresholding.\nThis weight function consists of the difference of the averaged transients for $\\ket{0}$ and for $\\ket{1}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nThese additions achieve $\\Fa=98.8\\%$, with $\\epsilon_{01}=0.1\\%$ and $\\epsilon_{10}=2.3\\%$ [Inset, Fig.\u00a0(Figure fig:fig1)(b)], limited by $\\Tone$.\n\nThe effect of photons leftover from this strong measurement is conveniently illustrated with a modified AllXY sequence\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nAllXY consists of 21 sequences, each comprised of one pair of pulses [Fig.\u00a0(Figure fig:fig1)(d)] applied to the qubit followed by qubit measurement.\nThe qubit pulses are drawn from the set $\\{I,X,Y,x,y\\}$, where $I$ denotes the identity, and $X$ and $Y$ $(x$ and $y)$ denote $\\pi$ ($\\pi/2$) pulses around the $x$ and $y$ axis of the Bloch sphere, respectively.\nIdeal pulses leave the qubit in $\\ket{0}$ (first 5 pairs), on the equator of the Bloch sphere (next 12), and in $\\ket{1}$ (final 4), producing a characteristic two-step signature in the fidelity to $\\ket{1}$, $\\Fidone$ [Fig.\u00a0(Figure fig:fig1)(d)].\nThe chosen order of pulse pairs reveals clear signatures of errors in many gate parameters\u00a0[Unknown Author, \"Unknown Title\", ].\nHere, we modify the AllXY sequence by applying a measurement pulse ending at a time $\\taud$ before the start of the qubit pulses.\nThe effect of leftover photons on the pulses is clearly visible in Fig.\u00a0(Figure fig:fig1)(c). At $\\taud \\gtrsim 10/\\kappa$, $\\Fidone$ displays the expected double step.\nAt $\\taud\\sim 7/\\kappa$, the characteristic signature of moderate qubit detuning is observed in the high/low response of pulse pairs $x$-$y$ and $y$-$x$.\nAt $\\taud\\leq 2/\\kappa$, the detuning is significant with respect to the Rabi frequency of pulses, which thus barely excite the qubit.\n\n< g r a p h i c s >\n\n(Color online) Two active methods of photon depletion compared to passive depletion.\n(a) Pulse scheme for conditional photon depletion. The controller applies a depletion pulse $\\Dzero$ (at $\\frzero$) or $\\Done$ (at $\\frone$), each with separate amplitude and phase, depending on its declared measurement outcome.\n(b) Performance of conditional depletion. Average photon number $\\nphoton$ as a function of $\\taud$ for all combinations of input qubit state and depletion pulse. Compared to waiting, conditional depletion saves $\\geq 1240~(1790)~\\ns$ for correct declaration 0 (1).\n(c) Pulse scheme for unconditional active depletion.\nThe single depletion pulse $\\Dall$, immediately following the nominal measurement pulse, has four parameters corresponding to the amplitude and phase of pulse components at $\\frzero$ and $\\frone$.\n(d) Performance of unconditional depletion. Unconditional depletion saves $\\geq1650~(1920)~\\ns$ for $\\ket{0}$ ($\\ket{1}$). Exponential best fits (curves) to the data in the linear regime  ($\\nphoton\\leq8$) give\n$1/\\kappa=255\\pm5~\\ns$.\n\nWe now focus on the calibration of AllXY as a photon detector, suitable for the optimization of depletion pulses.\nBecause we miss analytic formulas in the nonlinear regime, pulse optimization relies on numerical minimization of the residual average photon number $\\nphoton$ using Powell's method.\nWe choose $\\AllXYerror$ as cost function, defined as the sum of the absolute deviations from the ideal-result fit.\nWe find experimentally that $\\AllXYerror=\\alpha\\nphoton(\\taud)+\\beta$ for $\\nphoton \\lesssim 30$.\nThe calibration of coefficients $\\alpha$ and $\\beta$ is described in\u00a0[Unknown Author, \"Unknown Title\", ].\nMeasurement noise limits the sensitivity of the detector to $\\delta \\nphoton \\gtrsim 0.3$.\nThese two orders of magnitude constitute a suitable dynamic range for the optimizations that follow.\n\nPhoton depletion by feedback applies one of two depletion pulses, $D_j$, conditioned on the declared measurement result, $j\\in \\{0,1\\}$ [Fig.\u00a0(Figure fig:fig2)(a)].\nThe pulse $D_j$, a square pulse of duration $\\taup=30~\\ns$, is applied at $f_{\\mathrm{r},\\ket{j}}$ by sideband modulating $\\frf$.\nThe combined delays from round-trip signal propagation ($80~\\ns$), the augmented integration window ($100~\\ns$), and controller latency ($150~\\ns$) make $D_j$ arrive $330~\\ns$ after the measurement pulse ends.\nThe amplitude and phase of each pulse is separately optimized using a two-step procedure.\nUsing the modified AllXY sequence with the qubit initialized in $\\ket{i}$, we first minimize $\\nphoton$ at $\\taud=1000~\\ns$.\nThis $\\taud$ is sufficiently long to avoid saturating the detector and to reach the sensitivity limit after a few optimization rounds.\nNext, we minimize $\\nphoton$ at $\\taud=500~\\ns$.\nThis second optimization converges to $\\nphoton\\sim 2.1~(0.7)$ for $\\ket{0}$ ($\\ket{1}$), reducing $\\taud$ by at least $5/\\kappa$ compared to passive depletion [Fig.\u00a0(Figure fig:fig2)(b)].\nAn incorrect assignment by the feedback controller leads to less effective depletion but still outperforms passive depletion.\nWe have also explored conditional depletion for various pulse lengths while fixing $\\taud=500~\\ns$.\nWe observe a systematic evolution of the optimal depletion pulse parameters but no further reduction of $\\nphoton$\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\n(Color online) Emulated multi-round QEC: flipping ancilla qubit.\n(a) Block diagram for repeating parity measurements in a repetition code. The ancilla $A$ performs an indirect measurement of the parity of data qubits $\\Qone$ and $\\Qtwo$ by a coherent $200~\\ns$ interaction step followed by measurement.\nThis emulation replaces the c-phase gates by idling, reducing the coherent step to a simple echo sequence that ideally flips the ancilla each round.\nThe measurement step is followed by a depletion step of duration $\\taud$, after which a new cycle begins.\n(b) Single trace of digitized measurement outcomes. An event is detected whenever the measurement outcome first deviates from the ideal alternating sequence.\nTwo types of event, $\\types$ and $\\typed$, are distinguished by the measurement outcome on the next round.\n(c) Average rounds to event as a function of $\\taud$.\nThe unconditional method improves $\\RTEmean$ by a factor $2.7$ and reduces the optimum $\\taud$ by a factor $>2.7$.\n(d) Per-round probability of type-$\\types$ event versus $\\taud$.\nAdded curves are obtained from the two models described in the text.\n\nUnconditional depletion uses a universal depletion pulse $\\Dall$ starting immediately after the measurement pulse (there is no latency cost) [Fig.\u00a0(Figure fig:fig2)(c)].\nThis pulse is composed by summing two square pulses of duration $\\taup=330~\\ns$ with independent amplitude and phase, generated by sideband modulating $\\frf$ at $\\frzero$ and $\\frone$.\nThese four parameters are numerically optimized using the sum of $\\nphoton$ for $\\ket{0}$ and $\\ket{1}$ as cost function and a similar two-step procedure (with $\\taud=400~\\ns$ in the second step) as for the conditional pulses.\nThe minimization achieves $\\nphoton\\sim0.8~(0.4)$ for $\\ket{0}$ ($\\ket{1}$) and reduces $\\taud$ by more than $6/\\kappa$ compared to passive depletion [Fig.\u00a0(Figure fig:fig2)(d)].\nWe have also explored unconditional depletion for various pulse lengths while fixing $\\taud=400~\\ns$\u00a0[Unknown Author, \"Unknown Title\", ].\nWe find a smooth variation of optimal pulse parameters, and a small improvement in residual $\\nphoton$ with $\\taup=270~\\ns$. However, the overlap of the depletion pulse with the measurement integration window reduces the readout fidelity at this setting.\n\nWe quantify the merits of these active photon depletion schemes with an experiment motivated by current efforts in multi-round quantum error correction\u00a0(QEC).\nSpecifically, we emulate an ancilla qubit undergoing the rapid succession of interleaved coherent interaction and measurement steps when performing repetitive parity checks on data-carrying qubits in a repetition code.\nWe replace each conditional-phase (c-phase) gate in the interaction step with idling for an equivalent time $(40~\\ns)$, reducing the coherent step to a $200~\\ns$ echo sequence that ideally flips the ancilla each round [Fig.\u00a0(Figure fig:fig3)(a)].\nAs performance metric, we measure the average number of rounds to an error detection event, $\\RTEmean$.\nAn error event is marked by the first deviation of qubit measurement results from the ideal alternating sequence.\nImperfections reducing $\\RTEmean$ include qubit relaxation, dephasing and detuning during the interaction step, and measurement errors due to readout discrimination infidelity, $1-\\Fd$ (defined as the overlap fraction of gaussian best fits to the single-shot readout histograms\u00a0[Unknown Author, \"Unknown Title\", ]).\nTo differentiate these sources of ancilla hardware errors, we keep track of two types of detection events, determined by the measurement outcome in the round following the first deviation (Fig.\u00a0(Figure fig:fig3)(b), similar to Ref.\u00a0[Unknown Author, \"Unknown Title\", ]).\nEvents of type $\\types$ can result, for example, from a single ancilla bit flip or from measurement errors in two consecutive rounds.\nIn turn, events of type $\\typed$ can result from one measurement error or from ancilla bit flips in two consecutive rounds.\nBecause photon-induced errors primarily lead to single ancilla bit flips, we also extract the probability of encountering an event of type $\\types$ per cycle, $\\psingle$, and investigate its $\\taud$ dependence.\n\nDecreasing $\\taud$ trades off $\\Tone$-induced errors for photon-induced errors.\nFor passive depletion, $\\RTEmean$ is maximized to $14.6$ at $\\taud=2200~\\ns$ [Fig.\u00a0(Figure fig:fig3)(c)].\nAt this optimal point, depletion occupies most of the total QEC cycle time $\\taucycle=2700~\\ns$.\nThe active depletion methods reach a higher $\\RTEmean$ by balancing the trade-off at lower $\\taud$.\nAs in the optimization, we find that unconditional depletion performs best, improving the maximal $\\RTEmean$ to $39.5$ and reducing the optimum $\\taucycle$ to $1200~\\ns$.\n\nThe essential features of $\\RTEmean$ for the three depletion schemes are well captured by two theory models (see\u00a0[Unknown Author, \"Unknown Title\", ]).\nThe simple model includes only qubit relaxation and non-photon-induced dephasing (calibrated using standard $\\Tone$ and $\\Techo$ measurements).\nThe extensive model also includes photon-induced qubit dephasing and detuning during the idling steps (modeled following Ref.\u00a0[Unknown Author, \"Unknown Title\", ] with photon dynamics of Fig.\u00a0(Figure fig:fig2)), and a measured $1-\\Fd=0.1\\%$ for readout.\nAs we do not model photon-induced pulse errors, we restrict the extensive model to $\\nphoton<8$.\nThe good agreement observed between the extensive model and experiment demonstrates the non-demolition character of the measurement and confirms the $\\nphoton$ calibration.\n\nThe multi-round QEC emulation can be made more sensitive to leftover photons by harnessing the asymmetry of the qubit decay channel.\nSpecifically, changing the polarity of the final $\\pi/2$ pulse so that the coherent step does not flip the ancilla can keep the ancilla ideally in $\\ket{0}$ during measurement and depletion.\nThis change extends the sensitivity of $\\RTEmean$ to $\\nphoton$ by extending its ceiling to 168 [Fig.\u00a0(Figure fig:fig4)], which is $\\taud$ independent and set by intrinsic decoherence in the coherent step and readout discrimination infidelity.\nClearly, unconditional depletion outperforms conditional and passive depletion, but the reduction of $\\RTEmean$ to 50 at short $\\taud$ evidences the performance limit reached by our choice of pulses.\nIn a QEC context, the key benefit of active depletion in this non-flipping variant will be an increase in $\\RTEmean$ due to lower per-cycle probability of data qubit errors, afforded by reducing $\\taucycle$ by $6/\\kappa$. Evidently, this effect is not captured by our emulation, which is only sensitive to ancilla hardware errors.\n\n< g r a p h i c s >\n\n(Color online) Emulated multi-round QEC: non-flipping ancilla qubit in $\\ket{0}$.\nThis variant uses the sequence of Fig.\u00a0(Figure fig:fig3)(a) but with opposite polarity on the final $\\pi/2$ pulse in order not to flip the ancilla in every round.\n(a) Average rounds to event as a function of $\\taud$, for ancilla starting in $\\ket{0}$. $\\RTEmean$ is no longer sensitive to qubit relaxation during $\\taud$, increasing the sensitivity to $\\nphoton$. The ceiling of $\\sim 168$ reached at long $\\taud$ is set by intrinsic decoherence in the coherent step and readout discrimination infidelity.\n(b) Per-round probability of encountering event of type $\\types$ as a function of $\\taud$. The simple and extensive models include the same calibrated errors as in Fig.\u00a0(Figure fig:fig3).\n\nThese $\\RTE$ experiments motivate two points for discussion and outlook.\nFirst, they highlight the importance of using digital feedback\u00a0[Unknown Author, \"Unknown Title\", ] in QEC to keep ancillas in the ground state as much as possible (as used in a cat code\u00a0[Unknown Author, \"Unknown Title\", ]). Conveniently, this feedback has relaxed latency requirements ($\\taud + 160~\\ns$ in our example), because the conditional action can be chosen to be the polarity of the final $\\pi/2$ pulse. Second, $\\RTEmean$ emerges as an attractive method for quantifying the performance of every element in the QEC cycle, not just the depletion step. The advantage over traditional tune-up methods is the speed gained by not reinitializing in $\\ket{0}$ following every measurement\u00a0[Unknown Author, \"Unknown Title\", ] and the ability to tune without interrupting ongoing error correction\u00a0[Unknown Author, \"Unknown Title\", ].\n\nIn summary, we have investigated two active methods for fast photon depletion in the nonlinear regime of cQED, relying on numerical optimization to successfully outperform passive depletion by more than $6/\\kappa$.\nActive photon depletion will find application in quantum computing scenarios interleaving qubit measurements with coherent qubit operations. Here, we have focused on the example of quantum error correction, emulating an ancilla qubit performing repetitive parity checks in a repetition code.\nFuture experiments will focus on combining active depletion with Purcell filtering to further reduce QEC cycle time from the achieved $1~\\us$ to $\\sim500~\\ns$, sufficient to cross the error pseudo-threshold in small surface codes at state-of-the-art transmon relaxation times\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe thank S.\u00a0Visser, J.\u00a0Somers, L.\u00a0Riesebos, and E.\u00a0Garrido\u00a0Barrab\u00e9s for contributions to FPGA programming, K.\u00a0W.\u00a0Lehnert for the parametric amplifier, A.\u00a0Wallraff for a precision coil, and K.\u00a0Bertels, E.\u00a0Charbon, D.\u00a0Sank, and M.\u00a0Khezri for discussions. We acknowledge funding from the EU FP7 project ScaleQIT, the Dutch Organization for Fundamental Research on Matter (FOM), an ERC Synergy Grant, a Marie Curie Career Integration Grant (L.D.C.), and the China Scholarship Council (X.F.).\n\n37\nfxundefined [1]\nifx#1\n\nfnum [1]\n#1firstoftwo\nsecondoftwo\n\nfx [1]\n#1firstoftwo\nsecondoftwo\n\nnoop [0]secondoftwo\n\nref[1]@startlink#1@href\nhref[1]#1@endlink\nanitize@url [0]`\n12`$12\\catcode\n`\\&12\\catcode `\\#12\\catcode `\\^12\\catcode `\\_12\\catcode `\\%12\\relax}%\n\\providecommand \\@@startlink[1]{}%\n\\providecommand \\@@endlink[0]{}%\n\\providecommand \\url  [0]{\\begingroup\\@sanitize@url \\@url }%\n\\providecommand \\@url [1]{\\endgroup\\@href {#1}{\\urlprefix }}%\n\\providecommand \\urlprefix  [0]{URL }%\n\\providecommand \\Eprint [0]{\\href }%\n\\providecommand \\doibase [0]{http://dx.doi.org/}%\n\\providecommand \\selectlanguage [0]{\\@gobble}%\n\\providecommand \\bibinfo  [0]{\\@secondoftwo}%\n\\providecommand \\bibfield  [0]{\\@secondoftwo}%\n\\providecommand \\translation [1]{[#1]}%\n\\providecommand \\BibitemOpen [0]{}%\n\\providecommand \\bibitemStop [0]{}%\n\\providecommand \\bibitemNoStop [0]{.\\EOS\\space}%\n\\providecommand \\EOS [0]{\\spacefactor3000\\relax}%\n\\providecommand \\BibitemShut  [1]{\\csname bibitem#1\\endcsname}%\n\\let\\auto@bib@innerbib\\@empty\n%</preamble>\n\\bibitem [{\\citenamefont {Reed}\\ \\emph {et~al.}(2012)\\citenamefont {Reed},\n\\citenamefont {DiCarlo}, \\citenamefont {Nigg}, \\citenamefont {Sun},\n\\citenamefont {Frunzio}, \\citenamefont {Girvin},\\ and\\ \\citenamefont\n{Schoelkopf}}]{Reed12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~D.}\\ \\bibnamefont\n{Reed}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\n\\bibinfo {author} {\\bibfnamefont {S.~E.}\\ \\bibnamefont {Nigg}}, \\bibinfo\n{author} {\\bibfnamefont {L.}~\\bibnamefont {Sun}}, \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont\n{S.~M.}\\ \\bibnamefont {Girvin}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n{R.~J.}\\ \\bibnamefont {Schoelkopf}},\\ }\\href@noop {} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {482}},\\ \\bibinfo\n{pages} {382} (\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kelly}\\ \\emph {et~al.}(2015)\\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Fowler}, \\citenamefont {Megrant},\n\\citenamefont {Jeffrey}, \\citenamefont {White}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {Campbell}, \\citenamefont {Chen} \\emph\n{et~al.}}]{Kelly15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Kelly}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Barends}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Fowler}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{T.}~\\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Mutus}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Campbell}},\n\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}},  \\emph {et~al.},\\\n}\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Nature}\\ }\\textbf\n{\\bibinfo {volume} {519}},\\ \\bibinfo {pages} {66} (\\bibinfo {year}\n{2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rist\\`{e}}\\ \\emph {et~al.}(2015)\\citenamefont\n{Rist\\`{e}}, \\citenamefont {Poletto}, \\citenamefont {Huang}, \\citenamefont\n{Bruno}, \\citenamefont {Vesterinen}, \\citenamefont {Saira},\\ and\\\n\\citenamefont {DiCarlo}}]{Riste15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n{Rist\\`{e}}}, \\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Poletto}},\n\\bibinfo {author} {\\bibfnamefont {M.~Z.}\\ \\bibnamefont {Huang}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Bruno}}, \\bibinfo {author}\n{\\bibfnamefont {V.}~\\bibnamefont {Vesterinen}}, \\bibinfo {author}\n{\\bibfnamefont {O.~P.}\\ \\bibnamefont {Saira}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Nat.\\ Commun.}\\ }\\textbf {\\bibinfo {volume}\n{{6}}} (\\bibinfo {year} {{2015}})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Cramer}\\ \\emph {et~al.}(2015)\\citenamefont {Cramer},\n\\citenamefont {Kalb}, \\citenamefont {Rol}, \\citenamefont {Hensen},\n\\citenamefont {Markham}, \\citenamefont {Twitchen}, \\citenamefont {Hanson},\\\nand\\ \\citenamefont {Taminiau}}]{Cramer15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Cramer}}, \\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont {Kalb}},\n\\bibinfo {author} {\\bibfnamefont {M.~A.}\\ \\bibnamefont {Rol}}, \\bibinfo\n{author} {\\bibfnamefont {B.}~\\bibnamefont {Hensen}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Markham}}, \\bibinfo {author} {\\bibfnamefont\n{D.~J.}\\ \\bibnamefont {Twitchen}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Hanson}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {T.~H.}\\\n\\bibnamefont {Taminiau}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n{journal} {arXiv:1508.01388v1}\\ } (\\bibinfo {year} {2015})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Nigg}\\ \\emph {et~al.}(2014)\\citenamefont {Nigg},\n\\citenamefont {M\\\"{u}ller}, \\citenamefont {Martinez}, \\citenamefont\n{Schindler}, \\citenamefont {Hennrich}, \\citenamefont {Monz}, \\citenamefont\n{Martin-Delgado},\\ and\\ \\citenamefont {Blatt}}]{Nigg14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n{Nigg}}, \\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {M\\\"{u}ller}},\n\\bibinfo {author} {\\bibfnamefont {E.~A.}\\ \\bibnamefont {Martinez}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Schindler}}, \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Hennrich}}, \\bibinfo {author}\n{\\bibfnamefont {T.}~\\bibnamefont {Monz}}, \\bibinfo {author} {\\bibfnamefont\n{M.~A.}\\ \\bibnamefont {Martin-Delgado}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {R.}~\\bibnamefont {Blatt}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Science}\\ }\\textbf {\\bibinfo {volume}\n{345}},\\ \\bibinfo {pages} {302} (\\bibinfo {year} {2014})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Corcoles}\\ \\emph {et~al.}(2015)\\citenamefont\n{Corcoles}, \\citenamefont {Magesan}, \\citenamefont {Srinivasan},\n\\citenamefont {Cross}, \\citenamefont {Steffen}, \\citenamefont {Gambetta},\\\nand\\ \\citenamefont {Chow}}]{Corcoles15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~D.}\\ \\bibnamefont\n{Corcoles}}, \\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Magesan}},\n\\bibinfo {author} {\\bibfnamefont {S.~J.}\\ \\bibnamefont {Srinivasan}},\n\\bibinfo {author} {\\bibfnamefont {A.~W.}\\ \\bibnamefont {Cross}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Steffen}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Nat.\\ Commun.}\\ }\\textbf {\\bibinfo {volume}\n{{6}}} (\\bibinfo {year} {{2015}})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Ofek}\\ \\emph {et~al.}(2016)\\citenamefont {Ofek},\n\\citenamefont {Petrenko}, \\citenamefont {Heeres}, \\citenamefont {Reinhold},\n\\citenamefont {Leghtas}, \\citenamefont {Vlastakis}, \\citenamefont {Liu},\n\\citenamefont {Frunzio}, \\citenamefont {Girvin}, \\citenamefont {Jiang},\n\\citenamefont {Mirrahimi}, \\citenamefont {Devoret},\\ and\\ \\citenamefont\n{Schoelkopf}}]{Ofek16}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {N.}~\\bibnamefont\n{Ofek}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Petrenko}},\n\\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Heeres}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Reinhold}}, \\bibinfo {author}\n{\\bibfnamefont {Z.}~\\bibnamefont {Leghtas}}, \\bibinfo {author} {\\bibfnamefont\n{B.}~\\bibnamefont {Vlastakis}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Liu}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Frunzio}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\ \\bibnamefont {Girvin}},\n\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Jiang}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Mirrahimi}}, \\bibinfo {author}\n{\\bibfnamefont {M.~H.}\\ \\bibnamefont {Devoret}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {R.~J.}\\ \\bibnamefont {Schoelkopf}},\\ }\\href@noop {}\n{\\bibfield  {journal} {\\bibinfo  {journal} {arXiv:1602.04768}\\ } (\\bibinfo\n{year} {2016})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Blais}\\ \\emph {et~al.}(2004)\\citenamefont {Blais},\n\\citenamefont {Huang}, \\citenamefont {Wallraff}, \\citenamefont {Girvin},\\\nand\\ \\citenamefont {Schoelkopf}}]{Blais04}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Blais}}, \\bibinfo {author} {\\bibfnamefont {R.-S.}\\ \\bibnamefont {Huang}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Wallraff}}, \\bibinfo\n{author} {\\bibfnamefont {S.~M.}\\ \\bibnamefont {Girvin}}, \\ and\\ \\bibinfo\n{author} {\\bibfnamefont {R.~J.}\\ \\bibnamefont {Schoelkopf}},\\ }\\href@noop {}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo\n{volume} {69}},\\ \\bibinfo {pages} {062320} (\\bibinfo {year}\n{2004})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Petersson}\\ \\emph {et~al.}(2012)\\citenamefont\n{Petersson}, \\citenamefont {McFaul}, \\citenamefont {Schroer}, \\citenamefont\n{Jung}, \\citenamefont {Taylor}, \\citenamefont {Houck},\\ and\\ \\citenamefont\n{Petta}}]{Petersson12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {K.~D.}\\ \\bibnamefont\n{Petersson}}, \\bibinfo {author} {\\bibfnamefont {L.~W.}\\ \\bibnamefont\n{McFaul}}, \\bibinfo {author} {\\bibfnamefont {M.~D.}\\ \\bibnamefont {Schroer}},\n\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont {Jung}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Taylor}}, \\bibinfo {author}\n{\\bibfnamefont {A.~A.}\\ \\bibnamefont {Houck}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.~R.}\\ \\bibnamefont {Petta}},\\ }\\href\n{http://dx.doi.org/10.1038/nature11559} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {490}},\\ \\bibinfo {pages}\n{380} (\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Larsen}\\ \\emph {et~al.}(2015)\\citenamefont {Larsen},\n\\citenamefont {Petersson}, \\citenamefont {Kuemmeth}, \\citenamefont\n{Jespersen}, \\citenamefont {Krogstrup}, \\citenamefont {Nyg\\aa{}rd},\\ and\\\n\\citenamefont {Marcus}}]{Larsen15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {T.~W.}\\ \\bibnamefont\n{Larsen}}, \\bibinfo {author} {\\bibfnamefont {K.~D.}\\ \\bibnamefont\n{Petersson}}, \\bibinfo {author} {\\bibfnamefont {F.}~\\bibnamefont {Kuemmeth}},\n\\bibinfo {author} {\\bibfnamefont {T.~S.}\\ \\bibnamefont {Jespersen}}, \\bibinfo\n{author} {\\bibfnamefont {P.}~\\bibnamefont {Krogstrup}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Nyg\\aa{}rd}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {C.~M.}\\ \\bibnamefont {Marcus}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo\n{volume} {115}},\\ \\bibinfo {pages} {127001} (\\bibinfo {year}\n{2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {de~Lange}\\ \\emph {et~al.}(2015)\\citenamefont\n{de~Lange}, \\citenamefont {van Heck}, \\citenamefont {Bruno}, \\citenamefont\n{van Woerkom}, \\citenamefont {Geresdi}, \\citenamefont {Plissard},\n\\citenamefont {Bakkers}, \\citenamefont {Akhmerov},\\ and\\ \\citenamefont\n{DiCarlo}}]{deLange15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont\n{de~Lange}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {van Heck}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Bruno}}, \\bibinfo\n{author} {\\bibfnamefont {D.~J.}\\ \\bibnamefont {van Woerkom}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Geresdi}}, \\bibinfo {author}\n{\\bibfnamefont {S.~R.}\\ \\bibnamefont {Plissard}}, \\bibinfo {author}\n{\\bibfnamefont {E.~P. A.~M.}\\ \\bibnamefont {Bakkers}}, \\bibinfo {author}\n{\\bibfnamefont {A.~R.}\\ \\bibnamefont {Akhmerov}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo\n{volume} {115}},\\ \\bibinfo {pages} {127002} (\\bibinfo {year}\n{2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Groen}\\ \\emph {et~al.}(2013)\\citenamefont {Groen},\n\\citenamefont {Rist\\`e}, \\citenamefont {Tornberg}, \\citenamefont {Cramer},\n\\citenamefont {de~Groot}, \\citenamefont {Picot}, \\citenamefont {Johansson},\\\nand\\ \\citenamefont {DiCarlo}}]{Groen13}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~P.}\\ \\bibnamefont\n{Groen}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Rist\\`e}},\n\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {Tornberg}}, \\bibinfo\n{author} {\\bibfnamefont {J.}~\\bibnamefont {Cramer}}, \\bibinfo {author}\n{\\bibfnamefont {P.~C.}\\ \\bibnamefont {de~Groot}}, \\bibinfo {author}\n{\\bibfnamefont {T.}~\\bibnamefont {Picot}}, \\bibinfo {author} {\\bibfnamefont\n{G.}~\\bibnamefont {Johansson}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {DiCarlo}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {111}},\\ \\bibinfo\n{pages} {090506} (\\bibinfo {year} {2013})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Johnson}\\ \\emph {et~al.}(2012)\\citenamefont\n{Johnson}, \\citenamefont {Macklin}, \\citenamefont {Slichter}, \\citenamefont\n{Vijay}, \\citenamefont {Weingarten}, \\citenamefont {Clarke},\\ and\\\n\\citenamefont {Siddiqi}}]{Johnson12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~E.}\\ \\bibnamefont\n{Johnson}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont {Macklin}},\n\\bibinfo {author} {\\bibfnamefont {D.~H.}\\ \\bibnamefont {Slichter}}, \\bibinfo\n{author} {\\bibfnamefont {R.}~\\bibnamefont {Vijay}}, \\bibinfo {author}\n{\\bibfnamefont {E.~B.}\\ \\bibnamefont {Weingarten}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Clarke}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {I.}~\\bibnamefont {Siddiqi}},\\ }\\href {\\doibase\n10.1103/PhysRevLett.109.050506} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {109}},\\ \\bibinfo {pages}\n{050506} (\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rist\\`e}\\ \\emph\n{et~al.}(2012{\\natexlab{a}})\\citenamefont {Rist\\`e}, \\citenamefont {van\nLeeuwen}, \\citenamefont {Ku}, \\citenamefont {Lehnert},\\ and\\ \\citenamefont\n{DiCarlo}}]{Riste12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n{Rist\\`e}}, \\bibinfo {author} {\\bibfnamefont {J.~G.}\\ \\bibnamefont {van\nLeeuwen}}, \\bibinfo {author} {\\bibfnamefont {H.-S.}\\ \\bibnamefont {Ku}},\n\\bibinfo {author} {\\bibfnamefont {K.~W.}\\ \\bibnamefont {Lehnert}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href\n{\\doibase 10.1103/PhysRevLett.109.050507} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {109}},\\ \\bibinfo\n{pages} {050507} (\\bibinfo {year} {2012}{\\natexlab{a}})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Saira}\\ \\emph {et~al.}(2014)\\citenamefont {Saira},\n\\citenamefont {Groen}, \\citenamefont {Cramer}, \\citenamefont {Meretska},\n\\citenamefont {de~Lange},\\ and\\ \\citenamefont {DiCarlo}}]{Saira14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {O.-P.}\\ \\bibnamefont\n{Saira}}, \\bibinfo {author} {\\bibfnamefont {J.~P.}\\ \\bibnamefont {Groen}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Cramer}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Meretska}}, \\bibinfo {author}\n{\\bibfnamefont {G.}~\\bibnamefont {de~Lange}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo\n{volume} {112}},\\ \\bibinfo {pages} {070502} (\\bibinfo {year}\n{2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Reed}\\ \\emph {et~al.}(2010)\\citenamefont {Reed},\n\\citenamefont {Johnson}, \\citenamefont {Houck}, \\citenamefont {DiCarlo},\n\\citenamefont {Chow}, \\citenamefont {Schuster}, \\citenamefont {Frunzio},\\\nand\\ \\citenamefont {Schoelkopf}}]{Reed10b}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~D.}\\ \\bibnamefont\n{Reed}}, \\bibinfo {author} {\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}},\n\\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont {Houck}}, \\bibinfo\n{author} {\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\bibinfo {author}\n{\\bibfnamefont {D.~I.}\\ \\bibnamefont {Schuster}}, \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {Frunzio}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {R.~J.}\\ \\bibnamefont {Schoelkopf}},\\ }\\href@noop {}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Appl. Phys. Lett.}\\ }\\textbf\n{\\bibinfo {volume} {96}},\\ \\bibinfo {pages} {203110} (\\bibinfo {year}\n{2010})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Jeffrey}\\ \\emph\n{et~al.}(2014{\\natexlab{a}})\\citenamefont {Jeffrey}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {White}, \\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Chen}, \\citenamefont {Chen},\n\\citenamefont {Chiaro}, \\citenamefont {Dunsworth}, \\citenamefont {Megrant},\n\\citenamefont {O'Malley}, \\citenamefont {Neill}, \\citenamefont {Roushan},\n\\citenamefont {Vainsencher}, \\citenamefont {Wenner}, \\citenamefont\n{Cleland},\\ and\\ \\citenamefont {Martinis}}]{Jeffrey14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{Jeffrey}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Sank}},\n\\bibinfo {author} {\\bibfnamefont {J.~Y.}\\ \\bibnamefont {Mutus}}, \\bibinfo\n{author} {\\bibfnamefont {T.~C.}\\ \\bibnamefont {White}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont\n{Chen}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Chiaro}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Dunsworth}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {P.~J.~J.}\\ \\bibnamefont {O'Malley}}, \\bibinfo {author}\n{\\bibfnamefont {C.}~\\bibnamefont {Neill}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Roushan}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Vainsencher}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Wenner}}, \\bibinfo {author} {\\bibfnamefont {A.~N.}\\\n\\bibnamefont {Cleland}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\\n\\bibnamefont {Martinis}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {112}},\\ \\bibinfo\n{pages} {190504} (\\bibinfo {year} {2014}{\\natexlab{a}})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Houck}\\ \\emph {et~al.}(2008)\\citenamefont {Houck},\n\\citenamefont {Schreier}, \\citenamefont {Johnson}, \\citenamefont {Chow},\n\\citenamefont {Koch}, \\citenamefont {Gambetta}, \\citenamefont {Schuster},\n\\citenamefont {Frunzio}, \\citenamefont {Devoret}, \\citenamefont {Girvin},\\\nand\\ \\citenamefont {Schoelkopf}}]{Houck08}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont\n{Houck}}, \\bibinfo {author} {\\bibfnamefont {J.~A.}\\ \\bibnamefont {Schreier}},\n\\bibinfo {author} {\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo\n{author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Koch}}, \\bibinfo {author} {\\bibfnamefont\n{J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo {author} {\\bibfnamefont {D.~I.}\\\n\\bibnamefont {Schuster}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Frunzio}}, \\bibinfo {author} {\\bibfnamefont {M.~H.}\\ \\bibnamefont\n{Devoret}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\ \\bibnamefont {Girvin}},\n\\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\ \\bibnamefont {Schoelkopf}},\\\n}\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\\n}\\textbf {\\bibinfo {volume} {101}},\\ \\bibinfo {eid} {080502} (\\bibinfo {year}\n{2008})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Sears}\\ \\emph {et~al.}(2012)\\citenamefont {Sears},\n\\citenamefont {Petrenko}, \\citenamefont {Catelani}, \\citenamefont {Sun},\n\\citenamefont {Paik}, \\citenamefont {Kirchmair}, \\citenamefont {Frunzio},\n\\citenamefont {Glazman}, \\citenamefont {Girvin},\\ and\\ \\citenamefont\n{Schoelkopf}}]{Sears12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~P.}\\ \\bibnamefont\n{Sears}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Petrenko}},\n\\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont {Catelani}}, \\bibinfo\n{author} {\\bibfnamefont {L.}~\\bibnamefont {Sun}}, \\bibinfo {author}\n{\\bibfnamefont {H.}~\\bibnamefont {Paik}}, \\bibinfo {author} {\\bibfnamefont\n{G.}~\\bibnamefont {Kirchmair}}, \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont {L.~I.}\\\n\\bibnamefont {Glazman}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\\n\\bibnamefont {Girvin}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\\n\\bibnamefont {Schoelkopf}},\\ }\\href {\\doibase 10.1103/PhysRevB.86.180504}\n{\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. B}\\ }\\textbf {\\bibinfo\n{volume} {86}},\\ \\bibinfo {pages} {180504} (\\bibinfo {year}\n{2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Jin}\\ \\emph {et~al.}(2015)\\citenamefont {Jin},\n\\citenamefont {Kamal}, \\citenamefont {Sears}, \\citenamefont {Gudmundsen},\n\\citenamefont {Hover}, \\citenamefont {Miloshi}, \\citenamefont {Slattery},\n\\citenamefont {Yan}, \\citenamefont {Yoder}, \\citenamefont {Orlando},\n\\citenamefont {Gustavsson},\\ and\\ \\citenamefont {Oliver}}]{Jin15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {X.~Y.}\\ \\bibnamefont\n{Jin}}, \\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Kamal}}, \\bibinfo\n{author} {\\bibfnamefont {A.~P.}\\ \\bibnamefont {Sears}}, \\bibinfo {author}\n{\\bibfnamefont {T.}~\\bibnamefont {Gudmundsen}}, \\bibinfo {author}\n{\\bibfnamefont {D.}~\\bibnamefont {Hover}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Miloshi}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Slattery}}, \\bibinfo {author} {\\bibfnamefont\n{F.}~\\bibnamefont {Yan}}, \\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Yoder}}, \\bibinfo {author} {\\bibfnamefont {T.~P.}\\ \\bibnamefont {Orlando}},\n\\bibinfo {author} {\\bibfnamefont {S.}~\\bibnamefont {Gustavsson}}, \\ and\\\n\\bibinfo {author} {\\bibfnamefont {W.~D.}\\ \\bibnamefont {Oliver}},\\\n}\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys. Rev. Lett.}\\\n}\\textbf {\\bibinfo {volume} {114}},\\ \\bibinfo {pages} {240501} (\\bibinfo\n{year} {2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {McClure}\\ \\emph {et~al.}(2016)\\citenamefont\n{McClure}, \\citenamefont {Paik}, \\citenamefont {Bishop}, \\citenamefont\n{Steffen}, \\citenamefont {Chow},\\ and\\ \\citenamefont {Gambetta}}]{McClure16}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.~T.}\\ \\bibnamefont\n{McClure}}, \\bibinfo {author} {\\bibfnamefont {H.}~\\bibnamefont {Paik}},\n\\bibinfo {author} {\\bibfnamefont {L.~S.}\\ \\bibnamefont {Bishop}}, \\bibinfo\n{author} {\\bibfnamefont {M.}~\\bibnamefont {Steffen}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. Applied}\\ }\\textbf {\\bibinfo\n{volume} {5}},\\ \\bibinfo {pages} {011001} (\\bibinfo {year}\n{2016})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Powell}(1964)}]{Powell64}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~J.~D.}\\\n\\bibnamefont {Powell}},\\ }\\href {\\doibase 10.1093/comjnl/7.2.155} {\\bibfield\n{journal} {\\bibinfo  {journal} {The Computer Journal}\\ }\\textbf {\\bibinfo\n{volume} {7}},\\ \\bibinfo {pages} {155} (\\bibinfo {year} {1964})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Chow}\\ \\emph {et~al.}(2014)\\citenamefont {Chow},\n\\citenamefont {Gambetta}, \\citenamefont {Magesan}, \\citenamefont {Abraham},\n\\citenamefont {Cross}, \\citenamefont {Johnson}, \\citenamefont {Masluk},\n\\citenamefont {Ryan}, \\citenamefont {Smolin}, \\citenamefont {Srinivasan},\\\nand\\ \\citenamefont {Steffen}}]{Chow14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Chow}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}},\n\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont {Magesan}}, \\bibinfo\n{author} {\\bibfnamefont {D.~W.}\\ \\bibnamefont {Abraham}}, \\bibinfo {author}\n{\\bibfnamefont {A.~W.}\\ \\bibnamefont {Cross}}, \\bibinfo {author}\n{\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}}, \\bibinfo {author}\n{\\bibfnamefont {N.~A.}\\ \\bibnamefont {Masluk}}, \\bibinfo {author}\n{\\bibfnamefont {C.~A.}\\ \\bibnamefont {Ryan}}, \\bibinfo {author}\n{\\bibfnamefont {J.~A.}\\ \\bibnamefont {Smolin}}, \\bibinfo {author}\n{\\bibfnamefont {S.~J.}\\ \\bibnamefont {Srinivasan}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {M.}~\\bibnamefont {Steffen}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Nat.\\ Commun.}\\ }\\textbf {\\bibinfo {volume}\n{5}},\\ \\bibinfo {pages} {4015} (\\bibinfo {year} {2014})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {O'Brien}()}]{oBrien16}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {T.~E.}\\ \\bibnamefont\n{O'Brien}},\\ }\\href@noop {} {}\\bibinfo {howpublished} {in preparation\n(2016)}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Tomita}\\ and\\ \\citenamefont\n{Svore}(2014)}]{Tomita14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont\n{Tomita}}\\ and\\ \\bibinfo {author} {\\bibfnamefont {K.~M.}\\ \\bibnamefont\n{Svore}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. A}\\ }\\textbf {\\bibinfo {volume} {90}},\\ \\bibinfo {pages} {062320}\n(\\bibinfo {year} {2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Schuster}\\ \\emph {et~al.}(2007)\\citenamefont\n{Schuster}, \\citenamefont {Houck}, \\citenamefont {Schreier}, \\citenamefont\n{Wallraff}, \\citenamefont {Gambetta}, \\citenamefont {Blais}, \\citenamefont\n{Frunzio}, \\citenamefont {Majer}, \\citenamefont {Devoret}, \\citenamefont\n{Givin},\\ and\\ \\citenamefont {Schoelkopf}}]{Schuster07}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.~I.}\\ \\bibnamefont\n{Schuster}}, \\bibinfo {author} {\\bibfnamefont {A.~A.}\\ \\bibnamefont {Houck}},\n\\bibinfo {author} {\\bibfnamefont {J.~A.}\\ \\bibnamefont {Schreier}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Wallraff}}, \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo {author}\n{\\bibfnamefont {A.}~\\bibnamefont {Blais}}, \\bibinfo {author} {\\bibfnamefont\n{L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Majer}}, \\bibinfo {author} {\\bibfnamefont {M.~H.}\\\n\\bibnamefont {Devoret}}, \\bibinfo {author} {\\bibfnamefont {S.~M.}\\\n\\bibnamefont {Givin}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {R.~J.}\\\n\\bibnamefont {Schoelkopf}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n{journal} {Nature}\\ }\\textbf {\\bibinfo {volume} {445}},\\ \\bibinfo {pages}\n{515} (\\bibinfo {year} {2007})}\\BibitemShut {NoStop}%\n\\bibitem [{SOM()}]{SOMdepletion}%\n\\BibitemOpen\n\\href@noop {} {}\\bibinfo {howpublished} {See supplemental material.}\\BibitemShut {Stop}%\n\\bibitem [{\\citenamefont {Ryan}\\ \\emph {et~al.}(2015)\\citenamefont {Ryan},\n\\citenamefont {Johnson}, \\citenamefont {Gambetta}, \\citenamefont {Chow},\n\\citenamefont {da~Silva}, \\citenamefont {Dial},\\ and\\ \\citenamefont\n{Ohki}}]{Ryan15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {C.~A.}\\ \\bibnamefont\n{Ryan}}, \\bibinfo {author} {\\bibfnamefont {B.~R.}\\ \\bibnamefont {Johnson}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo\n{author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Chow}}, \\bibinfo {author}\n{\\bibfnamefont {M.~P.}\\ \\bibnamefont {da~Silva}}, \\bibinfo {author}\n{\\bibfnamefont {O.~E.}\\ \\bibnamefont {Dial}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {T.~A.}\\ \\bibnamefont {Ohki}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume}\n{91}},\\ \\bibinfo {pages} {022118} (\\bibinfo {year} {2015})}\\BibitemShut\n{NoStop}%\n\\bibitem [{\\citenamefont {Magesan}\\ \\emph {et~al.}(2015)\\citenamefont\n{Magesan}, \\citenamefont {Gambetta}, \\citenamefont {C\\'orcoles},\\ and\\\n\\citenamefont {Chow}}]{Magesan15}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{Magesan}}, \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Gambetta}}, \\bibinfo {author} {\\bibfnamefont {A.~D.}\\ \\bibnamefont\n{C\\'orcoles}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Chow}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. Lett.}\\ }\\textbf {\\bibinfo {volume} {114}},\\ \\bibinfo {pages} {200501}\n(\\bibinfo {year} {2015})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Chow}\\ \\emph {et~al.}(2010)\\citenamefont {Chow},\n\\citenamefont {DiCarlo}, \\citenamefont {Gambetta}, \\citenamefont {Motzoi},\n\\citenamefont {Frunzio}, \\citenamefont {Girvin},\\ and\\ \\citenamefont\n{Schoelkopf}}]{Chow10b}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont\n{Chow}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont {DiCarlo}},\n\\bibinfo {author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Gambetta}}, \\bibinfo\n{author} {\\bibfnamefont {F.}~\\bibnamefont {Motzoi}}, \\bibinfo {author}\n{\\bibfnamefont {L.}~\\bibnamefont {Frunzio}}, \\bibinfo {author} {\\bibfnamefont\n{S.~M.}\\ \\bibnamefont {Girvin}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont\n{R.~J.}\\ \\bibnamefont {Schoelkopf}},\\ }\\href@noop {} {\\bibfield  {journal}\n{\\bibinfo  {journal} {Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume} {82}},\\\n\\bibinfo {pages} {040305} (\\bibinfo {year} {2010})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Reed}(2013)}]{ReedPhD13}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.}~\\bibnamefont\n{Reed}},\\ }\\emph {\\bibinfo {title} {Entanglement and quantum error correction\nwith superconducting qubits}},\\ \\href@noop {} {\\bibinfo {type} {Ph{D}\n{D}issertation}},\\ \\bibinfo  {school} {Yale University} (\\bibinfo {year}\n{2013})\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Jeffrey}\\ \\emph\n{et~al.}(2014{\\natexlab{b}})\\citenamefont {Jeffrey}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {White}, \\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Chen}, \\citenamefont {Chen},\n\\citenamefont {Chiaro}, \\citenamefont {Dunsworth}, \\citenamefont {Megrant},\n\\citenamefont {O'Malley}, \\citenamefont {Neill}, \\citenamefont {Roushan},\n\\citenamefont {Vainsencher}, \\citenamefont {Wenner}, \\citenamefont\n{Cleland},\\ and\\ \\citenamefont {Martinis}}]{Sank14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {E.}~\\bibnamefont\n{Jeffrey}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Sank}},\n\\bibinfo {author} {\\bibfnamefont {J.~Y.}\\ \\bibnamefont {Mutus}}, \\bibinfo\n{author} {\\bibfnamefont {T.~C.}\\ \\bibnamefont {White}}, \\bibinfo {author}\n{\\bibfnamefont {J.}~\\bibnamefont {Kelly}}, \\bibinfo {author} {\\bibfnamefont\n{R.}~\\bibnamefont {Barends}}, \\bibinfo {author} {\\bibfnamefont\n{Y.}~\\bibnamefont {Chen}}, \\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont\n{Chen}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont {Chiaro}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Dunsworth}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {P.~J.~J.}\\ \\bibnamefont {O'Malley}}, \\bibinfo {author}\n{\\bibfnamefont {C.}~\\bibnamefont {Neill}}, \\bibinfo {author} {\\bibfnamefont\n{P.}~\\bibnamefont {Roushan}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Vainsencher}}, \\bibinfo {author} {\\bibfnamefont\n{J.}~\\bibnamefont {Wenner}}, \\bibinfo {author} {\\bibfnamefont {A.~N.}\\\n\\bibnamefont {Cleland}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {J.~M.}\\\n\\bibnamefont {Martinis}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo\n{journal} {Phys. Rev. Lett.}\\ }\\textbf {\\bibinfo {volume} {112}} (\\bibinfo\n{year} {2014}{\\natexlab{b}})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Fowler}\\ \\emph {et~al.}(2014)\\citenamefont {Fowler},\n\\citenamefont {Sank}, \\citenamefont {Kelly}, \\citenamefont {Barends},\\ and\\\n\\citenamefont {Martinis}}]{Fowler14}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont\n{Fowler}}, \\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont {Sank}},\n\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont {Kelly}}, \\bibinfo\n{author} {\\bibfnamefont {R.}~\\bibnamefont {Barends}}, \\ and\\ \\bibinfo\n{author} {\\bibfnamefont {J.~M.}\\ \\bibnamefont {Martinis}},\\ }\\href@noop {}\n{\\bibfield  {journal} {\\bibinfo  {journal} {arXiv:1405.1454}\\ } (\\bibinfo\n{year} {2014})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Frisk~Kockum}\\ \\emph {et~al.}(2012)\\citenamefont\n{Frisk~Kockum}, \\citenamefont {Tornberg},\\ and\\ \\citenamefont\n{Johansson}}]{FriskKockum12}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont\n{Frisk~Kockum}}, \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{Tornberg}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {G.}~\\bibnamefont\n{Johansson}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal}\n{Phys. Rev. A}\\ }\\textbf {\\bibinfo {volume} {85}},\\ \\bibinfo {pages} {052318}\n(\\bibinfo {year} {2012})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rist\\`e}\\ \\emph\n{et~al.}(2012{\\natexlab{b}})\\citenamefont {Rist\\`e}, \\citenamefont {Bultink},\n\\citenamefont {Lehnert},\\ and\\ \\citenamefont {DiCarlo}}]{Riste12b}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {D.}~\\bibnamefont\n{Rist\\`e}}, \\bibinfo {author} {\\bibfnamefont {C.~C.}\\ \\bibnamefont\n{Bultink}}, \\bibinfo {author} {\\bibfnamefont {K.~W.}\\ \\bibnamefont\n{Lehnert}}, \\ and\\ \\bibinfo {author} {\\bibfnamefont {L.}~\\bibnamefont\n{DiCarlo}},\\ }\\href@noop {} {\\bibfield  {journal} {\\bibinfo  {journal} {Phys.\nRev. Lett.}\\ }\\textbf {\\bibinfo {volume} {109}},\\ \\bibinfo {pages} {240502}\n(\\bibinfo {year} {2012}{\\natexlab{b}})}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Rol}()}]{Rol16}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {M.~A.}\\ \\bibnamefont\n{Rol}},\\ }\\href@noop {} {}\\bibinfo {howpublished} {in preparation\n(2016)}\\BibitemShut {NoStop}%\n\\bibitem [{\\citenamefont {Kelly}\\ \\emph {et~al.}(2016)\\citenamefont {Kelly},\n\\citenamefont {Barends}, \\citenamefont {Fowler}, \\citenamefont {Megrant},\n\\citenamefont {Jeffrey}, \\citenamefont {White}, \\citenamefont {Sank},\n\\citenamefont {Mutus}, \\citenamefont {Campbell}, \\citenamefont {Chen},\n\\citenamefont {Chen}, \\citenamefont {Chiaro}, \\citenamefont {Dunsworth},\n\\citenamefont {Lucero}, \\citenamefont {Neeley}, \\citenamefont {Neill},\n\\citenamefont {O'Malley}, \\citenamefont {Quintana}, \\citenamefont {Roushan},\n\\citenamefont {Vainsencher}, \\citenamefont {Wenner},\\ and\\ \\citenamefont\n{Martinis}}]{Kelly16}%\n\\BibitemOpen\n\\bibfield  {author} {\\bibinfo {author} {\\bibfnamefont {J.}~\\bibnamefont\n{Kelly}}, \\bibinfo {author} {\\bibfnamefont {R.}~\\bibnamefont {Barends}},\n\\bibinfo {author} {\\bibfnamefont {A.~G.}\\ \\bibnamefont {Fowler}}, \\bibinfo\n{author} {\\bibfnamefont {A.}~\\bibnamefont {Megrant}}, \\bibinfo {author}\n{\\bibfnamefont {E.}~\\bibnamefont {Jeffrey}}, \\bibinfo {author} {\\bibfnamefont\n{T.~C.}\\ \\bibnamefont {White}}, \\bibinfo {author} {\\bibfnamefont\n{D.}~\\bibnamefont {Sank}}, \\bibinfo {author} {\\bibfnamefont {J.~Y.}\\\n\\bibnamefont {Mutus}}, \\bibinfo {author} {\\bibfnamefont {B.}~\\bibnamefont\n{Campbell}}, \\bibinfo {author} {\\bibfnamefont {Y.}~\\bibnamefont {Chen}},\n\\bibinfo {author} {\\bibfnamefont {Z.}~\\bibnamefont {Chen}}, \\bibinfo {author}\n{\\bibfnamefont {B.}~\\bibnamefont {Chiaro}}, \\bibinfo {author} {\\bibfnamefont\n{A.}~\\bibnamefont {Dunsworth}}, \\bibinfo {author} {\\bibfnamefont\n{E.}~\\bibnamefont {Lucero}}, \\bibinfo {author} {\\bibfnamefont\n{M.}~\\bibnamefont {Neeley}}, \\bibinfo {author} {\\bibfnamefont\n{C.}~\\bibnamefont {Neill}}, \\bibinfo {author} {\\bibfnamefont {P.~J.~J.}\\\n\\bibnamefont {O'Malley}}, \\bibinfo {author} {\\bibfnamefont {C.}~\\bibnamefont\n{Quintana}}, \\bibinfo {author} {\\bibfnamefont {P.}~\\bibnamefont {Roushan}},\n\\bibinfo {author} {\\bibfnamefont {A.}~\\bibnamefont {Vainsencher}}, \\bibinfo\n{author} {\\bibfnamefont {J.}~\\bibnamefont {Wenner}}, \\ and\\ \\bibinfo {author}\n{\\bibfnamefont {J.~M.}\\ \\bibnamefont {Martinis}},\\ }\\href@noop {} {\\bibfield\n{journal} {\\bibinfo  {journal} {arXiv:1603.03082}\\ } (\\bibinfo {year}\n{2016})}\\BibitemShut {NoStop}%\n\\end{thebibliography}%\n\n\\clearpage\n\n\\renewcommand{\\theequation}{S\\arabic{equation}}\n\\renewcommand{\\thefigure}{S\\arabic{figure}}\n\\renewcommand{\\thetable}{S\\arabic{table}}\n\\setcounter{figure}{0}\n\\setcounter{equation}{0}\n\\setcounter{table}{0}{}\n%\n%# Supplementary material for  ``Active resonator reset in the nonlinear dispersive regime of circuit QED''\n\n\\section*{Supplementary material for  ``Active resonator reset in the nonlinear dispersive regime of circuit QED''}\n\\\n% \\author{C.~C.~Bultink}\n% \\author{M.~A.~Rol}\n% \\affiliation{QuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\affiliation{Kavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\author{T.~E.~O'Brien}\n% \\affiliation{Instituut-Lorentz for Theoretical Physics, Leiden University, Leiden, The Netherlands}\n% \\author{X.~Fu}\n% \\affiliation{QuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\affiliation{College of Computer, National University of Defense Technology, Changsha, China 410073}\n% \\author{B.~C.~S.~Dikken}\n% \\author{R.~Vermeulen}\n% \\affiliation{QuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\affiliation{Kavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n\n% \\author{J.~C.~de~Sterke}\n% \\affiliation{Topic Embedded Systems B.V., P.O. Box 440, 5680 AK Best, The Netherlands}\n% \\affiliation{QuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\author{A.~Bruno}\n\n% \\author{R.~N.~Schouten}\n% \\author{L.~DiCarlo}\n% \\affiliation{QuTech, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\affiliation{Kavli Institute of Nanoscience, Delft University of Technology, P.O. Box 5046, 2600 GA Delft, The Netherlands}\n% \\date{\\today}\n\nThis supplement provides additional figures and a description of the theoretical models used to model the QEC emulation experiments.\n\n\\section{Additional Figures}\n\\label{sec:som_figs}\n\\subsection{Experimental setup}\nFigure~\\ref{fig:figS1} shows the device and experimental setup, including a full wiring diagram. The chip contains ten transmon qubit-resonator pairs.\nAll experiments presented target pair 2.\nThe experimental setup is similar to that of previous experiments~\\cite{Riste15_b}, but with an important addition labeled QuTech Control Box.\nThis homebuilt controller, comprised of 4 interconnected field-programmable gate arrays (Altera Cyclone IV), has digitizing and waveform generation capabilities.\nThe 2-channel digitizer samples with 8-bit resolution at $200\u00a0$. The 6-channel waveform generator produces qubit and resonator pulse envelopes with 14-bit resolution at $200\u00a0$.\n\n\\begin{figure*}[hbt!]\n\\centering\n\\includegraphics[width=1.4\\columnwidth]{FigS1.pdf}\n\\caption{{\\bf Experimental setup.} Photograph of the cQED chip and complete wiring diagram of electronic components inside and outside the $^3$He/$^4$He dilution refrigerator (Leiden Cryogenics CF-450).\nThe chip contains ten transmon qubits individually coupled to dedicated readout resonators.\nAll resonators couple capacitively to the common feedline traversing the chip.\nAll data shown correspond to qubit-resonator pair 2. Dark features traversing the coplanar waveguide transmission lines are NbTiN bridges which interconnect ground planes and suppress slot-line mode propagation.\n}\n\\label{fig:figS1}\n\\end{figure*}\n\n\\subsection{Photon number calibration}\nFigure~\\ref{fig:figS2} contains the calibration of the photon number using AllXY error ($$) as a detector.\n$$ is defined as the average absolute deviation from the ideal 2-step result in an AllXY experiment.\nTo calibrate the detector the resonator is populated using a long ($1800\u00a0$) readout pulse with a varying pulse amplitude before measuring the AllXY.\nThis pulse amplitude is converted to an average photon number using the single-photon power that is extracted from a photon number splitting experiment.\nWe fit the form $=\u03b1+\u03b2$ to the data for each input state separately, with $\u03b1$ and $\u03b2$ as free parameters.\nThe best-fit functions are used throughout the experiment to convert $$ to $$.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=\\linewidth]{FigS2.pdf}\n\\caption{{\\bf Calibration of photon number using AllXY error.}\n$$ measured directly after a readout pulse of $1800\u00a0$ duration drives the resonator into a steady-state photon population, $$, for input states $|0\u27e9$ and $|1\u27e9$.\nThe lines show a bilinear fit to the form $=\u03b1+\u03b2$.\nInset: photon-number splitting experiment~\\cite{Schuster07_b} used to calibrate the single-photon power level, $\u223c-130\u00a0$.}\n\\label{fig:figS2}\n\\end{figure}\n\n\\subsection{Constant excited state QEC emulation}\nFigure~\\ref{fig:figS3} shows the emulated multi-round QEC for a non-flipping ancilla when the qubit is initialized in the excited state.\nThis variant of the emulation uses the same sequence as Fig.~4 but with the qubit initialized in $|1\u27e9$.\nVarying $$, we find the optimum tradeoff between errors induced by leftover photons and by relaxation for the three methods. Unconditional depletions performs best, increasing $$ by a factor $2.5$ with respect to passive depletion. Note that passive depletion produces a spurious increase in $$ for very short $$.\nThe high photon number detunes the qubit so much that qubit pulses are inoperative, causing the qubit to remain in the same state and yielding long strings of identical, expected measurement outcomes.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=1\\linewidth]{FigS3.pdf}\n\\caption{{\\bf Emulated multi-round QEC: non-flipping ancilla in $|1\u27e9$.}\nThis variant of the emulation uses the same sequence as Fig.~4 but with the qubit initialized in $|1\u27e9$.\n(a) Mean rounds to error detection event, $$, as a function of $$.\n(b) Per-round probability of encountering event of type $$ as a function of $$.\nAdded curves correspond to the simple and extensive models described in Sec.~\\ref{sec:model}.}\n\\label{fig:figS3}\n\\end{figure}\n\n\\subsection{Optimal depletion pulse characterization}\nFigures~S4 and~S5 summarize our further investigation of depletion-pulse optimizations for conditional and unconditional depletion, respectively.\nFor a variety of pulse lengths $$, the optimized pulse amplitudes and phase parameters are shown, along with residual photon levels and results for multi-round QEC emulation.\n\nFor conditional depletion, the optimal amplitude $A_0$ ($A_1$) of $$ ($$) decreases smoothly as $$ increases, whereas the optimal phase $\u03d5_0$ ($\u03d5_1$) remains constant.\nThe discrimination infidelity $1-$ is inferred from single-shot readout histogram experiments and is defined as the fraction of overlap of the best-fit gaussians.\nThe residual photon number and readout discrimination infidelity do not show any dependence on $$.\nAs expected, there is no dependence of the fidelity on $$ as there is no overlap between the depletion pulse and integration window.\nThe average rounds to event and per-round probability of type-$$ event for emulated QEC in the flipping configuration do not show any dependence on $$ either.\n\nFor unconditional depletion, the optimal values of the four parameters defining the universal depletion pulse $$ evolve smoothly as $$ is varied.\nThe optimized $$ first decreases weakly with decreasing $$ but increases sharply for $<250\u00a0$.\nA smooth decrease in $$ is observed for decreasing $$. We attribute this effect to the overlap between $$ and the measurement integration window.\n$$ is unchanged for $>270\u00a0$, suggesting a trade-off between errors due to $$ and $$.\nThis trade-off is reflected in the corresponding increase of per-round probability of type-$$ event.\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=1\\linewidth]{FigS4.pdf}\n\\caption{{\\bf Characterization of conditional depletion as a function of depletion pulse length $$.}\nThe dashed line indicates $=30\u00a0$, used in Figs.~2 to 4 and Fig.~\\ref{fig:figS3}.\nAll data were taken at a fixed $=500\u00a0$.\n(a) Optimal pulse parameters.\n(b) Residual photon number for both qubit states and discrimination fidelity $$.\n(c) Average rounds to event and per-round probability of type-$$ event for emulated QEC in the flipping configuration.\n}\n\\label{fig:figS4}\n\\end{figure}\n\n\\begin{figure}\n\\centering\n\\includegraphics[width=1\\linewidth]{FigS5}\n\\caption{{\\bf Characterization of unconditional depletion as a function of depletion pulse length $$.}\nThe dashed line indicates $=330\u00a0$, used in Figs.~2 to 4 and Fig.~\\ref{fig:figS3}.\nAll data were taken at a fixed depletion time of $=400\u00a0$\n(a) Optimal pulse parameters.\n(b) Residual photon number for both qubit states and discrimination fidelity $$.\n(c) Average rounds to event and per-round probability of $$-event for emulated QEC in the flipping configuration.\n}\n\\label{fig:figS5}\n\\end{figure}\n\n%\\clearpage\n\\newpage\n\\section{Theoretical Models}\n\\label{sec:model}\nWe use two models to compare to data in Figs.~3,~4, and~S3 labelled simple and extensive.\nThe simple model includes ancilla relaxation and intrinsic dephasing, providing an upper bound for the performance of the emulated multi-round QEC circuit.\nThe extensive model further includes ancilla readout error and detuning and dephasing from the photon-induced AC Stark shift.\nThese models use separately calibrated parameters.\n\nThe ancilla sans photon field is modeled considering amplitude and phase damping as in~\\cite{Nielsen00}.\nSingle-qubit gates are approximated as $40\u00a0$ decay windows with perfect instantaneous pulses in the middle.\nThis leads to the following scheme: $+20\u00a0$ of $$ decay, followed by a $\u03c0/2$ pulse, then $160\u00a0$ of $$ decay (with a $\u03c0$ pulse in the middle), another $\u03c0/2$ pulse, and $20\u00a0$ of $$ decay.\n\nMeasurement is modeled as a perfect state update $S_1$, followed by a $=300\u00a0$ decay window, and a second state update $S_2$. The measurement signal is conditioned both on the state post-$S_1$ ($|\u03c8_i$) and post-$S_2$ ($|\u03c8_o$). If $|\u03c8_i=|\u03c8_o$ no decay occurred, and the incorrect measurement is returned with probability $1-=0.1\n`&12`#12`1\u03022`_12`\nstartlink[1]\nendlink[0]\n\nrl [1]href #1\n\n@bib@innerbibempty\n\n[Rist\u00e8 et\u00a0al.(2015)Rist\u00e8, Poletto, Huang, Bruno, Vesterinen, Saira, and  DiCarlo]Riste15_b\nauthor author D.\u00a0Rist\u00e8, author S.\u00a0Poletto,\nauthor M.\u00a0Z. Huang, author A.\u00a0Bruno, author\nV.\u00a0Vesterinen, author\nO.\u00a0P. Saira,  and author\nL.\u00a0DiCarlo, @noop  journal journal Nat. Commun. volume\n6 (year 2015)NoStop\n[Schuster et\u00a0al.(2007)Schuster, Houck, Schreier, Wallraff, Gambetta, Blais, Frunzio, Majer, Devoret, Givin, and Schoelkopf]Schuster07_b\nauthor author D.\u00a0I. Schuster, author A.\u00a0A. Houck,\nauthor J.\u00a0A. Schreier, author A.\u00a0Wallraff, author\nJ.\u00a0M. Gambetta, author\nA.\u00a0Blais, author L.\u00a0Frunzio, author J.\u00a0Majer, author M.\u00a0H.  Devoret, author S.\u00a0M.  Givin,  and author R.\u00a0J.  Schoelkopf, @noop  journal journal Nature volume 445, pages\n515 (year 2007)NoStop\n[Nielsen and Chuang(2000)]Nielsen00\nauthor author M.\u00a0A. Nielsen and author I.\u00a0L. Chuang, @noop  title Quantum Computation and\nQuantum Information (publisher Cambridge University Press,  address Cambridge, year 2000)NoStop\n[Frisk\u00a0Kockum et\u00a0al.(2012)Frisk\u00a0Kockum, Tornberg, and Johansson]FriskKockum12_b\nauthor author A.\u00a0Frisk\u00a0Kockum, author L.\u00a0Tornberg,  and author G.\u00a0Johansson, @noop  journal journal\nPhys. Rev. A volume 85, pages 052318\n(year 2012)NoStop\n\n"}
{"prompt": "Explain the methodology used in the paper 'Paper 0707.0963'.", "completion": "\n\n./graphics/\n\nrm -R /tmp/bench1q; mkdir /tmp/bench1q\ncp `texfls bench1q.log | perl -e '$a=<>; $a =\u00a0 s:/*(revtex4|natbib)*(|$)::g; print \"$a\"'` /tmp/bench1q\nfind /tmp/bench1q -type f -name '*.pdf' -exec pdftops -eps    -exec rm\nfind /tmp/bench1q -type f -name '*.jpg' -exec perl -e '$f=shift; $g=f$; $g=\u00a0s/.jpg/.eps/; exec(\"convert $f $g\");'    -exec rm\n\n(cd /tmp/bench1q; tar czvf bench1q.tar.gz *)\n\nrm -R /tmp/bench1q; mkdir /tmp/bench1q\ncp `texfls bench1q.log | perl -e '$a=<>; $a =\u00a0 s:/*(revtex4|natbib)*(|$)::g; print \"$a\"'` /tmp/bench1q\nfind /tmp/bench1q -type f -name '*.pdf' -exec pdftops -eps    -exec rm\nfind /tmp/bench1q -type f -name '*.jpg' -exec perl -e '$f=shift; $g=f$; $g=\u00a0s/.jpg/.eps/; exec(\"convert $f $g\");'    -exec rm\n\ni\u03c3_u\u03c0/4$, with $u=x,y$. The sign and $u$ are chosen uniformly\nat random, except for the last $\u03c0/2$ pulse, where $u$ is chosen so\nthat the final state is an eigenstate of $\u03c3_z$.  The\ncomputational gates generate the Clifford group for one qubit. Their\nchoice is motivated by the fact that they are experimentally\nimplementable as simple pulses.  The final measurement is a\nvon Neumann measurement of $\u03c3_z$.  The last $\u03c0/2$ pulse ensures\nthat, in the absence of errors, the measurement has a known,\ndeterministic outcome for a given pulse sequence. However, the\nrandomization of the pulse sequence ensures that the outcome is not\ncorrelated with any individual pulse or proper subsequence of pulses.\n\nThe length $l$ of a randomized pulse sequence is its number of $\u03c0/2$\npulses. The $\u03c0/2$ pulses are considered to be the ones that advance\na computation. The $\u03c0$ pulses serve only to randomize the\nerrors. One can view their effect as being no more than a change of\nthe Pauli frame. The Pauli frame consists of the Pauli operator that\nneeds to be applied to obtain the intended computational state in the\nstandard basis~\\cite{knill:qc2005a}. We call the $\u03c0/2$ and Pauli\npulse combinations randomized computational gates.  In principle, we\ncan determine a pulse error rate by performing $N$ experiments for\neach length $l=1,\u2026,L$ to estimate the average probability $p_l$\nof the incorrect measurement outcome (or ``error probability'') for\nsequences of length $l$. The relationship between $l$ and $p_l$ can be\nused to obtain an average probability of error per pulse.  Suppose\nthat all errors are independent and depolarizing.  Let the\ndepolarization probability of an operation $A$ be $d_A$ and consider a\nspecific pulse sequence consisting of operations\n$A_0,A_1A_2,\u2026,A_2l+1A_2l+2,A_2l+3$, where $A_0$ is the\nstate preparation, $A_1A_2$ and the following pairs are the randomized\ncomputational gates, and $A_2l+3$ the measurement.  For the\nmeasurement, we can assume that the error immediately precedes a\nperfect measurement.  The state after $A_k$ is a known eigenstate of a\nPauli operator or completely depolarized. Depolarization of the state\nis equivalent to applying a random Pauli or identity operator, each\nwith probability $1/4$.  The probability of the state's not having\nbeen depolarized is $\u220f_j=0^k(1-d_A_j)$. In particular, we can\nexpress $p_l = E((1-\u220f_j=0^2l+3 (1-d_A_j))/2)$, where the\nfunction $E(.)$ gives the expectation over the random choices of the\n$A_j$. The factor of $1/2$ in the expression for $p_l$ arises because\ndepolarization results in the correct state $1/2$ of the time.  The\nchoices of the $A_j$ are independent except for the last $\u03c0/2$\npulse.  Assume that the depolarization probability of the last $\u03c0/2$\npulse does not depend on the previous pulses. We can then write $p_l =\n(1-(1-d_if)(1-d)^l)/2$, where $d$ is the average\ndepolarization probability of a random combination of one $\u03c0/2$- and\none Pauli pulse (a randomized computational gate), and\n$d_if$ combines the depolarization probabilities of the\npreparation, initial Pauli pulse and measurement. Thus $p_l$ decays\nexponentially to $1/2$, and the decay constant yields $d$.\n\nA commonly used metric to describe the deviation of an\nimplemented gate from the intended gate is the average fidelity $F_a$,\nwhich is defined as the uniform average over pure input states of the\nfidelity of the output state with respect to the intended output state.  We are\ninterested in the average computationally relevant error per step\nconsisting of a randomized computational gate (``average error'' for\nshort). This is given by the expectation over gates of $1-F_a$ and\nrelates to the depolarization parameter $d$ of the previous paragraph\nby $1-F_a=d/2$.  In our implementation of the randomized computational\ngates, the $\u03c0$ pulses around the $z$-axis are implemented by changes\nin rotating frame and do not involve actively applying a pulse.\nTherefore, on average, the angular distance of the randomized gate's\naction is $\u03c0$. As a result, $(1-d/2)$ represents the average\nfidelity of pulses with action $\u03c0$.\n\nAlthough estimates of $p_l$ are sufficient to obtain the average error\nfor a randomized computational gate, it is useful to\nconsider the error behavior of specific randomized computations and\neven fixed instances of the randomized sequences.  For this purpose,\nthe sequences are generated by first producing $N_G$ random sequences\nconsisting of $L$ random computational gates, where the gates are\nchosen independently without considering the final state. These\nsequences are considered to be a sample of typical computations. Each\nsequence is then truncated at different lengths. For each length, a\n$\u03c0/2$ pulse is appended to ensure that the final state is an\neigenstate of $\u03c3_z$. The sign of this final pulse is\nrandom.  The resulting sequences are randomized by\ninserting the random Pauli pulses. We can then perform experiments to\ndetermine the probability of incorrect measurement outcomes for each\nsuch sequence and for each truncated computation after randomization\nby Pauli pulses. To be specific, the procedure is implemented as\nfollows:\n\\begin{list}{}{}\n\\item[\\textbf{Randomized benchmarking for one qubit:}] This obtains\nmeasurement statistics for $N_G  N_l N_P N_e$ experiments, where $N_G$ is\nthe number of different computational gate sequences, $N_l$ is the\nnumber of lengths to which the sequences are truncated, $N_P$ is the\nnumber of Pauli randomizations for each gate sequence, and $N_e$ is\nthe number of experiments for each specific sequence.\n\\item[1.] Pick a set of lengths $l_1<l_2<\u2026<l_N_l$. The goal\nis to determine the probability of error of randomized\ncomputations of each length.\n\\item[2.] Do the following for each $j=1,\u2026,N_G$:\n\\begin{list}{}{}\n\\item[2.a.] Choose a random sequence $={G_1,\u2026}$ of $l_N_l-1$\ncomputational gates.\n\\item[2.b.] For each $k=1,\u2026,N_l$ do the following:\n\\begin{list}{}{}\n\\item[2.b.1.] Determine the final state $\u03c1_f$ obtained by\napplying $G_l_k\u2026G_1$ to $|0\u27e9$, assuming no error.\n\\item[2.b.2.] Randomly pick a final computational gate $R$\namong the two $\u00b1x, \u00b1y, \u00b1z$ axis $\u03c0/2$ pulses that result in an eigenstate\nof $\u03c3_z$ when applied to $\u03c1_f$. Record which eigenstate is\nobtained.\n\\item[2.b.3.] Do the following for each $m=1,\u2026N_P$:\n\\begin{list}{}{}\n\\item[2.b.3.a] Choose a random sequence $={P_1,\u2026}$\nof $l_k+2$ Pauli pulses.\n\\item[2.b.3.b.] Experimentally implement the pulse sequence\nthat applies $P_l_k+2RP_l_k+1G_l_k\u2026G_1P_1$ to $|0\u27e9$\nand measures $\u03c3_z$, repeating the experiment $N_e$ times.\n\\item[2.b.3.c.] From the experimental data and the expected\noutcome of the experiments in the absence of errors (from step 2.b.2),\nobtain an estimate $p_j,l_k,m$ of the probability of error.\nRecord the uncertainty of this estimate.\n\\end{list}\n\\end{list}\n\\end{list}\n\\end{list}\nThe probabilities of error $p_l$ are obtained from the $p_j,l_k,m$\nby averaging $p_l_k =\n\u2211_j=1^N_G\u2211_m=1^N_Pp_j,l_k,m/(N_G N_P)$.  We also obtain\nthe probabilities of error for each computational gate sequence,\n$p_j,l_k = \u2211_m=1^N_Pp_j,l_k,m/N_P$. If the errors are\nindependent and depolarizing, the $p_j,l_k,m$ and the $p_j,l_k$\nshould not differ significantly from the $p_l_k$. However, if the\nerrors are systematic in the sense that each implemented pulse differs\nfrom the ideal pulse by a pulse-dependent unitary operator, this can\nbe observed in the distribution of the $p_j,l_k,m$ over $m$.  In\nthis case, the final state of each implemented pulse sequence is pure.\nThe deviation of these pure states from the expected states is\ndistributed over the Bloch sphere as $m$ and $j$ are varied. For\nexample, consider the case where $p_l_k$ is close to $1/2$. If the errors\nare systematic, the $p_j,l_k,m$ are distributed as the probability amplitude of\n$|1\u27e9$ for a random pure state. In particular, we are likely to\nfind many instances of $j$ and $m$ where $p_j,l_k,m$ is close to $0$\nor $1$, that is, differs significantly from $1/2$. In contrast, if the\nerror is depolarizing, the $p_j,l_k,m$ are all close to $1/2$\nindependent of $j$ and $m$.\n\n\\section{Trapped-ion-qubit implementation}\n\nWe determined the computationally relevant error probabilities for\ncomputational gates on one qubit in an ion trap.  The qubit was\nrepresented by two ground-state hyperfine levels of a\n$^9Be^+$ ion trapped in a linear radio-frequency Paul trap\nbriefly described in~\\cite{wineland:qc2005a}. It is the same trap that\nhas been used in a several quantum information processing\nexperiments~\\cite{barrett:qc2004a,chiaverini:qc2004a,chiaverini:qc2005a,leibfried:qc2005a,reichle:qc2006a}.\nThe two qubit states are $|\u2193\u27e9$ ($F=2,m_F=-2$) and\n$|\u2191\u27e9$ ($F=1,m_F=-1$), where for our purposes, we identify\n$|\u2193\u27e9$ with $|0\u27e9$ and $|\u2191\u27e9$ with $|1\u27e9$.\nThe state $|\u2193\u27e9$ is prepared by optical pumping, after\nlaser cooling the motional states of the ion.  We can distinguish\nbetween $|\u2193\u27e9$ and $|\u2191\u27e9$ by means of\nstate-dependent laser fluorescence. Computational gates and Pauli\npulses involving $x$- or $y$-axis rotations were implemented by means\nof two-photon stimulated Raman transitions. To ensure that the pulses\nwere not sensitive to the remaining excitations of the motional\ndegrees of freedom, we used copropagating Raman beams. It was\ntherefore not necessary to cool to the motional ground state and only\nDoppler cooling was used. Pulses involving $z$-axis rotations were\nimplemented by programmed phase changes of one of the Raman\nbeams. This changes the phase of the rotating reference frame and is\nequivalent to the the desired $z$-axis rotation.  The $z$-axis\nrotations were accompanied by a delay equivalent to the correponding\n$x$ and $y$ pulses.\n\nThe Raman beams were switched on and off and shifted in phase and\nfrequency as necessary by means of acousto-optic modulators\ncontrolled by a field-programmable gate array (FPGA). The pulse sequences\nwere written in a special-purpose pulse-programming language and\nprecompiled onto the FPGA. The version of the FPGA in use for the\nexperiments was limited to about 100 computational pulses. The longest\nsequence in our experiments consisted of 96 computational gates. Our\ninitial implementations clearly showed the effects of systematic\nerrors in the distribution of the error probabilities of individual\nsequences.  This proved to be a useful diagnostic and we were able to\ncorrect these systematics to some extent. One of the largest\ncontributions to systematic errors was due to Stark shifts.  To\ncorrect for for these shifts, we calibrated them and adjusted phases\nin the pulse sequences.\n\n\\section{Experimental results}\n\nWe generated $N_G=4$ random computational sequences and truncated them\nto the $N_l=17$ lengths\n${2,3,4,5,6,8,10,12,16,20,24,32,40,48,64,80,96}$.  Each truncated\nsequence was Pauli randomized $N_P=8$ times. Each final pulse sequence\nwas applied to an ion a total of $8160$ times in four groups that\nwere interleaved with the other experiments in a randomized\norder. Pulse durations, qubit-resonant frequencies and Stark shifts\nwere recalibrated automatically at regular intervals. The number of\nexperiments per pulse sequence was sufficient to obtain the\nprobability of incorrect measurement outcome with a statistical error\nsmall compared to the variation due to randomization and systematic\nerrors. Fig.~\\ref{fig:each_all} plots the fidelity (one minus the\nprobability of incorrect measurement outcome) of each of the\n$4*17*8=544$ final pulse sequences against the length of the\ncorresponding computational sequence. As explained in the figure caption,\nthe variation in fidelity for\neach length shows that non-depolarizing errors contribute\nsignificantly to error. Fig.~\\ref{fig:merged_allwl} plots the average\nfidelity over the eight Pauli randomizations of each computational\nsequence truncated to the different lengths.  Pauli randomization\nremoves coherent errors, significantly reducing the variation in\nfidelities for different computational sequences.  The remaining\nvariation could be due to the small sample of $8$ Pauli randomizations\nused to obtain the average. The empirical average probability of error\nper randomized computational gate can be obtained by fitting the\nexponential decay and was found to be $0.00482(17)$.  The fit was\nconsistent with a simple exponential decay, which suggests that these\ngates behave similarly in all computational contexts.  The error bars\nrepresent standard deviation as determined by\nnonparameteric bootstrapping~\\cite{efron:qc1993a}. In what follows,\nif the fits are good, error bars are determined\nfrom nonlinear least-squares fits. In the cases where we can obtain a\nuseful estimate of an error per randomized computational gate but the\nfits are poor, we used nonparameteric bootstrapping.\n\n\\begin{figure}\n\\begin{cntrpict}(3,3)(0,-3)\n\\nputgr{0,0}{tl}{width=3in}{each_all1_a}\n\\nputbox{-.1,-1.5}{l}{\\rotatebox{90}{\\large\\textsf{Fidelity}}}\n\\nputbox{1.5,-3}{b}{\\large\\textsf{Number of computational gates}}\n\\end{cntrpict}\n\\caption{Fidelity as a function of the number of steps for each\nrandomized sequence. The fidelity ($1-prob.\u00a0of error$) is\nplotted on a logarithmic scale. The fidelity for the final state is\nmeasured for each randomized sequence. There are $32$ points for each\nnumber of steps, corresponding to $8$ randomizations of each of four\ndifferent computational sequences. Different symbols are used for the\ndata for each computational sequence.  The standard error of each\npoint is between $0.001$ (near fidelities of $1$) and $0.006$ (for the\nsmaller fidelities). The scatter greatly exceeds the standard error,\nsuggesting that coherent errors contribute significantly to the loss\nof fidelity.}\n\\label{fig:each_all}\n\\end{figure}\n\n\\begin{figure}\n\\begin{cntrpict}(3,3)(0,-3)\n\\nputgr{0,0}{tl}{width=3in}{merged_allwl1_a}\n\\nputbox{-.15,-1.5}{l}{\\rotatebox{90}{\\large\\textsf{Average fidelity}}}\n\\nputbox{1.5,-3}{b}{\\large\\textsf{Number of computational gates}}\n\\end{cntrpict}\n\\caption{Average fidelity as a function of the number of steps for\neach computational sequence.  The points show the average randomized\nfidelity for four different computational gate sequences (indicated by\nthe different symbols) as a function of the length.  The average fidelity is\nplotted on a logarithmic scale. The middle line shows the fitted exponential\ndecay. The upper and lower line show the boundaries of the $68\n\n(3,3)(0,-3)\n0,0tlwidth=3incocar_unref_a\n-.1,-1.5l90\n1.5,-3b\n\nMeasurement of phase decoherence without refocusing.  The\nrandomized benchmark does not systematically refocus changes in\nfrequency. To estimate the contribution to error from decoherence\nincluding refocusable decoherence, we performed the experiment of\nFig.\u00a0(Figure fig:cocar_decoh) without the refocusing pulse.  This is\nessentially an on-resonance Ramsey experiment. It was not\nexperimentally possible to eliminate the oscillatory shape of the\ncurve by calibrating the frequency indicating that the oscillation was\nnot simply caused by detuning from the resonant frequency, However,\nthe shape is similar to what one would expect from a roughly periodic\nchange in frequency that is not synchronized with the experiment. Such\nchanges could come from magnetic field fluctuations and phase noise\ndue to air currents in the paths of the two Raman beams. To estimate\nthe contribution to the probability of error per step, we fitted an\nexponentially decaying $\\cos(t)$ curve to the points with time\ncoordinates less than $220$ $\\mu$s. The extrapolation of the fitted\ncurve (dashed) clearly deviates from the data. Note that for\nsinusoidal phase noise, the curve should be related to a decaying\nBessel function. Fits to such a function also deviate from the\nexperimental data, consistent with the phase fluctuations not being\nsinusoidal.  Since the contribution to the probability of error is\nderived from the short-time behavior, the effect of the different\nmodels on the inferred probability of error per step is small.\n\nFor the fit shown, the inferred contribution to the probability of\nerror per step is $0.0090(7)$, larger than the error per step derived\nfrom Fig.\u00a0(Figure fig:merged_allwl). This is likely due to the fact that\nin the randomized sequences, the centering of the explicit $\\pi$\npulses in their intervals reduces this contribution by refocusing.\n\nThe contribution of spontaneous emission to phase decoherence can be\ndetermined by a refocused Ramsey experiment where the two Raman beams\nare on separately half the time during the intervals between the\npulses\u00a0[Unknown Author, \"Unknown Title\", ]. To determine the desired contribution, the probability of\n$\\ket{1}$ as a function of time is compared to the data shown in\nFig.\u00a0(Figure fig:cocar_decoh). The results of the comparisons are\nin Fig.\u00a0(Figure fig:cocar_spont). The inferred contribution to the error\nprobability per step is $0.00038(3)$, well below the contribution\nof the other sources of error.\n\n(3,3)(0,-3)\n0,0tlwidth=3incocar_spont_a\n-.1,-1.5l90\n1.5,-3b\n\nContribution of spontaneous emission to phase decoherence.\nTo experimentally determine the contribution of spontaneous emission\nto decoherence, we applied the two Raman beams separately for half the\ntime of each arm of the refocused decoherence measurement and compared\nthe resulting data to that of\nFig.\u00a0(Figure fig:cocar_decoh)\u00a0[Unknown Author, \"Unknown Title\", ].  The points shown\nhere were obtained by dividing the probabilities measured by the\ncorresponding probabilities of Fig.\u00a0(Figure fig:cocar_decoh),\ninterpolating between the nearest points to match the time\ncoordinates. The straight line shows the fitted exponential decay. The\nfit was weighted and used linear approximation to determine standard\ndeviations of the points.  The standard deviations used range from\n$0.003$ to $0.015$, which is substantially less than the apparent\nscatter of the plotted points.\n\nThe apparent scatter in the points near the end of the curve\nis likely due to slow fluctuations in pulse amplitude.\nThe contribution to the probability of error per step as\ndetected in this experiment is $0.006(3)$ if the calibration were\nbased on this experiment. Automatically calibrated\npulse times fluctuated by around $0.02$ $\\mu$s.\nFor pulse times differing by this amount,\nthe contribution to the error per step is $0.007(3)$.\n\n"}
{"prompt": "What are the main findings of the paper 'Superconducting Qubits: Current State of Play'?", "completion": "\n\nrange-phrase = \u00a0to\u00a0, math-micro=, detect-mode=false, detect-family=true\n\nKjaergaard et al.Superconducting Qubits: Current State of Play\n\n# Superconducting Qubits: Current State of Play\n\nSuperconducting qubits are leading candidates in the race to build a quantum computer capable of realizing computations beyond the reach of modern supercomputers. The superconducting qubit modality has been used to demonstrate prototype algorithms in the `noisy intermediate scale quantum' (NISQ) technology era, in which non-error-corrected qubits are used to implement quantum simulations and quantum algorithms. With the recent demonstrations of multiple high fidelity two-qubit gates as well as operations on logical qubits in extensible superconducting qubit systems, this modality also holds promise for the longer-term goal of building larger-scale error-corrected quantum computers. In this brief review, we discuss several of the recent experimental advances in qubit hardware, gate implementations, readout capabilities, early NISQ algorithm implementations, and quantum error correction using superconducting qubits. While continued work on many aspects of this technology is certainly necessary, the pace of both conceptual and technical progress in the last years has been impressive, and here we hope to convey the excitement stemming from this progress.\n\nsuperconducting qubits, superconducting circuits, quantum algorithms, quantum simulation, quantum error correction, NISQ era\n\n## INTRODUCTION\nThe ability to control individual quantum degrees of freedom and their interactions unlocks the capability to perform quantum coherent computation. This in turn imparts the possibility to perform certain computational tasks and quantum simulations which are outside the reach of modern supercomputers [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Superconducting qubits \u2013 collective excitations in superconducting circuits \u2013 are currently one of the leading approaches for realizing quantum logic elements and quantum coherent interactions with sufficiently high controllability and low noise to be a viable candidate for implementing medium and large-scale quantum computation.\n\nIn 2014, the first controlled qubit-qubit interaction with fidelities greater than 0.99 in multi-qubit systems was demonstrated\u00a0[Unknown Author, \"Unknown Title\", ] with the transmon qubit\u00a0[Unknown Author, \"Unknown Title\", ] variant of superconducting qubits, and since then, multiple controlled two-qubit interactions have been demonstrated with similarly high fidelities (e.g. Refs.\u00a0[Unknown Author, \"Unknown Title\", ] and\u00a0[Unknown Author, \"Unknown Title\", ]). Even though the two-qubit gate fidelity in multi-qubit systems is a limited metric for evaluating the maturity of a quantum computing technology, it implies a high degree of control of all aspects of the quantum processor, and indicates the state of play: superconducting qubits are well positioned to be a platform for demonstrating interesting noisy intermediate-scale quantum computing (NISQ) [Unknown Author, \"Unknown Title\", ] protocols outside the reach of classical computers and first realizations of operations on multiple logical error-corrected qubits [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nPath towards fault-tolerant quantum error-corrected quantum computers (left) as well as noisy intermediate scale quantum computing (right) using superconducting qubits. The left track follows the path towards quantum computers capable of performing arbitrarily long programs to arbitrary precision, based on logical (i.e. encoded and error-corrected) qubits. The right track is the `NISQ' approach (see Ref.\u00a0[Unknown Author, \"Unknown Title\", ]), where highly optimized quantum algorithms and quantum simulations, which typically take into account details of the quantum processor, can be executed without generalized quantum error correction procedures. The two tracks are pursued in parallel in many academic, government, and industrial laboratories.\n\nIn Fig.\u00a0(Figure fig:NISQ-QEC), we show two major tracks being pursued in parallel in the community. The left track (see e.g. Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]) shows the progression towards building a fault-tolerant quantum computer, capable of running an arbitrarily long computation, to arbitrary precision. Since 2012-2013, the field has climbed this ladder, including the recent demonstration of a logical qubit with a lifetime longer than any of the underlying constituent elements [Unknown Author, \"Unknown Title\", ], operations on single logical qubits [Unknown Author, \"Unknown Title\", ] as well as logical operations between two encoded (but not yet error-corrected) qubits [Unknown Author, \"Unknown Title\", ].\n\nAlthough the architectures based purely on the transmon qubit (see Sec.\u00a0<ref>) have not yet demonstrated logical states with longer lifetimes than their constituent physical states, multi-qubit systems with on the order of 10 \u2013 20 qubits have been demonstrated\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and even larger systems with 50 \u2013 100 qubits are under current development\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Such processors are eminently suitable for the NISQ era approach, where the aim is to perform quantum algorithms and quantum simulations that achieve quantum advantage in the absence of full quantum error correction. Such NISQ era demonstrations utilize highly tailored quantum programs that take into account detailed knowledge of a given quantum processor, some of which we have shown in the right track of Fig.\u00a0(Figure fig:NISQ-QEC). These (and more) details will need to be combined judiciously to ultimately demonstrate non-trivial physics (i.e. quantum simulations) or calculations (i.e. quantum algorithms) in the NISQ approach. The full toolbox of the NISQ era is an area under active development, and the ultimate reach of this approach is not yet known. Prominent among the NISQ demonstrations is the recent result of demonstrating a clear quantum advantage (nicknamed `quantum supremacy'\u00a0[Unknown Author, \"Unknown Title\", ]), where a computation performed on a quantum computer yields a result expected to be impossible to attain using large, classical supercomputers\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn this review, we do not aspire to give a complete, chronological review of the entire field of superconducting qubits and their broad applicability for implementing circuit quantum electrodynamics (cQED) or as a platform for studying fundamental physics. Interested readers may consult any of the already existing excellent reviews (some of which can be found in e.g. Refs. [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]). Instead, we focus on highlights from each of the blocks in Fig.\u00a0(Figure fig:NISQ-QEC) that have brought the field to its current exciting state. In Section\u00a0<ref>, we review progress towards improving qubit coherence (Sec.\u00a0<ref>), improved native gate fidelities (Sec.\u00a0<ref>), improvements to readout (Sec.\u00a0<ref>) and developments in using resonators to act as quantum memories (Sec.\u00a0<ref>).\n\nIn Section\u00a0<ref>, we review early NISQ-style demonstrations using superconducting qubits, including quantum supremacy (Sec.\u00a0<ref>), quantum simulation (Sec.\u00a0<ref>), digital quantum algorithms (Sec.\u00a0<ref>) and quantum annealing (Sec.\u00a0<ref>). In Section\u00a0<ref>, we briefly introduce the framework of quantum error correction and review progress in experiments using parity readout, often used in the context of realizing subsections of the surface code (Sec.\u00a0<ref>), as well as experiments towards demonstrating fault-tolerance (Sec.\u00a0<ref>) and operations on logical qubits encoded in resonator states (Sec.\u00a0<ref>). Finally in Section\u00a0<ref>, we provide an outlook on the developments from the preceeding sections, and discuss some of the near-term challenges related to moving to larger quantum processors based on the superconducting qubit modality.\n\n## THE HARDWARE OF SUPERCONDUCTING QUBITS\nSuperconducting circuits are manufactured using a multi-step additive and subtractive fabrication process involving lithographic patterning, metal deposition, etching, and controlled oxidation of thin two-dimensional films of a superconductor such as aluminum or niobium. Circuits are fabricated on silicon or sapphire substrates, leveraging techniques and materials compatible with silicon CMOS manufacturing. Devices are placed inside a copper or aluminum package that provides an engineered electromagnetic environment with requisite signal lines and thermally anchored to the $\\approx\\SI{10}{mK}$ stage of a dilution refrigerator. The toolbox of superconducting circuits comprises resonators and bias lines, in addition to the qubits themselves. The properties of these building blocks can be engineered by varying circuit parameters and interconnected with tailored couplings.\n\n[]\nJosephson junctionSuperconducting qubits are based on the Josephson junction, which consists of two superconducting electrodes that are separated by a thin insulating barrier, allowing for the coherent tunneling of Cooper pairs, resulting in a lossless non-linear inductor.\n\n### Devices based on superconducting tunnel junctions\n< g r a p h i c s >\n\n(a) The energy spectrum of a quantum harmonic oscillator (QHO).\n\n(b) The energy spectrum of the transmon qubit, showing how the introduction of the non-linear Josephson junction produces non-equidistant energy levels.\n\n(c) Evolution of lifetimes and coherence times in superconducting qubits. Bold font indicates the first demonstration of a given modality.\n\n`JJ-based qubits' are qubits where the quantum information is encoded in the excitations of a superconducting circuit containing one or more Josephson junctions (see Sec.\u00a0<ref>).\n\n`Bosonic encoded qubits' are qubits where the quantum information is encoded in superpositions of multi-photon states in a QHO, and a Josephson junction circuit mediates qubit operation and readout (see Sec.\u00a0<ref>).\n\n`Error corrected qubits' represent qubit encodings in which a layer of active error-correction has been implemented to increase the encoded qubit lifetime.\n\nThe charge qubit and transmon modalities are described in Sec.\u00a0<ref>, flux qubit and the capacitively shunted flux qubit (`C-sh. flux qubit') are described in Sec.\u00a0<ref>, and fluxonium and gatemon modalities are described in Sec.\u00a0<ref>.\n\nThe codes underlying the `cat encoding' and `binomial encoding' are discussed in Sec.\u00a0<ref>.\n\n`(3D)' indicates a qubit embedded in a three-dimensional cavity.\n\nFor encoded qubits, the non-error-corrected $T_1$ and $T_2$ times used in this figure are for the encoded, but not error-corrected, version of the logical qubit (see Refs.\u00a0[Unknown Author, \"Unknown Title\", ] and\u00a0[Unknown Author, \"Unknown Title\", ] for details).\n\nThe references for the JJ-based qubits are (in chronological order)\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]; the semiconductor-JJ-based transmons (gatemons) are Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]; and the graphene-JJ-based transmon is Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. The bosonic encoded qubits in chronological order are Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nThe quantum harmonic oscillator (QHO) shown in Fig.\u00a0(Figure fig:dispersion_devoret)(a) is a resonant circuit comprising a capacitor and an inductor with resonance frequency $\\omega_{\\mathrm{c}}=1/\\sqrt{LC}$. For sufficiently low temperature ($k_{\\mathrm{B}}T \\ll \\hbar \\omega_{\\mathrm{c}})$ and dissipation (level broadening much less than $\\hbar \\omega_{\\mathrm{c}}$), the resulting harmonic potential supports quantized energy levels spaced by $\\hbar\\omega_{\\mathrm{c}}$. However, due to the equidistant level spacing, the QHO by itself cannot be operated as a qubit.\n\nTo remedy this situation, the circuit potential is made anharmonic by introducing a nonlinear inductor \u2013 the Josephson junction. The imparted anharmonicity leads to a non-equidistant spacing of the energy levels, enabling one to uniquely address each transition, see Fig.\u00a0(Figure fig:dispersion_devoret)(b). Typically, the two lowest levels are used to define a qubit, with $|0\\rangle$ corresponding to the ground state and $|1\\rangle$ corresponding to the excited state. Large anharmonicity is generally favourable to suppress unwanted excitations to higher levels.\n\nBeyond the simple circuit in Fig.\u00a0(Figure fig:dispersion_devoret)(b), one may add additional inductors, capacitors, and Josephson junctions to achieve certain design goals.\n\nThe shape of the potential energy landscape and the nature of the encoding of the qubit states (charge, flux, etc.) depend on the relative strengths of the energies associated with these various circuit elements, including the Josephson energy $E_{\\mathrm{J}}$, the capacitive charging energy $E_{\\mathrm{C}}$, and the inductive energy $E_{\\mathrm{L}}$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Tuning the underlying circuit parameters enables one to engineer and trade-off various qubit properties, including transition frequency, anharmonicity, and sensitivity to various noise sources.\n\nContemporary superconducting circuits evolved from two fundamental types of qubits: one based on electric charge and one based on magnetic flux. These initial modalities \u2013 charge and flux qubits, respectively \u2013 have been improved and generalized over the past 20 years to realize the multiple types of qubits in use today\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\n#### Charge qubits and derivatives\nThe first temporal coherence in a superconducting circuit was observed in a charge qubit (also called a Cooper-pair box)\u00a0[Unknown Author, \"Unknown Title\", ]. A charge qubit consists of a small superconducting island connected to a large superconducting reservoir via a Josephson junction. A capacitively coupled gate voltage controls the charge offset $n_{\\mathrm{g}}$ on the island, and it is used to tune the qubit frequency. The circuit Hamiltonian is given by\n$$\n\n\\hat H=4E_{\\mathrm{C}}\\left(\\hat N- n_{\\mathrm{g}}\\right)^2 -E_{\\mathrm{J}}\\cos\\hat\\phi,\n\\label{eq:charge_qubit}\n\n$$\nwhere $\\hat N$ denotes the number of excess Cooper pairs on the island, $\\hat\\phi$ is the $2\\pi$-periodic operator of the phase difference across the Josephson junction, and the operators satisfy the commutation relation $[\\hat\\phi, \\hat N]=i$.\nCharge qubits are designed in the regime $E_\\textrm{C} > E_\\textrm{J}$, such that the island charge is a good quantum number. The bare qubit states are $|N\\rangle$ and $|N+1\\rangle$, corresponding to the absence and presence of an additional Cooper pair on the island. The Josephson junction acts as a valve for Cooper pairs and couples these states, opening an avoided crossing of size $E_\\textrm{J}$ at integer multiples of offset charge $n_\\textrm{g} = 1/2$. Although charge qubits have large anharmonicity $\\alpha \\equiv \\omega_{12}/2\\pi - \\omega_{01}/2\\pi > \\SI{10}{GHz}$, their lifetime and dephasing is strongly limited by environmental charge noise\u00a0[Unknown Author, \"Unknown Title\", ]. In addition, the small size of the island and Josephson junction leads to a strong susceptibility to stray capacitance, local defects, and fabrication variation, leading to large device-to-device variability.\n\nTo mitigate these issues, a large shunt capacitor was added to the charge qubit \u2013 a device nicknamed \u201cthe transmon\u201d\u00a0[Unknown Author, \"Unknown Title\", ]. The transmon is also described by Eq.\u00a0(<ref>), but it is designed in the regime $E_\\mathrm{J}/E_\\mathrm{C}\\gtrsim 50$, resulting in an exponential reduction of its charge noise sensitivity and making it a \u201ccharge-insensitive charge qubit\u201d (charge is no longer a good quantum number). Adding a high-quality shunt capacitor has led to improved reproducibility and coherence times in the range of 50100s, see Fig.\u00a0(Figure fig:dispersion_devoret)(c).\n\n[]\nCooper pair boxA charge qubit whose states correspond to the presence or absence of an additional Cooper pair on a superconducting island. Although the first superconducting qubit to exhibit temporal coherence, it suffered from poor reproducibility and coherence times.\n\nTransmon qubitA capacitively shunted variant of the Cooper pair box that is largely insensitive to charge, resulting in improved reproducibility and coherence times. It is one of the leading modalities used today for gate-model quantum computing.\n\nSQUIDA superconducting quantum interference device consists of a superconducting closed loop that is interrupted by one (rf-SQUID) or two (dc-SQUID) Josephson junctions. It is employed in superconducting circuits to enable frequency tunability via an applied magnetic flux.\n\nThe improved performance of the transmon comes at the expense of a reduced anharmonicity to values of about $\\SI{-200}{MHz}$\u00a0[Unknown Author, \"Unknown Title\", ], being only a few percent of the qubit level spacing $\\omega_\\text{q}/2\\pi \\equiv \\omega_{01}/2\\pi \\sim\\SI{5}{GHz}$. For single-junction transmons (see Fig.\u00a0(Figure fig:dispersion_devoret)(b), this frequency is set by the size of the shunt capacitor and the critical current $I_\\text{c}$ of the Josephson junction, determined by design and fabrication parameters such as materials choice, junction area, and insulator thickness. Replacing the single Josephson junction by a superconducting loop with two junctions in parallel \u2013 a dc-SQUID \u2013 enables one to tune the effective critical current of the Josephson junction (and hence the qubit frequency) via a magnetic field applied to the dc-SQUID loop. The trade-off for this additional control knob is that the qubit becomes susceptible to magnetic flux noise.\n\nTransmon qubits can be coupled capacitively \u2013 either directly or as mediated by a resonator \u201cbus\u201d \u2013 which, in the natural eigenbasis of the transmon qubits, lead to a two-qubit interaction term of the form $\\hat H^\\text{int}_\\text{cap} = J_\\text{cap}\\left(\\hat \\sigma_x ^i \\hat\\sigma_x ^j + \\hat\\sigma_y ^i\\hat\\sigma_y ^j\\right)$. The physical coupling strength $J_{\\mathrm{cap}}$ is related to the coupling capacitance and in the case of a resonator bus, the frequency detuning between the qubits and the resonator. By introducing an additional \u201ccoupler qubit\u201d or \u201ccoupler SQUID\u201d, one can furthermore tune the effective coupling strength\u00a0[Unknown Author, \"Unknown Title\", ].\n\n#### Flux qubits and derivatives\nThe superconducting qubit modality based on magnetic flux underwent a similar evolution. With flux qubits, the bare qubit states are defined by circulating currents in a superconducting loop interrupted by a small Josephson junction in series with either a linear inductor or several larger-area Josephson junctions. The small junction acts as a valve for magnetic fluxons, allowing one to enter or leave the superconducting loop. The presence or absence of this fluxon is accompanied by a clockwise or counterclockwise circulating current, which serves to satisfy the flux quantization condition in concert with the Josephson junctions, the linear inductances, and an externally applied magnetic field threading the loop. When biased at half a flux quantum, the small junction couples and hybridizes these states with a strength related to $E_{\\mathrm{J}}$, $E_{\\mathrm{C}}$, and $E_{\\mathrm{L}}$.\n\nWithin a two-level approximation, the flux qubit potential is approximated by two wells of energy difference $\\epsilon$ and coupling energy $\\Delta$, yielding an effective two-level Hamiltonian $\\hat H _{\\mathrm{TL}} = \\epsilon(\\Phi_z)\\hat\\sigma_z +\\Delta\\hat\\sigma_x$\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], with a qubit frequency $\\hbar\\omega_{\\mathrm{q}}=\\sqrt{\\epsilon^2+\\Delta^2}$, and $\\Phi_z$ is the flux applied to the flux qubit loop (typically denoted the $z$-loop). By replacing the small Josephson junction with a secondary dc-SQUID loop, the coupling $\\Delta$ becomes flux-tunable, leading to the modified two-level Hamiltonian $\\hat H' _{\\mathrm{TL}} = \\epsilon(\\Phi_z,\\Phi_x)\\hat\\sigma_z +\\Delta(\\Phi_x)\\hat\\sigma_x$, where $\\Phi_x$ is the flux applied to the $x$-loop. This makes the flux qubit a spin-1/2 system with tunable $z$ and $x$ fields, a building block for quantum annealing applications based on the transverse Ising Hamiltonian [Unknown Author, \"Unknown Title\", ].\n\n[]\nFlux qubitA qubit modality based on magnetic flux whose states correspond to clockwise and counter-clockwise currents flowing around a loop interrupted by Josephson junctions.\nAlthough the persistent-current flux qubit exhibited a high degree of temporal coherence, it suffered from poor reproducibility.\n\nCapacitively shunted flux qubitA capacitively shunted variant of the persistent-current flux qubit used for both gate-model and quantum annealing circuits. It features improved reproducibility and coherence times while retaining $>\\SI{500}{MHz}$ anharmonicity.\n\nIn the context of gate-model quantum computing, the persistent-current flux qubit\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] was the most successful of the early flux qubits, featuring a small junction (the valve) in series with 2 or 3 larger-area Josephson junctions (the series inductance). As with the transmon that later followed, this qubit operates in the regime $E_{\\mathrm{J}}\\gg E_{\\mathrm{C}}$ and is largely charge-insensitive. In addition, it featured a large anharmonicity with moderately-high coherence times\u00a0[Unknown Author, \"Unknown Title\", ], including the first superconducting qubit demonstrating coherence exceeding $\\SI{10}{\\micro s}$ (Fig.\u00a0(Figure fig:dispersion_devoret)(c)) and reaching as high as\n$\\SI{23}{\\micro s}$\u00a0[Unknown Author, \"Unknown Title\", ]. However, like the charge qubit, its major limitation was a lack of device-to-device reproducibility.\n\nTo improve the flux qubit, a large shunt capacitance was again added\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The resulting \u201ccapacitively shunted flux qubit\u201d featured improved reproducibility at the expense of qubit anharmonicity, in this case to around $\\SI{500}{MHz}$. It also reduced the circulating current, resulting in reduced sensitivity to flux noise and leading to coherence times in the range of 50100s (see Fig.\u00a0(Figure fig:dispersion_devoret)(c)).\n\nFlux qubits generally are coupled inductively to each other, resulting in an interaction term of the form $\\hat{H}^\\text{int}_\\text{ind} =J_\\text{ind}\\hat\\sigma_z ^i\\hat\\sigma_z ^j$. The coupling strength $J_\\text{ind}$ can be tuned by the magnetic flux applied to an additional inductive coupling element\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], with the potential to implement noise-resilient two-qubit gates\u00a0[Unknown Author, \"Unknown Title\", ].\n\n#### Qubit modalities \u2013 the current state of play\nThe transmon is currently the most widely used qubit for gate-based quantum computation, and it has been used to demonstrate multiple high-fidelity logical operations, quantum simulations and digital algorithms (see Sec.\u00a0<ref>, Sec.\u00a0<ref> and Sec.\u00a0<ref>).\n\nIn turn, due to the structure of their Hamiltonians, the persistent-current and rf-SQUID flux qubits are currently the predominant platforms being used for quantum annealing (see Sec.\u00a0<ref>), including the commercial D-Wave system\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWith the advent of capacitively shunted flux qubits, this modality now also supports high reproducibility, long coherence times, and moderate anharmonicity levels. Combined with the tunability of its Hamiltonian, this qubit offers a potential alternative platform for Hamiltonian emulation, gate-based quantum computing and quantum annealing.\n\nToday, a \u201cgeneralized superconducting qubit\u201d framework is emerging, featuring a capacitively shunted small junction in series with $N$ larger-area Josephson junctions (or an inductive shunt). The transmon is an early example of this evolution, as is the capacitively shunted flux qubit.\n\nAnother example is the fluxonium qubit\u00a0[Unknown Author, \"Unknown Title\", ] (see also Sec.\u00a0<ref>), which has been demonstrated with coherence times exceeding 100s\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] at the expense of increased complexity in the number of Josephson junctions.\n\n### Gate operations in superconducting qubits\nThe predominant technique for implementing single-qubit operations is via microwave irradiation of the superconducting circuit. Electromagnetic coupling to the qubit with microwaves at the qubit transition frequency drives Rabi oscillations in the qubit state. Control of the phase and amplitude of the drive is then used to implement rotations about an arbitrary axis in the $x,y$ plane. Within the rotating wave approximation, a microwave drive resonant with the qubit frequency gives rise to the Hamiltonian $\\hat H_\\text{drive} = \\Omega \\left( I(t)\\hat\\sigma_x + Q(t)\\hat\\sigma_y\\right)$, where $I(t)$ ($Q(t)$) is the envelope function of the in-phase (quadrature) component of the microwave signal and $\\Omega$ is the Rabi frequency as experienced by the qubit. However, due to the typically low anharmonicity of the transmon qubit, higher-order levels are easily populated, leading to leakage and dephasing effects.[]\nI,Q$I(t)$ and $Q(t)$ are the in-phase and quadrature components of the amplitude of the microwave drive. The labels are borrowed from classical RF processing.\nTo counteract this, the Derivative Removal by Adiabatic Gate (DRAG) technique is typically used to enable fast gates without leakage into higher-level states [Unknown Author, \"Unknown Title\", ], and single-qubit gates are now routinely implemented with fidelities $\\gtrsim0.99$\u00a0(e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]), typically measured using interleaved Clifford randomized benchmarking [Unknown Author, \"Unknown Title\", ]). $z$-axis rotations are typically performed in a virtual manner, where the phase of the qubit drives are shifted, effectively producing a $z$-rotation [Unknown Author, \"Unknown Title\", ].\n\nWhile the implementation of single-qubit gates is now mostly uniform across the community, many different two-qubit gates have been demonstrated, and several of those have reached fidelities $>0.99$. []\nInterleaved Clifford randomized benchmarkingA technique for assessing the average fidelity of a quantum gate, by interleaving the gate of interest in sequences of Clifford gates, and randomizing over many such sequences.\nThe two-qubit gates can be roughly split into three categories. One class uses tunable transmon qubits whose frequencies can be modulated by applying magnetic flux through a dc-SQUID loop that tunes the effective critical current of the Josephson junction. Several high-fidelity two-qubit gates can be implemented by tuning certain transitions close to resonance [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] (see details in Tbl.\u00a0(Table tab:2qubitgates)). The second class uses fixed-frequency qubits which are manipulated by microwave irradiation, typically driving one qubit at the frequency of a second qubit, to enact high-fidelity entangling gates [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The third class relies on parametrically driving a coupling element (or the qubits themselves) to induce a tunable coupling between the qubits. Such operations are referred to as \"parametrically driven\", and two high-fidelity two-qubit gates have recently been demonstrated using such parametrically driven interactions [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Common to all these gates is that they generate entanglement in the system via conditional rotations or transitions, such that the state and/or the phase of one qubit becomes dependent on that of the other. The class that uses tunable qubits has increased sensitivity to flux noise, but gates can be implemented more quickly. Conversely, the fixed frequency devices typically have longer lifetimes, but also require longer gate operation times. Table\u00a0(Table tab:2qubitgates) shows the current state-of-the-art fidelities of the two-qubit gates demonstrated to date. The continued development of novel gate designs, and fidelity improvement in current designs is a highly active area of research.\n\nState of the art high-fidelity two-qubit gates in superconducting qubits\n\nAcronym$^{\\rm a}$\t\t\t\t\t\t\t     \tLayout$^{\\rm b}$\t\t\t    First demonstration [Year] \t    Highest fidelity [Year]\t   \tGate time\n\nfluxcolor \t\t\t\t\t\t\t\t\t\t    \tfluxcolor \t\t\t\t\t\t\t\t    fluxcolor \t\t   fluxcolor99.4\n-2*fluxcolor (ad.)  \t     -2*fluxcolorT\u2013T\t    -2*fluxcolorDiCarlo et al. [Unknown Author, \"Unknown Title\", ]  [2009]    fluxcolor99.7\nfluxcolor$\\sqrt{\\textsf{iSWAP}}$\t    T\u2013T\t\t\t    Neeley et al. [Unknown Author, \"Unknown Title\", ]$^{\\rm \\circ}$  [2010]    90\nuwavecolor \t\t \t    F\u2013F\t\t\t    Chow et al. [Unknown Author, \"Unknown Title\", ]  [2011] \t\t\t\t\t\t    99.1\nuwavecolor$\\sqrt{\\textsf{bSWAP}}$    F\u2013F\t \t\t    Poletto et al. [Unknown Author, \"Unknown Title\", ]  [2012]\t\t\t    86\nuwavecolor\t\t \t    F\u2013F \t\t\t    Chow et al. [Unknown Author, \"Unknown Title\", ] [2013] \t\t\t    87.2\nfluxcolor (ad.) \t\t     T\u2013(T)\u2013T     Chen et al. [Unknown Author, \"Unknown Title\", ]  [2014] \t\t\t\t\t    99.0\nuwavecolor\t \t\t     3D F \t    Paik et al. [Unknown Author, \"Unknown Title\", ]  [2016]\t\t\t\t    98.5\nFandUwavecolor$\\sqrt{\\textsf{iSWAP}}$     F\u2013(T)\u2013F     McKay et al. [Unknown Author, \"Unknown Title\", ] [2016]\t\t\t    98.2\nFandUwavecolor (ad.)\t \t    T\u2013F\t\t    Caldwell et al. [Unknown Author, \"Unknown Title\", ]  [2018]\t    99.2\ncavitycolor$_L$  \t\t    BEQ-BEQ \t    Rosenblum et al. [Unknown Author, \"Unknown Title\", ]  [2018] \t\t\t    $\\sim$99\ncavitycolor$_{T-L}$      BEQ-BEQ     Chou et al. [Unknown Author, \"Unknown Title\", ]  [2018]\t\t\t\t\t\t    \t79\n\nGates ordered by year of first demonstration. Gate time is for the highest fidelity gate.\n\n$^{\\rm a}$Full names:  (ad.): Adiabatic controlled phase, $\\sqrt{\\textsf{iSWAP}}$: square-root of the , : Cross-resonance, $\\sqrt{\\textsf{bSWAP}}$: Square-root of the Bell-Rabi SWAP, : Microwave activated phase, : Resonator induced phase gate, $_L$: Logical , $_{T-L}$: Teleported logical .\n\n$^{\\rm b}$F is short `fixed frequency', T is short for `tunable'. For all non-bosonic encoded qubit gates, the qubits were of the transmon variety (except for the first demonstration of $\\sqrt{\\textsf{iSWAP}}$, using phase qubits, and first demonstration of $\\textsf{CR}$ which used capacitively shunted flux qubits). Terms in parenthesis is a coupling element. `3D F' is short for a fixed frequency transmon qubit in a three-dimensional cavity. `BEQ' is short for bosonic encoded qubit (see Sec.\u00a0<ref>).\n\n$^{\\rm \\circ}$Implemented with phase qubits.\n\n$^{\\rm \\dagger}$Determined by interleaved randomized Clifford benchmarking [Unknown Author, \"Unknown Title\", ].\n\n$^{\\rm \\square}$Determined by repeated application of the gate to various input states and observing state fidelity decay as function of applied gates. See\u00a0[Unknown Author, \"Unknown Title\", ] for details.\n\n$^{\\rm \\star}$Determined by quantum process tomography.\n\n-0.2em1em1em Gates implemented on flux-tunable qubits.\n\n-0.2em1em1em All-microwave gates.\n\n-0.2em1em1em Combination of tunable and fixed frequency components.\n\n-0.2em1em1em Gates on bosonic encoded qubits.\n\n### Amplification and high-fidelity readout\nAn essential part of any superconducting quantum chip is fast and reliable readout of its qubit states. For superconducting qubits, readout is typically done using dispersive readout, in which each qubit is entangled with photons in a linear readout resonator with frequency $\\omega_\\text{r}$ [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nIn the dispersive regime, when the qubit-resonator detuning $\\Delta = \\omega_\\text{q} - \\omega_\\text{r}$ is much larger than their coupling rate $g$, no direct exchange of energy takes place between the two systems. Instead, the qubit and resonator shift each others' frequencies \u2013 proportional to their photon occupations, coupling strength $g$, and detuning $\\Delta$ \u2013 enabling the readout of the qubit state by probing the microwave response of the resonator. Depending on the state of the qubit, the readout resonance shifts by the dispersive shift $\\chi$. For a two-level system, $\\chi$ is given by $g^2/\\Delta$, and for the transmon qubit $\\chi$ is modified to $\\frac{g^2}{\\Delta}\\frac{\\alpha}{\\alpha+\\Delta}$ (valid in the transmon regime, where $\\alpha = -E_\\text{c}$) [Unknown Author, \"Unknown Title\", ]. For efficient readout, $\\kappa$ is designed to be similar to $\\chi$, typically in the range of few $\\SI{}{MHz}$. []\nDispersive coupling HamiltonianDescribes coupling of a resonator ($\\hat a$) and a qubit ($\\hat\\sigma_z$). A canonical transformation of the Jaynes - Cummings Hamiltonian to second order in $g/\\Delta$ yields the dispersive coupling term,\n$\\chi\\hat{a}^\\dagger\\hat{a}{\\hat \\sigma}_z$, where $\\chi$ is the dispersive coupling coefficient.\nWhile an increased $\\kappa$ decreases the resonator ring-up time and thereby provides fast qubit-state readout, the coherence time of the qubit is increasingly limited by spontaneous energy decay into the readout cavity mode, referred to as the Purcell effect\u00a0[Unknown Author, \"Unknown Title\", ]. To mitigate this, the community is using so-called \u201cPurcell filters\u201d, which essentially act as bandpass filters, that support strong interactions between the resonator and an output line, while protecting the qubit from energy decay\u00a0[Unknown Author, \"Unknown Title\", ].\n\nDispersive readout requires relatively low photon numbers, which must be amplified with high quantum efficiency in order to enable fast, high-fidelity single-shot readout for real-time quantum feedback [Unknown Author, \"Unknown Title\", ]. This requirement has motivated the development of quantum-limited parametric amplifiers [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and detectors [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n[]\nPurcell effectQubit decay into a nearby oscillator mode. In the absence of a Purcell filter, $\\Gamma_\\text{p} \\approx (g/\\Delta)^2\\kappa$\n\nCurrent state-of-the-art processors utilize frequency-multiplexed readout circuits, reducing the hardware overhead by coupling several readout resonators to the same amplifier chain [Unknown Author, \"Unknown Title\", ]. The number of readout resonators that can be multiplexed is often limited by the bandwidth and saturation power of the parametric amplifier \u2013 a limitation that has motivated the development of stepped-impedance parametric amplifiers with increased bandwidth\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], as well as Josephson traveling wave parametric amplifiers (JTWPAs), achieving both large bandwidth and high saturation power\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Bosonic encoded qubits\nBosonic encoded qubits, or qubits encoded in the infinite-dimensional Hilbert space of a quantum harmonic oscillator (QHO), are in some ways the inverse of the technology described to this point. The encoding is defined by superpositions of multi-photon states in the QHO, whose modes obey bosonic statistics. The QHO is typically realized by either an engineered electromagnetic mode in a 3D microwave cavity or a lithographically defined transmission line resonator on a 2D chip. In these qubit implementations, the QHO encodes a qubit and is coupled to a transmon that plays a supplementary role in control and readout. The lack of individually-addressable energy level transitions in a QHO makes qubit manipulation more difficult than for transmons, but universal control is achieved using microwave irradiation and manipulations of the coupled transmon\u00a0[Unknown Author, \"Unknown Title\", ]. These encodings are attractive because they take advantage of the long lifetimes of microwave cavities [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and may enable hardware-efficient quantum error correction\u00a0[Unknown Author, \"Unknown Title\", ] (QEC). Significant recent effort has led to demonstrations of resonator state manipulation [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and readout [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] schemes, which have been used to demonstrate fault-tolerant measurements, error detection and correction, and active and passive QEC (see Sec.\u00a0<ref>).\n\n[]\nCoherent state $|{\\alpha}\\rangle$A minimum-uncertainty state of a QHO, comprised of a Poisson distribution of Fock states. Its is parametrized by an average photon number $\\overline{n} = |\\alpha|^2$ and a complex phase $\\phi = \\arg(\\alpha)$. Coherent states are eigenstates of the ladder operator $\\hat{a}$.\nFock state $|{n}\\rangle$A state of the QHO characterized by a single, well-defined photon occupation number $n$.\n\nThe bosonic encoding is implemented in superconducting hardware by coupling a long-lived microwave resonator to a transmon qubit which is additionally coupled to an auxiliary resonator that is used to read out the state of the transmon qubit. For a bosonic mode coupled to a transmon qubit with $\\chi/\\kappa \\gg 1$, the dispersive coupling imparts a well-resolved photon-number dependent shift in the transmon frequency: $\\omega_{q, n} = \\omega_q - n\\chi$. This is known as the \"photon-number resolved regime\" [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Photon state manipulations take two general forms: displacements $\\hat{\\mathcal{D}}(\\alpha)$ that coherently add or remove energy, and selective number-dependent arbitrary phase (SNAP) operations $\\hat{S}(\\vec{\\theta})$ that add an arbitrary phase to individual Fock states. Krastanov et al. showed that the combination of displacements and SNAP gates provides universal control over the resonator state [Unknown Author, \"Unknown Title\", ].\n[]\nDisplacement operator$\\hat{\\mathcal{D}}(\\alpha) = \\textrm{exp}(\\alpha \\hat a^\\dagger-\\alpha^* \\hat a)$\nSNAP operator$\\hat{S}(\\vec{\\theta}) = \\sum_{n=0}^\\infty e^{i\\theta_n} |{n}\\rangle\\langle{n}|$\n\nDisplacement operations are native to the QHO and are accomplished by applying a microwave drive to a weakly-coupled port at the resonator frequency. SNAP operations, because they address single energy levels within the QHO, require nonlinearity, and are realized using the photon-number resolved regime to entangle the transmon with the resonator and manipulate individual Fock states. Applying a slow pulse to the transmon qubit at frequency $\\omega_{q, n}$ with $\\tau_{\\textrm{pulse}} \\gg 1/\\chi$ ensures that the bandwidth of the pulse is smaller than the spacing between the various $\\omega_{q, n}$. In this case, the transmon qubit will be selectively pulsed if and only if the resonator is in Fock state $|{n}\\rangle$. The selective drive is then designed to impart a geometric phase to the resonator $|{n}\\rangle$ state. By applying superposed drives at multiple $\\omega_{q, n}$, an arbitrary geometric phase is imparted to each Fock state, thus implementing an arbitrary SNAP gate in a single step [Unknown Author, \"Unknown Title\", ].\n\nThe dispersive interaction between the transmon qubit and the resonator also enables readout of the parity of the resonator state [Unknown Author, \"Unknown Title\", ]. Here, parity refers to the symmetry of the coherent superposition(s) in the resonator: for example, the states $|\\alpha\\rangle \\pm |-\\alpha\\rangle$ have parity $P = \\pm 1$. Parity readout is particularly useful because the most common bosonic QEC codes use parity flips as an error syndrome (see Sec. <ref>). The parity readout technique can further be used to reconstruct the full Wigner function of the resonator state [Unknown Author, \"Unknown Title\", ]. Finally, fault-tolerant approaches to resonator parity measurement have been proposed [Unknown Author, \"Unknown Title\", ] and demonstrated [Unknown Author, \"Unknown Title\", ].\n\n## EARLY NISQ ERA DEMONSTRATIONS USING SUPERCONDUCTING QUBITS\nIn this section, we discuss NISQ computing implementations, which operate on noisy quantum hardware in the absence of quantum error correction. Recent demonstrations in this so-called NISQ era seek to perform useful quantum computations while tolerating some system noise in order to stretch limited (intermediate-scale) quantum resources to their maximum effect. NISQ demonstrations are mostly at the proof-of-principle stage and, with one notable exception\u2014sampling solutions of a random circuit\u2014generally have not outperformed a large classical computer in wall-clock time or accuracy. However, a computational advantage seems in reach for many of the experiments discussed below, by scaling up the number and quality of qubits on the chip and, consequently, the problem size. Although the task of controlling enough qubits to perform nontrivial demonstrations remains a major technological challenge, it is believed that on the order of 50\u201370 qubits with sufficiently high fidelities can achieve this goal\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWe organize this section into four branches of early NISQ-era implementations with soft borders: NISQ-Era Platforms and a Demonstration of Quantum Supremacy (Section\u00a0<ref>) discusses the recent report of quantum supremacy on a 53-qubit processor and the important role online cloud-based quantum computers will play in advancing NISQ-era algorithms. Quantum Simulations with Superconducting Circuits (Section\u00a0<ref>) use a physical quantum system in order to study another quantum system of interest. Whereas errors in the physical qubits decrease the simulation fidelity, meaningful results can be extracted, e.g., if the timescale of interest is small compared with the decay times of the participating qubits. In contrast, digital quantum simulations and, more generally, universal digital algorithms are gate\u2013based approaches that harness the power of a quantum processor to solve a problem that need not be quantum in nature (Section\u00a0<ref>). Typically, the latter algorithms are tailored to specific (potentially noisy) hardware in order to maximize the overall fidelity of the computation. The fourth flavor is quantum annealing (Section\u00a0<ref>), representing a potential complementary approach to quantum computation.\n\n### NISQ-Era Platforms and a Demonstration of Quantum Supremacy\nDeveloping commercializable NISQ-era algorithms will rely on access to quantum computers of increasing complexity and quality. Cloud-based access to superconducting quantum systems enables algorithm designers and others with expertise outside a traditional physics or quantum hardware background to try ideas. The approach was pioneered at IBM with a 5-transmon qubit device in 2016\u00a0[Unknown Author, \"Unknown Title\", ]. As of the writing of this review, such access is available from IBM, Rigetti Computing, and D-Wave (see, respectively, https://www.ibm.com/quantum-computing/https://www.ibm.com/quantum-computing/, https://www.rigetti.com/qcshttps://www.rigetti.com/qcs, and https://cloud.dwavesys.com/https://cloud.dwavesys.com/); Microsoft (https://azure. microsoft.com/en-us/services/quantum/https://azure. microsoft.com/en-us/services/quantum/), Amazon (https://aws.amazon.com/braket/https://aws.amazon.com/braket/), and Google have also announced plans to enable cloud access to their processors. Google recently used a 53-qubit processor (named Sycamore) to report the first demonstration of quantum computational supremacy\u00a0[Unknown Author, \"Unknown Title\", ], defined as solving a problem using a quantum computer significantly faster than the best-known algorithm on a classical computer\u00a0[Unknown Author, \"Unknown Title\", ]. Sycamore comprises 53 individually controllable transmon-type qubits and 86 couplers used to turn on/off nearest- neighbor 2-qubit interactions. The calibrated single-qubit and 2-qubit gate fidelities fell in the 99\u201399.9\n\n### Quantum simulations with superconducting circuits\n< g r a p h i c s >\n\nSchematic representation of a quantum simulation system (a) A quantum system of interest (red, artistically depicted as a protein complex), is mapped onto an artificial quantum simulator (blue, here a superconducting circuit). By preparing and reading out quantum states $|\\psi\\rangle$ in the precisely controlled simulator \u2013 therefore accessing its time evolution $\\hat U '$ \u2013 the time evolution $\\hat U$ of the underlying quantum system of interest (described by states $\\hat\\Psi$) can be inferred. Figure adapted from Ref.\u00a0[Unknown Author, \"Unknown Title\", ]. (b) Pulse sequence used in a digital quantum simulation, comprised of one- and two-qubit gates used to construct the interaction Hamiltonian of a Fermi-Hubbard simulator\u00a0[Unknown Author, \"Unknown Title\", ]. (c) Analog quantum simulation: One-to-one mapping of the time evolution in the simulator and in the underlying model, see e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. (d) Combination of analog unitary blocks and digital gates in the hybrid approach, as used in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nOne of the most anticipated applications of quantum computation in the NISQ era is quantum simulation\u00a0[Unknown Author, \"Unknown Title\", ]. A quantum simulator is a well-controllable device that mimics the dynamics or properties of a complex quantum system that is typically less controllable or accessible\u00a0[Unknown Author, \"Unknown Title\", ]. The key idea is to study relevant quantum models by emulating or simulating them with hardware that itself obeys the laws of quantum mechanics\u00a0[Unknown Author, \"Unknown Title\", ], in order to avoid the exponential scaling of classical computational resources\u00a0[Unknown Author, \"Unknown Title\", ].\n\nQuantum simulators are problem-specific and do not meet the requirements of a universal quantum computer in general\u00a0[Unknown Author, \"Unknown Title\", ]. This simplification is reflected in the hardware requirements and may allow for a computational speed-up with few\u00a0[Unknown Author, \"Unknown Title\", ], even noisy quantum elements\u00a0[Unknown Author, \"Unknown Title\", ]. Therefore, quantum simulations are likely to address meaningful problems with a quantum advantage well before universal quantum computation will be a reality [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\n\nCertain qubit modalities are advantageous over others, as the qubits themselves may share intrinsic coupling mechanisms or commutation relations with the system to be simulated. The advantages of superconducting circuits for quantum simulation experiments are their high degree of control in manipulation, preparation, and efficient readout, together with the possibility to tailor circuit properties and implement tunable qubit frequencies and coupling strengths\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. The absence of intrinsic conservation laws when encoding abstract circuit excitations also makes superconducting circuits appealing for the study of non-equilibrium phenomena\u00a0[Unknown Author, \"Unknown Title\", ].\n\nFigure\u00a0(Figure fig:qsimulation)a schematically depicts the basic idea of a quantum simulation. The key requirement is an exact (or to a degree desired) mapping between the time evolution $\\hat U$ of the quantum system of interest and the time evolution $\\hat U '$ of the quantum simulator.\nTwo flavors of quantum simulations have been proposed and successfully demonstrated, coined digital and analog quantum simulation\u00a0[Unknown Author, \"Unknown Title\", ]. In the absence of quantum error correction (see Sec.\u00a0<ref>), the achievement of a (problem specific) quantum advantage seems to be within closer reach for the analog or a hybrid analog-digital approach.\n\n#### Digital quantum simulation\nDigital quantum simulation is a gate-based approach where a complex evolution is deconstructed into a set of single and two-qubit gates that can be implemented on the simulator hardware.\n[]\nLie-Trotter-SuzukiA commonly used method of decomposing the evolution under a local Hamiltonian into a sum of universal quantum gates (time steps) that can be efficiently implemented on quantum hardware.\n\nIt is closely related to universal quantum computation and is compatible with error correcting schemes (see Sec.\u00a0<ref>). The approach relies on the fact that unitary operations that describe the time evolution of local Hamiltonians (that appear in most models of physical relevance) can be decomposed into a sum of local universal quantum gates\u00a0[Unknown Author, \"Unknown Title\", ]. The error introduced by the commonly employed Lie-Trotter-Suzuki decomposition\u00a0[Unknown Author, \"Unknown Title\", ] arises from non-vanishing commutators between the decomposed Hamiltonians and scales with the size of individual Trotter steps\u00a0[Unknown Author, \"Unknown Title\", ].\nThe digital simulation scheme was applied to study up to four fermionic modes with a superconducting quantum circuit\u00a0[Unknown Author, \"Unknown Title\", ]. Fermion operators with their correct anti-commutation relation were expressed in terms of Pauli operators using the Jordan-Wigner transformation, establishing an efficient mapping of the Fermi-Hubbard model to a spin Hamiltonian\u00a0[Unknown Author, \"Unknown Title\", ].\n[]\nJordan-Wigner transformationOne example of mapping fermionic operators to Pauli spin operators, enabling to simulate fermionic models with a set of (spin-like) qubits.\n\nThe gate sequence used to effectively construct the relevant interactions is depicted in Fig.\u00a0(Figure fig:qsimulation)(b). Spin models were investigated with a digital quantum simulation of an adiabatic algorithm on a nine-qubit chip\u00a0[Unknown Author, \"Unknown Title\", ] and a two-qubit chip\u00a0[Unknown Author, \"Unknown Title\", ], similarly using a Trotter decomposition in order to construct all interactions necessary to recover the model dynamics\u00a0[Unknown Author, \"Unknown Title\", ]. While these experiments highlight the versatility and universality of the digital approach, the total number of Trotter steps did not exceed ${\\sim} 5$ due to the gate errors present in these systems. Several theory proposals address the efficient encoding of gate sequences in digital quantum simulators\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], which, notwithstanding the hardware requirements, is one of the major challenges of this approach.\n[]\nHubbard modelsHighly general condensed matter model that describes a lattice of coupled fermions or bosons with an on-site interaction.\n\n#### Analog quantum simulation\nIn analog quantum simulations, the simulator directly mimics the time evolution of the quantum system of interest instead of constructing it, see Fig.\u00a0(Figure fig:qsimulation)(c). This requires a close mapping between system and simulator Hamiltonians in order to emulate the continuous time evolution, which in turn ensures a good scaling of hardware resources with problem complexity.\nCircuit-based analog quantum simulators have been proposed recently for studying Andersen and Kondo lattices\u00a0[Unknown Author, \"Unknown Title\", ], Ising models\u00a0[Unknown Author, \"Unknown Title\", ] and phase transitions therein\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], fermionic models \u00a0[Unknown Author, \"Unknown Title\", ], investigating Holstein polarons\u00a0[Unknown Author, \"Unknown Title\", ], and for exploring relativistic quantum mechanics\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ].\nAn array of coupled superconducting qubits naturally emulates the repulsive Bose-Hubbard model. Recently, 1D Bose Hubard chains were experimentally implemented to study quantum random walks\u00a0[Unknown Author, \"Unknown Title\", ] of one and two particles (excitations), and the stabilization of a Mott insulator phase\u00a0[Unknown Author, \"Unknown Title\", ].\nThe study of quantum many-body effects is another application adopted by analog quantum simulation. By generating a synthetic magnetic field, a quantum phase exhibiting a chiral ground-state current was observed with a mutually coupled three-qubit unit cell\u00a0[Unknown Author, \"Unknown Title\", ], and many-body localization signatures were experimentally demonstrated by using a spectroscopy technique that maps out the eigenenergies of a Hamiltonian of interest\u00a0[Unknown Author, \"Unknown Title\", ].\nExcitation transport in photosynthesis was recently studied by spectroscopic means on a three-qubit superconducting device\u00a0[Unknown Author, \"Unknown Title\", ], inspired by an earlier proposal\u00a0[Unknown Author, \"Unknown Title\", ]. Here, all temperatures and frequencies are scaled by ${\\sim}10^5$ in order to establish a correct mapping to biological mechanisms.\nOpen quantum systems described by the spin boson model\u00a0[Unknown Author, \"Unknown Title\", ] have recently attracted interest in the context of circuit simulations\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] for its straightforward mapping to superconducting qubits and resonators while being ubiquitous in nature and hard to access classically.\nIt reveals its complex quantum dynamics especially in the ultra-strong coupling (USC) regime, which was simulated spectroscopically\u00a0[Unknown Author, \"Unknown Title\", ] by implementing an increased physical coupling strength between a flux qubit and a transmission line. Several experiments investigated the non-classical groundstate properties of the quantum Rabi model at USC\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], and the model dynamics were emulated by creating an effective quantum Rabi model at USC in a rotating frame\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. In contrast to atom- and ion-based qubit implementations, superconducting qubits strongly interact with electromagnetic fields, facilitating such schemes. While the analog approach equally suffers from the finite coherence of the simulator hardware, a noisy environment may be considered as part of the simulation, accounting for the natural noise channels in the physical system being simulated. It remains an open question how to correctly benchmark the performance of such a lossy analog quantum simulator.\n[]\nQuantum Rabi modelThe quantum Rabi model describes a two-level atom or qubit coupled to a quantized harmonic mode via a transversal\ninteraction of arbitrary strength. At weak coupling, it can be reduced to the celebrated Jaynes-Cummings model.\nUSCIn the USC regime of the quantum Rabi model, the coupling strength is comparable to the resonator and qubit energies, leading to a breakdown of the rotating-wave approximation and consequently to dynamics that are hard to track classically.\n\n#### Digital-analog approach\nA recent development is the strategy of analog-digital quantum simulations\u00a0[Unknown Author, \"Unknown Title\", ]. By merging analog unitary blocks and digital gates, the overhead in gate construction is decreased and the advantageous scaling properties of the analog simulator are preserved, while the digital steps enhance the versatility of the simulator. This approach was used to simulate the quantum Rabi model at USC by constructing necessary Hamiltonian terms with digital gates while the simulation relied on an evolution in (different) analog blocks\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. See Fig.\u00a0(Figure fig:qsimulation)(d) for the simplified basic Trotter step used in the experiment. The digital-analog approach was likewise used in a proposal of a fermion-fermion scattering experiment on a three-qubit superconducting circuit that comprises an open transmission line\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Small-scale quantum algorithms\nDigital quantum algorithms in the NISQ setting represent an interesting alternative to algorithms that rely on the full power of universal, error-corrected quantum computers. Early demonstrations of quantum algorithms in superconducting circuits focused on small, non-QEC versions of well-known quantum algorithms such as Deutsch-Jozsa [Unknown Author, \"Unknown Title\", ] and Shor [Unknown Author, \"Unknown Title\", ], as well as demonstrations of surface code primitives (discussed in Sec.\u00a0<ref>).\n\nNISQ algorithms may be thought of as `hardware-informed' quantum algorithms, i.e. the algorithms can be developed for a specific qubit connectivity to avoid certain low-fidelity qubits in the processor or hard-to-implement quantum gates. NISQ algorithms do not rely on the full support of quantum error correction, but instead optimize the algorithm fidelity based on an expectation of a lossy quantum system.  In particular, the most promising NISQ algorithms take hybrid classical-quantum approaches: they rely on classical computers and algorithms to implement the bulk of the necessary calculations, and tap the quantum processor only for the portions of the algorithm that cannot be performed efficiently on a classical processor. By delegating work to a classical processor, these algorithms reduce the circuit depth[]\nCircuit depthThe number of time-steps required to run a given quantum algorithm. For instance, the depth of the quantum circuit in Fig.\u00a0(Figure fig:qsimulation)(b) is $5$.\nand therefore minimize the impact of circuit decoherence on the accuracy of the algorithm.\n\n#### Quantum chemistry\nQuantum chemistry is potentially one of the `killer apps' for a quantum computer. This is due in large part to the development and demonstration of the variational quantum eigensolver (VQE), a hybrid classical-quantum algorithm that places relatively modest requirements on the quantum system  (see e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ] and references therein). In the VQE, the Hamiltonian of a multi-atom system is mapped onto an array of qubits using an efficient classical algorithm, such that the Hamiltonian can be written as\n$$\n\n\\hat{\\mathcal{H}} = \\sum_{i\\alpha} h^i_\\alpha\\hat\\sigma ^i_\\alpha + \\sum_{ij\\alpha\\beta} h^{ij}_{\\alpha\\beta} \\hat\\sigma ^i_\\alpha \\hat\\sigma ^j_\\beta + ...,\n\n$$\nwhere $\\{i,j, ...\\}$ index over qubits, $\\{\\alpha, \\beta, ...\\}$ index over Pauli-matrix elements, and $\\{h_{\\alpha,\\beta}^{ij}\\}$ are classically computed weights [Unknown Author, \"Unknown Title\", ]. To find the energy levels of the molecule, one initializes a test state on the quantum system, measures the relevant expectation values $\\langle \\hat\\sigma ^i_\\alpha \\hat\\sigma ^j_\\beta\\rangle$, and reconstructs the total energy $\\langle \\hat{\\mathcal{H}} \\rangle$ of the state. By using a classical minimization algorithm with $\\langle \\hat{\\mathcal{H}} \\rangle$ as the objective function, one can find an upper limit to the ground state energy. Once the ground state is known, the higher energy levels can be estimated using quantum subspace expansion (QSS) [Unknown Author, \"Unknown Title\", ] or an equation-of-motion (EOM) approach [Unknown Author, \"Unknown Title\", ].\n\nThe first VQE demonstration in a superconducting qubit system was performed by O'Malley et al., who demonstrated its effectiveness in using two qubits to map the ground state of the H$_2$ molecule as a function of inter-atomic spacing [Unknown Author, \"Unknown Title\", ].  Kandala et al. used similar methods with up to six qubits to map the ground states of larger molecules, including LiH and BeH$_2$ [Unknown Author, \"Unknown Title\", ]. Colless et al. used the QSS to map the excited states of H$_2$ using a noise-resilient variant of the VQE [Unknown Author, \"Unknown Title\", ]; Ganzhorn et al. also calculated higher energy levels, using an efficient gate set to generate the ground state and the EOM method to extract excited state energies\u00a0[Unknown Author, \"Unknown Title\", ].\n\n#### Data processing on quantum computers\nThere have been a number of important algorithmic developments and demonstrations related to data processing on quantum computers and quantum machine learning (QML). One canonical QML algorithm is the Harrow, Hassidim, and Lloyd (HHL) algorithm for sampling solutions to systems of linear equations [Unknown Author, \"Unknown Title\", ]. This algorithm can in certain settings provide exponential speedup over its classical counterparts; a four-qubit implementation was demonstrated by Zheng et al. [Unknown Author, \"Unknown Title\", ]. However, the HHL algorithm is not NISQ-optimized and makes rather stringent demands on the system's ability to store and manipulate coherent quantum information.\n\nOne of the most promising QML algorithms for the NISQ era is the Quantum Approximate Optimization Algorithm (QAOA) [Unknown Author, \"Unknown Title\", ]. The QAOA provides an approximate solution to an NP-hard multivariate minimization problem in polynomial time, with a guaranteed accuracy set by the algorithm.  Like the VQE, the QAOA allows for the bulk of calculations to be performed in the classical processor, with the quantum device only required to produce a certain quantum state and perform a set of quantum measurements. The QAOA was first demonstrated by Otterbach et al. using a 19-qubit processor [Unknown Author, \"Unknown Title\", ].\n\nA third set of machine-learning NISQ algorithms relate to data classification.  These algorithms, which represent quantum equivalents of neural networks [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], take advantage of variational techniques to enable both supervised and unsupervised data classification mechanisms. In particular, Havlicek et al. demonstrated two supervised learning algorithms using two qubits on a five-qubit processor and laid out the case for the potential existence of feature maps for which a provable quantum advantage could be demonstrated [Unknown Author, \"Unknown Title\", ]. On a similar five-qubit processor, Rist\u00e9 et al. implemented the so-called `learning parity with noise' problem, which exhibits a quantum advantage [Unknown Author, \"Unknown Title\", ].\n\nHowever, the assumption of access to some form of quantum random access memory (QRAM) [Unknown Author, \"Unknown Title\", ] in several of the proposed schemes for analyzing classical data on quantum computers poses an open question for the feasibility of these protocols (see e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ] and references therein for details).[]\nQRAMA quantum form of random access memory which can store either quantum or classical data, but has the ability that stored data can be addressed using a superposition input.\nRAQMA random access quantum memory, where classical bits give the address of a quantum state to be retreived.\nUsing a single parametrically driven transmon qubit, a form of random access quantum memory (RAQM) was demonstrated by Naik et al. [Unknown Author, \"Unknown Title\", ].\n\n### Quantum annealing\nA formally equivalent approach to universal quantum computation is adiabatic quantum computation\u00a0[Unknown Author, \"Unknown Title\", ], where the solution to computational problems is encoded into the ground state of a time-dependent Hamiltonian\u00a0[Unknown Author, \"Unknown Title\", ]. Solving the problem translates into an adiabatic quantum evolution towards the global minimum of a potential energy landscape that represents the problem Hamiltonian. In classical annealing \u2013 used as a general heuristic for solving optimization problems \u2013 this is achieved by using simulated thermal fluctuations that allow the system to escape local minima, in combination with an appropriate annealing schedule that ensures the adiabaticity condition\u00a0[Unknown Author, \"Unknown Title\", ]. In quantum annealing, transitions between states are caused by quantum fluctuations rather than thermal fluctuations, leading to a more efficient convergence to the groundstate for certain problems\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. Quantum annealers strive to implement ideal adiabatic quantum computation for a restricted set of Hamiltonians, but suffer from experimental compromises\u00a0[Unknown Author, \"Unknown Title\", ], at the expense of universality or adiabaticity\u00a0[Unknown Author, \"Unknown Title\", ].\n\nThe most notable experimental implementation of quantum annealing to date is a device with ${\\sim} 2000$ superconducting flux qubits manufactured by D-Wave (D-Wave Systems, Burnaby, Canada). Frequency tunable qubits are arranged in inter-coupled unit cells comprising eight qubits, where each qubit in a unit cell is longitudinally coupled to four other qubits in the final Hamiltonian, defining a so-called \"Chimera\" graph\u00a0[Unknown Author, \"Unknown Title\", ]. The D-Wave devices can model the transverse-field Ising Hamiltonian,\n$$\n\n\\hat H=\\Lambda(t)\\left[\\sum_i h_i \\hat\\sigma _i ^z +\\sum_{i<j}J_{ij}\\hat\\sigma _i ^z \\hat\\sigma _j ^z\\right] +\\Gamma(t)\\sum_i \\Delta_i\\hat\\sigma _i ^x,\n\n$$\nwhere $2h_i$ are the asymmetry energies, $J_{ij}$ are the coupling matrix elements, and $\\Delta_i$ are the tunneling energies. At the beginning of the quantum annealing process, $\\Gamma(0)=1$ and $\\Lambda(0)=0$ in order to create a known groundstate, being an equal superposition in the computational basis. During the annealing protocol, $\\Gamma$ is adiabatically ramped to zero while $\\Lambda$ is increased to unity in order to adiabatically evolve to the final Ising Hamiltonian.\n\nIn a recent experiment\u00a0[Unknown Author, \"Unknown Title\", ], a three-dimensional lattice of $512$ Ising spins was simulated on the D-Wave device in order to map out the magnetic phase diagram of a spin glass. In a similar experiment, the D-Wave group studied the Kosterlitz-Thouless phase transition in a frustrated Ising model\u00a0[Unknown Author, \"Unknown Title\", ]. Both papers demonstrate that a variety of relevant lattices are accessible to the D-Wave approach by using non-trivial encodings, enabling research of condensed matter phenomena that are hard to address classically at a large scale. Recently, a framework was developed that maps the prime factorization problem on the D-Wave Ising model\u00a0[Unknown Author, \"Unknown Title\", ], demonstrating a reduced cost of $\\mathcal{O}(\\log^2(N))$ qubits (where $N$ is the integer number to be factorized). This has led to the experimental factorization of a seven-digit number with 89 qubits on the D-Wave machine\u00a0[Unknown Author, \"Unknown Title\", ].\nA definitive demonstration of a quantum enhancement for a general class of problems has been elusive for the D-Wave machines and quantum annealing in general\u00a0[Unknown Author, \"Unknown Title\", ]. In this context, it is known that the current D-Wave architecture is only able to implement stoquastic Hamiltonians, which can oftentimes be simulated efficiently with classical algorithms\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. []\nStoquasticityA Hamiltonian is stoquastic when its groundstate can be expressed as a classical probability distribution, allowing for more efficient classical sampling due to the absence of the \"sign problem\"\u00a0[Unknown Author, \"Unknown Title\", ]. Non-stoquastic Hamiltonians are believed to be inefficient to simulate classically.\nRecent studies, however, indicate that the D-Wave machine achieves significant runtime advantages for a certain class of problems\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]. It is an open question whether this is due to a quantum speedup or corresponds to a more efficient classical computation.\n\nD-Wave recently demonstrated a quantum annealing experiment of a non-stoquastic Hamiltonian on a two flux qubit chip with fixed capacitive transversal coupling [Unknown Author, \"Unknown Title\", ]. Another experiment has been demonstrated that simulates non-stoquastic Hamiltonians on a nine-transmon qubit chip\u00a0[Unknown Author, \"Unknown Title\", ], where non-stoquasticity was created by incorporating digital gates that construct the necessary distinct couplings.\n\n## QUANTUM ERROR CORRECTION WITH SUPERCONDUCTING QUBITS\nDespite the tremendous progress on coherence, gate operations, and readout fidelity achieved with superconducting qubits, quantum error correction (QEC) will still be needed to realize truly large-scale quantum computers.\nMost QEC schemes utilize some form of redundancy (typically, multiple qubits) to encode so-called logical qubits. A prescription for performing the encoding and for correcting errors in the encoding is referred to as an error correcting code. The threshold theorem\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] then guarantees that for a QEC code, if the operational error-rate on the physical qubits is below a certain value, and the code is implemented in a fault-tolerant manner (see Sec.\u00a0<ref>), then errors can be suppressed to arbitrary precision (see e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ] for a general introduction to QEC). The two-dimensional surface code is perhaps the most promising, experimentally feasible QEC code in the near term, due to its particularly lenient error rate to satisfy the threshold theorem (error rate $\\lesssim 1\\%$), and because it only requires weight-four parity measurements using nearest-neighbour coupling to four qubits (see e.g. Refs.\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ] and references therein for details). []\nLogical qubitA redundantly encoded qubit in which quantum errors in the constituent components can be identified and corrected without corrupting the encoded qubit. A logical qubit beyond the `break-even point' has improved coherence (and potentially gate operation properties) over its uncorrected components.\nAs a consequence, much of the experimental progress towards QEC has been focused on realizing multi-qubit parity measurements as well as primitives towards the surface code.\n[t]\n\n## Parity measurements - a workhorse in quantum error detection and correction\nMany quantum error correction schemes rely on parity measurements. In the left circuit below, the ancilla qubit $|A\\rangle$ is used to infer the bit parity (via information about $\\langle Z_1Z_2\\rangle$) of the two data qubits in state $|\\Psi\\rangle$, and in the right circuit qubit $|A\\rangle$ infers the phase parity (via $\\langle X_1X_2\\rangle$),\n$$\n\\Qcircuit @C=0.75em @R=1em{\n\\lstick{\\raisebox{-0.6cm}{$|\\Psi\\rangle$}\\,} &\t\\lstick{\\raisebox{-0.75cm}{$\\left\\{ \\vphantom{\\rule{0.1cm}{0.3cm}}\\right.$}} & \t\\ctrl{2}\t& \\qw\t\t      & \\qw & \\qw & \\\\\n&  \t& \t \\qw\t\t& \\ctrl{1}\t\t  & \\qw & \\qw & \\\\\n& \\lstick{|A\\rangle} \t& \t \\targ \t\t& \\targ &  \\meter & \\cw &     & \\quad \\langle Z_1Z_2 \\rangle_\\Psi\\\\\n}\n\\quad\\quad\\quad\\quad\\quad\n\\raisebox{-0.55cm}{\\text{and}}\n\\quad\\quad\\quad\\quad\\quad\n\\Qcircuit @C=0.75em @R=0.5em{\n\\lstick{\\raisebox{-0.6cm}{$|\\Psi\\rangle$}\\,} &\t\\lstick{\\raisebox{-0.75cm}{$\\left\\{ \\vphantom{\\rule{0.1cm}{0.3cm}}\\right.$}} & \\qw \t\t& \\targ\t\t& \\qw\t \t& \\qw &\\qw & \\qw & \\\\\n&  \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t& \t\\qw \t& \\qw\t\t& \\targ\t\t& \\qw &\\qw & \\qw & \\\\\n& \\lstick{|A\\rangle} \t\t\t\t\t\t\t\t\t\t\t\t\t\t& \t\\gate{H}& \\ctrl{-2}\t& \\ctrl{-1} & \\gate{H} & \\meter & \\cw &     & \\quad \\langle X_1X_2 \\rangle_\\Psi\\\\\n}\n$$\nIn the absence of errors on the ancilla qubit, the eigenvalue of $|A\\rangle$ will contain information reflecting whether the two-qubit state $|\\Psi\\rangle$ is an eigenstate of $Z_1Z_2$ (or $X_1X_2$) with eigenvalue $+1$ or $-1$ without collapsing the state of the individual qubits in $|\\Psi\\rangle$. Since the operators $Z_1Z_2$ and $X_1X_2$ (and even multiples of more $Z$ and $X$ operators) commute, combinations of parity measurements across a larger grid of qubits can therefore be used to infer if and where a bit- or phase-flip error ocurred, without collapsing the underlying quantum data. The collection of ancilla qubit measurements is typically referred to as the syndrome of the error, and inferring the underlying error is known as decoding.\n\n### Progress in error detection and correction using parity measurements\nMost experiments using superconducting qubits for quantum error detection and correction rely on parity measurements of two or more `data qubits', by coupling them to `syndrome' qubits. This basic construction has been used to demonstrate multiple aspects of error detection and error correction, which we review below. Figure\u00a0(Figure fig:surface-code-experiments) shows a section of the surface code, where circles correspond to the data qubits, and cross and triangle shapes are the ancilla syndrome qubits, used to infer the overall bit- and phase\u2013parity of the neighboring data qubits. For a brief description of parity measurements, see the infobox on parity measurements below. A general introduction to parity measurements (syndrome measurements) in the context of the surface code can be found in Ref.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nWithin the last 10 years, multiple experiments using superconducting qubits have realized parity measurements relying on a qubit layout corresponding to various sub-sections of the surface code. In particular, a single one-dimensional row of the surface code fabric, the so-called repetition code, which corrects either bit-flip or phase-flip errors, has been implemented in a multitude of ways. Reed et al.\u00a0[Unknown Author, \"Unknown Title\", ] first demonstrated a three-qubit repetition code (corresponding to the section denoted $r_1$ and highlighted in the inset of Fig.\u00a0(Figure fig:surface-code-experiments)) using the -gate, together with the three-qubit controlled-controlled-phase gate (the -gate) to correct a single error. Using the `cross-resonance' two-qubit gate, Chow et al.\u00a0[Unknown Author, \"Unknown Title\", ] demonstrated entanglement across three qubits (section $r_2$ in Fig.\u00a0(Figure fig:surface-code-experiments)). By using the middle qubit as a parity meter of the outer qubits, the authors were able to generate either the odd or even Bell states between the two non-nearest neighbor qubits, conditioned on the parity readout. Similar ideas were demonstrated simultaneously by Saira et al.\u00a0[Unknown Author, \"Unknown Title\", ].\n\n< g r a p h i c s >\n\nA section of the qubit layout of the surface code, with $40\\times 20$ data qubits (shown as circles), and associated bit-flip and phase-flip parity qubits are shown as triangles and crosses, respectively. Inset shows a subsection, in which shaded areas indicate parity experiments that have been reported, except `surface-17' which is currently being pursued in multiple laboratories (see text for details). Experiment $r_1$ by Reed et al.\u00a0[Unknown Author, \"Unknown Title\", ], $r_2$ by Chow et al.\u00a0[Unknown Author, \"Unknown Title\", ], $r_3$ by Rist\u00e9 et al\u00a0[Unknown Author, \"Unknown Title\", ], $r_4$ by Kelly et al.\u00a0[Unknown Author, \"Unknown Title\", ],  2-$X,$2-$Z$ by C\u00f3rcoles et al.\u00a0[Unknown Author, \"Unknown Title\", ], 2-$XZ$ by Andersen et al.\u00a0[Unknown Author, \"Unknown Title\", ] and Bultink et al.\u00a0[Unknown Author, \"Unknown Title\", ], 4-$XZ$ by Takita et al.\u00a0[Unknown Author, \"Unknown Title\", ].\n\nUsing an optimized form of the -gate\u00a0[Unknown Author, \"Unknown Title\", ], Barends et al.\u00a0[Unknown Author, \"Unknown Title\", ] demonstrated a two-qubit gate fidelity of $\\mathcal F \\sim 0.994$ (see Tbl.\u00a0(Table tab:2qubitgates)), using the `xmon' variant of the transmon qubit\u00a0[Unknown Author, \"Unknown Title\", ]. This was the first demonstration of a two-qubit gate in superconducting qubits whose fidelity (as measured via interleaved Clifford randomized benchmarking) surpassed the error threshold for the surface code. Kelly et al.\u00a0[Unknown Author, \"Unknown Title\", ] then used this implementation of the -gate to demonstrate both a five- and nine-qubit repetition code (sections denoted $r_4$ in Fig.\u00a0(Figure fig:surface-code-experiments)). The authors performed multiple rounds of error detection, and then used a minimum-weight perfect-matching algorithm in post-processing to determine and correct the most likely physical errors. This process resulted in an improved encoded state fidelity, when going from a five-qubit repetition code to a nine-qubit code, showing for the first time the efficacy of the repetition code. As of writing, the experiments performed by Kelly et al. represent the largest (by qubit-count) repetition code to have been experimentally demonstrated. Work by Rist\u00e9 et al.\u00a0[Unknown Author, \"Unknown Title\", ] studied performance of the bit-flip repetition code by artificially injecting coherent and incoherent noise after encoding a 3-qubit logical state (corresponding to the section denoted $r_3$ in Fig.\u00a0(Figure fig:surface-code-experiments)).\n\nThe repetition code by itself cannot simultaneously detect both bit- and phase-flip errors, so it cannot serve as a full quantum error correcting code. However, first work towards demonstrating full quantum error detection (as a precursor to full quantum error correction) of bit and phase flips was demonstrated by C\u00f3rcoles et al.\u00a0[Unknown Author, \"Unknown Title\", ]. By using a $2\\times 2$ `half-plaquette' of the surface code (corresponding to  section 2-$X$,2-$Z$ in Fig.\u00a0(Figure fig:surface-code-experiments)), the authors demonstrated quantum error detection in a two-qubit Bell state by reading both the $Z_1Z_2$ and $X_1X_2$ parities within one round of error correction.\n\nRecently, stabilization of Bell states has been studied using a single ancilla to perform both $Z_1Z_2$ and $X_1X_2$ parity checks, corresponding to the region denoted 2-$ZX$ in Fig.\u00a0(Figure fig:surface-code-experiments). The work by Andersen et al.\u00a0[Unknown Author, \"Unknown Title\", ] demonstrated real-time stabilization (using fast feedback) to maintain a Bell state fidelity of ${\\sim} 0.74$ in up to 12 cycles of feedback. The experiment by Bultink et al.\u00a0[Unknown Author, \"Unknown Title\", ] used the so-called \"Pauli frame updating\" technique to keep track of parity flips in up to $26$ rounds (corresponding to roughly 20s experiment time) with a resulting state fidelity ${\\sim} 0.8$.\n\nHowever, unlike the repetition code experiments, the surface code relies on weight-four parity measurements, i.e., measuring operators of the form $Z_1Z_2Z_3Z_4$ or $X_1X_2X_3X_4$. The first demonstration of weight-four parity measurements in superconducting qubits was performed by Takita et al.\u00a0[Unknown Author, \"Unknown Title\", ], corresponding to the section labelled $4-XZ$ in Fig.\u00a0(Figure fig:surface-code-experiments). By utilizing an optimized gate implementation to cancel spurious cross-talk issues related to the two-qubit cross-resonance gate, the authors achieved a weight-four parity fidelity of 0.774 for $Z_1Z_2Z_3Z_4$ and 0.795 for $X_1X_2X_3X_4$.\n\nFinally, the smallest logical qubit that uses the surface code encoding and can be error corrected is denoted `surface-17' and is shown in the inset of Fig.\u00a0(Figure fig:surface-code-experiments). The `surface-17' logical qubit uses nine data qubits and eight parity measurement qubits to simultaneously correct both bit- and phase-flip errors. Such a device is under current investigation using the -gate to implement two-qubit operations [Unknown Author, \"Unknown Title\", ].\n\n### Fault tolerance using superconducting qubits\nThe notion of fault tolerance (FT) is a key component for realizing a scalable quantum computer from faulty physical components. FT is an architectural property of a QEC quantum circuit, which (roughly stated) ensures that single physical errors in the underlying components do not propagate in a single time-step to corrupt logical data (see e.g. Ref. [Unknown Author, \"Unknown Title\", ] for details).\n\nDemonstrating explicit FT in superconducting qubit systems has to date been focused on using a version of the $[\\![4,2,2 ]\\!]$\u2013code (see Ref.\u00a0[Unknown Author, \"Unknown Title\", ] and references therein), which requires five physical qubits in total. This code encodes two logical qubits into four physical qubits and uses a fifth qubit for error-detection. The low physical qubit count for this code comes at the expense of not being an error-correcting code, but only an error-detection code. In the experiments of Ref.\u00a0[Unknown Author, \"Unknown Title\", ] one FT encoded qubit, and one non-FT encoded qubit were initialized (limited by the connectivity of the device). In the presence of noise, the FT-encoded circuits were shown to produce the intended state with greater probability than the non-FT circuit.[]\n$[\\![n,k,d ]\\!]$\u2013codesA shorthand notation for a quantum error correcting code using $n$ physical qubits (not counting overhead for parity readout or FT circuits), which encodes $k$ logical qubits, with a distance $d=2t+1$ that can correct $t$ errors.\nVuillot also studied FT state preparation circuits\u00a0[Unknown Author, \"Unknown Title\", ]. By using the highest-quality pair of physical qubits on the device to generate a set of specific states, Vuillot was able to show that by preparing the same states, but with FT encoding circuits, led to an average improvement in the state preparation fidelity.\n\nTo deconvolve the effects of state preparation and measurement (SPAM) errors from the improvements due to FT encodings, Harper & Flammia recently performed Clifford randomized benchmarking using the $[\\![4,2,2 ]\\!]$\u2013code [Unknown Author, \"Unknown Title\", ]. The infidelity of the logical gates decrease by nearly an order of magnitude when FT encodings are used, relative to non-FT physically equivalent gates.\n\n### Bosonic codes with superconducting cavities\nBosonic codes \u2013 those built from the internal states of a QHO \u2013 represent a different approach to demonstrating error-resilient qubits. Rather than encoding a logical qubit in the shared state of many two-level systems, as in the surface code, a bosonic code constructs a logical qubit from the many energy levels of a single quantum object (in this context, typically the long-lived photonic states of a superconducting cavity). Bosonic codes have had a remarkably rapid development trajectory and are now leading the superconducting qubit field in early prototype demonstrations of fault-tolerant error-corrected quantum computing. A few broad categories of bosonic codespaces have been considered, namely:\n\nFock-state encodings: Qubits are mapped onto the $|0/1\\rangle$ Fock states and form a direct analogy to a traditional spin 1/2 qubit encoding. Fock states are the longest-lived QHO qubits, but do not implement a bosonic code.\nExample cat codes\nThe `2-cat code': $|{0/1}\\rangle_L = |{\\alpha}\\rangle \\pm |{-\\alpha}\\rangle$\nThe `4-cat code': $|{0/1}\\rangle_L = |{\\alpha}\\rangle + |{-\\alpha}\\rangle \\pm |{i\\alpha}\\rangle \\pm |{-i\\alpha}\\rangle$\n\nExample binomial codesEncoding 1:\n\n$|{0}\\rangle_L = |{2}\\rangle$\n$|{1}\\rangle_L = \\frac{|{0}\\rangle + |{4}\\rangle}{\\sqrt{2}}$\nEncoding 2:\n\n$|{0/1}\\rangle_L = \\frac{1}{\\sqrt{2}} \\left( \\frac{|{0}\\rangle + |{4}\\rangle}{\\sqrt{2}} \\pm |{2}\\rangle\\right)$\nInstead, they are the benchmark against which to evaluate the QEC logical qubit lifetime.\n\nCat codes [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ]: Qubits are formed using superpositions of coherent states. The superpositions are chosen such that the loss of a single photon maps the system onto a detectable and correctable error space while maintaining the encoded information. Cat codes require a relatively large $\\overline{n}$ in order to approach orthogonality in the codespace. With sufficiently high $\\overline{n}$, error correction can be performed at the end of the experimental cycle as long as error detection is performed quasi-continuously.\n\nBinomial codes [Unknown Author, \"Unknown Title\", ]: Qubits are defined via a finite number of Fock states with binomial coefficients. Binomial codes comprise exactly orthogonal logical states constructed such that photon loss maps the system onto a correctable error space. The codespace can be constructed to allow for multiple photon losses at the expense of higher $\\overline{n}$. Binomial codes are in some sense a hybrid between Fock encodings, which are not correctable, and cat states, which require larger $\\overline{n}$ and are not exactly orthogonal. QEC on a binomial code requires correction at the time of detection.\n\nRecent demonstrations have confirmed the potential of bosonic codes in QEC and for fault-tolerant quantum computing. The initial demonstration of mapping an arbitrary qubit state onto a cat state was performed in 2013 by Vlastakis et al. [Unknown Author, \"Unknown Title\", ]. Error detection was demonstrated by observing parity jumps [Unknown Author, \"Unknown Title\", ], with fidelity limited by the relatively short lifetime of the transmon ancilla qubit used to read and control the cavity state. Universal control of cavity states in general [Unknown Author, \"Unknown Title\", ] and of logical bosonic codes in particular [Unknown Author, \"Unknown Title\", ] were demonstrated, enabling measurement-based QEC of cat codes [Unknown Author, \"Unknown Title\", ] and binomial codes [Unknown Author, \"Unknown Title\", ]. The former demonstration surpassed the break-even point by showing an error-corrected lifetime $T_{1, \\text{QEC}}$ greater than the Fock state lifetime $T_{1,\\text{Fock}}$; the latter came very close to this threshold and additionally demonstrated high-fidelity (although not error-corrected) operations on the logical single qubits.\n\nBeyond single logical qubit demonstrations, there have been several recent demonstrations of entanglement generation and two-qubit gates between the encoded bosonic qubit states. These demonstrations include a logical  [Unknown Author, \"Unknown Title\", ],  gate teleportation between two error-correctable qubits machined from the same aluminum block [Unknown Author, \"Unknown Title\", ], logical state transfer and remote entanglement between qubits separated by a long delay cable [Unknown Author, \"Unknown Title\", ] and an exponential-SWAP operation [Unknown Author, \"Unknown Title\", ]. While these multi-qubit experiments do not yet include active error correction, they have shown the feasibility of operations on logical states, and represent continuing progress towards universal QEC using superconducting hardware.\n\n## LOOKING AHEAD\nIn this review, we have discussed several of the most recent advances in the development of qubit architectures, gate operation, amplification and readout, and digital- and analog-algorithm implementations, as well as work toward quantum error correction. Despite the already tremendous progress outlined in this review, the field is still undergoing rapid development, and the theoretical, experimental, and conceptual boundaries are consistently being pushed. Below, we briefly discuss some future directions and near-term challenges for the field.\n\n### Beyond the surface code for quantum error correction\nWhile the surface code is promising due to its relatively lenient error threshold and modest requirements on connectivity, the overhead of physical-to-logical qubits is daunting, and the fault-tolerant gate-set is limited\u00a0[Unknown Author, \"Unknown Title\", ]. Other topological and concatenated codes typically have more demanding error thresholds and connectivity requirements (see e.g.\u00a0[Unknown Author, \"Unknown Title\", ] and references therein for a more detailed discussion), but allow for fault-tolerant implementation of a larger gate set. Whether other codes will be experimentally feasible in the near term hinges to some extent on whether improving overall gate fidelity or improving qubit count and connectivity is the more difficult endeavor.\n\nFor the bosonic codes, while the preliminary experiments have been promising, significant challenges remain. Fault-tolerant single-qubit error detection has been demonstrated [Unknown Author, \"Unknown Title\", ], but there are no current proposals for fault-tolerant multi-qubit protocols. In the absence of fault-tolerant gates, universal computing will require embedding the bosonic qubit in a larger error-correcting fabric (such as a surface code), potentially implying all of the associated scaling issues just discussed.\n\nEntirely different schemes rely on native error-resilience, providing another path forward for high-fidelity quantum memories and operations. Examples of this approach include the $0-\\pi$ qubit\u00a0[Unknown Author, \"Unknown Title\", ], `error-transparent' encodings\u00a0[Unknown Author, \"Unknown Title\", ], and the metastable flux qubit\u00a0[Unknown Author, \"Unknown Title\", ].\n\n### Alternative superconducting qubits\nThe transmon qubit modality has shown tremendous progress over the last decade, but it has certain limitations. The charge noise resilience of the transmon qubit comes at the expense of a small anharmonicity, making it more likely for excitations to leave the computational subspace. This shortcoming is addressed by the fluxonium qubit\u00a0[Unknown Author, \"Unknown Title\", ], which can be considered as combining the advantages of the Cooper-pair box and the flux qubit, while avoiding their respective drawbacks, at the cost of introducing high numbers of Josephson junctions per qubit. While recent experiments indicate excellent coherence properties of fluxonium qubits\u00a0[Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], it has not yet been used in larger scale, more complex circuits since its operation is less straightforward and its coupling capabilities in a circuit QED environment remain to be demonstrated.\n\nA different strategy, which still relies on the transmon qubit modality, replaces the local flux control used in the tunable transmon qubits with local voltage control, by using superconductor-semiconductor-superconductor Josephson junctions. In such systems, a local electrostatic gate is used to tune the carrier density in the semiconductor region, resulting in a modified $E_\\text{J}$. Such devices were first demonstrated in InAs nanowires proximitized by epitaxially-grown aluminum [Unknown Author, \"Unknown Title\", ] [Unknown Author, \"Unknown Title\", ], forming the transmon qubit element in a cQED setup. Subsequently, improved coherence times as well as compatibility with large external magnetic fields were demonstrated\u00a0[Unknown Author, \"Unknown Title\", ]. However, the need to individually place nanowires makes the path to larger devices within this scheme potentially difficult. Alternative demonstrations of such hybrid superconducting qubit systems have therefore used two-dimensional electron gases\u00a0[Unknown Author, \"Unknown Title\", ] amenable to top-down fabrication, as well as graphene flakes proximitized by evaporated aluminum\u00a0[Unknown Author, \"Unknown Title\", ]. The absence of local currents results in a decrease of the power that needs to be delivered onto the qubit chip, but at the cost of reintroducing some charge noise susceptibility through the gate.\n\n### Next steps\nAlthough there is ample daylight ahead for both NISQ-era demonstrations and large-scale, FT quantum computers based on superconducting qubits, there are also many nontrivial obstacles to overcome. On the path toward large quantum processors, the demonstration of multiple error- corrected FT logical qubits with gate fidelities and lifetimes exceeding any of the constituent degrees of freedom will be an important step. Finally, we outline a few of the challenges facing the community, as quantum processors are now moving from 10\u201320-qubit scale to the 50\u2013100-qubit scale.\n[NEAR-TERM CHALLENGES]\n\n$\\circ$ Control and high coherence in medium-scale devices: For medium- and large-scale devices, the individual qubit coherences are not necessarily the same as those in a simpler few-qubit devices. Maintaining high coherence and high-fidelity control across a large chip is a key challenge.\n\n$\\circ$ Scalable calibration techniques: Advanced software strategies are also needed to calibrate medium-to-large scale quantum processors due to the large number of non-trivial cross-calibration terms while finding simultaneous optimal operating parameters.\n\n$\\circ$ Verification and validation: As the number of qubits increases, efficiently determining the fidelity of quantum operations across the entire chip using e.g. Clifford randomized benchmarking\u00a0[Unknown Author, \"Unknown Title\", ] becomes infeasible and new techniques for validation and verification will be needed. Techniques such as `cross entropy benchmarking'\u00a0[Unknown Author, \"Unknown Title\", ] and `direct benchmarking'\u00a0[Unknown Author, \"Unknown Title\", ] have recently been proposed and implemented.\n\n$\\circ$ Improving qubit connectivity: While impressive progress has been made in three-dimensional integration of superconducting\ncircuits (e.g. Ref.\u00a0[Unknown Author, \"Unknown Title\", ]), non-planar connectivity of high-fidelity qubits has yet to be demonstrated.\n\n$\\circ$ Improved gate fidelity: Continued improvements to gate fidelities will be an important step towards bringing down the overhead of physical qubits needed to encode a single logical qubit as well as important for demonstrating the efficacy of NISQ algorithms.\n\n$\\circ$ Robust & reproducible fabrication: The fabrication of medium-to-large scale superconducting circuits will need to be consistent with continued improvements to qubit coherence and 3D integration techniques.\n\nUsing current techniques \u2013 nothwithstanding the challenges outlined above \u2013 it seems possible to scale to on the order of $\\sim$1000 qubits. However, beyond this (rough) number, a new set of techniques will be needed. Examples include co-location inside the dilution refrigerator of control and readout electronics, as well as on-the-fly decoders for quantum error correction procedures.\n\nDISCLOSURE STATEMENT\n\nThe authors are not aware of any affiliations, memberships, funding, or financial holdings that\nmight be perceived as affecting the objectivity of this review.\n\nACKNOWLEDGMENTS\n\nThe authors gratefully acknowledge input and comments from Laura Garc\u00eda-\u00c1lvarez, Gabriel Samach, Antti Veps\u00e4l\u00e4inen and Serge Rosenblum on the manuscript as well as numerous fruitful discussions with Terry P. Orlando. MK gratefully acknowledges support from the Carlsberg Foundation during part of this work. PK acknowledges partial support by the Wallenberg Centre for Quantum Technology (WACQT) funded by Knut and Alice Wallenberg Foundation. This research was funded in part by the U.S. Army Research Office Grant Nos. W911NF-14-1-0682, W911NF-18-1-0116, W911NF-18-1-0411, and MURI W911NF-18-1-0218; the National Science Foundation Grant No. PHY-1720311; and the Office of the Director  of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA) and the Assistant Secretary of Defense for Research and Engineering via MIT Lincoln Laboratory under Air Force Contract No. FA8721-05-C-0002. Opinions, interpretations, conclusions, and recommendations are those of the authors and are not necessarily endorsed by the United States Government.\n\nar-style4\n\n183\nnatexlab#1#1\n\nnielsen_quantum_2011\nNielsen MA, Chuang IL. 2011.\nQuantum Computation and Quantum Information: 10th Anniversary\nEdition.\nNew York, NY, USA: Cambridge University Press\n\nmontanaro_quantum_2016\nMontanaro A. 2016.\nnpj Quant. Info. 2:15023\n\nbarends_superconducting_2014\nBarends R, Kelly J, Megrant A, Veitia A, Sank D, et\u00a0al. 2014.\nNature 508:500\u2013503\n\nKoch2007\nKoch J, Yu TM, Gambetta J, Houck AA, Schuster DI, et\u00a0al. 2007.\nPhys. Rev. A 76:042319\n\nsheldon_procedure_2016\nSheldon S, Magesan E, Chow JM, Gambetta JM. 2016.\nPhys. Rev. A 93:060302\n\nhong_demonstration_2019\nHong SS, Papageorge AT, Sivarajah P, Crossman G, Dider N, et\u00a0al. 2019.\narXiv:1901.08035\n\npreskill_quantum_2018\nPreskill J. 2018.\nQuantum 2:79\n\ngambetta_building_2017\nGambetta JM, Chow JM, Steffen M. 2017.\nnpj Quant. Info. 3:2\n\ndevoret_superconducting_2013\nDevoret MH, Schoelkopf RJ. 2013.\nScience 339:1169\u20131174\n\njones_layered_2012\nJones NC, Van\u00a0Meter R, Fowler AG, McMahon PL, Kim J, et\u00a0al. 2012.\nPhys. Rev. X 2:031007\n\nofek_extending_2016\nOfek N, Petrenko A, Heeres R, Reinhold P, Leghtas Z, et\u00a0al. 2016.\nNature 536:441\u2013445\n\nhu_demonstration_2018\nHu L, Ma Y, Cai W, Mu X, Xu Y, et\u00a0al. 2019.\nNat. Phys. 15:503\u2013508\n\nrosenblum_cnot_2018\nRosenblum S, Gao YY, Reinhold P, Wang C, Axline CJ, et\u00a0al. 2018.\nNat. Comm. 9:652\n\nkelly_state_2015\nKelly J, Barends R, Fowler AG, Megrant A, Jeffrey E, et\u00a0al. 2015.\nNature 519:66\u201369\n\nOtterbach2017\nOtterbach JS, Manenti R, Alidoust N, Bestwick A, Block M, et\u00a0al. 2017.\narXiv:1712.05771\n\nkandala_hardware-efficient_2017\nKandala A, Mezzacapo A, Temme K, Takita M, Brink M, et\u00a0al. 2017.\nNature 549:242\u2013246\n\nneill_blueprint_2018\nNeill C, Roushan P, Kechedzhi K, Boixo S, Isakov SV, et\u00a0al. 2018.\nScience 360:195\u2013199\n\narute_supremacy_2019\nArute F, Arya K, Babbush R, Bacon D. Bardin JC, et\u00a0al. 2019.\nNature 574:505\u2013510\n\nwei_verifying_2019\nWei KX, Lauer I, Srinivasan S, Sundaresan N, McClure DT, et\u00a0al. 2019.\narXiv:1905.05720\n\nmoore_ibm_2017\nMoore SK. 2017.\nIBM Edges Closer to Quantum Supremacy with 50-Qubit Processor.\nHttps://spectrum.ieee.org/tech-talk/computing/hardware/ibm-edges-closer-to-quantum-supremacy-with-50qubit-processor\n\nrigetti_rigetti_2018\nRigetti C. 2018.\nThe Rigetti 128-qubit chip and what it means for quantum.\nHttps://medium.com/rigetti/the-rigetti-128-qubit-chip-and-what-it-means-for-quantum-df757d1b71ea\n\nhsu_ces_2018\nHsu J. 2018.\nCES 2018: Intel\u2019s 49-Qubit Chip Shoots for Quantum Supremacy.\nHttps://spectrum.ieee.org/tech-talk/computing/hardware/intels-49qubit-chip-aims-for-quantum-supremacy\n\nkelly_preview_2018\nKelly J. 2018.\nA Preview of Bristlecone, Google\u2019s New Quantum Processor.\nHttp://ai.googleblog.com/2018/03/a-preview-of-bristlecone-googles-new.html\n\nharrow_quantum_2017\nHarrow AW, Montanaro A. 2017.\nNature 549:203\u2013209\n\nWendin2006\nG. Wendin and V.S. Shumeiko. 2006.\nHandbook of Theoretical and Computational Nanotechnology: Quantum Circuits, Qubits and Computing\nAmerican Scientific Publishers, Los Angeles\n\nClarke2008\nJ Clarke and F. K. Wilhelm. 2008.\nNature 453:1031\u20131042\n\ngirvin_circuit_2009\nGirvin SM, Devoret MH, Schoelkopf RJ. 2009.\nPhys. Scr. T137:014012\n\nOliver2013\nOliver WD, Welander PB. 2013.\nMRS Bull. 38:816-\u2013825\n\ndevoret_circuit_2014\nGirvin SM. 2014.\nCircuit QED: superconducting qubits coupled to microwave photons. In\nQuantum Machines: Measurement and Control of Engineered\nQuantum Systems, eds. M\u00a0Devoret, B\u00a0Huard, R\u00a0Schoelkopf, LF\u00a0Cugliandolo,\nno. Proc. of the 2011 Les Houches Summer School on Quantum Machines. Oxford\nUniversity Press,  113\u2013256\n\nwendin_quantum_2017\nWendin G. 2017.\nRep. Prog. Phys. 80:106001\n\ngu_microwave_2017\nGu X, Kockum AF, Miranowicz A, Liu Yx, Nori F. 2017.\nPhysics Reports 718-719:1\u2013102\n\nkrantz_quantum_2019\nKrantz P, Kjaergaard M, Yan F, Orlando TP, Gustavsson S, Oliver WD. 2019\nAppl. Phys. Revs. 6:021318\n\nhauke_perspectives_2019\nHauke P, Katzgraber HG, Lechner W, Nishimori H, Oliver WD. 2019.\narXiv:1903.06559\n\nNakamura1999\nNakamura Y, Paskin YA, Tsai JS. 1999\nNature 398:786\u2013788\n\nNakamura2002\nNakamura Y, Pashkin Y A, Yamamoto T, Tsai J S. 2002\nPhys. Rev. Lett. 88:047901\n\nVion2002\nVion D, Aassime A, Cottet A, Joyez P, Pothier H, et\u00a0al. 2002\nScience 296:886\u2013889\n\nChiorescu2003\nChiorescu I, Nakamura Y, Harmans CJPM, Mooij JE. 2003\nScience 299:1869\u20131871\n\nBertet2005\nBertet P, Chiorescu I, Burkard G, Semba K, Harmans CJPM, et\u00a0al. 2005\nPhys. Rev. Lett. 95:257002\n\nHouck2008\nHouck A, Schreier AA, Johnson BR, Chow JM, Koch J, et\u00a0al. 2008.\nPhys. Rev. Lett. 101:080502\n\nManucharyan2009\nManucharyan VE, Koch J, Glazman LI, Devoret MH. 2009.\nScience 326:113\u2013116\n\nBylander2011\nBylander J, Gustavsson S, Yan F, Yoshihara F, Harrabi K, et\u00a0al. 2011.\nNat. Phys 7:565\u2013570\n\nPaik2011\nPaik H, Schuster, DI, Bishop LS, Kirchmair G, Catelani G, et\u00a0al. 2011.\nPhys. Rev. Lett. 107:240501\n\nRigetti2012\nRigetti C, Gambetta JM, Poletto S, Plourde BLT, Chow JM, et\u00a0al. 2012.\nPhys. Rev. B 86:100506(R)\n\nChang2013\nChang JB, Vissers MR, C\u00f3rcoles AD, Sandberg M, Gao J, et\u00a0al. 2013.\nAppl. Phys. Lett. 103:012602\n\nPop2014\nPop IM, Geerlings K, Catelani G, Schoelkopf RJ, Glazman LI, Devoret MH. 2014.\nNature 508:369\u2013372\n\nJin2015\nJin XY, Kamal A, Sears AP, Gudmundson T, Hover D, et\u00a0al. 2015.\nPhys. Rev. Lett. 114:240501\n\nYan2016\nYan F, Gustavsson S, Kamal A, Birenbaum J, Sears AP, et\u00a0al. 2016.\nNat. Comm. 7:12964\n\nNguyen2018\nNguyen LB, Lin YH, Somoroff A, Mencia R, Grabon N, Manucharyan VE. 2018.\narXiv:1810.11006\n\nLarsen2015_1\nLarsen TW, Petersson KD, Kuemmeth F, Jespersen TS, Krogstrup P, et\u00a0al. 2015.\nPhys. Rev. Lett. 115:127001\n\nCasparis2016\nCasparis L, Larsen TW, Olsen MS, Kuemmeth F, Krogstrup P, et\u00a0al. 2016\nPhys Rev. Lett. 116:150505\n\nLuthi2018\nLuthi F, Stavenga T, Enzing OW, Bruno A, Dickel C, et\u00a0al. 2018.\nPhys. Rev. Lett. 120:100502\n\nWang2019\nWang JIJ, Rodan-Legrain D, Bretheau L, Campbell DL, Kannan B, et\u00a0al. 2019.\nNat. Nano. 14:120\u2013125\n\nhwang_2008\nWang H, Hofheinz M, Ansmann M, Bialczak RC, Lucero E, et\u00a0al. 2008\nPhys. Rev. Lett. 101:240401\n\ncwang_2016\nWang C, Gao YY, Reinhold R, Heeres RW, Ofek N, et\u00a0al. 2016\nScience 352:1087-1091\n\nrosenblum_fault-tolerant_2018\nRosenblum S, Reinhold P, Mirrahimi M, Jiang L, Frunzio L, Schoelkopf RJ.\n2018b.\nScience 361:266\u2013270\n\nchen_qubit_2014\nChen Y, Neill C, Roushan P, Leung N, Fang M, et\u00a0al. 2014.\nPhys. Rev. Lett. 113:220502\n\nMooij1999\nMooij JE, Orlando TP, Levitov L, Tian L, van\u00a0der Wal CH, Lloyd S. 1999.\nScience 285:1036\u20131039\n\nOrlando1999\nOrlando TP, Mooij JE, Tian L, van\u00a0der Wal CH, Levitov LS, Lloyd S., Mazo JJ 1999.\nPhys. Rev. B 60:15398\n\nNori2007\nYou JQ, Hu X, Ashhab S, Nori F. 2007\nPhys. Rev. B 75:140515(R)\n\nSteffen2010\nSteffen M, Brito F, DiVincenzo D, Farinelli M, Keefe G, et\u00a0al. 2010\nJ. of Phys.: Cond. Mat 22:053201\n\nHarris2009\nHarris R, Lanting T, Berkley AJ, Johansson J, Johnson MW, et\u00a0al. 2009.\nPhysical Review B 80:052506\n\nWeber2017\nWeber SJ, Samach GO, Hover D, Gustavsson S, Kim DK, et\u00a0al. 2017.\nPhys. Rev. Appl. 8:014004\n\nkerman_high-fidelity_2008\nKerman AJ, Oliver WD. 2008.\nPhys. Rev. Lett. 101:070501\n\nJohnson2011\nJohnson MW, Amin MHS, Gildert S, Lanting T, Hamze F, et\u00a0al. 2011.\nNature 473:194\n\nmotzoi_simple_2009\nMotzoi F, Gambetta JM, Rebentrost P, Wilhelm FK. 2009.\nPhys. Rev. Lett. 103:110501\n\ngustavsson_improving_2013\nGustavsson S, Zwier O, Bylander J, Yan F, Yoshihara F, et\u00a0al. 2013.\nPhys. Rev. Lett. 110:040502\n\nsheldon_characterizing_2016\nSheldon S, Bishop LS, Magesan E, Filipp S, Chow JM, Gambetta JM.\n2016b.\nPhys. Rev. A 93:012301\n\nrol_restless_2017\nRol M, Bultink C, O\u2019Brien T, de\u00a0Jong S, Theis L, et\u00a0al. 2017.\nPhys. Rev. Appl. 7:041001\n\nreagor_demonstration_2018\nReagor M, Osborn CB, Tezak N, Staley A, Prawiroatmodjo G, et\u00a0al. 2018.\nSci. Adv. 4:eaao3603\n\nmagesan_scalable_2011\nMagesan E, Gambetta JM, Emerson J. 2011.\nPhys. Rev. Lett. 106:180504\n\nmckay_efficient_2017\nMcKay DC, Wood CJ, Sheldon S, Chow JM, Gambetta JM. 2017.\nPhys. Rev. A 96:22330\n\ndicarlo_demonstration_2009\nDiCarlo L, Chow JM, Gambetta JM, Bishop LS, Johnson BR, et\u00a0al. 2009.\nNature 460:240\u2013244\n\nkjaergaard_2019\nKjaergaard M, Schwartz M, Greene A, Samach GO, Bengtsson A, et\u00a0al. 2020.\narXiv:2001.08838\n\ndewes_characterization_2012\nDewes A, Ong FR, Schmitt V, Lauro R, Boulant N, et\u00a0al. 2012.\nPhys. Rev. Lett. 108:057002\n\nchow_simple_2011\nChow JM, C\u00f3rcoles AD, Gambetta JM, Rigetti C, Johnson BR, et\u00a0al. 2011.\nPhys. Rev. Lett. 107:080502\n\npoletto_entanglement_2012\nPoletto S, Gambetta JM, Merkel ST, Smolin JA, Chow JM, et\u00a0al. 2012.\nPhys. Rev. Lett. 109:240505\n\nchow_microwave-activated_2013\nChow JM, Gambetta JM, Cross AW, Merkel ST, Rigetti C, Steffen M. 2013.\nNew J. Phys. 15:115012\n\npaik_experimental_2016\nPaik H, Mezzacapo A, Sandberg M, McClure D, Abdo B, et\u00a0al. 2016.\nPhys. Rev. Lett. 117:250502\n\nmckay_universal_2016\nMcKay DC, Filipp S, Mezzacapo A, Magesan E, Chow JM, Gambetta JM. 2016.\nPhys. Rev. Appl. 6:064007\n\ncaldwell_parametrically_2018\nCaldwell SA, Didier N, Ryan CA, Sete EA, Hudson A, et\u00a0al. 2018.\nPhys. Rev. Appl. 10:034050\n\nneeley_generation_2010\nNeeley M, Bialczak RC, Lenander M, Lucero E, Mariantoni M, et\u00a0al. 2010.\nNature 467:570\u2013573\n\nChou2018\nChou KS, Blumoff JZ, Wang CS, Reinhold PC, Axline CJ, et\u00a0al. 2018.\nNature 561:368\u2013373\n\nBlais2004\nBlais A, Huang RS, Wallraff A, Girvin SM, Schoelkopf RJ. 2004.\nPhys. Rev. A 69:062320\n\nWallraff2004\nWallraff A, Schuster DI, Blais A, Frunzio L, Majer J, et\u00a0al. 2004.\nNature 431:162\u2013166\n\nReed2010\nReed MD, Johnson BR, Houck AA, DiCarlo L, Chow JM, et\u00a0al. 2010.\nAppl. Phys. Lett. 96:203110\n\nClerk2010\nClerk AA, Devoret MH, Girvin SM, Marquardt F, Schoelkopf RJ. 2010.\nRev. Mod. Phys. 82:1155\u20131208\n\nYurke1988\nYurke B, Kaminsky PG, Miller RE, Whittaker Ea, Smith aD, et\u00a0al. 1988.\nPhys. Rev. Lett. 60:764\u2013767\n\nYamamoto2008\nYamamoto T, Inomata K, Watanabe M, Matsuba K, Miyazaki T, et\u00a0al. 2008.\nAppl. Phys. Lett. 93:042510\n\nSimoen2015\nSimoen M, Chang CWS, Krantz P, Bylander J, Wustmann W, et\u00a0al. 2015.\nJ. Appl. Phys. 118:154501\n\nMallet2009\nMallet F, Ong FR, Palacios-Laloy A, Nguyen F, Bertet P, et\u00a0al. 2009.\nNat. Phys. 5:791\u2013795\n\nVijay2009\nVijay R, Devoret MH, Siddiqi I. 2009.\nRev. Sci. Instrum. 80:111101\n\nLin2014\nLin ZR, Inomata K, Koshino K, Oliver WD, Nakamura Y, et\u00a0al. 2014.\nNat. Comm. 5:15\n\nKrantz2016\nKrantz P, Bengtsson A, Simoen M, Gustavsson S, Shumeiko V, et\u00a0al. 2016.\nNat. Comm. 7:11417\n\nMutus2014\nMutus JY, White TC, Barends R, Chen Y, Chen Z, et\u00a0al. 2014.\nApplied Physics Letters 104:263513\n\nRoy2015\nRoy T, Kundu S, Chand M, Vadiraj AM, Ranadive A, et\u00a0al. 2015.\nApplied Physics Letters 107:262601\n\nMacklin2015\nMacklin C, O\u2019Brien K, Hover D, Schwartz ME, Bolkhovsky V,\net\u00a0al. 2015.\nScience 350:307\u2013310\n\nKrastanov2015\nKrastanov S, Albert VV, Shen C, Zou CL, Heeres RW, et\u00a0al. 2015.\nPhys. Rev. A 92:040303\n\nReagor2013\nReagor M, Paik H, Catelani G, Sun L, Axline C, et\u00a0al. 2013.\nAppl. Phys. Lett. 102:192604\n\nReagor2016\nReagor M, Pfaff W, Axline C, Heeres RW, Ofek N, et\u00a0al. 2016.\nPhys. Rev. B 94:014506\n\nGottesman2001\nGottesman D, Kitaev A, Preskill J. 2001.\nPhys. Rev. A 64:012310\n\nHeeres2015\nHeeres RW, Vlastakis B, Holland E, Krastanov S, Albert VV, et\u00a0al. 2015.\nPhys. Rev. Lett. 115:137002\n\nHeeres2017\nHeeres RW, Reinhold P, Ofek N, Frunzio L, Jiang L, et\u00a0al. 2017.\nNat. Comm. 8:94\n\nSun2014\nSun L, Petrenko A, Leghtas Z, Vlastakis B, Kirchmair G, et\u00a0al. 2014.\nNature 511:444\u2013448\n\nGambetta2006\nGambetta J, Blais A, Schuster DI, Wallraff A, Frunzio L, et\u00a0al. 2006.\nPhys. Rev. A 74:042318\n\nSchuster2007\nSchuster DI, Houck AA, Schreier JA, Wallraff A, Gambetta JM, et\u00a0al. 2007.\nNature 445:515\u2013518\n\nLutterbach1997\nLutterbach LG, Davidovich L. 1997.\nPhys. Rev. Lett. 78:2547\u20132550\n\nCohen2017\nCohen J, Smith WC, Devoret MH, Mirrahimi M. 2017.\nPhys. Rev. Lett. 119:060503\n\nboixo_characterizing_2018\nBoixo S, Isakov SV, Smelyanskiy VN, Babbush R, Ding N, et\u00a0al. 2018.\nNat. Phys. 14:595\u2013600\n\nIBM_press_release\nIBM News Room:IBM makes quantum computing available on IBM cloud to accelerate innovation. 2016.\nNews release https://www-03.ibm.com/press/us/en/pressrelease/49661.wss\n\nPreskill2011\nPreskill J. 2011\narXiv:1203.5813\n\nPednault2019\nPednault E, Gunnels JA, Nannicini G, Horesh L, Wisnieff R. 2019\narXiv:1910.09534\n\nParaoanu2014\nParaoanu GS. 2014.\nJ. Low Temp. Phys. 175:633\u2013654\n\nBuluta2009\nBuluta I, Nori F. 2009.\nScience 326:108\u2013111\n\nFeynman1982\nFeynman RP. 1982.\nInt. J. Theor. Phys. 21:467\u2013488\n\nLloyd1996\nLloyd S. 1996.\nScience 273:1073\u20131078\n\nGeorgescu2014\nGeorgescu IM, Ashhab S, Nori F. 2014.\nRev. Mod. Phys. 86:153\u2013185\n\nBarends2015\nBarends R, Lamata L, Kelly J, Garc\u00eda-\u00c1lvarez L, Fowler AG, et\u00a0al. 2015.\nNat. Comm. 6:7654\n\nBraumueller2017\nBraum\u00fcller J, Marthaler M, Schneider A, Stehli A, Rotzinger H, et\u00a0al. 2017.\nNat. Comm. 8:779\n\nPotocnik2018\nPoto\u010dnik A, Bargerbos A, Schr\u00f6der FAYN, Khan SA, Collodo MC, et\u00a0al. 2018.\nNat. Comm. 9:904\n\nLangford2017\nLangford NK, Sagastizabal R, Kounalakis M, Dickel C, Bruno A, et\u00a0al. 2017.\nNat. Comm. 8:1715\n\nAspuru-Guzik2005\nAspuru-Guzik A. 2005.\nScience 309:1704\u20131707\n\nGarcia-Ripoll2008\nGarc\u00eda-Ripoll JJ, Solano E, Martin-Delgado MA. 2008.\nPhys. Rev. B 77:024522\n\nHouck2012\nHouck AA, T\u00fcreci HE, Koch J. 2012.\nNat. Phys. 8:292\u2013299\n\nSuzuki1990\nSuzuki M. 1990.\nPhys. Lett. A 146:319\u2013323\n\nBabbush2015\nBabbush R, McClean J, Wecker D, Aspuru-Guzik A, Wiebe N. 2015.\nPhys. Rev. A 91:022311\n\nHeras2015\nHeras UL, Garc\u00eda-\u00c1lvarez L, Mezzacapo A, Solano E, Lamata L. 2015.\nEPJ Quant. Tech. 2\n\nBarends2016\nBarends R, Shabani A, Lamata L, Kelly J, Mezzacapo A, et\u00a0al. 2016.\nNature 534:222\n\nSalathe2015\nSalath\u00e9 Y, Mondal M, Oppliger M, Heinsoo J, Kurpiers P, et\u00a0al. 2015.\nPhys. Rev. X 5:021027\n\nHeras2014\nHeras UL, Mezzacapo A, Lamata L, Filipp S, Wallraff A, Solano E. 2014.\nPhys. Rev. Lett. 112:200501\n\nGarcia-Alvarez2016\nGarc\u00eda-\u00c1lvarez L, Las\u00a0Heras U, Mezzacapo A, Sanz M, Solano E, Lamata L. 2016.\nSci. Rep. 6:27836\n\nViehmann2013\nViehmann O, von Delft J, Marquardt F. 2013.\nPhys. Rev. Lett. 110:030601\n\nTian2010\nTian L. 2010.\nPhys. Rev. Lett. 105:167001\n\nZhang2014\nZhang Y, Yu L, Liang JQ, Chen G, Jia S, Nori F. 2014.\nSci. Rep. 4:4083\n\nReiner2016\nReiner JM, Marthaler M, Braum\u00fcller J, Weides M, Sch\u00f6n G. 2016.\nPhys. Rev. A 94:032338\n\nMei2013\nMei F, Stojanovi\u00a0\u0107\u0107 VM, Siddiqi I, Tian L. 2013.\nPhys. Rev. B 88:224502\n\nPedernales2013\nPedernales JS, Candia RD, Ballester D, Solano E. 2013.\nNew J. Phys. 15:055008\n\nBallester2012\nBallester D, Romero G, Garc\u00eda-Ripoll JJ, Deppe F, Solano E. 2012.\nPhys. Rev. X 2:021007\n\nYan2019\nYan Z, Zhang Y-R, Gong M, Wu Y, Zheng Y, et\u00a0al. 2019\nScience 364:753\u2013756\n\nma_dissipatively_2019\nMa R, Saxberg B, Owens C, Leung N, Lu Y, et\u00a0al. 2019.\nNature 566:51\n\nRoushan2016\nRoushan, P. and Neill, C. and Megrant, A. and Chen, Y. and Babbush, R., et\u00a0al. 2016.\nNat. Phys. 13:146\n\nRoushan2017\nP. Roushan and C. Neill and J. Tangpanitanon and V. M. Bastidas and A. Megrant, et\u00a0al. 2017.\nScience 358:1175\u20131179\n\nMostame2012\nMostame S, Rebentrost P, Eisfeld A, Kerman AJ, Tsomokos DI, Aspuru-Guzik A.\n2012.\nNew J. Phys. 14:105013\n\nLeggett1987\nLeggett A, Chakravarty S, Dorsey A, Fisher M, Garg A, Zwerger W. 1987.\nRev. Mod. Phys. 59:1\u201385\n\nMagazzu2018\nMagazz\u00f9 L, Forn-D\u00edaz P, Belyansky R, Orgiazzi JL, Yurtalan MA, et\u00a0al. 2018.\nNat. Comm. 9:1403\n\nLeppaekangas2018\nLepp\u00e4kangas J, Braum\u00fcller J, Hauck M, Reiner JM, Schwenk I, et\u00a0al. 2018.\nPhys. Rev. A 97:052321\n\nForn-Diaz2016\nForn-D\u00edaz P, Garc\u00eda-Ripoll J, Peropadre B, Orgiazzi JL, Yurtalan M, et\u00a0al.\n2016.\nNat. Phys. 13:39\u201343\n\nForn-Diaz2010\nForn-D\u00edaz P, Lisenfeld J, Marcos D, Garc\u00eda-Ripoll JJ, Solano E, et\u00a0al.\n2010.\nPhys. Rev. Lett. 105:237001\n\nYoshihara2016\nYoshihara F, Fuse T, Ashhab S, Kakuyanagi K, Saito S, Semba K. 2016.\nNat. Phys. 13:44\u201347\n\nLamata2018\nLamata L, Parra-Rodriguez A, Sanz M, Solano E. 2018.\nAdv. Phys. X 3:1457981\n\nMezzacapo2014\nMezzacapo A, Las\u00a0Heras U, Pedernales JS, DiCarlo L, Solano E, Lamata L. 2014.\nSci. Rep. 4:7482\n\nGarcia-Alvarez2015\nGarc\u00eda-\u00c1lvarez L, Casanova J, Mezzacapo A, Egusquiza IL, Lamata L,\net\u00a0al. 2015.\nPhys. Rev. Lett. 114:070502\n\nLucero2012\nLucero E, Barends R, Chen Y, Kelly J, Mariantoni M, et\u00a0al. 2012.\nNat. Phys. 8:719\u2013723\n\nmoll_quantum_2018\nMoll N, Barkoutsos P, Bishop LS, Chow JM, Cross A, et\u00a0al. 2018.\nQuantum Sci. Technol. 3:030503\n\nPeruzzo2014\nPeruzzo A, McClean J, Shadbolt P, Yung MH, Zhou XQ, et\u00a0al. 2014.\nNat. Comm. 5:4213\n\nMcclean2016\nMcClean JR, Schwartz ME, Carter J, de\u00a0Jong WA. 2016\n\nRowe1968\nRowe DJ. 1968.\nReviews of Modern Physics 40:153\u2013166\n\nOMalley2016\nO'Malley PJ, Babbush R, Kivlichan ID, Romero J, McClean JR, et\u00a0al. 2016.\nPhys. Rev. X\n\nKandala2017\nKandala A, Mezzacapo A, Temme K, Takita M, Brink M, et\u00a0al. 2017b.\nNature\n\nColless2018\nColless JI, Ramasesh VV, Dahlen D, Blok MS, Kimchi-Schwartz ME, et\u00a0al. 2018.\nPhys. Rev. X 8:011021\n\nGanzhorn2018\nGanzhorn M, Egger DJ, Barkoutsos PK, Ollitrault P, Salis G, et\u00a0al. 2018.\nPhys. Rev. Appl. 11:044092\n\nHarrow2009\nHarrow AW, Hassidim A, Lloyd S. 2009.\nPhys. Rev. Lett. 103:150502\n\nZheng2017\nZheng Y, Song C, Chen MC, Xia B, Liu W, et\u00a0al. 2017.\nPhys. Rev. Lett. 118:210504\n\nFarhi2014\nFarhi E, Goldstone J, Gutmann S. 2014.\narXiv:1411.4028\n\nFarhi2018\nFarhi E, Neven H. 2018.\narXiv:1802.06002\n\nMitarai2018\nMitarai K, Negoro M, Kitagawa M, Fujii K. 2018.\nPhys. Rev. A 98:032309\n\nHavlicek2018\nHavl\u00ed\u010dek V, C\u00f3rcoles AD, Temme K, Harrow AW, Kandala A, et\u00a0al. 2019.\nNature 567:209\n\nRiste2017\nRist\u00e8 D, da\u00a0Silva MP, Ryan CA, Cross AW, Smolin JA, et\u00a0al. 2017.\nnpj Quantum Information 3:16\n\nGiovannetti_2008\nGiovannetti V, Lloyd S, Maccone L. 2008\nPhys. Rev. Lett. 100:160501\n\nciliberto_carlo_quantum_2018\nCiliberto Carlo, Herbster Mark, Ialongo Alessandro Davide, Pontil\nMassimiliano, Rocchetto Andrea, et\u00a0al. 2018.\nProceedings of the Royal Society A: Mathematical, Physical and\nEngineering Sciences 474:20170551\n\nnaik_random_2017\nNaik RK, Leung N, Chakram S, Groszkowski P, Lu Y, et\u00a0al. 2017.\nNat. Comm. 8:1904\n\nAharonov2008\nAharonov D, van Dam W, Kempe J, Landau Z, Lloyd S, Regev O. 2008.\nSIAM Review 50:755\u2013787\n\nVinci2017\nVinci W, Lidar DA. 2017.\nnpj Quant. Info. 3:38\n\nKadowaki1998\nKadowaki T, Nishimori H. 1998.\nPhys. Rev. E 58:5355\u20135363\n\nBoixo2016\nBoixo S, Smelyanskiy VN, Shabani A, Isakov SV, Dykman M, et\u00a0al. 2016.\nNat. Comm. 7:10327\n\nHarris2018\nHarris R, Sato Y, Berkley AJ, Reis M, Altomare F, et\u00a0al. 2018.\nScience 361:162\u2013165\n\nKing2018\nKing AD, Carrasquilla J, Raymond J, Ozfidan I, Andriyash E, et\u00a0al. 2018.\nNature 560:456\u2013460\n\nJiang2018\nJiang S, Britt KA, McCaskey AJ, Humble TS, Kais S. 2018.\nScientific Reports 8:17667\n\npeng_factoring_2019\nPeng W, Wang B, Hu F, Wang Y, Fang X, et\u00a0al. 2019.\nSci. China Phys. Mech. Astron. 62:60311\n\nRonnow2014\nRonnow TF, Wang Z, Job J, Boixo S, Isakov SV, et\u00a0al. 2014.\nScience 345:420\u2013424\n\nBravyi2008\nBravyi S, Divincenzo DP, Oliveira R, Terhal BM. 2008.\nQuantum Info. Comput. 8:361\u2013385\n\nDenchev2016\nDenchev VS, Boixo S, Isakov SV, Ding N, Babbush R, et\u00a0al. 2016.\nPhys. Rev. X 6:031015\n\nMandra2016\nMandr\u00e0 S, Zhu Z, Wang W, Perdomo-Ortiz A, Katzgraber HG. 2016.\nPhys. Rev. A 94:022337\n\nozfidan_demonstration_2019\nOzfidan I, Deng C, Smirnov AY, Lanting T, Harris R, et\u00a0al. 2019.\narXiv:1903.06139\n\ngottesman_stabilizer_1997\nGottesman D. 1997. Stabilizer Codes and Quantum Error Correction. PhD Thesis, California Institute of Technology\n\naharonov_fault-tolerant_2008\nAharonov D, Ben-Or M. 2008.\nSIAM J. Comput. 38:1207\u20131282\n\nfowler_surface_2012\nFowler AG, Mariantoni M, Martinis JM, Cleland AN. 2012.\nPhys. Rev. A 86:032324\n\ntomita_low-distance_2014\nTomita Y, Svore KM. 2014.\nPhys. Rev. A 90:062320\n\nreed_realization_2012\nReed MD, DiCarlo L, Nigg SE, Sun L, Frunzio L, et\u00a0al. 2012.\nNature 482:382\u2013385\n\nchow_implementing_2014\nChow JM, Gambetta JM, Magesan E, Abraham DW, Cross AW, et\u00a0al. 2014.\nNat. Comm. 5:4015\n\nkelly_optimal_2014\nKelly J, Barends R, Campbell B, Chen Y, Chen Z, et\u00a0al. 2014.\nPhys. Rev. Lett. 112:240504\n\nBarends2013\nBarends R, Kelly J, Megrant A, Sank D, Jeffrey E, et\u00a0al. 2013.\nPhys. Rev. Lett. 111:080502\n\nsaira_entanglement_2014\nSaira O, Groen J, Cramer J, Meretska M, de\u00a0Lange G, DiCarlo L. 2014.\nPhys. Rev. Lett. 112:070502\n\nriste_detecting_2015\nRist\u00e8 D, Poletto S, Huang MZ, Bruno A, Vesterinen V, et\u00a0al. 2015.\nNat. Comm. 6:6983\n\ncorcoles_demonstration_2015\nC\u00f3rcoles AD, Magesan E, Srinivasan SJ, Cross AW, Steffen M, et\u00a0al. 2015.\nNat. Comm. 6:6979\n\nandersen_entanglement_2019\nAndersen CK, Remm A, Balasiu S, Krinner S, Heinsoo J, et\u00a0al. 2019.\narXiv:1902.06946\n\nbultink_protecting_2019\nBultink CC, O'Brien TE, Vollmer R, Muthusubramanian N, Beekman MW, et\u00a0al. 2019\narXiv:1905.12731\n\ntakita_demonstration_2016\nTakita M, C\u00f3rcoles A, Magesan E, Abdo B, Brink M, et\u00a0al. 2016.\nPhys. Rev. Lett. 117:210505\n\nversluis_scalable_2017\nVersluis R, Poletto S, Khammassi N, Tarasinski B, Haider N, et\u00a0al. 2017.\nPhys. Rev. Appl. 8:034021\n\ngottesman_introduction_2009\nGottesman D. 2009.\narXiv:0904.2557\n\ngottesman_quantum_2016\nGottesman D. 2016.\narXiv:1610.03507\n\ntakita_experimental_2017\nTakita M, Cross AW, C\u00f3rcoles A, Chow JM, Gambetta JM. 2017.\nPhys. Rev. Lett. 119:180501\n\nvuillot_is_2018\nVuillot C. 2018.\nQuant. Info. and Comp. 18:949\u2013964\n\nharper_fault-tolerant_2019\nHarper R, Flammia ST. 2019.\nPhys. Rev. Lett. 122:080504\n\nCochrane1999\nCochrane PT, Milburn GJ, Munro WJ. 1999.\nPhys. Rev. A 59:2631\u20132634\n\nMirrahimi2014\nMirrahimi M, Leghtas Z, Albert VV, Touzard S, Schoelkopf RJ, et\u00a0al. 2014.\nNew J. of Phys. 16:045014\n\nMichael2016\nMichael MH, Silveri M, Brierley RT, Albert VV, Salmilehto J, et\u00a0al. 2016.\nPhys. Rev. X 6:031006\n\nVlastakis2013\nVlastakis B, Kirchmair G, Leghtas Z, Nigg SE, Frunzio L, et\u00a0al. 2013.\nScience 342:607\u2013610\n\nAxline2018\nAxline CJ, Burkhart LD, Pfaff W, Zhang M, Chou K, et\u00a0al. 2018.\nNat. Phys. 14:705\u2013710\n\nGao2018\nGao YY, Lester BJ, Chou K, Frunzio L, Devoret MH, Jiang L, et\u00a0al. 2019.\nNature 556:509\u2013512\n\nCampbell2017a\nCampbell ET, Terhal BM, Vuillot C. 2017.\nNature 549:172\u2013179\n\nbrooks_protected_2013\nBrooks P, Kitaev A, Preskill J. 2013.\nPhys. Rev. A 87:052306\n\nkapit_error-transparent_2018\nKapit E. 2018.\nPhys. Rev. Lett. 120:050503\n\nkerman_2010\nKerman AJ. 2010.\nPhys. Rev. Lett. 104:027002\n\nde_lange_realization_2015\nde\u00a0Lange G, van Heck B, Bruno A, van Woerkom D, Geresdi A, et\u00a0al. 2015.\nPhys. Rev. Lett. 115:127002\n\nCasparis2018\nCasparis L, Connolly MR, Kjaergaard M, Pearson NJ, Kringh\u00f8j A, et\u00a0al. 2018.\nNat. Nano. 13:915\u2013919\n\nproctor_direct_2019\nProctor TJ, Carignan-Dugas A, Rudinger K, Nielsen E, Blume-Kohout R, et\u00a0al. 2019.\nPhys. Rev. Lett. 123:030503\n\nrosenberg_3d_2017\nRosenberg D, Kim D, Das R, Yost D, Gustavsson S, et\u00a0al. 2017.\nnpj Quant. Info. 3:42\n\n"}
{"prompt": "What are the key contributions of the paper 'Paper 1910.11333'?", "completion": "\n\nWe acknowledge Georg Goerg for consultation on statistical analyses. This research used resources of the Oak Ridge Leadership Computing Facility, which is a DOE Office of Science User Facility supported under Contract DE-AC05-00OR22725.\n\nCorrespondence and requests for materials\nshould be addressed to John M. Martinis\u00a0(jmartinis@google.com).\n\n$^\\dagger$  Frank Arute$^1$, Kunal Arya$^1$, Ryan Babbush$^1$, Dave Bacon$^1$, Joseph C. Bardin$^{1,2}$,\n[Also at ]Department of Electrical and Computer Engineering, University of Massachusetts Amherst, Amherst, MA, 01003-9292\nRami Barends$^1$, Rupak Biswas$^3$, Sergio Boixo$^1$, Fernando G.S.L. Brandao$^{1,4}$,\n[Also at ]Institute for Quantum Information and Matter, Caltech, Pasadena, CA, USA\nDavid A. Buell$^1$, Brian Burkett$^1$, Yu Chen$^1$, Zijun Chen$^1$, Ben Chiaro$^5$,\nRoberto Collins$^1$, William Courtney$^1$, Andrew Dunsworth$^1$, Edward Farhi$^1$, Brooks Foxen$^{1,5}$, Austin Fowler$^1$, Craig Gidney$^1$, Marissa Giustina$^1$, Rob Graff$^1$, Keith Guerin$^1$, Steve Habegger$^1$, Matthew P. Harrigan$^1$, Michael J. Hartmann$^{1,6}$, Alan Ho$^1$, Markus Hoffmann$^1$, Trent Huang$^1$, Travis S. Humble$^7$, Sergei V. Isakov$^1$, Evan Jeffrey$^1$, Zhang Jiang$^1$, Dvir Kafri$^1$, Kostyantyn Kechedzhi$^1$, Julian Kelly$^1$, Paul V. Klimov$^1$, Sergey Knysh$^1$, Alexander Korotkov$^{1,8}$, Fedor Kostritsa$^1$, David Landhuis$^1$, Mike Lindmark$^1$, Erik Lucero$^1$, Dmitry Lyakh$^{9}$,\nSalvatore Mandr\u00e0$^{3,10}$,\nJarrod R. McClean$^1$, Matthew McEwen$^5$,Anthony Megrant$^1$, Xiao Mi$^1$,Kristel Michielsen$^{11,12}$,\nMasoud Mohseni$^1$, Josh Mutus$^1$, Ofer Naaman$^1$, Matthew Neeley$^1$, Charles Neill$^1$, Murphy Yuezhen Niu$^1$, Eric Ostby$^1$, Andre Petukhov$^1$, John C. Platt$^1$, Chris Quintana$^1$, Eleanor G. Rieffel$^3$, Pedram Roushan$^1$, Nicholas C. Rubin$^1$, Daniel Sank$^1$, Kevin J.\u00a0Satzinger$^1$, Vadim Smelyanskiy$^1$, Kevin J.\u00a0Sung$^{1,13}$, Matthew D. Trevithick$^1$, Amit Vainsencher$^1$, Benjamin Villalonga$^{1,14}$, Theodore White$^1$, Z. Jamie Yao$^1$, Ping Yeh$^1$, Adam Zalcman$^1$, Hartmut Neven$^1$, John M. Martinis$^{1,5}$\n\n1. Google AI Quantum, Mountain View, CA, USA,\n2. Department of Electrical and Computer Engineering, University of Massachusetts Amherst, Amherst, MA, USA,\n3. Quantum Artificial Intelligence Lab. (QuAIL), NASA Ames Research Center, Moffett Field, USA,\n4. Institute for Quantum Information and Matter, Caltech, Pasadena, CA, USA,\n5. Department of Physics, University of California, Santa Barbara, CA, USA,\n6. Friedrich-Alexander University Erlangen-N\u00fcrnberg (FAU), Department of Physics, Erlangen, Germany,\n7. Quantum Computing Institute, Oak Ridge National Laboratory, Oak Ridge, TN, USA,\n8.  Department of Electrical and Computer Engineering, University of California, Riverside, CA, USA,\n9. Scientific Computing, Oak Ridge Leadership Computing, Oak Ridge National Laboratory, Oak Ridge, TN, USA\n10. Stinger Ghaffarian Technologies Inc., Greenbelt, MD, USA,\n11. Institute for Advanced Simulation, J\u00fclich Supercomputing Centre, Forschungszentrum J\u00fclich, J\u00fclich, Germany,\n12. RWTH Aachen University, Aachen, Germany,\n13. Department of Electrical Engineering and Computer Science, University of Michigan, Ann Arbor, MI, USA,\n14. Department of Physics, University of Illinois at Urbana-Champaign, Urbana, IL, USA\n\nERRATUM\n\nThe caption of Figure 4 in the main paper [Unknown Author, \"Unknown Title\", ] incorrectly states that the error bars in the figure represent both statistical and systematic uncertainty. They represent the statistical uncertainty. See Figure\u00a0(Figure fig:stat_and_syst_error) for comparison of both types of uncertainty and discussion in Section\u00a0<ref> for details. Note that both types of uncertainty were accounted for in the analysis and all conclusions remain intact.\n\nnaturemag\n\n100\nurl<#>1urlprefixURL\n\narute2019\nauthorArute, F. et\u00a0al.\ntitleQuantum supremacy using a programmable superconducting processor.\njournalNature volume574,\npages505 (year2019).\n<https://doi.org/10.1038/s41586-019-1666-5>\n\nbarends2014nine\nauthorBarends, R. et\u00a0al.\ntitleSuperconducting quantum circuits at the surface code\nthreshold for fault tolerance.\njournalNature volume508,\npages500 (year2014).\n\ncharles_thesis\nauthorNeill, C.\ntitleA path towards quantum supremacy with\nsuperconducting qubits.\nPh.D. thesis, schoolUniversity of California, Santa\nBarbara (year2017).\n\nYan-2018-MIT\nauthorYan, F. et\u00a0al.\ntitleTunable coupling scheme for implementing\nhigh-fidelity two-qubit gates.\njournalPhys. Rev. Applied\nvolume10, pages054062\n(year2018).\n\nchen2014coupler\nauthorChen, Y. et\u00a0al.\ntitleQubit architecture with high coherence and fast\ntunable coupling.\njournalPhys. Rev. Lett.\nvolume113, pages220502\n(year2014).\n\nneill2018blueprint\nauthorNeill, C. et\u00a0al.\ntitleA blueprint for demonstrating quantum supremacy with\nsuperconducting qubits.\njournalScience volume360,\npages195\u2013199 (year2018).\n\nkhezri2015transitions\nauthorKhezri, M., authorDressel, J. &\nauthorKorotkov, A.\u00a0N.\ntitleQubit measurement error from coupling with a detuned\nneighbor in circuit QED.\njournalPhys. Rev. A volume92,\npages052306 (year2015).\n\ntucci507171cartan\nauthorTucci, R.\u00a0R.\ntitleAn introduction to Cartan\u2019s KAK decomposition\nfor QC programmers.\nnotePreprint at https://arxiv.org/abs/quant-ph/0507171\n(2005).\n\nandrew_thesis\nauthorDunsworth, A.\ntitleHigh fidelity entangling gates in\nsuperconducting qubits.\nPh.D. thesis, schoolUniversity of California, Santa\nBarbara (year2018).\n\ndunsworth2018method\nauthorDunsworth, A. et\u00a0al.\ntitleA method for building low loss multi-layer wiring for\nsuperconducting microwave devices.\njournalAppl. Phys. Lett.\nvolume112, pages063502\n(year2018).\n\nrosenberg20173bumps\nauthorRosenberg, D. et\u00a0al.\ntitle3D integrated superconducting qubits.\njournalnpj Quantum Inf.\nvolume3, pages42 (year2017).\n\nFoxen_2017\nauthorFoxen, B. et\u00a0al.\ntitleQubit compatible superconducting interconnects.\njournalQuantum Sci. Tech.\nvolume3, pages014005 (year2017).\n\nfoxen2018high_speed\nauthorFoxen, B. et\u00a0al.\ntitleHigh speed flux sampling for tunable superconducting\nqubits with an embedded cryogenic transducer.\njournalSupercond. Sci. Technol.\nvolume32, pages015012\n(year2018).\n\nBlais2004CircuitQED\nauthorBlais, A., authorHuang, R.-S.,\nauthorWallraff, A., authorGirvin, S.\u00a0M. &\nauthorSchoelkopf, R.\u00a0J.\ntitleCavity quantum electrodynamics for superconducting\nelectrical circuits: An architecture for quantum computation.\njournalPhys. Rev. A volume69,\npages062320 (year2004).\n\nGambetta2006\nauthorGambetta, J. et\u00a0al.\ntitleQubit-photon interactions in a cavity:\nMeasurement-induced dephasing and number splitting.\njournalPhys. Rev. A volume74,\npages042318 (year2006).\n\nbultink2018general\nauthorBultink, C.\u00a0C. et\u00a0al.\ntitleGeneral method for extracting the quantum efficiency\nof dispersive qubit readout in circuit QED.\njournalAppl. Phys. Lett.\nvolume112, pages092601\n(year2018).\n\nSank2016Transitions\nauthorSank, D. et\u00a0al.\ntitleMeasurement-induced state transitions in a\nsuperconducting qubit: Beyond the rotating wave approximation.\njournalPhys. Rev. Lett.\nvolume117, pages190503\n(year2016).\n\nclerk2010intro\nauthorClerk, A.\u00a0A., authorDevoret, M.\u00a0H.,\nauthorGirvin, S.\u00a0M., authorMarquardt, F. &\nauthorSchoelkopf, R.\u00a0J.\ntitleIntroduction to quantum noise, measurement, and\namplification.\njournalRev. Mod. Phys.\nvolume82, pages1155\u20131208\n(year2010).\n\ncaves1982Amplifiers\nauthorCaves, C.\u00a0M.\ntitleQuantum limits on noise in linear amplifiers.\njournalPhys. Rev. D volume26,\npages1817\u20131839 (year1982).\n\nMutus2014IMPA\nauthorMutus, J.\u00a0Y. et\u00a0al.\ntitleStrong environmental coupling in a Josephson\nparametric amplifier.\njournalAppl. Phys. Lett.\nvolume104, pages263513\n(year2014).\n\nryan2015tomography\nauthorRyan, C.\u00a0A. et\u00a0al.\ntitleTomography via correlation of noisy measurement\nrecords.\njournalPhys. Rev. A volume91,\npages022118 (year2015).\n\nJeffrey2014Fast\nauthorJeffrey, E. et\u00a0al.\ntitleFast accurate state measurement with superconducting\nqubits.\njournalPhys. Rev. Lett.\nvolume112, pages190504\n(year2014).\n\nSank2015Noise\nauthorSank, D.\ntitleWhat is the connection between analog signal to noise\nratio and signal to noise ratio in the IQ plane in a quadrature\ndemodulation system?\nhowpublishedSignal Processing Stack Exchange.\nnoteURL https://dsp.stackexchange.com/questions/24372\n(2015).\n\nReed2010Purcell\nauthorReed, M.\u00a0D. et\u00a0al.\ntitleFast reset and suppressing spontaneous emission of a\nsuperconducting qubit.\njournalAppl. Phys. Lett.\nvolume96, pages203110\n(year2010).\n\nSete2015Purcell\nauthorSete, E.\u00a0A., authorMartinis, J.\u00a0M. &\nauthorKorotkov, A.\u00a0N.\ntitleQuantum theory of a bandpass purcell filter for qubit\nreadout.\njournalPhys. Rev. A volume92,\npages012325 (year2015).\n\nchen2012mux\nauthorChen, Y. et\u00a0al.\ntitleMultiplexed dispersive readout of superconducting\nphase qubits.\njournalAppl. Phys. Lett.\nvolume101, pages182601\n(year2012).\n\nboixo2018characterizing\nauthorBoixo, S. et\u00a0al.\ntitleCharacterizing quantum supremacy in near-term\ndevices.\njournalNat. Phys. volume14,\npages595 (year2018).\n\nwootters1990random\nauthorWootters, W.\u00a0K.\ntitleRandom quantum states.\njournalFound. Phys. volume20,\npages1365\u20131378 (year1990).\n\nemerson2005\nauthorEmerson, J., authorLivine, E. &\nauthorLloyd, S.\ntitleConvergence conditions for random quantum circuits.\njournalPhys. Rev. A volume72,\npages060302 (year2005).\n\naaronson2017complexity\nauthorAaronson, S. & authorChen, L.\ntitleComplexity-theoretic foundations of quantum supremacy\nexperiments.\nIn booktitle32nd Computational Complexity Conference\n(CCC 2017) (year2017).\n\nmagesan_characterizing_2012\nauthorMagesan, E., authorGambetta, J.\u00a0M. &\nauthorEmerson, J.\ntitleCharacterizing quantum gates via randomized\nbenchmarking.\njournalPhys. Rev. A volume85\n(year2012).\n\nmagesan_robust_2011\nauthorMagesan, E., authorGambetta, J.\u00a0M. &\nauthorEmerson, J.\ntitleRobust randomized benchmarking of quantum processes.\njournalPhys. Rev. Lett.\nvolume106 (year2011).\n\nPopescu2006entanglement\nauthorPopescu, S., authorShort, A.\u00a0J. &\nauthorWinter, A.\ntitleEntanglement and the foundations of statistical\nmechanics.\njournalNat. Phys. volume2,\npages754 (year2006).\n\nbremner2009random\nauthorBremner, M.\u00a0J., authorMora, C. &\nauthorWinter, A.\ntitleAre random pure states useful for quantum\ncomputation?\njournalPhys. Rev. Lett.\nvolume102, pages190502\n(year2009).\n\nGross2009most\nauthorGross, D., authorFlammia, S.\u00a0T. &\nauthorEisert, J.\ntitleMost quantum states are too entangled to be useful as\ncomputational resources.\njournalPhys. Rev. Lett.\nvolume102, pages190501\n(year2009).\n\nmcclean2018barren\nauthorMcClean, J.\u00a0R., authorBoixo, S.,\nauthorSmelyanskiy, V.\u00a0N., authorBabbush, R. &\nauthorNeven, H.\ntitleBarren plateaus in quantum neural network training\nlandscapes.\njournalNat. Comm. volume9,\npages4812 (year2018).\n\nledoux2005concentration\nauthorLedoux, M.\ntitleThe concentration of measure phenomenon.\nnumber89 (publisherAmerican Mathematical\nSociety, year2005).\n\nmarkov_quantum_2018\nauthorMarkov, I.\u00a0L., authorFatima, A.,\nauthorIsakov, S.\u00a0V. & authorBoixo, S.\ntitleQuantum supremacy is both closer and farther than it\nappears. notePreprint at https://arxiv.org/pdf/1807.10749\n(2018).\n\ncross2018validating\nauthorCross, A.\u00a0W., authorBishop, L.\u00a0S.,\nauthorSheldon, S., authorNation, P.\u00a0D. &\nauthorGambetta, J.\u00a0M.\ntitleValidating quantum computers using randomized model\ncircuits.\njournalPhys. Rev. A\nvolume100, pages032328\n(year2019).\n\njkelly2018physical\nauthorKelly, J., authorO'Malley, P.,\nauthorNeeley, M., authorNeven, H. &\nauthorMartinis, J.\u00a0M.\ntitlePhysical qubit calibration on a directed acyclic\ngraph. notePreprint at https://arXiv.org/abs/1803.03226 (2019).\n\nWallraff2004StrongCoupling\nauthorWallraff, A. et\u00a0al.\ntitleStrong coupling of a single photon to a\nsuperconducting qubit using circuit quantum electrodynamics.\njournalNature volume431,\npages162 (year2004).\n\nchen2018metrology\nauthorChen, Z.\ntitleMetrology of quantum control and measurement in\nsuperconducting qubits.\nPh.D. thesis, schoolUniversity of California, Santa\nBarbara (year2018).\n\nchen2016measuring\nauthorChen, Z. et\u00a0al.\ntitleMeasuring and suppressing quantum state leakage in a\nsuperconducting qubit.\njournalPhys. Rev. Lett.\nvolume116, pages020501\n(year2016).\n\npaultls\nauthorKlimov, P.\u00a0V. et\u00a0al.\ntitleFluctuations of energy-relaxation times in\nsuperconducting qubits.\njournalPhys. Rev. Lett.\nvolume121, pages090502\n(year2018).\n\nkelly2014optimal\nauthorKelly, J. et\u00a0al.\ntitleOptimal quantum control using randomized\nbenchmarking.\njournalPhys. Rev. Lett.\nvolume112, pages240504\n(year2014).\n\nbialczak2010quantum\nauthorBialczak, R.\u00a0C. et\u00a0al.\ntitleQuantum process tomography of a universal entangling\ngate implemented with Josephson phase qubits.\njournalNat. Phys. volume6,\npages409 (year2010).\n\nmartinis2014fast\nauthorMartinis, J.\u00a0M. & authorGeller, M.\u00a0R.\ntitleFast adiabatic qubit gates using only $\\sigma_z$\ncontrol.\njournalPhys. Rev. A volume90,\npages022307 (year2014).\n\ndicarlo2009cz\nauthorDiCarlo, L. et\u00a0al.\ntitleDemonstration of two-qubit algorithms with a\nsuperconducting quantum processor.\njournalNature volume460,\npages240 (year2009).\n\nkivlichan2018quantum\nauthorKivlichan, I.\u00a0D. et\u00a0al.\ntitleQuantum simulation of electronic structure with\nlinear depth and connectivity.\njournalPhys. Rev. Lett.\nvolume120, pages110501\n(year2018).\n\nvillalonga2019flexible\nauthorVillalonga, B. et\u00a0al.\ntitleA flexible high-performance simulator for the\nverification and benchmarking of quantum circuits implemented on real\nhardware.\njournalnpj Quantum Information\nvolume5, pages1\n(year2019).\n\njwallman2015estimating\nauthorWallman, J., authorGranade, C.,\nauthorHarper, R. & authorFlammia, S.\u00a0T.\ntitleEstimating the coherence of noise.\njournalNew J. Phys. volume17,\npages113020 (year2015).\n\nerhard2019characterizing\nauthorErhard, A. et\u00a0al.\ntitleCharacterizing large-scale quantum computers via\ncycle benchmarking. notePreprint at\nhttps://arxiv.org/pdf/1902.08543 (2019).\n\njohnson2012heralded\nauthorJohnson, J.\u00a0E. et\u00a0al.\ntitleHeralded state preparation in a superconducting\nqubit.\njournalPhys. Rev. Lett.\nvolume109, pages050506\n(year2012).\n\ndan_thesis\nauthorSank, D.\u00a0T.\ntitleFast, accurate state measurement in\nsuperconducting qubits.\nPh.D. thesis, schoolUniversity of California, Santa\nBarbara (year2014).\n\nSOM_csv\nnoteExperimental data repository\n<https://doi.org/10.5061/dryad.k6t1rj8>\n\nbabbush2018low\nauthorBabbush, R. et\u00a0al.\ntitleLow-depth quantum simulation of materials.\njournalPhys. Rev. X volume8,\npages011044 (year2018).\n\nBoykin1999OnUniversal\nauthorBoykin, P., authorMor, T.,\nauthorPulver, M., authorRoychowdhury, V. &\nauthorVatan, F.\ntitleOn universal and fault-tolerant quantum computing.\njournalProc. 40th Annual Symposium on Foundations of\nComputer Science, IEEE Computer Society Press  (year1999).\n\nDiVincenzo1995Twobit\nauthorDiVincenzo, D.\u00a0P.\ntitleTwo-bit gates are universal for quantum computation.\njournalPhys. Rev. A volume51,\npages1015\u20131022 (year1995).\n\nshor1995scheme\nauthorShor, P.\u00a0W.\ntitleScheme for reducing decoherence in quantum computer\nmemory.\njournalPhys. Rev. A volume52,\npagesR2493(R) (year1995).\n\nknill2008randomized\nauthorKnill, E. et\u00a0al.\ntitleRandomized benchmarking of quantum gates.\njournalPhys. Rev. A volume77,\npages012307 (year2008).\n\nkolmogorov-smirnov-test\nauthorLehmann, E.\u00a0L. & authorRomano, J.\u00a0P.\ntitleTesting Statistical Hypotheses\n(publisherSpringer-Verlag New York, year2005).\n\nscipy\nauthorJones, E., authorOliphant, T.,\nauthorPeterson, P. et\u00a0al.\ntitleSciPy: Open source scientific tools for Python\n(year2001).\nnoteURL http://www.scipy.org/ (2016).\n\nR_package\nauthorR Core Team.\ntitleR: A Language and Environment for Statistical\nComputing.\norganizationR Foundation for Statistical Computing,\naddressVienna, Austria (year2017).\nnoteURL https://www.R-project.org/\n\nbootstrapping\nauthorEfron, B.\ntitleBootstrap methods: Another look at the jackknife.\njournalAnn. Stat. volume7,\npages1 (year1979).\n\nDyakonov18\nauthorDyakonov, M.\ntitleThe case against quantum computing.\njournalIEEE Spectrum volume56,\nissue3,\npages24-29 (year2019).\n\nKalai19\nauthorKalai, G.\ntitleThe argument against quantum computers.\nnotePreprint at https://arxiv.org/pdf/1908.02499 (2019).\n\nsmelyanskiy2016qhipster\nauthorSmelyanskiy, M., authorSawaya, N.\u00a0P. &\nauthorAspuru-Guzik, A.\ntitleqHiPSTER: the quantum high performance software\ntesting environment. notePreprint at\nhttps://arxiv.org/pdf/1601.07195 (2016).\n\nvillalonga2019establishing\nauthorVillalonga, B. et\u00a0al.\ntitleEstablishing the quantum supremacy frontier with a\n281 Pflop/s simulation. notePreprint at\nhttps://arxiv.org/pdf/1905.00444 (2019).\n\nMS08\nauthorMarkov, I.\u00a0L. & authorShi, Y.\ntitleSimulating quantum computation by contracting tensor\nnetworks.\njournalSIAM J. Comput.\nvolume38, pages963\u2013981\n(year2008).\n\nBoi17\nauthorBoixo, S., authorIsakov, S.\u00a0V.,\nauthorSmelyanskiy, V.\u00a0N. & authorNeven, H.\ntitleSimulation of low-depth quantum circuits as complex\nundirected graphical models. notePreprint at\nhttps://arxiv.org/pdf/1712.05384 (2017).\n\nlyakh_tal_sh\nauthorLyakh, D.\ntitleTensor algebra library routines for shared memory\nsystems.\nhowpublishedURL https://github.com/DmitryLyakh/TAL_SH\n(2019).\n\nchen2018classical\nauthorChen, J. et\u00a0al.\ntitleClassical simulation of intermediate-size quantum\ncircuits. notePreprint at https://arxiv.org/pdf/1805.01450\n(2018).\n\nguo2019general\nauthorGuo, C. et\u00a0al.\ntitleGeneral-purpose quantum circuit simulator with\nprojected entangled-pair states and the quantum supremacy frontier.\nnotePreprint at https://arxiv.org/pdf/1905.08394 (2019).\n\nRAED07x\nauthorDe\u00a0Raedt, K. et\u00a0al.\ntitleMassively parallel quantum computer simulator.\njournalComput. Phys. Commun.\nvolume176, pages121\u2013136\n(year2007).\n\nRAED19a\nauthorDe\u00a0Raedt, H. et\u00a0al.\ntitleMassively parallel quantum computer simulator, eleven\nyears later.\njournalComput. Phys. Commun.\nvolume237, pages47\u201361\n(year2019).\n\nJURECA\nauthorKrause, D. & authorTh\u00f6rnig, P.\ntitleJureca: Modular supercomputer at J\u00fclich\nsupercomputing centre.\njournalJournal of large-scale research facilities\nJLSRF volume4, pages132\n(year2018).\n\nJUWELS\nauthorKrause, D.\ntitleJuwels: Modular tier-0/1 supercomputer at the\nJ\u00fclich supercomputing centre.\njournalJournal of large-scale research facilities\nJLSRF volume5, pages135\n(year2019).\n\nkalai2014gaussian\nauthorKalai, G. & authorKindler, G.\ntitleGaussian noise sensitivity and bosonsampling.\njournalarXiv:1409.3093  (year2014).\n\nbremner2017achieving\nauthorBremner, M.\u00a0J., authorMontanaro, A. &\nauthorShepherd, D.\u00a0J.\ntitleAchieving quantum supremacy with sparse and noisy\ncommuting quantum computations.\njournalQuantum volume1,\npages8 (year2017).\n\nyung2017can\nauthorYung, M.-H. & authorGao, X.\ntitleCan chaotic quantum circuits maintain quantum\nsupremacy under noise?\njournalarXiv:1706.08913  (year2017).\n\nboixo2017fourier\nauthorBoixo, S., authorSmelyanskiy, V.\u00a0N. &\nauthorNeven, H.\ntitleFourier analysis of sampling from noisy chaotic\nquantum circuits.\njournalarXiv:1708.01875  (year2017).\n\nnahum2018operator\nauthorNahum, A., authorVijay, S. &\nauthorHaah, J.\ntitleOperator spreading in random unitary circuits.\njournalPhys. Rev. X volume8,\npages021014 (year2018).\n\nvon2018operator\nauthorVon\u00a0Keyserlingk, C., authorRakovszky, T.,\nauthorPollmann, F. & authorSondhi, S.\u00a0L.\ntitleOperator hydrodynamics, OTOCs, and entanglement\ngrowth in systems without conservation laws.\njournalPhys. Rev. X volume8,\npages021013 (year2018).\n\ngogate2004complete\nauthorGogate, V. & authorDechter, R.\ntitleA complete anytime algorithm for treewidth.\nIn booktitleProceedings of the 20th Conference on\nUncertainty in Artificial Intelligence, pages201\u2013208\n(year2004).\n\nzhang2019alibaba\nauthorZhang, F. et\u00a0al.\ntitleAlibaba cloud quantum development kit: Large-scale\nclassical simulation of quantum circuits. notePreprint at\nhttps://arxiv.org/pdf/1907.11217 (2019).\n\nchen2019quantum\nauthorChen, M.-C. et\u00a0al.\ntitleQuantum teleportation-inspired algorithm for sampling\nlarge random quantum circuits. notePreprint at\nhttps://arxiv.org/pdf/1901.05003 (2019).\n\nNote1\nnoteWe assume 2 vCPUs per core.\n\nkoomey2016\nauthorKoomey, J. & authorNaffziger, S.\ntitleEnergy efficiency of computing: What's next?\njournalElectronic Design. noteURL\nhttps://www.electronicdesign.com/microprocessors/\nenergy-efficiency-computing-what-s-next (2016).\n\npreskill_2012\nauthorPreskill, J.\ntitleQuantum computing and the entanglement frontier.\njournalRapporteur talk at the 25th Solvay Conference\non Physics, Brussels  (year2012).\n\nAA11\nauthorAaronson, S. & authorArkhipov, A.\ntitleThe computational complexity of linear optics.\nIn booktitleProceedings of the Forty-third Annual\nACM Symposium on Theory of Computing, pages333\u2013342\n(year2011).\n\nBM16\nauthorBremner, M.\u00a0J., authorMontanaro, A. &\nauthorShepherd, D.\u00a0J.\ntitleAverage-case complexity versus approximate simulation\nof commuting quantum computations.\njournalPhys. Rev. Lett.\nvolume117, pages080501\n(year2016).\n\nBou19\nauthorBouland, A., authorFefferman, B.,\nauthorNirkhe, C. & authorVazirani, U.\ntitleOn the complexity and verification of quantum random\ncircuit sampling.\njournalNat. Phys. volume15,\npages159 (year2019).\n\nmovassagh2019cayley\nauthorMovassagh, R.\ntitleCayley path and quantum computational supremacy: A\nproof of average-case $\\#\\text{P}$-hardness of random circuit sampling with\nquantified robustness. notePreprint at\nhttps://arxiv.org/pdf/1909.06210 (2019).\n\nBJS10\nauthorBremner, M.\u00a0J., authorJozsa, R. &\nauthorShepherd, D.\u00a0J.\ntitleClassical simulation of commuting quantum\ncomputations implies collapse of the polynomial hierarchy.\njournalProc. Royal Soc. A\nvolume467, pages459\u2013472\n(year2010).\n\nHM17\nauthorHarrow, A.\u00a0W. & authorMontanaro, A.\ntitleQuantum computational supremacy.\njournalNature volume549,\npages203 (year2017).\n\nTD02\nauthorTerhal, B.\u00a0M. & authorDiVincenzo, D.\u00a0P.\ntitleAdaptive quantum computation, constant depth quantum\ncircuits and Arthur-Merlin games.\njournalQuant. Inf. Comp.\nvolume4, pages134\u2013145\n(year2004).\n\nHM18\nauthorHarrow, A.\u00a0W. & authorMehraban, S.\ntitleApproximate unitary $t$-designs by short random\nquantum circuits using nearest-neighbor and long-range gates.\nnotePreprint at https://arxiv.org/pdf/1809.06957 (2018).\n\nAB09\nauthorArora, S. & authorBarak, B.\ntitleComputational complexity: a modern approach\n(publisherCambridge University Press, year2009).\n\nCNS18\nauthorHuang, C., authorNewman, M. &\nauthorSzegedy, M.\ntitleExplicit lower bounds on strong quantum simulation.\nnotePreprint at https://arxiv.org/pdf/1804.10368 (2018).\n\nDal18\nauthorDalzell, A.\u00a0M., authorHarrow, A.\u00a0W.,\nauthorKoh, D.\u00a0E. & authorLa\u00a0Placa, R.\u00a0L.\ntitleHow many qubits are needed for quantum computational\nsupremacy? notePreprint at https://arxiv.org/pdf/1805.05224.pdf\n(2018).\n\nMS19\nauthorMorimae, T. & authorTamaki, S.\ntitleFine-grained quantum supremacy of the one-clean-qubit\nmodel. notePreprint at https://arxiv.org/pdf/1901.01637 (2019).\n\naaronson2014equivalence\nauthorAaronson, S.\ntitleThe equivalence of sampling and searching.\njournalTheory of Computing Systems\nvolume55, pages281\u2013298\n(year2014).\n\nNote2\nnoteThe variational distance is defined as $d_{\\protect \\text{VD}}(p, q) := \\frac{1}{2} \\sum_x |p(x) - q(x)|$ where the sum is over all output bitstrings $x$.\n\nAa19\nauthorAaronson, S.\ntitleCertifiable randomness from supremacy.\njournalManuscript in preparation.\n(year2019).\n\ncalabro2009complexity\nauthorCalabro, C., authorImpagliazzo, R. &\nauthorPaturi, R.\ntitleThe complexity of satisfiability of small depth\ncircuits.\nIn booktitleInternational Workshop on Parameterized\nand Exact Computation, pages75\u201385\n(organizationSpringer, year2009).\n\nNote3\nnoteIn terms of depth, the current construction gives a circuit $U$\non $n$ qubits of depth $n^{3k/2 + 5/2}$ for which it takes time $2^{(1 -\n2/k)n}$ to estimate the transition probability to additive error\n$2^{-(n+1)}$, assuming a form of SETH stating that it takes time no less than\n$2^{(1 - 2/k)n}$ to solve $k$-SAT.\n\n"}
